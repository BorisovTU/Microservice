
macro ADS(Id)
  var log="";

  if(not VclGetTrue("Выполнить синхронизацию?"))
    return;
  end;


  if(NOT ADGroupSynhro(Id,log))
     print(log);
  else
     print(log);
     RefreshScreen;
  end;
end;



macro ADS_List(Id)
  var log="";

  if(not VclGetTrue("Выполнить синхронизацию всех групп?"))
    return;
  end;

  var cmd = TRslOraQuery();
  cmd.sqlText ="select id_domensgroup from DOMENSGROUP";
  if(not cmd.Execute)
     println( "ошибка в запросе  - "+cmd.Error);
     return;
  end;

  while(NOT cmd.Eof)
     ADGroupSynhro(int(cmd.Rec.id_domensgroup),log);
     println(log);
     cmd.Next();
  end;

  RefreshScreen;
end;