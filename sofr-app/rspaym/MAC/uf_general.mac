/*28.11.2013 voikin*/
import general;

/*аналог GetColByCol, возвращает строку*/
macro GetColByColString(table, ret_colum, find_colum, find_value)
  var q = TRslOraQuery();
  if(Valtype(q)==V_UNDEF)
      runerror(ToAnsi("Ошибка GetColByCol: Не создан класс TRslOraQuery"));
      return 0;
  end;

  q.SqlText = "select "+ret_colum+" from "+table+" where "+ find_colum+" = :find_value";
  q.DeclareAndSet("find_value",find_value);
  if(NOT q.Execute())
      runerror(ToAnsi("Ошибка GetColByCol: "+q.Error + ". Параметры: " + table + "," + ret_colum + "," +
               find_colum + "," +  find_value));
  end;
  if(Not q.Eof)
      return q.GetByName(ret_colum).AsString;
  else
      return 0;
  end;
end;


/*ИД состояний*/
const UFStateSendUFEBS      = GetIdByCode("sstate","ID_SSTATE",30000); /*к отправке несрочным переводом*/
const UFStateSendBESP       = GetIdByCode("sstate","ID_SSTATE",30002); /*к отправке срочным переводом*/
const UFStateED108          = GetIdByCode("sstate","ID_SSTATE",3345); /*Помещен в ЭС108*/
const UFStateUnitED108      = GetIdByCode("sstate","ID_SSTATE",3350); /*Объединение реестров ЭС108*/
const UFStateED462ToSend    = GetIdByCode("sstate","ID_SSTATE",3150); /*Электронная заявка ЭС462 к отправке*/
const UFStateQueue          = GetIdByCode("sstate","ID_SSTATE",3315); /*В очереди*/
const UFStateFromCOS        = GetIdByCode("sstate","ID_SSTATE",3106); /*Принят из ЦОС*/

const UFStateSentRKC        = GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\Отправлен в РКЦ")); /*Отправлен в РКЦ*/
const UFStateSentCOS        = GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\Отправлен в ЦОС")); /*Отправлен в ЦОС*/
//const UFStateSentINFO       = GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\Отправлен банку-плательщику(инф.)")); /*Отправлен банку-плательщику*/
const UFStatePost           = GetIdByCode("sstate","ID_SSTATE",30011); /*Отложенные*/
//const UFStateInfoReadyToSend= GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\Информационные к отправке")); /*Информационные к отправке*/
const UFStateUFBSReadyToSend= GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\к отправке несрочным переводом")); /*к отправке несрочным переводом*/
const UFStateBESPReadyToSend= GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\к отправке срочным переводом"));  /*к отправке срочным переводом*/
const UFStateSOCReadyToSend = GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\к отправке ЦОС"));   /*к отправке ЦОС  */

const UFStateInfHas274      = GetIdByCode("sstate","ID_SSTATE",3123); /*Дан ответ на инф.платеж из РКЦ*/

const UFStateRecieveRKCwoEDP = GetIdByCode("sstate","ID_SSTATE",3145); /*Запрос/ответ из РКЦ без ЭПС*/

const UFStateValidError     = GetIdByCode("sstate","ID_SSTATE",GetSetupValue("Обмен с ПС БР\\Состояния начальных платежей\\Не пройдена валидация")); /*Состояние документов, не прошедших валидацию*/



const STATE_ESIDCREATED = GetIdByCode("sstate","ID_SSTATE",8050); /*Запрос/ответ исходящий*/
const STATE_ESID_SENT   = GetIdByCode("sstate","ID_SSTATE",8060); /*Запрос/ответ отправлен*/
const STATE_ESID_INCOM  = GetIdByCode("sstate","ID_SSTATE",8070); /*Запрос/ответ входящий*/
const STATE_ESID_PROCSD = GetIdByCode("sstate","ID_SSTATE",8080); /*Запрос/ответ обработан*/
const STATE_ESID_INVLD  = GetIdByCode("sstate","ID_SSTATE",8090); /*Запрос/ответ недопустимый*/


/*==============Значения настроек из таблицы SETUP==================*/
const UFEDAuthor   = GetSetupValue("Обмен с ПС БР\\УИС Составителя");/*УИС Составителя*/
const UFEDReceiver = GetSetupValue("Обмен с ПС БР\\УИС Получателя");/*УИС получателя*/

const NumKor        = GetSetupValue("Обмен с ПС БР\\Номер контрагента");
const NumKS         = GetSetupValue("Обмен с ПС БР\\Номер корсхемы");
const TypeAccKor    = GetSetupValue("Обмен с ПС БР\\Тип корсчета");
const intraRegional = GetSetupValue("Обмен с ПС БР\\Признак региональности");

/*Шаблон имени файла*/
const FileNameTemplate = GetSetupValue("Обмен с ПС БР\\Шаблон имени файла");

/*---Настройки сервиса несрочных переводов---*/
//const UFAutoSend        = int(GetSetupValue("Обмен с ПС БР\\Автоотправка"));
const UFSystemCodeUFEBS = GetSetupValue("Обмен с ПС БР\\Сервис несрочного перевода\\Признак системы обработки");/*Признак системы обработки*/
const UFPacketESID      = GetSetupValuesString("Обмен с ПС БР\\Сервис несрочного перевода\\Признак формирования пакетов ЭСИС");/*Признак формирования пакетов ЭСИС:список ЭСИС, по которым нужен пакет*/
const UFPacketEID       = GetSetupValuesString("Обмен с ПС БР\\Сервис несрочного перевода\\Признак формирования пакетов ЭИД");/*Признак формирования пакетов ЭИД:список ЭИД, по которым нужен пакет*/
const UFPacketCash      = GetSetupValuesString("Обмен с ПС БР\\Сервис несрочного перевода\\Признак формирования пакетов ЭС");/*Признак формирования пакетов ЭC:список ЭC, по которым нужен пакет*/

/*каталоги несрочных переводов*/
const UFDirUFEBSIn    = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог принимаемых файлов");/*Каталог принимаемых  файлов*/
const UFDirUFEBSOut   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог отправляемых файлов");/*Каталог отправляемых файлов*/
const UFDirUFEBSArc   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для архива файлов");/*Каталог для архива файлов*/
const UFDirUFEBSErr   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для принятых с ошибкой файлов");/*для принятых с ошибкой файлов*/
const UFDirUFEBSInKbr = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для принимаемых файлов АРМ КБР");/*Каталог для принимаемых файлов АРМ КБР*/


/*---Настройки сервиса срочных переводов---*/
const UFSystemCodeBESP  = GetSetupValue("Обмен с ПС БР\\Сервис срочного перевода\\Признак системы обработки");/*Признак системы обработки*/
//const UFPacketEPD       = GetSetupValue("Обмен с ПС БР\\Сервис срочного перевода\\Признак формирования пакетов ЭПС");/*Признак формирования пакетов ЭПС*/

/*каталоги срочных переводов*/
const UFDirBESPIn    = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог принимаемых файлов");/*Каталог принимаемых  файлов*/
const UFDirBESPOut   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог отправляемых файлов");/*Каталог отправляемых файлов*/
const UFDirBESPArc   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для архива файлов");/*Каталог для архива файлов*/
const UFDirBESPErr   = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для принятых с ошибкой файлов");/*для принятых с ошибкой файлов*/
const UFDirBESPInKbr = GetSetupValue("Обмен с ПС БР\\Каталоги\\Каталог для принимаемых файлов АРМ КБР");/*Каталог для принимаемых файлов АРМ КБР*/

/*каталоги схем XSD*/
const UFDirXSDIn  = GetSetupValue("Обмен с ПС БР\\XSD\\Каталоги схем\\Каталог принимаемых файлов");/*Каталог загружаемых схем*/
const UFDirXSDArc = GetSetupValue("Обмен с ПС БР\\XSD\\Каталоги схем\\Каталог для архива файлов");/*Каталог для архива схем*/
const UFDirXSDErr = GetSetupValue("Обмен с ПС БР\\XSD\\Каталоги схем\\Каталог для принятых с ошибкой файлов");/*для не загруженных схем*/

/*==================================================================*/

/*каталоги СПФС*/
const UFDirSPFSIn    = GetSetupValue("Обмен с СПФС\\Каталоги\\SPFSInDir");/*Каталог принимаемых  файлов*/
const UFDirSPFSOut   = GetSetupValue("Обмен с СПФС\\Каталоги\\SPFSOutDir");/*Каталог отправляемых файлов*/
const UFDirSPFSArc   = GetSetupValue("Обмен с СПФС\\Каталоги\\SPFSArcDir");/*Каталог для архива файлов*/
const UFDirSPFSErr   = GetSetupValue("Обмен с СПФС\\Каталоги\\SPFSErrDir");/*для принятых с ошибкой файлов*/

const Class_Doc_Out    = Class_Doc_ODB;/*Класс документов, созданных из кейса*/

/*идентификаторы шлюзов*/
const UFEBSIdGate = "UFEBS"; /* идентификатор шлюза УФЭБС */
const XSDIdGate   = "XSD";   /* идентификатор шлюза XSD */


/*Маска файлов для загрузки*/
const UFImpFileNameMask = "*.*";
const UFImpFileNameXSD  = "*.xsd";


/*таблицы*/
const UFTblTmpStepDoc = "TMP_STEPDOC";
const UFTblTmpXML     = "TMP_XML";
const UFTblTmpIDVR    = "TMP_IDVR";
const UFTblTmpXSD     = "XMLSCHEMA";
const UFTblTmpGroup   = "TMP_PAYM_GROUP";

/*формы документов*/
const Type_Doc_EPD       = GetIdByCode("nform","ID_NFORM",5100);
const Type_Doc_QUERY     = GetIdByCode("nform","ID_NFORM",5200);
const Type_Doc_ED202     = GetIdByCode("nform","ID_NFORM",5202);
const Type_Doc_ED203     = GetIdByCode("nform","ID_NFORM",5203);
const Type_Doc_ED204     = GetIdByCode("nform","ID_NFORM",5204);
const Type_Doc_ED210     = GetIdByCode("nform","ID_NFORM",5210);
const Type_Doc_ED211     = GetIdByCode("nform","ID_NFORM",5211);
const Type_Doc_ED211p    = GetIdByCode("nform","ID_NFORM",1211);/*ED211 как платеж*/
const Type_Doc_ED214     = GetIdByCode("nform","ID_NFORM",5214);
const Type_Doc_ED215     = GetIdByCode("nform","ID_NFORM",5215);
const Type_Doc_ED218     = GetIdByCode("nform","ID_NFORM",5218);
const Type_Doc_ED240     = GetIdByCode("nform","ID_NFORM",5240);
const Type_Doc_ED242     = GetIdByCode("nform","ID_NFORM",5242);
const Type_Doc_ED243     = GetIdByCode("nform","ID_NFORM",5243);
const Type_Doc_ED243p    = GetIdByCode("nform","ID_NFORM",1243);/*ED243 как платеж*/
const Type_Doc_ED244     = GetIdByCode("nform","ID_NFORM",5244);
const Type_Doc_ED244p    = GetIdByCode("nform","ID_NFORM",1244);/*ED244 как платеж*/
const Type_Doc_ED274     = GetIdByCode("nform","ID_NFORM",5274);
const Type_Doc_ED275     = GetIdByCode("nform","ID_NFORM",5275);
const Type_Doc_ED276     = GetIdByCode("nform","ID_NFORM",5276);
const Type_Doc_ED462     = GetIdByCode("nform","ID_NFORM",5462);
const Type_Doc_ED462p    = GetIdByCode("nform","ID_NFORM",1462);
const Type_Doc_ED464     = GetIdByCode("nform","ID_NFORM",5464);
const Type_Doc_ED503     = GetIdByCode("nform","ID_NFORM",5503);
const Type_Doc_ED501     = GetIdByCode("nform","ID_NFORM",5501);
const Type_Doc_ED512     = GetIdByCode("nform","ID_NFORM",5512);
const Type_Doc_ED540     = GetIdByCode("nform","ID_NFORM",5540);
const Type_Doc_ED542     = GetIdByCode("nform","ID_NFORM",5542);
const Type_Doc_ED573     = GetIdByCode("nform","ID_NFORM",5573);
const Type_Doc_ED801     = GetIdByCode("nform","ID_NFORM",5801);
const Type_Doc_ED804     = GetIdByCode("nform","ID_NFORM",5804);
const Type_Doc_ED806     = GetIdByCode("nform","ID_NFORM",5806);
const Type_Doc_ED810     = GetIdByCode("nform","ID_NFORM",5810);
const Type_Doc_ED813     = GetIdByCode("nform","ID_NFORM",5813);
const Type_Doc_EDCOS     = GetIdByCode("nform","ID_NFORM",5500);
const Type_Doc_EDMISSING = GetIdByCode("nform","ID_NFORM",5241);
const Type_Doc_NGRPAY    = GetIdByCode("form","ID_FORM",1150);


/*Префикс для формируемых xml-файлов*/
const UFPrefixFileName = "uf_";

/*системы обработки */
const UFSysCodeMOP  = "02";/*МОП*/
const UFSysCodeBESP = "05";/*БЭСП*/
const UFSysCodeCOS  = "99";/*ЦОС*/

const ESIS_STATUS_IGNORE = 5;/*Статус "Игнорирован" для ЭСИСов*/

const SUREQUEST_FINISH = GetIdByCode("SUREQUEST","ID_SUREQUEST",0);/*Окончательная выписка*/

/*---------ЭСИС-запросы------------------*/
/*Кода значений справочников по умолчанию*/
/*ED203*/
const SUSTATUS_DEF   = "00";
const SUGRCODE_DEF   = 2;
/*ED210*/
const SUREQUEST_DEF  = 1;
/*ED218*/
const SUMAKCODE_DEF  = 0;
/*ED220*/
const SUPERIOD_DEF   = 1;
const SUEDTYPE_DEF   = 1;
/*ED242*/
const SUREPEAT242ES_DEF    = 1;
const SUREPEAT242_DEF      = 3;
const SUREPEAT242ESOUT_DEF = 4;
/*ED244*/
const SUQUERY_DEF   = "09";
/*ED540*/
const SUEXCH_DEF  = 0;
/*ED542*/
const SUREPEAT542ES_DEF = 1;
const SUREPEAT542_DEF   = 3;
/*ED801*/
//const SULIQCODE_DEF  = 1;


/*------------Символы в шаблонах-------------------*/
const TEMPL_SYMB_NUM = "N";
const TEMPL_SYMB_YYYY = "YYYY";
const TEMPL_SYMB_YY = "YY";
const TEMPL_SYMB_MM = "MM";
const TEMPL_SYMB_DD = "DD";
