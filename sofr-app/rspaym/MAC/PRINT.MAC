/* ¥ç âì ¤®ªã¬¥­â®¢                                                        */
/* =============================   PayPrint   ============================= */
Import Curr2Str, general/*, "empty.cls", "mtforms.cls"*/, utils;

var PayObj, Pay, rmain, MT9xxRec;
Array CrRef;


/*----------------------------------------------------------------------------*/
/* ¯¥ç âì àã¡«¥¢®£® ¯« â¥¦­®£® ¤®ªã¬¥­â  */
/*----------------------------------------------------------------------------*/
macro PrintRub()
  var divide_kopeck ="-";
  ARRAY SS,SG,SBP,SBR,SP,SR;
  var shortsum, dat, datin, datval, datsp, paydate;

  var sumstr = trim(string(Pay.Amount:20:2));
  var rub = CurrToStr(Pay.Amount, GetCodeFi(Pay.ID_SFI));
  var pospoint = Index(sumstr, ".");
  if ((divide_kopeck == "-") OR (Int(SubStr(sumstr, pospoint + 1, 2)) > 0 ))
    StrSet(sumstr, pospoint, "-");
    shortsum = sumstr;
   elif (divide_kopeck == "=")
    rub = SubStr(rub,1,Index(rub,"ª®¯")-4);
    shortsum = SubStr(sumstr,1,pospoint-1)+"=";
  end;
  strsplit( rmain.Payer ,       SP,    50,50,5 ); /* « â¥«ìé¨ª      */
  strsplit( rmain.bank_payer  +" "+ rmain.NamePlace_Payer ,   SBP,   50,50,2 ); /*  ­ª-¯« â¥«ìé¨ª */
  strsplit( rub,                SS,    84,84,3 ); /* ‘ã¬¬  ¯p®¯¨áìî  */
  strsplit( rmain.ground,       SG,    95,95,3 ); /* á­®¢ ­¨¥       */
  strsplit( rmain.bank_receiver +" "+ rmain.NamePlace_Receiver ,SBR,   50,50,2 ); /*  ­ª-¯®«ãç â¥«ì */
  strsplit( rmain.receiver,     SR,    50,50,5 ); /* ®«ãç â¥«ì      */

  if(strlen(rmain.Shifr_Oper) < 2)
	rmain.Shifr_Oper = "0" + rmain.Shifr_Oper;
  end;
  dat = string(Pay.DateReferDoc);
  if (SubStr(dat,1,1) == " " )
    dat = "0" + SubStr(dat,2);
  end;
  dat = ChSubstr(dat, "-", ".");
  datin = string(Pay.InputDate);
  datin = ChSubstr(datin, "-", ".");
  datval = string(Pay.ValueDate);
  if (SubStr(datval,1,1) == " " )
    datval = "0" + SubStr(datval,2);
  end;
  datval = ChSubstr(datval, "-", ".");
  datsp = string(rmain.Date_Sp);
  if (datsp == "30-12-1899")
    datsp = "";
  end;
  if (SubStr(datsp,1,1) == " " )
   datsp = "0" + SubStr(datsp,2);
  end;
  datsp = ChSubstr(datsp, "-", ".");
  paydate = String( rmain.Pay_Date );
[          ##########                    ##########
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                                           ÚÄÄÄÄÄÄÄÄÄ¿
       ®áâã¯. ¢ ¡ ­ª ¯« â.          ‘¯¨á ­® á® áç. ¯« â.                                            ³ 0401060 ³
                                                                                                     ÀÄÄÄÄÄÄÄÄÄÙ



                                                                                                          ÚÄÄÄÄ¿
      ‹€’…†… “—…ˆ… ü ######      ##########                «¥ªâà®­­®                              ³#   ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                       ÀÄÄÄÄÙ
                                           „€’€                   ‚ˆ„ ‹€’…†€
                 ³
      ‘“ŒŒ€      ³ ####################################################################################
                 ³
      ˆ‘œ   ³ ####################################################################################
                 ³
                 ³ ####################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                           ³                                    ³        ³
      ˆ ############     ³  Š ###########                   ³        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ‘“ŒŒ€ ³ #############################
      ##################################################        ³        ³
                                                                ³        ³
      ##################################################        ³        ³
                                                                ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ##################################################        ³        ³
                                                                ³        ³
      ##################################################        ³  ‘—.ü  ³ #############################
                                                                ³        ³
      ##################################################        ³        ³
      ‹€’…‹œ™ˆŠ                                                ³        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄ´
      ##################################################        ³  ˆŠ   ³ #############################
                                                                ³        ³
                                                                ÃÄÄÄÄÄÄÄÄ´
      ##################################################        ³        ³
                                                                ³  ‘—.ü  ³ #############################
      €Š ‹€’…‹œ™ˆŠ€                                          ³        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ##################################################        ³  ˆŠ   ³ #############################
                                                                ³        ³
                                                                ÃÄÄÄÄÄÄÄÄ´
      ##################################################        ³        ³
                                                                ³  ‘—.ü  ³ #############################
      €Š ‹“—€’…‹Ÿ                                           ³        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄ´
                           ³                                    ³        ³
      ˆ ############     ³  Š ###########                   ³        ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ‘—.ü  ³ #############################
      ##################################################        ³        ³
                                                                ³        ³
      ##################################################        ³        ³
                                                                ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ##################################################        ³ ‚ˆ„ .³ ####      ³‘Š ‹€’. ³
                                                                ³        ³           ³           ³
      ##################################################        ÃÄÄÄÄÄÄÄÄ´           ÃÄÄÄÄÄÄÄÄÄÄÄ´
                                                                ³ €‡.‹.³           ³—….‹€’. ³ ###
      ##################################################        ÃÄÄÄÄÄÄÄÄ´           ÃÄÄÄÄÄÄÄÄÄÄÄ´
      ‹“—€’…‹œ                                                ³  Š„   ³           ³ …‡.‹…  ³  #
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÂÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÂÄÄÄÄ
       #                         ³ #             ³ #    ³ #         ³ #                    ³ #             ³ #
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ

      ###############################################################################################

      ###############################################################################################

      ###############################################################################################




      €‡€—…ˆ… ‹€’…†€

      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

          Œ..                                                                    ’Œ…’Šˆ €Š€

]
 (datval, datsp, Pay.NumReferDoc:l, dat:c, rmain.Status_Own,
  SS(0):l,SS(1):l,SS(2), rmain.INN_Payer, rmain.KPP_Payer,shortsum:l,
  SP(0):l,SP(1):l,SP(2):l,SP(3):l,Pay.PayerAccount:l,SP(4):l,
  SBP(0):l,Pay.PayerBankId:l,SBP(1):l,rmain.CorAcc_Payer:l,
  SBR(0):l,Pay.ReceiverBankId:l,SBR(1):l,rmain.CorAcc_Receiver:l,
  rmain.INN_Reciver, rmain.KPP_Reciver, Pay.ReceiverAccount:l,SR(0):l,SR(1):l,SR(2):l,
  rmain.Shifr_Oper:l,SR(3):l, int(rmain.Payment):l, SR(4):l, rmain.PayReserve,
  rmain.Code_Bj, rmain.Code_OKATO, rmain.Ground_Np, rmain.Nal_Per,
  rmain.Nal_Num, rmain.Nal_Date, rmain.Nal_Type,
  SG(0):l,SG(1):l,SG(2):l);

[
 
];


end;


/*----------------------------------------------------------------------------*/
/* ¥ç âì ¯« â¥¦­®£® ®à¤¥à                                                    */
/*----------------------------------------------------------------------------*/
MACRO print_rubord()
  var divide_kopeck ="-";
  ARRAY SS,SG,SBP,SBR,SP,SR;
  var shortsum, dat, datin, datval, datsp, paydate, dpdoc;

  var sumstr = trim(string(Pay.Amount:20:2));
  var rub = CurrToStr(Pay.Amount, GetCodeFi(Pay.ID_SFI));
  var pospoint = Index(sumstr, ".");
  if ((divide_kopeck == "-") OR (Int(SubStr(sumstr, pospoint + 1, 2)) > 0 ))
    StrSet(sumstr, pospoint, "-");
    shortsum = sumstr;
   elif (divide_kopeck == "=")
    rub = SubStr(rub,1,Index(rub,"ª®¯")-4);
    shortsum = SubStr(sumstr,1,pospoint-1)+"=";
  end;
  strsplit( rmain.Payer ,       SP,    50,50,5 ); /* « â¥«ìé¨ª      */
  strsplit( rmain.bank_payer  +" "+ rmain.NamePlace_Payer ,   SBP,   50,50,2 ); /*  ­ª-¯« â¥«ìé¨ª */
  strsplit( rub,                SS,    84,84,3 ); /* ‘ã¬¬  ¯p®¯¨áìî  */
  strsplit( rmain.ground,       SG,    66,66,5 ); /* á­®¢ ­¨¥       */
  strsplit( rmain.bank_receiver +" "+ rmain.NamePlace_Receiver ,SBR,   50,50,2 ); /*  ­ª-¯®«ãç â¥«ì */
  strsplit( rmain.receiver,     SR,    50,50,5 ); /* ®«ãç â¥«ì      */

  if(strlen(rmain.Shifr_Oper) < 2)
	rmain.Shifr_Oper = "0" + rmain.Shifr_Oper;
  end;
  dat = string(Pay.DateReferDoc);
  if (SubStr(dat,1,1) == " " )
    dat = "0" + SubStr(dat,2);
  end;
  dat = ChSubstr(dat, "-", ".");
  datin = string(Pay.InputDate);
  datin = ChSubstr(datin, "-", ".");
  datval = string(Pay.ValueDate);
  if (SubStr(datval,1,1) == " " )
    datval = "0" + SubStr(datval,2);
  end;
  datval = ChSubstr(datval, "-", ".");
  datsp = string(rmain.Date_Sp);
  if (datsp == "30-12-1899")
    datsp = "";
  end;
  if (SubStr(datsp,1,1) == " " )
   datsp = "0" + SubStr(datsp,2);
  end;
  datsp = ChSubstr(datsp, "-", ".");
  paydate = String( rmain.Pay_Date );
  /* ¤ â  ¯« â¥¦­®£® ¤®ªã¬¥­â  */
  dpdoc = string(rmain.PDoc_Date);
  if (dpdoc == "30-12-1899")
    dpdoc = "";
  end;
  if (SubStr(dpdoc,1,1) == " " )
   dpdoc = "0" + SubStr(dpdoc,2);
  end;
  dpdoc = ChSubstr(dpdoc, "-", ".");
[                                                                                                      ÚÄÄÄÄÄÄÄÄÄ¿
                                                                                                       ³ 0401066 ³
                                                                                                       ÀÄÄÄÄÄÄÄÄÄÙ
                                                                                                            ÚÄÄÄÄ¿
            ‹€’…†›‰ „… ü ######        ##########                 «¥ªâà®­­®                           ³#   ³
                                        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                     ÀÄÄÄÄÙ
                                              „€’€                   ‚ˆ„ ‹€’…†€




        ÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
        ‘“ŒŒ€      ³ ####################################################################################
                   ³
        ˆ‘œ   ³ ####################################################################################
                   ³
                   ³ ####################################################################################
        ÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
        ˆ ############     ³  Š ###########                   ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´        ³
        ##################################################        ³ ‘“ŒŒ€  ³ #############################
                                                                  ³        ³
        ##################################################        ³        ³
                                                                  ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
        ##################################################        ³        ³
                                                                  ³        ³
        ##################################################        ³  ‘—.ü  ³ #############################
                                                                  ³        ³
        ##################################################        ³        ³
        ‹€’…‹œ™ˆŠ                                                ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄ´
        ##################################################        ³  ˆŠ   ³ #############################
                                                                  ³        ³
                                                                  ÃÄÄÄÄÄÄÄÄ´
        ##################################################        ³        ³
                                                                  ³  ‘—.ü  ³ #############################
        €Š ‹€’…‹œ™ˆŠ€                                          ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
        ##################################################        ³  ˆŠ   ³ #############################
                                                                  ³        ³
                                                                  ÃÄÄÄÄÄÄÄÄ´
        ##################################################        ³        ³
                                                                  ³  ‘—.ü  ³ #############################
        €Š ‹“—€’…‹Ÿ                                           ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄ´
        ˆ ############     ³  Š ###########                   ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´        ³
        ##################################################        ³  ‘—.ü  ³ #############################
                                                                  ³        ³
        ##################################################        ³        ³
                                                                  ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
        ##################################################        ³ ‚ˆ„ .³ ####      ³‘Š ‹€’. ³
                                                                  ³        ³           ³           ³
        ##################################################        ÃÄÄÄÄÄÄÄÄ´           ÃÄÄÄÄÄÄÄÄÄÄÄ´
                                                                  ³ €‡.‹.³           ³—….‹€’. ³ ###
        ##################################################        ³        ³           ³           ³
        ‹“—€’…‹œ                                                ³        ³           ³           ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄ´           ÃÄÄÄÄÄÄÄÄÄÄÄ´
         ü —.‹€’.  ³˜ˆ” ‹€’.„Š.³ü ‹€’.„Š.  ³„€’€ ‹€’.„Š.  ³  Š„   ³           ³ …‡.‹…  ³  #
                    ³              ³             ³                ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
           ###      ³      ##      ³    ####     ³  ##########    ³ ‘“ŒŒ€  ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ‘’.‹.³ #############################
          ‘„…†€ˆ… …€–ˆˆ       —€‘’ˆ—€Ÿ ‹€’€              ³        ³
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÁÄÄÄÂÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄ
         #                         ³ #             ³ #    ³ #         ³ #                    ³ #             ³ #
        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄ
        €‡€—…ˆ… ‹€’…†€                                                 ³           ’Œ…’Šˆ €Š€
                                                                           ³
        ################################################################## ³
                                                                           ³
        ################################################################## ³
                                                                           ³
        ################################################################## ³
                                                                           ³
        ################################################################## ³
                                                                           ³
        ################################################################## ³
                                                                           ³

]
 (/*datval, datsp,*/ Pay.NumReferDoc:l, dat:c, rmain.Status_Own,
  SS(0):l,SS(1):l,SS(2), rmain.INN_Payer, rmain.KPP_Payer,
  SP(0):l,shortsum:l, SP(1):l,SP(2):l,SP(3):l,Pay.PayerAccount:l,SP(4):l,
  SBP(0):l,Pay.PayerBankId:l,SBP(1):l,rmain.CorAcc_Payer:l,
  SBR(0):l,Pay.ReceiverBankId:l,SBR(1):l,rmain.CorAcc_Receiver:l,
  rmain.INN_Reciver, rmain.KPP_Reciver, SR(0):l, Pay.ReceiverAccount:l,SR(1):l,SR(2):l,
  rmain.Shifr_Oper:l,SR(3):l, int(rmain.Payment):l, SR(4):l, rmain.PayReserve,
  rmain.PDoc_PartNum, rmain.PDoc_Shifr, rmain.PDoc_Num, dpdoc, rmain.Amm_Rest,
  rmain.Code_Bj, rmain.Code_OKATO, rmain.Ground_Np, rmain.Nal_Per,
  rmain.Nal_Num, rmain.Nal_Date, rmain.Nal_Type,
  SG(0):l,SG(1):l,SG(2):l,SG(3):l,SG(4):l );
[

];


END;

macro GetManyStr()
   var Str="";
   var TmpStr="";
   var Pos=0;
   var i=0;

   if(getparm(i,Str))
      i=i+1;
      while(getparm(i,TmpStr))
        Pos = Index(Str, "\r\n");
        If (Pos != 0)
           TmpStr = Trim(SubStr(Str, 1, Pos - 1));
           Str = SubStr(Str, Pos + 2);
        Else
           TmpStr=trim(Str);
           Str="";
        End;
        SetParm(i,TmpStr);
        i=i+1;
      end;
   end;
end;
/*----------------------------------------------------------------------------*/
MACRO PutSstr(s,s1);   /* ¥ç âì ­¥®¡ï§ â¥«ì­®© áâà®ª¨ ­  íªà ­ ¨ ¢ ä ©« */;
  if (trim(s1)!="")
    println(string(s,trim(s1)));
  end/*if*/;
END;

/*----------------------------------------------------------------------------*/
macro prF20(F20)
  if(trim(F20)!="")
   println("Transaction Reference Number       20 : ",F20);
  end;
end;
/*----------------------------------------------------------------------------*/
macro prF21(F21)
  if(trim(F21)!="")
   println("Related Reference                  21 : ",F21);
  end;
end;
/*----------------------------------------------------------------------------*/
macro prF32(Type,F32)
  if(Type="A")
   println("Value Date, Curr.Code,Amount            Date   Curr. Amount");
   println("                                   32A: ",substr(F32,1,6)," ",substr(F32,7,3),"   ",substr(F32,10));
  end;
end;

macro prF28C(F28Type,F28)
  if(trim(F28)!="")
   println("Statement Number/Sequence Number  28C : ",F28Type," ",F28);
  end;
end;

macro prF60a(F60aType,F60a)
  if(trim(F60a)!="")
    println("Opening Balance                   60",F60aType," : ");
    if (Substr(F60a,1,1)=="C")
      println("   Debit/Credit    : Credit");
    else
      println("   Debit/Credit    : Debit");
    end;
    println("   Date            : ",(Substr(F60a,6,2)+"."+SubStr(F60a,4,2)+".20"+Substr(F60a,2,2)));
    println("   Currency        : ",Substr(F60a,8,3));
    println("   Amount          : ",Substr(F60a,11));
  end;
end;

macro prF62a(F62aType,F62)
  if(trim(F62)!="")
    println("Closing Balance (Booked Funds)    62",F62aType," : ");
    if (Substr(F62,1,1)=="C")
      println("   Debit/Credit    : Credit");
    else
      println("   Debit/Credit    : Debit");
    end;
    println("   Date            : ",(Substr(F62,6,2)+"."+SubStr(F62,4,2)+".20"+Substr(F62,2,2)));
    println("   Currency        : ",Substr(F62,8,3));
    println("   Amount          : ",Substr(F62,11));
  end;
end;

macro AddSimb (str,chr:string, FullLen, B:Bool)
  chr=SubStr(chr,1,1);
  if (b==true)
    if(strlen(str) < FullLen)
      return MkStr(chr, FullLen - strlen(str)) + str;
    else
      return Substr(str, 1, FullLen);
    end;
  else
    if(strlen(str) < FullLen)
      return str + MkStr(chr, FullLen - strlen(str));
    else
      return Substr(str, 1, FullLen);
    end;
  end;
end;

macro prF61(F61)
  var Pos=0, Pos2=0, i=0, Sum=0;
  var Str="", Str1="", DC="";
  var DigitStr, S, Ref;

  println("Statement Line                    61 :");
  Str=SubStr(F61,5)+"\r\n:61:";
  println("   Value  Entr F Code Reference                      Amount        Ma");
  While (Index(Str,":61:")!=0)
    Str1=SubStr(Str,1,Index(Str,":61:")-1);

    /*Date*/
    print("   ",SubStr(Str1,1,6)," ");

    /* Entry Date*/
    if (Index(DigitStr,Substr(Str1,7,1))>0)
      Pos=11;
      S = SubStr(Str1,7,4);
	  print(S);
	  
      DC=SubStr(Str1,11,1);
    else
      Pos=7;
      DC=SubStr(Str1,7,1);
    end;

    /*Funds Code(3rd character of the currency code, if needed)*/
    Sum=SubStr(Str1,Pos+1,Index(Str1,",")+2);
    if (Index(DigitStr,SubStr(Sum,1,1))>0)
      print(" ");
    else
      print(SubStr(Sum,1,1));
      Sum=Substr(Sum,2);
    end;

    /*Transaction Type Identification Code, Reference for the Account Owner*/
    Pos2 = Index(Str1, ",")+7;
	if (StrLen(S) < 4)
      print(MkStr(" ",4-StrLen(S)));
	end;
    print(SubStr(Str1,Pos2-4,4)," ",AddSimb(SubStr(Str1,Pos2,Index(Str1,"//")-Pos2)," ",16,False));

    /*Amount*/
    Pos2 = Index(Sum, ",");
    If (Pos2 != 0)
      Sum = SubStr(Sum, 1, Pos2 - 1) + "." + SubStr(Sum, Pos2 + 1);
    End;
    Sum = Money(Double(Sum) * 100);
    print("     ",AddSimb(string(sum)," ",16,True));
    /*SubStr(Str1,Pos+1,Index(Str1,".")-Pos-5)*/

    /*Debit/Credit Mark*/
    println("        ",DC);

    /*Account Servicing Institution`s Reference*/
    Ref=SubStr(Str1,Index(Str1,"//")+2,Index(Str1,RN)-Index(Str1,"//")-2);
    println("                      ",Ref);

    /*Supplementary Details*/
    print("                      ",SubStr(Str1,Index(Str1,"//")+Index(Str1,RN)-Index(Str1,"//")+2));

    /*Getting PaymentId*/
    CrRef(i)=Ref;
    CrRef(i+1)=DC;
    CrRef(i+2)=Sum;
    i=i+3;
    /*******************/

    Str=SubStr(Str,Index(Str,":61:")+4);
  end;
end;


macro prFPINA(str,Type,PI,NA)
   var str1,str2,str3,str4,str5,str6;
   str1=str2=str3=str4=str5=str6="";
   GetManyStr(NA,str1,str2,str3,str4,str5,str6);
   if(trim(PI)!="")
     println(str,Type,": ",PI);
     PutSstr("                                        ",str1);
   else
     PutSstr(str+Type+": ",str1);
   end;
   PutSstr("                                        ",str2);
   PutSstr("                                        ",str3);
   PutSstr("                                        ",str4);
   PutSstr("                                        ",str5);
   PutSstr("                                        ",str6);
end;

macro print9xx()
       prF20(MT9xxRec.Reference);
       prF21(MT9xxRec.F21);
       prFPINA("Account Identification             25"," ","",MT9xxRec.F25);
       prF28C(MT9xxRec.F28Type,MT9xxRec.F28);
       prF60a(MT9xxRec.F60aType,MT9xxRec.F60a);
       prF61(MT9xxRec.Text);
       prF62a(MT9xxRec.F62aType,MT9xxRec.F62);
       println("-------------------------------> End of Message <------------------------------");
end;


/*----------------------------------------------------------------------------*/
/* â®çª  ¢å®¤  */
/*----------------------------------------------------------------------------*/
macro PayPrint(p)

  PayObj = p;
  Pay = PayObj.paym;
  rmain = PayObj.rmain;

  if(Pay.ID_NFORM == Type_Doc_RUS) /* àã¡«¥¢ë© */
    if(Pay.IsInf)/* ¨­ä®à¬ æ¨®­­ë© */
      ;
    else
      if (int(rmain.Shifr_Oper) == 2)
        /* ¯« â¥¦­®¥ âà¥¡®¢ ­¨¥ */
        printrub();
      elif (int(rmain.Shifr_Oper) == 16)
        /* ¯« â¥¦­ë© ®à¤¥à */
        print_rubord();
      else
        /* ¯« â¥¦­®¥ ¯®àãç¥­¨¥ */
        printrub();
      end;
    end;
  else
    if(Pay.ID_NFORM == Type_Doc_MT9XX)
      MT9xxRec = PayObj.MT9XX;
      println("----------> Message type ::n9x COMMON GROUP MESSAGE <----------");
      println("Sender:   " +MT9XXRec.Sender);
      println("          " +MT9XXRec.SenderDescr);
      println("Receiver: " +MT9XXRec.Receiver);
      println("          " +MT9XXRec.ReceiverDescr);
      print9xx;
    else
      if  (pay.id_nform  == Type_Doc_MT100)
         println("--------------> Message type ::100 CUSTOMER TRANSFER <----------");
      elif(pay.id_nform  == Type_Doc_MT200)
         println("----------> Message type ::200 BANK TRANSFER FOR OWN ACCOUNT <----------");
      elif(pay.id_nform  == Type_Doc_MT202)
         println("----------> Message type ::202 GENERAL BANK TRANSFER <----------");
      elif(pay.id_nform  == Type_Doc_MT103)
         println("----------> Message type ::103 SINGLE CUSTOMER CREDIT TRANSFER <----------");
      elif(pay.id_nform  == Type_Doc_MT900)
         println("----------> Message type ::900 CONFIRMATION OF DEBIT <----------");
      elif(pay.id_nform  == Type_Doc_MT910)
         println("----------> Message type ::910 CONFIRMATION OF CREDIT <----------");
      end;
      println(PayObj.mtrec.str);
    end;
  end;
end;
