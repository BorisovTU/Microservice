import dictionary;


const C_EDIT1SEC_WITHOUTO = 1, C_EDIT1SEC_WITHO = 2,
      C_EDIT2SEC_SM = 3, C_EDIT2SEC_RSS = 4, C_EDIT2SEC_RSM = 5,
      C_EDIT3SEC_SSS = 6, C_EDIT3SEC_DSM = 7,
      C_EDIT4SEC_SSSSWITHOUTO = 8, C_EDIT4SEC_SSSSWITHO = 9, C_EDIT4SEC_RSTST = 10,
      C_EDIT5SEC_SSSSS = 11,
      C_EDIT6SEC_SSSSSSWITHOUTO = 12, C_EDIT6SEC_SSSSSSWITHO = 13,
      C_EDIT7SEC_SSSSSSS = 14,
      C_EDIT8SEC_SSSSSSSS = 15;

class EditSection(_type: integer, _label: TArray, _width: TArray, _maxLength: TArray)
    var Type: integer = IIF(_type, _type, 0);
    var Label: TArray = IIF(_label, _label, TArray());
    var Width: TArray = IIF(_width, _width, TArray());
    var MaxLength: TArray = IIF(_maxLength, _maxLength, TArray());
end;

const EditSectionParameters = Dictionary();
      EditSectionParameters.Add("20", EditSection(C_EDIT1SEC_WITHOUTO, makeArray(""), makeArray(130), makeArray(16)));
      EditSectionParameters.Add("21", EditSection(C_EDIT1SEC_WITHOUTO, makeArray(""), makeArray(130), makeArray(16)));
      EditSectionParameters.Add("25", EditSection(C_EDIT1SEC_WITHO, makeArray(""), makeArray(250), makeArray(35)));
      EditSectionParameters.Add("13C", EditSection(C_EDIT4SEC_RSTST, makeArray("Код", "Указание времени", "Знак", "Разница во времени"), makeArray(60, 105, 25, 115), makeArray(7, 0, 1, 0)));
      EditSectionParameters.Add("23B", EditSection(C_EDIT1SEC_WITHO, makeArray(""), makeArray(50), makeArray(4)));
      EditSectionParameters.Add("23E", EditSection(C_EDIT2SEC_RSS, makeArray("Код инструкций", "Дополнительная информация"), makeArray(100, 215), makeArray(4, 30)));
      EditSectionParameters.Add("26T", EditSection(C_EDIT1SEC_WITHO, makeArray(""), makeArray(40), makeArray(3)));
      EditSectionParameters.Add("32A", EditSection(C_EDIT3SEC_DSM, makeArray("Дата", "Валюта", "Сумма"), makeArray(85, 55, 120), makeArray(0, 3, 0)));
      EditSectionParameters.Add("33B", EditSection(C_EDIT2SEC_SM, makeArray("Валюта", "Сумма"), makeArray(55, 120), makeArray(3, 0)));
      EditSectionParameters.Add("36", EditSection(C_EDIT1SEC_WITHOUTO, makeArray(""), makeArray(130), makeArray(12)));
      EditSectionParameters.Add("50", EditSection(C_EDIT4SEC_SSSSWITHO, makeArray("NA", "", "", ""), makeArray(250, 250, 250, 250), makeArray(35, 35, 35, 35)));
      EditSectionParameters.Add("50A", EditSection(C_EDIT6SEC_SSSSSSWITHO, makeArray("BIC", "PI", "NA", "", "", ""), makeArray(85, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35)));
      EditSectionParameters.Add("51A", EditSection(C_EDIT3SEC_SSS, makeArray("BIC", "PI", "NA"), makeArray(85, 250, 250), makeArray(11, 37, 35)));
      EditSectionParameters.Add("52A", EditSection(C_EDIT8SEC_SSSSSSSS, makeArray("BIC", "PI", "Loc", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("53A", EditSection(C_EDIT8SEC_SSSSSSSS, makeArray("BIC", "PI", "Loc", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("54A", EditSection(C_EDIT8SEC_SSSSSSSS, makeArray("BIC", "PI", "Loc", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("55A", EditSection(C_EDIT8SEC_SSSSSSSS, makeArray("BIC", "PI", "Loc", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("56A", EditSection(C_EDIT7SEC_SSSSSSS, makeArray("BIC", "PI", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("57A", EditSection(C_EDIT8SEC_SSSSSSSS, makeArray("BIC", "PI", "Loc", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("58A", EditSection(C_EDIT7SEC_SSSSSSS, makeArray("BIC", "PI", "NA", "", "", "", ""), makeArray(85, 250, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("59", EditSection(C_EDIT5SEC_SSSSS, makeArray("PI", "NA", "", "", ""), makeArray(250, 250, 250, 250, 250), makeArray(37, 35, 35, 35, 35)));
      EditSectionParameters.Add("59A", EditSection(C_EDIT6SEC_SSSSSSWITHO, makeArray("BIC", "PI", "NA", "", "", ""), makeArray(85, 250, 250, 250, 250, 250), makeArray(11, 37, 35, 35, 35, 35)));
      EditSectionParameters.Add("70", EditSection(C_EDIT4SEC_SSSSWITHOUTO, makeArray("", "", "", ""), makeArray(250, 250, 250, 250), makeArray(35, 35, 35, 35)));
      EditSectionParameters.Add("71A", EditSection(C_EDIT1SEC_WITHO, makeArray(""), makeArray(40), makeArray(3)));
      EditSectionParameters.Add("71F", EditSection(C_EDIT2SEC_RSM, makeArray("Валюта", "Сумма"), makeArray(55, 120), makeArray(3, 0)));
      EditSectionParameters.Add("71G", EditSection(C_EDIT2SEC_SM, makeArray("Валюта", "Сумма"), makeArray(55, 120), makeArray(3, 0)));
      EditSectionParameters.Add("72", EditSection(C_EDIT6SEC_SSSSSSWITHOUTO, makeArray("", "", "", "", "", ""), makeArray(250, 250, 250, 250, 250, 250), makeArray(35, 35, 35, 35, 35, 35)));
      EditSectionParameters.Add("77B", EditSection(C_EDIT3SEC_SSS, makeArray("", "", ""), makeArray(250, 250, 250), makeArray(35, 35, 35)));
      EditSectionParameters.Add("77T", EditSection(C_EDIT1SEC_WITHO, makeArray(""), makeArray(400), makeArray(9000)));

class EditSectionBuilder(_defaultMTRecCls, _mtRecCls)
    private var defaultMTRecCls = _defaultMTRecCls;
    private var mtRecCls = _mtRecCls;

    private macro Get1SectionEditWithoutOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const left = 70;
        var fieldName = SubStr(name, 1, 2);
        var field = defaultMTRecCls.GetField(fieldName);
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_" + field.ArrayValue[0].Name,
            "Row", rowNum,
            "Type", PanelItemType.Input,
            "Field", makeObj(
                "IInput",
                "Type", PanelInputFieldType.String,
                "Label", "F" + field.Name,
                "LabelTop", false,
                "ReadOnly", false,
                "Enabled", true,
                "TabStop", true,
                "ClearButton", false,
                "Required", false,
                "MaxLength", maxLength[0],
                "ValidateOnLostFocus", false,
                "Source", "F" + name + "." + field.ArrayValue[0].Name,
                "TextWrapping", false,
                "LinesCount", 1,
                "Location", makeObj(
                    "ILocation",
                    "MinWidth", width[0],
                    "Width", width[0],
                    "StretchHorizontal", false,
                    "StretchVertical", false,
                    "MarginLeft", left
                )
            )
        );
        return fields;
    end;

    private macro Get1SectionEditWithOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const left = 70;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Option",
            "Row", rowNum,
            "Type", PanelItemType.Input,
            "Field", makeObj(
                "IInput",
                "Type", PanelInputFieldType.String,
                "Label", "F" + field.Name,
                "LabelTop", false,
                "ReadOnly", true,
                "Enabled", true,
                "TabStop", false,
                "ClearButton", false,
                "Required", false,
                "MaxLength", 1,
                "ValidateOnLostFocus", false,
                "Source", "F" + name + ".Option",
                "TextWrapping", false,
                "LinesCount", 1,
                "Location", makeObj(
                    "ILocation",
                    "MinWidth", 20,
                    "Width", 20,
                    "StretchHorizontal", false,
                    "StretchVertical", false,
                    "MarginLeft", left
                )
            )
        );
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_" + field.ArrayValue[0].Name,
            "Row", rowNum,
            "Type", PanelItemType.Input,
            "Field", makeObj(
                "IInput",
                "Type", PanelInputFieldType.String,
                "Label", label[0],
                "LabelTop", false,
                "ReadOnly", false,
                "Enabled", true,
                "TabStop", true,
                "ClearButton", false,
                "Required", false,
                "MaxLength", maxLength[0],
                "ValidateOnLostFocus", false,
                "Source", "F" + name + "." + field.ArrayValue[0].Name,
                "TextWrapping", false,
                "LinesCount", 1,
                "Location", makeObj(
                    "ILocation",
                    "MinWidth", width[0],
                    "Width", width[0],
                    "StretchHorizontal", false,
                    "StretchVertical", false,
                    "MarginLeft", 5
                )
            )
        );
        return fields;
    end;

    private macro Get2SectionSMEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.Money);
        private const left = 0;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "List", makeObj(
                                "IList",
                                "ID", field.ArrayValue[0].Name,
                                "MultiPage", false,
                                "MultiSelect", false,
                                "ContextChar", 2,
                                "SelectOnly", false,
                                "GetRowsService", WebServiceCallback("ws_utils", "GetListRowsService", Type_Spr_SFI),
                                "GetRowCountService", WebServiceCallback("ws_utils", "GetListRowCountService", Type_Spr_SFI),
                                "ViewFields", GetViewFields(Type_Spr_SFI),
                                "MappingFields", makeArray(
                                    makeObj(
                                        "IMappingItem",
                                        "ListSource", "SFI8STRCODE",
                                        "ObjSource", "F" + name + "." + field.ArrayValue[0].Name
                                    )
                                )
                            ),
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", 50
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", 45
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro GetRepeatable2SectionSSEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 0;
        var fieldName = SubStr(name, StrLen("RepeatableSection") + 1);
        var field = mtRecCls.GetField(name);
        var repeatableFields = TArray();
        for (var i, 0, field.ArrayValue.Size - 2)
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[0].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[0],
                    "Label", label[0],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[0],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[0].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[0],
                        "Width", width[0],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", left
                    )
                )
            );
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[1].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[1],
                    "Label", label[1],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[1],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[1].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[1],
                        "Width", width[1],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", 5
                    )
                )
            );
        end;
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + fieldName,
                "Fields", repeatableFields
            )
        );
        return fields;
    end;

    private macro GetRepeatable2SectionSMEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.Money);
        private const left = 0;
        var fieldName = SubStr(name, StrLen("RepeatableSection") + 1);
        var field = mtRecCls.GetField(name);
        var repeatableFields = TArray();
        for (var i, 0, field.ArrayValue.Size - 2)
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[0].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[0],
                    "Label", label[0],
                    "LabelTop", false,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[0],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[0].Name,
                    "List", makeObj(
                        "IList",
                        "ID", field.ArrayValue[i].ArrayValue[0].Name + i,
                        "MultiPage", false,
                        "MultiSelect", false,
                        "ContextChar", 2,
                        "SelectOnly", false,
                        "GetRowsService", WebServiceCallback("ws_utils", "GetListRowsService", Type_Spr_SFI),
                        "GetRowCountService", WebServiceCallback("ws_utils", "GetListRowCountService", Type_Spr_SFI),
                        "ViewFields", GetViewFields(Type_Spr_SFI),
                        "MappingFields", makeArray(
                            makeObj(
                                "IMappingItem",
                                "ListSource", "SFI8STRCODE",
                                "ObjSource", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[0].Name
                            )
                        )
                    ),
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[0],
                        "Width", width[0],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", left
                    )
                )
            );
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[1].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[1],
                    "Label", label[1],
                    "LabelTop", false,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[1],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[1].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[1],
                        "Width", width[1],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", 45
                    )
                )
            );
        end;
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + fieldName,
                "Fields", repeatableFields
            )
        );
        return fields;
    end;

    private macro Get3SectionSSSEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get3SectionDSMEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.Date, PanelInputFieldType.String, PanelInputFieldType.Money);
        private const left = 0;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", 35
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "List", makeObj(
                                "IList",
                                "ID", field.ArrayValue[1].Name,
                                "MultiPage", false,
                                "MultiSelect", false,
                                "ContextChar", 2,
                                "SelectOnly", false,
                                "GetRowsService", WebServiceCallback("ws_utils", "GetListRowsService", Type_Spr_SFI),
                                "GetRowCountService", WebServiceCallback("ws_utils", "GetListRowCountService", Type_Spr_SFI),
                                "ViewFields", GetViewFields(Type_Spr_SFI),
                                "MappingFields", makeArray(
                                    makeObj(
                                        "IMappingItem",
                                        "ListSource", "SFI8STRCODE",
                                        "ObjSource", "F" + name + "." + field.ArrayValue[1].Name
                                    )
                                )
                            ),
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", 50
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", 45
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get4SectionSSSSEditWithoutOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var field = defaultMTRecCls.GetField(fieldName);
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get4SectionSSSSEditWithOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro GetRepeatable4SectionSTSTEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.Time, PanelInputFieldType.String, PanelInputFieldType.Time);
        private const left = 0;
        var fieldName = SubStr(name, StrLen("RepeatableSection") + 1);
        var field = mtRecCls.GetField(name);
        var repeatableFields = TArray();
        for (var i, 0, field.ArrayValue.Size - 2)
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[0].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[0],
                    "Label", label[0],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[0],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[0].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[0],
                        "Width", width[0],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", left
                    )
                )
            );
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[1].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[1],
                    "Label", label[1],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[1],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[1].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[1],
                        "Width", width[1],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", 5
                    )
                )
            );
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[1].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[2],
                    "Label", label[2],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[2],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[2].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[2],
                        "Width", width[2],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", 5
                    )
                )
            );
            repeatableFields[repeatableFields.Size] = makeObj(
                "IPanelItem",
                "Id", name + i + "_" + field.ArrayValue[i].ArrayValue[3].Name,
                "Row", i,
                "Type", PanelItemType.Input,
                "Field", makeObj(
                    "IInput",
                    "Type", type[3],
                    "Label", label[3],
                    "LabelTop", true,
                    "ReadOnly", false,
                    "Enabled", true,
                    "TabStop", true,
                    "ClearButton", false,
                    "Required", false,
                    "MaxLength", maxLength[2],
                    "ValidateOnLostFocus", false,
                    "Source", name + "[" + i + "]." + field.ArrayValue[i].ArrayValue[3].Name,
                    "TextWrapping", false,
                    "LinesCount", 1,
                    "Location", makeObj(
                        "ILocation",
                        "MinWidth", width[3],
                        "Width", width[3],
                        "StretchHorizontal", false,
                        "StretchVertical", false,
                        "MarginLeft", 5
                    )
                )
            );
        end;
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + fieldName,
                "Fields", repeatableFields
            )
        );
        return fields;
    end;

    private macro Get5SectionSSSSSEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[4].Name,
                        "Row", 5,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[4],
                            "Label", label[4],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[4],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[4].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[4],
                                "Width", width[4],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get6SectionSSSSSSEditWithoutOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var field = defaultMTRecCls.GetField(fieldName);
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[4].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[4],
                            "Label", label[4],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[4],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[4].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[4],
                                "Width", width[4],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[5].Name,
                        "Row", 5,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[5],
                            "Label", label[5],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[5],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[5].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[5],
                                "Width", width[5],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get6SectionSSSSSSEditWithOption(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String, PanelInputFieldType.String);
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[4].Name,
                        "Row", 5,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[4],
                            "Label", label[4],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[4],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[4].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[4],
                                "Width", width[4],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[5].Name,
                        "Row", 6,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[5],
                            "Label", label[5],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[5],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[5].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[5],
                                "Width", width[5],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get7SectionSSSSSSSEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String
        );
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[4].Name,
                        "Row", 5,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[4],
                            "Label", label[4],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[4],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[4].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[4],
                                "Width", width[4],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[5].Name,
                        "Row", 6,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[5],
                            "Label", label[5],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[5],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[5].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[5],
                                "Width", width[5],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[6].Name,
                        "Row", 7,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[6],
                            "Label", label[6],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[6],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[6].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[6],
                                "Width", width[6],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    private macro Get8SectionSSSSSSSSEdit(name: string, rowNum: integer, label: TArray, width: TArray, maxLength: TArray): TArray
        private const type = makeArray(
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String,
            PanelInputFieldType.String
        );
        private const left = 54;
        var fieldName = SubStr(name, 1, 2);
        var fieldOption = SubStr(name, 3, 1);
        var field = IIF(fieldOption == "", defaultMTRecCls.GetField(fieldName), defaultMTRecCls.GetField(fieldName, fieldOption));
        var fields = TArray();
        fields[fields.Size] = makeObj(
            "IPanelItem",
            "Id", name + "_Group",
            "Row", rowNum,
            "Type", PanelItemType.Group,
            "Field", makeObj(
                "IGroup",
                "Type", GroupItemType.Expander,
                "Label", "F" + field.Name,
                "Fields", makeArray(
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_Option",
                        "Row", 0,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", PanelInputFieldType.String,
                            "Label", "",
                            "LabelTop", false,
                            "ReadOnly", true,
                            "Enabled", true,
                            "TabStop", false,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", 1,
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + ".Option",
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", 20,
                                "Width", 20,
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[1].Name,
                        "Row", 1,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[0],
                            "Label", label[0],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[0],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[1].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[0],
                                "Width", width[0],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[0].Name,
                        "Row", 2,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[1],
                            "Label", label[1],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[1],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[0].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[1],
                                "Width", width[1],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[2].Name,
                        "Row", 3,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[2],
                            "Label", label[2],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[2],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[2].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[2],
                                "Width", width[2],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[3].Name,
                        "Row", 4,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[3],
                            "Label", label[3],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[3],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[3].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[3],
                                "Width", width[3],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[4].Name,
                        "Row", 5,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[4],
                            "Label", label[4],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[4],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[4].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[4],
                                "Width", width[4],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[5].Name,
                        "Row", 6,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[5],
                            "Label", label[5],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[5],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[5].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[5],
                                "Width", width[5],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[6].Name,
                        "Row", 7,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[6],
                            "Label", label[6],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[6],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[6].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[6],
                                "Width", width[6],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    ),
                    makeObj(
                        "IPanelItem",
                        "Id", name + "_" + field.ArrayValue[7].Name,
                        "Row", 8,
                        "Type", PanelItemType.Input,
                        "Field", makeObj(
                            "IInput",
                            "Type", type[7],
                            "Label", label[7],
                            "LabelTop", false,
                            "ReadOnly", false,
                            "Enabled", true,
                            "TabStop", true,
                            "ClearButton", false,
                            "Required", false,
                            "MaxLength", maxLength[7],
                            "ValidateOnLostFocus", false,
                            "Source", "F" + name + "." + field.ArrayValue[7].Name,
                            "TextWrapping", false,
                            "LinesCount", 1,
                            "Location", makeObj(
                                "ILocation",
                                "MinWidth", width[7],
                                "Width", width[7],
                                "StretchHorizontal", false,
                                "StretchVertical", false,
                                "MarginLeft", left
                            )
                        )
                    )
                )
            )
        );
        return fields;
    end;

    macro GetSectionEdit(name: string, rowNum: integer, editSectionParam: EditSection): TArray
        if (editSectionParam.Type == C_EDIT1SEC_WITHOUTO)
            return Get1SectionEditWithoutOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT1SEC_WITHO)
            return Get1SectionEditWithOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT2SEC_SM)
            return Get2SectionSMEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT2SEC_RSS)
            return GetRepeatable2SectionSSEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT2SEC_RSM)
            return GetRepeatable2SectionSMEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT3SEC_SSS)
            return Get3SectionSSSEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT3SEC_DSM)
            return Get3SectionDSMEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT4SEC_SSSSWITHOUTO)
            return Get4SectionSSSSEditWithoutOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT4SEC_SSSSWITHO)
            return Get4SectionSSSSEditWithOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT4SEC_RSTST)
            return GetRepeatable4SectionSTSTEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT5SEC_SSSSS)
            return Get5SectionSSSSSEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT6SEC_SSSSSSWITHOUTO)
            return Get6SectionSSSSSSEditWithoutOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT6SEC_SSSSSSWITHO)
            return Get6SectionSSSSSSEditWithOption(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT7SEC_SSSSSSS)
            return Get7SectionSSSSSSSEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        elif (editSectionParam.Type == C_EDIT8SEC_SSSSSSSS)
            return Get8SectionSSSSSSSSEdit(name, rowNum, editSectionParam.Label, editSectionParam.Width, editSectionParam.MaxLength);
        end;
    end;
end;

const MT100RequiredFields = MakeVector("20", "32A", "50", "59");
const MT103RequiredFields = MakeVector("20", "23B", "32A", "50A", "59A", "71A");
const MT200RequiredFields = MakeVector("20", "32A", "57");
const MT202RequiredFields = MakeVector("20", "21", "32A", "58A");
const MT900RequiredFields = MakeVector("20", "21", "25", "32A");
const MT910RequiredFields = MakeVector("20", "21", "25", "32A");

const RequiredFieldsDictionary = Dictionary();
      RequiredFieldsDictionary.Add(Type_Doc_MT100, MT100RequiredFields);
      RequiredFieldsDictionary.Add(Type_Doc_MT103, MT103RequiredFields);
      RequiredFieldsDictionary.Add(Type_Doc_MT200, MT200RequiredFields);
      RequiredFieldsDictionary.Add(Type_Doc_MT202, MT202RequiredFields);
      RequiredFieldsDictionary.Add(Type_Doc_MT900, MT900RequiredFields);
      RequiredFieldsDictionary.Add(Type_Doc_MT910, MT910RequiredFields);

const MT100AvailableFields = MakeVector("52", "53", "54", "56", "57", "70", "71A", "72");
const MT103AvailableFields = MakeVector("13C", "23E", "26T", "33B", "36", "51", "52", "53", "54", "55", "56", "57", "70", "71F", "71G", "72", "77B"/*, "77T"*/);
const MT200AvailableFields = MakeVector("53", "56", "72");
const MT202AvailableFields = MakeVector("52", "53", "54", "55", "56", "57", "72");
const MT900AvailableFields = MakeVector("52", "72");
const MT910AvailableFields = MakeVector("50", "52", "56", "72");

const AvailableFieldsDictionary = Dictionary();
      AvailableFieldsDictionary.Add(Type_Doc_MT100, MT100AvailableFields);
      AvailableFieldsDictionary.Add(Type_Doc_MT103, MT103AvailableFields);
      AvailableFieldsDictionary.Add(Type_Doc_MT200, MT200AvailableFields);
      AvailableFieldsDictionary.Add(Type_Doc_MT202, MT202AvailableFields);
      AvailableFieldsDictionary.Add(Type_Doc_MT900, MT900AvailableFields);
      AvailableFieldsDictionary.Add(Type_Doc_MT910, MT910AvailableFields);
