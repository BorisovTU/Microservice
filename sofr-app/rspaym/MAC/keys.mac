macro SaveKeyLeft (PayDoc)
  Key = " ";
  var Encrypt = TRslOraQuery();
  var EncrKey = "";

  if(not VclGetString (Key, TOOEM("Ключ"), TOOEM("Ввод левого ключа"), 110, 16, true))
     return;
  end;

  if(not key)
     EncrKey = "";
  else
     Encrypt.SqlText = "begin :EncrKey := RSP_ENCODE.Encrypt(:Str); end;";
     Encrypt.DeclareAndSet("EncrKey", EncrKey, "Str", Key);

     if(not Encrypt.Execute)
       RunError(toansi(Encrypt.Error));
     end;

     EncrKey = Encrypt.GetVariable("EncrKey");
  end;

  PayDoc.Rec.KEYS8KEYLEFT = EncrKey;
  PayDoc.Save;
  OraTrnCommit();
  RefreshScreen;
end;

macro SaveKeyRight (PayDoc)
  Key = " ";
  var Encrypt = TRslOraQuery();
  var EncrKey = "";

  if(not VclGetString (Key, TOOEM("Ключ"), TOOEM("Ввод правого ключа"), 110, 16, true))
     return;
  end;

  if(not key)
     EncrKey = "";
  else
     Encrypt.SqlText = "begin :EncrKey := RSP_ENCODE.Encrypt(:Str); end;";
     Encrypt.DeclareAndSet("EncrKey", EncrKey, "Str", Key);

     if(not Encrypt.Execute)
       RunError(toansi(Encrypt.Error));
     end;

     EncrKey = Encrypt.GetVariable("EncrKey");
  end;

  PayDoc.Rec.KEYS8KEYRIGHT = EncrKey;
  PayDoc.Save;
  OraTrnCommit();
  RefreshScreen;
end;