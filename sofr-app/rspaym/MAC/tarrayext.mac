  macro push_back(a, val)
    if (a == null)
        RunError("Не задан TArray");
    end;
    a[a.size] = val;
  end;

/*!
 * Создаёт вектор из перечисленных параметров
 * ex: var v = makeVector(4,6,89,6,3);
 */
macro MakeTArray() : TArray
  var i = 0, val;
  var a = TArray();
  while (getparm(i, val))
    push_back(a, val);
    i = i + 1;
  end;
  return a;
end;

macro FirstOrDefault(a, def)
  if (a.size > 0)
    return a[0];
  end;
  return def;
end;

class staticArrayExt

  macro push_back(a, val)
    if (a == null)
        RunError("Не задан TArray");
    end;
    a[a.size] = val;
  end;

  macro FirstOrDefault(a, def)
    if (a.size > 0)
      return a[0];
    end;
    return def;
  end;

    /*!
   * Создаёт вектор из перечисленных параметров
   * ex: var v = makeVector(4,6,89,6,3);
   */
  macro MakeTArray() : TArray
    var i = 1, val;
    var a = TArray();
    while (getparm(i, val))
      push_back(a, val);
      i = i + 1;
    end;
    return a;
  end;

  macro IsTArray(v)
    return valtype(v) == V_GENOBJ and isEqClass("TArray", v);
  end;

macro All(source, predicate) : bool
    
    for (var item, source)
        if (not ExecMacro2(predicate, item))
            return false;
        end;
    end;
    return true;
end;

macro Any(source, predicate) : bool
    
    for (var item, source)
        if (ExecMacro2(predicate, item))
            return true;
        end;
    end;
    return false;
end;

end;

const ArrayExt = staticArrayExt();
