<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
    http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">

  <changeSet id="110_BOSS-3399_create_dmetricskafka_dbt" context="prod" author="Shestakov">
    <createTable tableName="DMETRICSKAFKA_DBT" remarks="Информация о перечне метрик, передаваемых в Prometheus (App.Farm)">
      <column name="T_ID" type="number(10)" remarks="Идентификатор метрики"/>
      <column name="T_NAME" type="varchar2(60)" remarks="Наименование метрики"/>
      <column name="T_TYPE" type="number(1)" remarks="Тип метрики:1 - Counter; 2 - Gauge; 3 - Histogram; 4 - Summary; 5 - Untyped"/>
      <column name="T_VALUE" type="float(64)" remarks="Значение метрики"/>
	  <column name="T_DESCRIPTION" type="varchar2(100)" remarks="Описание метрики"/>
      <column name="T_TIMESTAMP" type="date" defaultValueComputed="sysdate" remarks="Системная дата и время"/>
    </createTable>

    <createIndex indexName="DMETRICSKAFKA_DBT_IDX0" tableName="DMETRICSKAFKA_DBT" unique="true">
      <column name="T_ID"/>
    </createIndex>

    <createSequence sequenceName="DMETRICSKAFKA_DBT_SEQ" startValue="1" maxValue="999999999999999999999999999" minValue="1" cacheSize="0"/>
  </changeSet>

  <changeSet id="110_BOSS-3399_createtrg_dmetricskafka.sql" context="prod" author="Shestakov"> 
    <sqlFile encoding="cp866" 
           endDelimiter="/" 
       path="./110/110_BOSS-3399_createtrg_dmetricskafka.sql" 
       splitStatements="true" 
       stripComments="false"/> 
  </changeSet>
</databaseChangeLog>

<!--

create sequence DMETRICSKAFKA_DBT_SEQ
 minValue 1  
 start with 1
 increment by 1 
 maxValue 999999999999999999999999999;
 
create unique index DMETRICSKAFKA_DBT_IDX0 on DMETRICSKAFKA_DBT(t_id)

create table DMETRICSKAFKA_DBT (
 T_ID number(10),
 T_NAME varchar2(60),
 T_TYPE number(1),
 T_VALUE float(64),
 T_DESCRIPTION VARCHAR2(100),
 T_TIMESTAMP date
);

-->