<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
    http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">
  <changeSet id="DEF-73474_update_reg" author="SennikovIV">
    <update tableName="DREGPARM_DBT">
      <column name="T_DESCRIPTION" value="Относительный путь (против корня терминала) к папке для сохранения Протокола запроса к хранилищу"/>
      <where>T_NAME = 'ПРОТОКОЛ_ЗАПРОСА_К_ХРАНИЛИЩУ'</where>
    </update>
  </changeSet>

  <changeSet id="DEF-73474_update_regflg" author="SennikovIV">
    <update tableName="DREGPARM_DBT">
      <column name="T_GLOBAL" valueComputed="CHR(0)"/>
      <where>T_NAME = 'ПРОТОКОЛ_ЗАПРОСА_К_ХРАНИЛИЩУ'</where>
    </update>
  </changeSet>

  <changeSet id="DEF-73474_update_regval" author="SennikovIV">
    <update tableName="DREGVAL_DBT">
      <column name="T_FMTBLOBDATA_XXXX" valueComputed="(to_blob(utl_raw.cast_to_raw('txtfile'||chr(0))))"/>
      <where> t_keyid in (select t_keyid from dregparm_dbt 
        where t_parentid = (SELECT t_keyid
              from (select p.t_keyid,SYS_CONNECT_BY_PATH(p.t_name, '/') Path
                      from dregparm_dbt p, dregval_dbt v 
                      where v.t_keyid=p.t_keyid and v.t_objectid=0
                      connect by prior p.t_keyid=p.t_parentid start with p.t_parentid=0)
               where Path='/РСХБ/ДИРЕКТОРИИ/OUT')
               and t_name = 'ПРОТОКОЛ_ЗАПРОСА_К_ХРАНИЛИЩУ')</where>
    </update>  
  </changeSet>
</databaseChangeLog> 