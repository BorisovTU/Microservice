/*Обновление категорий*/
DECLARE
BEGIN

 Insert into DMCACCDOC_DBT
   (T_ID, T_ISCOMMON, T_DOCKIND, T_DOCID, T_CATID, T_CATNUM, T_CHAPTER, T_ACCOUNT, T_CURRENCY, T_TEMPLNUM, T_GROUPNUM, T_PERIODID, T_ACTIVATEDATE, T_DISABLINGDATE, T_ISUSABLE, T_FIID, T_OWNER, T_PLACE, T_ISSUER, T_KIND_ACCOUNT, T_CENTR, T_CENTROFFICE, T_ACTIONDATE, T_FIID2, T_CLIENTCONTRID, T_BANKCONTRID, T_MARKETPLACEID, T_MARKETPLACEOFFICEID, T_FIROLE, T_INDEXDATE, T_DEPARTMENTID, T_CONTRACTOR, T_BRANCH, T_CORRDEPARTMENTID, T_CURRENCYEQ, T_CURRENCYEQ_RATETYPE, T_CURRENCYEQ_RATEDATE, T_CURRENCYEQ_RATEEXTRA, T_MCBRANCH)
 SELECT
   0, 'X', 0, 0, cat.t_ID, 
    cat.t_Number, 1, 
    (CASE WHEN cat.t_Code = 'НДФЛ к возврату_18%' THEN '60302810699000000018'
          WHEN cat.t_Code = 'НДФЛ к возврату_20%' THEN '60302810399000000020'
          ELSE '60302810999000000022' END
    ), 
    0, 1, 
    0, 0, TO_DATE('01.01.2025 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), TO_DATE('01.01.0001 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), 'X', 
    -1, -1, -1, -1, 'А', 
    -1, -1, TO_DATE('01.01.2025 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), -1, -1, 
    -1, -1, -1, 0, -1, 
    1, -1, 1, 0, -1, 
    0, 0, 0, 1
   FROM DMCCATEG_DBT cat
  WHERE cat.t_Code IN ('НДФЛ к возврату_18%',
                       'НДФЛ к возврату_20%',
                       'НДФЛ к возврату_22%'
                      )
    AND NOT EXISTS(SELECT 1 FROM DMCACCDOC_DBT WHERE T_CATID = CAT.T_ID AND T_ISCOMMON = 'X');



END;
/

DECLARE
BEGIN

 Insert into DMCACCDOC_DBT
   (T_ID, T_ISCOMMON, T_DOCKIND, T_DOCID, T_CATID, T_CATNUM, T_CHAPTER, T_ACCOUNT, T_CURRENCY, T_TEMPLNUM, T_GROUPNUM, T_PERIODID, T_ACTIVATEDATE, T_DISABLINGDATE, T_ISUSABLE, T_FIID, T_OWNER, T_PLACE, T_ISSUER, T_KIND_ACCOUNT, T_CENTR, T_CENTROFFICE, T_ACTIONDATE, T_FIID2, T_CLIENTCONTRID, T_BANKCONTRID, T_MARKETPLACEID, T_MARKETPLACEOFFICEID, T_FIROLE, T_INDEXDATE, T_DEPARTMENTID, T_CONTRACTOR, T_BRANCH, T_CORRDEPARTMENTID, T_CURRENCYEQ, T_CURRENCYEQ_RATETYPE, T_CURRENCYEQ_RATEDATE, T_CURRENCYEQ_RATEEXTRA, T_MCBRANCH)
 SELECT
   0, 'X', 0, 0, cat.t_ID, 
    cat.t_Number, 1, 
    (CASE WHEN cat.t_Code = 'НДФЛ к перечислению 18%' THEN '60301810399000000018'
          WHEN cat.t_Code = 'НДФЛ к перечислению 20%' THEN '60301810099000000020'
          ELSE '60301810699000000022' END
    ), 
    0, 1, 
    0, 0, TO_DATE('01.01.2025 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), TO_DATE('01.01.0001 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), 'X', 
    -1, -1, -1, -1, 'П', 
    -1, -1, TO_DATE('01.01.2025 00:00:00', 'DD.MM.YYYY HH24:MI:SS'), -1, -1, 
    -1, -1, -1, 0, -1, 
    1, -1, 1, 0, -1, 
    0, 0, 0, 1
   FROM DMCCATEG_DBT cat
  WHERE cat.t_Code IN ('НДФЛ к перечислению 18%',
                       'НДФЛ к перечислению 20%',
                       'НДФЛ к перечислению 22%'
                      )
    AND NOT EXISTS(SELECT 1 FROM DMCACCDOC_DBT WHERE T_CATID = CAT.T_ID AND T_ISCOMMON = 'X');



END;
/


