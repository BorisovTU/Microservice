<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
    http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">

  <changeSet id="116_BOSS-2183_create_ddl_enrolldebtsumop" author="Zhits">
    <createTable tableName="DDL_ENROLLDEBTSUMOP_DBT" remarks="Экземпляры запуска операции автоматического выноса задолженности на просрочку">
      <column name="T_ID" type="NUMBER(10)" remarks="Идентификатор операции"/>
      <column name="T_PROCDATE" type="DATE" remarks="Дата запуска процедуры"/>
      <column name="T_CLIENTID" type="NUMBER(10)" remarks="Идентификатор клиента"/>
      <column name="T_DLCONTRID" type="NUMBER(10)" remarks="Идентификатор ДБО"/>
      <column name="T_LOG" type="CLOB" remarks="Протокол"/>
      <column name="T_OPER" type="NUMBER(5)" remarks="Операционист"/>
      <column name="T_SYSDATE" type="DATE" defaultValueComputed="SYSDATE" remarks="Системная дата"/>
    </createTable>

    <createIndex indexName="DDL_ENROLLDEBTSUMOP_DBT_IDX0" tableName="DDL_ENROLLDEBTSUMOP_DBT" unique="true">
      <column name="T_ID"/>
    </createIndex>	

    <createSequence sequenceName="DDL_ENROLLDEBTSUMOP_DBT_SEQ" startValue="1" maxValue="999999999999999999999999999" minValue="1" cacheSize="0"/>
  </changeSet>

  <changeSet id="116_BOSS-2183_create_ddl_enrolldebtsum" author="Zhits">
    <createTable tableName="DDL_ENROLLDEBTSUM_DBT" remarks="Таблица общей задолженности клиентов к выносу на просрочку">
      <column name="T_ID" type="NUMBER(10)" remarks="Идентификатор общей задолженности"/>
      <column name="T_OPID" type="NUMBER(10)" remarks="Идентификатор запуска"/>
      <column name="T_CLIENTID" type="NUMBER(10)" remarks="Идентификатор клиента"/>
      <column name="T_DLCONTRID" type="NUMBER(10)" remarks="Идентификатор ДБО"/>
      <column name="T_SFCONTRID" type="NUMBER(10)" remarks="Идентификатор субдоговора"/>
      <column name="T_RESTDATE" type="DATE" remarks="Дата по которую собирается задолженность"/>
      <column name="T_DEBTDATE" type="DATE" remarks="Дата в которую возникла задолженность"/>
      <column name="T_DEBTSUM" type="NUMBER(32,12)" remarks="Общая сумма задолженности"/>
      <column name="T_DEBTCURRENCY" type="NUMBER(10)" remarks="Валюта задолженности"/>
      <column name="T_DEBTTYPE" type="NUMBER(5)" remarks="Тип задолженности"/>
      <column name="T_DEBTACCID" type="NUMBER(10)" remarks="Идентификатор счета клиента по прочей задолженности"/>
      <column name="T_DEBT458ACCID" type="NUMBER(10)" remarks="Идентификатор счета клиента по учету просроченной задолженности"/>
      <column name="T_ISENROLLDEBT" type="CHAR(1)" remarks="Признак успешного выноса на просрочку"/>
    </createTable>

    <createIndex indexName="DDL_ENROLLDEBTSUM_DBT_IDX0" tableName="DDL_ENROLLDEBTSUM_DBT" unique="true">
      <column name="T_ID"/>
    </createIndex>	

    <createSequence sequenceName="DDL_ENROLLDEBTSUM_DBT_SEQ" startValue="1" maxValue="999999999999999999999999999" minValue="1" cacheSize="0"/>
  </changeSet>

  <changeSet id="116_BOSS-2183_create_ddl_enrolldebtsumtrn" author="Zhits">
    <createTable tableName="DDL_ENROLLDEBTSUMTRN_DBT" remarks="Таблица сформированных проводок по выносу задолженности на просрочку">
      <column name="T_DEBTID" type="NUMBER(10)" remarks="Идентификатор общей задолженности"/>
      <column name="T_ACCTRN" type="NUMBER(10)" remarks="Идентификатор проводки"/>
    </createTable>
  </changeSet>

  <!--Триггеры на авто-инкрементные поля-->
  <changeSet id="116_BOSS-2183_create_trg_enrolldebtsum.sql" context="prod" author="Zhits"> 
    <sqlFile encoding="cp866" endDelimiter="/" path="./116/116_BOSS-2183_create_trg_enrolldebtsum.sql" splitStatements="true" stripComments="false"/> 
  </changeSet>

</databaseChangeLog>