BEGIN
   INSERT INTO DITEMSYST_DBT(T_CIDENTPROGRAM,T_ICASEITEM,T_IKINDMETHOD,T_IKINDPROGRAM,T_IHELP,T_RESERVE,T_SZNAMEITEM,T_PARM )
               VALUES('S',20206,1,2,0,CHR(1),'Отчет о плановых позициях клиента','00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000436C69656E74506C616E506F735F5265706F72742E6D6163000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000');
               
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
   INSERT INTO DITEMSYST_DBT(T_CIDENTPROGRAM,T_ICASEITEM,T_IKINDMETHOD,T_IKINDPROGRAM,T_IHELP,T_RESERVE,T_SZNAMEITEM,T_PARM )
               VALUES('S',20207,1,2,0,CHR(1),'Отчет о клиентах 2-го типа','00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000436C69656E7432547970655F5265706F72742E6D61630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000');
               
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/


DECLARE
   v_isMenu NUMBER := 0;
   v_NumberPoint NUMBER := 0;
   v_ParentID NUMBER := 0;
BEGIN

   SELECT count(1)
     INTO v_isMenu
     FROM DMENUITEM_DBT
    WHERE T_OBJECTID      = 1
      AND T_ISTEMPLATE    = 'X'
      AND T_IIDENTPROGRAM = 83
      AND T_ICASEITEM = 0
      AND T_SZNAMEITEM = ' Базовый стандарт';
     

   IF v_isMenu = 0 THEN
     SELECT NVL(MAX(T_INUMBERPOINT), 0)
       INTO v_NumberPoint
       FROM DMENUITEM_DBT
      WHERE T_OBJECTID      = 1
        AND T_ISTEMPLATE    = 'X'
        AND T_IIDENTPROGRAM = 83;

     v_NumberPoint := v_NumberPoint + 1;

     INSERT INTO DMENUITEM_DBT(T_OBJECTID,T_ISTEMPLATE,T_IIDENTPROGRAM,T_INUMBERPOINT,T_INUMBERFATHER,T_INUMBERLINE,T_ICASEITEM,T_CSYSTEMITEM,T_SZNAMEITEM,T_SZNAMEPROMPT,T_IHELP,T_IPROGITEM)
                 VALUES(1,'X',83,v_NumberPoint,3,100,0,'X',' Базовый стандарт',CHR(1),0,83);

     v_ParentID := v_NumberPoint;

     SELECT count(1)
       INTO v_isMenu
       FROM DMENUITEM_DBT
      WHERE T_OBJECTID      = 1
        AND T_ISTEMPLATE    = 'X'
        AND T_IIDENTPROGRAM = 83
        AND T_ICASEITEM = 20206;

     IF v_isMenu = 0 THEN
       v_NumberPoint := v_NumberPoint + 1;

       INSERT INTO DMENUITEM_DBT(T_OBJECTID,T_ISTEMPLATE,T_IIDENTPROGRAM,T_INUMBERPOINT,T_INUMBERFATHER,T_INUMBERLINE,T_ICASEITEM,T_CSYSTEMITEM,T_SZNAMEITEM,T_SZNAMEPROMPT,T_IHELP,T_IPROGITEM)
                   VALUES(1,'X',83,v_NumberPoint,v_ParentID,10,20206,'X',' Отчет о плановых позициях клиента','Отчет о плановых позициях клиента',0,83);
     END IF;

     SELECT count(1)
       INTO v_isMenu
       FROM DMENUITEM_DBT
      WHERE T_OBJECTID      = 1
        AND T_ISTEMPLATE    = 'X'
        AND T_IIDENTPROGRAM = 83
        AND T_ICASEITEM = 20207;

     IF v_isMenu = 0 THEN
       v_NumberPoint := v_NumberPoint + 1;

       INSERT INTO DMENUITEM_DBT(T_OBJECTID,T_ISTEMPLATE,T_IIDENTPROGRAM,T_INUMBERPOINT,T_INUMBERFATHER,T_INUMBERLINE,T_ICASEITEM,T_CSYSTEMITEM,T_SZNAMEITEM,T_SZNAMEPROMPT,T_IHELP,T_IPROGITEM)
                   VALUES(1,'X',83,v_NumberPoint,v_ParentID,20,20207,'X',' Отчет о клиентах 2-го типа',CHR(1),0,83);
     END IF;
   END IF;        
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

DECLARE
BEGIN
  UPDATE DDL_LIMITPRM_DBT
     SET T_IMPLKIND = 1
   WHERE T_IMPLKIND = 0;

EXCEPTION 
   WHEN DUP_VAL_ON_INDEX THEN NULL;
END;
/

DECLARE
  v_FirmCode DDL_LIMITPRM_DBT.T_FIRMCODE%TYPE;
  v_DepoAcc DDL_LIMITPRM_DBT.T_DEPOACC%TYPE;
BEGIN
  
  INSERT INTO DDL_LIMITPRM_DBT (T_ID, T_MARKETKIND, T_MARKETID, T_FIRMCODE, T_POSCODE, T_ISCORRECT, T_ISDEPO, T_DEPOACC, T_KINDLARGERTWO, T_CALENDARID, T_CURID, T_CURLIMITKIND, T_CODESCZEROLIMIT, T_CORDIVERG, T_IMPLKIND)
  VALUES (0, 1, 2, CHR(1), 'EQTV', CHR(0), CHR(0), 'L00+00002385', CHR(0), 20, 0, 1, 'GAZP', 0, 2);  --!!!
  
  EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

DECLARE
  v_FirmCode DDL_LIMITPRM_DBT.T_FIRMCODE%TYPE;
  v_DepoAcc DDL_LIMITPRM_DBT.T_DEPOACC%TYPE;
BEGIN
  
  INSERT INTO DDL_LIMITPRM_DBT (T_ID, T_MARKETKIND, T_MARKETID, T_FIRMCODE, T_POSCODE, T_ISCORRECT, T_ISDEPO, T_DEPOACC, T_KINDLARGERTWO, T_CALENDARID, T_CURID, T_CURLIMITKIND, T_CODESCZEROLIMIT, T_CORDIVERG, T_IMPLKIND)
  VALUES (0, 1, 151337, CHR(1), 'EQTV', CHR(0), CHR(0), '2-RSXBM_L01+00', CHR(0), 100, 0, 1, 'AAPL', 0, 2); --!!!
  
  EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/


BEGIN
   INSERT INTO DOBJGROUP_DBT (T_OBJECTTYPE, T_GROUPID, T_TYPE, T_NAME, T_SYSTEM, T_ORDER, T_MACRONAME, T_KEEPOLDVALUES,
                              T_UPDATEFLAG, T_SUCCESSOPFLAG, T_ATTROBJECTTYPE, T_ATTRGROUPID, T_ISHIDDEN, T_FULLNAMEISBASIC,
                              T_SYSHIDDEN, T_NOTUSEFIELDUSE, T_ISMEANPARENTNODE, T_ISMANUALFIRST, T_COMMENT)
                      VALUES (659,6,'X','Предоставлять брокеру право использования ценных бумаг в его интересах','X',6,CHR(1),'X',0,CHR(0),0,0,CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0));

                      
                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN

   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,6,1,0,CHR(1),'1','1',CHR(0),0,0,'Да','Да',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));


   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,6,2,0,CHR(1),'2','2',CHR(0),0,0,'Нет','Нет',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));

                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
  INSERT INTO DOBJATCOR_DBT(T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_OBJECT, T_GENERAL, T_VALIDFROMDATE, T_OPER, T_VALIDTODATE, T_SYSDATE, T_SYSTIME, T_ISAUTO, T_ID)
  SELECT 659,
         6,
         1, /*Да*/
         LPAD(SF.T_ID, 10, '0'),
         'X',
         SF.T_DATEBEGIN,
         9997,
         TO_DATE('31.12.9999','DD.MM.YYYY'),
         TO_DATE('01.01.0001','DD.MM.YYYY'),
         TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),
         'X',
         0
    FROM DSFCONTR_DBT SF
   WHERE SF.T_SERVKIND = 1
     AND SF.T_SERVKINDSUB = 8
     AND SF.T_DATECLOSE = TO_DATE('01.01.0001','DD.MM.YYYY')
     AND SF.T_PARTYID > 0
     AND EXISTS(SELECT 1 FROM DDLCONTRMP_DBT MP WHERE MP.T_SFCONTRID = SF.T_ID)
     AND NOT EXISTS(SELECT 1 
                      FROM DOBJATCOR_DBT ATCOR
                     WHERE ATCOR.T_OBJECTTYPE = 659
                       AND ATCOR.T_GROUPID = 6
                       AND ATCOR.T_OBJECT = LPAD(SF.T_ID, 10, '0')
                   );

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/


BEGIN
   INSERT INTO DOBJGROUP_DBT (T_OBJECTTYPE, T_GROUPID, T_TYPE, T_NAME, T_SYSTEM, T_ORDER, T_MACRONAME, T_KEEPOLDVALUES,
                              T_UPDATEFLAG, T_SUCCESSOPFLAG, T_ATTROBJECTTYPE, T_ATTRGROUPID, T_ISHIDDEN, T_FULLNAMEISBASIC,
                              T_SYSHIDDEN, T_NOTUSEFIELDUSE, T_ISMEANPARENTNODE, T_ISMANUALFIRST, T_COMMENT)
                      VALUES (659,7,'X','Перевод активов на новый номер ТКС произведен','X',7,CHR(1),'X',0,CHR(0),0,0,CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0));

                      
                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN

   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,7,1,0,CHR(1),'1','1',CHR(0),0,0,'Да','Да',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));


   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,7,2,0,CHR(1),'2','2',CHR(0),0,0,'Нет','Нет',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));

                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
  INSERT INTO DOBJATCOR_DBT(T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_OBJECT, T_GENERAL, T_VALIDFROMDATE, T_OPER, T_VALIDTODATE, T_SYSDATE, T_SYSTIME, T_ISAUTO, T_ID)
  SELECT 659,
         7,
         2, /*Нет*/
         LPAD(SF.T_ID, 10, '0'),
         'X',
         SF.T_DATEBEGIN,
         9997,
         TO_DATE('31.12.9999','DD.MM.YYYY'),
         TO_DATE('01.01.0001','DD.MM.YYYY'),
         TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),
         'X',
         0
    FROM DSFCONTR_DBT SF
   WHERE SF.T_SERVKIND = 1
     AND SF.T_SERVKINDSUB = 8
     AND SF.T_DATECLOSE = TO_DATE('01.01.0001','DD.MM.YYYY')
     AND SF.T_PARTYID > 0
     AND EXISTS(SELECT 1 FROM DDLCONTRMP_DBT MP WHERE MP.T_SFCONTRID = SF.T_ID)
     AND NOT EXISTS(SELECT 1 
                      FROM DOBJATCOR_DBT ATCOR
                     WHERE ATCOR.T_OBJECTTYPE = 659
                       AND ATCOR.T_GROUPID = 7
                       AND ATCOR.T_OBJECT = LPAD(SF.T_ID, 10, '0')
                   );

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
   INSERT INTO DOBJGROUP_DBT (T_OBJECTTYPE, T_GROUPID, T_TYPE, T_NAME, T_SYSTEM, T_ORDER, T_MACRONAME, T_KEEPOLDVALUES,
                              T_UPDATEFLAG, T_SUCCESSOPFLAG, T_ATTROBJECTTYPE, T_ATTRGROUPID, T_ISHIDDEN, T_FULLNAMEISBASIC,
                              T_SYSHIDDEN, T_NOTUSEFIELDUSE, T_ISMEANPARENTNODE, T_ISMANUALFIRST, T_COMMENT)
                      VALUES (659,8,'X','Заявление клиента о переводе на обособленный учет','X',8,CHR(1),'X',0,CHR(0),0,0,CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0),CHR(0));

                      
                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN

   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,8,1,0,CHR(1),'1','1',CHR(0),0,0,'Да','Да',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));


   INSERT INTO DOBJATTR_DBT (T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_PARENTID, T_CODELIST, T_NUMINLIST, T_NAMEOBJECT, T_CHATTR, T_LONGATTR, T_INTATTR,
                             T_NAME, T_FULLNAME, T_OPENDATE, T_CLOSEDATE, T_CLASSIFICATOR, T_CORRACTYPE, T_BALANCE, T_ISOBJECT)
                      VALUES (659,8,2,0,CHR(1),'2','2',CHR(0),0,0,'Нет','Нет',TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),0,CHR(1),CHR(1),CHR(0));

                      
EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
  INSERT INTO DOBJATCOR_DBT(T_OBJECTTYPE, T_GROUPID, T_ATTRID, T_OBJECT, T_GENERAL, T_VALIDFROMDATE, T_OPER, T_VALIDTODATE, T_SYSDATE, T_SYSTIME, T_ISAUTO, T_ID)
  SELECT 659,
         8,
         2, /*Нет*/
         LPAD(SF.T_ID, 10, '0'),
         'X',
         SF.T_DATEBEGIN,
         9997,
         TO_DATE('31.12.9999','DD.MM.YYYY'),
         TO_DATE('01.01.0001','DD.MM.YYYY'),
         TO_DATE('01.01.0001:00:00:00','DD.MM.YYYY HH24:MI:SS'),
         'X',
         0
    FROM DSFCONTR_DBT SF
   WHERE SF.T_SERVKIND = 1
     AND SF.T_SERVKINDSUB = 8
     AND SF.T_DATECLOSE = TO_DATE('01.01.0001','DD.MM.YYYY')
     AND SF.T_PARTYID > 0
     AND EXISTS(SELECT 1 FROM DDLCONTRMP_DBT MP WHERE MP.T_SFCONTRID = SF.T_ID)
     AND NOT EXISTS(SELECT 1 
                      FROM DOBJATCOR_DBT ATCOR
                     WHERE ATCOR.T_OBJECTTYPE = 659
                       AND ATCOR.T_GROUPID = 8
                       AND ATCOR.T_OBJECT = LPAD(SF.T_ID, 10, '0')
                   );

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

DECLARE
  v_cnt NUMBER := 0;
BEGIN

  SELECT COUNT(1) INTO v_cnt
    FROM DDLTRACC_DBT
   WHERE T_MARKETID = 2
     AND T_TRADACC = 'NEW_MMVB_ACC';

  IF v_cnt = 0 THEN
    INSERT INTO DDLTRACC_DBT (T_ID, T_MARKETID, T_TRADACC, T_AFFILIATION, T_DEFAULT, T_DEPSETID, T_ISSYS, T_SETTLECODE)
                      VALUES (0, 2, 'L00+00002385', 2, CHR(0), 22, CHR(0), CHR(1));
  END IF;

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

DECLARE
  v_cnt NUMBER := 0;
BEGIN

  SELECT COUNT(1) INTO v_cnt
    FROM DDLTRACC_DBT
   WHERE T_MARKETID = 2
     AND T_TRADACC = 'NEW_SPB_ACC_1';

  IF v_cnt = 0 THEN
    INSERT INTO DDLTRACC_DBT (T_ID, T_MARKETID, T_TRADACC, T_AFFILIATION, T_DEFAULT, T_DEPSETID, T_ISSYS, T_SETTLECODE)
                      VALUES (0, 151337, '2-RSXBM_L01+00', 2, CHR(0), 61, CHR(0), CHR(1));
  END IF;

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

DECLARE
  v_cnt NUMBER := 0;
BEGIN

  SELECT COUNT(1) INTO v_cnt
    FROM DDLTRACC_DBT
   WHERE T_MARKETID = 2
     AND T_TRADACC = 'NEW_SPB_ACC_2';

  IF v_cnt = 0 THEN
    INSERT INTO DDLTRACC_DBT (T_ID, T_MARKETID, T_TRADACC, T_AFFILIATION, T_DEFAULT, T_DEPSETID, T_ISSYS, T_SETTLECODE)
                      VALUES (0, 151337, '2-RSXBM_L01+00', 2, CHR(0), 62, CHR(0), CHR(1));
  END IF;

EXCEPTION
   WHEN OTHERS THEN NULL;
END;
/

BEGIN
   INSERT INTO DOBJECTS_DBT (T_OBJECTTYPE, T_NAME, T_CODE, T_USERNUMBER, T_PARENTOBJECTTYPE, T_SERVICEMACRO, T_MODULE)
   VALUES(4156,'Принадлежность ТКС для лимитов QUIK','ПРИН_ТКС',0,0,CHR(1),CHR(0));

EXCEPTION 
   WHEN DUP_VAL_ON_INDEX THEN NULL;
END;
/

BEGIN
   INSERT INTO DLLVALUES_DBT(T_LIST, T_ELEMENT, T_CODE, T_NAME, T_FLAG, T_NOTE, T_RESERVE)
   VALUES(4156,1,'1','Основной',1,CHR(1),CHR(1));

   INSERT INTO DLLVALUES_DBT(T_LIST, T_ELEMENT, T_CODE, T_NAME, T_FLAG, T_NOTE, T_RESERVE)
   VALUES(4156,2,'2','Для клиентов 2-го типа',2,CHR(1),CHR(1));

EXCEPTION 
   WHEN DUP_VAL_ON_INDEX THEN NULL;
END;
/

BEGIN
 EXECUTE IMMEDIATE 'COMMIT';
EXCEPTION
  WHEN OTHERS THEN NULL;
END;
/