<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
    http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">
  <changeSet id="AVT_BOSS-545_insert_objattr_14_1_04" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="0">
        select count(1) from dobjattr_dbt where t_objecttype = 3 and t_groupid = 16 and t_numinlist = '14.1'
      </sqlCheck>
    </preConditions>
    
    <insert tableName="dobjattr_dbt">
        <column name="t_objecttype" value="3"/>
        <column name="t_groupid" value="16"/>
        <column name="t_attrid" valueComputed="(select max(t_attrid)+1 from dobjattr_dbt where t_objecttype = 3 and t_groupid = 16)"/>
        <column name="t_parentid" value="17"/>
        <column name="t_codelist" valueComputed="chr(1)"/>
        <column name="t_numinlist" value="14.1"/>
        <column name="t_nameobject" value="14.1"/>
        <column name="t_chattr" valueComputed="chr(0)"/>
        <column name="t_longattr" value="0"/>
        <column name="t_intattr" value="0"/>
        <column name="t_name" value="Международная компания по 290-ФЗ в порядке редомициляции"/>
        <column name="t_fullname" value="Международная компания по 290-ФЗ в порядке редомициляции"/>
        <column name="t_opendate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_closedate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_classificator" value="0"/>
        <column name="t_corractype" valueComputed="chr(1)"/>
        <column name="t_balance" valueComputed="chr(1)"/>
        <column name="t_isobject" valueComputed="chr(0)"/>
    </insert>   
  </changeSet>

  <changeSet id="AVT_BOSS-545_insert_objattr_14_2_04" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="0">
        select count(1) from dobjattr_dbt where t_objecttype = 3 and t_groupid = 16 and t_numinlist = '14.2'
      </sqlCheck>
    </preConditions>
    
    <insert tableName="dobjattr_dbt">
        <column name="t_objecttype" value="3"/>
        <column name="t_groupid" value="16"/>
        <column name="t_attrid" valueComputed="(select max(t_attrid)+1 from dobjattr_dbt where t_objecttype = 3 and t_groupid = 16)"/>
        <column name="t_parentid" value="17"/>
        <column name="t_codelist" valueComputed="chr(1)"/>
        <column name="t_numinlist" value="14.2"/>
        <column name="t_nameobject" value="14.2"/>
        <column name="t_chattr" valueComputed="chr(0)"/>
        <column name="t_longattr" value="0"/>
        <column name="t_intattr" value="0"/>
        <column name="t_name" value="Международная компания по 290-ФЗ в порядке инкорпорации"/>
        <column name="t_fullname" value="Международная компания по 290-ФЗ в порядке инкорпорации"/>
        <column name="t_opendate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_closedate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_classificator" value="0"/>
        <column name="t_corractype" valueComputed="chr(1)"/>
        <column name="t_balance" valueComputed="chr(1)"/>
        <column name="t_isobject" valueComputed="chr(0)"/>
    </insert>
   
  </changeSet>

  <changeSet id="AVT_BOSS-545_update_objatcor_04" author="Shvetsov" >
    <update tableName="dobjatcor_dbt">
      <column name="t_validfromdate" valueComputed="to_date('01/01/2025', 'dd/mm/yyyy')"/>
       <where>t_objecttype = 12 and t_groupid = 1 and t_validfromdate = to_date('01.01.0001','dd.mm.yyyy') and t_general = 'X'</where>
    </update>  
  </changeSet>

  <changeSet id="AVT_BOSS-545_insert_objattr_SHS9_04" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="0">
        select count(1) from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1 and t_name = 'SHS9'
      </sqlCheck>
    </preConditions>
    
    <insert tableName="dobjattr_dbt">
        <column name="t_objecttype" value="12"/>
        <column name="t_groupid" value="1"/>
        <column name="t_attrid" valueComputed="(select max(t_attrid)+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_parentid" value="0"/>
        <column name="t_codelist" valueComputed="chr(1)"/>
        <column name="t_numinlist" valueComputed="(select max(to_number(t_numinlist))+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_nameobject" valueComputed="(select max(to_number(t_numinlist))+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_chattr" valueComputed="chr(0)"/>
        <column name="t_longattr" value="0"/>
        <column name="t_intattr" value="0"/>
        <column name="t_name" value="SHS9"/>
        <column name="t_fullname" value="акции банков – нерезидентов (привилегированные)"/>
        <column name="t_opendate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_closedate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_classificator" value="0"/>
        <column name="t_corractype" valueComputed="chr(1)"/>
        <column name="t_balance" valueComputed="chr(1)"/>
        <column name="t_isobject" valueComputed="chr(0)"/>
    </insert>    
  </changeSet>

  <changeSet id="AVT_BOSS-545_insert_objattr_SHS10_04" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="0">
        select count(1) from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1 and t_name = 'SHS10'
      </sqlCheck>
    </preConditions>
    
    <insert tableName="dobjattr_dbt">
        <column name="t_objecttype" value="12"/>
        <column name="t_groupid" value="1"/>
        <column name="t_attrid" valueComputed="(select max(t_attrid)+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_parentid" value="0"/>
        <column name="t_codelist" valueComputed="chr(1)"/>
        <column name="t_numinlist" valueComputed="(select max(to_number(t_numinlist))+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_nameobject" valueComputed="(select max(to_number(t_numinlist))+1 from dobjattr_dbt where t_objecttype = 12 and t_groupid = 1)"/>
        <column name="t_chattr" valueComputed="chr(0)"/>
        <column name="t_longattr" value="0"/>
        <column name="t_intattr" value="0"/>
        <column name="t_name" value="SHS10"/>
        <column name="t_fullname" value="акции прочих нерезидентов (привилегированные)"/>
        <column name="t_opendate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_closedate" valueComputed="to_date('01/01/0001', 'dd/mm/yyyy')"/>
        <column name="t_classificator" value="0"/>
        <column name="t_corractype" valueComputed="chr(1)"/>
        <column name="t_balance" valueComputed="chr(1)"/>
        <column name="t_isobject" valueComputed="chr(0)"/>
    </insert>    
  </changeSet>

  <changeSet id="AVT_BOSS-545_update_DOBJATTR_04" author="Shvetsov" >
    <update tableName="dobjattr_dbt">
      <column name="t_fullname" value="акции банков – нерезидентов (обыкновенные)"/>
       <where>t_objecttype = 12 and T_GROUPID = 1 and t_name = 'SHS5'</where>
    </update>

    <update tableName="dobjattr_dbt">
      <column name="t_fullname" value="акции прочих нерезидентов (обыкновенные)"/>
       <where>t_objecttype = 12 and t_groupid = 1 and t_name = 'SHS6'</where>
    </update> 

    <update tableName="dobjattr_dbt">
      <column name="t_fullname" value="документарные закладные (кроме обездвиженных документарных закладных)"/>
       <where>t_objecttype = 12 and t_groupid = 1 and t_name = 'ENC1'</where>
    </update>   
  </changeSet>

  <changeSet id="AVT_BOSS-545_inser_namealg_04" author="Shvetsov">
    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="0"></column>
      <column name="t_sznamealg" value="Все"></column>
      <column name="t_ilenname" value="8"></column>
      <column name="t_iquantalg" value="6"></column>
      <column name="t_reserve" value="null"></column>
    </insert>

    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="1"></column>
      <column name="t_sznamealg" value="1 раздел"></column>
      <column name="t_ilenname" value="0"></column>
      <column name="t_iquantalg" value="0"></column>
      <column name="t_reserve" value="null"></column>
    </insert>

    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="2"></column>
      <column name="t_sznamealg" value="2 раздел"></column>
      <column name="t_ilenname" value="0"></column>
      <column name="t_iquantalg" value="0"></column>
      <column name="t_reserve" value="null"></column>
    </insert>

    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="3"></column>
      <column name="t_sznamealg" value="3 раздел"></column>
      <column name="t_ilenname" value="0"></column>
      <column name="t_iquantalg" value="0"></column>
      <column name="t_reserve" value="null"></column>
    </insert>

    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="4"></column>
      <column name="t_sznamealg" value="4 раздел"></column>
      <column name="t_ilenname" value="0"></column>
      <column name="t_iquantalg" value="0"></column>
      <column name="t_reserve" value="null"></column>
    </insert>

    <insert tableName="dnamealg_dbt">
      <column name="t_itypealg" value="2275"></column>
      <column name="t_inumberalg" value="5"></column>
      <column name="t_sznamealg" value="5 раздел"></column>
      <column name="t_ilenname" value="0"></column>
      <column name="t_iquantalg" value="0"></column>
      <column name="t_reserve" value="null"></column>
    </insert>
  </changeSet>

  <changeSet id="AVT_BOSS-545_insert_menu" context="prod" author="Shvetsov"> 
    <sqlFile encoding="cp866" 
           endDelimiter="/" 
       path="./123/AVT_BOSS-545_insert_menu.sql" 
       splitStatements="true" 
       stripComments="false"/> 
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_clientportfolio_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dclientportfolio_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_partyid" type="varchar2(35)" remarks="Код вида 1 клиента"/>
      <column name="t_clientname" type="varchar2(208)" remarks="Наименование клиента"/>
      <column name="t_contractid" type="varchar2(64)" remarks="Код ДБО клиента"/>
      <column name="t_clienttype" type="number(5)" remarks="Тип клиента"/>
      <column name="t_isresident" type="number(5)" remarks="Признак резидентности"/>
      <column name="t_isqualinvestor" type="number(5)" remarks="Признак квал. инвестора"/>
      <column name="t_rcvstatus" type="number(5)" remarks="Состояние НПР портфеля"/>
      <column name="t_cohort" type="number(5)" remarks="Группа клиентов по объёму портфеля"/>
      <column name="t_initmargin" type="number(32,12)" remarks="Сумма начальной маржи"/>
      <column name="t_rcv1" type="number(32,12)" remarks="Сумма НВП1"/>
      <column name="t_rcv2" type="number(32,12)" remarks="Сумма НВП2"/>
      <column name="t_risklevel" type="number(5)" remarks="Уровень риска"/>
      <column name="t_portfoliovalue" type="number(32,12)" remarks="Стоимость портфеля"/>
      <column name="t_rubposition" type="number(32,12)" remarks="Стоимость позиции по рублям"/>
      <column name="t_curposition" type="number(32,12)" remarks="Стоимость позиции по инстранной валюте, в руб"/>
      <column name="t_secposition" type="number(32,12)" remarks="Стоимость позиции по ценным бумагам, в руб"/>
      <column name="t_futuresposition" type="number(32,12)" remarks="Стоимость позиции по фьючерсам, в руб"/>
      <column name="t_optionposition" type="number(32,12)" remarks="Стоимость позиции по опционам, в руб"/>
      <column name="t_precmetposition" type="number(32,12)" remarks="Стоимость позиции по драг. металлам"/>
      <column name="t_nonqualassecposition" type="number(32,12)" remarks="Стоимость позиции по НПФИ"/>
      <column name="t_curinitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по инстранной валюте, в руб"/>
      <column name="t_secinitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по ценным бумагам, в руб"/>
      <column name="t_futuresinitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по фьючерсам, в руб"/>
      <column name="t_optioninitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по опционам, в руб"/>
      <column name="t_precmetinitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по драг. металлам"/>
      <column name="t_nonqualassecinitmargin" type="number(32,12)" remarks="Стоимость начальной маржи по НПФИ"/>
      <column name="t_clientcounter" type="number(5)" remarks="Счётчик клиентов"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_fipositionsbytype_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dfipositionsbytype_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_fikind" type="number(5)" remarks="Вид ФИ"/>
      <column name="t_ficode" type="varchar2(12)" remarks="Код ФИ"/>
      <column name="t_nonqualassec" type="char(1)" remarks="Признак НИФИ"/>
      <column name="t_settledate" type="timestamp" remarks="Дата, за которую получены данные"/>
      <column name="t_currentbal" type="number(32,12)" remarks="Текущий остаток по инструменту"/>
      <column name="t_currentlimit" type="number(32,12)" remarks="Текущая позиция по инструменту"/>
      <column name="t_settleprice" type="number(32,12)" remarks="Цена, с использованием которой оценивается позиция"/>
      <column name="t_currcode" type="varchar2(4)" remarks="Валюта цены"/>
      <column name="t_discountccp" type="number(32,12)" remarks="Ставка рыночного риска по инструменту"/>
      <column name="t_isnonliquidasset" type="char(1)" remarks="Признак неликвидного инструмента"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part1form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart1form725_dbt" remarks="725 форма. Часть 1">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a12" type="number(5)"/>
      <column name="t_a13" type="number(5)"/>
      <column name="t_a14" type="number(5)"/>
      <column name="t_a15" type="number(5)"/>
      <column name="t_a16" type="number(5)"/>
      <column name="t_a17" type="number(5)"/>
      <column name="t_a18" type="number(5)"/>
      <column name="t_a19" type="number(10)"/>
      <column name="t_a110" type="number(10)"/>
      <column name="t_a111" type="number(32,12)"/>
      <column name="t_a112" type="number(32,12)"/>
      <column name="t_a113" type="number(32,12)"/>
      <column name="t_a114" type="number(32,12)"/>
      <column name="t_a115" type="number(32,12)"/>
      <column name="t_a116" type="number(32,12)"/>
      <column name="t_a117" type="number(32,12)"/>
      <column name="t_a118" type="number(32,12)"/>
      <column name="t_a119" type="number(32,12)"/>
      <column name="t_a120" type="number(32,12)"/>
      <column name="t_a121" type="number(32,12)"/>
      <column name="t_a122" type="number(32,12)"/>
      <column name="t_a123" type="number(32,12)"/>
      <column name="t_a124" type="number(32,12)"/>
      <column name="t_a125" type="number(32,12)"/>
      <column name="t_a126" type="number(32,12)"/>
      <column name="t_a127" type="number(32,12)"/>
      <column name="t_a128" type="number(32,12)"/>
      <column name="t_a129" type="number(32,12)"/>
      <column name="t_a130" type="number(32,12)"/>
      <column name="t_a131" type="number(32,12)"/>
      <column name="t_a132" type="number(32,12)"/>
      <column name="t_a133" type="number(32,12)"/>
      <column name="t_a134" type="number(32,12)"/>
      <column name="t_a135" type="number(32,12)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_clientpositionstoclose_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dclientpositionstoclose_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_partyid" type="varchar2(35)" remarks="Код вида 1 клиента"/>
      <column name="t_clientname" type="varchar2(208)" remarks="Наименование клиента"/>
      <column name="t_contractid" type="varchar2(64)" remarks="Код ДБО клиента"/>
      <column name="t_clienttype" type="number(5)" remarks="Тип клиента"/>
      <column name="t_isresident" type="number(5)" remarks="Признак резидентности"/>
      <column name="t_isqualinvestor" type="number(5)" remarks="Признак квал. инвестора"/>
      <column name="t_date" type="varchar2(10)" remarks="Дата фиксации отрицательного значения НПР2"/>
      <column name="t_time" type="number(5)" remarks="Тип момента времени при фиксации отрицательного значения НПР2"/>
      <column name="t_rcv1" type="number(32,12)" remarks="Сумма НВП1"/>
      <column name="t_rcv2" type="number(32,12)" remarks="Сумма НВП2"/>
      <column name="t_rcv2cohort" type="number(5)" remarks="Группа клиентов по показателю НПВ2"/>
      <column name="t_portfoliovalue" type="number(32,12)" remarks="Стоимость портфеля"/>
      <column name="t_initmargin" type="number(32,12)" remarks="Сумма начальной маржи"/>
      <column name="t_clientcounter" type="number(5)" remarks="Счётчик клиентов"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part2form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart2form725_dbt" remarks="725 форма. Часть 2">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a12" type="number(5)"/>
      <column name="t_a13" type="number(5)"/>
      <column name="t_a14" type="number(5)"/>
      <column name="t_a15" type="number(5)"/>
      <column name="t_a26" type="number(5)"/>
      <column name="t_a27" type="number(5)"/>
      <column name="t_a28" type="number(5)"/>
      <column name="t_a29" type="number(10)"/>
      <column name="t_a210" type="number(10)"/>
      <column name="t_a211" type="number(32,12)"/>
      <column name="t_a212" type="number(32,12)"/>
      <column name="t_a213" type="number(32,12)"/>
      <column name="t_a214" type="number(32,12)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_nonliquidfipositions_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dnonliquidfipositions_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_fikind" type="number(5)" remarks="Вид ФИ"/>
      <column name="t_fiid" type="varchar2(12)" remarks="Код ФИ"/>
      <column name="t_nonqualassec" type="char(1)" remarks="Признак НИФИ"/>
      <column name="t_settledate" type="timestamp" remarks="Дата, за которую получены данные"/>
      <column name="t_currentlimit" type="number(32,12)" remarks="Текущая позиция по инструменту"/>
      <column name="t_settleprice" type="number(32,12)" remarks="Цена, с использованием которой оценивается позиция"/>
      <column name="t_currcode" type="varchar2(4)" remarks="Валюта цены"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_nonilquidfishortpos_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dnonilquidfishortpos_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_partyid" type="varchar2(35)" remarks="Код вида 1 клиента"/>
      <column name="t_clientname" type="varchar2(208)" remarks="Наименование клиента"/>
      <column name="t_contractid" type="varchar2(64)" remarks="Код ДБО клиента"/>
      <column name="t_clienttype" type="number(5)" remarks="Тип клиента"/>
      <column name="t_isresident" type="number(5)" remarks="Признак резидентности"/>
      <column name="t_isqualinvestor" type="number(5)" remarks="Признак квал. инвестора"/>
      <column name="t_rcvstatus" type="number(5)" remarks="Состояние НПР портфеля"/>
      <column name="t_settledate" type="timestamp" remarks="Дата фиксации отрицательной позиции"/>
      <column name="t_initmargin" type="number(32,12)" remarks="Сумма начальной маржи"/>
      <column name="t_rcv1" type="number(32,12)" remarks="Сумма НВП1"/>
      <column name="t_rcv2" type="number(32,12)" remarks="Сумма НВП2"/>
      <column name="t_portfoliovalue" type="number(32,12)" remarks="Стоимость портфеля"/>
      <column name="t_curposition" type="number(32,12)" remarks="Стоимость позиции по инстранной валюте, в руб"/>
      <column name="t_secposition" type="number(32,12)" remarks="Стоимость позиции по ценным бумагам, в руб"/>
      <column name="t_futuresposition" type="number(32,12)" remarks="Стоимость позиции по фьючерсам, в руб"/>
      <column name="t_optionposition" type="number(32,12)" remarks="Стоимость позиции по опционам, в руб"/>
      <column name="t_precmetposition" type="number(32,12)" remarks="Стоимость позиции по драг. металлам"/>
      <column name="t_nonqualassecposition" type="number(32,12)" remarks="Стоимость позиции по НПФИ"/>
      <column name="t_clientcounter" type="number(5)" remarks="Счётчик клиентов"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part3form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart3form725_dbt" remarks="725 форма. Часть 3">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a12" type="number(5)"/>
      <column name="t_a13" type="number(5)"/>
      <column name="t_a14" type="number(5)"/>
      <column name="t_a15" type="number(5)"/>
      <column name="t_a36" type="number(5)"/>
      <column name="t_a37" type="date"/>
      <column name="t_a38" type="number(10)"/>
      <column name="t_a39" type="number(10)"/>
      <column name="t_a310" type="number(32,12)"/>
      <column name="t_a311" type="number(32,12)"/>
      <column name="t_a312" type="number(32,12)"/>
      <column name="t_a313" type="number(32,12)"/>
      <column name="t_a314" type="number(32,12)"/>
      <column name="t_a315" type="number(32,12)"/>
      <column name="t_a316" type="number(32,12)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_clientshortpositions_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dclientshortpositions_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_partyid" type="varchar2(35)" remarks="Код вида 1 клиента"/>
      <column name="t_clientname" type="varchar2(208)" remarks="Наименование клиента"/>
      <column name="t_contractid" type="varchar2(64)" remarks="Код ДБО клиента"/>
      <column name="t_clienttype" type="number(5)" remarks="Тип клиента"/>
      <column name="t_isresident" type="number(5)" remarks="Признак резидентности"/>
      <column name="t_isqualinvestor" type="number(5)" remarks="Признак квал. инвестора"/>
      <column name="t_ficode" type="varchar2(12)" remarks="Биржевой код актива"/>
      <column name="t_fitype" type="number(5)" remarks="Тип актива"/>
      <column name="t_sectype" type="varchar2(5)" remarks="Тип ценной бумаги"/>
      <column name="t_regnumber" type="varchar2(35)" remarks="Регистрационный номер выпуска"/>
      <column name="t_isin" type="varchar2(25)" remarks="Регистрационный номер выпуска"/>
      <column name="t_cfi" type="varchar2(35)" remarks="Код CFI"/>
      <column name="t_currcode" type="varchar2(4)" remarks="Код валюты ц.б."/>
      <column name="t_nominalsum" type="number(32,12)" remarks="Номинальная стоимость ц.б."/>
      <column name="t_emitentname" type="varchar2(320)" remarks="Наименование эмитента"/>
      <column name="t_emitentinn" type="varchar2(35)" remarks="ИНН эмитента"/>
      <column name="t_emitentogrn" type="varchar2(35)" remarks="ОГРН эмитента"/>
      <column name="t_emitentcountrycode" type="varchar2(3)" remarks="Код страды по ОКСМ"/>
      <column name="t_currentbal" type="number(32,12)" remarks="Количество активов"/>
      <column name="t_shortpossum" type="number(32,12)" remarks="Стоимость коротких позиций"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part4form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart4form725_dbt" remarks="725 форма. Часть 4">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a12" type="number(5)"/>
      <column name="t_a13" type="number(5)"/>
      <column name="t_a14" type="number(5)"/>
      <column name="t_a15" type="number(5)"/>
      <column name="t_a46" type="number(5)"/>
      <column name="t_a47" type="varchar2(75)"/>
      <column name="t_a48" type="number(10)"/>
      <column name="t_a49" type="number(10)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part41form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart41form725_dbt" remarks="725 форма. Часть 4.1">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a412" type="varchar2(60)"/>
      <column name="t_a413" type="varchar2(5)"/>
      <column name="t_a414" type="varchar2(35)"/>
      <column name="t_a415" type="varchar2(25)"/>
      <column name="t_a416" type="varchar2(35)"/>
      <column name="t_a417" type="varchar2(4)"/>
      <column name="t_a418" type="number(32,12)"/>
      <column name="t_a419" type="varchar2(320)"/>
      <column name="t_a4110" type="varchar2(35)"/>
      <column name="t_a4111" type="varchar2(35)"/>
      <column name="t_a4112" type="varchar2(3)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_forcedclosuredeals_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dforcedclosuredeals_dbt">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_clientcode" type="varchar2(12)" remarks="ЕКК клиента"/>
      <column name="t_firmid" type="varchar2(12)" remarks="Код фирмы"/>
      <column name="t_partyid" type="varchar2(35)" remarks="Код вида 1 клиента"/>
      <column name="t_clientname" type="varchar2(208)" remarks="Наименование клиента"/>
      <column name="t_contractid" type="varchar2(64)" remarks="Код ДБО клиента"/>
      <column name="t_clienttype" type="number(5)" remarks="Тип клиента"/>
      <column name="t_isresident" type="number(5)" remarks="Признак резидентности"/>
      <column name="t_isqualinvestor" type="number(5)" remarks="Признак квал. инвестора"/>
      <column name="t_cohort" type="number(5)" remarks="Группа клиентов по объёму сделок"/>
      <column name="t_date" type="date" remarks="Дата заключения сделки"/>
      <column name="t_dealdirection" type="varchar2(7)" remarks="Направление сделки"/>
      <column name="t_assetkind" type="number(5)" remarks="Вид инструмента сделки"/>
      <column name="t_assetamount" type="number(32,12)" remarks="Количество ФИ по сделке"/>
      <column name="t_dealprice" type="number(32,12)" remarks="Цена по сделке"/>
      <column name="t_coupon" type="number(32,12)" remarks="Сумма НКД долговой ц/б"/>
      <column name="t_dealpricecurrency" type="number(32,12)" remarks="Валюта цены"/>
      <column name="t_tick" type="number(32,12)" remarks="Минимальный шаг цены"/>
      <column name="t_tickprice" type="number(32,12)" remarks="Стоимость мин. шага цены"/>
      <column name="t_dealvalue" type="number(32,12)" remarks="Объём сделки"/>
      <column name="t_clientcounter" type="number(5)" remarks="Счётчик клиентов"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545_create_part5form725_dbt" context="prod" author="Shvetsov">
    <createTable tableName="dpart5form725_dbt" remarks="725 форма. Часть 5">
      <column name="t_sessionid" type="number(10)" remarks="Идентификатор сессии"/>
      <column name="t_a12" type="number(5)"/>
      <column name="t_a13" type="number(5)"/>
      <column name="t_a14" type="number(5)"/>
      <column name="t_a15" type="number(5)"/>
      <column name="t_a56" type="number(5)"/>
      <column name="t_a57" type="date"/>
      <column name="t_a58" type="number(10)"/>
      <column name="t_a59" type="number(10)"/>
      <column name="t_a510" type="number(10)"/>
      <column name="t_a511" type="number(32,12)"/>
      <column name="t_a512" type="number(32,12)"/>
      <column name="t_a513" type="number(32,12)"/>
      <column name="t_a514" type="number(32,12)"/>
      <column name="t_a515" type="number(32,12)"/>
      <column name="t_a516" type="number(32,12)"/>
      <column name="t_a517" type="number(32,12)"/>
      <column name="t_a518" type="number(32,12)"/>
      <column name="t_a519" type="number(32,12)"/>
      <column name="t_a520" type="number(32,12)"/>
    </createTable>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_depolimitsjournal" author="Shvetsov">
    <addColumn tableName="ddepolimitsjournal_dbt">
      <column name="t_currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_sofr_depolimitsjournal" author="Shvetsov">
    <addColumn tableName="sofr_depolimitsjournal">
      <column name="currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_futoptlimitsjournal" author="Shvetsov">
    <addColumn tableName="dfutoptlimitsjournal_dbt">
      <column name="t_currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
      <column name="t_settlepricecurrcode" type="varchar2(4)" remarks="Валюта цены"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_sofr_futuresholdingjournal" author="Shvetsov">
    <addColumn tableName="sofr_futuresholdingjournal">
      <column name="currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
      <column name="settlepricecurrcode" type="varchar2(4)" remarks="Валюта цены"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_moneylimitsjournal" author="Shvetsov">
    <addColumn tableName="dmoneylimitsjournal_dbt">
      <column name="t_currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545-alter_table_sofr_moneylimitsjournal" author="Shvetsov">
    <addColumn tableName="sofr_moneylimitsjournal">
      <column name="currentlimit" type="number(28,8)" remarks="Текущий лимит"/>
    </addColumn>
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_depolimitsjournal" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('ddepolimitsjournal_dbt') and column_name = upper('t_shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="ddepolimitsjournal_dbt" columnName="t_shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_sofr_depolimitsjournal" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('sofr_depolimitsjournal') and column_name = upper('shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="sofr_depolimitsjournal" columnName="shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_dfutoptlimitsjournal_dbt" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('dfutoptlimitsjournal_dbt') and column_name = upper('t_shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="dfutoptlimitsjournal_dbt" columnName="t_shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_sofr_futuresholdingjournal" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('sofr_futuresholdingjournal') and column_name = upper('shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="sofr_futuresholdingjournal" columnName="shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_dmoneylimitsjournal_dbt" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('dmoneylimitsjournal_dbt') and column_name = upper('t_shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="dmoneylimitsjournal_dbt" columnName="t_shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_sofr_moneylimitsjournal" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('sofr_moneylimitsjournal') and column_name = upper('shortdiscount')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="sofr_moneylimitsjournal" columnName="shortdiscount"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_dmoneylimitsjournal_dbt_curr" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('dmoneylimitsjournal_dbt') and column_name = upper('t_currcode')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="dmoneylimitsjournal_dbt" columnName="t_currcode"/>      
  </changeSet>

  <changeSet id="AVT_BOSS-545_drop_constraint_sofr_moneylimitsjournal_curr" author="Shvetsov">
    <preConditions onFail="MARK_RAN">
      <sqlCheck expectedResult="N">
        select nullable from user_tab_columns where table_name = upper('sofr_moneylimitsjournal') and column_name = upper('currcode')
      </sqlCheck>
    </preConditions>

    <dropNotNullConstraint tableName="sofr_moneylimitsjournal" columnName="currcode"/>      
  </changeSet>

</databaseChangeLog>