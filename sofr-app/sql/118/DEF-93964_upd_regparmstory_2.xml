<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
                            http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">

    <changeSet id="DEF-93964_upd_regparmstory_2" author="SennikovIV">
        <update tableName="dregparmstory_dbt">
            <column name="T_DATEEND" valueDate="2024-12-31"/>
            <where> T_KEYID = (select t_keyid 
                                  from dregparm_dbt 
                                 where t_parentid = (SELECT t_keyid
                                                       from (select p.t_keyid,SYS_CONNECT_BY_PATH(p.t_name, '/') Path
                                                               from dregparm_dbt p
                                                            connect by prior p.t_keyid=p.t_parentid start with p.t_parentid=0)
                                                      where Path='/COMMON/НДФЛ')
                                                        and t_name = 'АВТО_ЗАМЕНА_КОДОВ_ДОХОДОВ_INTR' )
                AND (T_BOOLVALUE != CHR(88) OR T_BOOLVALUE IS NULL)
            </where>
        </update>
    </changeSet>
</databaseChangeLog>