<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.6.xsd
    http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.6.xsd ">
  <changeSet id="120_BOSS-2229_delete_regval" author="Zhits">
    <delete tableName="dregval_dbt">
      <where>t_KeyId = (SELECT t_keyid 
                          FROM dregparm_dbt 
                         WHERE t_parentid = (SELECT t_keyid                                               
                                               FROM (SELECT p.t_keyid,SYS_CONNECT_BY_PATH(p.t_name, '/') Path                                     
                                                       FROM dregparm_dbt p, dregval_dbt v 
                                                      WHERE v.t_keyid=p.t_keyid and v.t_objectid=0                       
                                                    connect by prior p.t_keyid=p.t_parentid start with p.t_parentid=0)                                 
                                              WHERE Path='/РСХБ/БРОКЕРСКОЕ ОБСЛУЖИВАНИЕ')
                           AND t_name = 'ВЕДЕНИЕ_ВУ_ПРОЧАЯ_ЗАДОЛЖЕННОСТЬ')</where>
    </delete>
    <delete tableName="dregparm_dbt">
      <where>t_ParentId = (select t_keyid from (select p.t_keyid,SYS_CONNECT_BY_PATH(p.t_name, '/') Path
                                                  from dregparm_dbt p
                                               connect by prior p.t_keyid=p.t_parentid start with p.t_parentid=0)
                            where Path='/РСХБ/БРОКЕРСКОЕ ОБСЛУЖИВАНИЕ')
             and t_Name = 'ВЕДЕНИЕ_ВУ_ПРОЧАЯ_ЗАДОЛЖЕННОСТЬ'</where>
    </delete>
  </changeSet> 
</databaseChangeLog>