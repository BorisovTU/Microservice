//макрос плановой процедуры
import mb_load;

/*
Ответ макроса плановой процедуры
*/
class TSsExecutionResult
   var processState: integer;
/*  возможные значения
    RESPONSE_REPEAT_OK = 0;
    RESPONSE_REPEAT_ERROR = 1;
    RESPONSE_NEXT = 2; перейти к выполнению следующей функции
    RESPONSE_END = 3;
    RESPONSE_FATAL = 4; фатальная ошибка остановить выполнение процедуры
*/
   var errorNumber: integer;
   var errorTex: string;
end;

var Result = TSsExecutionResult;
    Result.processState = 2;

//принимает номер попытки, параметры для функции,параметры процедуры


//прием файлов Московской биржи
macro p_LoadMB(attempt, funcparm, procparam)
    LoadMB();
    return Result;
end;

//прием файлов Валютного рынка
macro p_LoadCM(attempt, funcparm, procparam)
    LoadCM();
    return Result;
end;




//распаковка файлов Срочного рынка
macro p_UnZipFM(attempt, funcparm, procparam)
    UnZipFM();
    return Result;
end;


//прием файлов Срочного рынка
macro p_LoadFM(attempt, funcparm, procparam)
    LoadFM();
    return Result;
end;



//прием файлов биржи СПБ
macro p_LoadSPB(attempt, funcparm, procparam)

    UnZipSpb();

    LoadSPB();
    return Result;
end;
