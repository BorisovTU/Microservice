/*voikin 23.04.2014*/
const Path = "Настройки инициализации\\Каталоги\\LOGSDIR";

macro test

  var q = TRslOraQuery();
  var val = "";

  if(Valtype(q)==V_UNDEF)
      runerror(ToAnsi("Ошибка GetSetupValue: Не создан класс TRslOraQuery"));
  end;

  q.SqlText = "begin :val := RSP_Setup.Get_Value(:Path); end;";
  q.DeclareAndSet("val",val,"Path",Path);
  if(NOT q.Execute())
      runerror(ToAnsi("Ошибка GetSetupValue: "+q.Error + ". Параметры: " + Path));
  end;

  val = q.GetVariable("val");

  println("Значение настройки '"+Path+"' = '"+val+"'");


end;