Import PTInter, RSD;

const PTSK_REPOSHORTNAME = 14;

macro UL_GetRepoPseudonim(PartyID : integer) : string

  if(PartyID > 0)
    var arrNames : TArray = GetPartyNames(PartyID, PTSK_REPOSHORTNAME, false);
    if(arrNames.size > 0)
      return arrNames[0];
    end;
  end;

  return "";
end;


macro UL_setPseudonim(PartyID, name)
    var cmd;

    cmd = RSDCommand("DELETE FROM dpartyname_dbt WHERE t_PartyID = ? AND t_NameTypeID = ?");
    cmd.addParam("", RSDBP_IN, partyID);
    cmd.addParam("", RSDBP_IN, PTSK_REPOSHORTNAME);
    cmd.execute();

    cmd = RSDCommand("INSERT INTO dpartyname_dbt (t_PartyID, t_Name, t_NameTypeID) values(?, ?, ?)");
    cmd.addParam("", RSDBP_IN, partyID);
    cmd.addParam("", RSDBP_IN, name   );
    cmd.addParam("", RSDBP_IN, PTSK_REPOSHORTNAME);
    cmd.execute();
    
  end;