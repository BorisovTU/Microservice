import RsbObjFactory, "or_rep_h.mac", globals;

var Table = 
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥       äÆ§       ≥   Ñ†‚†    ≥ äÆ´®Á•·‚¢Æ ≥   Å†´†≠·Æ¢†Ô   ≥      çäÑ       ≥   çÆ¨•‡ ã/ëÁ•‚† çäÑ   ≥      Ç®§/äÆ§      ≥   Ñ†‚†   ≥    ñ•´Ï    ≥    äÆ§   ≥                         ≥                         ≥   ë„¨¨†    ≥   ë„¨¨†    ≥\n"+
"≥  Ê•≠≠Æ© °„¨†£®  ≥  Æ·‚†‚™†  ≥            ≥    ·‚Æ®¨Æ·‚Ï   ≥   „Ø´†Á•≠≠Î©   ≥                       ≥ ÆØ•‡†Ê®® ØÆ·‚†¢™® ≥ ØÆ·‚†¢™® ≥Ø‡®Æ°‡•‚•≠®Ô≥  ¢†´Ó‚Î  ≥     çÆ¨•‡ ã/ëÁ•‚†       ≥  çÆ¨•‡ ã/ëÁ•‚† ‡•ß•‡¢†  ≥ ·Æß§†≠≠Æ£Æ ≥ ‡†·Á•‚≠Æ£Æ ≥\n"+
"≥                 ≥           ≥            ≥                ≥                ≥                       ≥                   ≥          ≥            ≥ ≠Æ¨®≠†´† ≥                         ≥                         ≥    êÇè     ≥    êÇè     ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ¥";

var Rep = CMakeReport(Table);

const FontStyleTitel =  "ex_FS(b)";

macro IsNULL( str )
   if( str != NULL )
      return str;
   else
      return " ";
   end;
end;

macro IsNULLSum( str )
   if( (str != NULL) and (str > 0) )
      return str;
   else
      return " ";
   end;
end;

macro PrintAvoirissBalance(Obj)

   Rep.AddPrintCell( IsNull(Obj.FI_Code),                    0, 0, "l:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.ReportDate),                 0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.Amount),                     0, 0, "r");
   Rep.AddPrintCell( IsNull(Obj.BalanceCost),                0, 4, "r");
   Rep.AddPrintCell( IsNull(Obj.PaydNKD),                    0, 4, "c");
   Rep.AddPrintCell( IsNull(Obj.NKDAccountNumber),           0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.BuyKind + "-" + Obj.BuyCode),0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.BuyDate),                    0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.BuyGoalStr),                 0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.FaceValueFICode),            0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.AccountNumber),              0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.ReserveAccountNumber),       0, 0, "c");
   Rep.AddPrintCell( IsNullSum(Obj.CreatedReserve),          0, 4, "c");
   Rep.AddPrintCell( IsNullSum(Obj.CalculatedReserve),       0, 4, "c");
   Rep.AddStr();
       
end;


var Factory = RsbObjectFactory();

var Object = Factory.GetObject("RSCOMAvoirissBalance");
var bRes, DateRep = {CurDate};
var Num = 0;

   if( not GetDate(DateRep, "Ç¢•§®‚• §†‚„"))
      DateRep = {CurDate};
   end;


   Object.SetParmValue("BeginDate", DateRep);
   Object.SetParmValue("EndDate", DateRep);
   Object.SetFilter( " BuyDate <= " + DateRep );
   Object.ApplyFilter();

   bRes = Object.Next();

   Rep.AddPrintCell( "Ñ†‚†: " + DateRep, Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();

   while(bRes)
      PrintAvoirissBalance(Object);
      bRes = Object.Next();
      Num = Num + 1;
   end;

   Rep.AddPrintCell( "Ç·•£Æ: " + String(Num), Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();

   
   Rep.PrintWinRep();
   Rep.ShowWinRep();

