import RsbObjFactory, "or_rep_h.mac", globals;

var Table = 
"ÚÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ¿\n"+
"³   ’¨¯   ³       Š®¤        ³       Š®¤       ³   ’¨¯   ³       Š®¤        ³   „ â    ³   Š®¤    ³   „ â    ³   ‘¯¨á ­®¥     ³   ‘¯¨á ­ ï     ³Š®¤ ¢ «îâë³ Š„ ã¯« ç¥­­ë© ³    ‘¯¨á ­ ï    ³  Š„ ¯®«ãç¥­­ë©  ³   ‘¯¨á ­ ï     ³Š®¤ ¢ «îâë³\n"+
"³ ®¯¥à æ¨¨³     ®¯¥à æ¨¨     ³  æ¥­­®© ¡ã¬ £¨  ³ ®¯¥à æ¨¨³     ®¯¥à æ¨¨     ³ ¯®áâ ¢ª¨ ³  ¢ «îâë  ³ á¯¨á ­¨ï ³ ª®«¨ç¥áâ¢® æ/¡ ³   áâ®¨¬®áâì    ³   æ¥­ë   ³                ³   ¡ « ­á®¢ ï   ³                  ³   áâ®¨¬®áâì    ³   æ¥­ë   ³\n"+
"³ á¯¨á ­¨ï³     á¯¨á ­¨ï     ³                 ³ ¯®áâ ¢ª¨³     ¯®áâ ¢ª¨     ³          ³ ­®¬¨­ «  ³          ³                ³ ¯®ªã¯ª¨ ¡¥§ Š„³  ¯®ªã¯ª¨ ³                ³   áâ®¨¬®áâì    ³                  ³ ¯à®¤ ¦¨ ¡¥§ Š„³  ¯à®¤ ¦¨ ³\n"+
"ÃÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄ´";

var Rep = CMakeReport(Table);

const FontStyleTitel =  "ex_FS(b)";

macro IsNULL( str )
   if( str != NULL )
      return str;
   else
      return " ";
   end;
end;

macro IsNULLSum( str )
   if( (str != NULL) and (str > 0) )
      return str;
   else
      return " ";
   end;
end;

macro PrintAvoirissSale(obj)

   Rep.AddPrintCell( IsNull(Obj.BuyKind),                      0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.BuyCode),                      0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.FI_Code),                      0, 0, "l:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.SaleKind),                     0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.SaleCode),                     0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.BuyDate),                      0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.FaceValueFICode),              0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.SaleDate),                     0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.SaleAmount),                   0, 0, "r");
   Rep.AddPrintCell( IsNull(Obj.BuyCost),                      0, 4, "r");
   Rep.AddPrintCell( IsNull(Obj.BuyPriceFICode),               0, 0, "c");
   Rep.AddPrintCell( IsNullSum(Obj.BuyNKD),                    0, 4, "r");
   Rep.AddPrintCell( IsNull(Obj.BalanceCost),                  0, 4, "r");
   Rep.AddPrintCell( IsNullSum(Obj.SaleNKD),                   0, 4, "r");
   Rep.AddPrintCell( IsNull(Obj.SaleCost),                     0, 4, "r");
   Rep.AddPrintCell( IsNull(Obj.SalePriceFICode),              0, 0, "c");
   Rep.AddStr();

end;



var Factory = RsbObjectFactory();

var Object = Factory.GetObject("RSCOMAvoirissSale");
var bRes, DateRep = {CurDate};
var Num = 0;


   if( not GetDate(DateRep, "‚¢¥¤¨â¥ ¤ âã"))
      DateRep = {CurDate};
   end;


   Object.SetParmValue("BeginDate", DateRep);
   Object.SetParmValue("EndDate", DateRep);
   Object.ApplyFilter();
   InitProgress( 1, "‚ë¯®«­¥­¨¥...", "‚ë¯®«­¥­¨¥..." );
   Rep.AddPrintCell( "„ â : " + DateRep, Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();

   bRes = Object.Next();
   while(bRes)
      PrintAvoirissSale(Object);
      bRes = Object.Next();
      Num = Num + 1;
      UseProgress(Num);
   end;
   RemProgress();
   Rep.AddPrintCell( "‚á¥£®: " + String(Num), Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();

   
   Rep.PrintWinRep();
   Rep.ShowWinRep();

