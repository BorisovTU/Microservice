import RsbObjFactory, "or_rep_h.mac", globals;

var Table = "⁄ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒø\n"+
            "≥     äÆ§    ≥     Ñ†‚†     ≥   î†™‚®Á•·™†Ô ≥  Ç®§   ≥       äÆ§       ≥ç†Ø‡†¢´•≠®•≥   äÆ§    ≥      ë„¨¨†      ≥ î®´®†´ ≥\n"+
            "≥  ÆØ•‡†Ê®®  ≥   ÆØ•‡†Ê®®   ≥      §†‚†     ≥ †™‚®¢† ≥   ‰®≠†≠·Æ¢Æ£Æ   ≥ ®‚Æ£Æ¢Æ£Æ ≥  ¢†´Ó‚Î  ≥                 ≥        ≥\n"+
            "≥            ≥              ≥(¢†´Ó‚®‡Æ¢†≠®Ô)≥        ≥   ®≠·‚‡„¨•≠‚†   ≥  Ø´†‚•¶†  ≥ ÆØ•‡†Ê®® ≥                 ≥        ≥\n"+
            "√ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒ¥";

var Rep = CMakeReport(Table);

const FontStyleTitel =  "ex_FS(b)";


macro IsNULL( str )
   if( str != NULL )
      return str;
   else
      return " ";
   end;
end;

macro IsNULLSum( str )
   if( str > 0 )
      return str;
   else
      return " ";
   end;
end;


macro PrintWarrants(Obj)
  var FI_Kind;

  if( Obj.FI_Kind == 2 )
     FI_Kind = "ñÅ";
  else
     FI_Kind = "¢†´Ó‚†";
  end;

   Rep.AddPrintCell( IsNull(Obj.Code),             0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.Date),             0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.ValueDate),        0, 0, "c");
   Rep.AddPrintCell( FI_Kind,                      0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.FI_Code),          0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.Direction),        0, 0, "c");
   Rep.AddPrintCell( IsNull(Obj.OperFICode),       0, 0, "c:"+FontStyleTitel);
   Rep.AddPrintCell( IsNull(Obj.Amount),           0, 2, "r");
   Rep.AddPrintCell( IsNull(Obj.Department),       0, 0, "c");
   Rep.AddStr();
end;



var Factory = RsbObjectFactory();

var Object = Factory.GetObject("RSCOMNetting");
var bRes, DateRep = {CurDate};
var Num = 0;

   if( not GetDate(DateRep, "Ç¢•§®‚• §†‚„"))
      DateRep = {CurDate};
   end;

   Object.SetParmValue("BeginDate", DateRep);
   Object.SetParmValue("EndDate", DateRep);
   Object.ApplyFilter();


   Rep.AddPrintCell( "Ñ†‚†: " + DateRep, Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();
   
   bRes = Object.Next();
   while(bRes)
      PrintWarrants(Object);
      bRes = Object.Next();
      Num = Num + 1;
   end;

   Rep.AddPrintCell( "Ç·•£Æ: " + String(Num), Rep.GetHeaderWidth(), 0, "l:"+FontStyleTitel, REP_ELEM_STR);
   Rep.AddStr();

   
   Rep.PrintWinRep();
   Rep.ShowWinRep();

