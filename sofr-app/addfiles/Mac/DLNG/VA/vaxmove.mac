/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vaxmove.mac
                                va-вексель
                                 x-операция мены векселей (bart)
                               060-номер (соответствующий шагу)
  Programmer  : Чижик К.Н.
  Операция    : Мена векселей
  Comment     : Переносить по срокам? (вынесено в vatransf.mac)
└───────────────────────────────────────────────────────────────────────────*/
IMPORT vatransf;

/* Действия шага выбора (В пункты 2 и 3 добавлена доплата)
   Алгоритм:
   1.  Если Дуч - Дс < 3 рабочих дней,  то: Выход по "Нет".
   2.  ТекущийДиапазонСрочности = min (диапазон срочности текущего счета 
       категории "+Форвард, дрейф" (роль "требование"); 
       диапазон срочности текущего счета категории "-Форвард, дрейф" 
       (роль "обязательство").
       Если ТекущийДиапазонСрочности = 1 
       // т.е. это самый нижний диапазон срочности,
       то: Выход по "Нет"
   3.  Dок_п = max (Дата окончания предыдущего периода срочности для 
       текущего счета категории "+Форвард, дрейф" (роль "требование"), 
       вычисленная относительно текущей даты; 
       Дата окончания предыдущего периода срочности для текущего счета 
       категории "-Форвард, дрейф"(роль "обязательство"), 
       вычисленная относительно текущей даты).
     
       Проинициализировать дату Dпер =  (Текущая дата + (Dуч - Dок_п)). 
       Полученная дата должна попадать на рабочий день 
       (для вычисления значения использовать стандартные средства).

       Примечание. Аналогичный алгоритм реализован в операции покупки-продажи 
       ц/б в БО Ц/б.
       Выход по "Да"
*/

MACRO NeedMoveByBart( tick, NoStep, YesStep, StepDate )
   return VA_NeedMoveByUrgency( tick, NoStep, YesStep, StepDate );
END;
