/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vasf_a15.mac
  Programmer  : Азаренок Ю.Г.
  Comment     : Комиссия банку с клиента по сделкам с векселями.
└───────────────────────────────────────────────────────────────────────────*/
Import SFInter, va4each, vasflib;

const
    REG_INT_TYPE = 500;

/* Получить базовую сумму для расчета комиссии
       docKind - Тип перв.документа
           Doc - Буфер перв.документа
 sfcalcalusr_a - Алгоритм расчета
     sfcontr_a - Договор обслуживания
*/
macro CalcCommissionSum( docKind, Doc, sfcalcalusr_a, sfcontr_a )
var
    no = 0,
    comiss = TRecHandler( "sfcomiss.dbt" );

    record tick ("dl_tick");
    record alg ("sfcalcal");
    SetBuff( tick, Doc );
    SetBuff( alg, sfcalcalusr_a );

    if(SfCalcAlGetUserParm(alg, "ВИД АЛГОРИТМА", REG_INT_TYPE, no) != 0)
      no = 0;
    end;

    if((no == 0) and SfGetComiss( alg.FeeType, alg.Number, comiss ))
       vasf_1(tick, comiss.rec.Fiid_Comm);
    end;

end;

