/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vafcheck.mac
                                va-вексель
                                 f-операция мены векселей УВ<->СВ

  Programmer  : Чижик К.Н.
  Операция    : Мена векселей УВ<->СВ
  Шаг         : 
  Comment     : Проверки в макросе первичного документа.
└───────────────────────────────────────────────────────────────────────────*/
IMPORT PaymInter, globals, valib, va4each, vaxcheck, vamisc;
       
PRIVATE VAR Currency, VeksNum;

/*
   Для события "начало операции":
   1. Проверить заполнение обязательных атрибутов сделки.
   2. Если в сделке указан способ расчетов "платежи", то 
      счет плательщика платежа по контрактиву должен быть 
      указан не в нашем банке.
   3. Если в сделке указан способ расчетов "безакцептное списание", 
      то счет плательщика платежа по контрактиву должен быть указан 
      в нашем банке.
   4. Если существует платеж по оплате разницы, то проверить, 
      что плановая дата платежа задана и она не меньше дат 
      поставки векселей по требованиям и обязательствам.
   5. Цена всех передаваемых векселей должна быть выражена в одной валюте.
   6. Цена всех принимаемых векселей должна быть выражена в одной валюте.
   7. Дата поставки принимаемых и передаваемых векселей совпадает.
   8. Клиент в сделке не указан. В противном случае сообщение об ошибке
      "Операция не поддерживает сделки для клиента".
*/

/* Проверки для мены УВ<->СВ
*/
MACRO VA_CheckXFDeal_StartOpr( УВДоговор )

   /* 1-7 */
   if(VA_CheckBarterDeal_StartOpr(УВДоговор))
      return 1;
   end;

   /* 8 */
   if(VA_IsClient(УВДоговор))
      /* клиент указан */
      MsgBox("Операция не поддерживает сделки для клиента.");
      return 1;
   end;

   return 0;
END;
