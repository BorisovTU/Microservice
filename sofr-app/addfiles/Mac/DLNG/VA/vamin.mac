/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vamin.mac
  Comment     : Библиотека функций модуля "Учтенные векселя",
                которой не нужны другие модули.
└───────────────────────────────────────────────────────────────────────────*/
/* IMPORT Задумайтесь, если вы собираетесь раскоментарить это*/

/* Возвращает первый плановый платеж
*/
MACRO Get1stPlanPaym(DocKind, DocID, Purpose, payms)
var 
    Ok;

    payms.KeyNum = 1;
    payms.rec.DocKind = DocKind;
    payms.rec.DocumentID = DocID;
    payms.rec.Purpose = Purpose;
    payms.rec.SubPurpose = 0;
    Ok = payms.GetGE;

    while(Ok) 
      if((payms.rec.DocKind != DocKind) OR
         (payms.rec.DocumentID != DocID) OR
         (payms.rec.Purpose != Purpose))
         /* пошли уже не наши платежи */
         return false;
      end;

      if(payms.rec.IsPlanPaym == "X")
         return true;
      else
         Ok = payms.next; /* ищем дальше */
      end;

    end;

    return false;
END;


