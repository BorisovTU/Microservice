/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : va_ground.mac
  Programmer  : Свириденко A.И.
  Comment     : макрас оснований проводок
└───────────────────────────────────────────────────────────────────────────*/

// IMPORT
CONST 
      УВПереводДС                = 1, /*Перевод денежных средств*/
      УВПереводДСБиржа           = 2, /*Перевод денежных средств на биржу*/
      УВПереводДСБрокер          = 3, /*Перевод денежных средств брокеру*/
      УВВозвратДСБиржа           = 4, /*Возврат денежных средств с биржи*/
      УВВозвратДСБрокер          = 5, /*Возврат денежных средств от брокера*/
      УВПриемДСотКл              = 6, /*Прием от клиента денежных средств*/
      УВВозвратДСКл              = 7, /*Возврат клиенту денежных средств*/
      УВОплатаКомБанк            = 8, /*Оплата комиссии банку*/
      УВОплатаКомБиржа           = 9, /*Оплата комиссии бирже*/
      УВОплатаКомБрокер          = 10, /*Оплата комиссии брокеру*/
      УВОплатаДепозКом           = 11, /*Оплата депозитарной комиссии*/
      УВОплатаКомПоср            = 12, /*Оплата комиссии посреднику*/
      УВОплатаКомБанкИД          = 13, /*Оплата комиссии банку по итогам дня*/
      УВОплатаКомПосрИД          = 14, /*Оплата комиссии посреднику по итогам дня*/
      УВОплатаКомВекс            = 15, /*Оплата комиссии векселедателю*/
      УВОплатаУслуг              = 16, /*Оплата информационных и консультационных услуг*/
      УВНалогФЛ                  = 17, /*Удержание налога на доходы физ.лиц*/
      УВПереводГО                = 18, /*Перевод гарантийного обеспечения*/
      УВВозвратГО                = 19, /*Возврат гарантийного обеспечения*/
      УВОплатаЦБ                 = 20, /*Оплата ценных бумаг*/
      УВОплатаАванса             = 21, /*Оплата аванса/задатка*/
      УВПолучКупонДох            = 22, /*Получение купонного дохода*/
      УВПолучСумПогаш            = 23, /*Получение суммы погашения*/
      УВПолучДивиденд            = 24, /*Получение дивидендов*/
      УВВозвратКупонДох          = 25, /*Возврат купонного дохода*/
      УВВыплПроцЗайм             = 26, /*Выплата процентов по займу ценных бумаг*/
      УВОплатаРазницы            = 27, /*Оплата разницы стоимости ценных бумаг*/
      УВОплатаВарМаржи           = 28, /*Оплата вариационной маржи*/
      УВОплатаПремий             = 29, /*Оплата премий*/
      УВПереводЦБ                = 50, /*Перевод ценных бумаг*/
      УВПереводЦББиржа           = 51, /*Перевод ценных бумаг на биржу*/
      УВПереводЦББрокер          = 52, /*Перевод ценных бумаг брокеру*/
      УВВозвратЦББиржа           = 53, /*Возврат ценных бумаг с биржи*/
      УВВозвратЦББрокер          = 54, /*Возврат ценных бумаг от брокера*/
      УВПоставкаЦБ               = 55, /*Поставка ценных бумаг*/
      УВПогашениеЦБ              = 56, /*Погашение ценных бумаг*/
      УВЗачислЦБКонв             = 57, /*Зачисление ценных бумаг при конвертации*/
      УВСписаниеЦБКонв           = 58, /*Списание ценных бумаг при конвертации*/
      УВПриемЦБКлиент            = 59, /*Прием от клиента ценных бумаг*/
      УВВозвратЦБКлиент          = 60, /*Возврат клиенту ценных бумаг*/
      УВПолучИнвПаев             = 61, /*Получение инвестиционных паев*/
      УВПередачаЦБЗаем           = 62, /*Передача ценных бумаг в заем*/
      УВВозвратЦБЗаем            = 63, /*Возврат ценных бумаг из займа*/
      УВПередачаЦБЗалог          = 64, /*Передача ценных бумаг в залог*/
      УВВозвратЦБЗалог           = 65, /*Возврат ценных бумаг из залога*/
      УВПередЦБФилиал            = 66, /*Передача ценных бумаг на баланс филиала*/
      УВПриемЦБизФилиал          = 67, /*Прием ценных бумаг на баланс из филиала*/
      УВЗачислЦБОснВып           = 68, /*Зачисление ценных бумаг основного выпуска*/
      УВСписанЦБДопВып           = 69, /*Списание ценных бумаг аннулируемого дополнительного выпуска*/
      УВПокупСрочКонтр           = 70, /*Покупка срочных контрактов*/
      УВПродСрочКонтр            = 71, /*Продажа срочных контрактов*/
      УВИсполнСрокКонтр          = 72, /*Исполнение срочных контрактов*/
      УВСписанСрочКонтр          = 73, /*Списание закрытых срочных контрактов*/
      УВПриемЦБМена              = 74, /*Прием векселей по операции мены*/
      УВПередачаЦБМена           = 75; /*Передача векселей по операции мены*/
      
      
      


CONST VA_GRNUM_SBAY_EENG      =  0, /*"Оплата ц/б сделки покупки"*/   
      VA_GRNUM_SBAY_EREQ      =  1, /*"Поставка ц/б сделки покупки"*/
      VA_GRNUM_SSEL_EENG      =  2, /*"Поставка ц/б по сделке продажи"*/ 
      VA_GRNUM_SSEL_EREQ      =  3, /*"Оплата ц/б по сделке продажи"*/     
      VA_GRNUM_SBAY_PAYMCL_COMIS =  4, /*Оплата комиссии банку по сделке покупки ц/б*/           
      VA_GRNUM_SBAY_PAYM_BLNK    =  5, /*Оплата комиссии за бланки по сделке покупки ц/б*/           
      VA_GRNUM_SSEL_PAYMCL_COMIS =  6, /*Оплата комиссии банку по сделке продажи*/           
      VA_GRNUM_SREPAY         =  7, /*Зачисление средств в операции погашения*/           
      VA_GRNUM_SPAWN_TR       =  8, /*Передача ц/б в залог по операции*/
      VA_GRNUM_SPAWN_BTR      =  9, /*Возврат ц/б из залога по операции*/
      VA_GRNUM_SEXCH_PAYM_BLNK      =  10, /*Оплата комиссии за бланки по операции мены*/
      VA_GRNUM_SEXCH_PAYMCL_COMIS     =  11, /*Оплата комиссии банку по операции мены*/
      VA_GRNUM_SREPAY_PAYMCL_COMIS    =  12, /*Оплата комиссии банку в операции погашения*/
      VA_GRNUM_SEXCH_VAVA_EENG        =  13, /*Передача векселей по операции мены*/
      
      VA_GRNUM_SREPAY_EREQ            =  14, /*Списание ц/б в операции погашения*/
      VA_GRNUM_SEXCH_VAVA_EREQ        =  15, /*Прием векселей по операции мены*/
      VA_GRNUM_SEXCH_VAOV_EENG        =  16, /*Передача векселей по операции мены*/
      VA_GRNUM_SEXCH_OVVA_EREQ        =  17, /*Получение векселей по операции мены*/
      VA_GRNUM_SEXCH_DIFPAYM_PAY_REST = 18, /**/
      VA_GRNUM_SEXCH_DIFPAYM_CONTR_PAY= 19, /**/
      VA_GRNUM_SENROLMENT             = 20, /*Прием на баланс ц/б из филиала по операции*/
      VA_GRNUM_SENROLMENT_CL          = 21, /*Получение ц/б от клиента по операции*/
      VA_GRNUM_SRETIREMENT            = 22, /*Передача ц/б на баланс филиала по операции*/
      VA_GRNUM_SRETIREMENT_CL         = 23; /*Возврат ц/б клиенту по операции*/
      

CLASS VA_GroundsClass()

   PRIVATE var GroundArray; 

   PRIVATE MACRO Init()
      GroundArray = TArray();      
      GroundArray[VA_GRNUM_SBAY_EREQ]   =  "Поставка ц/б сделки покупки";
      GroundArray[VA_GRNUM_SSEL_EREQ]   =  "Оплата ц/б по сделке продажи";
      

      // Оплата бланков      
      GroundArray[VA_GRNUM_SBAY_PAYM_BLNK]   =  "Оплата комиссии за бланки по сделке покупки ц/б";
      GroundArray[VA_GRNUM_SEXCH_PAYM_BLNK]    ="Оплата комиссии за бланки по операции мены";
      
      // Оплата комиссий
      GroundArray[VA_GRNUM_SSEL_PAYMCL_COMIS]=  "Оплата комиссии банку по сделке продажи";
      GroundArray[VA_GRNUM_SBAY_PAYMCL_COMIS]=  "Оплата комиссии банку по сделке покупки ц/б";
      GroundArray[VA_GRNUM_SEXCH_PAYMCL_COMIS]    =  "Оплата комиссии банку по операции мены";
      GroundArray[VA_GRNUM_SREPAY_PAYMCL_COMIS]   =  "Оплата комиссии банку в операции погашения";
      
      
      // Исполение обязательств/требований (ф. Оплата)
      GroundArray[VA_GRNUM_SBAY_EENG]   =  "Оплата ц/б сделки покупки";
      GroundArray[VA_GRNUM_SSEL_EENG]   =  "Поставка ц/б по сделки продажи";
      GroundArray[VA_GRNUM_SEXCH_VAVA_EENG]    =  "Передача векселей по операции мены";
      GroundArray[VA_GRNUM_SEXCH_VAOV_EENG]    =  "Передача векселей по операции мены";

      
      // Исполение обязательсв/требований (ф. Поставка)
      GroundArray[VA_GRNUM_SREPAY_EREQ]      = "Списание ц/б в операции погашения";
      GroundArray[VA_GRNUM_SEXCH_VAVA_EREQ]  = "Прием векселей по операции мены";
      GroundArray[VA_GRNUM_SEXCH_OVVA_EREQ]  = "Получение векселей по операции мены";
      
      GroundArray[VA_GRNUM_SREPAY]   =  "Зачисление средств в операции погашения";
      
      GroundArray[VA_GRNUM_SEXCH_DIFPAYM_PAY_REST] = "Оплата разницы стоимости векселей по операции мены";
      GroundArray[VA_GRNUM_SEXCH_DIFPAYM_CONTR_PAY]= "Получение оплаты разницы стоимости векселей по операции мены";

      GroundArray[VA_GRNUM_SPAWN_TR]   =  "Передача ц/б в залог по операции";
      GroundArray[VA_GRNUM_SPAWN_BTR]  =  "Возврат ц/б из залога по операции";
      
      GroundArray[VA_GRNUM_SENROLMENT]    =  "Прием на баланс ц/б из филиала по операции"; 
      GroundArray[VA_GRNUM_SENROLMENT_CL] =  "Получение ц/б от клиента по операции"; 
      GroundArray[VA_GRNUM_SRETIREMENT]   =  "Передача ц/б на баланс филиала по операции";
      GroundArray[VA_GRNUM_SRETIREMENT_CL]=  "Возврат ц/б клиенту по операции";


   END;

   MACRO Get(Num)
      return GroundArray[Num];
   END;      

   Init();
END;
 
PRIVATE var VAGrounds = null;

MACRO VA_Ground( Num, tick, date )
   
   if( VAGrounds == null )
      VAGrounds = VA_GroundsClass();
   end;
   return string(VAGrounds.Get( Num )," ", tick.DealCode);
END;



/*  Вариант со сложным основанием проводки
PRIVATE MACRO GetGround( GroundType );
  var i = 1,n = 0,val, 
      FunctionParameters = TArray;
    while (getparm (i,val))
      FunctionParameters(n) = val;
      i = i + 1; n = n + 1;
    end;
    return GB.BuildGroundEx(GroundType,FunctionParameters);
END;
*/

