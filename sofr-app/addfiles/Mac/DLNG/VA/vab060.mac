/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vab060.mac
                                va-вексель
                                 b-операция покупки векселей (buy)
                               060-номер (соответствующий шагу)
  Programmer  : Велигжанин А.В.
  Операция    : Покупка векселей
  Шаг         : Переносить по срокам?
└───────────────────────────────────────────────────────────────────────────*/
IMPORT vabmove;

/* Переносить по срокам?
*/
MACRO ExecuteCaseStep( Kind_Operation, Number_Step, FDoc, KindDoc )
var step;

    record tick("dl_tick");
    SetBuff( tick, FDoc );

    if( tick.DealDate > {curdate} )
      MsgBox ("Преждевременное выполнение шага запрещено.");
      return 1;
    end;
    
    step = NeedMoveByBuy( tick, 
                          "90", /* нет - снятие сделки с внебалансового учета */
                          "70", /*  да - перенос по срокам */
                          tick.DealDate);

    return step;
END;
