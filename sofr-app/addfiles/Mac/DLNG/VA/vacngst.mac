/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank 6.0                                          R-Style Software Lab
  File Name   : vacngst.mac
  Comment     : ”ã­ªæ¨ï ¨§¬¥­¥­¨ï áâ âãá  ¯« â¥¦ 
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
IMPORT OprInter, PaymInter, InsCarryDoc;

MACRO VA_ChangeStat(pmobj, newstat, method, valueDate)
   var Ok = true;

   if( ((newstat == PM_FINISHED) or (newstat == PM_READY_TO_SEND)) AND (pmobj.PaymStatus == PM_CLOSED_W_M_MOVEMENT) )
      return true;
   end; 

   if((ValType(method) == V_INTEGER) AND (method != PMMET_ID))
      Ok = InsertPaymentStat(pmobj.PaymentID, newstat, method, null, null, null, null, valueDate);
   else
      pmobj.PaymStatus = newstat;
      if(ValType(valueDate) == V_DATE)
         pmobj.ValueDate = valueDate;
      end;
      if( newstat == PM_READY_TO_SEND ) 
         pmobj.IsFactPaym = "X"; // #70370
      end;
   end;
   return Ok;
END;