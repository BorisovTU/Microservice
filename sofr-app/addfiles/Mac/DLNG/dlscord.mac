/*
$Name:         dlscord.mac
$Module:       Векселя банка
$Description:  Макрос скроллинга договоров
*/

private RECORD ord (dl_order); 

private const   
    Ошибка    = 0,
    Первый    = 1,
    Последний = 2,
    Создание_операции = 0,
    Удаление_договоров = 1,
    Перевод_в_отложенные = 2;

MACRO Печать_ОтчетСканирования (Вызов, firstdoc, Статус, Сообщение, Действие)
    setbuff(ord, firstdoc);
    if (Вызов == Первый)
        if (Действие == Создание_операции)
[            Отчет о групповом создании операций для договоров.];
        elif (Действие == Удаление_договоров)
[            Отчет о массовом удалении операций];
        elif (Действие == Перевод_в_отложенные)
[            Отчет о групповом переводе договоров в отложенные.];
        else
[            Отчет о групповой операции с договорами.];
        end;

[┌────────────────────┬───────┬───────────────────────────────────────────────────────────┐];
[│       Номер        │№ошибки│                 Сообщение                                 │];
[│      договора      │       │                                                           │];
[├────────────────────┼───────┼───────────────────────────────────────────────────────────┤];
    elif (Вызов == Ошибка)
            if (Статус == 0)
                if (Действие == Создание_операции)
                    Сообщение = "Операция создана успешно";
                elif (Действие == Удаление_договоров)
                    Сообщение = "Договор успешно удален";
                elif (Действие == Перевод_в_отложенные)
                    Сообщение = "Перевод в отложенные выполнен успешно";
                else
                    Сообщение = "Действие выполнено успешно";
                end;
            end;
[│####################│#######│###########################################################│](ord.OrderNumber, Статус, Сообщение);
    elif (Вызов == Последний)                                                   
[└────────────────────┴───────┴───────────────────────────────────────────────────────────┘];
    end;  
END;
