/**
 @file dl_report_TransfBalAcc_Form.mac
 @brief Отчет "Перенос по балансовым счетам" - форма ввода данных

 Отчет "Перенос по балансовым счетам" - форма ввода данных БО ЦБ/ФИССиКО/УВ/СВ/МБК

*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_TRANSFBALACC_DEPARTCODE    = 0, // код филиала
    PNFLD_TRANSFBALACC_DEPARTMENT    = 1, // наименование филиала
    PNFLD_TRANSFBALACC_DATE          = 2, // дата 
    PNFLD_TRANSFBALACC_SEC           = 3, // БО ЦБ
    PNFLD_TRANSFBALACC_DV            = 4, // ФИССиКО
    PNFLD_TRANSFBALACC_VA            = 5, // Учтенные векселя
    PNFLD_TRANSFBALACC_VS            = 6, // Векселя банка
    PNFLD_TRANSFBALACC_MBK           = 7, // Сделки МБК
    PNFLD_TRANSFBALACC_ISAPOSTR      = 8, // С апострофами
    PNFLD_TRANSFBALACC_EXCEL         = 9; // Выпуск отчета в Excel 

/**
@brief Класс формы панели отчета
*/
CLASS ( DL_CPanel ) DL_Report_TransfBalAcc_Form()
    PRIVATE MACRO Init()

        AddFieldProc( 0, PNFLD_TRANSFBALACC_DEPARTCODE,   DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, {OperDprt});
        AddFieldProc( 0, PNFLD_TRANSFBALACC_DEPARTMENT,   DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, {OperDprt});
        AddFieldProc( 0, PNFLD_TRANSFBALACC_DATE,         DL_PNFLD_BEGINDATE,  @DL_FldProc_BeginDate, {curdate} );
        AddFieldProc( 0, PNFLD_TRANSFBALACC_SEC,          DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_DV,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_VA,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_VS,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_MBK,          DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_ISAPOSTR,     DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
        AddFieldProc( 0, PNFLD_TRANSFBALACC_EXCEL,        DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
    END;

    /**
    @brief Проверка ввода данных
    */
    PRIVATE MACRO Check():BOOL
      if ((this.GetFieldValue( PNFLD_TRANSFBALACC_SEC ) == UNSET_CHAR) and
         (this.GetFieldValue( PNFLD_TRANSFBALACC_DV ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_TRANSFBALACC_VA ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_TRANSFBALACC_VS ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_TRANSFBALACC_MBK ) == UNSET_CHAR))
        msgbox("Необходимо выбрать хотя бы один параметр для выпуска отчета.");
        return false;
      end;
      return true;
    END;

    initDL_CPanel( "deals.lbr", "REPTRBAC" );
END;
