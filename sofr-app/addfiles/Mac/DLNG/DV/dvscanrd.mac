/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : dvscanrd.mac
  Created     : //AV 21.06.05
  Programmer  : Азарцов Валерий В.
  Description : Печать отчета сканирования. удалении операций для 
                  сделок\операций исполнения ПИ.
└───────────────────────────────────────────────────────────────────────────*/
import DVInter;   

RECORD deal_firstdoc (dvdeal); 
FILE dvdeal(dvdeal); 

const Ошибка = 0,
      Первый = 1,
   Последний = 2;

/*Action = 1 - вызывается из списка сделок в сервисной операции*/
MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение, Action)
     setbuff (deal_firstdoc,firstdoc);
     if (Вызов==Первый)
[      Отчет о групповом удалении операций для сделок\операций исполнения ПИ.     ];
[+----------+-------+------------------------------------------------------------+];
[|    Код   |№ошибки|                 Сообщение                                  |];
[|  сделки  |       |                                                            |];
[+----------+-------+------------------------------------------------------------+];
     elif (Вызов==Ошибка)
        if(Статус == 0) 
           if( Action == 1 )
              Сообщение = "Шаги сервисной операции удалены.";
           else 
              if(deal_firstdoc.ID)
                 dvdeal.ID = deal_firstdoc.ID;
                 if(GetEQ(dvdeal))
                    if( dvdeal.State != 0 )
                       Сообщение = "Операция не удалена.";
                    elif(dvdeal.State == 0 )
                       Сообщение = "Операция удалена успешно. Сделка отложена.";
                    end;
                 else 
                    Сообщение = "Операция и сделка удалены успешно.";
                 end;
              end;
           end;
        end;
[|##########|#######|############################################################|](deal_firstdoc.Code,Статус,Сообщение);
     elif (Вызов==Последний)            
[+----------+-------+------------------------------------------------------------+];
     end;
END;