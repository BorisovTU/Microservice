//DerivativeDealCategClass.mac
//Класс по работе с категориями сделок срочного рынка
import "CategCommonClass.mac", globals;

class (CategCommonClass) DerivativeDealCategClass (dealid:integer)
  private var expirationGroupID:integer = 101;
  private var marginCallGroupID:integer = 116;

  private macro Init(dealid:integer)
    objectID = string(dealid:34:o);
    logger = NewLogger(c_logger.IT_LOG_TYPE, "DERIVATIVEDEALCATEGCLASS.MAC");
    objectType = 140; //OBJTYPE_OPER_DV
  end;

  macro SaveExpiration(dt:date)
    return SetCategory(expirationGroupID, 1, dt);
  end;

  macro SaveMarginCall(isMarginCall:bool, dt:date)
    var attrID:integer;
    if (isMarginCall)
      attrID = 1;
    else
      attrID = 2;
    end;
    return SetCategory(marginCallGroupID, attrID, dt);
  end;

  Init(dealid);
end;