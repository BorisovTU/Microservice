/*
$Name:        dvnop240.mac
$Module:      Производные инструменты
$Description: Ранние расчеты. Инициализация.
*/
import InsCarryDoc, "dv_categ.mac", "dv_car.mac";

macro ExecuteStep( doc, FDoc, DocKind, ID_Operation, ID_Step)
  record ndeal(dvndeal);
  SetBuff( ndeal, FDoc );
  var FD = DVFirstDocNDeal(DocKind, ndeal);
  var ДатаИсполненияШага:date;
  if (not GetOprDate( DV_NDEAL_OPRDATE_ES, ДатаИсполненияШага))
    ДатаИсполненияШага = {curdate};
  end;

  if (FD.ОтказОтИсполнения())
     return 0;
  end;

  if ( АктуализироватьПлатежи(FD, ДатаИсполненияШага) != 0 )
    return 1;
  end;

  return 0;
end;
