/*
$Name:        dvcomalg.mac
$Module:      Производные инструменты
$Description: Вспомогательные функции для расчета комиссий
*/
import "dvserv.mac";

const SF_BASETYPE_SUM   = 1; /* Сумма*/
const SF_BASETYPE_QUONT = 2; /* Количество*/

/* Названия алгоритмов комиссий (по Alt-P из панели редактирования алгоритмов)*/
const COMM_ALG_A     = "Алгоритм A", /* для "БрокерПИ" */
      COMM_ALG_B     = "Алгоритм B", /* для "МскБиржКлирПИ" */
      COMM_ALG_C     = "Алгоритм C", /* для "КлиентПИ" */
      COMM_ALG_AB    = "Алгоритмы A и B",
      COMM_ALG_ABC   = "Алгоритм A и B и C",
      COMM_ALG_ERROR = "Error";

macro АлгЕдиноврКомиссии( DealID )
  var RetVal = "";

  var cmd = RSDCommand( "select RSB_Derivatives.DV_GetAlgNameCom(?) AlgName from dual" );
  cmd.addParam("", RSDBP_IN, DealID);
  cmd.execute();

  var RSD = TRsbDataSet(cmd);
  if( RSD.MoveNext() )
     RetVal = RSD.rec.AlgName;
  end;

  return RetVal;
end;
