/*
$Name:        dvop300.mac
$Module:      Производные инструменты
$Description: Операция расчетов по ПИ/Шаг - Прекращение встречных обязательств
*/

/* Shvetsov Y.A.                             */

import InsCarryDoc, "dvserv.mac", "dv_fun.mac", "dv_carop.mac", "dv_comiss.mac";

MACRO ExecuteStep( doc, FDoc )
  record oper(dvoper);
  var FD_Oper:DVFirstDocOper;
  SetBuff( oper , FDoc );

  FD_Oper = DVFirstDocOper( DL_DVOPER, oper );

  if( УчетБиржевыхКонтрактов() == DV_ACCEXCONTR_DEAL )
      if( DV_LinkDeals(FD_Oper.Dvoper.rec.id) != 0 )
         return 1;
      end;
  end;
  return 0;
end;
