/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : dvscano.mac
  Created     : //AV 21.06.05
  Programmer  : Азарцов Валерий В.
  Description : Печать отчета сканирования для операций расчета ПИ 
└───────────────────────────────────────────────────────────────────────────*/
import DVInter;   

RECORD oper_firstdoc (dvoper); 
FILE   dvoper(dvoper); 

const Ошибка = 0,
      Первый = 1,
   Последний = 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
     var RetCount = 0;

     setbuff (oper_firstdoc,firstdoc);
     if (Вызов==Первый)
[             Отчет о групповом создании операций для сделок.];
[+----------+-------+----------------------------------------------------------------------------------------+];
[|    Код   |№ошибки|                 Сообщение                                                              |];
[|  сделки  |       |                                                                                        |];
[+----------+-------+----------------------------------------------------------------------------------------+];
     elif (Вызов==Ошибка)
        if(Статус == 0) 
           if(oper_firstdoc.ID)
              dvoper.ID = oper_firstdoc.ID;
              if(GetEQ(dvoper))
                 if(dvoper.State    == 2 ) /*закрытая*/
                    Сообщение = "Операция создана успешно. Сделка закрыта.";
                 elif(dvoper.State  == 1 ) /*открытая*/
                    Сообщение = "Операция создана успешно. Сделка не закрыта.";
                 elif( dvoper.State == 0 ) /*отложенная*/
                    Сообщение = "Операция не создана.";
                 end;
              end;
           end;
        end;
[|##########|#######|########################################################################################|]
(oper_firstdoc.Code,Статус,Сообщение:w);
     elif (Вызов==Последний)            
[+----------+-------+----------------------------------------------------------------------------------------+];
     end;
END;