/**
 @file dvnop450.mac
 @brief Расчётный форвард СПФИ?
 */
import InsCarryDoc, "dv_categ.mac", "dv_car.mac";

macro ExecuteCaseStep(Kind_Operation, Number_Step, FDoc, KindDoc)

  record ndeal(dvndeal);
   SetBuff( ndeal, FDoc );
  var FD = DVFirstDocNDeal(KindDoc, ndeal);

  if(FD.IsForward() and (not FD.ПоставочныйКонтракт()) and FD.РынокСПФИ())
    return "167";
  else
    return "151,165";
  end;

  return 0;

end;

