/*
    $Name:        dvcurmarketscr.mac
    $Module:      ФИСС и КО
    $Description: Сервисные операции/Обработка итогов биржевых валютных торгов
*/

import TSInter, dlmisc;

PRIVATE VAR Документ       = TRecHandler("dl_comm");
PRIVATE VAR СтарыйДокумент = TRecHandler("dl_comm");

PRIVATE MACRO Новый_Документ()
    Документ.rec.opersubkind    = 2;
    Документ.rec.partyid        = 2;
    Документ.rec.partyofficeid  = 9;
    Документ.rec.marketschemeid = 15;
    Документ.rec.traderid       = 4;
    Документ.rec.contractkind   = 0;

    return 0;
END;

PRIVATE MACRO Проверить_Документ(Режим:INTEGER )
    if (Режим == TS_INSERT)
      if (Документ.rec.partyid == GetCodeParty("АО СПВБ",1))
        Документ.rec.partyofficeid  = 1;
        Документ.rec.marketschemeid = 37;
        Документ.rec.traderid       = GetCodeParty("АО СПВБ",1);
      end;
    end;
    return 0;
END;

PRIVATE MACRO Функция_Пользователя()
    return 0;
END;
