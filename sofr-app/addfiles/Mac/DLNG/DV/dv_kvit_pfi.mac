import "dv_categ.mac";
macro ExecuteStep( doc, FDoc, DocKind, ID_Operation, ID_Step )
  record ndeal(dvndeal);
  var FD;

  SetBuff( ndeal, FDoc );
  FD = DVFirstDocNDeal(DocKind, ndeal);

  /*PNV*/
  if (FD.Биржевая())
      return 0;
  end;
  /*PNV*/
/*DAN Для опционов */
  if (FD.IsOption() and (FD.deal.rec.contractor == {OurBank})) /*DAN Для опционов с БИО контрагентом выступает Наш Банк. В этом случае отправка сообщения не осуществляется*/
    return 0;
  end;

    array MenuItems;
    MenuItems[0] = "Автоматическая квитовка";
    MenuItems[1] = "Ручная квитовка";
    
    var MenuResult = Menu(MenuItems, "Выбрать действие");

  return 0;
end;