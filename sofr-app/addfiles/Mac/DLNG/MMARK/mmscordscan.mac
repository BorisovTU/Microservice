private RECORD ord (mm_order); 

private const
    Ошибка   = 0,
    Первый   = 1,
    Последний= 2;

private const
    Создание_операции    = 0,
    Перевод_в_отложенные = 1,
    Удаление             = 2,
    Функция_пользователя = 3;

MACRO Печать_ОтчетСканирования (Вызов, firstdoc, Статус, Сообщение, Действие)
    SetBuff(ord, firstdoc);

    if (Вызов == Первый)
        if (Действие == Создание_операции)
[                       Отчет о групповом создании операций для договоров.                 ];
        elif (Действие == Перевод_в_отложенные)
[                       Отчет о групповом переводе договоров в отложенные.                 ];
        elif (Действие == Удаление)
[                       Отчет о групповом удалении договоров.                              ];
        elif (Действие == Функция_пользователя)
[                       Отчет о групповом выполнении функции пользователя.                 ];
        else
[                       Отчет о групповой операции с договорами.                           ];
        end;

[┌────────────────────┬───────┬───────────────────────────────────────────────────────────┐];
[│       Номер        │№ошибки│                 Сообщение                                 │];
[│      договора      │       │                                                           │];
[├────────────────────┼───────┼───────────────────────────────────────────────────────────┤];
    elif (Вызов == Ошибка)
            if (Статус == 0)
                if (Действие == Создание_операции)
                    Сообщение = "Операция создана успешно";
                elif (Действие == Перевод_в_отложенные)
                    Сообщение = "Перевод в отложенные выполнен успешно";
                elif (Действие == Удаление)
                    Сообщение = "Удаление выполнено успешно";
                elif (Действие == Функция_пользователя)
                    Сообщение = "Функция_пользователя выполнена успешно";
                else
                    Сообщение = "Действие выполнено успешно";
                end;
            end;
[│####################│#######│###########################################################│](ord.OrderNumber, Статус, Сообщение);
    elif (Вызов == Последний)                                                   
[└────────────────────┴───────┴───────────────────────────────────────────────────────────┘];
    end;  
END;
