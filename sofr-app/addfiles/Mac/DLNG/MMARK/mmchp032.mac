/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Softlab

  File Name   : mmchp032.mac
  Операция    : (+/-) Залог МБК
  Шаг         : Балансовое отражение изменений залога МБК
  Comment     :
└───────────────────────────────────────────────────────────────────────────*/
Import RsbDataSet, mmordcr;

MACRO ExecuteStep(Buffer, Document)
  record ord(dl_order);

    setbuff(ord, Document);

    if (not ord.flag1) // Флаг "Обеспечение по договору" не включен - проводок не делаем
       return 0;
    end;

    if (ord.kind_operation == 2350)
       MM_OrdPledgeExecCarry(EditPledgeR, ord, -1).ExecCarry();
    elif (ord.kind_operation == 2355)
       MM_OrdPledgeExecCarry(EditPledgeP, ord, -1).ExecCarry();
    elif (ord.kind_operation == 2365)
        MM_OrdPledgeSecurExecCarry(EditPledgeR, ord, -1).ExecCarry();
    elif (ord.kind_operation == 2370)
        MM_OrdPledgeSecurExecCarry(EditPledgeP, ord, -1).ExecCarry();
    else
        return 1;
    end;

    return 0;
end;
