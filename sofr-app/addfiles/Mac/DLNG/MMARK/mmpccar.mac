///*
//    Отражение в бухучете оплаты процентов
//*/
//import mmcarry, mmlb_j;
//
//private var ok, СчетКредит, СчетДебет;
//
//
///*Проводки получения процентов*/
//MACRO MM_ReceivePerc (deal_pd, ExecDate, УплачНач, УплачСверхНач, НачбалансСрочн, НачВНЕбалансСрочн, ВП, СчетПлательщика, Основание, ИДплатежа )
//var КатегПроцентов, ВД, at = DL_AccTrans;;
//
//	if (deal_pd.tick.rec.typedoc == "L")
//		КатегПроцентов = "+%, Кр";
//	else
//		КатегПроцентов = "+%, Дп";
//	end;	
//
//    ВД = deal_pd.GetParametr(MC_TYPE_PARAMETR_CURRENCY);
//
//    if ((УплачНач > 0)and(НачбалансСрочн > 0))
//        ok = ПолучитьСчетСделки( "+% к погашению", deal_pd, null, СчетКредит, ExecDate) and
//             MM_UNI_Carry (deal_pd, ВД, НачбалансСрочн, ВП, СчетПлательщика, ВД, СчетКредит, ExecDate, Основание + " по надежной сделке", ИДплатежа);
//
//        if( not ok) return false; end;
//    end;
//
//    // Если кредит просрочен (есть платеж с назначением "Возврат просроченного ОД"),
//    // используем категорию "+%, Кр с н.с." вместо "+%, Кр"
//    if((КатегПроцентов == "+%, Кр")and(MM_IsPaymExist(deal_pd.tick.rec.BofficeKind, deal_pd.tick.rec.DealID, PM_PURP_OVD_PRINC)))
//       КатегПроцентов = "+%, Кр с н.с.";
//    end;
//
//    if ((УплачНач > 0)and(НачВНЕбалансСрочн > 0))
//        ok = ПолучитьСчетСделки( КатегПроцентов, deal_pd, null, СчетКредит, ExecDate) and
//             MM_UNI_Carry (deal_pd, ВД, НачВНЕбалансСрочн, ВП, СчетПлательщика, NatCur, СчетКредит, ExecDate, Основание+" по проблемной сделке", ИДплатежа);
//        if( not ok) return false; end;
//
//    at.date_carry = ExecDate;
//    at.PrimaryDoc = deal_pd;
//    at.CatPayer = "ВнебалСчетКорресп";
//    at.FiRolePayer = FIROLE_CORACC_ACTIVE;
//    at.FIIDPayer = ВД;
//    at.FIIDReceiver = ВП;
//	at.SumPayer = 
//    at.SumReceiver = НачВНЕбалансСрочн;
//    at.Ground = Основание+" по проблемной сделке";
//    at.Chapter = 3;
//    at.PaymentID = ИДплатежа;
//    at.CatReceiver  = "Задолж.% (внебаланс)";
//
//    if (not at.carry()) return false; end;
//    end;
//
//    if (УплачСверхНач > 0)
//        ok = ПолучитьСчетСделки( КатегПроцентов, deal_pd, null, СчетКредит, ExecDate) and
//             MM_UNI_Carry (deal_pd, ВД, УплачСверхНач, ВД, СчетПлательщика, NatCur, СчетКредит, ExecDate, Основание, ИДплатежа);
//        if( not ok) return false; end;
//    end;
//    
//    return true;
//END;
//
///*Проводки оплаты процентов*/
//MACRO MM_PayPerc (deal_pd, ExecDate, УплачНач, УплачСверхНач, ВП, СчетОплаты, Основание, ИДплатежа, СуммаОплаты:@variant)
//var СуммаПроводки,
//	KU,
//    ВД = deal_pd.GetParametr(MC_TYPE_PARAMETR_CURRENCY);
//
//    СуммаОплаты = $0;
//  
//    if (УплачНач > 0)
//        ok = ПолучитьСчетСделки( "-% к погашению", deal_pd, null, СчетДебет, ExecDate) and
//             MM_UNI_Carry (deal_pd, ВД, УплачНач, ВД, СчетДебет, ВП, СчетОплаты, ExecDate, Основание, ИДплатежа, @СуммаПроводки);
//
//        if( not ok) return false; end;
//        СуммаОплаты = СуммаОплаты + СуммаПроводки;
//    end;
//
//    if (УплачСверхНач > 0)
//		if (deal_pd.tick.rec.typedoc == "L")
//			KU = "-%, Кр";
//		else
//			KU = "-%, Дп";
//		end;	
//        ok = ПолучитьСчетСделки( KU, deal_pd, null, СчетДебет, ExecDate) and
//             MM_UNI_Carry (deal_pd, ВД, УплачСверхНач, NatCur, СчетДебет, ВП, СчетОплаты, ExecDate, Основание, ИДплатежа, @СуммаПроводки);
//
//        if( not ok) return false; end;
//        СуммаОплаты = СуммаОплаты + СуммаПроводки;
//    end;
//
//    return true;
//END;
