/*
$Name:        mmacccom.mac
$Module:      МБ Кредиты
$Description: макрос выполнения сервисной операции "Учет затрат"
*/
IMPORT RsbDataSet, FIInter, mmservop, globals;
///****************************************************************************************/
PRIVATE VAR
    _Errors = TArray();

/*Печать ошибок****************************************************************************/
MACRO PrintReportError(_ErrorArray)
    VAR 
        idx = 0,
        cntError = _ErrorArray.Size;

    AddSvOpReportLine("┌────────────┬────────────────────┬──────┬─────────────────────────────────────────────────────────────────────────────────────────┐");
    AddSvOpReportLine("│    Код     │  Номер документа   │  №   │               Сообщение                                                                 │");
    AddSvOpReportLine("│  операции  │                    │ошибки│                                                                                         │");
    AddSvOpReportLine("├────────────┼────────────────────┼──────┼─────────────────────────────────────────────────────────────────────────────────────────┤");

    while (idx < cntError)
        AddSvOpReportLine("│" +
                           string(_ErrorArray[idx].OpCode:12)  + "│" + 
                           string(_ErrorArray[idx].ObjCode:20) + "│" +  
                           string(_ErrorArray[idx].NumErr:6)   + "│" +  
                           string(_ErrorArray[idx].StrErr:89)  + "│"  );
        idx = idx + 1;
    end;

    AddSvOpReportLine("└────────────┴────────────────────┴──────┴─────────────────────────────────────────────────────────────────────────────────────────┘");
    return false;
END;
///*Печать результатов работы**************************************************************/
PRIVATE MACRO ToDate(Date)
    if (ValType(Date) == V_DATE)
        Date = String(Date:10:f);
    end;

    return Date;
END;

MACRO PrintReport()
    return true;
END;
/****************************************************************************************/
MACRO OpFilter(_OprServDoc, _DocID)
    return true;
END;
