/*
$Name:        ntgpconfrq.mac
$Module:      Неттинг
$Description: Печать соглашения неттига
*/
import "ntgftagrq.mac";

macro PrintAgreed( NettingID  : integer, /* ИД сделки неттинга */
                   SPgroundID : integer  /* ИД документа соглашения по сделке */
                 )
  file dlnet("dl_nett");
  var TempFile;

  ClearRecord(dlnet);
  dlnet.NettingID = NettingID;
  if( not getEQ(dlnet) )
     msgbox("Не найдена сделка неттинга с параметром NettingID = " + NettingID);
     return 1;
  end;

  message("Формирование соглашения...");

  if( dlnet.IdentProgram == 14/*IP_SEC*/ ) /*операция БОЦБ*/
     if( not FormTagForPrintRQ(NettingID, SPgroundID, false) )
        return 1;
     end;

     TempFile = SetOutput(CreateFileName);

     DLWREPS_PrintReportFromTagFile(TempFile);
     SetOutput(NULL, false);
  end;

  return 0;
end;
