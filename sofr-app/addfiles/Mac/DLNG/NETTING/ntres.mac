
import OprInter;

PRIVATE MACRO ExecuteStep( D, FirstDoc, FirstDocKind, ID_Operation, ID_Step )

  var RetVal = 0;

  if( FirstDocKind == DL_NTGDOC )
     var ReservObj = TRecHandler( "dl_nett" ); 
     ReservObj.SetRecordAddr( FirstDoc );

     if( ReservObj.rec.IdentProgram == 14 /*IP_SEC*/ )
        RetVal = ExecMacroFile("spreserv.mac", "ExecuteStep", D, FirstDoc, FirstDocKind, ID_Operation, ID_Step );
     elif( ReservObj.rec.IdentProgram == 41 /*IP_VEKSELACCOUNTED*/ )
        RetVal = ExecMacroFile("vareserv.mac", "ExecuteStep", D, FirstDoc, FirstDocKind, ID_Operation, ID_Step );
     end;
  end;

  return RetVal;
END;
