//шаг "Переоценка НВПИ" операции неттинга

private record rNtg( dl_nett );

macro ExecuteStep( Doc, FDoc, DocKind )
  var Дата = {curdate};
  var MacroFile = "";
  var MacroFunc = "";
  var stat = 0;

  SetBuff( rNtg, FDoc );

  if(rNtg.IdentProgram == 41 /*IP_VEKSELACCOUNTED*/) //УВ
    MacroFile = "vaovernvpi.mac";
    MacroFunc = "ПереоценкаНВПИНеттинга";
  else
    MacroFile = "scoverntg.mac";
    MacroFunc = "ВыполнитьПереоценкуСделкиНеттинга";
  end;

  stat = ExecMacroFile(MacroFile, MacroFunc, rNtg, Doc);

  return stat;
end;