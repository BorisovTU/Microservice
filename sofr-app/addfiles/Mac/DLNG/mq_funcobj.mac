/*
 $Name: mq_funcobj.mac
 $Module: Ядро Securities
 $Description: Добавление сообщений в очередь отправки
 */
import DealsInter, "FuncObj.mac";

macro AddMsgMQ_MMVB(objectType:integer, objectId:integer, param:string, guid:string, taskId:bigint)
  var stat:integer = 0;
  var ReturnObj = FuncObjResult(FUNCOBJ_RESULT_OK, "", 0);

  stat = DL_AddDlContrMsgToAMQP(objectId, false);

  if(stat != 0)
    ReturnObj.state = FUNCOBJ_RESULT_ERROR;
    ReturnObj.errorText = "Ошибка при добавлении сообщений в очередь отправки по DlContrID=" + objectId;
    ReturnObj.errorCode = stat;
  end;

  return ReturnObj;
end;