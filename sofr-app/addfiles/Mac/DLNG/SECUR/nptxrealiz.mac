/*
$Name:        nptxrealiz.mac
$Module:      ñ•≠≠Î• °„¨†£®
$Description: é‚Á•‚ "ê•£®·‚‡ ‡•†´®ß†Ê®®" (çÑîã)
*/

/*******************************************************************************
 DESCRIPTION  :   é‚Á•‚ "ê•£®·‚‡ ‡•†´®ß†Ê®®" (çÑîã)
 PROGRAMMED BY:   Nikonorov Evgeny
 CREATION DATE:   27.01.2011
*******************************************************************************/
IMPORT "nptxrealiz_form.mac", "RegistrReport.mac";

PRIVATE CONST ë‚‡Æ™†_à‚Æ£Æ                = 0,
              ë‚‡Æ™†_ë‚‡Æ™†Ñ†≠≠ÎÂ         = 1;

PRIVATE VAR ReportHeader =
"Ä≠†´®‚®Á•·™®© ‡•£®·‚‡ §´Ô ‡†·Á•‚† çÑîã ØÆ ·§•´™†¨ ‡•†´®ß†Ê®®\n" +
"ß† Ø•‡®Æ§ · ########## ØÆ ##########\n" +
"É‡„ØØ† ≠†´Æ£Æ¢Æ£Æ „Á•‚†: #################################################################\n" +
"Ç®§ Ê/°:                 #################################################################\n" +
"ÇÎØ„·™ Ê/°:              #################################################################\n" +
"à≠¢•·‚Æ‡:                #################################################################\n";

PRIVATE VAR TableHeader =
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒø\n" +
"≥            ≥            ≥          ≥           ≥                      ≥   äÆ§    ≥   çÆ¨•‡   ≥    í®Ø    ≥   Ñ†‚†   ≥   Ñ†‚†   ≥   Ñ†‚†   ≥äÆ´®Á•·‚¢Æ ≥    ñ•≠†    ≥Ç†´Ó‚†≥Ç†´Ó‚†≥ ä„‡· ñÅêî ≥äÆÌ‰‰®Ê®•≠‚≥      ë‚Æ®¨Æ·‚Ï ‡•†´®ß†Ê®®      ≥      çäÑ ØÆ´„Á•≠≠Î© Ø‡®        ≥     êÎ≠ÆÁ≠†Ô Ê•≠† ØÆ ·§•´™• ‡•†´®ß†Ê®®     ≥   ë„¨¨†    ≥ äÆ¨®··®Ô,  ≥  çÆ¨•‡   ≥   Ñ†‚†   ≥   Ñ†‚†   ≥   Ñ†‚†   ≥    ñ•≠†    ≥Ç†´Ó‚†≥Ç†´Ó‚†≥ ä„‡· ñÅêî ≥äÆÌ‰‰®Ê®•≠‚≥    ë‚Æ®¨Æ·‚Ï Ø‡®Æ°‡•‚•≠®Ô      ≥      çäÑ ØÆ´„Á•≠≠Î© Ø‡®        ≥        êÎ≠ÆÁ≠†Ô Ê•≠† ØÆ ·§•´™• Ø‡®Æ°‡•‚•≠®Ô           ≥å†‚•‡®†´Ï≠†Ô≥  ç†´Æ£ ≠†  ≥ è‡•¢ÎË•≠®• ≥ äÆ¨®··®Ô,   ≥ è‡ÆÊ•≠‚≠Î© ≥ î®≠†≠·Æ¢Î© ≥   ë„¨¨†    ≥     çÆ¨®≠†´ Ê•≠≠Æ© °„¨†£®      ≥    Ñ†‚†    ≥    Ñ†‚†    ≥   ñ•≠†     ≥     Ñ†‚† Ø•‡•™¢†´®‰®™†Ê®®      ≥ äÆ≠‚‡†£•≠‚≥ äÆ≠‚‡†£•≠‚≥ç†´Æ-≥  ë‚†¢™†   ≥   é°È†Ô   ≥äÆ´®Á•·‚¢Æ ≥\n" +
"≥  à≠¢•·‚Æ‡  ≥ ä´®•≠‚/    ≥  ë‚†‚„·  ≥  äÆ§ Ê/°  ≥ ÇÎØ„·™ Ê•≠≠Æ© °„¨†£® ≥  ¢†´Ó‚Î  ≥   ·§•´™®  ≥ ÆØ•‡†Ê®®  ≥ß†™´ÓÁ•≠®Ô≥ Ø•‡•ÂÆ§† ≥ØÆ´„Á•≠®Ô ≥°„¨†£, Ë‚. ≥ ‡•†´®ß†Ê®® ≥ Ê•≠Î ≥‡†·Á•-≥  ≠† §†‚„  ≥ Ø•‡•·Á•‚† ≥          (ØÆ£†Ë•≠®Ô)           ≥    ‡•†´®ß†Ê®® (ØÆ£†Ë•≠®®)      ≥                                            ≥ Æ‚™´Æ≠•≠®Ô ≥ „Ø´†Á•≠≠†Ô ≥  ·§•´™®  ≥ß†™´ÓÁ•≠®Ô≥ Ø•‡•ÂÆ§† ≥  ÆØ´†‚Î  ≥Ø‡®Æ°‡•‚•≠®Ô≥ Ê•≠Î ≥‡†·Á•-≥  ≠† §†‚„  ≥ Ø•‡•·Á•‚† ≥                                ≥         Ø‡®Æ°‡•‚•≠®®           ≥                                                       ≥   ¢Î£Æ§†   ≥¨†‚•‡®†´Ï≠„Ó≥   ·„¨¨Î    ≥ „Ø´†Á•≠≠†Ô  ≥   §ÆÂÆ§    ≥ ‡•ß„´Ï‚†‚, ≥   ≠†´Æ£Æ-  ≥                                ≥ ØÆ£†Ë•≠®Ô  ≥   ¢ÎØ„·™†  ≥ ‡†ß¨•È•≠®Ô ≥       ·§•´™® êÖèé/á†©¨†        ≥ ØÆ ·§•´™• ≥ ØÆ ·§•´™• ≥£Æ¢†Ô≥≠†´Æ£ÆÆ°´Æ-≥  ·‚†¢™†   ≥´Ï£Æ‚≠ÎÂ   ≥\n" +
"≥            ≥ ™Æ≠‚‡†£•≠‚ ≥          ≥           ≥                      ≥ ≠Æ¨®≠†´† ≥‡•†´®ß†Ê®® ≥‡•†´®ß†Ê®® ≥  ·§•´™®  ≥   Ø‡†¢†  ≥  ·‡•§·‚¢ ≥           ≥  ¢ ¢†´Ó‚•  ≥·§•´™®≥ ‚Æ¢  ≥ ØÆ´„Á•≠®Ô ≥ ®ß ¢†´Ó‚Î ≥                                ≥                                ≥                                            ≥‰†™‚®Á•·™Æ© ≥    Ø‡®     ≥Ø‡®Æ°‡•‚•-≥  ·§•´™®  ≥   Ø‡†¢†  ≥ØÆ  ·§•´™•≥  ¢ ¢†´Ó‚•  ≥·§•´™®≥ ‚Æ¢  ≥  ÆØ´†‚Î   ≥ ®ß ¢†´Ó‚Î ≥                                ≥                                ≥                                                       ≥            ≥   ¢Î£Æ§„   ≥ØÆ™„Ø™® ≠†§ ≥    Ø‡®      ≥ ¢ ¢®§•     ≥    ‡„°.    ≥  Æ°´Æ¶•≠®Ô ≥                                ≥ Æ°´®£†Ê®®  ≥ Æ°´®£†Ê®®  ≥ Æ°´®£†Ê®®, ≥                                ≥‡•†´®ß†Ê®® ≥Ø‡®Æ°‡•‚•- ≥£‡„Ø-≥   ¶•≠®Ô   ≥≠†´Æ£ÆÆ°´Æ-≥°„¨†£, Ë‚. ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥(ØÆ£†Ë•≠®Ô)≥(ØÆ£†Ë•≠®Ô)≥    ≠†    ≥ ·Æ°·‚¢-‚®≥    Æ‚    ≥           ≥Ê•≠Î ·§•´™® ≥‡•†´®-≥·§•´™®≥  ¢Î‡„Á™®  ≥    Ê•≠Î   ≥                                ≥                                ≥                                            ≥¢Î‡„Á™® ≠®¶•≥ ‡•†´®ß†Ê®®,≥   ≠®Ô    ≥    ≠†    ≥ ·Æ°·‚¢-‚®≥Ø‡®Æ°‡•‚•-≥Ê•≠Î ·§•´™® ≥Ø‡®Æ°-≥·§•´™®≥Ø‡®Æ°‡•‚•- ≥    Ê•≠Î   ≥                                ≥                                ≥                                                       ≥            ≥            ≥  ‡Î≠ÆÁ≠Æ©  ≥Ø‡®Æ°‡•‚•≠®®,≥§®·™Æ≠‚†, ≠•≥            ≥  ØÆ Æ°È•©  ≥                                ≥            ≥            ≥   ¢ % Æ‚   ≥                                ≥           ≥    ≠®Ô    ≥Ø†   ≥ Ø‡ÆÊ•≠‚Æ¢ ≥   ¶•≠®Ô   ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥‡•†´®ß†Ê®Ó≥    Ø‡®   ≥‡•†´®ß†Ê®®≥           ≥            ≥ß†Ê®® ≥‡•†´®-≥           ≥ ¢ ¢†´Ó‚„  ≥                                ≥                                ≥                                            ≥  ‡Î≠ÆÁ≠Æ©  ≥    ‡„°.    ≥          ≥Ø‡®Æ°‡•‚•-≥    Ø‡®   ≥    ≠®Ô   ≥            ≥‡•‚•- ≥Ø‡®Æ°-≥    ≠®Ô    ≥ ¢ ¢†´Ó‚„  ≥                                ≥                                ≥                                                       ≥            ≥            ≥   Ê•≠Æ©    ≥    ‡„°.     ≥ „Á®‚Î¢†•¨Î©≥            ≥   ·‚†¢™•   ≥                                ≥            ≥            ≥  ≠Æ¨®≠†´†  ≥                                ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥  (§†‚†   ≥‡•†´®ß†Ê®®≥          ≥           ≥            ≥      ≥ß†Ê®® ≥           ≥ ≠Æ¨®≠†´†  ≥                                ≥                                ≥                                            ≥(‡†·Á•‚≠Æ©) ≥            ≥          ≥  ≠®• ñÅ  ≥Ø‡®Æ°‡•‚•-≥          ≥            ≥ ≠®Ô  ≥‡•‚•- ≥           ≥ ≠Æ¨®≠†´†  ≥                                ≥                                ≥                                                       ≥            ≥            ≥            ≥             ≥Ø‡® ≠†´Æ£Æ- ≥            ≥            ≥                                ≥            ≥            ≥            ≥                                ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥ØÆ£†Ë•≠®Ô)≥  (§†‚†   ≥          ≥           ≥            ≥      ≥      ≥           ≥§´Ô ·§•´™® √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¥ Ê•≠Î, ‡„°. ≥            ≥          ≥          ≥  ≠®® ñÅ  ≥          ≥            ≥      ≥ ≠®Ô  ≥           ≥§´Ô ·§•´™® √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¥            ≥            ≥            ≥             ≥ Æ°´Æ¶•≠®®  ≥            ≥            √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥            ≥            ≥            √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥    ñÅ    ≥ØÆ£†Ë•≠®Ô)≥          ≥           ≥            ≥      ≥      ≥           ≥‡•†´®ß†Ê®® ≥ ë„¨¨† ¢ ¢†´Ó‚• ≥  ë„¨¨†, ‡„°.  ≥ ë„¨¨† ¢ ¢†´Ó‚• ≥  ë„¨¨†, ‡„°.  ≥  Å„¨†£†   ≥  ç®¶≠ÔÔ  ≥ à·‚ÆÁ≠®™ ≥   Ñ†‚†   ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥Ø‡®Æ°‡•‚•- ≥ ë„¨¨† ¢ ¢†´Ó‚• ≥  ë„¨¨†, ‡„°.  ≥ ë„¨¨† ¢ ¢†´Ó‚• ≥  ë„¨¨†, ‡„°.  ≥  Å„¨†£†   ≥  ç®¶≠ÔÔ  ≥  Ç•‡Â≠ÔÔ ≥ à·‚ÆÁ≠®™ ≥   Ñ†‚†   ≥            ≥            ≥            ≥             ≥  ØÆ Æ°È•©  ≥            ≥            ≥    ≠† §†‚„     ≥    ≠† §†‚„    ≥            ≥            ≥            ≥   §´Ô ·§•´™®   ≥  §´Ô ·§•´™®   ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥    ñÅ    ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥      Ê•≠Î      ≥               ≥    ≠Æ¨®≠†´†    ≥               ≥ Ô¢´Ô•‚·Ô  ≥  £‡†≠®Ê† ≥®≠‰Æ‡¨†Ê®®≥ ™Æ‚®‡Æ¢™®≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥    ≠®Ô    ≥    ≠Æ¨®≠†´†    ≥               ≥    ≠Æ¨®≠†´†    ≥               ≥ Ô¢´Ô•‚·Ô  ≥  £‡†≠®Ê† ≥  £‡†≠®Ê† ≥®≠‰Æ‡¨†Ê®®≥ ™Æ‚®‡Æ¢™®≥            ≥            ≥            ≥             ≥   ·‚†¢™•   ≥            ≥            ≥   ‡•†´®ß†Ê®®   ≥ Ø‡®Æ°‡•‚•≠®Ô  ≥            ≥            ≥            ≥   ‡•†´®ß†Ê®®   ≥ Ø‡®Æ°‡•‚•≠®Ô  ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  Æ°‡†È†-  ≥ ™Æ´•°†≠®©≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  Æ°‡†È†-  ≥ ™Æ´•°†≠®©≥ ™Æ´•°†≠®©≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  ÓÈ•©·Ô   ≥          ≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  ÓÈ•©·Ô   ≥          ≥          ≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  ≠† §†‚„  ≥          ≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥  ≠† §†‚„  ≥          ≥          ≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥‡•†´®ß†Ê®® ≥          ≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥Ø‡®Æ°‡•‚•- ≥          ≥          ≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥           ≥          ≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥    ≠®Ô    ≥          ≥          ≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"≥            ≥            ≥          ≥           ≥                      ≥          ≥           ≥           ≥          ≥          ≥          ≥           ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥           ≥          ≥          ≥          ≥            ≥            ≥          ≥          ≥          ≥          ≥            ≥      ≥      ≥           ≥           ≥                ≥               ≥                ≥               ≥           ≥          ≥          ≥          ≥          ≥            ≥            ≥            ≥             ≥            ≥            ≥            ≥                ≥               ≥            ≥            ≥            ≥                ≥               ≥           ≥           ≥     ≥           ≥           ≥           ≥\n" +
"√ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ¥\n" +
"≥      1     ≥      2     ≥     3    ≥     4     ≥          5           ≥     6    ≥     7     ≥     8     ≥     9    ≥    10    ≥    11    ≥     12    ≥     13     ≥  14  ≥  15  ≥     16    ≥     17    ≥       18       ≥      19       ≥       20       ≥      21       ≥    22     ≥    23    ≥    24    ≥    25    ≥     26     ≥     27     ≥    28    ≥    29    ≥    30    ≥    31    ≥     32     ≥  33  ≥  34  ≥     35    ≥     36    ≥       37       ≥      38       ≥       39       ≥      40       ≥    41     ≥    42    ≥    43    ≥    44    ≥    45    ≥     46     ≥     47     ≥     48     ≥      49     ≥     50     ≥     51     ≥     52     ≥       53       ≥      54       ≥     55     ≥     56     ≥     57     ≥       58       ≥      59       ≥     60    ≥     61    ≥  62 ≥     63    ≥     64    ≥     65    ≥\n" +
"√ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ¥";
                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                      
PRIVATE CLASS (TX_RegistrReport) NPTX_RealizReg_Report
  VAR m_BeginDate;
  PRIVATE VAR m_IsBond, m_IsDiscBond, m_IsPrivilegedBond;
  PRIVATE VAR m_KZS, m_MainSvp, m_MainSrub, m_NkdSrub, m_NkdBrub, m_ProcSec, m_FRrub, m_TaxLink,
              m_TaxRateProc, m_TaxPM, m_SumQnty;
  
  PRIVATE MACRO PrintMode():INTEGER
     return m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_PRINTMETHOD );
  END;
  
  PRIVATE MACRO BeginReport( NumCopy:INTEGER )
    Dl_CallInsertStat(PrintMode());
    m_SumQnty = 0.0;
  END;
  
  MACRO ClientStatus():STRING
    var ClientStatus = "≠•‡•ß®§•≠‚";

    if(DL_GetPartyResident(m_Rs.Investor,m_EndDate) == NPTXPARTY_RESIDENT)
       ClientStatus = "‡•ß®§•≠‚";
    end;

    return ClientStatus;
  END;

  MACRO PrivQnty():DOUBLE
     /*bug WinRep: ‚ÆÁ≠Æ·‚Ï §•≠•£ ¢·•£§† 2? Ø‡®ÂÆ§®‚·Ô Á•‡•ß double ...*/
     return double(m_RS.t_PrivAmount);
  END;

  MACRO è•Á†‚†‚Ïë‚‡Æ™„í†°´®ÊÎ( LineType:INTEGER )

     if( LineType == ë‚‡Æ™†_ë‚‡Æ™†Ñ†≠≠ÎÂ )

        PrintTableLine( "N1_Client",           this.Client(),           null,      /*1  */
                        "N1_ClientDeal",       this.ClientDeal(),       null,      /*2  */
                        "N1_ClientStatus",     this.ClientStatus(),     null,      /*3  */
                        "N1_SecCode",          this.SecCode(),          null,      /*4  */
                        "N1_SecName",          this.SecName(),          null,      /*5  */
                        "N1_VN",               this.VN(),               null,      /*6  */
                        "N1_CodeS",            this.CodeS(),            null,      /*7  */
                        "N1_TypeS",            this.TypeS(),            null,      /*8  */
                        "N1_DZS",              this.DZS(),              null,      /*9  */
                        "N1_DDS",              iif(this.DDS() > this.H0_2(), null, this.DDS()),    null,      /*10  */
                        "N1_DPS",              this.DPS(),              null,      /*11 */
                        "N1_Qnty",             ÇÎ¢Æ§ó•‡•ßîÆ‡¨„´„(this.Qnty(),this.QntyPrecision()), null,      /*12 */
                        "N1_PrSvp",            this.PrSvp(),            null,      /*13 */
                        "N1_ValS",             this.ValSNumber(),       null,      /*14 */
                        "N1_VpS",              this.VpSNumber(),        null,      /*15 */
                        "N1_CrSP",             this.CrSP(),             null,      /*16 */
                        "N1_KZS",              this.KZS(),              null,      /*17 */
                        "N1_MainSvp",          this.MainSvp(),          null,      /*18 */
                        "N1_MainSrub",         this.MainSrub(),         null,      /*19 */
                        "N1_NkdSvn",           this.NkdSvn(),           null,      /*20 */
                        "N1_NkdSrub",          this.NkdSrub(),          null,      /*21 */
                        "N1_bMrktS",           this.bMrktS(),           null,      /*22 */
                        "N1_PriceMrktS",       this.PriceMrktS(),       null,      /*23 */
                        "N1_MrktS",            this.MrktS(),            null,      /*24 */
                        "N1_DMrktS",           this.DMrktS(),           null,      /*25 */
                        "N1_DifS",             this.DifS(),             null,      /*26 */
                        "N1_ComS",             this.ComS(),             null,      /*27 */
                        "N1_CodeB",            this.CodeB(),            null,      /*28 */
                        "N1_DZB",              this.DZB(),              null,      /*29 */
                        "N1_DDB",              this.DDB(),              null,      /*30 */
                        "N1_DPB",              iif(((this.DPB() == date(0,0,0)) or (this.DPB() > this.H0_2())), null, this.DPB()), null,      /*31 */
                        "N1_PrBvp",            this.PrBvp(),            null,      /*32 */
                        "N1_ValB",             this.ValBNumber(),       null,      /*33 */
                        "N1_VpB",              this.VpBNumber(),        null,      /*34 */
                        "N1_CrBP",             this.CrBP(),             null,      /*35 */
                        "N1_KZB",              this.KZB(),              null,      /*36 */
                        "N1_MainBvp",          this.MainBvp(),          null,      /*37 */
                        "N1_MainBrub",         this.MainBrub(),         null,      /*38 */
                        "N1_NkdBvn",           this.NkdBvn(),           null,      /*39 */
                        "N1_NkdBrub",          this.NkdBrub(),          null,      /*40 */
                        "N1_bMrktB",           this.bMrktB(),           null,      /*41 */
                        "N1_MinMrktB",         this.MinMrktB(),         null,      /*42 */
                        "N1_MaxMrktB",         this.MaxMrktB(),         null,      /*43 */
                        "N1_MrktB",            this.MrktB(),            null,      /*44 */
                        "N1_DMrktB",           this.DMrktB(),           null,      /*45 */
                        "N1_Material",         this.Material(),         null,      /*46 */
                        "N1_TaxPM",            this.TaxPM(),            null,      /*47 */
                        "N1_DifB",             this.DifB(),             null,      /*48 */
                        "N1_ComB",             this.ComB(),             null,      /*49 */
                        "N1_ProcSec",          this.ProcSec(),          null,      /*50 */
                        "N1_FRrub",            this.FRrub(),            null,      /*51 */
                        "N1_GenRub",           this.GenRub(),           null,      /*52 */
                        "N1_NomS",             this.NomS(),             null,      /*53 */
                        "N1_NomB",             this.NomB(),             null,      /*54 */
                        "N1_Dexp",             iif(m_IsBond, this.Dexp(), null),             null,      /*55 */
                        "N1_Dauc",             iif(((m_IsDiscBond) and (m_IsPrivilegedBond)), this.Dauc(), null),  null,      /*56 */
                        "N1_PrAucNom",         this.PrAucNom(),         null,      /*57 */
                        "N1_DqualS",           this.DqualS(),           null,      /*58 */
                        "N1_DqualB",           this.DqualB(),           null,      /*59 */
                        "N1_ContS",            this.ContS(),            null,      /*60 */
                        "N1_ContB",            this.ContB(),            null,      /*61 */
                        "N1_SecType",          this.SecType(),          null,      /*62 */
                        "N1_TaxRateProcent",   this.TaxRateProcent(),   null,      /*63 */
                        "N1_TaxRateGeneral",   this.TaxRateGeneral(),   null,      /*64 */ 
                        "N1_PrivQnty",         ÇÎ¢Æ§ó•‡•ßîÆ‡¨„´„(this.PrivQnty(),this.QntyPrecision()),  null       /*65 */ 
                      );


     elif( LineType == ë‚‡Æ™†_à‚Æ£Æ )

        SetCurrentLineFont( 8, true, false );
        PrintTableLine( "N1_Client",  "Ç·•£Æ:", null );

        SetCurrentLineFont( 8, false, false );
        PrintTableLine( "N1_Client",  "¢ ‚Æ¨ Á®·´•", null );

     end;
  END;


  PRIVATE MACRO Create()
    var query, DataSet;
    var InvestorID = -1;
    var count = 0, Num = 0;
    var AvrFIID, AvrKind, AvrGroup, Investor;

    m_BeginDate = this.H0_1();
    m_EndDate   = this.H0_2();

    SetActiveSheet( "ê•£®·‚‡ê•†´®ß†Ê®®" );

    PrintFormatString( ReportHeader,
                       "N1_H0_1", this.H0_1(), // ß† Ø•‡®Æ§ ·
                       "N1_H0_2", this.H0_2(), // ØÆ
                       "N1_H0_3", this.H0_3(), // É‡„ØØ† ≠†´Æ£Æ¢Æ£Æ „Á•‚†
                       "N1_H0_4", this.H0_4(), // Ç®§ Ê/°
                       "N1_H0_5", this.H0_5(), // ÇÎØ„·™ Ê/°
                       "N1_H0_6", this.H0_6()  // à≠¢•·‚Æ‡
                     );

    RegisterTable( "N1_MainTable", TableHeader,
         /*1  */   "N1_Client",
         /*2  */   "N1_ClientDeal",
         /*3  */   "N1_ClientStatus",
         /*4  */   "N1_SecCode",
         /*5  */   "N1_SecName",
         /*6  */   "N1_VN",
         /*7  */   "N1_CodeS",
         /*8  */   "N1_TypeS",
         /*9  */   "N1_DZS",
         /*10 */   "N1_DDS",
         /*11 */   "N1_DPS",
         /*12 */   "N1_Qnty",
         /*13 */   "N1_PrSvp",
         /*14 */   "N1_ValS",
         /*15 */   "N1_VpS",
         /*16 */   "N1_CrSD",
         /*17 */   "N1_KZS",
         /*18 */   "N1_MainSvp",
         /*19 */   "N1_MainSrub",
         /*20 */   "N1_NkdSvn",
         /*21 */   "N1_NkdSrub",
         /*22 */   "N1_bMrktS",
         /*23 */   "N1_PriceMrktS",
         /*24 */   "N1_MrktS",
         /*25 */   "N1_DMrktS",
         /*26 */   "N1_DifS",
         /*27 */   "N1_ComS",
         /*28 */   "N1_CodeB",
         /*29 */   "N1_DZB",
         /*30 */   "N1_DDB",
         /*31 */   "N1_DPB",
         /*32 */   "N1_PrBvp",
         /*33 */   "N1_ValB",
         /*34 */   "N1_VpB",
         /*35 */   "N1_CrBD",
         /*36 */   "N1_KZB",
         /*37 */   "N1_MainBvp",
         /*38 */   "N1_MainBrub",
         /*39 */   "N1_NkdBvn",
         /*40 */   "N1_NkdBrub",
         /*41 */   "N1_bMrktB",
         /*42 */   "N1_MinMrktB",
         /*43 */   "N1_MaxMrktB",
         /*44 */   "N1_MrktB",
         /*45 */   "N1_DMrktB",
         /*46 */   "N1_Material",
         /*47 */   "N1_TaxPM",
         /*48 */   "N1_DifB",
         /*49 */   "N1_ComB",
         /*50 */   "N1_ProcSec",
         /*51 */   "N1_FRrub",
         /*52 */   "N1_GenRub",
         /*53 */   "N1_NomS",
         /*54 */   "N1_NomB",
         /*55 */   "N1_Dexp",
         /*56 */   "N1_Dauc",
         /*57 */   "N1_PrAucNom",
         /*58 */   "N1_DqualS",
         /*59 */   "N1_DqualB",
         /*60 */   "N1_ContS",
         /*61 */   "N1_ContB",
         /*62 */   "N1_SecType",
         /*63 */   "N1_TaxRateProcent",
         /*64 */   "N1_TaxRateGeneral",
         /*65 */   "N1_PrivQnty"
                  );  

    SetCellAutoSummaPoint( "Ç·•£Æ:", 
                      "N1_Qnty",6,
                      "N1_MainSvp",2, 
                      "N1_MainSrub",2,
                      "N1_NkdSvn",2,    
                      "N1_NkdSrub",2,
                      "N1_DifS",2,    
                      "N1_ComS",2,
                      "N1_MainBvp",2, 
                      "N1_MainBrub",2,  
                      "N1_NkdBvn",2,    
                      "N1_NkdBrub",2,
                      "N1_Material",2,    
                      "N1_TaxPM",2,
                      "N1_DifB",2,  
                      "N1_ComB",2,  
                      "N1_ProcSec",2,   
                      "N1_FRrub",2,
                      "N1_GenRub",2,
                      "N1_PrivQnty",6
                      );
                            
    this.è•Á†‚†‚Ïë‚‡Æ™„í†°´®ÊÎ( ë‚‡Æ™†_à‚Æ£Æ );


    query  =  " select  lnk.t_ID as LinkID, "
            + "         lnk.t_Client as Investor, "
            + "         client.t_Name as InvestorName, "
            + "         av.t_TaxGroup, "
            + "         FinInstr.t_FIID, "
            + "         FinInstr.t_FI_Code as AvrCode, "
            + "         FinInstr.t_Name as AvrName, "
            + "         FinInstr.t_FaceValueFI, " 
            + "         FinInstr.t_AvoirKind, "
            + "         FinInstr.t_DrawingDate, "
            + "         FinInstr.t_Issued, "
            + "         FinInstr.t_SumPrecision, "

            + "         salelot.t_DEALCODETS AS DealSaleCodeTS, "
            + "         salelot.t_DocKind as SaleDocKind, "
            + "         salelot.t_DEALDATE AS DealSaleDate, "
            + "         (case when DealSale.t_BOfficeKind = "+DL_RETIREMENT+" then salelot.t_DealDate else salelot.t_SALEDATE end) AS SaleDate, "
            + "         (case when (DealSale.t_BOfficeKind = "+DL_RETIREMENT+" or DealSale.t_BOfficeKind = "+DL_AVRWRT+") then salelot.t_DealDate else salecdlrq.t_FactDate end) AS SalePayDate, "
            + "         (case when salebdlrq.t_FactDate = "+GetSQLDate(date(0,0,0))+" then salebdlrq.t_Amount else lnk.t_Amount end) as t_Amount, "
            + "         lnk.t_PrivAmount as t_PrivAmount, "
            + "         LegS.t_CFI AS ValS, "
            + "         LegS.t_Price AS SalePrice, "
            + "         LegS.t_RelativePrice as SaleRelativePrice, "
            + "         (case when DealSale.t_BOfficeKind = "+DL_AVRWRT+" then salelot.t_PriceFIID else salecdlrq.t_FIID end) as VpS, "
            + "         salelot.t_DocID as DealSaleID, "

            + "         buylot.t_DocID as DealBuyID, "
            + "         buylot.t_DEALCODETS AS DealBuyCodeTS, "
            + "         buylot.t_DealDate as DealBuyDate, "
            + "         buylot.t_BuyDate, "
            + "         LegB.t_Price as BuyPrice, "
            + "         LegB.t_CFI as ValB, "
            + "         LegB.t_RelativePrice as BuyRelativePrice, "
            + "         (case when DealBuy.t_BOfficeKind = "+DL_AVRWRT+" then buylot.t_PriceFIID else buycdlrq.t_FIID end) as VpB, "
            + "         (case when DealBuy.t_BOfficeKind = "+DL_AVRWRT+" then buylot.t_DealDate else buycdlrq.t_FactDate end) as PayBuyDate, "

            + Get_PartyName_Query( "DealSale", "PartyNameSale", "lnk.t_Client" ) + ", " /*PartyNameSale*/
            + Get_PartyName_Query( "DealBuy",  "PartyNameBuy", "lnk.t_Client" )  + ", " /*PartyNameBuy*/

            + "         (case when npto.GetPaperTaxGroupNPTX(FinInstr.t_FIID) in (30, 40, 50) then "+BOND_FAVOUR+" else "+BOND_UNDEF+" end) as TaxGroupType, "
            + "         (case when RSB_FIINSTR.FI_IsCouponAvoiriss(FinInstr.t_FIID) = 1 then 0 else 1 end) as IsDiscountAvoir, " //Ñ®·™Æ≠‚≠Î¨® Æ°´®£†Ê®Ô¨® ·Á®‚†Ó‚·Ô Æ°´®£†Ê®®, ≠• ®¨•ÓÈ®• ™„ØÆ≠Æ¢.

            + "         to_number(DECODE(DealSale.t_BOfficeKind,"+DL_RETIREMENT+",0,NPTO.GetMinMarketPrice(FinInstr.t_FIID,salelot.t_DEALDATE,DealSale.t_DealID))) SMinMarketPrice, "
            + "         to_date(DECODE(DealSale.t_BOfficeKind,"+DL_RETIREMENT+",TO_DATE('01-01-0001','DD-MM-YYYY'),NPTO.GetMinDateMarket(FinInstr.t_FIID,salelot.t_DEALDATE,DealSale.t_DealID))) SDateMarket, "
            + "         to_char(DECODE(DealSale.t_BOfficeKind,"+DL_RETIREMENT+",'',NPTO.GetMinMarket(FinInstr.t_FIID,salelot.t_DEALDATE,DealSale.t_DealID))) SMarket, "
            + "         to_char(NPTO.IfMarket(FinInstr.t_FIID,salelot.t_DEALDATE)) SIfMarket, "
            
            + "         to_number(DECODE(buylot.t_DEALCODETS,chr(1),0,NPTO.GetMinMarketPrice(buylot_real.t_FIID,buylot.t_DEALDATE,DealBuy.t_DealID))) BMinMarketPrice, "
            + "         to_number(DECODE(buylot.t_DEALCODETS,chr(1),0,NPTO.GetMaxMarketPrice(buylot_real.t_FIID,buylot.t_DEALDATE,DealBuy.t_DealID))) BMaxMarketPrice, "
            + "         to_char(DECODE(buylot.t_DEALCODETS,chr(1),'',NPTO.GetMarket(buylot_real.t_FIID,buylot.t_DEALDATE,DealBuy.t_DealID))) BMarket, "
            + "         to_date(DECODE(buylot.t_DEALCODETS,chr(1),TO_DATE('01-01-0001','DD-MM-YYYY'),NPTO.GetDateMarket(buylot_real.t_FIID,buylot.t_DEALDATE,DealBuy.t_DealID))) BDateMarket, "
            + "         to_char(DECODE(buylot.t_DEALCODETS,chr(1),chr(1),NPTO.IfMarket(buylot_real.t_FIID,buylot.t_DEALDATE))) BIfMarket, "

            + "         lnk.t_Date as OrderDate, "
            + "         case when DealSale.t_IsPartyClient = 'X' and DealSale.t_PartyID = lnk.t_Client then 1 else 0 end IsPartyClient "

            + "   from dnptxlnk_dbt  lnk, "
            + "        dnptxlot_dbt  buylot, "
            + "        dnptxlot_dbt  buylot_real, "
            + "        dnptxlot_dbt  salelot, "
            + "        DDL_TICK_DBT  DealSale," 
            + "        DDL_TICK_DBT  DealBuy," 
            + "        DFININSTR_DBT FinInstr, "  
            + "        DAVOIRISS_DBT av, " 
            + "        ddl_leg_dbt   LegS, "  
            + "        ddl_leg_dbt   LegB, " 
            + "        ddlrq_dbt   salebdlrq, "
            + "        ddlrq_dbt   salecdlrq, "
            + "        ddlrq_dbt   buybdlrq, "
            + "        ddlrq_dbt   buycdlrq, "

            + "        dparty_dbt    client "

            + "  where lnk.t_Type = " + NPTXLNK_DELIVER
            + "    and salelot.t_ID = lnk.t_SaleID "
            + "    and buylot.t_ID = lnk.t_BuyID "
            + "    and buylot_real.t_ID = (case when buylot.t_Origin IN ( " + string(NPTXLOTORIGIN_GO) + "," + string(NPTXLOTORIGIN_IN) +" ) then buylot.t_RealID else buylot.t_ID end ) " 
            + "    and salelot.t_DocID = DealSale.t_DealID " 
            + "    and buylot.t_DocID  = DealBuy.t_DealID "
            + "    and FinInstr.t_FIID = lnk.t_FIID " 
            + "    and av.t_FIID = lnk.t_FIID " 
            + "    and client.t_PartyID = lnk.t_Client "

            + "    and LegS.t_DealID             = DealSale.t_DealID " 
            + "    and LegS.t_LegKind            = (case when salelot.t_Kind = "+NPTXLOTS_BACKREPO+" then 2 else 0 end) " 
            + "    and LegS.t_LegID              = 0 " 
            + "    and LegB.t_DealID             = DealBuy.t_DealID " 
            + "    and LegB.t_LegKind            = (case when buylot.t_Kind = "+NPTXLOTS_REPO+" then 2 else 0 end) " 
            + "    and LegB.t_LegID              = 0 "
            + "    and salebdlrq.t_ID = salelot.t_RQID "
            + "    and salecdlrq.t_DocID(+) = salelot.t_DocID "
            + "    and salecdlrq.t_DocKind(+) = salelot.t_DocKind "
            + "    and salecdlrq.t_Type(+) = " + DLRQ_TYPE_PAYMENT
            + "    and salecdlrq.t_DealPart(+) =  1 " 
            + "    and 1 = ( case when DealSale.t_BOfficeKind <> "+DL_RETIREMENT+" and DealSale.t_BOfficeKind <> "+DL_AVRWRT+" and (salebdlrq.t_FactDate BETWEEN "+GetSQLDate(m_BeginDate)+" and "+GetSQLDate(m_EndDate)+") then 1"
            + "                   when DealSale.t_BOfficeKind = "+DL_RETIREMENT+" then 1 "
            + "                   when DealSale.t_BOfficeKind = "+DL_AVRWRT+" then 1 "
            + "                   else 0 end)"
            + "    and 1 = ( case when DealSale.t_BOfficeKind <> "+DL_RETIREMENT+" and DealSale.t_BOfficeKind <> "+DL_AVRWRT+" and (salecdlrq.t_FactDate BETWEEN "+GetSQLDate(m_BeginDate)+" and "+GetSQLDate(m_EndDate)+") then 1"
            + "                   when DealSale.t_BOfficeKind = "+DL_RETIREMENT+" then 1 "
            + "                   when DealSale.t_BOfficeKind = "+DL_AVRWRT+" then 1 "
            + "                   else 0 end)"
            + "    and 1 = ( case when (DealSale.t_BOfficeKind = "+DL_RETIREMENT+" or DealSale.t_BOfficeKind = "+DL_AVRWRT+") and (salelot.t_DealDate BETWEEN "+GetSQLDate(m_BeginDate)+" and "+GetSQLDate(m_EndDate)+") then 1 "
            + "                   when DealSale.t_BOfficeKind <> "+DL_RETIREMENT+" and DealSale.t_BOfficeKind <> "+DL_AVRWRT+" then 1"
            + "                   else 0 end)"
            + "    and buybdlrq.t_ID = buylot.t_RQID "
            + "    and buycdlrq.t_DocID(+) = buylot.t_DocID "
            + "    and buycdlrq.t_DocKind(+) = buylot.t_DocKind "
            + "    and buycdlrq.t_Type(+) = " + DLRQ_TYPE_PAYMENT
            + "    and buycdlrq.t_DealPart(+) = 1 ";

    AvrFIID = m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_AVRCODE);
    if( (AvrFIID != null) AND (AvrFIID > 0 ) ) /*ß†§†≠† °„¨†£†*/
       query = query + " and lnk.t_FIID = " + string(AvrFIID);
    else

       AvrKind  = m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_AVRKIND );
       if( (AvrKind != null) AND (AvrKind > 0 ) ) /*ß†§†≠ ¢®§ °„¨†£®*/
          query = query + " and RSB_FIInstr.FI_AvrKindsEQ(2, " + string(AvrKind) + ", FinInstr.t_AvoirKind) = 1 ";
       end;

       AvrGroup = m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_AVRGROUP );
       if( (AvrGroup != null) AND (AvrGroup > 0 ) ) /*ß†§†≠† ™†‚•£Æ‡®Ô °„¨†£®*/
          query = query + " and "+ Get_NpTxAvrGroup_Query(AvrGroup,"FinInstr.t_FIID");
       end;
    end;

    Investor = m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_INVESTORCODE);
    if( (Investor != null) AND (Investor > 0 ) )
      query = query + " and lnk.t_Client = " + Investor;
    end;

    query = query + " order by OrderDate asc";

    count = SQL_GetNRecs( query );
    if (count > 0)
      InitProgress( count, "ê•£®·‚‡ ‡•†´®ß†Ê®®", "ê•£®·‚‡ ‡•†´®ß†Ê®®" );

      m_RS = TRsbDataSet( query );

      m_CacheFinInstr.Clear();

      this.SetCurrentLineFont( 8, false, false );
        
      while( m_RS.MoveNext() )

        this.ClearCacheOneRecord();

        m_IsBond = FI_IsBond(m_RS.FIID);
        if(m_IsBond)
          m_IsDiscBond       = m_RS.IsDiscountAvoir;
          m_IsPrivilegedBond = ãÏ£Æ‚≠†Ôé°´®£†Ê®Ô( m_RS.TaxGroupType );
        end;

        è•Á†‚†‚Ïë‚‡Æ™„í†°´®ÊÎ( ë‚‡Æ™†_ë‚‡Æ™†Ñ†≠≠ÎÂ );

        UseProgress( Num = Num + 1 );
      end;

      RemProgress();
    end;

    EndTable();
    
    //Ø‡Æ¨•¶„‚ÆÁ≠Î• ®‚Æ£®
    SetSubtotal(13, 10 + MAXROWSHEET,
                "L7",        
                "R7",
                "S7",        
                "T7",         
                "U7",        
                "Z7",        
                "A7",        
                "AK7",       
                "AL7",         
                "AM7",       
                "AN7",       
                "AT7",       
                "AU7",       
                "AV7",       
                "AW7",       
                "AX7",       
                "AY7",       
                "AZ7",       
                "BM7"        
               );

    AddStandardFooter( "N1_" );

  END;

  MACRO ClearCacheOneRecord()
     this.ClearCacheOneRecord();

     m_IsBond = null;
     m_IsDiscBond       = null;
     m_IsPrivilegedBond = null;

     m_KZS         = null;
     m_MainSvp     = null;
     m_MainSrub    = null;
     m_NkdSrub     = null;
     m_MainBvp     = null;
     m_MainBrub    = null;
     m_NkdBrub     = null;
     m_Material    = null;
     m_TaxPM       = null;
     m_ProcSec     = null;
     m_FRrub       = null;
     m_TaxRateProc = null;
     m_TaxRate     = null;
     m_TaxLink     = null;
  END;


  /*ç†Á†´Ï≠†Ô §†‚†*/
  MACRO H0_1():DATE
     return FormData.BeginDate;
  END;

  /*äÆ≠•Á≠†Ô §†‚†*/
  MACRO H0_2():DATE
     return FormData.EndDate;
  END;

  /*É‡„ØØ† ≠†´Æ£Æ¢Æ£Æ „Á•‚†*/
  MACRO H0_3():STRING
     var AttrID = m_Form.GetFieldValue( PNFLD_TXREALIZ_REG_AVRGROUP),
         GroupName = "";

     if (AttrID > 0)
        DL_GetObjAttrName( OBJTYPE_AVOIRISS, OBJGROUP_AVRNPTXGROUP, AttrID, @GroupName );
        return GroupName;
     end;

     return STR_ALLVALUE;
  END;

  /*Ç®§ Ê/°*/
  MACRO H0_4():STRING
     return FormData.AvrKind;
  END;

  /*ÇÎØ„·™ Ê/°*/
  MACRO H0_5():STRING
     return FormData.AvrName;
  END;

  /*à≠¢•·‚Æ‡*/
  MACRO H0_6():STRING
     return FormData.InvestorName;
  END;
                                                                                                                                                                                                  
  MACRO Client():STRING
    return m_Rs.InvestorName;
  END;                                                                                                                                                                                                    

  MACRO TypeS():STRING
    if(m_RS.SaleDocKind == DL_RETIREMENT)
      return "èÆ£†Ë•≠®•";
    elif((m_RS.SaleDocKind == DL_SECURITYDOC) or (m_RS.SaleDocKind == DL_AVRWRT))
      return "è‡Æ§†¶†";
    end;
    return null;
  END;

  MACRO DPS():DATE // Ñ†‚† ÆØ´†‚Î ØÆ ·§•´™• ‡•†´®ß†Ê®®
     return SQL_ConvTypeDate(m_RS.SalePayDate);
  END;

  MACRO ValS():INTEGER  //¢†´Ó‚† Ê•≠Î
    return m_RS.ValS;
  END;

  MACRO ValSNumber():STRING  //¢†´Ó‚† Ê•≠Î
    if(m_RS.SaleRelativePrice == SET_CHAR)
      return "%";
    else
      return m_CacheFinInstr.GetISO( m_RS.ValS ).m_Number;
    end;
  END;

  MACRO VpS():INTEGER //¢†´Ó‚† ‡†·Á•‚Æ¢
    return m_RS.VpS;      
  END;

  MACRO VpSNumber():STRING //¢†´Ó‚† ‡†·Á•‚Æ¢
    return m_CacheFinInstr.GetISO( m_RS.VpS ).m_Number;      
  END;

  MACRO CrSP():DOUBLE
    if(m_CrSP == NULL)
      m_CrSP = GetRateOnDateCrossDbl( this.DPS(), this.VpS(), NATCUR, true );
    end;
    return m_CrSP;
  END;

  MACRO KZS():DOUBLE
    var Rate = 0;
    if(m_KZS == NULL)
      Rate = GetRateOnDateCrossDbl( this.DZS(), m_RS.FaceValueFI, NATCUR, true );
      if((ValType(Rate) != V_UNDEF) AND (Rate != 0.0))
        m_KZS = GetRateOnDateCrossDbl( this.DZS(), this.ValS(), NATCUR, true )/Rate;
      else
        m_KZS = 0.0;
      end;
    end;

    if((m_CrSP == NULL) or (m_CrSP == 0.0))
      m_CrSP = NULL;
      return 1.0;
    end;

    return m_KZS;
  END;

  MACRO MainSvp():MONEY
    if(m_MainSvp == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_MAINS), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_MainSvp, @m_MainSrub);
    end;
    return m_MainSvp;
  END;
      
  MACRO MainSrub():MONEY
    if(m_MainSrub == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_MAINS), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_MainSvp, @m_MainSrub);
    end;
    return m_MainSrub;
  END;

  MACRO NkdSvn():MONEY
    if(m_NkdSvn == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_NKDS), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_NkdSvn, @m_NkdSrub);
    end;
    return m_NkdSvn;
  END;
      
  MACRO NkdSrub():MONEY
    if(m_MainSrub == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_NKDS), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_NkdSvn, @m_NkdSrub);
    end;
    return m_NkdSrub;
  END;

  MACRO bMrktS():STRING
     return IIF(m_Rs.SIfMarket == SET_CHAR,"§†","≠•‚");
  END;

  MACRO PriceMrktS():STRING
     return m_Rs.SMinMarketPrice;
  END;

  MACRO MrktS():STRING
     return IIF(m_Rs.SMinMarketPrice>0.,m_Rs.SMarket,"");
  END;
   
  MACRO DMrktS():STRING
     return IIF(m_Rs.SMinMarketPrice>0.,SQL_ConvType(m_Rs.SDateMarket),"");
  END;

  MACRO DifS():MONEY
    if(m_DifS == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_DIFS), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_DifS);
    end;
    return m_DifS;
  END;

  MACRO ComS():MONEY
    if(m_ComS == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_COMS), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_ComS);
    end;
    return m_ComS;
  END;

  MACRO DPB():DATE
    return SQL_ConvTypeDate(m_RS.PayBuyDate);
  END;

  MACRO ValB():INTEGER  //¢†´Ó‚† Ê•≠Î
    return m_RS.ValB;
  END;

  MACRO ValBNumber():STRING  //¢†´Ó‚† Ê•≠Î
    if(m_RS.BuyRelativePrice == SET_CHAR)
      return "%";
    else
      return m_CacheFinInstr.GetISO( m_RS.ValB ).m_Number;
    end;
  END;

  MACRO VpB():INTEGER //¢†´Ó‚† ‡†·Á•‚Æ¢
    return m_RS.VpB;      
  END;

  MACRO VpBNumber():STRING //¢†´Ó‚† ‡†·Á•‚Æ¢
    return m_CacheFinInstr.GetISO( m_RS.VpB ).m_Number;      
  END;

  MACRO CrBP():DOUBLE
    if(m_CrBP == NULL)
      if(this.DPB() > date(0,0,0))
        m_CrBP = GetRateOnDateCrossDbl( this.DPB(), this.VpB(), NATCUR, true );
      end;
    end;

    if((m_CrBP == NULL) or (m_CrBP == 0.0))
      m_CrBP = NULL;
      return 1.0;
    end;

    return m_CrBP;
  END;

  MACRO KZB():DOUBLE
    var Rate = 0;
    if(m_KZB == NULL)
      Rate = GetRateOnDateCrossDbl( this.DZB(), m_RS.FaceValueFI, NATCUR, true );
      if((ValType(Rate) != V_UNDEF) AND (Rate != 0.0))
        m_KZB = GetRateOnDateCrossDbl( this.DZB(), this.ValB(), NATCUR, true )/Rate;
      else
        m_KZB = 0.0;
      end;
    end;

    if((m_KZB == NULL) or (m_KZB == 0.0))
      m_KZB = NULL;
      return 1.0;
    end;

    return m_KZB;
  END;

  MACRO MainBvp():MONEY
    if(m_MainBvp == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_MAINB), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_MainBvp, @m_MainBrub);
    end;

    if( m_RS.FaceValueFI != 0 )
      SmartConvertSum( m_MainBvp, m_MainBvp, this.DPS(), NATCUR, m_RS.FaceValueFI, false);
    end;

    return m_MainBvp;
  END;
      
  MACRO MainBrub():MONEY
    if(m_MainBrub == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_MAINB), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_MainBvp, @m_MainBrub);
    end;
    return m_MainBrub;
  END;

  MACRO NkdBvn():MONEY
    if(m_NkdBvn == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_NKDB), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_NkdBvn, @m_NkdBrub);
    end;

    if( m_RS.FaceValueFI != 0 )
      SmartConvertSum( m_NkdBvn, m_NkdBvn, this.DPS(), NATCUR, m_RS.FaceValueFI, false);
    end;

    return m_NkdBvn;
  END;
      
  MACRO NkdBrub():MONEY
    if(m_NkdBrub == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_NKDB), NULL, this.H0_2(), TXOBJ_DIR_ALL, @m_NkdBvn, @m_NkdBrub);
    end;
    return m_NkdBrub;
  END;

  MACRO bMrktB():STRING
    if( m_Rs.BIfMarket == SET_CHAR );
       return "§†";
    elif( m_Rs.BIfMarket == UNSET_CHAR )
       return "≠•‚";
    end;
    return "";
  END;

  MACRO MinMrktB():STRING
    return m_Rs.BMinMarketPrice;
  END;

  MACRO MaxMrktB():STRING
    return m_Rs.BMaxMarketPrice;
  END;

  MACRO MrktB():STRING
    return IIF((m_Rs.BMinMarketPrice>0.)or(m_Rs.BMaxMarketPrice>0.),m_Rs.BMarket,"");
  END;
   
  MACRO DMrktB():STRING
    return IIF((m_Rs.BMinMarketPrice>0.)or(m_Rs.BMaxMarketPrice>0.),SQL_ConvType(m_Rs.BDateMarket),"");
  END;

  MACRO Material():MONEY
    if(m_Material == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_MATERIAL), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_Material);
    end;
    return m_Material;
  END;

  MACRO TaxPM():MONEY
    if(m_TaxPM == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_TAXPM_LINK), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_TaxPM);
    end;
    return m_TaxPM;
  END;

  MACRO DifB():MONEY
    if(m_DifB == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_DIFB), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_DifB);
    end;
    return m_DifB;
  END;

  MACRO ComB():MONEY
    if(m_ComB == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_COMB), NULL, this.H0_2(), TXOBJ_DIR_ALL, NULL, @m_ComB);
    end;
    return m_ComB;
  END;

  MACRO ProcSec():MONEY
    var ProcSecIn = 0.0, ProcSecOut = 0.0;
    if(m_ProcSec == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_DISCOUNT_LINK), NULL, this.H0_2(), TXOBJ_DIR_IN, NULL, @ProcSecIn);
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_DISCOUNT_LINK), NULL, this.H0_2(), TXOBJ_DIR_OUT, NULL, @ProcSecOut);
      m_ProcSec = ProcSecIn - ProcSecOut;
    end;
    return m_ProcSec;
  END;

  MACRO FRrub():MONEY
    var FRrubIn = 0.0, FRrubOut = 0.0;
    if(m_FRrub == NULL)
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_FR_LINK), NULL, this.H0_2(), TXOBJ_DIR_IN, NULL, @FRrubIn);
      DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_FR_LINK), NULL, this.H0_2(), TXOBJ_DIR_OUT, NULL, @FRrubOut);
      m_FRrub = FRrubIn - FRrubOut;
    end;
    return m_FRrub;
  END;

  MACRO NomS():MONEY
    if(m_NomS == NULL)
      if(m_IsBond)
        if(m_RS.SaleDocKind == DL_RETIREMENT) //ØÆ£†Ë•≠®•
          m_NomS = GetFaceValue( m_RS.t_FIID, this.DDS()-1, true, false );
        else
          m_NomS = GetFaceValue( m_RS.t_FIID, iif(((this.DDS() == NULL) or (this.DDS() == date(0,0,0))), this.H0_2(), this.DDS()), true, false );
        end;
      end;
    end;
    return m_NomS;
  END;

  MACRO NomB():MONEY                                                                                                                                        
    if(m_NomB == NULL)
      if(m_IsBond)
        m_NomB = GetFaceValue( m_RS.t_FIID, this.DDB(), true, false );
      end;
    end;
    return m_NomB;
  END;

  MACRO PrAucNom():DOUBLE
    if((m_IsDiscBond) and (m_IsPrivilegedBond))
      return this.PrAucNom();
    end;
    return NULL;
  END;

  MACRO SecType():STRING
    return DL_GetNPTXSecType(m_Rs.FIID);
  END;

  MACRO TaxRateProcent():STRING
    if(m_TaxRateProc == NULL)
      m_TaxRateProc = DL_GetClientTaxRateProcent(m_Rs.Investor, m_Rs.FIID, m_EndDate);
      if(m_TaxRateProc == NULL)
        m_TaxRateProc = "≠•‚";
      else
        m_TaxRateProc = string(m_TaxRateProc * 100.0, "%");
      end;  
    end;
    return m_TaxRateProc;
  END;

  MACRO TaxRateGeneral():STRING
    if(m_TaxRate == NULL)
      m_TaxRate = DL_GetClientTaxRateGeneral(m_Rs.Investor, m_EndDate) * 100.0;
    end;
    return string(m_TaxRate, "%");
  END;

  MACRO TaxLink():MONEY
    var TaxLink_plus = $0, TaxLink_minus = $0;

    if( m_TaxLink == NULL )
       DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_TAX_LINK), NULL, this.H0_2(), TXOBJ_DIR_IN, NULL, @TaxLink_plus);
       DL_GetNPTXOBJSumByLink(m_Rs.LinkID, string(TXOBJ_TAX_LINK), NULL, this.H0_2(), TXOBJ_DIR_OUT, NULL, @TaxLink_minus);
       m_TaxLink = TaxLink_plus - TaxLink_minus;
    end;
    return m_TaxLink;
  END;

  MACRO GenRub():MONEY /*ë„¨¨† §´Ô ≠†´Æ£ÆÆ°´Æ¶•≠®Ô ØÆ Æ°È•© ·‚†¢™•, ‡„°.*/

    var GenRub = 0;

    if( (SecType() == 50) and (m_RS.SaleDocKind == DL_RETIREMENT) )
       GenRub = this.TaxLink() - this.DifB() - this.MainSrub();
    else
       GenRub = IIF((this.FRrub() < 0), this.TaxLink() + this.DifS() - this.DifB(), this.TaxLink());
    end;

    return GenRub;
  END;

  initTX_RegistrReport( NPTX_RealizReg_Panel(), "Report_NPTXRealiz.xlsx" );
END;

  
NPTX_RealizReg_Report().Run();

exit(1);