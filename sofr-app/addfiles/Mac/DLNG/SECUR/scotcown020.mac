/*
$Name:         scotcown020.mac
$Module:       Ценные бумаги
$Description:  Операция внебиржевой продажи/покупки ВО. Шаг "Оформление договора"
*/

import InsCarryDoc, "sp_class.mac", "sp_car.mac", "sprpord.mac";

record Deal_Tick (dl_tick);

macro ExecuteStep( doc, FDoc)

  var FD, dat;

  SetBuff( Deal_Tick, FDoc ); 

  if(Deal_Tick.Flag3 == SET_CHAR)
    if( not InsertOprStatus( SP_OPERSTATUS_SECUROWN_KOM, SP_OPERSTATUS_SECUROWN_KOM_NEEDPAY) ) 
       msgbox( "Ошибка при установке статуса <Оплата комиссии> операции" );
       return 1;
    end;
  end;
 
  return 0;
end;

/* Макрос постобработки */
MACRO PostStep (    
                CommitOrRollback, /*1-выполнение шага,2 -отакат шага*/
                errTrn,        /* Статус выполнения шага-!0-произошла ошибка */
                FDoc,      /* Указатель на первичный документ */
                ID_Operation,  /* Номер экземпляра операции */
                Num_Step,      /* Номер шага операции(из настроек) */
                Kind_Operation,/* Вид операции */
                KindDoc,       /* Вид первичного документа */
                KindStep,      /* Вид шага операции */
                ID_Step)       /* Номер шага операции */


  var     FD;    

  SetBuff(Deal_Tick, FDoc ); 

  return 0;

END;


/* Макрос печати */
MACRO PrintStepDocs (
                ID_Operation,  /* Номер экземпляра операции */
                ID_Step,       /* Номер шага операции */
                Kind_Operation,/* Вид операции */
                KindStep)      /* Вид шага операции */
    

   exit(1); /*Для того, чтобы не выводился пустой файл */

END;
