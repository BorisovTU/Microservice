/*
$Name:             NpTxRepoReg.mac
$Module:           –¥­­ë¥ ¡ã¬ £¨ 
$Description:      Žâç¥â "¥£¨áâàë …Ž" („”‹)
*/
/*******************************************************************************
 DESCRIPTION  :   Žâç¥â "¥£¨áâàë …Ž" („”‹)
 PROGRAMMED BY:   Œ ª à®¢ €.ƒ.
 CREATION DATE:   24.01.11
*******************************************************************************/
IMPORT à®æ¥­âë, "spCache.mac", "NpTxRepoReg_Form.mac", "DLReport_h.mac", "spserv.mac", "spRepFun.mac", "nptxfun.mac", "NpTxRepoReg_Data.mac";

PRIVATE CONST ItogsLineName = "‚á¥£®:";

PRIVATE CONST ‘âà®ª _ˆâ®£®                = 0,
              ‘âà®ª _‘âà®ª „ ­­ëå         = 1;

PRIVATE VAR ReportHeader =
"€­ «¨â¨ç¥áª¨© à¥£¨áâà ¤«ï à áç¥â  „”‹ ¯® á¤¥«ª ¬ …Ž\n" +
"§  ¯¥à¨®¤ á ########## ¯® ##########\n" +
"ƒàã¯¯  ­ «®£®¢®£® ãç¥â : #################################################################\n" +
"‚¨¤ æ/¡:                 #################################################################\n" +
"‚ë¯ãáª æ/¡:              #################################################################\n" +                      
"ˆ­¢¥áâ®à:                #################################################################\n";                      

PRIVATE VAR TableHeader = 
"ÚÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄ¿\n"+
"³  ˆ­¢¥áâ®à  ³ Š«¨¥­â/    ³   ‘â âãá   ³ Š®¤ ¡ã¬ £¨ ³     ‚ë¯ãáª     ³ ®¬¥à á¤¥«ª¨ ³    „ â     ³   Š®«-¢®  ³  Š®¤   ³  Š®¤   ³ ¯à ¢«¥­¨¥³  „ â  1  ³  „ â  1  ³ Ž¡é ï áâ®¨¬®áâì ³ à®æ¥­â ³ Š®«-¢® ¯« â¥¦¥©,³ ‘ã¬¬  ¯« â¥¦¥©, ³ Š®«¨ç¥áâ¢® ³  Š®«-¢®    ³ ¯à ¢«¥­¨¥³  „ â  2  ³  „ â  2  ³ Ž¡é ï áâ®¨¬®áâì ³    ‘â®¨¬®áâì    ³ ¥à¨®¤ ³   ‘ã¬¬     ³   ‘ã¬¬     ³ ” ªâ¨ç¥áª¨¥³ ” ªâ¨ç¥áª¨¥³    áå®¤ë,    ³ ‘¯à ¢®ç­®: ³  ‘â®¨¬®áâì   ³ Ž¡à é ¥¬®áâì ³ Š®­âà £¥­â ¯®  ³  Š®¬¨áá¨ï ¯®  ³ ƒ®¤  ³  Œ¥áïæ  ³Žâ¬¥âª  ®¡³     ‘ã¬¬      ³     ‘ã¬¬      ³    „ â      ³ ‘â ¢ª  ¤«ï ³ Žæ¥­ª  ³  ‘¤¥«ª¨ á  ³ ƒŽ/ä¨«¨ « ³  «®£®¢ ï ³   Ž¡é ï   ³\n"+
"³            ³ ª®­âà £¥­â ³            ³            ³     æ¥­­®©     ³    …Ž      ³ § ª«îç¥­¨ï ³   æ¥­­ëå  ³ ¢ «îâë ³ ¢ «îâë ³  1 ç áâ¨  ³ç áâ¨ …Ž³ç áâ¨ …Ž³ ¯® 1 ç áâ¨ …Ž ³  …Ž   ³   ¨§¬¥­ïîé¨å    ³   ¨§¬¥­ïîé¨å    ³  ª®¬¯¥­á - ³  æ¥­­ëå    ³  2 ç áâ¨  ³ç áâ¨ …Ž³ç áâ¨ …Ž³ ¯® 2 ç áâ¨ …Ž ³   2 ç áâ¨ …Ž  ³  …Ž, ³ % ¤®å®¤®¢  ³ % ¤®å®¤®¢  ³  à áå®¤ë   ³  à áå®¤ë   ³¯à¨­¨¬ ¥¬ë¥ ¤«ï³ áå®¤ë, ­¥ ³     æ/¡      ³      æ/¡     ³  á¤¥«ª¥ …Ž   ³  á¤¥«ª¥ …Ž  ³ …Ž ³  …Ž   ³¨á¯®«­¥­¨¨³    ªã¯®­®¢,   ³    ç áâ¨ç­ëå  ³ á®áâ ¢«¥­¨ï ³  ­®à¬¨à-ï  ³ áâ ¢ª¨ ³®£à ­¨ç¥­¨¥¬³           ³  £àã¯¯    ³  áâ ¢ª    ³\n"+
"³            ³            ³            ³            ³     ¡ã¬ £¨     ³              ³   á¤¥«ª¨   ³   ¡ã¬ £,  ³­®¬¨­ « ³ á¤¥«ª¨ ³           ³(¤¢¨¦¥­¨¥ ³(¤¢¨¦¥­¨¥ ³ ¢ ¢ «îâ¥ á¤¥«ª¨ ³         ³áâ®¨¬®áâì 2 ç áâ¨³áâ®¨¬®áâì 2 ç áâ¨³   æ¨®­­ëå  ³  ¡ã¬ £     ³           ³(¤¢¨¦¥­¨¥ ³(¤¢¨¦¥­¨¥ ³ ¢ ¢ «îâ¥ á¤¥«ª¨ ³   ¯®á«¥ ãç¥â    ³  ¤­¥©  ³  ¢ ¢ «îâ¥  ³  ¢ àã¡«ïå  ³  ¢ ¢ «îâ¥  ³  ¢ àã¡«ïå  ³     æ¥«¥©     ³ãç¨âë¢ ¥¬ë¥ ³              ³              ³                ³               ³      ³         ³2-© ç áâ¨ ³   ¯®¤«¥¦ é¨å  ³   ¯®£ è¥­¨©,  ³   á¯¨áª     ³  à áå®¤®¢  ³  …Ž  ³    ¯à ¢    ³           ³           ³  ­ «®£®-  ³\n"+
"³            ³            ³            ³            ³                ³              ³    …Ž    ³    èâãª   ³ ¡ã¬ £¨ ³        ³           ³  ¡ã¬ £)  ³  ¤¥­¥£)  ³                 ³         ³                 ³                 ³  ¯®áâ ¢®ª, ³ ¢ ª®¬¯¥­-  ³           ³  ¡ã¬ £)  ³  ¤¥­¥£)  ³                 ³  ¯à®¬¥¦ãâ®ç­ëå  ³        ³   á¤¥«ª¨   ³            ³   á¤¥«ª¨   ³            ³  ­ «®£®¢®£®   ³ ¤«ï æ¥«¥©  ³              ³              ³                ³               ³      ³         ³  …Ž ¢  ³    ¢ë¯« â¥    ³   ¯®¤«¥¦ é¨å  ³   ªæ¨®­¥à®¢ ³   ­  ¤ âã  ³        ³ ¯®ªã¯ â¥«ï ³           ³           ³ ®¡«®¦¥­¨ï ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³     èâ.    ³ á æ¨®­­®¬  ³           ³          ³          ³                 ³    ¯« â¥¦¥©,    ³        ³            ³            ³            ³            ³    ãç¥â ,     ³­ «®£®®¡«®- ³              ³              ³                ³               ³      ³         ³ ®âç¥â­®¬ ³    í¬¨â¥­â®¬, ³    ¢ë¯« â¥    ³ ¤«ï ¢ë¯« âë ³  2 ç. …Ž ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³  ¯« â¥¦¥,  ³           ³          ³          ³                 ³ ¢ ¢ «îâ¥ á¤¥«ª¨ ³        ³            ³            ³            ³            ³     àã¡.      ³  ¦¥­¨ï §   ³              ³              ³                ³               ³      ³         ³(­ «®£®¢®¬³    ¢ ¢ «îâ¥   ³    í¬¨â¥­â®¬, ³  ¤¨¢¨¤¥­¤®¢ ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³     èâ.    ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³  ®âç¥â­ë©  ³              ³              ³                ³               ³      ³         ³) ¯¥à¨®¤¥ ³    ­®¬¨­ «  - ³    ¢ ¢ «îâ¥   ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³(­ «®£®¢ë©) ³              ³              ³                ³               ³      ³         ³          ³    §  ¯¥à¨®¤  ³    ­®¬¨­ «  - ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³   ¯¥à¨®¤,  ³              ³              ³                ³               ³      ³         ³          ³    á ­ ç «    ³    §  ¯¥à¨®¤  ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³    àã¡.    ³              ³              ³                ³               ³      ³         ³          ³    ­ «®£®¢®£® ³    á ­ ç «    ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³     ¯¥à¨®¤    ³    ­ «®£®¢®£® ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³   ¯® ®âç¥â­ãî ³     ¯¥à¨®¤    ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³      ¤ âã     ³   ¯® ®âç¥â­ãî ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³      ¤ âã     ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³               ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³               ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³               ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³               ³             ³            ³        ³            ³           ³           ³           ³\n"+
"³            ³            ³            ³            ³                ³              ³            ³           ³        ³        ³           ³          ³          ³                 ³         ³                 ³                 ³            ³            ³           ³          ³          ³                 ³                 ³        ³            ³            ³            ³            ³               ³            ³              ³              ³                ³               ³      ³         ³          ³               ³               ³             ³            ³        ³            ³           ³           ³           ³\n"+
"ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´\n"+
"³     1      ³     2      ³     3      ³     4      ³       5        ³       6      ³      7     ³     8     ³   9    ³   10   ³     11    ³    12    ³    13    ³        14       ³    15   ³        16       ³        17       ³     18     ³     19     ³     20    ³    21    ³    22    ³        23       ³        24       ³   25   ³     26     ³     27     ³     28     ³     29     ³      30       ³     31     ³      32      ³      33      ³       34       ³      35       ³  36  ³    37   ³    38    ³       39      ³       40      ³      41     ³     42     ³   43   ³     44     ³     45    ³     46    ³     47    ³\n"+
"ÃÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄ´";
               

PRIVATE CLASS CRepoReg( Report:OBJECT, RepData:OBJECT )
  VAR m_Report  = Report;
  VAR m_RepData = RepData;

  MACRO BeginReport()
     m_Report.PrintMainHeader( "¥£¨áâà…Ž", "N1_" );

     m_Report.RegisterTable( "N1_MainTable", TableHeader,
                             "N1_Client",          //1 
                             "N1_ClientDeal",      //2 
                             "N1_ClientStatus",    //3 
                             "N1_SecCode",         //4 
                             "N1_SecName",         //5 
                             "N1_CodeR",           //6 
                             "N1_DZ",              //7 
                             "N1_Qnty",            //8 
                             "N1_VN",              //9 
                             "N1_VP",              //10
                             "N1_Dir1",            //11
                             "N1_DD1",             //12
                             "N1_DP1",             //13
                             "N1_Tot1vp",          //14
                             "N1_Rate",            //15
                             "N1_PayN",            //16
                             "N1_PayVp",           //17
                             "N1_PaySecCnt",       //18
                             "N1_PaySecTot",       //19
                             "N1_Dir2",            //20
                             "N1_DD2",             //21
                             "N1_DP2",             //22
                             "N1_Deal2vp",         //23
                             "N1_Tot2vp",          //24
                             "N1_Trepo",           //25
                             "N1_DohVp",           //26
                             "N1_DohRub",          //27
                             "N1_RashVP",          //28
                             "N1_RashRub",         //29
                             "N1_TaxPashRub",      //30
                             "N1_DifRashRub",      //31
                             "N1_MrktSum",         //32
                             "N1_GenRub",          //33
                             "N1_bMrkt",           //34
                             "N1_Cont",            //35
                             "N1_Com",             //36
                             "N1_Yrepo",           //37
                             "N1_MonthRepo",       //38
                             "N1_ifDone2",         //39
                             "N1_CoupCalcVn",      //40
                             "N1_AmortCalcVn",     //41
                             "N1_DfixDiv",         //42
                             "N1_StRate",          //43
                             "N1_DifRate",         //44
                             "N1_IsBlock",         //45
                             "N1_Fil",             //46
                             "N1_SecType",         //47
                             "N1_TaxRateGeneral"   //48
                           );

     m_Report.SetCellAutoSummaPoint( ItogsLineName, 
                                "N1_Qnty",6,            //8 
                                "N1_Tot1vp",2,          //14
                                "N1_PayN",0,            //16
                                "N1_PayVp",2,           //17
                                "N1_PaySecCnt",0,       //18
                                "N1_PaySecTot",6,       //19
                                "N1_DohVp",2,           //26
                                "N1_DohRub",2,          //27
                                "N1_RashVP",2,          //28
                                "N1_RashRub",2,         //29
                                "N1_TaxPashRub",2,      //30
                                "N1_DifRashRub",2,      //31
                                "N1_MrktSum",2,         //32
                                "N1_Com",2,             //35
                                "N1_CoupCalcVn",2,      //39
                                "N1_AmortCalcVn",2      //40
                              );

     this.¥ç â âì‘âà®ªã’ ¡«¨æë( ‘âà®ª _ˆâ®£® );
  END;

  MACRO ¥ç â âìà®¬¥¦ãâ®ç­ë¥ˆâ®£¨()
     
     m_Report.SetSubtotal(12, 9 + MAXROWSHEET,
                          "H7",       // "N1_Qnty",         //8       
                          "N7",       // "N1_Tot1vp",       //14    
                          "P7",       // "N1_PayN",         //16     
                          "Q7",       // "N1_PayVp",        //17    
                          "R7",       // "N1_PaySecCnt",    //18    
                          "S7",       // "N1_PaySecTot",    //19   
                          "Z7",       // "N1_DohVp",        //26       
                          "AA7",      // "N1_DohRub",       //27      
                          "AB7",      // "N1_RashVP",       //28 
                          "AC7",      // "N1_RashRub",      //29 
                          "AD7",      // "N1_TaxPashRub",   //30    
                          "AE7",      // "N1_DifRashRub",   //31  
                          "AF7",      // "N1_MrktSum",      //32   
                          "AI7",      // "N1_Com",          //35
                          "AM7",      // "N1_CoupCalcVn",   //39
                          "AN7"       // "N1_AmortCalcVn"   //40 
                         );                                                                      
  END;

  MACRO ¥ç â âì‘âà®ªã’ ¡«¨æë( LineType:INTEGER )

     if( LineType == ‘âà®ª _‘âà®ª „ ­­ëå )
        m_Report.PrintTableLine( 
                                 "N1_Client",        m_RepData.Client(),          null,               //1
                                 "N1_ClientDeal",    m_RepData.ClientDeal(),      null,               //2
                                 "N1_ClientStatus",  m_RepData.ClientStatus(),    null,               //3
                                 "N1_SecCode",       m_RepData.SecCode(),         null,               //4
                                 "N1_SecName",       m_RepData.SecName(),         null,               //5
                                 "N1_CodeR",         m_RepData.CodeR(),           null,               //6
                                 "N1_DZ",            m_RepData.DZ(),              null,               //7
                                 "N1_Qnty",          m_RepData.Qnty(),            SetPrecisionByFractPart(m_RepData.Qnty(), m_RepData.QntyPrecision(), 0),               //8
                                 "N1_VN",            m_RepData.VN(),              null,               //9
                                 "N1_VP",            m_RepData.VP(),              null,               //10
                                 "N1_Dir1",          m_RepData.Dir1(),            null,               //11
                                 "N1_DD1",           m_RepData.DD1(),             null,               //12
                                 "N1_DP1",           m_RepData.DP1(),             null,               //13
                                 "N1_Tot1vp",        m_RepData.Tot1vp(),          null,               //14
                                 "N1_Rate",          m_RepData.Rate(),            m_RepData.Point(),   //15       
                                 "N1_PayN",          m_RepData.PayN(),            null,               //16
                                 "N1_PayVp",         m_RepData.PayVp(),           null,               //17
                                 "N1_PaySecCnt",     m_RepData.PaySecCnt(),       null,               //18
                                 "N1_PaySecTot",     m_RepData.PaySecTot(),       null,               //19
                                 "N1_Dir2",          m_RepData.Dir2(),            null,               //20
                                 "N1_DD2",           m_RepData.DD2(),             null,               //21
                                 "N1_DP2",           m_RepData.DP2(),             null,               //22
                                 "N1_Deal2vp",       m_RepData.Deal2vp(),         null,               //23
                                 "N1_Tot2vp",        m_RepData.Tot2vp(),          null,               //24
                                 "N1_Trepo",         m_RepData.Trepo(),           null,               //25
                                 "N1_DohVp",         m_RepData.DohVp(),           null,               //26
                                 "N1_DohRub",        m_RepData.DohRub(),          null,               //27
                                 "N1_RashVP",        m_RepData.RashVP(),          null,               //28
                                 "N1_RashRub",       m_RepData.RashRub(),         null,               //29
                                 "N1_TaxPashRub",    m_RepData.TaxPashRub(),      null,               //30
                                 "N1_DifRashRub",    m_RepData.DifRashRub(),      null,               //31
                                 "N1_MrktSum",       m_RepData.MrktSum(),         null,               //32
                                 "N1_GenRub",        m_RepData.GenRub(),          null,               //33
                                 "N1_bMrkt",         m_RepData.bMrkt(),           null,               //34
                                 "N1_Cont",          m_RepData.Cont(),            null,               //35
                                 "N1_Com",           m_RepData.Com(),             null,               //36
                                 "N1_Yrepo",         m_RepData.Yrepo(),           null,               //37
                                 "N1_MonthRepo",     m_RepData.MonthRepo(),       null,               //38
                                 "N1_ifDone2",       m_RepData.ifDone2(),         null,               //39
                                 "N1_CoupCalcVn",    m_RepData.CoupCalcVn(),      null,               //40
                                 "N1_AmortCalcVn",   m_RepData.AmortCalcVn(),     null,               //41
                                 "N1_DfixDiv",       m_RepData.DfixDiv(),         null,               //42
                                 "N1_StRate",        m_RepData.StRate(),          null,               //43
                                 "N1_DifRate",       m_RepData.DifRate(),         null,               //44
                                 "N1_IsBlock",       m_RepData.IsBlock(),         null,               //45
                                 "N1_Fil",           m_RepData.Fil(),             null,               //46
                                 "N1_SecType",       m_RepData.SecType(),         null,               //47
                                 "N1_TaxRateGeneral",m_RepData.TaxRateGeneral(),  null                //48
                               );

     elif( LineType == ‘âà®ª _ˆâ®£® )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N1_Client",  ItogsLineName, null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N1_Client",  "‚ â®¬ ç¨á«¥:", null );
     end;
  END;         

  MACRO EndReport();
     m_Report.EndTable();
     ¥ç â âìà®¬¥¦ãâ®ç­ë¥ˆâ®£¨();
     m_Report.AddStandardFooter( "N1_" );
  END;         
END;


PRIVATE CLASS (DL_CReportTemplate) NPTX_RepoReg_Report
  PRIVATE VAR m_ReportKind, m_Run599, m_RepData;

  PRIVATE MACRO PrintMode():INTEGER
     return m_Form.GetFieldValue( PNFLD_REPOREG_PRINTMETHOD );
  END;

  MACRO PrintMainHeader( ReportCode:STRING, FldNamePrefix:STRING )
     SetActiveSheet( ReportCode );
     PrintFormatString( ReportHeader,
                       FldNamePrefix+"H0_1"   , this.H0_1(),  // §  ¯¥à¨®¤ á
                       FldNamePrefix+"H0_2"   , this.H0_2(),  // ¯®
                       FldNamePrefix+"H0_3"   , this.H0_3(),  // ƒàã¯¯  ­ «®£®¢®£® ãç¥â 
                       FldNamePrefix+"H0_4"   , this.H0_4(),  // ‚¨¤ æ/¡
                       FldNamePrefix+"H0_5"   , this.H0_5(),  // ‚ë¯ãáª æ/¡
                       FldNamePrefix+"H0_6"   , this.H0_6()   // ˆ­¢¥áâ®à
                     );
  END;


  PRIVATE MACRO ExecuteReport( ObjReport:OBJECT )
     VAR  Num = 0;

     ObjReport.BeginReport();
     
     InitProgress( m_RepData.GetCount(), HTML_StSheetName, HTML_StSheetName );

     while( m_RepData.GetNext() )
        ObjReport.¥ç â âì‘âà®ªã’ ¡«¨æë( ‘âà®ª _‘âà®ª „ ­­ëå );
        UseProgress( Num = Num + 1 );
     end;

     RemProgress();
     ObjReport.EndReport();
     ReplaceFormulaAndCalculate();

  END;

  PRIVATE MACRO Create()
     m_RepData = NPTX_RepoReg_Data(m_Form.GetFieldValue(PNFLD_REPOREG_YEAR),
                                   date(m_Form.GetFieldValue(PNFLD_REPOREG_BEGINDATE)), 
                                   date(m_Form.GetFieldValue(PNFLD_REPOREG_ENDDATE)),
                                   m_Form.GetFieldValue( PNFLD_REPOREG_CLIENTCODE), 
                                   m_Form.GetFieldValue( PNFLD_REPOREG_AVRCODE), 
                                   m_Form.GetFieldValue( PNFLD_REPOREG_AVRKIND ), 
                                   m_Form.GetFieldValue( PNFLD_REPOREG_AVRGROUP ), 
                                   m_Form.GetFieldValue( PNFLD_REPOREG_DEALSTATUS ));


     Dl_CallInsertStat(PrintMode());
     ExecuteReport( CRepoReg(this, m_RepData) );
  END;


  MACRO H0_1():DATE
     return FormData.BeginDate;
  END;

  /*Žâç¥â­ ï ¤ â , ãª § ­­ ï ¢ ä®à¬¥ § ¯ãáª  ®âç¥â */
  MACRO H0_2():DATE
     return FormData.EndDate;
  END;

  /*ƒàã¯¯  ­ «®£®¢®£® ãç¥â */
  MACRO H0_3():STRING
     var AttrID = m_Form.GetFieldValue( PNFLD_REPOREG_AVRGROUP),
         GroupName = "";

     if (AttrID > 0)
        DL_GetObjAttrName( OBJTYPE_AVOIRISS, OBJGROUP_AVRNPTXGROUP, AttrID, @GroupName );
        return GroupName;
     end;

     return STR_ALLVALUE;
  END;

  /*‚¨¤ æ/¡*/
  MACRO H0_4():STRING
     return FormData.AvrKind;
  END;

  /*‚ë¯ãáª æ/¡*/
  MACRO H0_5():STRING
     return FormData.AvrName;
  END;

  /*ˆ­¢¥áâ®à*/
  MACRO H0_6():STRING
     return FormData.ClientName;
  END;

  initDL_CReportTemplate( NP_RepoReg_Panel(), "Report_NpTxRepoReg.xls", true );
END;

NPTX_RepoReg_Report().Run();
Exit(1);
