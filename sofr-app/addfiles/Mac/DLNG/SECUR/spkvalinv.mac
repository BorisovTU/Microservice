/*******************************************************************************
 DESCRIPTION  :   é‚Á•‚ "ë¢•§•≠®Ô Æ ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡†Â"(Åé ñÅ, èà)
 PROGRAMMED BY:   Nikolskaya  V.
 CREATION DATE:   26.01.10
*******************************************************************************/
import "dlkvalinv_form.mac","sprepfun.mac";

PRIVATE CONST ãàñÖçáàü_Åêéä    = 1,
              ãàñÖçáàü_ìèê_ñÅ  = 2,
              ãàñÖçáàü_ìèê_èàî = 3;

PRIVATE CONST ÇäãûóÖç   = 1,
              àëäãûóÖç  = 0;

PRIVATE CONST ÑéëíìèÖç   = 1,
              çÖÑéëíìèÖç = 0;

PRIVATE CONST èé_áÄüÇãÖçàû = 2;

PRIVATE VAR UniqStr = TUniqStrCollector;

PRIVATE MACRO PrintPartStr(Str:string,From:integer,Len:integer)
   var EmptyStr = "", PartStr = "";
   PartStr = mkstr(" ",len);
   if( strlen(Str) > 0 )
      PartStr = substr(Str,From,Len);              
      if( strlen(PartStr) < Len )                  
         EmptyStr = mkstr(" ",Len-strlen(PartStr));
         PartStr = PartStr + EmptyStr;             
      end;                                         
   end;
   return PartStr;
END;

PRIVATE VAR Part1     = "                ë¢•§•≠®Ô Æ ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡†Â\n"+
                        "\n1. ë¢•§•≠®Ô Æ ´®Ê•, Æ·„È•·‚¢´ÔÓÈ•¨ Ø‡®ß≠†≠®• ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨ ®≠¢•·‚Æ‡Æ¨\n"+
"⁄ƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥  ≥ èÆ´≠Æ• ≠†®¨•≠Æ¢†≠®• Æ‡£†≠®ß†Ê®®        ≥ "+PrintPartStr({Name_Bank},1,45)+" ≥\n"+
"≥  ≥ ≠† ‡„··™Æ¨ ÔßÎ™•                       ≥ "+PrintPartStr({Name_Bank},46,35)+"           ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥  ≥ ëÆ™‡†È•≠≠Æ• ≠†®¨•≠Æ¢†≠®• Æ‡£†≠®ß†Ê®®   ≥ "+PrintPartStr(GetPartyShortNameByID({OurBank}),1,45)+" ≥\n"+
"≥  ≥ ≠† ‡„··™Æ¨ ÔßÎ™•                       ≥ "+PrintPartStr(GetPartyShortNameByID({OurBank}),46,15)+"                               ≥\n"+ 
"≥ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥  ≥ à≠§®¢®§„†´Ï≠Î© ≠Æ¨•‡                   ≥ ##########                                    ≥\n"+
"≥  ≥ ≠†´Æ£ÆØ´†‚•´ÏÈ®™† (àçç)                ≥                                               ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥  ≥ ë¢•§•≠®Ô Æ ≠†´®Á®® ´®Ê•≠ß®© ≠† Æ·„È•·‚¢´•≠®• Ø‡Æ‰•··®Æ≠†´Ï≠Æ© §•Ô‚•´Ï≠Æ·‚® ≠† ‡Î≠™•    ≥\n"+
"≥  ≥ Ê•≠≠ÎÂ °„¨†£ (´®Ê•≠ß®® ≠† Æ·„È•·‚¢´•≠®• §•Ô‚•´Ï≠Æ·‚® ØÆ „Ø‡†¢´•≠®Ó ®≠¢•·‚®Ê®Æ≠≠Î¨®     ≥\n"+
"≥  ≥ ‰Æ≠§†¨®, Ø†•¢Î¨® ®≠¢•·‚®Ê®Æ≠≠Î¨® ‰Æ≠§†¨® ® ≠•£Æ·„§†‡·‚¢•≠≠Î¨® Ø•≠·®Æ≠≠Î¨® ‰Æ≠§†¨®)     ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥  ≥ Å‡Æ™•‡·™†Ô §•Ô‚•´Ï≠Æ·‚Ï                ≥ ############################################# ≥\n"+
"≥  ≥                                        ≥ ###################################           ≥\n"+ 
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¥\n"+
"≥  ≥ çÆ¨•‡ ´®Ê•≠ß®®                         ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥  ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ¥\n"+
"≥  ≥ Ñ†‚† ¢Î§†Á®                            ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¥\n"+
"≥  ≥ Ñ•Ô‚•´Ï≠Æ·‚Ï ØÆ „Ø‡†¢´•≠®Ó             ≥ ############################################# ≥\n"+
"≥  ≥ Ê•≠≠Î¨® °„¨†£†¨®                       ≥ ###################################           ≥\n"+ 
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¥\n"+
"≥  ≥ çÆ¨•‡ ´®Ê•≠ß®®                         ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥# ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ¥\n"+
"≥  ≥ Ñ†‚† ¢Î§†Á®                            ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¥\n"+
"≥  ≥ Ñ•Ô‚•´Ï≠Æ·‚Ï ØÆ „Ø‡†¢´•≠®Ó             ≥                                               ≥\n"+
"≥  ≥ ®≠¢•·‚®Ê®Æ≠≠Î¨® ‰Æ≠§†¨®,               ≥                                               ≥\n"+
"≥  ≥ Ø†•¢Î¨® ®≠¢•·‚®Ê®Æ≠≠Î¨® ‰Æ≠§†¨® ®      ≥                                               ≥\n"+
"≥  ≥ ≠•£Æ·„§†‡·‚¢•≠≠Î¨® Ø•≠·®Æ≠≠Î¨® ‰Æ≠§†¨® ≥                                               ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¬ƒƒ¥\n"+
"≥  ≥ çÆ¨•‡ ´®Ê•≠ß®®                         ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥  ≥\n"+
"√ƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ≈ƒƒ¡ƒƒ¥\n"+
"≥  ≥ Ñ†‚† ¢Î§†Á®                            ≥     ≥     ≥     ≥     ≥     ≥     ≥     ≥     ≥\n"+
"¿ƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒŸ";

PRIVATE VAR Part2 = "\n2.  Ñ†‚†, ≠† ™Æ‚Æ‡„Ó Ø‡•§·‚†¢´ÔÓ‚·Ô ·¢•§•≠®Ô Æ ‡••·‚‡• ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢\n"+
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒ¬ƒƒƒƒƒø\n"+
"≥ Ñ†‚†, ≠† ™Æ‚Æ‡„Ó Ø‡•§·‚†¢´ÔÓ‚·Ô ·¢•§•≠®Ô  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥  #  ≥\n"+
"≥ Æ ‡••·‚‡• ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢    ≥     ≥     ≥     ≥     ≥     ≥     ≥     ≥     ≥\n"+
"¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒ¡ƒƒƒƒƒŸ";

PRIVATE VAR Part3 = "\n3. ë¢•§•≠®Ô Æ ™Æ´®Á•·‚¢• ´®Ê, ¢™´ÓÁ•≠≠ÎÂ ¢ ‡••·‚‡ ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢\n"+
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê, ¢™´ÓÁ•≠≠ÎÂ ¢ ‡••·‚‡     ≥                                      ≥\n"+
"≥ ß† Æ‚Á•‚≠Î© Ø•‡®Æ§                                 ≥                 ####                 ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê, ®·™´ÓÁ•≠≠ÎÂ ®ß ‡••·‚‡†  ≥                                      ≥\n"+
"≥ ß† Æ‚Á•‚≠Î© Ø•‡®Æ§                                 ≥                 ####                 ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê, ·Æ·‚ÆÔÈ®Â ¢ ‡••·‚‡•     ≥                 ####                 ≥\n"+
"≥                                                    √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ - ®ß ≠®Â ≠•‡•ß®§•≠‚Æ¢ êÆ··®©·™Æ© î•§•‡†Ê®®         ≥                 ####                 ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â  ´®Ê, ¢™´ÓÁ•≠≠ÎÂ ¢ ‡••·‚‡   ≥                                      ≥\n"+
"≥ ß† Æ‚Á•‚≠Î© Ø•‡®Æ§                                 ≥                 ####                 ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â ´®Ê, ®·™´ÓÁ•≠≠ÎÂ ®ß ‡••·‚‡† ≥                                      ≥\n"+
"≥ ß† Æ‚Á•‚≠Î© Ø•‡®Æ§                                 ≥                 ####                 ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â ´®Ê, ·Æ·‚ÆÔÈ®Â ¢ ‡••·‚‡•    ≥                 ####                 ≥\n"+
"≥                                                    √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ - ®ß ≠®Â ≠•‡•ß®§•≠‚Æ¢ êÆ··®©·™Æ© î•§•‡†Ê®®         ≥                 ####                 ≥\n"+
"¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ";

PRIVATE VAR TableHeader4 = "\n4. ë¢•§•≠®Ô Æ ¢®§†Â „·´„£, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ ‰®ß®Á•·™®• ® Ó‡®§®Á•·™®• ´®Ê† °Î´® Ø‡®ß≠†≠Î\n"+
                           "™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®\n";
PRIVATE VAR Table4 =
"⁄ƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥ N ≥      Ç®§ „·´„£®        ≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê,    ≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â ´®Ê,   ≥\n"+
"≥   ≥                        ≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ≥\n"+
"≥   ≥                        ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®       ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®       ≥\n"+
"≥   ≥                        ≥ §†≠≠Æ£Æ ¢®§† „·´„£            ≥ §†≠≠Æ£Æ ¢®§† „·´„£            ≥\n"+
"√ƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥";
                                                                                               
PRIVATE VAR TableHeader5 = "\n5. ë¢•§•≠®Ô Æ ¢®§†Â Ê•≠≠ÎÂ °„¨†£ ® (®´®) ®≠ÎÂ ‰®≠†≠·Æ¢ÎÂ ®≠·‚‡„¨•≠‚†Â, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ\n"+
                           "‰®ß®Á•·™®• ® Ó‡®§®Á•·™®• ´®Ê† °Î´® Ø‡®ß≠†≠Î ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®:\n"+
                           "5.1. ë¢•§•≠®Ô Æ ¢®§†Â Ê•≠≠ÎÂ °„¨†£, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ ‰®ß®Á•·™®• ® Ó‡®§®Á•·™®• ´®Ê† °Î´®\n"+
                           "Ø‡®ß≠†≠Î ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®:\n";
PRIVATE VAR Table5_1 =
"⁄ƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥ N ≥    Ç®§ Ê•≠≠ÎÂ °„¨†£    ≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê,   ≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â ´®Ê,   ≥\n"+
"≥   ≥                        ≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨®≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ≥\n"+
"≥   ≥                        ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®      ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®       ≥\n"+
"≥   ≥                        ≥ §†≠≠Æ£Æ ¢®§† Ê•≠≠ÎÂ °„¨†£    ≥ §†≠≠Æ£Æ ¢®§† Ê•≠≠ÎÂ °„¨†£     ≥\n"+
"√ƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥";

PRIVATE VAR TableHeader5_2 = "\n5.2. ë¢•§•≠®Ô Æ ¢®§†Â ®≠ÎÂ ‰®≠†≠·Æ¢ÎÂ ®≠·‚‡„¨•≠‚Æ¢, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ ‰®ß®Á•·™®• ® Ó‡®§®Á•·™®• ´®Ê† °Î´®\n"+
                             "Ø‡®ß≠†≠Î ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®:\n";
PRIVATE VAR Table5_2 =
"⁄ƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥ N ≥  Ç®§ ®≠ÎÂ ‰®≠†≠·Æ¢ÎÂ   ≥ äÆ´®Á•·‚¢Æ ‰®ß®Á•·™®Â ´®Ê,   ≥ äÆ´®Á•·‚¢Æ Ó‡®§®Á•·™®Â ´®Ê,   ≥\n"+
"≥   ≥  ®≠·‚‡„¨•≠‚Æ¢          ≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨®≥ Ø‡®ß≠†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ≥\n"+
"≥   ≥                        ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®      ≥ ®≠¢•·‚Æ‡†¨® ¢ Æ‚≠ÆË•≠®®       ≥\n"+
"≥   ≥                        ≥ §†≠≠Æ£Æ ¢®§† ®≠ÎÂ ‰®≠†≠·Æ¢ÎÂ ≥ §†≠≠Æ£Æ ¢®§† ®≠ÎÂ ‰®≠†≠·Æ¢ÎÂ  ≥\n"+
"≥   ≥                        ≥ ®≠·‚‡„¨•≠‚Æ¢                 ≥ ®≠·‚‡„¨•≠‚Æ¢                  ≥\n"+
"√ƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥";

PRIVATE VAR Part6 = "\n6. ë¢•§•≠®Ô Æ° Æ°Í•¨†Â Æ™†ß†≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨ ®≠¢•·‚Æ‡†¨ „·´„£, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ\n"+    
                    "ØÆ·´•§≠®• Ø‡®ß≠†≠Î ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®, ® ·§•´Æ™, ·Æ¢•‡Ë•≠≠ÎÂ ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨®\n"+ 
                    "®≠¢•·‚Æ‡†¨®, · Ê•≠≠Î¨® °„¨†£†¨® ® (®´®) ®≠Î¨® ‰®≠†≠·Æ¢Î¨® ®≠·‚‡„¨•≠‚†¨®, ¢ Æ‚≠ÆË•≠®® ™Æ‚Æ‡ÎÂ\n"+
                    "‚†™®• ´®Ê† Ø‡®ß≠†≠Î ™¢†´®‰®Ê®‡Æ¢†≠≠Î¨® ®≠¢•·‚Æ‡†¨®, ß† Æ‚Á•‚≠Î© Ø•‡®Æ§\n"+
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥ é°Í•¨ ·§•´Æ™, ·Æ¢•‡Ë•≠≠ÎÂ ß† ·Á•‚ ‰®ß®Á•·™®Â ´®Ê, ‚Î·. ‡„°.,     ≥ ##################     ≥\n"+
"≥ ®ß ≠®Â:                                                          √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ - · Ê•≠≠Î¨® °„¨†£†¨® §´Ô ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢,           ≥ ##################     ≥\n"+
"≥ - · ®≠Î¨® ‰®≠†≠·Æ¢Î¨® ®≠·‚‡„¨•≠‚†¨® §´Ô ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ        √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥   ®≠¢•·‚Æ‡Æ¢.                                                    ≥ ##################     ≥\n"+
"≥                                                                  √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ é™†ß†≠Æ „·´„£ §´Ô ‰®ß®Á•·™®Â ´®Ê - ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢  ≥ ##################     ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ é°Í•¨ ·§•´Æ™, ·Æ¢•‡Ë•≠≠ÎÂ ß† ·Á•‚ Ó‡®§®Á•·™®Â ´®Ê, ‚Î·. ‡„°.,    ≥ ##################     ≥\n"+
"≥ ®ß ≠®Â:                                                          √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ - · Ê•≠≠Î¨® °„¨†£†¨® §´Ô ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢,           ≥ ##################     ≥\n"+
"≥ - · ®≠Î¨® ‰®≠†≠·Æ¢Î¨® ®≠·‚‡„¨•≠‚†¨® §´Ô ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ        √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥   ®≠¢•·‚Æ‡Æ¢.                                                    ≥ ##################     ≥\n"+
"≥                                                                  √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥ é™†ß†≠Æ „·´„£ §´Ô Ó‡®§®Á•·™®Â ´®Ê - ™¢†´®‰®Ê®‡Æ¢†≠≠ÎÂ ®≠¢•·‚Æ‡Æ¢ ≥ ##################     ≥\n"+
"¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ";

PRIVATE CLASS (DL_CReportTemplate) DL_KvalInv_Report
  var m_Quartal, m_Year, m_BegDate, m_EndDate, m_RepDate, m_PrintExel, m_IsUseApp;
  var m_SheetName = "ë¢•§•≠®Ô Æ ™¢†´®‰®Ê. ®≠¢•·‚Æ‡†Â", m_Licence_Br_Doc = "", m_Licence_DuSec_Doc = "";

  var m_Licence_Br_Num = TArray(), 
      m_Licence_DuSec_Num = TArray(), 
      m_Licence_Br_Date = TArray(), 
      m_Licence_DuSec_Date = TArray(),
      m_Rep_Date = TArray();

  MACRO WithApp()
     if( m_IsUseApp )
        return ":a";
     else
        return "";
     end;
  END;
  
  MACRO EndRepTable()
    EndTable();
  END;                  
 
  MACRO RegisterRepTable4()
     PrintFormatString( TableHeader4 );
     if( m_PrintExel )          
        RegisterTable( "MainTable4", "",  
                       "A4_1",                    
                       "A4_2",                    
                       "A4_3_1",                    
                       "A4_3_2",                    
                       "A4_3_3",                    
                       "A4_3_4",                    
                       "A4_3_5",                    
                       "A4_3_6",                    
                       "A4_3_7",                    
                       "A4_3_8",                    
                       "A4_4_1",                    
                       "A4_4_2",                    
                       "A4_4_3",                    
                       "A4_4_4",                    
                       "A4_4_5",                    
                       "A4_4_6",                    
                       "A4_4_7",                    
                       "A4_4_8"                    
                         );
     else
        RegisterTable( "MainTable4", Table4,  
                       "A4_1",                    
                       "A4_2",                    
                       "A4_3_1",                    
                       "A4_4_1"                    
                         );
     end;                       
  END;

  MACRO RegisterRepTable5_1()
     PrintFormatString( TableHeader5 );               
     if( m_PrintExel )          
        RegisterTable( "MainTable5_1", "",  
                       "A5_11",                    
                       "A5_12",                    
                       "A5_13_1",                    
                       "A5_13_2",                    
                       "A5_13_3",                    
                       "A5_13_4",                    
                       "A5_13_5",                    
                       "A5_13_6",                    
                       "A5_13_7",                    
                       "A5_13_8",                    
                       "A5_14_1",                    
                       "A5_14_2",                    
                       "A5_14_3",                    
                       "A5_14_4",                    
                       "A5_14_5",                    
                       "A5_14_6",                    
                       "A5_14_7",                    
                       "A5_14_8"                    
                         );
     else
        RegisterTable( "MainTable5_1", Table5_1,  
                       "A5_11",                    
                       "A5_12",                    
                       "A5_13_1",                    
                       "A5_14_1"                    
                         );
     end;                       
  END;

  MACRO RegisterRepTable5_2() 
     PrintFormatString( TableHeader5_2 );               
     if( m_PrintExel )          
        RegisterTable( "MainTable5_2", "",  
                       "A5_21",                    
                       "A5_22",                    
                       "A5_23_1",                    
                       "A5_23_2",                    
                       "A5_23_3",                    
                       "A5_23_4",                    
                       "A5_23_5",                    
                       "A5_23_6",                    
                       "A5_23_7",                    
                       "A5_23_8",                    
                       "A5_24_1",                    
                       "A5_24_2",                    
                       "A5_24_3",                    
                       "A5_24_4",                    
                       "A5_24_5",                    
                       "A5_24_6",                    
                       "A5_24_7",                    
                       "A5_24_8"                    
                         );
     else
        RegisterTable( "MainTable5_2", Table5_2,  
                       "A5_21",                    
                       "A5_22",                    
                       "A5_23_1",                    
                       "A5_24_1"                    
                         );
     end;                       
  END;

  MACRO PrintRepTableLine4()
     Merge( "A4_3_1", "A4_3_8", null);
     Merge( "A4_4_1", "A4_4_8", null);

     PrintTableLine( "A4_1", "", null,                       
                     "A4_2", "", null,                                   
                     "A4_3_1", "", null,                                   
                     "A4_4_1", "", null      
                   );                                                              
  END;

  MACRO PrintRepTableLine5_1( NumRec:integer, AvrName:string, FL_Amount_, UL_Amount_ )
     var FL_Amount = FL_Amount_, UL_Amount = UL_Amount_;
     
     if( FL_Amount == 0 )
        FL_Amount = "ƒƒ";
     end;
     if( UL_Amount == 0 )
        UL_Amount = "ƒƒ";
     end;

     Merge( "A5_13_1", "A5_13_8", null);
     Merge( "A5_14_1", "A5_14_8", null);
     PrintTableLine( "A5_11", NumRec, null,                       
                     "A5_12", AvrName, null,                                   
                     "A5_13_1"+WithApp(),FL_Amount, null,                                   
                     "A5_14_1"+WithApp(), UL_Amount, null      
                   );                                                              
  END;

  MACRO PrintRepTableLine5_2()
     Merge( "A5_23_1", "A5_23_8", null);
     Merge( "A5_24_1", "A5_24_8", null);
     PrintTableLine( "A5_21", "", null,                       
                     "A5_22", "", null,                                   
                     "A5_23_1", "", null,                                   
                     "A5_24_1", "", null      
                   );                                                              
  END;

  PRIVATE MACRO PrintMode():INTEGER
     if( m_Form.GetFieldValue( PNFLD_KVALINV_PRINTEXCEL ) == SET_CHAR )
        return DL_OUTREPORT_EXCEL;
     else
        return DL_OUTREPORT_STD;
     end;
  END;

  PRIVATE MACRO BeginReport()
    Dl_CallInsertStat(PrintMode());
    m_Quartal            = m_Form.GetFieldValue( PNFLD_KVALINV_PERIOD );
    m_Year               = m_Form.GetFieldValue( PNFLD_KVALINV_YEAR );
    m_RepDate            = m_Form.GetFieldValue( PNFLD_KVALINV_ONDATE );
    m_IsUseApp           = m_Form.GetFieldValue( PNFLD_KVALINV_WITHAPP );
    m_PrintExel          = m_Form.GetFieldValue( PNFLD_KVALINV_PRINTEXCEL );
    Period_GetInterval( m_Quartal+12, m_Year, @m_BegDate, @m_EndDate );
    SetActiveSheet( m_SheetName );
    SetUseApp(m_IsUseApp == "X");
  END;

  PRIVATE MACRO EndReport()
    AddStandardFooter();
  END;
  /*ØÆ´„Á®‚Ï ≠Æ¨•‡ ® §†‚„ ´®Ê•≠ß®®*/
  PRIVATE MACRO GetRegDoc( LicenceKind:integer, LicenceNum:@string, LicenceDate:@Date )
     var DataSet, SqlQuery, Query;
     Query = "select objrgdoc.t_StartDate, objrgdoc.t_Number "+
             "  from dobjrgdoc_dbt objrgdoc "+              
             " where objrgdoc.t_ObjectType = ? "+                        
             "   and objrgdoc.t_RegPartyKind = ? ";
     
     if( LicenceKind == ãàñÖçáàü_Åêéä )
        Query = Query + " and (objrgdoc.t_RegDocKind = "+string(OBJKDOC_BROKING_BUT_NATURAL_PERSON)+
                        "      or objrgdoc.t_RegDocKind = "+string(OBJKDOC_BROKING_AND_NATURAL_PERSON)+")";          
     elif( LicenceKind == ãàñÖçáàü_ìèê_ñÅ )
        Query = Query + " and objrgdoc.t_RegDocKind = "+string(OBJKDOC_LICEN_CONFIDING_CONTROL);          
     else/*ØÆ èàî†¨ ØÆ™† ≠• ¢Î¢Æ§®¨*/
        Query = Query + " and objrgdoc.t_RegDocKind = "+string(0);          
     end;

     Query = Query +           
             "   and objrgdoc.t_ObjectID = ?";                          
                           
     SqlQuery = RSDCommand(Query);
     SqlQuery.addParam("", RSDBP_IN, OBJTYPE_PARTY);                               
     SqlQuery.addParam("", RSDBP_IN, REGPT_FKCB);                               
     SqlQuery.addParam("", RSDBP_IN, {OurBank});                               
     SqlQuery.execute();                                                     

     DataSet = TRsbDataSet(SqlQuery);
     if( DataSet.MoveNext() )
        LicenceNum = DataSet.Number;  
        LicenceDate = Date(DataSet.StartDate);
        return true;
     end;
     return false;
  END;

  PRIVATE MACRO ParceRegNum( LicenceKind:integer, str:string )
     var RetValue = TArray(), i = 1, j = 0;
     while( i <= strlen(str) )
        if( ( (i == 4) AND (substr(str, i, 1) != "-") ) OR
            ( (LicenceKind == ãàñÖçáàü_Åêéä) and ((i == 8) AND (substr(str, i, 1) != "-")) ) OR
            ( (LicenceKind == ãàñÖçáàü_ìèê_ñÅ) and ((i == 9) AND (substr(str, i, 1) != "-")) )
          )
           RetValue[j] = "-";
           j = j + 1;
        end;
        RetValue[j] = substr(str, i, 1);
        j = j + 1;
        i = i + 1;
     end;
     return RetValue;
  END;

  MACRO ParceDate( ADate:Date )
     var RetValue = TArray(), i = 1, j = 0, ADateStr = string(ADate:f);

     while( i <= strlen(ADateStr) )
        if( Index(ADateStr," ") == 1 )
           RetValue[j] = "0";
           j = j +1;
        elif( substr(ADateStr, i, 1) != "." )
           RetValue[j] = substr(ADateStr, i, 1);
           j = j +1;
        end;
        i = i + 1;
     end;
     return RetValue;
  END;

  MACRO GetRegDocBroker()
     var Licence_Br_Num, Licence_Br_Date;
     if( GetRegDoc(ãàñÖçáàü_Åêéä,@Licence_Br_Num,@Licence_Br_Date) )       
        m_Licence_Br_Num = ParceRegNum(ãàñÖçáàü_Åêéä,string(Licence_Br_Num));
        m_Licence_Br_Date = ParceDate(Date(Licence_Br_Date));
        m_Licence_Br_Doc = "ÇÎ§†≠† ´®Ê•≠ß®Ô îëîê êî ≠† Æ·„È•·‚¢´•≠®• °‡Æ™•‡·™Æ© §•Ô‚•´Ï≠Æ·‚®";
        return true;
     end;
     m_Licence_Br_Doc = "ƒƒƒƒ";
     return false;
  END;

  MACRO GetRegDocDuSec()
     var Licence_DuSec_Num, Licence_DuSec_Date;
     if( GetRegDoc(ãàñÖçáàü_ìèê_ñÅ,@Licence_DuSec_Num,@Licence_DuSec_Date) )
        m_Licence_DuSec_Num = ParceRegNum(ãàñÖçáàü_ìèê_ñÅ,string(Licence_DuSec_Num)); 
        m_Licence_DuSec_Date = ParceDate(Date(Licence_DuSec_Date));
        m_Licence_DuSec_Doc = "ÇÎ§†≠† ´®Ê•≠ß®Ô îëîê êî ≠† Æ·„È•·‚¢´•≠®• §•Ô‚•´Ï≠Æ·‚® ØÆ „Ø‡†¢´•≠®Ó Ê•≠≠Î¨® °„¨†£†¨®";
        return true;
     end;
     m_Licence_DuSec_Doc = "ƒƒƒƒ";
     return false;
  END;

  MACRO PrintParceData( ParceData:TArray, ind:integer )
     if( (ParceData.Size() > 0) AND (ParceData.Size() >= ind) )
        return ParceData[ind];
     end;
     return "";
  END;

  MACRO PrintPart1()

     GetRegDocBroker();
     GetRegDocDuSec();
     if( m_PrintExel )
        PrintFormatString( "",                                               
                           "A1_1", {Name_Bank},                              
                           "A1_2", GetPartyShortNameByID({OurBank}),         
                           "A1_3", èÆ´„Á®‚ÏäÆ§ë„°Í•™‚†({OurBank}, PTCK_INN), 
                           "A1_4:c", m_Licence_Br_Doc,                       
                           "A1_5_1", PrintParceData(m_Licence_Br_Num,0),     
                           "A1_5_2", PrintParceData(m_Licence_Br_Num,1),     
                           "A1_5_3", PrintParceData(m_Licence_Br_Num,2),     
                           "A1_5_4", PrintParceData(m_Licence_Br_Num,3),     
                           "A1_5_5", PrintParceData(m_Licence_Br_Num,4),     
                           "A1_5_6", PrintParceData(m_Licence_Br_Num,5),     
                           "A1_5_7", PrintParceData(m_Licence_Br_Num,6),     
                           "A1_5_8", PrintParceData(m_Licence_Br_Num,7),     
                           "A1_5_9", PrintParceData(m_Licence_Br_Num,8),     
                           "A1_5_10", PrintParceData(m_Licence_Br_Num,9),    
                           "A1_5_11", PrintParceData(m_Licence_Br_Num,10),   
                           "A1_5_12", PrintParceData(m_Licence_Br_Num,11),   
                           "A1_5_13", PrintParceData(m_Licence_Br_Num,12),   
                           "A1_5_14", PrintParceData(m_Licence_Br_Num,13),   
                           "A1_5_15", PrintParceData(m_Licence_Br_Num,14),   
                           "A1_6_1", PrintParceData(m_Licence_Br_Date,0),    
                           "A1_6_2", PrintParceData(m_Licence_Br_Date,1),    
                           "A1_6_3", PrintParceData(m_Licence_Br_Date,2),    
                           "A1_6_4", PrintParceData(m_Licence_Br_Date,3),    
                           "A1_6_5", PrintParceData(m_Licence_Br_Date,4),    
                           "A1_6_6", PrintParceData(m_Licence_Br_Date,5),    
                           "A1_6_7", PrintParceData(m_Licence_Br_Date,6),    
                           "A1_6_8", PrintParceData(m_Licence_Br_Date,7),    
                           "A1_7:c", m_Licence_DuSec_Doc,                    
                           "A1_8_1", PrintParceData(m_Licence_DuSec_Num,0),  
                           "A1_8_2", PrintParceData(m_Licence_DuSec_Num,1),  
                           "A1_8_3", PrintParceData(m_Licence_DuSec_Num,2),  
                           "A1_8_4", PrintParceData(m_Licence_DuSec_Num,3),  
                           "A1_8_5", PrintParceData(m_Licence_DuSec_Num,4),  
                           "A1_8_6", PrintParceData(m_Licence_DuSec_Num,5),  
                           "A1_8_7", PrintParceData(m_Licence_DuSec_Num,6),  
                           "A1_8_8", PrintParceData(m_Licence_DuSec_Num,7),  
                           "A1_8_9", PrintParceData(m_Licence_DuSec_Num,8),  
                           "A1_8_10", PrintParceData(m_Licence_DuSec_Num,9), 
                           "A1_8_11", PrintParceData(m_Licence_DuSec_Num,10),
                           "A1_8_12", PrintParceData(m_Licence_DuSec_Num,11),
                           "A1_8_13", PrintParceData(m_Licence_DuSec_Num,12),
                           "A1_8_14", PrintParceData(m_Licence_DuSec_Num,13),
                           "A1_8_15", PrintParceData(m_Licence_DuSec_Num,14),
                           "A1_8_16", PrintParceData(m_Licence_DuSec_Num,15),
                           "A1_9_1", PrintParceData(m_Licence_DuSec_Date,0), 
                           "A1_9_2", PrintParceData(m_Licence_DuSec_Date,1), 
                           "A1_9_3", PrintParceData(m_Licence_DuSec_Date,2), 
                           "A1_9_4", PrintParceData(m_Licence_DuSec_Date,3), 
                           "A1_9_5", PrintParceData(m_Licence_DuSec_Date,4), 
                           "A1_9_6", PrintParceData(m_Licence_DuSec_Date,5), 
                           "A1_9_7", PrintParceData(m_Licence_DuSec_Date,6), 
                           "A1_9_8", PrintParceData(m_Licence_DuSec_Date,7)  
                          );                                                 
     else
        PrintFormatString( Part1,                                            
                           "", èÆ´„Á®‚ÏäÆ§ë„°Í•™‚†({OurBank}, PTCK_INN), 
                           "", PrintPartStr(m_Licence_Br_Doc,1,45),  
                           "", PrintPartStr(m_Licence_Br_Doc,46,35), 
                           "", PrintParceData(m_Licence_Br_Num,0),     
                           "", PrintParceData(m_Licence_Br_Num,1),     
                           "", PrintParceData(m_Licence_Br_Num,2),     
                           "", PrintParceData(m_Licence_Br_Num,3),     
                           "", PrintParceData(m_Licence_Br_Num,4),     
                           "", PrintParceData(m_Licence_Br_Num,5),     
                           "", PrintParceData(m_Licence_Br_Num,6),     
                           "", PrintParceData(m_Licence_Br_Num,7),     
                           "", PrintParceData(m_Licence_Br_Num,8),     
                           "", PrintParceData(m_Licence_Br_Num,9),    
                           "", PrintParceData(m_Licence_Br_Num,10),   
                           "", PrintParceData(m_Licence_Br_Num,11),   
                           "", PrintParceData(m_Licence_Br_Num,12),   
                           "", PrintParceData(m_Licence_Br_Num,13),   
                           "", PrintParceData(m_Licence_Br_Num,14),   
                           "", PrintParceData(m_Licence_Br_Date,0),    
                           "", PrintParceData(m_Licence_Br_Date,1),    
                           "", PrintParceData(m_Licence_Br_Date,2),    
                           "", PrintParceData(m_Licence_Br_Date,3),    
                           "", PrintParceData(m_Licence_Br_Date,4),    
                           "", PrintParceData(m_Licence_Br_Date,5),    
                           "", PrintParceData(m_Licence_Br_Date,6),    
                           "", PrintParceData(m_Licence_Br_Date,7),    
                           "", PrintPartStr(m_Licence_DuSec_Doc,1,45), 
                           "", PrintPartStr(m_Licence_DuSec_Doc,46,35),
                           "", PrintParceData(m_Licence_DuSec_Num,0),  
                           "", PrintParceData(m_Licence_DuSec_Num,1),  
                           "", PrintParceData(m_Licence_DuSec_Num,2),  
                           "", PrintParceData(m_Licence_DuSec_Num,3),  
                           "", PrintParceData(m_Licence_DuSec_Num,4),  
                           "", PrintParceData(m_Licence_DuSec_Num,5),  
                           "", PrintParceData(m_Licence_DuSec_Num,6),  
                           "", PrintParceData(m_Licence_DuSec_Num,7),  
                           "", PrintParceData(m_Licence_DuSec_Num,8),  
                           "", PrintParceData(m_Licence_DuSec_Num,9), 
                           "", PrintParceData(m_Licence_DuSec_Num,10),
                           "", PrintParceData(m_Licence_DuSec_Num,11),
                           "", PrintParceData(m_Licence_DuSec_Num,12),
                           "", PrintParceData(m_Licence_DuSec_Num,13),
                           "", PrintParceData(m_Licence_DuSec_Num,14),
                           "", PrintParceData(m_Licence_DuSec_Num,15),
                           "", PrintParceData(m_Licence_DuSec_Date,0), 
                           "", PrintParceData(m_Licence_DuSec_Date,1), 
                           "", PrintParceData(m_Licence_DuSec_Date,2), 
                           "", PrintParceData(m_Licence_DuSec_Date,3), 
                           "", PrintParceData(m_Licence_DuSec_Date,4), 
                           "", PrintParceData(m_Licence_DuSec_Date,5), 
                           "", PrintParceData(m_Licence_DuSec_Date,6), 
                           "", PrintParceData(m_Licence_DuSec_Date,7)  
                          );
     end;
                                                    
  END;
  
  MACRO PrintPart2()
     m_Rep_Date = ParceDate(m_RepDate);
     PrintFormatString( Part2,                                     
                        "A2_1", PrintParceData(m_Rep_Date,0),
                        "A2_2", PrintParceData(m_Rep_Date,1),
                        "A2_3", PrintParceData(m_Rep_Date,2),
                        "A2_4", PrintParceData(m_Rep_Date,3),
                        "A2_5", PrintParceData(m_Rep_Date,4),
                        "A2_6", PrintParceData(m_Rep_Date,5),
                        "A2_7", PrintParceData(m_Rep_Date,6),
                        "A2_8", PrintParceData(m_Rep_Date,7)
                       );                                                     
  END;
  
  MACRO GetAmountKIForPeriod( LegalForm:integer, State:integer )
     var SqlQuery, DataSet, PartyAmount = 0;
     
     SqlQuery = RSDCommand("select count(1) as PartyAmount " +
                           "  from DV_SCQINVHIST t, dparty_dbt party, DSCQINV_DBT SCQINV " +                                               
                           " where t.t_State = ? "+                                                                   
                           "   and t.t_BegDate = (select max(vhist.t_BegDate) from DV_SCQINVHIST vhist " +             
                           "                       where vhist.t_PartyID = t.t_PartyID " +                            
                           "                         and vhist.t_BegDate >= ? " + 
                           "                         and vhist.t_BegDate <= ? " + 
                           "                         and (vhist.t_EndDate >= ? or vhist.t_EndDate = '01.01.0001')) " +                   
                           "   and party.t_LegalForm = ? " + 
                           "   and SCQINV.t_PartyID = t.t_PartyID " +
                           "   and SCQINV.t_Kind = "+string(èé_áÄüÇãÖçàû)+                              
                           "   and party.t_PartyID = t.t_PartyID");                                                  
                           
     SqlQuery.addParam( "", RSDBP_IN, State );
     SqlQuery.addParam( "", RSDBP_IN, m_BegDate );
     SqlQuery.addParam( "", RSDBP_IN, m_EndDate );
     SqlQuery.addParam( "", RSDBP_IN, m_EndDate );
     SqlQuery.addParam( "", RSDBP_IN, LegalForm );
     
     SqlQuery.execute();
     
     DataSet = TRsbDataSet(SqlQuery);
     if( DataSet.MoveNext() )
        PartyAmount = DataSet.PartyAmount;
     end;
     if( PartyAmount == 0. )
        return "";
     end;
     return PartyAmount;
  END;
  
  MACRO GetAmountKIOnDate( LegalForm:integer, State:integer, OnlyNotResident:bool )
     var Query, SqlQuery, DataSet, PartyAmount = 0;

     Query = "select count(1) as PartyAmount " +
             "  from DV_SCQINVHIST t, dparty_dbt party, DSCQINV_DBT SCQINV " +                                                             
             " where t.t_State = ? "+                                                                                 
             "   and t.t_BegDate = (select max(vhist.t_BegDate) from DV_SCQINVHIST vhist " +                           
             "                       where vhist.t_PartyID = t.t_PartyID " + 
             "                         and vhist.t_BegDate <= ? " +                            
             "                         and (vhist.t_EndDate >= ? or vhist.t_EndDate = '01.01.0001')) " +                                 
             "   and party.t_LegalForm = ? " +                                                                        
             "   and SCQINV.t_PartyID = t.t_PartyID " +
             "   and SCQINV.t_Kind = "+string(èé_áÄüÇãÖçàû)+                              
             "   and party.t_PartyID = t.t_PartyID";
     if( OnlyNotResident )
        Query = Query + "   and party.t_NotResident = 'X'";                                                                    
     end;
                                                             
     SqlQuery = RSDCommand(Query);                                                   

     SqlQuery.addParam( "", RSDBP_IN, State );
     SqlQuery.addParam( "", RSDBP_IN, m_EndDate );
     SqlQuery.addParam( "", RSDBP_IN, m_EndDate );
     SqlQuery.addParam( "", RSDBP_IN, LegalForm );

     SqlQuery.execute();

     DataSet = TRsbDataSet(SqlQuery);
     if( DataSet.MoveNext() )
        PartyAmount = DataSet.PartyAmount;
     end;
     if( PartyAmount == 0. )
        return "";
     end;
     return PartyAmount;
  END;

  MACRO PrintPart3()
     PrintFormatString( Part3,                                     
                        "A3_1"+WithApp(), GetAmountKIForPeriod( 2, ÇäãûóÖç ),
                        "A3_2"+WithApp(), GetAmountKIForPeriod( 2, àëäãûóÖç ),
                        "A3_3"+WithApp(), GetAmountKIOnDate( 2, ÇäãûóÖç, false),
                        "A3_4"+WithApp(), GetAmountKIOnDate( 2, ÇäãûóÖç, true),
                        "A3_5"+WithApp(), GetAmountKIForPeriod( 1, ÇäãûóÖç ),
                        "A3_6"+WithApp(), GetAmountKIForPeriod( 1, àëäãûóÖç ),
                        "A3_7"+WithApp(), GetAmountKIOnDate( 1, ÇäãûóÖç, false),
                        "A3_8"+WithApp(), GetAmountKIOnDate( 1, ÇäãûóÖç, true)
                       );                                                     
  END;

  MACRO PrintPart4()/*ß†ØÆ´≠•≠®• - 2 ÆÁ•‡•§Ï*/
     RegisterRepTable4();
     PrintRepTableLine4();
     EndRepTable();                                                
  END;

  MACRO PrintPart5_1()
     var Query, Sql, Set, IsExistsData = false, Num = 1,
     Query1 = "(select count(1) " +                                                             
              "   from dparty_dbt party " +                                  
              "  where (select count(1) " +                          
              "           from DV_SCQINVFIHIST vhist " +                                                     
              "          where vhist.t_PartyID = party.t_PartyId " +                                        
              "            and vhist.t_State = " +string(ÑéëíìèÖç)+                                                       
              "            and vhist.t_AvoirKind = t.t_AvoirKind " +                                        
              "            and vhist.t_BegDate <= ? " +                                                     
              "            and (vhist.t_EndDate >= ? or vhist.t_EndDate = '01.01.0001')) > 0  " +                
              "    and party.t_LegalForm = ?) "; 
                                          
    
     Query = "select avrkind.t_Name, NVL("+Query1+",0) as FL, NVL("+Query1+",0) as UL " +                                                                                                  
             " from ( select t1.t_AvoirKind from DV_SCQINVFIHIST t1 " +                                                                           
             "         where t1.t_State = " +string(ÑéëíìèÖç)+                                                       
             "           and t1.t_BegDate <= ? " +                                                     
             "           and (t1.t_EndDate >= ? or t1.t_EndDate = '01.01.0001') " +                
             "        group by t1.t_AvoirKind " +                                                                                                
             "        order by t1.t_AvoirKind) t, davrkinds_dbt avrkind " +                                                                      
             " where avrkind.t_FI_KIND = 2 " +                                                                                                  
             "   and avrkind.t_AvoirKind = t.t_AvoirKind " +                                                                                   
             " order by avrkind.t_Numlist ";                                                                                                    
                            
     Sql = RSDCommand(Query);                                                            
     Sql.addParam( "", RSDBP_IN, m_EndDate );
     Sql.addParam( "", RSDBP_IN, m_BegDate );
     Sql.addParam( "", RSDBP_IN, 2 );
     Sql.addParam( "", RSDBP_IN, m_EndDate );
     Sql.addParam( "", RSDBP_IN, m_BegDate );
     Sql.addParam( "", RSDBP_IN, 1 );
     Sql.addParam( "", RSDBP_IN, m_EndDate );
     Sql.addParam( "", RSDBP_IN, m_BegDate );
     Sql.execute();

     Set = TRsbDataSet(Sql);
 
     RegisterRepTable5_1();

     while( Set.MoveNext() )
        PrintRepTableLine5_1(Num,Set.Name,Set.FL,Set.UL);
        IsExistsData = true;
        Num = Num + 1;
     end;

     if( not IsExistsData )
        Merge( "A5_13_1", "A5_13_8", null);
        Merge( "A5_14_1", "A5_14_8", null);
        PrintTableLine( "A5_11", "", null,                       
                        "A5_12", "", null,                                   
                        "A5_13_1","", null,                                   
                        "A5_14_1", "", null      
                      );                                                              
     end;

     EndRepTable();                                                
  END;

  MACRO PrintPart5_2()/*ß†ØÆ´≠•≠®• - 2 ÆÁ•‡•§Ï*/
     RegisterRepTable5_2();
     PrintRepTableLine5_2();
     EndRepTable();                                                
  END;

  MACRO GetSecDealSum(LegalForm:integer)
     var Sql, Set, FD, LegKind; 
     var DealSum = $0., CFI = $0., Price = $0., NKD = $0.;
     var Leg         = TRecHandler( "dl_leg" ), 
         DealChange  = TRecHandler( "sptkchng" );

     Sql = RSDCommand(" select rq.t_DocID, rq.t_DealPart, rq.t_FactDate, rq.t_type " + 
                      "   from ddlrq_dbt rq, ddl_tick_dbt tick  " +
                      "  where rq.t_FactDate  >= ? "  + 
                      "    and rq.t_FactDate  <= ? "  + 
                      "    and rq.t_DocKind = " + string(DL_SECURITYDOC) + 
                      "    and tick.t_DealID =  rq.t_DocID  " +
                      "    and tick.t_BofficeKind = rq.t_DocKind " + 
                      "    and (NVL((select SCQINV.t_kind " +
                      "           from dparty_dbt party, DSCQINV_DBT SCQINV, DV_SCQINVHIST t " +
                      "          where party.T_PARTYID = tick.t_PartyID " +
                      "            and party.T_LEGALFORM = ? " +
                      "            and SCQINV.T_PARTYID = party.T_PARTYID "+
                      "            and t.t_PartyID = SCQINV.T_PARTYID " +
                      "            and t.t_State = "+string(ÇäãûóÖç)+
                      "            and t.t_BegDate <= tick.t_DealDate " +
                      "            and (t.t_EndDate >= tick.t_DealDate or t.t_EndDate = '01.01.0001')),-1) = "+string(èé_áÄüÇãÖçàû)+
                      "        or " +
                      "        NVL((select SCQINV.t_kind " +
                      "           from dparty_dbt party, DSCQINV_DBT SCQINV, DV_SCQINVHIST t " +
                      "          where party.T_PARTYID = tick.t_ClientID " +
                      "            and party.T_LEGALFORM = ? " +
                      "            and SCQINV.T_PARTYID = party.T_PARTYID "+
                      "            and t.t_PartyID = SCQINV.T_PARTYID " +
                      "            and t.t_State = "+string(ÇäãûóÖç)+
                      "            and t.t_BegDate <= tick.t_DealDate " +
                      "            and (t.t_EndDate >= tick.t_DealDate or t.t_EndDate = '01.01.0001')),-1) = "+string(èé_áÄüÇãÖçàû)+" )"+
                      "    and (select count(1) " +
                      "           FROM dobjatcor_dbt attr " + 
                      "          WHERE attr.t_ObjectType = " + string(OBJTYPE_AVOIRISS) +
                      "            and attr.t_GroupID = 34 " +
                      "            AND attr.t_Object = LPAD(rq.t_FIID, 10, '0') " +
                      "            AND attr.t_AttrID = 1 " +
                      "            AND attr.T_VALIDTODATE >= ? ) > 0 " +  
                      "   and( rq.t_State = " + string(DLRQ_STATE_EXEC)+                  //DLRQ_STATE_EXEC
                      "       OR rq.t_State >= " + string(DLRQ_STATE_GO_CLOSE) + ") " +
                      "   and tick.t_Department = ?");

                                                            
     Sql.addParam( "", RSDBP_IN, m_BegDate );
     Sql.addParam( "", RSDBP_IN, m_EndDate );
     Sql.addParam( "", RSDBP_IN, LegalForm );
     Sql.addParam( "", RSDBP_IN, LegalForm );
     Sql.addParam( "", RSDBP_IN, m_BegDate );
     Sql.addParam( "", RSDBP_IN, {OperDprt} );
     Sql.execute();               
     
     Set = TRsbDataSet(Sql);
     while( Set.MoveNext() )
         if( (Set.DealPart == 2) and (Set.type == DLRQ_TYPE_DELIVERY))
            LegKind = LEG_KIND_DL_TICK_BACK;
         else
            LegKind = LEG_KIND_DL_TICK;
         end;

         FD = SPFirstDoc( LegKind, Set.DocID );
         GetDlLegByDealID( Set.DocID, LegKind, false, false, Leg );
         if( Leg.rec.ID == 0 )
            UniqStr.AddString( "ç• ¨Æ£„ ØÆ´„Á®‚Ï §†≠≠Î• ·§•´™® (DealID = "+String(Set.DocID)+")");
         end;

         if( not WasRejectDealPart(Leg.rec,m_EndDate) )
            /*v.  Ö·´® ØÆ ·§•´™• Ø‡Æ¢Æ§®´®·Ï ®ß¨•≠•≠®Ô „·´Æ¢®©, 
                  ‚Æ ¢ Æ‚Á•‚ ¢ÂÆ§®‚ ·§•´™† · ‚•¨® „·´Æ¢®Ô¨®, ™Æ‚Æ‡Î• ·„È•·‚¢Æ¢†´® ØÆ ·Æ·‚ÆÔ≠®Ó ≠† Æ™Æ≠Á†≠®• Æ‚Á•‚≠Æ£Æ Ø•‡®Æ§†*/                                                             
            SP_GetDealParmsByDate( FD.tick, m_EndDate, DealChange, false, true );
            if( FD.IsBack )       
               CFI = DealChange.rec.OldCFI2;
            else
               CFI = DealChange.rec.OldCFI1;
            end;
            Price = GetPriceByDlTickDlLeg( FD.tick.rec, FD.dl_leg.rec, false, DealChange.rec, Date(Set.FactDate) );

            if( CFI != NATCUR )
               if( not SmartConvertSumDbl(Price, Price, Date(Set.FactDate), CFI, NATCUR, false) )
                  UniqStr.AddString( GetCurrencyConvertErrorMsg(CFI, NATCUR,Date(Set.FactDate)) )
               end;
            end;
                                   
            /*i.  ë„¨¨† ·§•´™® ¢™´ÓÁ†•‚ çäÑ ® ‡†··Á®‚Î¢†•‚·Ô ¢ ‚Î·. ‡„°´•©:
            "  §´Ô ¢·•Â ·Æ°·‚¢•≠≠ÎÂ ·§•´Æ™ ® ™´®•≠‚·™®Â ·§•´Æ™ ØÆ ™„‡·„ ≠† ‰†™‚®Á•·™„Ó §†‚„ ØÆ·‚†¢™®,
            "  çäÑ ‡†··Á®‚Î¢†•‚·Ô ≠† ‰†™‚®Á•·™„Ó §†‚„ ØÆ·‚†¢™®
            */
            if(FI_IsAvrKindCoupon(FD.fininstr.rec.AvoirKind))
               NKD = çäÑ(FD.fininstr.rec.FIID, DealChange.rec.OldPrincipal, Date(Set.FactDate));
               if( FD.fininstr.rec.FaceValueFI != NATCUR )
                  if( not SmartConvertSumDbl(NKD, NKD, Date(Set.FactDate), FD.fininstr.rec.FaceValueFI, NATCUR, false) )
                     UniqStr.AddString( GetCurrencyConvertErrorMsg(CFI, NATCUR,Date(Set.FactDate)) )
                  end;
               end;                                                         
            end;
            DealSum = DealSum + Price*DealChange.rec.OldPrincipal + NKD;
         end;
     end;

     return DealSum;
  END;

  MACRO è•Á†‚ÏÇíÎ·ÔÁ†Â(DealSum:double)
     if(DealSum > $0. )
        return ó®·´ÆCá†§†≠≠Æ©íÆÁ≠Æ·‚ÏÓ( DealSum/1000.0, 5 );
     end;
     return "";
  END;

  MACRO PrintPart6()
     var SecDealSumFL = GetSecDealSum(2), SecDealSumUL = GetSecDealSum(1);

     PrintFormatString( Part6,                                     
                        "A6_1"+WithApp(), è•Á†‚ÏÇíÎ·ÔÁ†Â(SecDealSumFL), 
                        "A6_2"+WithApp(), è•Á†‚ÏÇíÎ·ÔÁ†Â(SecDealSumFL),
                        "A6_3", "",/*≠• ß†ØÆ´≠Ô•‚·Ô*/
                        "A6_4", "",/*≠• ß†ØÆ´≠Ô•‚·Ô*/
                        "A6_5"+WithApp(), è•Á†‚ÏÇíÎ·ÔÁ†Â(SecDealSumUL),
                        "A6_6"+WithApp(), è•Á†‚ÏÇíÎ·ÔÁ†Â(SecDealSumUL),
                        "A6_7", "",/*≠• ß†ØÆ´≠Ô•‚·Ô*/
                        "A6_8", "" /*≠• ß†ØÆ´≠Ô•‚·Ô*/
                       );                                                     
  END;

  PRIVATE MACRO Create()
     var Num = 0;
    /*Ç·• ‡†ß§•´Î ‰Æ‡¨®‡„Ó‚·Ô ¢·•£§†, ≠• ß†¢®·®¨Æ Æ‚ ≠†´®Á®Ô §†≠≠ÎÂ ¢ ·®·‚•¨•.*/
     PrintPart1();
     PrintPart2();
     PrintPart3();
     PrintPart4();
     PrintPart5_1();
     PrintPart5_2();
     PrintPart6();

     if( UniqStr.Size > 0 )
       if( not m_PrintExel )
          PrintFormatString( "\nè‡Æ‚Æ™Æ´ ¢ÎØÆ´≠•≠®Ô\n" );
       end;
       while( Num < UniqStr.Size )
          if( not m_PrintExel )
             PrintFormatString( UniqStr.(Num) );
          else
             msgbox( UniqStr.(Num) ); 
          end;
          Num = Num + 1;         
       end;
     end;

  END;
  
  initDL_CReportTemplate( DL_KvalInv_Panel(), "Report_KvalInv.xls" );
END;

DL_KvalInv_Report().Run();
Exit(1);