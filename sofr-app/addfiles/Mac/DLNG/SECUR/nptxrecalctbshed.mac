/*
$Name:         nptxrecalctbshed.mac
$Module:       БОЦБ
$Description:  Создание и выполнение операций пересчета СНОБ через планировщик 
*/

import "dlquery.mac", BankInter, CTInter, DealsInter, globals, OprInter, secinter, spserv;

private macro Exec()
  var err = 0, ErrStr = "";

  ErrStr = "";
  DL_CreateAndExecuteRecalcTB(-1, {curdate}, true, true, ErrStr);
  if(ErrStr != "")
    msgbox(ErrStr);
  end;
end;

var saveDialogFlag = SetDialogFlag(0);
if(IsShedulerRunning())
  Exec();
end;
SetDialogFlag(saveDialogFlag);