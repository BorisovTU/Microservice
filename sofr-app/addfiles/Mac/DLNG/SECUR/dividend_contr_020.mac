/*
$Name:         dividend_contr_020.mac
$Module:       Ценные бумаги
$Description:  Операция получения дивидендов по РЕПО (от Контрагента)
*/
/*  Подготовка планового платежа. Формирование ТО*/

import InsCarryDoc, "sp_class.mac", "sp_caracc.mac", "sp_car2.mac", "spservsql.mac", "SPQICheckOper.mac", "nutxfun.mac";
 
macro ExecuteStep( Doc, FDoc )   


    record deal(DL_TICK);
    SetBuff( deal, FDoc ); 
    
    VAR FD = SPFirstDoc( deal );  
    var rq = FD.GetRQ(DLRQ_TYPE_PAYMENT).rec;

    if ( (rq.Amount != FD.dl_leg.rec.ReceiptAmount) OR (rq.FIID != FD.tick.rec.CurGet) )
        MsgBox("ТО не соответствует параметрам формы операции!");
        return 1;
    end;

    return 0; 
end;



