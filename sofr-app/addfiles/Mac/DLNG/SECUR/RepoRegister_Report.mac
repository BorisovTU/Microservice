/**
 @file RepoRegister_Report.mac
 @brief Отчет "Регистры РЕПО" (НУ)
 @note Регистры считаются устаревшими. Прямого запуска из АРНУ нет.

 Печать отчета "Регистры РЕПО" (НУ) регистры 501-506,508

 # tag 
 - functional_block:Налоги_Отчеты
 - code_type:Report
 - АРНУ
   
 # changeLog 
 |date       |author         |tasks            |note                            
 |-----------|---------------|-----------------|--------------------------------
 |2023.09.19 |Фаршатов Г. К. |CCBO-7602        | Добавлены комментарии          
 |           |               |                 |                   

*/ 
IMPORT "RepoRegister_Form.mac";

/*Здесь можно через "," в апострофах указать код (FININSTR.FI_Code) ценных бумаг, которые будут исключаться из отчета.
  Например: 
    ИсключаемыеИзОтчетаЦБ_050 = "'1','2','3'"
*/
PRIVATE CONST ИсключаемыеИзОтчетаЦБ_050 = "";

PRIVATE VAR   RepoRegister_Form;
PRIVATE VAR   RepoRegister_Report;
PRIVATE VAR   WebMenuItem; // Информация о запуске отчета из веб

PRIVATE CONST SHEET_0501 = "0501";
PRIVATE CONST SHEET_0502 = "0502";
PRIVATE CONST SHEET_0503 = "0503";
PRIVATE CONST SHEET_0504 = "0504";
PRIVATE CONST SHEET_0505 = "0505";
PRIVATE CONST SHEET_0506 = "0506";
PRIVATE CONST SHEET_0508 = "0508";

/**
 @brief Класс отчета по 501 регистру
 
 Класс для отчета по валютным сделкам прямого РЕПО
*/
PRIVATE CLASS CRepoReg_501( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0501, "N1_" );

     m_Report.RegisterTable( "N1_MainTable", "",
                             "N1_SecCode",       "N1_SecName",      "N1_CodeR",        "N1_DZ",            "N1_Qnty",
                             "N1_VP",            "N1_DD1",          "N1_DP1",          "N1_Tot1vp",        "N1_Rate",
                             "N1_CoupN",         "N1_CoupVp",       "N1_AmortN",       "N1_AmortVp",       "N1_NMC",
                             "N1_MCvp",          "N1_PaySecCnt",    "N1_PaySecTot",    "N1_DD2",           "N1_DP2",
                             "N1_Tot2vp",        "N1_Trepo",        "N1_Trep",         
                             "N1_DohPrevVp",     "N1_DohRepVp",     "N1_TaxDohRepRub",
                             "N1_DifDohRepRub",  "N1_RashPrevVp",   "N1_RashRepVP",    "N1_TaxPashRepRub", "N1_DifRashRepRub",
                             "N1_Cont",          "N1_Com",          "N1_Yrepo",        "N1_MonthRepo",     "N1_ifDone2",
                             "N1_SumCalc2vp",    "N1_SumDeal2vp",   "N1_ContSum2",     "N1_ContD1",        "N1_ContD2",
                             "N1_CoupD1D2Vn",    "N1_CoupD1endVN",  "N1_CoupBegEndVn", "N1_AmortD1D2Vn",   "N1_AmortD1endVn",
                             "N1_AmortBegEndVn", "N1_DfixDiv",      "N1_StRate",       "N1_DifRate",
                             "N1_CBchange",      "N1_FRate",        "N1_IsBlock",      "N1_Dqual",
                             "N1_Fil",           "N1_SecType",      "N1_Dep"
                           );

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(), 
                                "N1_Qnty",6, "N1_Tot1vp",2, "N1_CoupN",0, "N1_CoupVp",2, "N1_AmortN",0, "N1_AmortVp",2, "N1_NMC",0,
                                "N1_MCvp",0, "N1_PaySecCnt",2, "N1_PaySecTot",2, "N1_Tot2vp",2, "N1_DohPrevVp",2, "N1_DohRepVp",2,
                                "N1_TaxDohRepRub",2, "N1_DifDohRepRub",2, "N1_RashPrevVp",2, "N1_RashRepVP",2, "N1_TaxPashRepRub",2, 
                                "N1_DifRashRepRub",2, "N1_Com",2, "N1_SumCalc2vp",2, "N1_SumDeal2vp",2, "N1_ContSum2",2, "N1_ContD1",0,
                                "N1_ContD2",0, "N1_CoupD1D2Vn",2, "N1_CoupD1endVN",2, "N1_CoupBegEndVn",2, "N1_AmortD1D2Vn",2, "N1_AmortD1endVn",2,
                                "N1_AmortBegEndVn",2);

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()
     
     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",             
                        "I23",           
                        "K23",            
                        "L23",           
                        "M23",           
                        "N23",          
                        "O23",              
                        "P23",             
                        "Q23",        
                        "R23",        
                        "U23",           
                        "X23",        
                        "Y23",         
                        "Z23",     
                        "AA23",     
                        "AB23",       
                        "AC23",        
                        "AD23",    
                        "AE23",    
                        "AG23",              
                        "AK23",       
                        "AL23",       
                        "AM23",         
                        "AN23",           
                        "AO23",           
                        "AP23",       
                        "AQ23",      
                        "AR23",     
                        "AS23",      
                        "AT23",     
                        "AU23"    
                      );
  END;

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )
        m_Report.PrintTableLine( "N1_SecCode",       m_Report.SecCode(),         null,               //1
                                 "N1_SecName",       m_Report.SecName(),         null,               //2
                                 "N1_CodeR",         m_Report.CodeR(),           null,               //3
                                 "N1_DZ",            m_Report.DZ(),              null,               //4
                                 "N1_Qnty",          m_Report.Qnty(),            SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),   //5
                                 "N1_VP",            m_Report.VP(),              null,               //6
                                 "N1_DD1",           m_Report.DD1(),             null,               //7
                                 "N1_DP1",           m_Report.DP1(),             null,               //8
                                 "N1_Tot1vp",        m_Report.Tot1vp(),          null,               //9
                                 "N1_Rate",          m_Report.Rate(),            m_Report.Point(),   //10
                                 "N1_CoupN",         m_Report.CoupN(),           null,               //11
                                 "N1_CoupVp",        m_Report.CoupVp(),          null,               //12
                                 "N1_AmortN",        m_Report.AmortN(),          null,               //13
                                 "N1_AmortVp",       m_Report.AmortVp(),         null,               //14
                                 "N1_NMC",           m_Report.NMC(),             null,               //15
                                 "N1_MCvp",          m_Report.MCvp(),            null,               //16
                                 "N1_PaySecCnt",     m_Report.PaySecCnt(),       null,               //17
                                 "N1_PaySecTot",     m_Report.PaySecTot(),       null,               //18
                                 "N1_DD2",           m_Report.DD2(),             null,               //19
                                 "N1_DP2",           m_Report.DP2(),             null,               //20
                                 "N1_Tot2vp",        m_Report.Tot2vp(),          null,               //21
                                 "N1_Trepo",         m_Report.Trepo(),           null,               //22
                                 "N1_Trep",          m_Report.Trep(),            null,               //23
                                 "N1_DohPrevVp",     m_Report.DohPrevVp(),       null,               //24
                                 "N1_DohRepVp",      m_Report.DohRepVp(),        null,               //25
                                 "N1_TaxDohRepRub",  m_Report.TaxDohRepRub(),    null,               //26
                                 "N1_DifDohRepRub",  m_Report.DifDohRepRub(),    null,               //27
                                 "N1_RashPrevVp",    m_Report.RashPrevVp(),      null,               //28
                                 "N1_RashRepVP",     m_Report.RashRepVP(),       null,               //29
                                 "N1_TaxPashRepRub", m_Report.TaxPashRepRub(),   null,               //30
                                 "N1_DifRashRepRub", m_Report.DifRashRepRub(),   null,               //31
                                 "N1_Cont",          m_Report.Cont(),            null,               //32
                                 "N1_Com",           m_Report.Com(),             null,               //33
                                 "N1_Yrepo",         m_Report.Yrepo(),           null,               //T1
                                 "N1_MonthRepo",     m_Report.MonthRepo(),       null,               //T2
                                 "N1_ifDone2",       m_Report.ifDone2(),         null,               //T3
                                 "N1_SumCalc2vp",    m_Report.SumCalc2vp(),      null,               //T4
                                 "N1_SumDeal2vp",    m_Report.SumDeal2vp(),      null,               //T5
                                 "N1_ContSum2",      m_Report.ContSum2(),        null,               //T6
                                 "N1_ContD1",        m_Report.ContD1(),          null,               //T7
                                 "N1_ContD2",        m_Report.ContD2(),          null,               //T8
                                 "N1_CoupD1D2Vn",    m_Report.CoupD1D2Vn(),      null,               //T9
                                 "N1_CoupD1endVN",   m_Report.CoupD1endVN(),     null,               //T10
                                 "N1_CoupBegEndVn",  m_Report.CoupBegEndVn(),    null,               //T11
                                 "N1_AmortD1D2Vn",   m_Report.AmortD1D2Vn(),     null,               //T12
                                 "N1_AmortD1endVn",  m_Report.AmortD1endVn(),    null,               //T13
                                 "N1_AmortBegEndVn", m_Report.AmortBegEndVn(),   null,               //T14
                                 "N1_DfixDiv",       m_Report.DfixDiv(),         null,               //T15
                                 "N1_StRate",        m_Report.StRate(),          null,               //T16
                                 "N1_DifRate",       m_Report.DifRate(),         null,               //T18
                                 "N1_CBchange",      m_Report.CBchange(),        null,               //T19
                                 "N1_FRate",         m_Report.FRate(),           null,               //T20
                                 "N1_IsBlock",       m_Report.IsBlock(),         null,               //T21
                                 "N1_Dqual",         m_Report.Dqual(),           null,               //T22
                                 "N1_Fil",           m_Report.Fil(),             null,               //T23
                                 "N1_SecType",       m_Report.SecType(),         null,               //T24
                                 "N1_Dep",           m_Report.Dep(),             null
                               );

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N1_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N1_SecCode",  "в том числе:", null );
     end;
  END;

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N1_" );
  END;         
END;

/**
 @brief Класс отчета по 502 регистру
 
 Класс для отчета по рублевым сделкам прямого РЕПО
*/
PRIVATE CLASS CRepoReg_502( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0502, "N2_");

     m_Report.RegisterTable( "N2_MainTable", "",
                             "N2_SecCode",       "N2_SecName",      "N2_CodeR",         "N2_DZ",            "N2_Qnty",          "N2_VP",
                             "N2_DD1",           "N2_DP1",          "N2_Tot1vp",        "N2_Rate",          "N2_CoupN",         "N2_CoupVp",
                             "N2_AmortN",        "N2_AmortVp",      "N2_NMC",           "N2_MCvp",          "N2_PaySecCnt",     "N2_PaySecTot",
                             "N2_DD2",           "N2_DP2",          "N2_Tot2vp",        "N2_Trepo",         "N2_Trep",          
                             "N2_DohPrevVp",     "N2_DohRepVp",     "N2_TaxDohRepRub",
                             "N2_DifDohRepRub",  "N2_RashPrevVp",   "N2_RashRepVP",     "N2_TaxPashRepRub", "N2_DifRashRepRub", "N2_Cont",
                             "N2_Com",           "N2_Yrepo",        "N2_MonthRepo",     "N2_ifDone2",       "N2_SumCalc2vp",    "N2_SumDeal2vp",
                             "N2_ContSum2",      "N2_ContD1",       "N2_ContD2",        "N2_CoupD1D2Vn",    "N2_CoupD1endVN",   "N2_CoupBegEndVn",
                             "N2_AmortD1D2Vn",   "N2_AmortD1endVn", "N2_AmortBegEndVn", "N2_DfixDiv",       "N2_StRate",          
                             "N2_DifRate",       "N2_CBchange",     "N2_FRate",         "N2_IsBlock",       "N2_Dqual",         
                             "N2_Fil",           "N2_SecType",      "N2_Dep");

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(), 
                                "N2_Qnty",6, "N2_Tot1vp",2, "N2_CoupN",0, "N2_CoupVp",2,
                                "N2_AmortN",0, "N2_AmortVp",2, "N2_NMC",0, "N2_MCvp",2, "N2_PaySecCnt",0, "N2_PaySecTot",0,
                                "N2_Tot2vp",2, "N2_DohPrevVp",2, "N2_DohRepVp",2, "N2_TaxDohRepRub",2,
                                "N2_DifDohRepRub",2, "N2_RashPrevVp",2, "N2_RashRepVP",2, "N2_TaxPashRepRub",2, "N2_DifRashRepRub",2,
                                "N2_Com",2, "N2_SumCalc2vp",2, "N2_SumDeal2vp",2, "N2_ContSum2",2, "N2_ContD1",0, "N2_ContD2",0, "N2_CoupD1D2Vn",2,
                                "N2_CoupD1endVN",2, "N2_CoupBegEndVn",2, "N2_AmortD1D2Vn",2,   "N2_AmortD1endVn",2, "N2_AmortBegEndVn",2
                              );

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()
     
     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",             
                        "I23",           
                        "K23",            
                        "L23",           
                        "M23",           
                        "N23",          
                        "O23",              
                        "P23",             
                        "Q23",        
                        "R23",        
                        "U23",           
                        "X23",         
                        "Y23",          
                        "Z23",      
                        "AA23",     
                        "AB23",       
                        "AC23",        
                        "AD23",    
                        "AE23",    
                        "AG23",              
                        "AK23",       
                        "AL23",       
                        "AM23",         
                        "AN23",           
                        "AO23",           
                        "AP23",       
                        "AQ23",      
                        "AR23",     
                        "AS23",      
                        "AT23",     
                        "AU23"    
                      );

  END;

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )
        m_Report.PrintTableLine( "N2_SecCode",        m_Report.SecCode(),          null,              //1  
                                 "N2_SecName",        m_Report.SecName(),          null,              //2  
                                 "N2_CodeR",          m_Report.CodeR(),            null,              //3  
                                 "N2_DZ",             m_Report.DZ(),               null,              //4  
                                 "N2_Qnty",           m_Report.Qnty(),             SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),              //5  
                                 "N2_VP",             m_Report.VP(),               null,              //6  
                                 "N2_DD1",            m_Report.DD1(),              null,              //7  
                                 "N2_DP1",            m_Report.DP1(),              null,              //8  
                                 "N2_Tot1vp",         m_Report.Tot1vp(),           null,              //9  
                                 "N2_Rate",           m_Report.Rate(),             m_Report.Point(),  //10 
                                 "N2_CoupN",          m_Report.CoupN(),            null,              //11 
                                 "N2_CoupVp",         m_Report.CoupVp(),           null,              //12 
                                 "N2_AmortN",         m_Report.AmortN(),           null,              //13 
                                 "N2_AmortVp",        m_Report.AmortVp(),          null,              //14 
                                 "N2_NMC",            m_Report.NMC(),              null,              //15 
                                 "N2_MCvp",           m_Report.MCvp(),             null,              //16 
                                 "N2_PaySecCnt",      m_Report.PaySecCnt(),        null,              //17 
                                 "N2_PaySecTot",      m_Report.PaySecTot(),        null,              //18 
                                 "N2_DD2",            m_Report.DD2(),              null,              //19 
                                 "N2_DP2",            m_Report.DP2(),              null,              //20 
                                 "N2_Tot2vp",         m_Report.Tot2vp(),           null,              //21 
                                 "N2_Trepo",          m_Report.Trepo(),            null,              //22 
                                 "N2_Trep",           m_Report.Trep(),             null,              //23 
                                 "N2_DohPrevVp",      m_Report.DohPrevVp(),        null,              //24 
                                 "N2_DohRepVp",       m_Report.DohRepVp(),         null,              //25 
                                 "N2_TaxDohRepRub",   m_Report.TaxDohRepRub(),     null,              //26 
                                 "N2_DifDohRepRub",   m_Report.DifDohRepRub(),     null,              //27 
                                 "N2_RashPrevVp",     m_Report.RashPrevVp(),       null,              //28 
                                 "N2_RashRepVP",      m_Report.RashRepVP(),        null,              //29 
                                 "N2_TaxPashRepRub",  m_Report.TaxPashRepRub(),    null,              //30 
                                 "N2_DifRashRepRub",  m_Report.DifRashRepRub(),    null,              //31 
                                 "N2_Cont",           m_Report.Cont(),             null,              //32 
                                 "N2_Com",            m_Report.Com(),              null,              //33 
                                 "N2_Yrepo",          m_Report.Yrepo(),            null,              //T1 
                                 "N2_MonthRepo",      m_Report.MonthRepo(),        null,              //T2 
                                 "N2_ifDone2",        m_Report.ifDone2(),          null,              //T3 
                                 "N2_SumCalc2vp",     m_Report.SumCalc2vp(),       null,              //T4 
                                 "N2_SumDeal2vp",     m_Report.SumDeal2vp(),       null,              //T5 
                                 "N2_ContSum2",       m_Report.ContSum2(),         null,              //T6 
                                 "N2_ContD1",         m_Report.ContD1(),           null,              //T7 
                                 "N2_ContD2",         m_Report.ContD2(),           null,              //T8 
                                 "N2_CoupD1D2Vn",     m_Report.CoupD1D2Vn(),       null,              //T9 
                                 "N2_CoupD1endVN",    m_Report.CoupD1endVN(),      null,              //T10
                                 "N2_CoupBegEndVn",   m_Report.CoupBegEndVn(),     null,              //T11
                                 "N2_AmortD1D2Vn",    m_Report.AmortD1D2Vn(),      null,              //T12
                                 "N2_AmortD1endVn",   m_Report.AmortD1endVn(),     null,              //T13
                                 "N2_AmortBegEndVn",  m_Report.AmortBegEndVn(),    null,              //T14
                                 "N2_DfixDiv",        m_Report.DfixDiv(),          null,              //T15
                                 "N2_StRate",         m_Report.StRate(),           null,              //T16
                                 "N2_DifRate",        m_Report.DifRate(),          null,              //T18
                                 "N2_CBchange",       m_Report.CBchange(),         null,              //T19
                                 "N2_FRate",          m_Report.FRate(),            null,              //T20
                                 "N2_IsBlock",        m_Report.IsBlock(),          null,              //T21
                                 "N2_Dqual",          m_Report.Dqual(),            null,              //T22
                                 "N2_Fil",            m_Report.Fil(),              null,              //T23
                                 "N2_SecType",        m_Report.SecType(),          null,              //T24
                                 "N2_Dep",            m_Report.Dep(),              null
                               );

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N2_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N2_SecCode",  "в том числе:", null );
     end;
  END;         

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N2_" );
  END;         
END;

/**
 @brief Класс отчета по 503 регистру
 
 Класс для отчета по валютным сделкам обратного РЕПО
*/
PRIVATE CLASS CRepoReg_503( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0503, "N3_" );

     m_Report.RegisterTable( "N3_MainTable", "",
                             "N3_SecCode",       "N3_SecName",       "N3_CodeR",         "N3_DZ",             "N3_Qnty",          "N3_VP",
                             "N3_DD1",           "N3_DP1",           "N3_Tot1vp",        "N3_Rate",           "N3_CoupN",         "N3_CoupVp",
                             "N3_AmortN",        "N3_AmortVp",       "N3_NMC",           "N3_MCvp",           "N3_PaySecCnt",     "N3_PaySecTot",
                             "N3_DD2",           "N3_DP2",           "N3_Tot2vp",        "N3_Trepo",          "N3_Trep",          
                             "N3_DohPrevVp",     "N3_DohPrevRub",    "N3_DohRepVp",
                             "N3_DohRepRub",     "N3_TaxDohRepRub",  "N3_DifDohRepRub",  "N3_RashPrevVp",     "N3_RashPrevRub",   "N3_RashRepVP",
                             "N3_RashRepRub",    "N3_TaxPashRepRub", "N3_DifRashRepRub", "N3_Cont",           "N3_Com",           "N3_PereocDohAll",
                             "N3_PereocDohPrev", "N3_PereocDohRep",  "N3_PereocRashAll", "N3_PereocRashPrev", "N3_PereocRashRep", "N3_Yrepo", 
                             "N3_MonthRepo",     "N3_ifDone2",       "N3_SumCalc2vp",    "N3_SumDeal2vp",     "N3_ContSum2",      "N3_ContD1",    
                             "N3_ContD2",        "N3_CoupD1D2Vn",    "N3_CoupD1endVN",   "N3_CoupBegEndVn",   "N3_AmortD1D2Vn",   "N3_AmortD1endVn",  
                             "N3_AmortBegEndVn", "N3_DfixDiv",       "N3_StRate",        "N3_DifRate",        
                             "N3_CBchange",      "N3_FRate",         "N3_IsBlock",       "N3_Dqual",         
                             "N3_Fil",           "N3_SecType",       "N3_Dep"                        
                           );

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(),
                                "N3_Qnty",6,"N3_Tot1vp",2, "N3_CoupN",0, "N3_CoupVp",2, "N3_AmortN",0, "N3_AmortVp",2, "N3_NMC",0, "N3_MCvp",2,
                                "N3_PaySecCnt",0, "N3_PaySecTot",0, "N3_Tot2vp",2, "N3_DohPrevVp",2, "N3_DohPrevRub",2, "N3_DohRepVp",2,
                                "N3_DohRepRub",2, "N3_TaxDohRepRub",2, "N3_DifDohRepRub",2, "N3_RashPrevVp",2, "N3_RashPrevRub",2, "N3_RashRepVP",2,
                                "N3_RashRepRub",2, "N3_TaxPashRepRub",2, "N3_DifRashRepRub",2, "N3_Com",2, "N3_PereocDohAll",2,
                                "N3_PereocDohPrev",2, "N3_PereocDohRep",2, "N3_PereocRashAll",2, "N3_PereocRashPrev",2, "N3_PereocRashRep",2,
                                "N3_SumCalc2vp",2, "N3_SumDeal2vp",2, "N3_ContSum2",2, "N3_ContD1",0,
                                "N3_ContD2",0,  "N3_CoupD1D2Vn",2, "N3_CoupD1endVN",2, "N3_CoupBegEndVn",2, "N3_AmortD1D2Vn",2, "N3_AmortD1endVn",2,
                                "N3_AmortBegEndVn",2);

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()
     
     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",                   
                        "I23",                 
                        "K23",                  
                        "L23",                 
                        "M23",                 
                        "N23",                
                        "O23",                    
                        "P23",                   
                        "Q23",              
                        "R23",              
                        "U23",                 
                        "X23",              
                        "Y23",             
                        "Z23",               
                        "AA23",              
                        "AB23",           
                        "AC23",           
                        "AD23",             
                        "AE23",            
                        "AF23",              
                        "AG23",             
                        "AH23",          
                        "AI23",          
                        "AK23",                    
                        "AL23",           
                        "AN23",          
                        "AM23",           
                        "AO23",          
                        "AP23",         
                        "AQ23",          
                        "AU23",             
                        "AV23",             
                        "AW23",               
                        "AX23",                 
                        "AY23",                 
                        "AZ23",             
                        "BA23",            
                        "BB23",           
                        "BC23",            
                        "BD23",           
                        "BE23"          
                    );

  END; 

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )
        m_Report.PrintTableLine( "N3_SecCode",        m_Report.SecCode(),           null,               //1  
                                 "N3_SecName",        m_Report.SecName(),           null,               //2  
                                 "N3_CodeR",          m_Report.CodeR(),             null,               //3  
                                 "N3_DZ",             m_Report.DZ(),                null,               //4  
                                 "N3_Qnty",           m_Report.Qnty(),              SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),               //5  
                                 "N3_VP",             m_Report.VP(),                null,               //6  
                                 "N3_DD1",            m_Report.DD1(),               null,               //7  
                                 "N3_DP1",            m_Report.DP1(),               null,               //8  
                                 "N3_Tot1vp",         m_Report.Tot1vp(),            null,               //9  
                                 "N3_Rate",           m_Report.Rate(),              m_Report.Point(),   //10 
                                 "N3_CoupN",          m_Report.CoupN(),             null,               //11 
                                 "N3_CoupVp",         m_Report.CoupVp(),            null,               //12 
                                 "N3_AmortN",         m_Report.AmortN(),            null,               //13 
                                 "N3_AmortVp",        m_Report.AmortVp(),           null,               //14 
                                 "N3_NMC",            m_Report.NMC(),               null,               //15 
                                 "N3_MCvp",           m_Report.MCvp(),              null,               //16 
                                 "N3_PaySecCnt",      m_Report.PaySecCnt(),         null,               //17 
                                 "N3_PaySecTot",      m_Report.PaySecTot(),         null,               //18 
                                 "N3_DD2",            m_Report.DD2(),               null,               //19 
                                 "N3_DP2",            m_Report.DP2(),               null,               //20 
                                 "N3_Tot2vp",         m_Report.Tot2vp(),            null,               //21 
                                 "N3_Trepo",          m_Report.Trepo(),             null,               //22 
                                 "N3_Trep",           m_Report.Trep(),              null,               //23 
                                 "N3_DohPrevVp",      m_Report.DohPrevVp(),         null,               //24 
                                 "N3_DohPrevRub",     m_Report.DohPrevRub(),        null,               //25 
                                 "N3_DohRepVp",       m_Report.DohRepVp(),          null,               //26 
                                 "N3_DohRepRub",      m_Report.DohRepRub(),         null,               //27 
                                 "N3_TaxDohRepRub",   m_Report.TaxDohRepRub(),      null,               //28 
                                 "N3_DifDohRepRub",   m_Report.DifDohRepRub(),      null,               //29 
                                 "N3_RashPrevVp",     m_Report.RashPrevVp(),        null,               //30 
                                 "N3_RashPrevRub",    m_Report.RashPrevRub(),       null,               //31 
                                 "N3_RashRepVP",      m_Report.RashRepVP(),         null,               //32 
                                 "N3_RashRepRub",     m_Report.RashRepRub(),        null,               //33 
                                 "N3_TaxPashRepRub",  m_Report.TaxPashRepRub(),     null,               //34 
                                 "N3_DifRashRepRub",  m_Report.DifRashRepRub(),     null,               //35 
                                 "N3_Cont",           m_Report.Cont(),              null,               //36 
                                 "N3_Com",            m_Report.Com(),               null,               //37 
                                 "N3_PereocDohAll",   m_Report.PereocDohAll(),      null,               //38 
                                 "N3_PereocDohPrev",  m_Report.PereocDohPrev(),     null,               //39 
                                 "N3_PereocDohRep",   m_Report.PereocDohRep(),      null,               //40 
                                 "N3_PereocRashAll",  m_Report.PereocRashAll(),     null,               //41 
                                 "N3_PereocRashPrev", m_Report.PereocRashPrev(),    null,               //42 
                                 "N3_PereocRashRep",  m_Report.PereocRashRep(),     null,               //43 
                                 "N3_Yrepo",          m_Report.Yrepo(),             null,               //T1 
                                 "N3_MonthRepo",      m_Report.MonthRepo(),         null,               //T2 
                                 "N3_ifDone2",        m_Report.ifDone2(),           null,               //T3 
                                 "N3_SumCalc2vp",     m_Report.SumCalc2vp(),        null,               //T4 
                                 "N3_SumDeal2vp",     m_Report.SumDeal2vp(),        null,               //T5 
                                 "N3_ContSum2",       m_Report.ContSum2(),          null,               //T6 
                                 "N3_ContD1",         m_Report.ContD1(),            null,               //T7 
                                 "N3_ContD2",         m_Report.ContD2(),            null,               //T8 
                                 "N3_CoupD1D2Vn",     m_Report.CoupD1D2Vn(),        null,               //T9 
                                 "N3_CoupD1endVN",    m_Report.CoupD1endVN(),       null,               //T10
                                 "N3_CoupBegEndVn",   m_Report.CoupBegEndVn(),      null,               //T11
                                 "N3_AmortD1D2Vn",    m_Report.AmortD1D2Vn(),       null,               //T12
                                 "N3_AmortD1endVn",   m_Report.AmortD1endVn(),      null,               //T13
                                 "N3_AmortBegEndVn",  m_Report.AmortBegEndVn(),     null,               //T14
                                 "N3_DfixDiv",        m_Report.DfixDiv(),           null,               //T15
                                 "N3_StRate",         m_Report.StRate(),            null,               //T16
                                 "N3_DifRate",        m_Report.DifRate(),           null,               //T17
                                 "N3_CBchange",       m_Report.CBchange(),          null,               //T18
                                 "N3_FRate",          m_Report.FRate(),             null,               //T19
                                 "N3_IsBlock",        m_Report.IsBlock(),           null,               //T20
                                 "N3_Dqual",          m_Report.Dqual(),             null,               //T21
                                 "N3_Fil",            m_Report.Fil(),               null,               //T22
                                 "N3_SecType",        m_Report.SecType(),           null,               //T23
                                 "N3_Dep",            m_Report.Dep(),               null                //T24
                               );                      

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N3_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N3_SecCode",  "в том числе:", null );
     end;
  END;         

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N3_" );
  END;         
END;

/**
 @brief Класс отчета по 504 регистру
 
 Класс для отчета по валютным сделкам прямого РЕПО
*/
PRIVATE CLASS CRepoReg_504( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0504, "N4_" );

     m_Report.RegisterTable( "N4_MainTable", "",                                      
                             "N4_SecCode",       "N4_SecName",       "N4_CodeR",         "N4_DZ",             "N4_Qnty",          "N4_VP",
                             "N4_DD1",           "N4_DP1",           "N4_Tot1vp",        "N4_Rate",           "N4_CoupN",         "N4_CoupVp",
                             "N4_AmortN",        "N4_AmortVp",       "N4_NMC",           "N4_MCvp",           "N4_PaySecCnt",     "N4_PaySecTot",
                             "N4_DD2",           "N4_DP2",           "N4_Tot2vp",        "N4_Trepo",          "N4_Trep",          
                             "N4_DohPrevVp",     "N4_DohPrevRub",    "N4_DohRepVp",
                             "N4_DohRepRub",     "N4_TaxDohRepRub",  "N4_DifDohRepRub",  "N4_RashPrevVp",     "N4_RashPrevRub",   "N4_RashRepVP",
                             "N4_RashRepRub",    "N4_TaxPashRepRub", "N4_DifRashRepRub", "N4_Cont",           "N4_Com",           "N4_PereocDohAll",
                             "N4_PereocDohPrev", "N4_PereocDohRep",  "N4_PereocRashAll", "N4_PereocRashPrev", "N4_PereocRashRep", "N4_Yrepo",
                             "N4_MonthRepo",     "N4_ifDone2",       "N4_SumCalc2vp",    "N4_SumDeal2vp",     "N4_ContSum2",      "N4_ContD1",
                             "N4_ContD2",        "N4_CoupD1D2Vn",    "N4_CoupD1endVN",   "N4_CoupBegEndVn",   "N4_AmortD1D2Vn",   "N4_AmortD1endVn",
                             "N4_AmortBegEndVn", "N4_DfixDiv",       "N4_StRate",        "N4_DifRate",        
                             "N4_CBchange",      "N4_FRate",         "N4_IsBlock",       "N4_Dqual",         
                             "N4_Fil",           "N4_SecType",       "N4_Dep"
                           );

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(), 
                                "N4_Qnty",6, "N4_Tot1vp",2, "N4_CoupN",0, "N4_CoupVp",2, "N4_AmortN",0, "N4_AmortVp",2, "N4_NMC",0, "N4_MCvp",2,
                                "N4_PaySecCnt",0, "N4_PaySecTot",0, "N4_Tot2vp",2, "N4_DohPrevVp",2, "N4_DohPrevRub",2, "N4_DohRepVp",2,
                                "N4_DohRepRub",2, "N4_TaxDohRepRub",2, "N4_DifDohRepRub",2, "N4_RashPrevVp",2, "N4_RashPrevRub",2, "N4_RashRepVP",2,
                                "N4_RashRepRub",2, "N4_TaxPashRepRub",2, "N4_DifRashRepRub",2, "N4_Com",2, "N4_PereocDohAll",2,
                                "N4_PereocDohPrev",2, "N4_PereocDohRep",2, "N4_PereocRashAll",2, "N4_PereocRashPrev",2, "N4_PereocRashRep",2,
                                "N4_SumCalc2vp",2, "N4_SumDeal2vp",0, "N4_ContSum2",0, "N4_ContD1",2, "N4_ContD2",2, "N4_CoupD1D2Vn",2, "N4_CoupD1endVN",2,
                                "N4_CoupBegEndVn",2, "N4_AmortD1D2Vn",2, "N4_AmortD1endVn",2, "N4_AmortBegEndVn",2);

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()

     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",                   
                        "I23",                 
                        "K23",                  
                        "L23",                 
                        "M23",                 
                        "N23",                
                        "O23",                    
                        "P23",                   
                        "Q23",              
                        "R23",              
                        "U23",                 
                        "X23",           
                        "Y23",          
                        "Z23",            
                        "AA23",           
                        "AB23",        
                        "AC23",        
                        "AD23",          
                        "AE23",         
                        "AF23",           
                        "AG23",          
                        "AH23",       
                        "AI23",       
                        "AK23",                 
                        "AL23",        
                        "AM23",       
                        "AN23",        
                        "AO23",       
                        "AP23",      
                        "AQ23",       
                        "AU23",          
                        "AV23",          
                        "AW23",            
                        "AX23",              
                        "AY23",              
                        "AZ23",          
                        "BA23",         
                        "BB23",        
                        "BC23",         
                        "BD23",        
                        "BE23"       
                    );
  END;

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )
        m_Report.PrintTableLine("N4_SecCode",        m_Report.SecCode(),             null,                //1  
                                "N4_SecName",        m_Report.SecName(),             null,                //2  
                                "N4_CodeR",          m_Report.CodeR(),               null,                //3  
                                "N4_DZ",             m_Report.DZ(),                  null,                //4  
                                "N4_Qnty",           m_Report.Qnty(),                SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),                //5  
                                "N4_VP",             m_Report.VP(),                  null,                //6  
                                "N4_DD1",            m_Report.DD1(),                 null,                //7  
                                "N4_DP1",            m_Report.DP1(),                 null,                //8  
                                "N4_Tot1vp",         m_Report.Tot1vp(),              null,                //9  
                                "N4_Rate",           m_Report.Rate(),                m_Report.Point(),    //10
                                "N4_CoupN",          m_Report.CoupN(),               null,                //11 
                                "N4_CoupVp",         m_Report.CoupVp(),              null,                //12 
                                "N4_AmortN",         m_Report.AmortN(),              null,                //13 
                                "N4_AmortVp",        m_Report.AmortVp(),             null,                //14 
                                "N4_NMC",            m_Report.NMC(),                 null,                //15 
                                "N4_MCvp",           m_Report.MCvp(),                null,                //16 
                                "N4_PaySecCnt",      m_Report.PaySecCnt(),           null,                //17 
                                "N4_PaySecTot",      m_Report.PaySecTot(),           null,                //18 
                                "N4_DD2",            m_Report.DD2(),                 null,                //19 
                                "N4_DP2",            m_Report.DP2(),                 null,                //20 
                                "N4_Tot2vp",         m_Report.Tot2vp(),              null,                //21 
                                "N4_Trepo",          m_Report.Trepo(),               null,                //22 
                                "N4_Trep",           m_Report.Trep(),                null,                //23 
                                "N4_DohPrevVp",      m_Report.DohPrevVp(),           null,                //24 
                                "N4_DohPrevRub",     m_Report.DohPrevRub(),          null,                //25 
                                "N4_DohRepVp",       m_Report.DohRepVp(),            null,                //26 
                                "N4_DohRepRub",      m_Report.DohRepRub(),           null,                //27 
                                "N4_TaxDohRepRub",   m_Report.TaxDohRepRub(),        null,                //28 
                                "N4_DifDohRepRub",   m_Report.DifDohRepRub(),        null,                //29 
                                "N4_RashPrevVp",     m_Report.RashPrevVp(),          null,                //30 
                                "N4_RashPrevRub",    m_Report.RashPrevRub(),         null,                //31 
                                "N4_RashRepVP",      m_Report.RashRepVP(),           null,                //32 
                                "N4_RashRepRub",     m_Report.RashRepRub(),          null,                //33 
                                "N4_TaxPashRepRub",  m_Report.TaxPashRepRub(),       null,                //34
                                "N4_DifRashRepRub",  m_Report.DifRashRepRub(),       null,                //35
                                "N4_Cont",           m_Report.Cont(),                null,                //36
                                "N4_Com",            m_Report.Com(),                 null,                //37
                                "N4_PereocDohAll",   m_Report.PereocDohAll(),        null,                //38
                                "N4_PereocDohPrev",  m_Report.PereocDohPrev(),       null,                //39
                                "N4_PereocDohRep",   m_Report.PereocDohRep(),        null,                //40
                                "N4_PereocRashAll",  m_Report.PereocRashAll(),       null,                //41
                                "N4_PereocRashPrev", m_Report.PereocRashPrev(),      null,                //42
                                "N4_PereocRashRep",  m_Report.PereocRashRep(),       null,                //43
                                "N4_Yrepo",          m_Report.Yrepo(),               null,                //T1 
                                "N4_MonthRepo",      m_Report.MonthRepo(),           null,                //T2 
                                "N4_ifDone2",        m_Report.ifDone2(),             null,                //T3 
                                "N4_SumCalc2vp",     m_Report.SumCalc2vp(),          null,                //T4 
                                "N4_SumDeal2vp",     m_Report.SumDeal2vp(),          null,                //T5 
                                "N4_ContSum2",       m_Report.ContSum2(),            null,                //T6 
                                "N4_ContD1",         m_Report.ContD1(),              null,                //T7 
                                "N4_ContD2",         m_Report.ContD2(),              null,                //T8 
                                "N4_CoupD1D2Vn",     m_Report.CoupD1D2Vn(),          null,                //T9 
                                "N4_CoupD1endVN",    m_Report.CoupD1endVN(),         null,                //T10
                                "N4_CoupBegEndVn",   m_Report.CoupBegEndVn(),        null,                //T11
                                "N4_AmortD1D2Vn",    m_Report.AmortD1D2Vn(),         null,                //T12
                                "N4_AmortD1endVn",   m_Report.AmortD1endVn(),        null,                //T13
                                "N4_AmortBegEndVn",  m_Report.AmortBegEndVn(),       null,                //T14
                                "N4_DfixDiv",        m_Report.DfixDiv(),             null,                //T15
                                "N4_StRate",         m_Report.StRate(),              null,                //T16
                                "N4_DifRate",        m_Report.DifRate(),             null,                //T17
                                "N4_CBchange",       m_Report.CBchange(),            null,                //T18
                                "N4_FRate",          m_Report.FRate(),               null,                //T19
                                "N4_IsBlock",        m_Report.IsBlock(),             null,                //T20
                                "N4_Dqual",          m_Report.Dqual(),               null,                //T21
                                "N4_Fil",            m_Report.Fil(),                 null,                //T22
                                "N4_SecType",        m_Report.SecType(),             null,                //T23
                                "N4_Dep",            m_Report.Dep(),                 null                 //T24
                               );

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N4_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N4_SecCode",  "в том числе:", null );
     end;
  END;         

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N4_" );
  END;         
END;

/**
 @brief Класс отчета по 505 регистру
 
 Класс для отчета по обратным РЕПО, ВР не совпадает с ВН
*/
PRIVATE CLASS CRepoReg_505( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0505, "N5_" );

     m_Report.RegisterTable( "N5_MainTable", "",
                             "N5_SecCode",       "N5_SecName",        "N5_CodeR",         "N5_DZ",            "N5_Qnty",           "N5_VN",
                             "N5_VP",            "N5_DD1",            "N5_DP1",           "N5_Tot1vp",        "N5_Rate",           "N5_CoupN",
                             "N5_CoupVp",        "N5_AmortN",         "N5_AmortVp",       "N5_NMC",           "N5_MCvp",           "N5_PaySecCnt",
                             "N5_PaySecTot",     "N5_DD2",            "N5_DP2",           "N5_Tot2vp",        "N5_Trepo",          "N5_Trep",
                             "N5_DohPrevVp",     "N5_DohPrevRub",
                             "N5_DohRepVp",      "N5_DohRepRub",      "N5_TaxDohRepRub",  "N5_DifDohRepRub",  "N5_RashPrevVp",     "N5_RashPrevRub",
                             "N5_RashRepVP",     "N5_RashRepRub",     "N5_TaxPashRepRub", "N5_DifRashRepRub", "N5_Cont",           "N5_Com",
                             "N5_PereocDohAll",  "N5_PereocDohPrev",  "N5_PereocDohRep",  "N5_PereocRashAll", "N5_PereocRashPrev", "N5_PereocRashRep",                      
                             "N5_Yrepo",         "N5_MonthRepo",      "N5_ifDone2",       "N5_SumCalc2vp",    "N5_SumDeal2vp",     "N5_ContSum2",  
                             "N5_ContD1",        "N5_ContD2",         "N5_CoupD1D2Vn",    "N5_CoupD1endVN",   "N5_CoupBegEndVn",   "N5_AmortD1D2Vn",   
                             "N5_AmortD1endVn",  "N5_AmortBegEndVn",  "N5_DfixDiv",       "N5_StRate",        "N5_DifRate",
                             "N5_CBchange",      "N5_FRate",          "N5_IsBlock",       "N5_Dqual",         
                             "N5_Fil",           "N5_SecType",        "N5_Dep");                      

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(),
                                "N5_Qnty",6, "N5_Tot1vp",2, "N5_CoupN",0, "N5_CoupVp",2, "N5_AmortN",0, "N5_AmortVp",2, "N5_NMC",0, "N5_MCvp",2,
                                "N5_PaySecCnt",0, "N5_PaySecTot",0, "N5_Tot2vp",2, "N5_DohPrevVp",2, "N5_DohPrevRub",2,
                                "N5_DohRepVp",2, "N5_DohRepRub",2, "N5_TaxDohRepRub",2, "N5_DifDohRepRub",2, "N5_RashPrevVp",2, "N5_RashPrevRub",2,
                                "N5_RashRepVP",2, "N5_RashRepRub",2, "N5_TaxPashRepRub",2, "N5_DifRashRepRub",2, "N5_Com",2,
                                "N5_PereocDohAll",2, "N5_PereocDohPrev",2, "N5_PereocDohRep",2, "N5_PereocRashAll",2, "N5_PereocRashPrev",2, "N5_PereocRashRep",2,
                                "N5_SumCalc2vp",2, "N5_SumDeal2vp",2, "N5_ContSum2",2, "N5_ContD1",0, "N5_ContD2",0, "N5_CoupD1D2Vn",2, "N5_CoupD1endVN",2,
                                "N5_CoupBegEndVn",2, "N5_AmortD1D2Vn",2, "N5_AmortD1endVn",2, "N5_AmortBegEndVn",2);

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()

     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",                 
                        "J23",               
                        "L23",                  
                        "M23",               
                        "N23",               
                        "O23",              
                        "P23",                  
                        "Q23",                 
                        "R23",            
                        "S23",            
                        "V23",               
                        "Y23",        
                        "Z23",       
                        "AA23",         
                        "AB23",        
                        "AC23",     
                        "AD23",     
                        "AE23",       
                        "AF23",      
                        "AG23",        
                        "AH23",       
                        "AI23",    
                        "AJ23",    
                        "AL23",              
                        "AM23",     
                        "AN23",    
                        "AO23",     
                        "AP23",    
                        "AQ23",   
                        "AR23",    
                        "AV23",       
                        "AW23",       
                        "AX23",         
                        "AY23",           
                        "AZ23",           
                        "BA23",       
                        "BB23",      
                        "BC23",     
                        "BD23",      
                        "BE23",     
                        "BF23"    
                    );

  END;

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )                                     
        m_Report.PrintTableLine( "N5_SecCode",        m_Report.SecCode(),            null,               //1  
                                 "N5_SecName",        m_Report.SecName(),            null,               //2  
                                 "N5_CodeR",          m_Report.CodeR(),              null,               //3  
                                 "N5_DZ",             m_Report.DZ(),                 null,               //4  
                                 "N5_Qnty",           m_Report.Qnty(),               SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),               //5  
                                 "N5_VN",             m_Report.VN(),                 null,               //6  
                                 "N5_VP",             m_Report.VP(),                 null,               //7  
                                 "N5_DD1",            m_Report.DD1(),                null,               //8  
                                 "N5_DP1",            m_Report.DP1(),                null,               //9  
                                 "N5_Tot1vp",         m_Report.Tot1vp(),             null,               //10 
                                 "N5_Rate",           m_Report.Rate(),               m_Report.Point(),   //11 
                                 "N5_CoupN",          m_Report.CoupN(),              null,               //12 
                                 "N5_CoupVp",         m_Report.CoupVp(),             null,               //13 
                                 "N5_AmortN",         m_Report.AmortN(),             null,               //14 
                                 "N5_AmortVp",        m_Report.AmortVp(),            null,               //15 
                                 "N5_NMC",            m_Report.NMC(),                null,               //16 
                                 "N5_MCvp",           m_Report.MCvp(),               null,               //17 
                                 "N5_PaySecCnt",      m_Report.PaySecCnt(),          null,               //18 
                                 "N5_PaySecTot",      m_Report.PaySecTot(),          null,               //19 
                                 "N5_DD2",            m_Report.DD2(),                null,               //20 
                                 "N5_DP2",            m_Report.DP2(),                null,               //21 
                                 "N5_Tot2vp",         m_Report.Tot2vp(),             null,               //22 
                                 "N5_Trepo",          m_Report.Trepo(),              null,               //23 
                                 "N5_Trep",           m_Report.Trep(),               null,               //24 
                                 "N5_DohPrevVp",      m_Report.DohPrevVp(),          null,               //25 
                                 "N5_DohPrevRub",     m_Report.DohPrevRub(),         null,               //26 
                                 "N5_DohRepVp",       m_Report.DohRepVp(),           null,               //27 
                                 "N5_DohRepRub",      m_Report.DohRepRub(),          null,               //28 
                                 "N5_TaxDohRepRub",   m_Report.TaxDohRepRub(),       null,               //29 
                                 "N5_DifDohRepRub",   m_Report.DifDohRepRub(),       null,               //30 
                                 "N5_RashPrevVp",     m_Report.RashPrevVp(),         null,               //31 
                                 "N5_RashPrevRub",    m_Report.RashPrevRub(),        null,               //32 
                                 "N5_RashRepVP",      m_Report.RashRepVP(),          null,               //33 
                                 "N5_RashRepRub",     m_Report.RashRepRub(),         null,               //34 
                                 "N5_TaxPashRepRub",  m_Report.TaxPashRepRub(),      null,               //35 
                                 "N5_DifRashRepRub",  m_Report.DifRashRepRub(),      null,               //36 
                                 "N5_Cont",           m_Report.Cont(),               null,               //37 
                                 "N5_Com",            m_Report.Com(),                null,               //38 
                                 "N5_PereocDohAll",   m_Report.PereocDohAll(),       null,               //39 
                                 "N5_PereocDohPrev",  m_Report.PereocDohPrev(),      null,               //40 
                                 "N5_PereocDohRep",   m_Report.PereocDohRep(),       null,               //41 
                                 "N5_PereocRashAll",  m_Report.PereocRashAll(),      null,               //42 
                                 "N5_PereocRashPrev", m_Report.PereocRashPrev(),     null,               //43 
                                 "N5_PereocRashRep",  m_Report.PereocRashRep(),      null,               //44
                                 "N5_Yrepo",          m_Report.Yrepo(),              null,               //T1 
                                 "N5_MonthRepo",      m_Report.MonthRepo(),          null,               //T2 
                                 "N5_ifDone2",        m_Report.ifDone2(),            null,               //T3 
                                 "N5_SumCalc2vp",     m_Report.SumCalc2vp(),         null,               //T4 
                                 "N5_SumDeal2vp",     m_Report.SumDeal2vp(),         null,               //T5 
                                 "N5_ContSum2",       m_Report.ContSum2(),           null,               //T6 
                                 "N5_ContD1",         m_Report.ContD1(),             null,               //T7 
                                 "N5_ContD2",         m_Report.ContD2(),             null,               //T8 
                                 "N5_CoupD1D2Vn",     m_Report.CoupD1D2Vn(),         null,               //T9 
                                 "N5_CoupD1endVN",    m_Report.CoupD1endVN(),        null,               //T10
                                 "N5_CoupBegEndVn",   m_Report.CoupBegEndVn(),       null,               //T11
                                 "N5_AmortD1D2Vn",    m_Report.AmortD1D2Vn(),        null,               //T12
                                 "N5_AmortD1endVn",   m_Report.AmortD1endVn(),       null,               //T13
                                 "N5_AmortBegEndVn",  m_Report.AmortBegEndVn(),      null,               //T14
                                 "N5_DfixDiv",        m_Report.DfixDiv(),            null,               //T15
                                 "N5_StRate",         m_Report.StRate(),             null,               //T16
                                 "N5_DifRate",        m_Report.DifRate(),            null,               //T17
                                 "N5_CBchange",       m_Report.CBchange(),           null,               //T18
                                 "N5_FRate",          m_Report.FRate(),              null,               //T19
                                 "N5_IsBlock",        m_Report.IsBlock(),            null,               //T20
                                 "N5_Dqual",          m_Report.Dqual(),              null,               //T21
                                 "N5_Fil",            m_Report.Fil(),                null,               //T22
                                 "N5_SecType",        m_Report.SecType(),            null,               //T23
                                 "N5_Dep",            m_Report.Dep(),                null                //T24
                               );

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N5_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N5_SecCode",  "в том числе:", null );
     end;
  END;         

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N5_" );
  END;         
END;

/**/
/**
 @brief Класс отчета по 506 регистру
 
 Класс для отчета по прямым РЕПО, ВР не совпадает с ВН
*/
PRIVATE CLASS CRepoReg_506( Report:OBJECT )
  VAR m_Report = Report;

  /**
   @brief Сформировать начало отчета

   Печать заголовков, регистрация табличных данных, вставка итоговой строчки
  */
  MACRO BeginReport()
     m_Report.PrintMainHeader( SHEET_0506, "N6_" );

     m_Report.RegisterTable( "N6_MainTable", "",                                              
                             "N6_SecCode",      "N6_SecName",       "N6_CodeR",         "N6_DZ",            "N6_Qnty",           "N6_VN",
                             "N6_VP",           "N6_DD1",           "N6_DP1",           "N6_Tot1vp",        "N6_Rate",           "N6_CoupN",
                             "N6_CoupVp",       "N6_AmortN",        "N6_AmortVp",       "N6_NMC",           "N6_MCvp",           "N6_PaySecCnt",
                             "N6_PaySecTot",    "N6_DD2",           "N6_DP2",           "N6_Tot2vp",        "N6_Trepo",          "N6_Trep",
                             "N6_DohPrevVp",    "N6_DohPrevRub",
                             "N6_DohRepVp",     "N6_DohRepRub",     "N6_TaxDohRepRub",  "N6_DifDohRepRub",  "N6_RashPrevVp",     "N6_RashPrevRub",
                             "N6_RashRepVP",    "N6_RashRepRub",    "N6_TaxPashRepRub", "N6_DifRashRepRub", "N6_Cont",           "N6_Com",
                             "N6_PereocDohAll", "N6_PereocDohPrev", "N6_PereocDohRep",  "N6_PereocRashAll", "N6_PereocRashPrev", "N6_PereocRashRep",
                             "N6_Yrepo",        "N6_MonthRepo",     "N6_ifDone2",       "N6_SumCalc2vp",    "N6_SumDeal2vp",     "N6_ContSum2",  
                             "N6_ContD1",       "N6_ContD2",        "N6_CoupD1D2Vn",    "N6_CoupD1endVN",   "N6_CoupBegEndVn",   "N6_AmortD1D2Vn",   
                             "N6_AmortD1endVn", "N6_AmortBegEndVn", "N6_DfixDiv",       "N6_StRate",        "N6_DifRate",
                             "N6_CBchange",     "N6_FRate",         "N6_IsBlock",       "N6_Dqual",        
                             "N6_Fil",          "N6_SecType",       "N6_Dep");

     m_Report.SetCellAutoSummaPoint( m_Report.ItogsLineName(),
                                "N6_Qnty",6, "N6_Tot1vp",2, "N6_CoupN",0, "N6_CoupVp",2, "N6_AmortN",0, "N6_AmortVp",2, "N6_NMC",0, "N6_MCvp",2,            
                                "N6_PaySecCnt",0, "N6_PaySecTot",0, "N6_Tot2vp",2, "N6_DohPrevVp",2, "N6_DohPrevRub",2, "N6_DohRepVp",2,        
                                "N6_DohRepRub",2, "N6_TaxDohRepRub",2, "N6_DifDohRepRub",2, "N6_RashPrevVp",2, "N6_RashPrevRub",2, "N6_RashRepVP",2,       
                                "N6_RashRepRub",2, "N6_TaxPashRepRub",2, "N6_DifRashRepRub",2, "N6_Com",2, "N6_PereocDohAll",2, "N6_PereocDohPrev",2,   
                                "N6_PereocDohRep",2, "N6_PereocRashAll",2, "N6_PereocRashPrev",2, "N6_PereocRashRep",2, "N6_SumCalc2vp",2, "N6_SumDeal2vp",2,      
                                "N6_ContSum2",2, "N6_ContD1",0, "N6_ContD2",0, "N6_CoupD1D2Vn",2, "N6_CoupD1endVN",2, "N6_CoupBegEndVn",2, "N6_AmortD1D2Vn",2,     
                                "N6_AmortD1endVn",2, "N6_AmortBegEndVn",2);

     this.ПечататьСтрокуТаблицы( m_Report.Строка_Итого() );
  END;

  /**
   @brief Печать промежуточных итогов
  */
  MACRO ПечататьПромежуточныеИтоги()
     
     m_Report.SetSubtotal(29, 26 + MAXROWSHEET,
                        "E23",                 
                        "J23",               
                        "L23",                  
                        "M23",               
                        "N23",               
                        "O23",              
                        "P23",                  
                        "Q23",                 
                        "R23",            
                        "S23",            
                        "V23",               
                        "Y23",    
                        "Z23",       
                        "AA23",         
                        "AB23",        
                        "AC23",     
                        "AD23",     
                        "AE23",       
                        "AF23",      
                        "AG23",        
                        "AH23",       
                        "AI23",    
                        "AJ23",    
                        "AL23",              
                        "AM23",     
                        "AN23",    
                        "AO23",     
                        "AP23",    
                        "AQ23",   
                        "AR23",    
                        "AV23",       
                        "AW23",       
                        "AX23",         
                        "AY23",           
                        "AZ23",           
                        "BA23",       
                        "BB23",      
                        "BC23",     
                        "BD23",      
                        "BE23",     
                        "BF23"    
                    );

  END;      

  /**
   @brief Печать строки таблицы
   @param[in] LineType - Тип строки (данные и итого)
  */
  MACRO ПечататьСтрокуТаблицы( LineType:INTEGER )

     if( LineType == m_Report.Строка_СтрокаДанных() )
        m_Report.PrintTableLine( "N6_SecCode",         m_Report.SecCode(),             null,               //1  
                                 "N6_SecName",         m_Report.SecName(),             null,               //2  
                                 "N6_CodeR",           m_Report.CodeR(),               null,               //3  
                                 "N6_DZ",              m_Report.DZ(),                  null,               //4  
                                 "N6_Qnty",            m_Report.Qnty(),                SetPrecisionByFractPart(m_Report.Qnty(), m_Report.QntyPrecision(), 0),               //5  
                                 "N6_VN",              m_Report.VN(),                  null,               //6   
                                 "N6_VP",              m_Report.VP(),                  null,               //7  
                                 "N6_DD1",             m_Report.DD1(),                 null,               //8  
                                 "N6_DP1",             m_Report.DP1(),                 null,               //9  
                                 "N6_Tot1vp",          m_Report.Tot1vp(),              null,               //10 
                                 "N6_Rate",            m_Report.Rate(),                m_Report.Point(),   //11 
                                 "N6_CoupN",           m_Report.CoupN(),               null,               //12 
                                 "N6_CoupVp",          m_Report.CoupVp(),              null,               //13 
                                 "N6_AmortN",          m_Report.AmortN(),              null,               //14 
                                 "N6_AmortVp",         m_Report.AmortVp(),             null,               //15 
                                 "N6_NMC",             m_Report.NMC(),                 null,               //16 
                                 "N6_MCvp",            m_Report.MCvp(),                null,               //17 
                                 "N6_PaySecCnt",       m_Report.PaySecCnt(),           null,               //18 
                                 "N6_PaySecTot",       m_Report.PaySecTot(),           null,               //19 
                                 "N6_DD2",             m_Report.DD2(),                 null,               //20 
                                 "N6_DP2",             m_Report.DP2(),                 null,               //21 
                                 "N6_Tot2vp",          m_Report.Tot2vp(),              null,               //22 
                                 "N6_Trepo",           m_Report.Trepo(),               null,               //23 
                                 "N6_Trep",            m_Report.Trep(),                null,               //24 
                                 "N6_DohPrevVp",       m_Report.DohPrevVp(),           null,               //25 
                                 "N6_DohPrevRub",      m_Report.DohPrevRub(),          null,               //26 
                                 "N6_DohRepVp",        m_Report.DohRepVp(),            null,               //27 
                                 "N6_DohRepRub",       m_Report.DohRepRub(),           null,               //28 
                                 "N6_TaxDohRepRub",    m_Report.TaxDohRepRub(),        null,               //29 
                                 "N6_DifDohRepRub",    m_Report.DifDohRepRub(),        null,               //30 
                                 "N6_RashPrevVp",      m_Report.RashPrevVp(),          null,               //31 
                                 "N6_RashPrevRub",     m_Report.RashPrevRub(),         null,               //32 
                                 "N6_RashRepVP",       m_Report.RashRepVP(),           null,               //33 
                                 "N6_RashRepRub",      m_Report.RashRepRub(),          null,               //34 
                                 "N6_TaxPashRepRub",   m_Report.TaxPashRepRub(),       null,               //35 
                                 "N6_DifRashRepRub",   m_Report.DifRashRepRub(),       null,               //36 
                                 "N6_Cont",            m_Report.Cont(),                null,               //37 
                                 "N6_Com",             m_Report.Com(),                 null,               //38 
                                 "N6_PereocDohAll",    m_Report.PereocDohAll(),        null,               //39 
                                 "N6_PereocDohPrev",   m_Report.PereocDohPrev(),       null,               //40 
                                 "N6_PereocDohRep",    m_Report.PereocDohRep(),        null,               //41 
                                 "N6_PereocRashAll",   m_Report.PereocRashAll(),       null,               //42 
                                 "N6_PereocRashPrev",  m_Report.PereocRashPrev(),      null,               //43 
                                 "N6_PereocRashRep",   m_Report.PereocRashRep(),       null,               //44 
                                 "N6_Yrepo",           m_Report.Yrepo(),               null,               //T1 
                                 "N6_MonthRepo",       m_Report.MonthRepo(),           null,               //T2 
                                 "N6_ifDone2",         m_Report.ifDone2(),             null,               //T3 
                                 "N6_SumCalc2vp",      m_Report.SumCalc2vp(),          null,               //T4 
                                 "N6_SumDeal2vp",      m_Report.SumDeal2vp(),          null,               //T5 
                                 "N6_ContSum2",        m_Report.ContSum2(),            null,               //T6 
                                 "N6_ContD1",          m_Report.ContD1(),              null,               //T7 
                                 "N6_ContD2",          m_Report.ContD2(),              null,               //T8 
                                 "N6_CoupD1D2Vn",      m_Report.CoupD1D2Vn(),          null,               //T9 
                                 "N6_CoupD1endVN",     m_Report.CoupD1endVN(),         null,               //T10
                                 "N6_CoupBegEndVn",    m_Report.CoupBegEndVn(),        null,               //T11
                                 "N6_AmortD1D2Vn",     m_Report.AmortD1D2Vn(),         null,               //T12
                                 "N6_AmortD1endVn",    m_Report.AmortD1endVn(),        null,               //T13
                                 "N6_AmortBegEndVn",   m_Report.AmortBegEndVn(),       null,               //T14
                                 "N6_DfixDiv",         m_Report.DfixDiv(),             null,               //T15
                                 "N6_StRate",          m_Report.StRate(),              null,               //T16
                                 "N6_DifRate",         m_Report.DifRate(),             null,               //T17
                                 "N6_CBchange",        m_Report.CBchange(),            null,               //T18
                                 "N6_FRate",           m_Report.FRate(),               null,               //T19
                                 "N6_IsBlock",         m_Report.IsBlock(),             null,               //T20
                                 "N6_Dqual",           m_Report.Dqual(),               null,               //T21
                                 "N6_Fil",             m_Report.Fil(),                 null,               //T22
                                 "N6_SecType",         m_Report.SecType(),             null,               //T23
                                 "N6_Dep",             m_Report.Dep(),                 null                //T24
                               );

     elif( LineType == m_Report.Строка_Итого() )
        m_Report.SetCurrentLineFont( 8, true, false );
        m_Report.PrintTableLine( "N6_SecCode",  m_Report.ItogsLineName(), null );
        m_Report.SetCurrentLineFont( 8, false, false );
        m_Report.PrintTableLine( "N6_SecCode",  "в том числе:", null );
     end;
  END;         

  /**
   @brief Сформировать конец отчета

   Закрытие таблицы с данными, печать итогов, формирование окончания отчета
  */
  MACRO EndReport();
     m_Report.EndTable();
     ПечататьПромежуточныеИтоги();
     m_Report.AddStandardFooter( "N6_" );
  END;         
END;

/**
 @brief Класс отчета по регистрам РЕПО 501-506,508
 
 Класс для создания отчета по регистрам РЕПО 501-506,508 
 Унаследован от базового класса отчета по регистрам РЕПО. (RepoRegisterBase.mac)
*/
PRIVATE CLASS (SP_RepoRegBase) SP_RepoReg_Report( Form:DL_CPanel, TemplateName:STRING, UseCSV:BOOL, IsWebService:BOOL, ReportHashCode:INTEGER )

  /**
   @brief Получить значение поля "код Ц/Б"
   @return Значение поля "код Ц/Б"
  */
  PRIVATE MACRO GetFromForm_AVRCODE()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRCODE);
  END;

  /**
   @brief Получить значение поля "тип Ц/Б"
   @return Значение поля "тип Ц/Б"
  */
  PRIVATE MACRO GetFromForm_AVRKIND()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRKIND );
  END;

  /**
   @brief Получить значение поля "группа Ц/Б"
   @return Значение поля "группа Ц/Б"
  */
  PRIVATE MACRO GetFromForm_AVRGROUP()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRGROUP );
  END;

  /**
   @brief Получить значение поля "исключить некоторые Ц/Б"
   @return Значение поля "исключить некоторые Ц/Б"
  */
  PRIVATE MACRO GetFromForm_EXCLUDE()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_EXCLUDE );
  END;

  /**
   @brief Получить значение поля "статус сделки"
   @return Значение поля "статус сделки"
  */
  PRIVATE MACRO GetFromForm_DEALSTATUS()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_DEALSTATUS );
  END;

  /**
   @brief Получить значение поля "дата: c"
   @return Значение поля "дата: c"
  */
  PRIVATE MACRO GetFromForm_BEGINDATE()
     return RepoRegister_Form.GetFieldValue(PNFLD_REPOREG_BEGINDATE);
  END;

  /**
   @brief Получить значение поля "подвид регистра"
   @return Значение поля "подвид регистра"
  */
  PRIVATE MACRO GetFromForm_SUBKIND()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_SUBKIND );
  END;

  /**
   @brief Получить значение поля "дата: по"
   @return Значение поля "дата: по"
  */
  PRIVATE MACRO GetFromForm_ENDDATE()
     return RepoRegister_Form.GetFieldValue(PNFLD_REPOREG_ENDDATE);
  END;

  /**
   @brief Получить значение поля "наименование Ц/Б"
   @return Значение поля "наименование Ц/Б"
  */
  PRIVATE MACRO GetFromForm_AVRNAME()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRNAME );
  END;

  /**
   @brief Получить значение поля "Год"
   @return Значение поля "Год"
  */
  PRIVATE MACRO GetFromForm_YEAR()
     return RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_YEAR );
  END;

  /**
   @brief Получить исключаемые из отчета ЦБ
   @return Строка с Ц/Б исключенными из отчета через ","
  */
  PRIVATE MACRO ИсключаемыеИзОтчетаЦБ():string
     return ИсключаемыеИзОтчетаЦБ_050;
  END;

  /**
   @brief Получить режим вывода
   @return Номер режима вывода через Excel (1)
  */
  MACRO PrintMode():INTEGER
     return DL_OUTREPORT_EXCEL;
  END;

  /**
   @brief Добавление автофильтра на листах отчета
  */
  PRIVATE MACRO SetAutoFilter()
     if( ExistsSheet( SHEET_0501 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BE28", SHEET_0501);
     end;

     if( ExistsSheet( SHEET_0502 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BE28", SHEET_0502);
     end;

     if( ExistsSheet( SHEET_0503 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BO28", SHEET_0503);
     end;

     if( ExistsSheet( SHEET_0504 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BO28", SHEET_0504);
     end;

     if( ExistsSheet( SHEET_0505 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BP28", SHEET_0505);
     end;

     if( ExistsSheet( SHEET_0506 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:BP28", SHEET_0506);
     end;

     if( ExistsSheet( SHEET_0508 ) )
        m_ObjTemplateXLS.SetAutoFilter("A28:AS28", SHEET_0508);
     end;
  END;

  /**
   @brief Сформировать конец отчета

   Формирование окончания отчета, установка автофильтра
  */
  PRIVATE MACRO EndReport()
    EndReport();
    SetAutoFilter();
  END;

  /**
   @brief Получение группы налогового учета
   @return Наименование группы налогового учета
  */
  MACRO H0_9():STRING
     var GroupName = "";
     RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRGROUP, @GroupName );
     return GroupName;
  END;

  /**
   @brief Получение вида ц/б
   @return Вид ц/б
  */
  MACRO H0_10():STRING
     var AvrKindShowValue = "";
     RepoRegister_Form.GetFieldValue( PNFLD_REPOREG_AVRKIND, @AvrKindShowValue );
     return AvrKindShowValue;
  END;

  /**
   @brief Создать отчет по виду регистра
   @param[in] Kind - вид регистра
  */
  PRIVATE MACRO CreateReportByKind( Kind:INTEGER )
     m_ReportKind = Kind;
     if( Kind == REPOREG_0501 )
        ExecuteReport( CRepoReg_501(this) );
     elif( Kind == REPOREG_0502 )
        ExecuteReport( CRepoReg_502(this) );
     elif( Kind == REPOREG_0503 )
        ExecuteReport( CRepoReg_503(this) );
     elif( Kind == REPOREG_0504 )
        ExecuteReport( CRepoReg_504(this) );
     elif( Kind == REPOREG_0505 )
        ExecuteReport( CRepoReg_505(this) );
     elif( Kind == REPOREG_0506 )
        ExecuteReport( CRepoReg_506(this) );     
     elif( Kind == REPOREG_0508 )
        ExecuteReport( CRepoReg_507_508(this, SHEET_0508, "N8_") );
     end;
  END;

  /**
   @brief Создать отчеты по всем регистрам (501-506, 508)
  */
  PRIVATE MACRO CreateReportByAll()
     CreateReportByKind( REPOREG_0501 );
     CreateReportByKind( REPOREG_0502 );
     CreateReportByKind( REPOREG_0503 );
     CreateReportByKind( REPOREG_0504 );
     CreateReportByKind( REPOREG_0505 );
     CreateReportByKind( REPOREG_0506 );
     CreateReportByKind( REPOREG_0508 );
  END;

  initSP_RepoRegBase( Form, TemplateName, UseCSV, IsWebService, ReportHashCode );
END;

/**
 @brief Запуск отчета по сделкам РЕПО
 @param[in] IsWebService - Флаг запуска из WEB
 @param[in] FormData - данные формы отчета (CTxReportForm)
 @param[in] ReportHashCode - хэш код отчета
 @param[in] menuItem - Класс меню WEB (WsMenuItem)
 @return Массив имен файлов отчета

 Запуск отчета по сделкам РЕПО с заданными параметрами в FormData
*/
MACRO ReportRunEx(
  IsWebService    : Bool
 ,FormData      //: CTxReportForm
 ,ReportHashCode  : Integer
 ,menuItem      //: WsMenuItem
)
  var stat = true;
  var FullReportFileNames = TArray();

  if( not IsWebService )
    RepoRegister_Form = SP_RepoReg_Panel();
  else
    if( ValType( FormData ) != V_UNDEF )
      RepoRegister_Form = WS_TX_RepoReg_Panel( FormData );
    else
      stat = false;
    end;
  end;

  while( stat )
    if( not IsWebService )
      stat = RepoRegister_Form.Run();
    end;

    if( stat )
      RepoRegister_Report = SP_RepoReg_Report( null, "Report_TxRegisterREPO.xls", true, IsWebService, ReportHashCode );
      RepoRegister_Report.SetWebMenuItem(menuItem);
      RepoRegister_Report.Run();

      if( IsWebService )
        DL_CallInsertStat( RepoRegister_Report.PrintMode(), menuItem.iCaseItem, menuItem.iIdentProgram, menuItem.szNameItem);
        FullReportFileNames = RepoRegister_Report.GetFullReportFileNames();
        stat = false;
      else
        DL_CallInsertStat( RepoRegister_Report.PrintMode());
      end;
    end;
  end;

  return FullReportFileNames;
END;
