/*
$Name:        settl040.mac
$Module:      Ценные бумаги
$Description: Операция Расчеты на ОРЦБ. Шаг - Пополнение торгового счета
*/
import "settl.mac";

/* Глобальная структура с данными для поплнения торгового счета (то, что вводится в панели поплнения счета))*/
PRIVATE VAR TorgAccData = TRecHandler( "dl_comm.dbt");
PRIVATE VAR MoneySourceBase:Integer; // Источник средств в первоначальной операции, при создании (не при изменении на шаге)

/*заполнение суммы "по умолчанию" в форме ввода параметров, вызываемой на данном шаге*/
PRIVATE MACRO CalcRestOnMarketAccounts()
   TorgAccData.rec.hidden_sum = $0; 
   TorgAccData.rec.Currency = NATCUR; 
   TorgAccData.rec.Currency_sum = $0; 
END;

macro ExecuteStep( Doc, adr, DocKind, ID_Operation, ID_Step )

  if( not ПереводСредствНаТорговыйСчет( Doc, TorgAccData ))
     return 1;
  end;

  return 0;
end;
