/*
$Name:         sc_week_reporep_form.mac
$Module:       БОЦБ
$Description:  Отчет "Еженедельный отчет по сделкам РЕПО" - форма ввода данных
*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_WREPOREP_DEPARTCODE   = 0, // код филиала
    PNFLD_WREPOREP_DEPARTMENT   = 1, // наименование филиала
    PNFLD_WREPOREP_BEGDATE      = 2, // дата начала
    PNFLD_WREPOREP_ENDDATE      = 3, // дата окончания
    PNFLD_WREPOREP_EXCEL        = 4, // Выпуск отчета в Microsoft Excel 
    PNFLD_WREPOREP_ISAPOSTR     = 5; // С апострофами


CLASS ( DL_CPanel ) WRR_Panel()
    PRIVATE MACRO Init()

        AddFieldProc( 0, PNFLD_WREPOREP_DEPARTCODE,   DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, -1);
        AddFieldProc( 0, PNFLD_WREPOREP_DEPARTMENT,   DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, -1);
        AddFieldProc( 0, PNFLD_WREPOREP_BEGDATE,      DL_PNFLD_BEGINDATE,  @DL_FldProc_BeginDate, {curdate} );
        AddFieldProc( 0, PNFLD_WREPOREP_ENDDATE,      DL_PNFLD_ENDDATE,    @DL_FldProc_EndDate, {curdate} );
        AddFieldProc( 0, PNFLD_WREPOREP_EXCEL,        DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
        AddFieldProc( 0, PNFLD_WREPOREP_ISAPOSTR,     DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
        
    END;

    PRIVATE MACRO Check():BOOL
      return true;
    END;

    initDL_CPanel( "sp_rep.lbr", "WREPOREP" );
END;
