/*
$Name: nptxwrt070.mac
$Module: Ценные бумаги
$Description: Корректировка сумм
*/
import oralib, likepy, "cblogger2.mac", "sp_car.mac", "nptxwrt_func.mac";

macro ExecuteStep( kind_oper, FDoc, DocKind, ID_Operation, ID_Step )
  record nptxop("nptxop");
  SetBuff( nptxop, FDoc );

  var NumberOp = "";
  var logger = NewLogger(c_logger.IT_LOG_TYPE, "NPTXWRT070.MAC");

  if(ЕстьНеисполненнаяПорожденнаяОперацияНОБ(nptxop.ID, @NumberOp))
    if( (MsgBoxEx( "Порождённая операция расчёта НОБ № "+ NumberOp +" не выполнена. Продолжить выполнение текущей операции зачисления/списания? ",
                   MB_YES+MB_NO, IND_NO) != IND_YES ))
      logger.Error("id = " + nptxop.ID + "; Порождённая операция расчёта НОБ № "+ NumberOp +" не выполнена");
      return 1;
    end;
  end;

  return 0;
end;