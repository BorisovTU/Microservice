//SecurOTCCreateDealsUI.mac
import "SecurOTCCreateDeals.mac", "SecurOTCCreateDealsPanel.mac";

private macro StartProcess()
  var pn = SecurOTCCreateDealsPanel();

  if (pn.Run == 0)
    return -1;    
  end;

  var dealProcessor = SecurOTCDealsCreator(pn.GetContractorID(),
                                           pn.GetDealDate(),
                                           pn.GetDealTime(),
                                           pn.GetSellSupplyDate(),
                                           pn.GetSellPayDate(),
                                           pn.GetBuySupplyDate(),
                                           pn.GetBuyPayDate());

  dealProcessor.CreateDealsByBuf();

  return 1;
end;

if (StartProcess() == -1)
  Exit(1);
end;