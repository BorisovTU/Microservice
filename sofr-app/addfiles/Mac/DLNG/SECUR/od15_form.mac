/********************************************************************************
 DESCRIPTION  :   Отчет "Расшифровка долговых ценных бумаг"
                   - форма ввода данных 
 PROGRAMMED BY:   Шайков В.Е.
 CREATION DATE:   **.**.****
*******************************************************************************/
import "DlRepForm_h.mac", "globals.mac";

CONST PNFLD_OD15_BEGINDATE              = 0,  /*Дата начала периода*/
	  PNFLD_OD15_ENDDATE              = 1,  /*Дата конца периода*/
	  PNFLD_OD15_PRINTMETHOD            = 2;  /*Вид вывода отчета*/

CLASS Dl_OD15_Form_Data()
  VAR BeginRepDate, EndRepDate;
  BeginRepDate = {curdate};
  EndRepDate = {curdate};
END;

VAR DlComTrAvrRepFormData = Dl_OD15_Form_Data();

PRIVATE MACRO Default( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
    FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE ) /*значение поля было изменено*/
    FldRealValue = FldRealValue;
  end;
  return CM_DEFAULT;
END;
                    
CLASS (DL_CPanel) DL_OD15_Panel()

  PRIVATE MACRO Init()
     var  d, m, y;
     var  BeginRepDate, EndRepDate;
     BeginRepDate = {curdate};
     EndRepDate = {curdate};
     AddFieldProc( 0, PNFLD_OD15_BEGINDATE, DL_PNFLD_BEGINDATE, @DL_FldProc_BeginDate, BeginRepDate);
     AddFieldProc( 0, PNFLD_OD15_ENDDATE, DL_PNFLD_ENDDATE, @DL_FldProc_BeginDate, EndRepDate);
     AddFieldProc( 0, PNFLD_OD15_PRINTMETHOD, DL_PNFLD_PRINTMETHOD, @DL_FldProc_PrintMethod, DL_OUTREPORT_EXCEL, 43, 13 );
  END;

  PRIVATE MACRO Check():BOOL
     return true;
  END;
  
  initDL_CPanel( "od15.lbr", "OD15" );
 
END;