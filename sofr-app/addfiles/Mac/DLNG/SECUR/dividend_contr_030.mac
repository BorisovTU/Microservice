/*
$Name:         dividend_contr_030.mac
$Module:       Ценные бумаги
$Description:  Операция получения дивидендов пл РЕПО (от Контрагента)
*/
/*  Обработка входящего платежа   */

import InsCarryDoc, "sp_class.mac", "sp_car2.mac", "spservsql.mac", "SPQICheckOper.mac", "nutxfun.mac";

macro ExecuteStep( Doc, FDoc )  
    record deal(DL_TICK);
    SetBuff( deal, FDoc ); 
    
    VAR FD = SPFirstDoc( deal );  
    var rq_money = TRecHandler("dlrq.dbt");
        rq_money = FD.GetRQ(  DLRQ_TYPE_PAYMENT ); //DLRQ_TYPE_DELIVERY

    if(УстановитьСтатусТО(rq_money, DLRQ_STATE_EXEC, deal.DealDate) != 0)
       return 1;
    end;

   return 0;
end;  
