/*
$Name:        iopool10.mac
$Module:      Ценные бумаги
$Description: Операция передачи имущества в пул/возврата из пула. Поставка
*/
import InsCarryDoc, sp_categ;

macro ExecuteStep( doc, FDoc, DocKind, ID_Operation, ID_Step)
  record dl_comm(dl_comm);
  var FD;

  SetBuff( dl_comm, FDoc ); 
  FD = SPFirstDocDLCOMM(dl_comm.DocKind, dl_comm.DocumentID);

  var pool_code = FD.GetPoolCode(dl_comm.MarketSchemeID);
  var pool_code_2 = FD.GetPoolCode(dl_comm.MarketSchemeID_2);

  if( (FD.PoolCodeIsPool(pool_code) == false) and (FD.PoolCodeIsPool(pool_code_2) == false))
    msgbox("Операция не является переводом в пул или возвратом из пула.");
    return -1;
  end;

  return 0;
end;