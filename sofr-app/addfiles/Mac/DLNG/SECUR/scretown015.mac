/*
$Name:         scretown015.mac 
$Module:       Ценные бумаги
$Description:  Операция погашения выпуска СЭБ. Шаг "Подготовка к расчету"
*/
import "spretownfun.mac";

macro ExecuteStep( Doc, FDoc, DocKind, ID_Operation, ID_Step )
   record deal(dl_tick);
   var FD, dat;
   var SumComiss = $0, SumNDS = $0;
   var NeedUpdGr = false;

   SetBuff( deal, FDoc );
   FD = SPFirstDoc ( deal, false );

   dat = FD.dl_leg.rec.MoveDate;

   if(ОЭБ_ПодготовкаКРасчетуПогашения(FD, dat, ID_Operation, ID_Step) != 0)
     return 1;
   end;

  return 0;
end;