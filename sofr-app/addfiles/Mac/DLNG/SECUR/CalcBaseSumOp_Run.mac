/**                                                                                                             
 @file \CalcBaseSumOp_Run.mac                                                                                           
 @brief Прослойка для запуска сервисной операции Расчета базовой суммы для периодических комиссий из пункта меню                                                                         
                                                                                                                
 #menu 
  - БО ЦБ\Сервисные операции\Расчет базовой суммы для периодических комиссий                                                                         
                                                                                                                
 #tag                                                                                                          
 - functional_block:СО                                                                             
 - code_type:GUI 
 - code_type:API                                                                                                                                                                                               
                                                                                                                
 # changeLog                                                                                                    
 |date       |author         |tasks               |note                                                         
 |-----------|---------------|--------------------|-------------------------------------------------------------
 |2023.12.29 |Жиц М.В.       |BIQ-14887           |Создание макроса прослойки                                                                                                                                                 
*/ 

import CalcBaseSumOp;

/**
 @brief Запуск сервисной операции Расчета базовой суммы для периодических комиссий с заполнением параметров панели 
*/
MACRO RunCalc()
  var errmsg:string = ""; //Переменная под сообщение об ошибке 
  var OperID:integer = 0; //Идентификатор операции расчета
  var param = CalcBaseSumOp_Panel(COMMISS_INVEST_ADVISER);

  while(param.Run())
    CalcBaseSumOp_Run(param.GetParams(), @OperID, @errmsg);

    if(errmsg != "")
      msgbox(errmsg);
    end;
  end;
END;

RunCalc();
Exit(1);