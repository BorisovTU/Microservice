/*
$Name:        nptxshort_2025_funcobj.mac
$Module:      Ценные бумаги
$Description: Выполнить подготовку данных для отчета "Краткая справка"
*/
import "nptxshort_2025_data.mac", "funcobj.mac";


macro CreateNptxShort2025Data_Funcobj(ObjectType, ObjectID, ParamStr)
  var err = 0;
  var ErrStr = "";
  var ReturnObj = FuncObjResult(FUNCOBJ_RESULT_OK, "", 0);
  var OldDialogFlag = SetDialogFlag(0);
  var GUID = ParamStr;
  var query, upd;
  
  var RepData = NPTXShort2025_Data(GUID);

  RepData.Create();

  query = "update dnptxshort_repparm_dbt set t_Status = 1 where t_GUID = ? AND t_Status = 0";
  upd = DL_RSDCommand(query);

  upd.AddParam(GUID);

  upd.ExecuteCMD();

  SetDialogFlag(OldDialogFlag);
  
  return ReturnObj;
end;


