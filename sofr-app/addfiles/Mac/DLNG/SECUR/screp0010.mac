/*
$Name:         screp0010.mac 
$Module:       Ценные бумаги
$Description:  Операция РЕПО (биржа). Шаг настройки операции
*/
/* Используется для операций:
     2122 Обратное РЕПО на бирже без признания ц/б
     2127 Прямое РЕПО на бирже без признания ц/б
*/
IMPORT InsCarryDoc, "sp_class.mac", "oprmassexec.mac","SPQICheckOper.mac","sp_car2.mac";

PRIVATE MACRO __ExecuteStep( FD:SPFirstDoc, FD2:SPFirstDoc ):INTEGER

  if(ПроверитьПринадлежностьКИ( FD ) == false)
     return 1;
  end;

  if( ИнициализироватьОперациюРЕПО( FD, FD2 ) == false )
     return 1;
  end;

  return 0;
END;

macro executeParamStep( kind_oper, BOf_kind, FDoc, ID_Operation, ID_Step )

  record  deal(dl_tick);
  var     FD, FD2;

  SetBuff( deal, FDoc ); 

  FD  = SPFirstDoc( deal, false, true );
  FD2 = SPFirstDoc( deal, true, true );

  return __ExecuteStep( FD, FD2 );
end;

/* Массовое исполнение сделок*/
MACRO MassExecuteStep()
  return __ExecuteStep( NULL, NULL );
END;
