/*
$Name:        nptxphysiisinfo.mac
$Module:      Ценные бумаги
$Description: Печать отчета "Сведения о ФЛ и его ИИС"
*/

import "nptxphysiisinfo_form.mac", "nptxphysiisinfo_report.mac";

private macro ReportRun()
  var Form = NpTxPhysIISInfoPanel();
  
  while(Form.Run())
    var RepDate        = Form.GetFieldValue(PNFLD_NPTXPIIS_REPORTDATE),    
        ClientID       = Form.GetFieldValue(PNFLD_NPTXPIIS_INVESTORCODE),  
        DlContrID      = Form.GetFieldValue(PNFLD_NPTXPIIS_CONTRACT),      
        IsConsolidate  = Form.GetFieldValue(PNFLD_NPTXPIIS_CONSOLIDATE),   
        ToExcel        = Form.GetFieldValue(PNFLD_NPTXPIIS_EXCEL),         
        ToPDF          = Form.GetFieldValue(PNFLD_NPTXPIIS_PDF),           
        Signatory      = Form.GetFieldValue(PNFLD_NPTXPIIS_SIGNATORY),     
        SendToClient   = Form.GetFieldValue(PNFLD_NPTXPIIS_SENDTOCLIENT),  
        DocumentNumber = Form.GetFieldValue(PNFLD_NPTXPIIS_DOCUMENTNUMBER);

    var ExcelFullRepPath = "", PDFFullRepPath = "";

    CreateNpTxPhysIISInfoRep(RepDate,       
                             ClientID,      
                             DlContrID,     
                             IsConsolidate, 
                             ToExcel,       
                             ToPDF,         
                             Signatory,     
                             SendToClient,
                             UNSET_CHAR,  
                             DocumentNumber,
                             @ExcelFullRepPath,
                             @PDFFullRepPath,
                             true
                            );

  end;
end;

ReportRun();
Exit(1);
