/*
$Name:        regdvinc.mac
$Module:      ñ•≠≠Î• °„¨†£®
$Description: é‚Á•‚ "ê†·Á•‚ §ÆÂÆ§Æ¢ ® ‡†·ÂÆ§Æ¢ ØÆ èà"
*/
/*******************************************************************************
 DESCRIPTION  :   é‚Á•‚ "ê†·Á•‚ §ÆÂÆ§Æ¢ ® ‡†·ÂÆ§Æ¢ ØÆ èà"
 PROGRAMMED BY:   Nikolskya V. 
 CREATION DATE:   25.01.2011
*******************************************************************************/
import "regdvinc_form.mac", "regdvinc_data.mac";

PRIVATE VAR TableHeader =                                                                                                                                                                                                                                                                                 
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒø\n"+
"≥          à≠¢•·‚Æ‡            ≥            ë‚†‚„·            ≥       äÆ§ èà       ≥        ç†®¨•≠Æ¢†≠®• èà       ≥      Ç®§ èà        ≥      Ç®§           ≥     äÆ§ °†ßÆ¢Æ£Æ   ≥           ç†®¨•≠Æ¢†≠®•       ≥             Å®‡¶†            ≥            Å‡Æ™•‡            ≥   Ñ†‚†   ≥ äÆ´®Á•·‚- ≥ äÆ´®Á•·‚- ≥   é‚™‡Î‚†Ô       ≥   å†‚•‡®†´Ï≠†Ô   ≥    ë„¨¨†         ≥    ë„¨¨†         ≥     ë„¨¨†        ≥    ë„¨¨†         ≥     äÆ¨®··®Ô,    ≥     î®≠†≠·Æ¢Î©   ≥    é°‡†È†•¨Æ·‚Ï  ≥ é°È†Ô  ≥\n"+
"≥                              ≥                              ≥                    ≥                              ≥                    ≥      °†ßÆ¢Æ£Æ      ≥     ®≠·‚‡„¨•≠‚†    ≥           °†ßÆ¢Æ£Æ           ≥                              ≥                              ≥          ≥ ¢Æ,       ≥ ¢Æ,       ≥   ØÆß®Ê®Ô        ≥   ¢Î£Æ§†,        ≥    ØÆ´„Á•≠≠Æ©    ≥    „Ø´†Á•≠≠Æ©    ≥     ØÆ´„Á•≠≠ÎÂ   ≥    „Ø´†Á•≠≠ÎÂ    ≥     ‡„°.         ≥     ‡•ß„´Ï‚†‚,   ≥    (§´Ô èà,      ≥ ·‚†¢™† ≥\n"+
"≥                              ≥                              ≥                    ≥                              ≥                    ≥      ®≠·‚‡„¨•≠‚†   ≥                    ≥           ®≠·‚‡„¨•≠‚†        ≥                              ≥                              ≥          ≥ ™„Ø´•≠≠Æ• ≥ Ø‡Æ§†≠≠Æ• ≥   ≠† ™Æ≠•Ê §≠Ô   ≥   ‡„°.           ≥    ¢†‡®†Ê®Æ≠≠Æ©  ≥    ¢†‡®†Ê®Æ≠≠Æ©  ≥     Ø‡•¨®©,      ≥    Ø‡•¨®©,       ≥                  ≥     ‡„°.         ≥    £§• °†ßÆ¢Î©   ≥ ≠†´Æ£Æ-≥\n"+
"≥                              ≥                              ≥                    ≥                              ≥                    ≥                    ≥                    ≥                              ≥                              ≥                              ≥          ≥ ¢ Ì‚Æ‚    ≥ ¢ Ì‚Æ‚    ≥   (+ - ØÆ™„Ø™†,  ≥                  ≥    ¨†‡¶®,        ≥    ¨†‡¶®,        ≥     ‡„°.         ≥    ‡„°.          ≥                  ≥                  ≥    †™‚®¢ - Ê/°)  ≥ Æ°´Æ¶•-≥\n"+
"≥                              ≥                              ≥                    ≥                              ≥                    ≥                    ≥                    ≥                              ≥                              ≥                              ≥          ≥ §•≠Ï      ≥ §•≠Ï      ≥    - Ø‡Æ§†¶†)    ≥                  ≥    ‡„°.          ≥    ‡„°.          ≥                  ≥                  ≥                  ≥                  ≥                  ≥ ≠®Ô    ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒ¥\n"+
"≥              1               ≥              2               ≥         3          ≥               4              ≥         5          ≥         6          ≥          7         ≥              8               ≥               9              ≥               10             ≥    11    ≥     12    ≥     13    ≥       14         ≥        15        ≥       16         ≥        17        ≥        18        ≥         19       ≥        20        ≥        21        ≥         22       ≥    23  ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒ¥";

PRIVATE VAR N1_TableHeader =                                                                                                                                                                                                                                                                                 
"⁄ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø\n"+
"≥          à≠¢•·‚Æ‡            ≥            ë‚†‚„·            ≥  Ñ†‚† ·§•´™®  ≥    çÆ¨•‡ ·§•´™®    ≥   Ç®§ ™Æ≠‚‡†™‚†    ≥    Ç®§ ·§•´™®      ≥  èÆ·‚†¢ÆÁ≠Î©/  ≥       à·ÂÆ§≠Î© †™‚®¢         ≥  Ñ†‚† ®·ØÆ´≠•≠®Ô  ≥      äÆ´®Á•·‚¢Æ        ≥ ç†®¨•≠Æ¢†≠®• ™Æ≠‚‡†£•≠‚† ≥    ñ•≠† ®·ÂÆ§≠Æ£Æ     ≥  Ç†´Ó‚†  ≥  êÎ≠ÆÁ≠†Ô Ê•≠†   ≥   å†‚•‡®†´Ï≠†Ô   ≥  ë„¨¨† ØÆ´„Á•≠≠Æ©  ≥  ë„¨¨† „Ø´†Á•≠≠Æ©   ≥       ë„¨¨†        ≥       ë„¨¨†        ≥ ë„¨¨† „Ø´†Á•≠≠ÎÂ   ≥   î®≠†≠·Æ¢Î©     ≥\n"+
"≥                              ≥                              ≥               ≥                    ≥                    ≥                    ≥   ‡†·Á•‚≠Î©    ≥                              ≥                   ≥    ®·ÂÆ§≠Æ£Æ †™‚®¢†    ≥                          ≥  †™‚®¢† ØÆ ™Æ≠‚‡†™‚„  ≥   Ê•≠Î   ≥                  ≥      ¢Î£Æ§†      ≥ ¢†‡®†Ê®Æ≠≠Æ© ¨†‡¶®,≥ ¢†‡®†Ê®Æ≠≠Æ© ¨†‡¶®, ≥ ØÆ´„Á•≠≠ÎÂ Ø‡•¨®©, ≥ „Ø´†Á•≠≠ÎÂ Ø‡•¨®©, ≥ ™Æ¨®··®© (¢ ‡„°´ÔÂ)≥    ‡•ß„´Ï‚†‚,    ≥\n"+
"≥                              ≥                              ≥               ≥                    ≥                    ≥                    ≥                √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥                   ≥                        ≥                          ≥       ¢ ¢†´Ó‚•        ≥          ≥                  ≥                  ≥        ‡„°.        ≥        ‡„°.         ≥       ‡„°.         ≥        ‡„°.        ≥                    ≥     ‡„°.         ≥\n"+
"≥                              ≥                              ≥               ≥                    ≥                    ≥                    ≥                ≥     Ç®§      ≥     äÆ§       ≥                   ≥                        ≥                          ≥                       ≥          ≥                  ≥                  ≥                    ≥                     ≥                    ≥                    ≥                    ≥                  ≥\n"+
"≥                              ≥                              ≥               ≥                    ≥                    ≥                    ≥                ≥              ≥               ≥                   ≥                        ≥                          ≥                       ≥          ≥                  ≥                  ≥                    ≥                     ≥                    ≥                    ≥                    ≥                  ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥\n"+
"≥              1               ≥              2               ≥      3        ≥          4         ≥         5          ≥         6          ≥        7       ≥      8       ≥       9       ≥         10        ≥            11          ≥            12            ≥           13          ≥     14   ≥       15         ≥        16        ≥         17         ≥         18          ≥         19         ≥          20        ≥         21         ≥        22        ≥\n"+
"√ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥";

PRIVATE VAR RepHeader =
"Ä≠†´®‚®Á•·™®© ‡•£®·‚‡ §´Ô ‡†·Á•‚† çÑîã ØÆ ÆØ•‡†Ê®Ô¨ · èà\n"+
"ß† Ø•‡®Æ§ · ########## ØÆ ##########\n"+
"Å®‡¶•¢Î• Ø‡Æ®ß¢Æ§≠Î• ®≠·‚‡„¨•≠‚Î\n"+
"Ç®§ èà:     ####################\n"+
"ÇÎØ„·™ èà:  ####################\n"+
"à≠¢•·‚Æ‡:   ##############################\n";

PRIVATE VAR N1_RepHeader =
"Ä≠†´®‚®Á•·™®© ‡•£®·‚‡ §´Ô ‡†·Á•‚† çÑîã ØÆ ÆØ•‡†Ê®Ô¨ · èà\n"+
"ß† Ø•‡®Æ§ · ########## ØÆ ##########\n"+
"Ç≠•°®‡¶•¢Î• Ø‡Æ®ß¢Æ§≠Î• ®≠·‚‡„¨•≠‚Î\n"+
"Ç®§ èà:               ####################\n"+
"Ç®§ ®·ÂÆ§≠Æ£Æ †™‚®¢†: ####################\n"+
"à≠¢•·‚Æ‡:             ##############################\n";

PRIVATE CLASS (DL_CReportTemplate) SP_DvTaxInc_Report
  var m_IsRegTable = false, m_IsPrintHead:bool = false;
  var m_Exchange:bool = false, m_OutExchange:bool = false;
  var m_DataExchange, m_DataOutExchange;

  MACRO Init()
    m_IsRegTable = false;
    m_IsPrintHead = false;
  END;

  PRIVATE MACRO BeginReport()
    Init();
    Dl_CallInsertStat(PrintMode());

    var BegDate      = m_Form.GetFieldValue( PNFLD_DVTAXINC_BEGDATE ),
        EndDate      = m_Form.GetFieldValue( PNFLD_DVTAXINC_ENDDATE ),
        InvestorID   = m_Form.GetFieldValue( PNFLD_DVTAXINC_INVERSTORCODE );

    m_Exchange     = (m_Form.GetFieldValue( PNFLD_DVTAXINC_EXCHANGE ) == "X");
    m_OutExchange  = (m_Form.GetFieldValue( PNFLD_DVTAXINC_OUTEXCHANGE ) == "X");

    if (m_Exchange)
      m_DataExchange = SP_DvTaxInc_Exchange_Data( InvestorID,
                                                  BegDate,
                                                  Enddate,
                                                  m_Form.GetFieldValue( PNFLD_DVTAXINC_DERIVKIND_EX ),
                                                  m_Form.GetFieldValue( PNFLD_DVTAXINC_DERIVCODE )
                                                );
    end;

    if(m_OutExchange)
      m_DataOutExchange = SP_DvTaxInc_OutExchange_Data( InvestorID,
                                                        BegDate,
                                                        EndDate,
                                                        m_Form.GetFieldValue( PNFLD_DVTAXINC_DERIVKIND_OUTEX ),
                                                        m_Form.GetFieldValue( PNFLD_DVTAXINC_SOURCEKIND )
                                                      );
    end;
  END;

  MACRO è•Á†‚†‚Ïè‡Æ¨•¶„‚ÆÁ≠Î•à‚Æ£®()
     SetSubtotal( 12, 8 + MAXROWSHEET,
                  "L6",             
                  "M6",           
                  "P6",            
                  "Q6",           
                  "R6",           
                  "S6"          
                );                                                                      
  END;

  PRIVATE MACRO EndReport()
  END;

  PRIVATE MACRO PrintMode():INTEGER
    return m_Form.GetFieldValue( PNFLD_DVTAXINC_PRINTMETHOD );
  END;

  PRIVATE MACRO PrintRepHeader()
     if( not m_IsPrintHead )
        PrintFormatString( RepHeader,
                           "H0_1", m_DataExchange.BegDate(),
                           "H0_2", m_DataExchange.EndDate(),
                           "H0_4", m_DataExchange.DerivKind(),
                           "H0_5", m_DataExchange.DerivCode(),
                           "H0_6", m_DataExchange.InvestorName()
                         );
        m_IsPrintHead = true;
     end;
  END;

  PRIVATE MACRO N1_PrintRepHeader()
     if( not m_IsPrintHead )
        SetActiveSheet("ê•£®·‚‡ ¢≠•°®‡¶•¢ÎÂ èà");
        PrintFormatString( N1_RepHeader,
                           "N1_H0_1",   m_DataOutExchange.BegDate(),
                           "N1_H0_2",   m_DataOutExchange.EndDate(),
                           "N1_H0_4",   m_DataOutExchange.DerivKindOut(),
                           "N1_H0_5_1", m_DataOutExchange.SourceKind(),
                           "N1_H0_6",   m_DataOutExchange.InvestorName()
                         );
        m_IsPrintHead = true;
     end;
  END;

  PRIVATE MACRO RegistrTable()
     if( not m_IsRegTable )
        RegisterTable( "MainTable", TableHeader,
                       "Client",
                       "ClientStatus",
                       "SecCode",
                       "FICode",
                       "FIName",
                       "FIType",
                       "BaseType",
                       "BaseCode",
                       "BaseName",
                       "TradePlace",
                       "Dpos",
                       "Qbuy",
                       "Qsell",
                       "Qlong",
                       "Material",
                       "VarPos",
                       "VarNeg",
                       "PremPos",
                       "PremNeg",
                       "Com",
                       "FR",
                       "bMarket",
                       "TaxRate"
                     );

        SetCellAutoSumma( "Ç·•£Æ", 
                          "Qbuy", "Qsell", "Material", "VarPos", "VarNeg", "PremPos", "PremNeg", "Com", "FR");

        PrintTableLine( "Client",  "Ç·•£Æ", null );

        PrintTableLine( "Client",  "Ç ‚Æ¨", null,
                        "SecCode", "Á®·´•", null );

        m_IsRegTable = true;
     end;
  END;

  PRIVATE MACRO N1_RegistrTable()
     if( not m_IsRegTable )
        RegisterTable( "N1_MainTable", N1_TableHeader,
                       "N1_Client",
                       "N1_ClientStatus",
                       "N1_DealDate",
                       "N1_ContractN",
                       "N1_ContractType",
                       "N1_Direction",
                       "N1_Contract",
                       "N1_BaseType",
                       "N1_FIType",
                       "N1_ExpirationDate",
                       "N1_Q",
                       "N1_Contragent",
                       "N1_ExpirationPriceCur",
                       "N1_PriceCurrency",
                       "N1_MarketPrice",
                       "N1_Material",
                       "N1_VarPos",
                       "N1_VarNeg",
                       "N1_PremPos",
                       "N1_PremNeg",
                       "N1_Com",
                       "N1_FR"
                     );

        SetCellAutoSumma("Ç·•£Æ",
                         "N1_Material", "N1_VarPos", "N1_VarNeg", "N1_PremPos", "N1_PremNeg", "N1_Com", "N1_FR");

        PrintTableLine("N1_Client", "Ç·•£Æ", null);

        PrintTableLine("N1_Client", "Ç ‚Æ¨", null,
                       "N1_DealDate", "Á®·´•", null);

        m_IsRegTable = true;
     end;
  END;

  PRIVATE MACRO PrintLineFiTurn()
    PrintTableLine( "Client",       m_DataExchange.Client(),       null,
                    "ClientStatus", m_DataExchange.ClientStatus(), null,
                    "SecCode",      m_DataExchange.SecCode(),      null,
                    "FICode",       m_DataExchange.FICode(),       null,
                    "FIName",       m_DataExchange.FIName(),       null,
                    "FIType",       m_DataExchange.FIType(),       null,
                    "BaseType",     m_DataExchange.BaseType(),     null,
                    "BaseCode",     m_DataExchange.BaseCode(),     null,
                    "BaseName",     m_DataExchange.BaseName(),     null,
                    "TradePlace",   m_DataExchange.TradePlace(),   null,
                    "Dpos",         m_DataExchange.Dpos(),         null,
                    "Qbuy",         m_DataExchange.Qbuy(),         null,
                    "Qsell",        m_DataExchange.Qsell(),        null,
                    "Qlong",        m_DataExchange.Qlong(),        null,
                    "Material",     m_DataExchange.Material(),     null,
                    "VarPos",       m_DataExchange.VarPos(),       null,
                    "VarNeg",       m_DataExchange.VarNeg(),       null,
                    "PremPos",      m_DataExchange.PremPos(),      null,
                    "PremNeg",      m_DataExchange.PremNeg(),      null,
                    "Com",          m_DataExchange.Com(),          null,
                    "FR",           m_DataExchange.FR(),           null,
                    "bMarket",      m_DataExchange.bMarket(),      null,
                    "TaxRate",      m_DataExchange.TaxRate(),      null
                  );
  END;

  PRIVATE MACRO N1_PrintLineDeal()
    PrintTableLine( "N1_Client",             m_DataOutExchange.Client(),             null,
                    "N1_ClientStatus",       m_DataOutExchange.ClientStatus(),       null,
                    "N1_DealDate",           m_DataOutExchange.DealDate(),           null,
                    "N1_ContractN",          m_DataOutExchange.ContractN(),          null,
                    "N1_ContractType",       m_DataOutExchange.ContractType(),       null,
                    "N1_Direction",          m_DataOutExchange.Direction(),          null,
                    "N1_Contract",           m_DataOutExchange.Contract(),           null,
                    "N1_BaseType",           m_DataOutExchange.BaseType(),           null,
                    "N1_FIType",             m_DataOutExchange.FIType(),             null,
                    "N1_ExpirationDate",     m_DataOutExchange.ExpirationDate(),     null,
                    "N1_Q",                  m_DataOutExchange.Q(),                  null,
                    "N1_Contragent",         m_DataOutExchange.Contragent(),         null,
                    "N1_ExpirationPriceCur", m_DataOutExchange.ExpirationPriceCur(), null,
                    "N1_PriceCurrency",      m_DataOutExchange.PriceCurrency(),      null,
                    "N1_MarketPrice",        m_DataOutExchange.MarketPrice(),        null,
                    "N1_Material",           m_DataOutExchange.Material(),           null,
                    "N1_VarPos",             m_DataOutExchange.VarPos(),             null,
                    "N1_VarNeg",             m_DataOutExchange.VarNeg(),             null,
                    "N1_PremPos",            m_DataOutExchange.PremPos(),            null,
                    "N1_PremNeg",            m_DataOutExchange.PremNeg(),            null,
                    "N1_Com",                m_DataOutExchange.Com(),                null,
                    "N1_FR",                 m_DataOutExchange.FR(),                 null
                  );
  END;

  PRIVATE MACRO ExecuteReport()
    var Num = 0;

    InitProgress(m_DataExchange.Nrec(), "ê†·Á•‚ §ÆÂÆ§Æ¢ ® ‡†·ÂÆ§Æ¢ ØÆ èà", "è‡Æ·¨Æ‚‡ ®‚Æ£Æ¢ §≠Ô");

    while( m_DataExchange.MoveNext() )
       PrintRepHeader();
       RegistrTable();
       PrintLineFiTurn();
       UseProgress( Num = Num + 1 );
    end;

    EndTable();
    è•Á†‚†‚Ïè‡Æ¨•¶„‚ÆÁ≠Î•à‚Æ£®();
    AddStandardFooter();

    RemProgress();
  END;

  PRIVATE MACRO N1_ExecuteReport()
    var Num = 0, needprint = true;

    if( m_DataOutExchange.GetDataForRep() > 0 )

       InitProgress(m_DataOutExchange.Nrec(), "ê†·Á•‚ §ÆÂÆ§Æ¢ ® ‡†·ÂÆ§Æ¢ ØÆ èà", "è‡Æ·¨Æ‚‡ ¢≠•°®‡¶•¢ÎÂ ·§•´Æ™");

       while( m_DataOutExchange.MoveNext(@needprint) )
          if (needprint)
             N1_PrintRepHeader();
             N1_RegistrTable();
             N1_PrintLineDeal();
          end;

          UseProgress(Num = Num + 1);
       end;

       RemProgress();
    end;

    if( m_IsPrintHead )
      EndTable();
      AddStandardFooter("N1_");
    else
       SetActiveSheet("ê•£®·‚‡ ¢≠•°®‡¶•¢ÎÂ èà_");
       PrintFormatString("#", "N1_NoRepData", "ç•‚ §†≠≠ÎÂ, „§Æ¢´•‚¢Æ‡ÔÓÈ®Â Ø†‡†¨•‚‡†¨ Æ‚Á•‚†.");
    end;
  END;

  PRIVATE MACRO Create()
     if( m_Exchange )
        if( m_DataExchange.GetDataForRep() > 0 )
           SetActiveSheet("ê•£®·‚‡ °®‡¶•¢ÎÂ èà");
           ExecuteReport();
        else
           SetActiveSheet("ê•£®·‚‡ °®‡¶•¢ÎÂ èà_");
           PrintFormatString("#", "NoRepData", "ç•‚ §†≠≠ÎÂ, „§Æ¢´•‚¢Æ‡ÔÓÈ®Â Ø†‡†¨•‚‡†¨ Æ‚Á•‚†.");
        end;
     end;

     if( m_OutExchange )
        Init();
        N1_ExecuteReport();
     end;
  END;

  initDL_CReportTemplate( DvTaxInc_Panel(), "Report_regdvinc.xls" );
END;

SP_DvTaxInc_Report().Run();
exit(1);
