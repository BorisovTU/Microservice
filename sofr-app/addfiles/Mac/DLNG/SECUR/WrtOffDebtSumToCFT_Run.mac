/**                                                                                                             
 @file  WrtOffDebtSumToCFT_Run.mac                                                                                           
 @brief Прослойка для запуска операции Инициации процесса списания задолженностей со счетов в ЦФТ из пункта меню                                                                         
                                                                                                                
 #menu 
  - БО ЦБ\Договоры\Договоры брокерского обслуживания\Инициация процесса списания задолженностей со счетов в ЦФТ                                                                         
                                                                                                                
 #tag                                                                                                          
 - functional_block:СО                                                                             
 - code_type:GUI 
 - code_type:API                                                                                                                                                                                               
                                                                                                                
 # changeLog                                                                                                    
 |date       |author         |tasks               |note                                                         
 |-----------|---------------|--------------------|-------------------------------------------------------------
 |2025.10.14 |Жиц М.В.       |AVT_BOSS-714        |Создание макроса прослойки                                                                                                                                                 
*/ 

import WrtOffDebtSumToCFT;

/**
 @brief Запуск операции Инициации процесса списания задолженностей со счетов в ЦФТ с заполнением параметров панели 
*/
MACRO RunWrtOffDebtToCFT()
  var errmsg:string = ""; //Переменная под сообщение об ошибке 
  var param = WrtOffDebtSumToCFT_Panel();

  while(param.Run())
    if(CheckDebtSumParams(param.GetParams().ProcDate, @errmsg) and CheckCFTWorkTime(@errmsg)) //Проверяем корректность параметров
      CreateDebtListToCFT(param.GetParams(), null, @errmsg);
    end;

    if(errmsg != "")
      msgbox(errmsg);
    end;
  end;
END;

RunWrtOffDebtToCFT();
Exit(1);