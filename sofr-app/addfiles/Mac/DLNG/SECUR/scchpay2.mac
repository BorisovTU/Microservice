/* Операция "Расчеты по сделке"
   шаг "Переносить оплату по срокам втрой части сделки ?"*/
import "sp_car.mac";

macro ExecuteCaseStep( Kind_Operation, Number_Step, FDoc, KindDoc )

  record  deal(dl_tick);
  var     FD;

  SetBuff( deal, FDoc );
  FD = SPFirstDoc( deal, true );

  if( IsSALE(FD.Group) ) /*сделки продажи с обратным выкупом*/
     return string(Kind_Operation) + "00:" + ОпределитьШагПереносаПоСрокам( FD, "470", "460", FD.GetRQ(DLRQ_TYPE_PAYMENT), null, null, null, null, null, FD.GetRQ(DLRQ_TYPE_DELIVERY) );
  else
     return string(Kind_Operation) + "00:" + ОпределитьШагПереносаПоСрокам( FD, "470", "360", FD.GetRQ(DLRQ_TYPE_PAYMENT), null, null, null, null, null, FD.GetRQ(DLRQ_TYPE_DELIVERY) );
  end;
end;
