/*
$Name:        inoutpoolopsc.mac
$Module:      Ценные бумаги
$Description: Макрос скролинга операций передачи имущества в пул/возврата из пула
*/
import DealsInter, SPInter, PTInter, globals;
import RsbDataSet;
import "NrdTransferOrder.mac";
//import "dpcrmsginf.mac","boswift54x.mac";
import "boswift54x.mac";
/* Уже заполненные структуры, все изменения отразятся в базах */
PRIVATE VAR Документ         = TRecHandler( "dl_comm" );
PRIVATE VAR СтарыйДокумент   = TRecHandler( "dl_comm" ); /* заполняется при редактировании */

/* Макрофункция инициализации нового актива 
   необходимо заполнить структуру "Документ"
   возвращаемое значение
   0 - ошибок не было
   1 - была ошибка
*/
PRIVATE MACRO Новый_Документ()
  
  return 0;
END;

private macro Проверить_Документ( Режим:integer )
  if(Режим == 3) //редактирование операции

    //здесь должны быть проверки при редактировании

  elif(Режим == 1) //удаление
    
    //здесь должны быть проверки при удалении

  end;

  return 0;
end;

/* Установка подсказки для скролингов из макроса */
private MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStatus:integer, ScrolKind:integer ):string

  //пример
  //return "/*+FIRST_ROWS LEADING(t) INDEX(t ddl_comm_dbt_idx0)*/";

  return DefaultHint;

END;

/* Вызывается по CTRL+Z из скроллинга */
private macro Функция_Пользователя(режим)

 var m = TArray();
     m(m.Size) = "Сформировать поручения на перевод в НРД";
     m(m.Size) = "Сформировать SWIFT MT540/542 в НРД";
var choice = menu(m);
if (choice == 0)
  CreateTransferOrder(Документ);
elif (choice == 1)
  DL_CreateMsgInf( Документ );
end;  
  //execmacrofile("boswift54x.mac","DL_CreateMsgInf",Документ);
  //DL_CreateMsgInf( Документ );
  //MsgBox( "!!!Выполняется макрофункция \"inoutpoolopsc.mac\\ Функция_Пользователя\"." );
  //execmacrofile("NRDTransferOrder.mac","CreateTransferOrder",Документ);
  return 0;
end;

