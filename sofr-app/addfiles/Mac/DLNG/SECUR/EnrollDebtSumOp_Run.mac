/**                                                                                                             
 @file  EnrollDebtSumOp_Run.mac                                                                                           
 @brief Прослойка для запуска сервисной операции Автоматического выноса задолженности на просрочку из пункта меню                                                                         
                                                                                                                
 #menu 
  - БО ЦБ\Сервисные операции\Автоматический вынос задолженности на просрочку                                                                         
                                                                                                                
 #tag                                                                                                          
 - functional_block:СО                                                                             
 - code_type:GUI 
 - code_type:API                                                                                                                                                                                               
                                                                                                                
 # changeLog                                                                                                    
 |date       |author         |tasks               |note                                                         
 |-----------|---------------|--------------------|-------------------------------------------------------------
 |2025.03.13 |Жиц М.В.       |BOSS-2183           |Создание макроса прослойки                                                                                                                                                 
*/ 

import EnrollDebtSumOp;

/**
 @brief Запуск сервисной операции Автоматического выноса задолженности на просрочку с заполнением параметров панели 
*/
MACRO RunEnrollDebt()
  var errmsg:string = ""; //Переменная под сообщение об ошибке 
  var OperID:integer = 0; //Идентификатор операции расчета
  var param = EnrollDebtSumOp_Panel();

  while(param.Run())
    if(CheckDebtSumParams(param.GetParams().ProcDate, @errmsg)) //Проверяем корректность параметров
      EnrollDebtSumOp_Run(param.GetParams(), @OperID, @errmsg);
    end;

    if(errmsg != "")
      msgbox(errmsg);
    end;
  end;
END;

RunEnrollDebt();
Exit(1);