/*
$Name:         scretown010.mac 
$Module:       Ценные бумаги
$Description:  Операция погашения выпуска СЭБ. Шаг настройки операции
*/
import "spRetire.mac";

macro executeParamStep( kind_oper, BOf_kind, FDoc, ID_Operation, ID_Step )
  record  deal(dl_tick);
  var FD;

  SetBuff( deal, FDoc ); 
  FD = SPFirstDoc( deal, false, true );

  DefineOprDate( FD.GetKindDate(DATE_DEALDATE),        FD.DateArray[DATE_DEALDATE]   );
  DefineOprDate( FD.GetKindDate(DATE_DEALTRANSFER),    FD.DateArray[DATE_DEALTRANSFER]   );  // Дки (Дата переноса на счета "к исполнению")
  DefineOprDate( FD.GetKindDate(DATE_DEALSETAVOIRISS), FD.DateArray[DATE_DEALSETAVOIRISS] ); // Дп (Дата погашения факт.)
  DefineOprDate( FD.GetKindDate(DATE_DEALPAY),         FD.DateArray[DATE_DEALPAY]  );        // До (Дата платежа)
  DefineOprDate( FD.GetKindDate(DATE_DEALEEND),        maxDate(FD.DateArray[DATE_DEALPAY], FD.DateArray[DATE_DEALSETAVOIRISS]));

  if( ИнициализироватьОперациюПогашения( FD ) != 0 )
     return 1;
  end;

  return 0;
end;

