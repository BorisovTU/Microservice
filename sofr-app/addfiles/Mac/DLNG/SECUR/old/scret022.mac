/*
$Name:         scret022.mac
$Module:       Ценные бумаги
$Description:  не используется
*/
/* Операция погашения ц/б
   Проверка необходимости оплаты единовременных комиссий */

/*Макрос не используется*/
import InsCarryDoc, "secinter.mac", "spserv.mac";

macro ExecuteCaseStep( Kind_Operation, Number_Step, FDoc, KindDoc )

  record deal(dl_tick);
  var    FD;

  SetBuff( deal, FDoc );
  FD = SPFirstDoc( deal, false );

  /*Если взведен битовый флаг PM_WRTSUM_ADD_AGENT_ONCE ( т.е. начислена 
    единовременная комиссия посреднику (или бирже) то комиссию надо оплачивать*/
  if( bAND( FD.dl_leg.rec.BitMask, DL_LEG_ADD_AGENT_ONCE ) AND
      (FD.DateArray[DATE_DEALCOMISS] != Date(0,0,0)  )
    )
     return "25";
  else
     return 0; /*не надо оплачивать*/
  end;
end;


