/*
$Name:         scret025.mac
$Module:       Ценные бумаги
$Description:  не используется
*/
/* Операция продажи ц/б на бирже (или через брокера)
   Шаг - Оплата комиссий: учет затрат на продажу ц/б  */

/*Макрос не используется*/
import InsCarryDoc, "sp_categ.mac", "sp_car.mac", "sp_carcm.mac";

macro ExecuteStep( doc, FDoc, DocKind, OperationID )

  record  deal(dl_tick);  
  var     Dk, Dp, FD;

  SetBuff( deal, FDoc );
  FD = SPFirstDoc( deal, false );

  GetOprDate( FD.GetKindDate(DATE_DEALSETAVOIRISS), Dp ); /*Дата поставки*/
  GetOprDate( DATE_DEALCOMISS, Dk ); /*Дата оплаты комиссии*/
 
  if( Dk > {curdate} )
    MsgBox ("Преждевременное выполнение шага запрещено.");
    return 1;
  end;

  return 0;

end;
