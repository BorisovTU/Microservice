/**                                                                                                             
 @file  WrtOffDebtSumOp_Run.mac                                                                                           
 @brief Прослойка для запуска сервисной операции Автоматического списания задолженности из пункта меню                                                                         
                                                                                                                
 #menu 
  - БО ЦБ\Сервисные операции\Автоматическое списание задолженности                                                                         
                                                                                                                
 #tag                                                                                                          
 - functional_block:СО                                                                             
 - code_type:GUI 
 - code_type:API                                                                                                                                                                                               
                                                                                                                
 # changeLog                                                                                                    
 |date       |author         |tasks               |note                                                         
 |-----------|---------------|--------------------|-------------------------------------------------------------
 |2025.02.17 |Жиц М.В.       |BOSS-2177           |Создание макроса прослойки                                                                                                                                                 
*/ 

import WrtOffDebtSumOp;

/**
 @brief Запуск сервисной операции Автоматического списания задолженности с заполнением параметров панели 
*/
MACRO RunWrtOffDebt()
  var errmsg:string = ""; //Переменная под сообщение об ошибке 
  var OperID:integer = 0; //Идентификатор операции расчета
  var param = WrtOffDebtSumOp_Panel();

  while(param.Run())
    if(CheckDebtSumParams(param.GetParams().ProcDate, @errmsg)) //Проверяем корректность параметров
      WrtOffDebtSumOp_Run(param.GetParams(), @OperID, @errmsg);
    end;

    if(errmsg != "")
      msgbox(errmsg);
    end;
  end;
END;

RunWrtOffDebt();
Exit(1);