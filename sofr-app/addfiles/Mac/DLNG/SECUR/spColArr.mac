/*******************************************************************************
 FILE         :   SPCOLARR.MAC

 COPYRIGHT    :   R-Style, 1998 

 DESCRIPTION  :   RS-Bank, БО ЦБ, всякое для создания и генерации массивов столбцов таблиц

 PROGRAMMED BY:   Alex Kormukhin

 CREATION DATE:   7.12.1998
*******************************************************************************/

 import spReport;

  /* Возвращает true, если в массиве arr содержится элемент равный t */
  macro InArray(arr,t)
    var i=0;
    while(i < arr.size)
      if(arr(i) == t)
        return true; end;
      i=i+1;
    end;
    return false;
  end;

  /* Генерит из arr новый массив столбцов, объединяя все, кроме заданных в параметрах */
  /* Идентификаторы объединенных столбцов 0, 1, 2, ... */
  macro GenerateColArrayByUntouchables(arr /*, id1, id2, ... */)
    var idArray=TArray(),
        v,
        arrNew=TArray();
    while(GetParm(1 + idArray.size,v) AND (ValType(v) != V_UNDEF))
      idArray(idArray.size)=v; end;
    var i=0,w=-1,j=0;
    while(i < arr.size)
      if(InArray(idArray,arr(i).id()))
        if(w > 0)
          arrNew(arrNew.size)=TColumn(j,w,string(j));
          j=j+1;
        end;
        arrNew(arrNew.size)=arr(i);/*GenObject(GenClassName(arr(i)),arr(i));*/
        w=-1;
      else
        w=w + arr(i).width + 1;
      end;
      i=i+1;
    end;
    if(w > 0)
      arrNew(arrNew.size)=TColumn(j,w,string(j)); end;
    return arrNew;
  end;

