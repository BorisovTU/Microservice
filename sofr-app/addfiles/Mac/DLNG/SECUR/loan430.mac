/* Операция займа
   Шаг выбора - Проверка режима списания */
import InsCarryDoc, "sp_class.mac";

macro ExecuteCaseStep( Kind_Operation, Number_Step, FDoc, KindDoc)

  record deal(dl_tick);       
  var    FD; 

  SetBuff( deal, FDoc );
  FD = SPFirstDoc( deal );

  if( FD.GetModeWriteOff( true ) != "X" ) /* "X" - online, "" - offline */
     /*работаем в offline*/
     return "435"; /*закрытие в режиме offline*/
  else
     return "440"; /*закрытие в режиме online*/
  end;
end;
