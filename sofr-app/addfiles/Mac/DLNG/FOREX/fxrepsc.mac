/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                                R-Style SoftLab

  File Name   : fxrepsc.mac
  Created     : 28.11.02
  Programmer  : Голдобин А.
  Description : Печать отчетов

└───────────────────────────────────────────────────────────────────────────*/
RECORD deal_firstdoc (dl_tick); 

const   Ошибка	 = 0,
	Первый	 = 1,
	Последний= 2;
const   ДействиеПользователя = 0,
        ГрупповоеСозданииОп = 1,
        ГрупповоеУдаленииОп = 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение, Action)
	setbuff (deal_firstdoc,firstdoc);
	if (Вызов==Первый)
if(Action == ДействиеПользователя)
	setbuff (deal_firstdoc, firstdoc);
[                    Отчет о массовых действиях пользователя.];
elif(Action == ГрупповоеСозданииОп)
[             Отчет о групповом создании операций для сделок.];
elif(Action == ГрупповоеУдаленииОп)
[             Отчет о групповом удалении операций для сделок.];
end;
[+-------+-------+------------------------------------------------------------+];
[|  Код  |№ошибки|                 Сообщение                                  |];
[| сделки|       |                                                            |];
[+-------+-------+------------------------------------------------------------+];
	elif (Вызов==Ошибка)
        	if (Статус == 0)
        	     if (deal_firstdoc.DealStatus==0) /* Сделка на этапе подготовки? */
        	          Сообщение = "Операция создана успешно";   
        	     else
        	          Сообщение = "Перевод сделки в отложенные выполнен успешно";
        	     end;     
        	end;
[|#######|#######|############################################################|](deal_firstdoc.DealCode,Статус,Сообщение);
       	elif (Вызов==Последний)        	
[+-------+-------+------------------------------------------------------------+];
	end;
END;

