/*
$Name:         dl_report_TrnA_G_Form.mac
$Module:       БО ЦБ/ФИССиКО/УВ
$Description:  Отчет "Отчет-сверка проводок глав А и Г" - форма ввода данных
*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_TRNA_G_DEPARTCODE    = 0, // код филиала
    PNFLD_TRNA_G_DEPARTMENT    = 1, // наименование филиала
    PNFLD_TRNA_G_DATE          = 2, // дата начала
    PNFLD_TRNA_G_SEC           = 3, // БО ЦБ
    PNFLD_TRNA_G_DV            = 4, // ФИССиКО
    PNFLD_TRNA_G_VA            = 5, // Учтенные векселя
    PNFLD_TRNA_G_ISAPOSTR      = 6, // С апострофами
    PNFLD_TRNA_G_EXCEL         = 7; // Выпуск отчета в Excel 

CLASS ( DL_CPanel ) DL_Report_TrnA_G_Form()
    PRIVATE MACRO Init()

        AddFieldProc( 0, PNFLD_TRNA_G_DEPARTCODE,   DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, {OperDprt});
        AddFieldProc( 0, PNFLD_TRNA_G_DEPARTMENT,   DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, {OperDprt});
        AddFieldProc( 0, PNFLD_TRNA_G_DATE,         DL_PNFLD_BEGINDATE,  @DL_FldProc_BeginDate, {curdate} );
        AddFieldProc( 0, PNFLD_TRNA_G_SEC,          DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRNA_G_DV,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRNA_G_VA,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_TRNA_G_ISAPOSTR,     DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
        AddFieldProc( 0, PNFLD_TRNA_G_EXCEL,        DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
    END;

    PRIVATE MACRO Check():BOOL
      if ((this.GetFieldValue( PNFLD_TRNA_G_SEC ) == UNSET_CHAR) and
         (this.GetFieldValue( PNFLD_TRNA_G_DV ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_TRNA_G_VA ) == UNSET_CHAR))
        msgbox("Необходимо выбрать хотя бы один параметр для выпуска отчета.");
        return false;
      end;
      return true;
    END;

    initDL_CPanel( "deals.lbr", "REPTRNAG" );
END;
