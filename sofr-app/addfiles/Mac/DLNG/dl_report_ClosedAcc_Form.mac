/*
$Name:         dl_report_ClosedAcc_Form.mac
$Module:       БО ЦБ/ФИССиКО/УВ/СВ/МБК
$Description:  Отчет "Закрытые счетах за период" - форма ввода данных
*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_CLOSEDACC_DEPARTCODE    = 0, // код филиала
    PNFLD_CLOSEDACC_DEPARTMENT    = 1, // наименование филиала
    PNFLD_CLOSEDACC_BEGDATE       = 2, // дата начала
    PNFLD_CLOSEDACC_ENDDATE       = 3, // дата конца
    PNFLD_CLOSEDACC_SEC           = 4, // БО ЦБ
    PNFLD_CLOSEDACC_DV            = 5, // ФИССиКО
    PNFLD_CLOSEDACC_VA            = 6, // Учтенные векселя
    PNFLD_CLOSEDACC_VS            = 7, // Векселя банка
    PNFLD_CLOSEDACC_MBK           = 8, // Сделки МБК
    PNFLD_CLOSEDACC_ISAPOSTR      = 9, // С апострофами
    PNFLD_CLOSEDACC_EXCEL         = 10; // Выпуск отчета в Excel 

CLASS ( DL_CPanel ) DL_Report_ClosedAcc_Form()
    PRIVATE MACRO Init()

        AddFieldProc( 0, PNFLD_CLOSEDACC_DEPARTCODE,   DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, {OperDprt});
        AddFieldProc( 0, PNFLD_CLOSEDACC_DEPARTMENT,   DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, {OperDprt});
        AddFieldProc( 0, PNFLD_CLOSEDACC_BEGDATE,      DL_PNFLD_BEGINDATE,  @DL_FldProc_BeginDate, {curdate} );
        AddFieldProc( 0, PNFLD_CLOSEDACC_ENDDATE,      DL_PNFLD_ENDDATE,    @DL_FldProc_BeginDate, {curdate} );
        AddFieldProc( 0, PNFLD_CLOSEDACC_SEC,          DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_DV,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_VA,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_VS,           DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_MBK,          DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, UNSET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_ISAPOSTR,     DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
        AddFieldProc( 0, PNFLD_CLOSEDACC_EXCEL,        DL_PNFLD_CHECKBOX,   @DL_FldProc_CheckBox, SET_CHAR);
    END;

    PRIVATE MACRO Check():BOOL
      if ((this.GetFieldValue( PNFLD_CLOSEDACC_SEC ) == UNSET_CHAR) and
         (this.GetFieldValue( PNFLD_CLOSEDACC_DV ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_CLOSEDACC_VA ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_CLOSEDACC_VS ) == UNSET_CHAR) and 
         (this.GetFieldValue( PNFLD_CLOSEDACC_MBK ) == UNSET_CHAR))
        msgbox("Необходимо выбрать хотя бы один параметр для выпуска отчета.");
        return false;
      end;
      return true;
    END;

    initDL_CPanel( "deals.lbr", "REPCLACC" );
END;
