/*
$Name: ul_inputdataobj.mac
$Module: Универсальный загрузчик
$Description: Промежуточный объект данных, описывающий объект вида данных внешнего источника
*/

CLASS UL_InputDataObj_Base()
  private var
      ar_keys = TArray,
      ar_values = TArray;

  // Добавить пару ключ-значение
  MACRO Add(_key, _value)
      ar_keys[ar_keys.size] = strupr(_key);
      ar_values[ar_values.size] = _value;
  END;

  // Получить значение по ключу. Поиск без учета регистра
  MACRO GetValue(_key)
    var
        idx = 0, retVal = NULL;

      _key = strupr(_key);

      if (strlen(_key) > 0)
          while (idx < ar_keys.size)
              if (_key == ar_keys[idx])
                  break;
              end;

              idx = idx + 1;
          end;
 
          if ((ar_keys.size > 0)and(idx < ar_keys.size))
              retVal = ar_values[idx];
          end;
      end;

      return retVal;
  END;
END;
