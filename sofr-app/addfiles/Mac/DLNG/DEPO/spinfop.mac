/*******************************************************************************
 FILE         :   spInfOp.mac

 COPYRIGHT    :   R-Style, 2000

 DESCRIPTION  :   RS-Bank, БО ЦБ, макрос обслуживания информационных документов

 PROGRAMMED BY:   Леонов И. Е.

 CREATION DATE:   IL 05.09.2000
*******************************************************************************/
import DPInter, SPInter, PTInter, globals, opr_depo;
import RsbDataSet;

/* значения пераметра Mode в ПроверитьОперацию */
const modeInsert = 1,   /* Функция вызвана при создании новой инф. операции */
      modeUpdate = 2,   /* -"- при редактировании инф. операции */
      modeDelete = 3,   /* -"- при удалении информ. операции */
      modeDefer  = 5;   /* -"- при перемещении в отложенные */

/* Уже заполненные структуры, все изменения отразятся в базах */
record LogOpr( splogopr );
record InfOpr( spinfopr );
record Draft ( spground );
record Ground( spground );

/* Вызывается при создании новой информационной операции. Если вернет не 0, 
   операция не будет создана */
macro НоваяОперация()
  return 0;
end;

/* Проверка информационной операции. Должна возвращать не 0, при ошибке */
macro ПроверитьОперацию( Mode:integer )

  if( mode == modeInsert )
     /* действия при создании нового */
  elif( mode == modeUpdate )
     /* действия при редактироании */
  elif( mode == modeDelete )
     /* действия при удалении */
  elif( mode == modeDefer )
     /* действия при откате */
  end;

  return 0;
end;

/* Установка подсказки для скролингов из макроса */
PRIVATE MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStatus:integer, ScrolKind:integer ):string
  //  Возможные значения ScrolStatus:
  // 0,  //все       
  // 1,  //отложенные
  // 3   //закрытые  
  
  //  Возможные значения ScrolKind:
  // 0,   // Всегда

  //пример
  //return "/*+FIRST_ROWS LEADING(t) INDEX(t dspinfopr_dbt_idx0)*/";

  return DefaultHint;

END;

/* Вызывается по CTRL+Z из панели информационной операции */
macro ФункцияПользователя()
  return 0;
end;

