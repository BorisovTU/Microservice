/*******************************************************************************
 FILE         :   dpspgrsc.mac
 COPYRIGHT    :   R-Style, 2009
 DESCRIPTION  :   Макрос скролинга документов Депозитария
 PROGRAMMED BY:   Nikonorov Evgeny
 CREATION DATE:   20.07.2009
*******************************************************************************/
import DPInter, SPInter, PTInter, globals, opr_depo;
import RsbDataSet;

/* Уже заполненные структуры, все изменения отразятся в базах */
//record Документ( dpmsginf );
//record СтарыйДокумент( dpmsginf );
PRIVATE VAR Документ         = TRecHandler( "spground" );
PRIVATE VAR СтарыйДокумент   = TRecHandler( "spground" ); /* заполняется при редактировании */


/* Макрофункция инициализации нового актива 
   необходимо заполнить структуру "Документ"
   возвращаемое значение
   0 - ошибок не было
   1 - была ошибка
*/
PRIVATE MACRO Новый_Документ()
  
  return 0;
END;


/* Проверка информационной операции. Должна возвращать не 0, при ошибке */
private macro Проверить_Документ( Режим:integer )
  
  if(Режим == 3) //редактирование операции

    //здесь должны быть проверки при редактировании
  elif(Режим == 2) //ввод

    //здесь должны быть проверки при вводе
  elif(Режим == 1) //удаление
    
    //здесь должны быть проверки при удалении

  end;

  return 0;
end;

/* Установка подсказки для скролингов из макроса */
private MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStatus:integer, ScrolKind:integer ):string

  //ScrolStatus
  // 0 первичные документы депозитария
  // 1 документы приложения депозитария
  // 2 все зарегистрированные депозитария
  // 3 первичные документы клиентские  
  // 4 документы приложения клиентские 
  // 5 все зарегистрированные клиентские
  // 6 незарегистрированные
  // 7 все входящие
  // 8 отчеты об исполнении
  // 9 все исходящие

  //ScrolKind
  //Всегда 0


  //пример
//  return "/*+FIRST_ROWS LEADING(t) INDEX(t dspground_dbt_idx0)*/";

  return DefaultHint;

END;

/* Вызывается по CTRL+Z из панели информационной операции */
private macro Функция_Пользователя()
  return 0;
end;

