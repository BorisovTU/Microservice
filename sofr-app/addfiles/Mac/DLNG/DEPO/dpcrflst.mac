/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : dpcrflst.mac
  Created     : 23.11.02
  Programmer  : Chernov Anton
  Description : Печать отчета сканирования

└───────────────────────────────────────────────────────────────────────────*/

RECORD dppmfi( dppmfi ); 
FILE   fins( fininstr );

const Ошибка = 0,
      Первый = 1,
   Последний = 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
     var code;

     setbuff ( dppmfi, firstdoc );

     if ( Вызов == Первый )
[             Отчет о групповом добавлении выпусков ценных бумаг.];
[+----------------+--------+-----------------------------------------------------------------------------------------+];
[| код  цб        | №      |                 Сообщение                                                               |];
[|                | ошибки |                                                                                         |];
[+----------------+--------+-----------------------------------------------------------------------------------------+];
     elif ( Вызов == Ошибка )

        if ( Статус == 0 ) 
           Сообщение = "ценная бумага успешно добавлена.";
        end;

        fins.FIID = dppmfi.FIID;
        if ( GetEQ(fins) )
          code = fins.FI_Code;
        else
          code = "";
        end;

[|################|########|#########################################################################################|]
(code, Статус, Сообщение);
     elif ( Вызов == Последний )            
[+----------------+--------+-----------------------------------------------------------------------------------------+];
     end;

END;
