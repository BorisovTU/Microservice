/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : dpcrplst.mac
  Created     : 18.11.02
  Programmer  : Chernov Anton
  Description : Печать отчета сканирования

└───────────────────────────────────────────────────────────────────────────*/

RECORD dpacccrp( dpacccrp ); 
FILE   depoacnt( depoacnt );

const Ошибка = 0,
      Первый = 1,
   Последний = 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
     var Account;

     setbuff ( dpacccrp, firstdoc );

     if ( Вызов == Первый )
[             Отчет о групповом добавлении счетов НОСТРО.];
[+------------+--------+-----------------------------------------------------------------------------------------+];
[| код счета  | №      |                 Сообщение                                                               |];
[|            | ошибки |                                                                                         |];
[+------------+--------+-----------------------------------------------------------------------------------------+];
     elif ( Вызов == Ошибка )

        if ( Статус == 0 ) 
           Сообщение = "Счет успешно добавлен.";
        end;

        depoacnt.AutoKey = dpacccrp.DepoAccID;
        if ( GetEQ(depoacnt) )
          Account = depoacnt.BriefCode;
        else
          Account = "";
        end;

[|############|########|#########################################################################################|]
(Account, Статус, Сообщение);
     elif ( Вызов == Последний )            
[+------------+--------+-----------------------------------------------------------------------------------------+];
     end;

END;
