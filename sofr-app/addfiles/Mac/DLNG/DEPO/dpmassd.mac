/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                          R-Style SoftLab

  File Name   : dpmassd.mac
  Created     : 07.09.04
  Programmer  : Nikonorov Evgeny
  Description : Печать отчетов удаления документов 

└───────────────────────────────────────────────────────────────────────────*/
import dpscanr, BankInter;

const РежимУдалВхДок   = 0,
      РежимУдалОтчИВып = 1,
      РежимУдалДокОсн  = 2;

macro ОтчетДокументы( Вызов, firstdoc, Статус, Сообщение, Режим )
     var KindName;

     RECORD spgr(spground); 
     FILE spground(spground);
     FILE llval(llvalues);

     setbuff(spgr,firstdoc);
               
     if (Вызов==Первый)
       if(Режим == РежимУдалВхДок)
[             Отчет о групповом удалении входящих документов.];
       elif(Режим == РежимУдалОтчИВып)
[             Отчет о групповом удалении отчетов и выписок.];
       elif(Режим == РежимУдалДокОсн)
[             Отчет о групповом удалении документов-оснований.];
       end;
[+-------+-----------------------------------------+-------+----------------------------------------------------------------------------------------+];
[| Вх.№  |                 Вид                     | №     |                 Сообщение                                                              |];
[| док.  |              документа                  | ошибки|                                                                                        |];
[+-------+-----------------------------------------+-------+----------------------------------------------------------------------------------------+];
     elif (Вызов==Ошибка)
        
         if( spgr.Kind )
           llval.Element = spgr.Kind;
           llval.List = 1050;
           if( GetEQ(llval) )
             KindName = llval.Name;
           else 
             KindName = "";
           end;
         end;
              
        if(Статус == 0) 
           if(spgr.SpgroundID)
              spground.SpgroundID = spgr.SpgroundID;
              if( GetEQ(spground) )
                 Сообщение = "Документ не удален.";
              else
                 Сообщение = "Документ успешно удалён.";
              end;
           end;
        end;

[|#######|#########################################|#######|########################################################################################|]
( spgr.Xld, KindName, Статус, Сообщение);
     elif (Вызов==Последний)            
[+-------+-----------------------------------------+-------+----------------------------------------------------------------------------------------+];
     end;
end;


/* точка входа в макрос!!! */
MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение,Режим)
     if( (Режим == РежимУдалВхДок)   OR
         (Режим == РежимУдалОтчИВып) OR
         (Режим == РежимУдалДокОсн) )
       ОтчетДокументы(Вызов, firstdoc, Статус, Сообщение, Режим);
     end;

END;