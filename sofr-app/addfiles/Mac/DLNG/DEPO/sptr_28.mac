/* операция "Междепозитарный перевод эмиссионных ценных бумаг" */
/* шаг      "квитовка встречных поручений"                     */
/* Nikonorov Evgeny 22-09-2006                                 */

import InsCarryDoc, OprInter, PaymInter, "dlcarry.inc", opr_depo;

/* Буферы ПД, заполняемые из операции */
record Pm_paym( pmpaym );     /*основной платеж*/
record Pm_prop_deb( pmprop ); /*св-ва платежа банка-плательщика*/
record Pm_prop( pmprop );     /*св-ва платежа*/
record Pm_rmprop( pmrmprop ); /*платеж по ценным бумагам*/


macro ExecuteStep( d, spdraft )
  var err = 0;
  record spdraft_buf( spdraft );

  if( DP_CheckRejectedDepoDraft( spdraft, Pm_paym, err ) ) return err; end;

  SetBuff( spdraft_buf, spdraft );

  err = DP_IncDraftScrol(spdraft_buf.AutoKey);

  return err;
end;