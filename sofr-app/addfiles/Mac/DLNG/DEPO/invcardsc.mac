/************************************************************************/
/*         Автоматизированная банковская система RS-Bank v6             */
/*                 Copyright (c) R-Style SoftLab 2014                   */
/*  Имя файла        : invcardsc.mac                                    */
/*  Описание         : Проверка ИК                                      */
/*  Программист      : Nikonorov Evgeny                                 */
/*  Создан           : 25.04.2014                                         */
/************************************************************************/
import BankInter, Globals;

/* Уже заполненные структуры, все изменения отразятся в базах */
PRIVATE VAR Документ         = TRecHandler( "invcard.dbt" );
PRIVATE VAR СтарыйДокумент   = TRecHandler( "invcard.dbt" ); /* заполняется при редактировании */

//Только для описи сертификатов
PRIVATE VAR InvList      = TRecHandler( "invlist.dbt" );
PRIVATE VAR OldInvList   = TRecHandler( "invlist.dbt" ); /* заполняется при редактировании */

//!!!Внимание! При работе скроллинга в качестве описи сертификатов идентификаторы в буферах могут быть "не настоящие", а временные (но не отрицательные)
//т.е. по ним бессмысленно что-то искать в постоянных таблицах

/* Вызывается по CTRL+Z из скроллинга */
private macro Функция_Пользователя()
  MsgBox( "Выполняется макрофункция \"invcardsc.mac\\ Функция_Пользователя\"." );
  return 0;
end;

private macro Проверить_Документ( Режим:integer )
  if(Режим == 3) //редактирование ИК

    //здесь должны быть проверки при редактировании

  elif(Режим == 1) //удаление
    
    //здесь должны быть проверки при удалении ИК

  end;

  return 0;
end;

/* Установка подсказки для скролингов из макроса */
private MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStatus:integer, ScrolKind:integer ):string

  //пример
  //return "/*+FIRST_ROWS LEADING(t) INDEX(t dinvcard_dbt_idx0)*/";

  return DefaultHint;

END;
