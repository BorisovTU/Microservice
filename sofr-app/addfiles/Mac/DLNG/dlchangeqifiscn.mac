/*Œ áá®¢®¥ ¢ë¯®«­¥­¨¥ ¤¥©áâ¢¨© ­ ¤ ¢¨¤ ¬¨ ”ˆ ¤«ï Šˆ*/
IMPORT FIInter;

PRIVATE RECORD scqinvfi( scqinvfi );

PRIVATE CONST ERROR_EXEC = 0,
              PRINT_HEADER = 1,
              PRINT_FOOTER = 2;

/*ˆ¬ï ¢¨¤  æ/¡*/
private macro AvoirKindName(AvoirKind)
   var RetVal = "";
   file avrkind ("avrkinds");   
   avrkind.FI_Kind = FIKIND_AVOIRISS;
   avrkind.AvoirKind = AvoirKind;
   if(GetEQ(avrkind))
      RetVal = avrkind.Name;
   end;
   return RetVal;
end;

PRIVATE MACRO PrintHead( Head:STRING )
[
                   #
ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
³     ‚¨¤ ”ˆ         ³  ü   ³                      ‘®®¡é¥­¨¥                                                                    ³
³                    ³®è¨¡ª¨³                                                                                                   ³
ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´](Head);
END;


PRIVATE MACRO PrintFooter()
[ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
];

END;

PRIVATE MACRO PrintLine( ErrStatus:INTEGER, ErrMessage:STRING )
[³####################³######³###################################################################################################³]
( AvoirKindName(scqinvfi.AvoirKind):w, ErrStatus, ErrMessage:w );
END;

PRIVATE MACRO ChangeState( NumExec:INTEGER, ErrStatus:INTEGER, ErrMessage:STRING )
  if( NumExec == PRINT_HEADER )
     PrintHead( "âç¥â ® ¬ áá®¢®¬ ¨§¬¥­¥­¨¨ áâ âãá  Šˆ." );
  elif( NumExec == PRINT_FOOTER )            
     PrintFooter();
  elif( NumExec == ERROR_EXEC )
     if( ErrStatus == 0 ) 
        ErrMessage = "‘â âãá ¨§¬¥­ñ­.";
     else
        ErrMessage = ErrMessage + "\n‘â âãá ­¥ ¨§¬¥­ñ­.";
     end;
     PrintLine( ErrStatus, ErrMessage);
  end;
END;

MACRO ¥ç âì_âç¥â‘ª ­¨à®¢ ­¨ï( NumExec:INTEGER, FDoc:VARIANT, ErrStatus:INTEGER, ErrMessage:STRING, Action:INTEGER )

  SetBuff( scqinvfi, FDoc );

  if( Action == 1 )
     ChangeState( NumExec, ErrStatus, ErrMessage );
  end;

END;
