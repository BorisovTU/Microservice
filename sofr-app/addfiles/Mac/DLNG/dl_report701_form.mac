/*
$Name: dl_report701_form.mac
$Module: Ядро Securities
$Description: <Отчеты> / <Регламентированные> / <Указание №4927-У> / <Отчет об операциях на валютных и денежных рынках (ф.701)> - форма отчета 
*/
import "DlRepForm_h.mac", "globals.mac";

/*Номера полей в форме отчета*/
CONST PNFLD_701_DATE               = 0,
      PNFLD_701_INTERMEDIATE       = 1,
      PNFLD_701_BY_SC_OWN          = 2,
      PNFLD_701_BY_SC_CLIENT       = 3,
      PNFLD_701_BY_DV_DERIV_OWN    = 4,
      PNFLD_701_BY_DV_DERIV_CLIENT = 5,
      PNFLD_701_BY_DV_CUR_OWN      = 6,
      PNFLD_701_BY_DV_CUR_CLIENT   = 7,
      PNFLD_701_BY_DV_OTHER        = 8,
      PNFLD_701_BY_MBK             = 9,
      PNFLD_701_ALL_BANK           = 10,
      PNFLD_701_ONLY_HEAD          = 11,
      PNFLD_701_ONLY_FILIAL        = 12,
      PNFLD_701_FILIAL_CODE        = 13,
      PNFLD_701_IN_EXCEL           = 14,
      PNFLD_701_IN_KLIKO           = 15,
      PNFLD_701_IN_DELTA           = 16;

PRIVATE CONST
  H_CHECKBOX_ALL_BANK    = 100,
  H_CHECKBOX_ONLY_HEAD   = 101,
  H_CHECKBOX_ONLY_FILIAL = 102,
  H_CHECKBOX_IN_EXCEL    = 103,
  H_CHECKBOX_IN_KLIKO    = 104,
  H_CHECKBOX_BY_SC_OWN          = 105,
  H_CHECKBOX_BY_SC_CLIENT       = 106,
  H_CHECKBOX_BY_DV_DERIV_OWN    = 107,
  H_CHECKBOX_BY_DV_DERIV_CLIENT = 108,
  H_CHECKBOX_BY_DV_CUR_OWN      = 109,
  H_CHECKBOX_BY_DV_CUR_CLIENT   = 110,
  H_CHECKBOX_BY_DV_OTHER        = 111,
  H_CHECKBOX_BY_MBK             = 112,
  H_CHECKBOX_INTERMEDIATE       = 113;

PRIVATE MACRO DL_FldProc_CheckBox_ALL_BANK( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if( FldRealValue == "X" )
        return CM_IGNORE;
     else
        FldShowValue = FldRealValue = "X";
        pThis.SetLinkedValue( H_CHECKBOX_ONLY_HEAD, "" );
        pThis.SetLinkedValue( H_CHECKBOX_ONLY_FILIAL, "" );
        DisableFields( pThis.Data(), PNFLD_701_FILIAL_CODE );
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_ONLY_HEAD( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if( FldRealValue == "X" )
        return CM_IGNORE;
     else
        FldShowValue = FldRealValue = "X";
        pThis.SetLinkedValue( H_CHECKBOX_ALL_BANK, "" );
        pThis.SetLinkedValue( H_CHECKBOX_ONLY_FILIAL, "" );
        DisableFields( pThis.Data(), PNFLD_701_FILIAL_CODE );
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_ONLY_FILIAL( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if( FldRealValue == "X" )
        return CM_IGNORE;
     else
        FldShowValue = FldRealValue = "X";
        pThis.SetLinkedValue( H_CHECKBOX_ALL_BANK, "" );
        pThis.SetLinkedValue( H_CHECKBOX_ONLY_HEAD, "" );
        EnableFields( pThis.Data(), PNFLD_701_FILIAL_CODE );
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_IN_EXCEL( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if( FldRealValue == "X" )
        FldShowValue = FldRealValue = "";
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_IN_KLIKO( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if( FldRealValue == "X" )
        FldShowValue = FldRealValue = "";
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_SC_OWN( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_SC_CLIENT( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_DV_DERIV_OWN( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_DV_DERIV_CLIENT( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_DV_CUR_OWN( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_DV_CUR_CLIENT( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_DV_OTHER( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_MBK ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_BY_MBK( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;                                                                                       
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        if( (pThis.GetFieldValue( PNFLD_701_BY_SC_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_SC_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_DERIV_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_OWN ) != "X") and (pThis.GetFieldValue( PNFLD_701_BY_DV_CUR_CLIENT ) != "X") and
            (pThis.GetFieldValue( PNFLD_701_BY_DV_OTHER ) != "X") 
          )
           return CM_IGNORE;
        else
           FldShowValue = FldRealValue = "";
        end;
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_CheckBox_INTERMEDIATE( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
     if( FldRealValue == null ) 
        FldRealValue = "";
     end;
     FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE )
     FldRealValue = FldShowValue;
  elif( (Cmd == DLG_KEY) and (Key == KEY_SPACE) )
     if(FldRealValue == "X")
        FldShowValue = FldRealValue = "";
     else
        FldShowValue = FldRealValue = "X";
     end;
  end;
  return CM_DEFAULT;
END;

PRIVATE MACRO DL_FldProc_Department( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
file   dep( dp_dep );

  if( Cmd == DLG_INIT )
     if( FldRealValue == null )
        FldRealValue = -1;
     end;
     if( FldRealValue < 0 )
        FldShowValue = "";
     else
        FldShowValue = DL_GetDepartmentNameByCode(FldRealValue);
     end;
  elif( (Cmd == DLG_KEY) AND (Key == KEY_SPACE) )
     FldRealValue = -1;
     FldShowValue = "";
  elif( (Cmd == DLG_KEY) AND (Key == KEY_F3) ) // Вызов листалки и заполнение FldShowValue и FldRealValue
     if( ListDepartment( dep ) )
        FldRealValue = dep.Code;
        FldShowValue = DL_GetDepartmentNameByCode(dep.code);
     end;
  end;
  return CM_DEFAULT;
END;

CLASS (DL_CPanel) DL_REP701_Panel()

  PRIVATE MACRO Init()

     DisableFields( This.Data(), PNFLD_701_FILIAL_CODE );

     AddFieldProc( 0, PNFLD_701_DATE,               DL_PNFLD_ENDDATE,              @DL_FldProc_EndDate,  {curdate} );
     AddFieldProc( 0, PNFLD_701_INTERMEDIATE,       H_CHECKBOX_INTERMEDIATE,       @DL_FldProc_CheckBox_INTERMEDIATE,  "" );

     AddFieldProc( 0, PNFLD_701_BY_SC_OWN,          H_CHECKBOX_BY_SC_OWN,          @DL_FldProc_CheckBox_BY_SC_OWN, "X" ); 
     AddFieldProc( 0, PNFLD_701_BY_SC_CLIENT,       H_CHECKBOX_BY_SC_CLIENT,       @DL_FldProc_CheckBox_BY_SC_CLIENT, "X" ); 
     AddFieldProc( 0, PNFLD_701_BY_DV_DERIV_OWN,    H_CHECKBOX_BY_DV_DERIV_OWN,    @DL_FldProc_CheckBox_BY_DV_DERIV_OWN, "X" );
     AddFieldProc( 0, PNFLD_701_BY_DV_DERIV_CLIENT, H_CHECKBOX_BY_DV_DERIV_CLIENT, @DL_FldProc_CheckBox_BY_DV_DERIV_CLIENT, "X" );
     AddFieldProc( 0, PNFLD_701_BY_DV_CUR_OWN,      H_CHECKBOX_BY_DV_CUR_OWN,      @DL_FldProc_CheckBox_BY_DV_CUR_OWN, "X" );
     AddFieldProc( 0, PNFLD_701_BY_DV_CUR_CLIENT,   H_CHECKBOX_BY_DV_CUR_CLIENT,   @DL_FldProc_CheckBox_BY_DV_CUR_CLIENT, "X" );
     AddFieldProc( 0, PNFLD_701_BY_DV_OTHER,        H_CHECKBOX_BY_DV_OTHER,        @DL_FldProc_CheckBox_BY_DV_OTHER, "X" );
     AddFieldProc( 0, PNFLD_701_BY_MBK,             H_CHECKBOX_BY_MBK,             @DL_FldProc_CheckBox_BY_MBK, "X" );

     AddFieldProc( 0, PNFLD_701_ALL_BANK,    H_CHECKBOX_ALL_BANK,     @DL_FldProc_CheckBox_ALL_BANK, "" );
     AddFieldProc( 0, PNFLD_701_ONLY_HEAD,   H_CHECKBOX_ONLY_HEAD,    @DL_FldProc_CheckBox_ONLY_HEAD, "X" );
     AddFieldProc( 0, PNFLD_701_ONLY_FILIAL, H_CHECKBOX_ONLY_FILIAL,  @DL_FldProc_CheckBox_ONLY_FILIAL, "" );
     AddFieldProc( 0, PNFLD_701_FILIAL_CODE, DL_PNFLD_DEPARTMENT,     @DL_FldProc_Department, "" );

     AddFieldProc( 0, PNFLD_701_IN_EXCEL,    H_CHECKBOX_IN_EXCEL,     @DL_FldProc_CheckBox_IN_EXCEL, "X");
     AddFieldProc( 0, PNFLD_701_IN_KLIKO,    H_CHECKBOX_IN_KLIKO,     @DL_FldProc_CheckBox_IN_KLIKO, "");
     
     AddFieldProc( 0, PNFLD_701_IN_DELTA,    DL_PNFLD_CHECKBOX,     @DL_FldProc_CheckBox, "");

  END;

  PRIVATE MACRO Check():BOOL
     if( (this.GetFieldValue( PNFLD_701_ONLY_FILIAL ) == SET_CHAR) and
         (this.GetFieldValue( PNFLD_701_FILIAL_CODE ) < 0 )
       )
        msgbox("Необходимо выбрать филиал");
        return false;
     end;
     return true;
  END;

  initDL_CPanel( "dlrep.lbr", "DLREP701" ); 
END;

//DL_REP701_Panel().run();
//exit(1); 