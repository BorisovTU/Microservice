/*   Расчетная Операция ВУ          
   Шаг - формирование поручения Депо
*/
IMPORT InsCarryDoc, FiInter, DealsInter, BankInter, "dlcnst.inc";

macro executeParamStep( kind_oper, BOf_kind, FDoc )

     record dl_acc( dl_acc );
     var Ret = false;
     var OprStat;
     SetBuff( dl_acc, FDoc );

     DefineOprDate( 1, dl_acc.ValueDate );

     if( (dl_acc.FormPaym != "X") or (dl_acc.FIKind == FIKIND_CURRENCY) or (DL_WORKWITHDEPOSITARY == UNSET_CHAR) )
         OprStat = 3;  //Перевод актива
     else
         OprStat = 2; //Поручение депо
     end;

     if( not InsertOprStatus( 1592, OprStat) )   
        msgbox( "Ошибка при установке статуса операции" );
        return 1;
     end;

    return 0;

end;
