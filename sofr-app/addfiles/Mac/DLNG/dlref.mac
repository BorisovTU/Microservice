///////////////////////////////////////////////////////////////////////////////////
//*******************************************************************************//
//*  Модуль           : DLNG                                                    *//
//*  Имя файла        : dlref.mac                                               *//	
//*  Описание         : Работа с референсами                                    *//
//*  Программист      : Куперин М.В. //AV 06.08.2009                            *//
//*******************************************************************************//
///////////////////////////////////////////////////////////////////////////////////
import BankInter;

macro DL_GenRefByTypeDoc(TypeDoc, Ref, RefID)
  var
    retVal = true;

    RefID = 0;
    Ref   = "";

    if ((GetReferenceIDByType(TypeDoc, 1, refID))or
        (GenerateReference(refID, Ref)))
        retVal = false;
    end;

    SetParm(1, Ref);
    SetParm(2, RefID);

    return retVal;
end;

macro DL_RestoreRefByTypeDoc(TypeDoc, Ref)
  var
    retVal = true,
    RefID = 0;

    if ((GetReferenceIDByType(TypeDoc, 1, refID))or
        (RestoreReference(refID, Ref)))
        retVal = false;
    end;

    return retVal;
end;
