/*    Биржевая операция c ПИ                 */
/*    Шаг расчета комиссий                   */

import InsCarryDoc;

MACRO ExecuteStep( DlDoc, FDoc, DocKind, ID_Operation, ID_Step )
  
  record deal(dvdeal);

  SetBuff( deal, FDoc );

/*
Ищется ДО с контрагентом по расчетам:
==>   с видом обслуживания "Срочные контракты"
==>   действующий на дату операции
==>   с плательщиком, равным нашему банку
==>   Если не задан DDVDEAL.T_BROKER то с получателем DDVDEAL.T_FIID-> DFININSTR.T_ISSUER
==>   Иначе с получателем  DDVDEAL.T_BROKER и номером DDVFIPOS [DDVDEAL.T_FIID, DDVDEAL.T_DEPARTMENT, DDVDEAL.T_BROKER, DDVDEAL.T_CLIENT].T_BROKERCONTR
Если ДО не найден, то ошибка.
Если по договору есть единовременные комиссии, то выполняется их расчет.

При откате шага выполняется откат расчета комиссий.
*/


  return 0;
end;
