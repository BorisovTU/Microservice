/* Проверка ограничения */
/* Минимальный взнос */

MACRO TS_CheckLimit(Val:double, CheckVal:double, OrderFD, MngPlan):bool

   var RetVal = true;

   if(OrderFD.Kind == TS_DOC_DPOFBU)  /* ограничение только для ДП ОФБУ */
      if(CheckVal < Val)
         if( MsgBoxEx("Вносимая сумма нарушает ограничение плана управления по договору присоединения.\nМинимальный взнос составляет <" + string(Val) + ">.| Продолжить выполнение?", MB_YES+MB_NO, IND_NO ) == IND_NO )
            RetVal = false;
         end;
      end;
   end;

   return RetVal;
END;