/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style SoftLab

  File Name   : trvar250.mac
  Programmer  : Nikonorov Evgeny
  Операция    : Погашение векселей в ДУ
  Шаг         : 250 - Исполнение требований
└───────────────────────────────────────────────────────────────────────────*/
import InsCarryDoc, globals, trvafd, varepay, trvautl;


macro ExecuteStep( doc, FDoc, DocKind, ID_Operation )

  record tick(dl_tick);
  var PayDate;
  var stat = 0;

  SetBuff( tick, FDoc );
  var fd = TS_VATickFD( tick );

  GetOprDate( DATE_REP_PAY, PayDate ); /* Dо (Дата оплаты) */

  stat = ИсполнитьТребованияПоСделке(fd, doc, ID_Operation, tick, PayDate, PayDate, 23);

  return stat;

end;