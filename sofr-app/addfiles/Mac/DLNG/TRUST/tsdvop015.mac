/* Расчеты по производным инструментам с биржей/брокером в ДУ
   Расчет итоговых сумм*/
import "dvOperSt.mac", TSInter, "dvrepfun2.mac", "dv_fun.mac", "tsdv.mac", InsCarryDoc;

PRIVATE VAR DVOper        = TRecHandler( "dvoper" ),
            OperationID   = 0,
            OperationDate = DATE(0,0,0);
macro ExecuteStep( doc, FDoc, DocKind, _OperationID, ID_Step)
  
   record   oper(dvoper);
   DVOper.SetRecordAddr( FDoc );
   OperationID = _OperationID;

   GetOprDate( 0 /*Дата операции*/, OperationDate );

   Copy( oper, DVOper );
   if( ВыполнитьРасчетИтоговыхCуммПоПозиции( oper ) != 0 )
      return 1;
   end;

   return 0;
end;
