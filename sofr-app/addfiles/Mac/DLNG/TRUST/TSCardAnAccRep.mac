/********************************************************************************************
 DESCRIPTION  : Запуск отчета "Карточка аналитического учета"
********************************************************************************************/
IMPORT "TSCardAnAccRep_IDDU.mac", "TSCardAnAccRep_POFBU.mac", "TSCardAnAccRep_DOFBU.mac";

macro MakeReports()

  var m_Form = TS_CardAnAcc_Panel();

  while( m_Form.Run() )
     var FData = m_Form.ReturnFormFields();
     if( FData.IDDU == "X" )
        TS_CardAnAcc_Report(FData).Run();
     elif( FData.OFBU == "X" )
        if( FData.OFBU_Number > 0 ) /* задан конкретный договор */
           var OrderFD = TS_OrderFD(0, FData.OFBU_Number);
           if( OrderFD.ЭтоПаевойОФБУ() )
              TS_CardAnAccPOFBU_Report(FData).Run();
           else
              TS_CardAnAccDOFBU_Report(FData).Run();
           end;
        else
           TS_CardAnAccPOFBU_Report(FData).Run();
           TS_CardAnAccDOFBU_Report(FData).Run();
        end;
     end;
  end;

end;

MakeReports();
exit(1);