/*Формирование поручения депо при внесении капитала*/
IMPORT InsCarryDoc, TSInter;

PRIVATE VAR Request = TRecHandler( "tsiorqst.dbt" ); /*Заполняется программой при выполнении шага*/

MACRO ExecuteStep( DlDoc, FDoc, DocKind, ID_Operation, ID_Step )
  VAR recAsset,
      AssetFD:TS_ReqAssetFD,
      OrderFD = TS_OrderFD( 0, Request.rec.OrderID ),
      ReqFD   = TS_RequestFD( Request, null, OrderFD );

  if( ( Request.rec.ActiveKind != TS_IOREQ_ACTIVEKIND_MONEY ) AND 
      ( РАБОТА_С_ДЕПОЗИТАРИЕМ() != TS_WORK_DEPO_NO) 
    )
     if( OrderFD.СчетДепо() == NULL )
        MsgBox( "По данному договору ДУ не открыт счет ДЕПО с типом Траст." );
        return 1;
     end;
  end;

  if( not ReqFD.InsertDepoDraft() )
     return 1;
  end;

  return 0;
END;

