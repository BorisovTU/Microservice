/* Операция сопровождения общих условий ОФБУ 
   Закрытие договора*/
IMPORT InsCarryDoc, TSInter, "tsutil.mac";

MACRO ExecuteStep( DlDoc, FDoc, DocKind, ID_Operation, ID_Step )

  VAR Order = TRecHandler( "tsorder.dbt" ),
      ДатаИсполненияШага = {curdate};

  if( TS_CheckExecuteClose( ID_Operation ) == false )
     return 1;
  end;

  Order.SetRecordAddr( FDoc );

  if( TS_SetOrderCloseDate( Order.rec.ID, ДатаИсполненияШага ) ) 
     return 1;
  end;

  return 0;
END;

