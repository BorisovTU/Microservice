/*
  nontrading_orders_load_exchange_ui.mac
*/
import "nontrading_orders_load_from_file.mac";

macro openFile()
  var mask:string = "*.csv";
  var fileFullName:string = "";
  var onTerm:bool = true;
  var filepath:string, fileName:string, extName:string;
  var starter = c_file_load_starter();

  starter.SetExchangeType();

  if (not SelectFile(fileFullName, starter.fileTargetPath + "\\" + mask, "Выберите файл для загрузки", 0, onTerm))
    MsgBox("Файл не выбран");
    exit(1);
  end;

  splitfile(fileFullName, fileName, extName);
  filepath = substr(fileFullName, 1, strlen(filefullname) - strlen(extname) - strlen(filename));
  starter.RunManual(filePath, fileName + extName);
end;

openFile();