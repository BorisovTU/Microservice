/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : dlimport.mac
  Programmer  : Korolev Sergey
  Description : Импорт сделок из шлюза. Сервисные процедуры.
  Comment     :
└───────────────────────────────────────────────────────────────────────────*/
IMPORT PTInter;

/* Макрос преобразовавает платежные инструкции в формат RS-Bank 5.1 */
MACRO ЗаполнитьПлатежнуюИнструкцию
(
        InstrNum,       /* МБК: PM_PURP_PRINC/PM_PURP_PRINC_RET; КО: BAi/CAi/BRi/CRi*/
        tick_buff,      /* Буфер сделки */
        leg_buff,       /* Буфер транша */
        freeinstr,      /* Платежная инструкция в свободном формате */
        swiftinstr,     /* Платежная инструкция в формате SWIFT (может отсутствовать)*/
        debet_buff,     /* свойства платежа по дебету */
        credit_buff     /* свойства платежа по кредиту */
)
    RECORD tick   ("dl_tick","bank.def");
    RECORD leg    ("dl_leg" ,"bank.def");
    RECORD debet  ("pmprop" ,"bank.def");
    RECORD credit ("pmprop" ,"bank.def");

    SetBuff (tick,  tick_buff);
    SetBuff (leg,   leg_buff);
    SetBuff (debet, debet_buff);
    SetBuff (credit,credit_buff);

/*  // по запросу 63908
    if (swiftinstr!="")
        credit.CodeKind = PTCK_SWIFT;
        credit.BankCode = swiftinstr;
    else
        credit.CodeKind = PTCK_REUTER;
        credit.BankCode = freeinstr;
    end;
*/
    return true;
END;