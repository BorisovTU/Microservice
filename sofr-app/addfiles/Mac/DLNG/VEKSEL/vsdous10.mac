/**
 @file vsdous10.mac
 @brief Операция "Сопровождение Договоров об общих условиях". Шаг Открытие Договора об общих условиях.
  
  # tag
 - functional_block:Векселя
 - code_type:BP_Step
 - Векселя банка
 - ДОУС
 
  # changeLog
 |date       |author       |tasks                                                     |note                                                        
 |-----------|-------------|----------------------------------------------------------|-------------------------------------------------------------
 |09.01.2025 |Топорков Д.В.|BOSS-6579                                                 | Создание
 */
 
import InsCarryDoc, OprInter, globals;

macro ExecuteCaseStep(OperationKind, StepNumber, Document, DocKind)
  record dous(dl_genagr);
  
  SetBuff(dous, Document);

  var EndDate = IIF(dous.UnlimitedContract == "X", Date(dous.Start), Date(dous.Date_End));

  if (EndDate < {curdate})
    EndDate = {curdate};
  end;

  DefineOprDate(1, EndDate);

  return "15";
end;