/**
 @file vsi050bn.mac
 @brief Операция "Эмиссия собственного векселя". Шаг "Д.Формирование сертификатов векселей".
  vs - вексель
   i - операция эмиссии векселя (issue)
 050 - номер (соответствующий шагу)
  bn - сертификат (banner)
  
  # tag
 - functional_block:Векселя
 - code_type:BP_Step
 - Векселя банка
 
  # changeLog
 |date       |author         |tasks                                                     |note                                                        
 |-----------|---------------|----------------------------------------------------------|-------------------------------------------------------------
 |           |Велигжанин А.В.|                                                          | Создание
 |02.04.2025 |Топорков Д.В.  |BOSS-7972                                                 | Новая версия
 */
import "vsform.mac", vsdates;

/**
 @brief Выполнение шага
*/
macro ExecuteStep(Buffer, dl_order)
  var StepDate;

  record order( dl_order );
  SetBuff( order, dl_order );

  if (not VS_TestStepDate(DATE_EMI_DOC, @StepDate, order.SignDate))
    return 1;
  end;

  FillBnrForm(order);

  return 0;
end;

/**
 @brief Функция печати шага
*/
macro PrintStepDocs (ID_Operation,  // Номер экземпляра операции
                     ID_Step,       // Номер шага операции
                     Kind_Operation,// Вид операции
                     KindStep)      // Вид шага операции

  if (FillBnrFormByOperationID(ID_Operation) != 0)
    return 1;
  end;
  
  exit(1);
end;