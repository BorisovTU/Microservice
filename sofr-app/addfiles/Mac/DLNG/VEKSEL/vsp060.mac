/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : vsp060.mac
  Programmer  : Велигжанин А.В.
  Операция    : Погашение собственных векселей в другом филиале банка
  Шаг         : Завершение операции
└───────────────────────────────────────────────────────────────────────────*/
IMPORT vsdates, vsaccclose, dlclose;


/* Запуск шага
*/
MACRO ExecuteStep(Buffer, dl_order, DocKind, ID_Operation, ID_Step)
var
    StepDate, stat = 0;

    record order( dl_order );
    SetBuff( order, dl_order );

    if(not VS_TestStepDate(DATE_REP_DOC, @StepDate, order.SignDate))
       return 1;
    end;

    if  (not DL_TestAllSteps(ID_Operation, ID_Step))
       stat = Ошибка("Не все шаги операции выполнены.|Выполните все шаги операции.");
    elif(not ЗакрытьСчетаВекселя(order, StepDate)) 
       stat = 1;
    end;

    return stat;
END;

