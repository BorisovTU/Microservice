/**
 @file vsdoussc.mac
 @brief Макрос скроллинга договоров об общих условиях.
  
  # tag
 - functional_block:Векселя
 - code_type:
 - Векселя банка
 - ДОУС
 
  # changeLog
 |date       |author       |tasks                                                     |note                                                        
 |-----------|-------------|----------------------------------------------------------|-------------------------------------------------------------
 |09.01.2025 |Топорков Д.В.|BOSS-6579                                                 | Создание
 */

import BankInter;
import TSInter;
import "dlmisc.mac";
import "vsdousfunc.mac";

// Уже заполненные структуры, все изменения отразятся в базах
private var Документ         = TRecHandler( "dl_genagr" );
private var СтарыйДокумент   = TRecHandler( "dl_genagr" ); // заполняется при редактировании

/* Макрофункция инициализации нового актива 
   необходимо заполнить структуру "Документ"
   возвращаемое значение
   0 - ошибок не было
   1 - была ошибка
*/
private macro Новый_Документ()
    return 0;
end;

/* Макрофункция проверки операции при вводе, редактировании, удалении, выполнении
   возвращаемое значение
   0 - ошибок не было
   1 - была ошибка
*/
private macro Проверить_Документ( Режим:Integer )
    var err = 0;

    if( Режим == TS_DELETE ) //удаление
      if (Документ.rec.Status == GENAGR_STATUS_CLOSED)
        msgbox("Удаление закрытого ДОУС невозможно.");
        err = 1;
      end;
      
      if (DOUS_IsLinkedDealsExists(Документ.rec.GenAgrID, false))
        msgbox("Удаление невозможно! Есть привязанные сделки");
        err = 1;
      end;
    elif( Режим == TS_INSERT ) //вставка
    elif( Режим == TS_EDIT ) //редактирование
    elif( Режим == TS_EXECUTE ) //выполнение
    elif( Режим == TS_AFTER_DELETE) // после удаления
    end;

    return err;
end;

// Вызывается по CTRL+Z из скроллинга
private macro Функция_Пользователя()
    return 0;
end;
