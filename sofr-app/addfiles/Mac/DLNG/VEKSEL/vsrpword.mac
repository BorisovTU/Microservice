/*
$Name:         vsrpword.mac
$Module:       Векселя банка
$Description:  Печать распоряжений на списание ранее выкупленных/не предъявленных векселей
*/

import "vsrpord.mac";

private const VS_OPTYPE_WRITEOFF_INC_BNR = 11;

private var fmo = TBfile("vsfrmord");

private macro PrintReport(ContractID)
    fmo.rec.FrmOrdID = ContractID;

    if(fmo.GetEQ())
        VS_InitRepBanners();
        ВидДоговора = Д_СписаниеВык;

        [PNCWord.dot];  /*Шаблон*/
        println("PNCW" + fmo.rec.DocNumber + ".rtf");

        [~OperTypeName];
        if(fmo.rec.OperType != VS_OPTYPE_WRITEOFF_INC_BNR)
            println("выкупленных");
        else
            println("не предъявленных");
        end;

        [~Signed];
        println(DateStr(fmo.rec.Signed));

        [~BalanceAccount];
        if(fmo.rec.OperType != VS_OPTYPE_WRITEOFF_INC_BNR)
            println("90703");
        else
            println("52406");
        end;

        [~Executive];
        println(ИмяОператора({oper}));

        VS_VekselTag(fmo);

        DLWREPS_PrintReportFromTagFile(SetOutput(CreateFileName()));
        SetOutput(NULL, false);
    end;
end;
