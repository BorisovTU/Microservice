/** 
 @file ChodVekselRep.mac
 @brief Отчет для ЧОД
 
 # tag 
 - functional_block:Отчетность_Внутренняя
 - code_type:Report
 - Собственные векселя
   
 # changeLog 
 |date       |author         |tasks            |note                            
 |-----------|---------------|-----------------|--------------------------------
 |21.04.2025 |Топорков Д.В.  |BOSS-7878        | Создание
*/

import "ChodVekselRep_Form.mac";
import "IPS.mac";
import "StorageInfo.mac";

var settingsForm = ChodVekselRep_Form();

if (settingsForm.Run())
  var reportName = "Отчет по ЧОД с " + String(settingsForm.reportParams.beginDate:f) + " по " + String(settingsForm.reportParams.endDate:f) + ".xlsx";
  var result = IPSDFactoryRequest(GetFullTxtPath(not IsStandAlone()) + reportName,
                                  "IT_VekselRepChod.ReportRun",
                                  MakeArray(reportName, settingsForm.reportParams.beginDate, settingsForm.reportParams.endDate));
                                  
  if (result.errorCode != 0)
    MsgBox("Ошибка формирования отчета:\n" + result.errorDesc);
  elif (not StartShellProgram(result.data.fileName) == 0)
    MsgBox("Сформирован файл:\n" + result.data.fileName);
  end;
end;

Exit(1);