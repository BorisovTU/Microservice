/*
$Name:         vsprcexp_form.mac
$Module:       Векселя банка
$Description:  Отчет "Расходы в виде процентов при погашении" - форма ввода данных
*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_PRCEXP_MONTH      = 0, // месяц отчетного периода
    PNFLD_PRCEXP_YEAR       = 1, // год отчетного периода
    PNFLD_PRCEXP_CURCODE    = 2, // ISO код валюты
    PNFLD_PRCEXP_CURNAME    = 3, // название валюты
    PNFLD_PRCEXP_DEPARTCODE = 4, // код филиала
    PNFLD_PRCEXP_DEPARTMENT = 5; // название филиала

CLASS ( DL_CPanel ) VS_PrcExp_Panel()
    PRIVATE MACRO Init()
        VAR CurMonth, Year;
        DateSplit( {curdate}, null, CurMonth, Year );

        AddFieldProc( 0, PNFLD_PRCEXP_MONTH,      DL_PNFLD_MONTH,      @DL_FldProc_Month, CurMonth, 23, 9 );
        AddFieldProc( 0, PNFLD_PRCEXP_YEAR,       DL_PNFLD_YEAR,       @DL_FldProc_Year, Year );
        AddFieldProc( 0, PNFLD_PRCEXP_CURCODE,    DL_PNFLD_FI,         @DL_FldProc_FI, NATCUR, 1, 1 );
        AddFieldProc( 0, PNFLD_PRCEXP_CURNAME,    DL_PNFLD_FI_NAME,    @DL_FldProc_FI_Name, NATCUR, 1, 1 );
        AddFieldProc( 0, PNFLD_PRCEXP_DEPARTCODE, DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, {OperDprt}, 1, 1 );
        AddFieldProc( 0, PNFLD_PRCEXP_DEPARTMENT, DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, {OperDprt}, 1, 1 );
    END;

    PRIVATE MACRO Check():BOOL
        return true;
    END;

    initDL_CPanel( "vs_rep.lbr", "PRCEXP" ); 
END;
