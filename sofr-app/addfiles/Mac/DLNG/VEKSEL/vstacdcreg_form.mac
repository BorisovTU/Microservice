/*
$Name:         vstacdcreg_form.mac
$Module:       Векселя банка
$Description:  Отчет "Налоговый учет курсовых разниц в валюте" - форма ввода данных
*/

IMPORT "DlRepForm_h.mac";

// Номера полей в форме отчета
CONST
    PNFLD_TACDC_PERIOD     = 0, // месяц отчетного периода
    PNFLD_TACDC_YEAR       = 1, // год отчетного периода
    PNGLD_TACDC_INCPERIOD  = 2, //нарастающий период
    PNGLD_TACDC_BEGINDATE  = 3, //начало периода
    PNGLD_TACDC_ENDDATE    = 4, //конец периода
    PNFLD_TACDC_DEPARTCODE = 5, // код филиала     
    PNFLD_TACDC_DEPARTMENT = 6; // название филиала

CLASS ( DL_CPanel ) VS_TacdcReg_Panel()

    PRIVATE MACRO Init()
        VAR CurMonth, Year;
        DateSplit( {curdate}, null, CurMonth, Year );
        if(CurMonth == 1)
            CurMonth = 12;
        else
            CurMonth = CurMonth - 1;
        end;
        Year = Year - 1;
        var newDate = date(null, CurMonth, Year);
        AddFieldProc( 0, PNFLD_TACDC_PERIOD,     DL_PNFLD_PERIOD,     @DL_FldProc_Period,     CurMonth, 21, 8 );
        AddFieldProc( 0, PNFLD_TACDC_YEAR,       DL_PNFLD_YEAR,       @DL_FldProc_Year,       Year );
        AddFieldProc( 0, PNGLD_TACDC_INCPERIOD,  DL_PNFLD_GROWTH,     @DL_FldProc_Growth,     "X");
        AddFieldProc( 0, PNGLD_TACDC_BEGINDATE,  DL_PNFLD_BEGINDATE,  @DL_FldProc_BeginDate,  newDate);
        AddFieldProc( 0, PNGLD_TACDC_ENDDATE,    DL_PNFLD_ENDDATE,    @DL_FldProc_EndDate,    newDate);
        AddFieldProc( 0, PNFLD_TACDC_DEPARTCODE, DL_PNFLD_DEPARTCODE, @DL_FldProc_DepartCode, {OperDprt}, 1, 1 );
        AddFieldProc( 0, PNFLD_TACDC_DEPARTMENT, DL_PNFLD_DEPARTMENT, @DL_FldProc_Department, {OperDprt}, 1, 1 );
    END;

    PRIVATE MACRO Check():BOOL
        return true;
    END;

    initDL_CPanel( "vs_rep.lbr", "TACDC" );
END;
