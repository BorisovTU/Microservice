/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank 5.1                                          R-Style Software Lab
  File Name   : vscngst.mac
  Programmer  : ‚¥«¨£¦ ­¨­ €.‚.
  Comment     : ”ã­ªæ¨ï ¨§¬¥­¥­¨ï áâ âãá  ¯« â¥¦  (¨¬¯®àâ¨â OprInter, ª ª ¢¨¤¨â¥)
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
IMPORT OprInter, PaymInter;

MACRO VS_ChangeStat(pmobj, newstat, method, valueDate)
   var Ok = true;
   if((ValType(method) == V_INTEGER) AND (method != PMMET_ID))
      Ok = InsertPaymentStat(pmobj.PaymentID, newstat, method, null, null, null, null, valueDate);
   else
      pmobj.PaymStatus = newstat;
      if(ValType(valueDate) == V_DATE)
         pmobj.ValueDate = valueDate;
      end;
      if( newstat == PM_READY_TO_SEND ) 
         pmobj.IsFactPaym = "X"; // #70370
      end;
   end;
   return Ok;
END;