/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : vsb170cl.mac
                                vs-вексель
                                 b-операция мены векселей (barter)
                               170-номер (соответствующий шагу)
                                cl-выдача (output)
  Programmer  : Велигжанин А.В.
  Операция    : Мена векселей
  Шаг         : Закрытие договора.
  Comment     : Используется общий код для операций мены и эмиссии
                (см. vsclose)
└───────────────────────────────────────────────────────────────────────────*/
IMPORT vscateg, vsclose;


/* Запуск шага
*/
MACRO ExecuteStep(Buffer, dl_order, DocKind, ID_Operation, ID_Step)
var stat=0;

    record order( dl_order );
    SetBuff( order, dl_order );

    if(not DL_TestAllSteps(ID_Operation, ID_Step))
       msgbox("Нельзя закрыть договор:|в операции есть невыполненные шаги.");
       stat = 1;
    elif(not ПроверкаПриЗакрытии(order))
       stat=1;
    end;

    return stat;

END;


