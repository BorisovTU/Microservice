/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab
  File Name   : vsi010ac.mac
                                vs-вексель
                                 i-операция эмиссии векселя (issue)
                               015-номер (соответствующий шагу)
                                st-настройка
  Programmer  : Азаренок Ю.
  Операция    : Эмиссия собственного векселя
  Шаг         : С.Настройка способа оплаты векселей
  Дата        : 06/03/2002
└───────────────────────────────────────────────────────────────────────────*/
IMPORT OprInter, vsdates;

MACRO ExecuteCaseStep(OperationKind, StepNumber, Document, DocKind)
var StepDate, zero_date=date(0,0,0);

   record dl_order(dl_order);
   SetBuff( dl_order, Document );

   GetOprDate( DATE_EMI_PAY, @StepDate );

   if( StepDate > {curdate} )
      MsgBox ("Преждевременное выполнение шага запрещено.");
      return 1;
   end;

   if(dl_order.DateOfPayment == zero_date)
     return "20";   /* Оформление оплаты векселей */
   else
     return "40";   /* Подготовка к печати сертификатов векелей */
   end;

END;
