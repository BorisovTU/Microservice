/**
 @file vsdous20.mac
 @brief Операция "Сопровождение Договоров об общих условиях". Шаг Закрытие Договора об общих условиях.
  
  # tag
 - functional_block:Векселя
 - code_type:BP_Step
 - Векселя банка
 - ДОУС
 
  # changeLog
 |date       |author       |tasks                                                     |note                                                        
 |-----------|-------------|----------------------------------------------------------|-------------------------------------------------------------
 |09.01.2025 |Топорков Д.В.|BOSS-6579                                                 | Создание
 */
 
import "vsdousfunc.mac";

macro ExecuteStep(doc, FDoc, DocKind, ID_Operation, ID_Step)
  record dous(dl_genagr);
  SetBuff(dous, FDoc);
  
  if (DOUS_IsLinkedDealsExists(dous.GenAgrID, true))
    msgbox("Закрытие договора невозможно, привязаны незакрытые сделки.");
  end;
  
  return 0;
end;