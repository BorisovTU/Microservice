    
/*
**  Опердневник ф.24. Прочие операции
**
*/

import od_com, od_total, od_pay, od_ci, od_exch;

class ( TDataCollector ) TOperDC_Other( _oper, _brigadeMode )

  var
    otherTotals      = TSubTotals( _oper ), 
    otherTotalsU     = TSubTotals( _oper ), 
    otherOtherTotals = TSubTotals( _oper ),
    brigadeMode      = false;

  if( _brigadeMode != null )
    brigadeMode = _brigadeMode;
  end;

  macro proceed

    var 
      pay = TOperDC_Pay( oper, brigadeMode ), 
/*    trn = TOperDC_Trn( oper, true ), */
      cd  = TOperDC_Desk( oper ), 
      ci  = TOperDC_CI( oper ), 
      exch = TOperDC_ExchOther( oper ), 
/*    erp = TOperDC_ExchRegPay( oper ), */
      i, t;

    otherTotals.reset;
    otherTotalsU.reset;
    otherOtherTotals.reset;

    pay.proceed;
    otherTotals.add( pay.payTotals );
    otherOtherTotals.add( pay.payTotals );
/*                         
    trn.proceed;
    otherTotals.add( trn.trnTotals );
    otherOtherTotals.add( trn.trnTotals );
*/
    cd.proceed;
    otherTotals.add( cd.deskTotals );
    otherTotalsU.add( cd.deskTotalsU );
    otherOtherTotals.add( cd.deskTotals );
    otherOtherTotals.add( cd.deskTotalsU );

    if ( isCur == 0 )
      ci.proceed;
      i = 0;
      while ( i < ci.ciTypeSubTotals.size )
        t = ci.ciTypeSubTotals[i];
        if ( t != null ) 
          otherTotals.add( t );
        end;
        i = i + 1;
      end;
    end;
    ci.beforeDestructor(); /* SCR10801 */

    exch.proceed;
    otherTotals.add( exch.exchOtherTotals );
    otherTotalsU.add( exch.exchOtherTotalsU );
    otherOtherTotals.add( exch.exchOtherTotals );
    otherOtherTotals.add( exch.exchOtherTotalsU );

/*  RA 29-09-03 платы по ВОО обрабатываем наравне со всеми    
    if( brigadeMode ) /* RA 10-09-02 (SCR 9795) */
      erp.proceed;
      otherTotals.add( erp.exchPayTotals );
      otherOtherTotals.add( erp.exchPayTotals );
    end;
*/

    otherOtherTotals.write( ODSTO_OTHEROTHER_TOT );

    otherTotals.writeAsGlobal( ODSTT_TURNS_OTHER );
    updateGlobalTotals( otherTotals );

    otherTotalsU.writeAsGlobal( ODSTT_UNPAY_OFFS + ODSTT_TURNS_OTHER );
    updateGlobalTotalsU( otherTotalsU );

    otherTotals.add( otherTotalsU );
    otherTotals.write( ODSTO_OTHER_TOT );
  end;

  InitTDataCollector( _oper );
end;
