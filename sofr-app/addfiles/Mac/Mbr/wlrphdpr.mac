/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "МБР"                                        */
/*   Печать отчета о печати сообщений выписок/уведомлений                   */
/*                                                                          */
/*  Имя файла: wlrphdpr.mac                                                 */
/*  Создан:    04.10.02                                     Васюкова О.Е.   */
/****************************************************************************/
import PaymInter, "globals.mac", "wldoc.mac";

const Ошибка      = 0,
      Первый      = 1,
      Последний   = 2,
      Выписка     = 1,
      Уведомление = 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение)
  var str;

  SetBuff( wlhead, firstdoc );
  
  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповой печати сообщений выписок/уведомлений                      ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+---------+------+------------------------------------------------------------+];
    [|  Номер  |Номер |                 Сообщение                                  |];
    [|документа|ошибки|                                                            |];
    [+---------+------+------------------------------------------------------------+];
  elif( Вызов == Ошибка )
    if( Статус == 0 )
      if (wlhead.Kind==Выписка )
         Сообщение = "Печать сообщения выписки выполнена успешно";
      else
         Сообщение = "Печать сообщения уведомления выполнена успешно";
      end;
    end;    
    
    [|#########|######|############################################################|](wlhead.Number,Статус,StrSubst(Сообщение, "|", " " ):w);
  elif (Вызов==Последний)
    [+---------+------+------------------------------------------------------------+];
  end;
end;