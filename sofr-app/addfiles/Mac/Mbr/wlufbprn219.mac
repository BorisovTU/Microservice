
import  "wluftool.mac";


/* Функция печати заголовка формы */
macro PrintHeader( xml )

  [ ED219 Выходная форма ];
  [ ЭД ########## составлен ########## УИС ##########](ReadAttribute(xml,"EDNo"), ReadAttribute(xml,"EDDate"), ReadAttribute(xml,"EDAuthor"));

  return TRUE;

  OnError(er) /* Обработка ошибок времени выполнения */
    std.msg(String(er.Message, "|Модуль: ", er.Module, " Строка: ", er.Line));
    return FALSE;
  
end;

/* Функция печати форм */
macro PrintForm( addrMes )
  var xml:object = ActiveX( "MSXML.DOMDocument" );
  var Строка, Report = "";

  SetBuff( wlmes, addrMes );

  if( not СчитатьПоле( XMLField, Строка ) )
    return FALSE;
  end;

  if ( not xml.loadXML(Строка) )
     println( string( "Неверный формат сообщения" ) );
     return false;
  end;
  
  if( not PrintHeader( xml ) )
    return FALSE;
  end;

  // Последовательно считываем поля
  while( СчитатьПоле( UFBSRepConStrField, Строка) )
    Report = Report + Строка;
  end;

  println(Report);

  return TRUE;

  OnError(er) /* обработка ошибок времени выполнения */
    std.msg(String(er.Message, "|Модуль: ", er.Module, " Строка: ", er.Line));
    return FALSE;
end;
