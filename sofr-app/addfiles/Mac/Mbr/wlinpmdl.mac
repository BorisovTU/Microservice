/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*   Печать отчета сканирования удаления входящих платежей                  */
/*                                                                          */
/*  Имя файла: wlinpmdl.mac                                                 */
/*  Создан:    25.07.01                                     Алешин А.В.     */
/****************************************************************************/

import "wldoc.mac";

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов,firstdoc,Статус,Сообщение )
  var stat, Номер;

  
  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповом удалении ответных платежей                                ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+----------------+------+-----------------------------------------------------------------+];
    [|      Номер     |Номер |                      Сообщение                                  |];
    [|     платежа    |ошибки|                                                                 |];
    [+----------------+------+-----------------------------------------------------------------+];
  elif( Вызов == Ошибка )
    Номер = GetLastPaymentsNumber();
    if( Статус == 0 )
      Сообщение = "Откат формирования платежа по сообщению выполнен успешно";
    end;
    [|################|######|#################################################################|](Номер,Статус,StrSubst(Сообщение, "|", " " ):w);
  elif (Вызов==Последний)
    [+----------------------+------+-----------------------------------------------------------+];
  end;
end;
