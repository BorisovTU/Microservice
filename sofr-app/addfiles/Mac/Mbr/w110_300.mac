/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  квитовка (повторная)                                                    */
/*  Имя файла: w110_300.mac                                                 */
/*  Создан:  17.10.00                                         Бабин А.П.    */
/****************************************************************************/

import BankInter, OprInter, RMInter, "rmconst.mac", "wldoc.mac", "wlkvit.mac";

RECORD Corschem( corschem );

var PaymentObj:RsbPayment;

/**********************************/
/* Выполнение шага                */
/**********************************/
macro ExecuteCaseStep( Kind_Operation, Number_Step, first, KindDoc )  
   var stat, UnkvitSum = Moneyl(0), kvitSum = Moneyl(0), Cancel:string;

  /* Заполняем поля документа */
  if( Corschem.IsKvitOutPaym == "X" )

     if ( not ПолучитьСуммуКвитовки( PaymentObj, kvitSum, Cancel) )
        /* Ошибка создана */
        return 1;
     end;

     if ( Cancel==KVIT_CANCEL )
        MsgBox( "Нельзя квитовать с подтвердением отказом" );
        return 1;
     end;
  end;

  return 0 ;  
end;