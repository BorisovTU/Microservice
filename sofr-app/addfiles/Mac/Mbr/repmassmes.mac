/* -------------------------------------------------------------------- */
/*         Автоматизированная банковская система RS-Bank v6.0           */
/*                 Copyright (c) R-Style Software Lab                   */
/*                                                                      */
/*  Имя файла  : repmassmes.mac                                         */
/*                                                                      */
/*  Описание   : Печать отчета о массовых действиях с сообщениями       */
/*                                                                      */
/*  Программист: Чукина Т.А. .                                          */
/*                                                                      */
/*  Создан     : 18.01.2012                                             */
/*                                                                      */
/* -------------------------------------------------------------------- */
import wlglobal;

MACRO PrintReportHeader( ReportTitle )
  [                                                                                      ];
  [   #                                               ](ReportTitle);
  [   Дата обработки: ##########  ########                                               ](date:f, time);
  [   Операционист:   #####                                                              ]({oper});
  [                                                                                      ];
  [+----------------+------+------------------------------------------------------------------------------------------+];
  [|      Номер     |Номер |                                 Сообщение                                                |];
  [|    сообщения   |ошибки|                                                                                          |];
END;

MACRO PrintReportLine( MesID, ErrNum, MessageText )
  array StringArray;

  StrSplit( MessageText, StringArray, 90 );
  [+----------------+------+------------------------------------------------------------------------------------------+];
  [|################|######|##########################################################################################|]
  ( MesID, ErrNum, StrSubst(StringArray(0), "|", " "):l );

  var i = 1;
  while ( StrLen(StringArray(i) ) > 0)
  [|                |      |##########################################################################################|]
  ( StrSubst(StringArray(i), "|", " "):l );
    i = i + 1;
  end;

END;

MACRO PrintReportFooter()
  [+----------------+------+------------------------------------------------------------------------------------------+];
END;