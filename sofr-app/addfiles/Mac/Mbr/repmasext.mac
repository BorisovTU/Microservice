/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : repmasext.mac
  Created     : 11.05.2012
  Description : Отчет массового формирования выписок МБР
└───────────────────────────────────────────────────────────────────────────*/
                     
import wlglobal;

MACRO PrintReportHeader( FIName, DateIn, DateOut, TranspName, MesFrmName )
  [   Массовое формирование выписок                                      ];
  [   Валюта: #########################                                  ](FIName);
  [   С даты: ##########                                                 ](DateIn);
  [   По дату: ##########                                                ](DateOut);
  [   Транспорт: ###############                                         ](TranspName);
  [   Форма сообщения: ###############                                   ](MesFrmName);
  [                                                                                      ];
  [┌────────────────────┬─────┬────────────────────┬──────────────────────────────────────────────────┐];
  [│ Корсчет            │Релиз│Результат           │Ошибка                                            │];
  [├────────────────────┼─────┼────────────────────┼──────────────────────────────────────────────────┤];
END;

MACRO PrintReportLine( Account, RlsFormID, ErrNum, MessageText )
  var String;

  if( ErrNum == 0)
    String = "Сформирована";
    MessageText = "";
  else
    String = "Не сформирована";
  end;

  [│####################│#####│####################│##################################################│]
  ( Account, RlsFormID, String, MessageText );
  /*
  var i = 1;
  while ( StrLen(StringArray(i) ) > 0)
  [|                |      |##########################################################################################|]
  ( StrSubst(StringArray(i), "|", " "):l );
    i = i + 1;
  end;
    */
END;

MACRO PrintReportFooter()
  [└────────────────────┴─────┴────────────────────┴──────────────────────────────────────────────────┘];
END;