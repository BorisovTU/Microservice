/*
  $Name:         ufgd808_class.mac
  $Module:       Межбанковские расчеты
  $Description:  Классы для работы с полями ED808
*/

import "ufgendoc.mac", "xmlmestools.mac";
import "ic_getaccclient.mac";


private class TPartInfo
  var PartNo:          integer, /*Номер части*/
      PartQuantity:    integer, /*Количество частей*/
      PartAggregateID: string;  /*Уникальный идентификатор совокупности частей*/
 
  macro Construct()
    PartAggregateID = "";
    PartNo = PartQuantity = 0;
  end;

  Construct();
end;

private class TInitialED
  var EDNo:       integer,   /*Номер ЭС в течение опердня для исходного ЭСИС*/
      EDDate:     date,      /*Дата составления ЭС для исходного ЭСИС*/
      EDAuthor:   string;    /*Уникальный идентификатор составителя ЭС для исходного ЭСИС*/

  macro Construct()
    EDNo = 0;
    EDDate = date(0,0,0);
    EDAuthor = "";
  end;

  Construct();
end;

private class TRstr /*Структура ограничений участника*/
  var Rstr:     string, /*Код ограничения, наложенного на участника*/
      RstrDate: date;   /*Дата начала действия ограничения*/

  macro Construct()
    Rstr = "";
    RstrDate = date(0,0,0);
  end;

  Construct();
end;

private class TAccRstr /*Структура ограничений операций по счету*/
  var AccRstr:     string, /*Код ограничения операций по счету*/
      AccRstrDate: date;   /*Дата начала действия ограничения по счету*/

  macro Construct()
    AccRstr = "";
    AccRstrDate = date(0,0,0);
  end;

  Construct();
end;

private class TSWBIC /*БИК (СФИФТ), соответствующих участнику*/
  var SWBIC:        string, /*БИК (СВИФТ) (по справочнику СВИФТ, стандарт ИСО 9362)*/
      DefaultSWBIC: string; /*Признак использования БИК (СВИФТ) по умолчанию*/

  macro Construct()
    SWBIC = DefaultSWBIC = "";
  end;

  Construct();
end;

private class TAccount /*Информация о счете участника перевода денежных средств*/
  var Account:               string, /*Номер счета*/
      RegulationAccountType: string, /*Тип счета*/
      CK:                    string, /*Контрольный ключ*/
      AccountCBRBIC:         string, /*БИК ПБР, обслуживающего счет участника перевода*/
      DateIn:                date, /*Дата открытия счета*/
      DateOut:               date, /*Дата исключения информации о счете участника*/
      AccountStatus:         string, /*Статус счета*/
      AccRstrList:           TArray; /*Перечень ограничений операций по счету*/
      
  macro Construct()
    Account = RegulationAccountType = CK = AccountCBRBIC = AccountStatus = "";
    DateIn = DateOut = date(0,0,0);
    AccRstrList = TArray();
  end;

  Construct();
end;

class TDirectParticipantAccount /*БИК и счет прямого участника*/
  var BIC:     string, /*БИК прямого участника*/
      Account: string; /*Счет прямого участника*/

  macro Construct()
    Account = BIC = "";
  end;

  Construct();
end;

class TParticipantInfo /*Информация об участнике*/
  var NameP:                       string, /*Наименование участника*/
      EnglName:                     string, /*Наименование участника на английском языке*/
      RegN:                        string, /*Регистрационный порядковый номер*/
      CntrCd:                      string, /*Код страны*/
      Rgn:                         string, /*Код территории*/
      Ind:                         string, /*Индекс*/
      Tnp:                         string, /*Тип населенного пункта*/
      Nnp:                         string, /*Наименование населенного пункта*/
      Adr:                         string, /*Адрес*/
      PrntBIC:                     string, /*БИК головной организации*/
      DateIn:                      date,   /*Дата включения в состав участников перевода*/
      DateOut:                     date,   /*Дата исключения информации об участнике*/
      PtType:                      string, /*Тип участника перевода*/
      Srvcs:                       string, /*Доступные сервисы перевода денежных средств*/
      XchType:                     string, /*Участник обмена*/
      UID:                         string, /*УИС*/
      NPSParticipant:              string, /*Признак участия в ПС БР*/
      ToNPSDate:                   date,   /*Дата включения в список участников ПС БР*/
      ParticipantStatus:           string, /*Статус участника*/
      RstrList:                    TArray, /*Перечень ограничений участника*/
      DirectParticipantAccount:    variant;/*БИК и счет прямого участника*/
      
  macro Construct()
    NameP = EnglName = RegN = CntrCd = Rgn = Ind = Tnp = Nnp = Adr = PrntBIC = PtType = Srvcs = XchType = UID = NPSParticipant = ParticipantStatus = "";
    DateIn = DateOut = ToNPSDate = date(0,0,0);
    RstrList = TArray();
    DirectParticipantAccount = null;
  end;

  Construct();
end;

class TBICDirectoryEntry /*Запись в справочнике БИК*/
  var BIC:             string,  /*БИК участника*/
      ChangeType:      string,  /*Тип изменения*/
      ParticipantInfo: variant, /*Информация об участнике*/
      SWBICS:          TArray,  /*Перечень БИК (СФИФТ), соответствующих участнику*/
      Accounts:        TArray;  /*Информация о счетах участника перевода денежных средств*/
            
  macro Construct()
    BIC = ChangeType = "";
    ParticipantInfo = null;
    SWBICS = TArray();
    Accounts = TArray();
  end;

  Construct();
end;

class TCFBICList
  var CFBIC: TArray;
  
  macro Construct()
    CFBIC = TArray();
  end;
  
  Construct();
end;

class TUFCFInfo
  var UFBIC: string,
      CFBICList: variant;
end;

class TRestrictionBasisDoc
  var DocDate: date,
      DocNumber: string,
      Description: string;
  macro Construct()
    DocDate = date(0,0,0);
    DocNumber = Description = "";
  end;
  
  Construct();
end;

class TStopUrgentFTS
  var Applied: string,
      ApplyDate: string,
      RestrictionBasisDoc: variant;
  macro Construct()
    Applied = ApplyDate = "";
    RestrictionBasisDoc = null;
  end;
    Construct();  
end;

class (TStopUrgentFTS) TStopSendFTI
end;

class (TStopUrgentFTS) TStopSendRecvEM
end;

class (TStopUrgentFTS) TStopSendEM
end;

class (TStopUrgentFTS) TPendingDeletion
end;

class TIntradayRestrictions
  var StopUrgentFTS: variant,
      StopSendFTI: variant,
      StopSendRecvEM: variant,
      StopSendEM: variant,
      PendingDeletion: variant;
end;

class TParticipantAttributes
  var CanBeAuthorOfConfLiqRsrv: string,
      CanBeAuthorOfLiqRsrv: string,
      CanBeAuthorOfCover: string,
      CanSendDD: string,
      CanBeAuthorReqOfRsrv: string;
end;

class (TDirectParticipantAccount) TGarFundNumber
end;

class (TDirectParticipantAccount) TClearingAccount
end;

class TGarFunds
  var GarFundsUsage: string,
      GarFundNumber: variant,
      ClearingAccount: variant;
end;

class TClearingCircuits
  var ClearingCircuit: string,
      ClearingCircuitShortName: string,
      ClearingCircuitFullName: string,
      AllOrNothingSchema: string,
      DefaultSchema: string,
      ClaimLimitsAllowed: string,
      GarFunds: variant;
end;

class TEPSInfo
  var RCPAllowed: string,
      ClearingCircuits: TArray;
      
      macro Contruct()
        ClearingCircuits = TArray();
      end;
      
      Contruct();
end;

class (TDirectParticipantAccount) TAccountsList
end;

class TAccountsAuthorizedForDD
  var AccountsList: TArray;
  
  macro Construct()
    AccountsList = TArray();
  end;
  
  Construct();
end;
      

class TParticipantProfileInfo
  var PtType:                  string,
      ServCBRBIC:              string,
      DefaultARMNo:            string,
      ChannelMode:             string,
      UFCFInfo:                variant,
      IntradayRestrictions:    variant,
      ParticipantAttributes:   variant,
      EPSInfo:                 variant,
      AccountsAuthorizedForDD: variant;
end;

class (TStopUrgentFTS) TStopDebits
end;

class (TStopUrgentFTS) TStopCredits
end;

class (TStopUrgentFTS) TRouteToCBR
end;

class (TStopUrgentFTS) TManualVerifMode
end;

class (TStopUrgentFTS) TArrest
end;

class (TStopUrgentFTS) TSpecialMode
end;

class TAccIntradayRestrictions
  var StopDebits: variant,
      StopCredits: variant,
      StopUrgentFTS: variant,
      PendingDeletion: variant,
      RouteToCBR: variant,
      ManualVerifMode: variant,
      Arrest: variant,
      SpecialMode: variant;
end;

class TDestinationInfo
  var DestinationBIC: string,
      DestinationAccount: string;
end;

class TPendingDeletionInfo
  var AccountCloseDate: string,
      DestinationInfo: variant;
end;

class TEventTransfer
  var EventCode: string,
      EventNumber: string;
end;

class TDailyTransfer
  var TimeTransfer: string,
      EventTransfer: variant;
end;

class TBalanceSweepingAccount
  var BIC: string,
      Account: string,
      DailyTransfer: variant;      
end;

class (TDirectParticipantAccount) TSPInfo
end;

class (TDirectParticipantAccount) TMainPoolParticipant
end;

class TListOfSP
  var SPInfo: TArray;
  
  macro Construct()
    SPInfo = TArray();
  end;
  
  Construct();
end;

class TPoolSPInfo
  var ListOfSP: variant,
      MainPoolParticipant: variant;
end;

class TIPInfo
  var BIC: TArray;
  
  macro Construct()
    BIC = TArray();
  end;
  
  Construct();
end;

class TLimitInfo
  var LimitType: string,
      Value: string,
      Utilization: string,
      BIC: string,
      Account: string,
      UID: string,
      ClearingCircuit: string;
end;

class TAuthorizedClaimAuthorsList
  var ClearingCircuit: string,
      BIC: string,
      UID: string;
end;

class TAuthorizedClaimAuthors
  var AuthorizedClaimAuthorsList: TArray;
  
  macro Construct()
    AuthorizedClaimAuthorsList = TArray();
  end;
  
  Construct();
end;

class TArrestDetailedInfo
  var ArrestID: string,
      IndeterminateAmountFlag: string,
      ArrestAmount: string,
      OutstandingAmount: string,
      RestrictionBasisDoc: variant;
end;

class TArrestsInfo
  var ArrestDetailedInfo: TArray;
  
  macro Construct()
    ArrestDetailedInfo = TArray();
  end;
  
  Construct();
end;

class TLimitsInfo
  var LimitInfo: TArray;
  
  macro Construct()
    LimitInfo = TArray();
  end;
  
  Construct();
end;

class TAccountsInfo
  var Account: string,
      AccountType: string,
      DateOfDeletion: date,
      DefaultARMNo: string,
      AccIntradayRestrictions: variant,
      PendingDeletionInfo: variant,
      BalanceSweepingAccount: variant,
      PoolSPInfo: variant,
      IPInfo: variant,
      LimitsInfo: variant,
      AuthorizedClaimAuthors: variant,
      ArrestsInfo: variant;
end;

class TParticipantProfile
  var ParticipantProfileInfo: variant,
      AccountsInfo:           TArray;
      
  macro Construct()
    AccountsInfo = TArray();
  end;
  
  Construct;
end;

class TCreationReason
  var CreationReasonCode: TArray;
  
  macro Construct()
    CreationReasonCode = TArray();
  end;

  Construct();
  
end;
  

class TED808MessageFields /*Поля сообщения ED808*/
  var isXMLExists:        bool; /*Флаг наличия данных из прикрепленного XML-файла*/

  var EDNo:               integer,    /*Номер ЭПД в течение опердня*/
      EDDate:             date,       /*Дата составления ЭС*/
      EDAuthor:           string,     /*Уникальный идентификатор составителя ЭС*/
      EDReceiver:         string,     /*Уникальный идентификатор получателя ЭС*/
      CreationDateTime:   string,     /*Дата и время создания ЭС в формате YYYY-MM-DDThh:mm:ssZ*/
      InfoTypeCode:       string,     /*Вид представления информации*/
      ChangeNumber:       string,     /*Номер изменения в Профиле*/
      CreationReason:     variant,    /*Причины формирования Профиля участника (ED808)*/
      BICDirectoryEntry:  variant,    /*Запись в Справочнике БИК*/
      ParticipantProfile: variant,    /*Профиль участника*/
      InitialED:          variant;    /*Идентификаторы исходного ЭСИС*/

  macro Construct()
    isXMLExists = false;
    EDNo = 0;
    EDDate = date(0,0,0);
    EDAuthor = EDReceiver = InfoTypeCode = CreationDateTime = "";
    CreationReason = null;
    BICDirectoryEntry = null;
    ParticipantProfile = null;
    InitialED = null;
  end; 

  Construct();
end;

// Макрос чтения полей сообщения ED808
// Входные параметры: ED808MessageFields - структура полей сообщения ED808
macro ReadED808MessageFields( ED808MessageFields:@TED808MessageFields, xml ) : bool

  var fieldname = "", fieldvalue = "", blockname = "";
  var isNeedXMLParse : bool = false;
  var stat : bool = false;
  if( valtype(xml) != V_UNDEF )
    isNeedXMLParse = true;
  end;

  /*Считываем только то, что хранится в полях релиза*/
  while( СчитатьПоле(fieldname, fieldvalue, blockname) )
    if(blockname == "")
      if(fieldname == "EDNo")
        ED808MessageFields.EDNo = int( fieldvalue );
      elif(fieldname == "EDDate")
        ED808MessageFields.EDDate = ToDate( fieldvalue );
      elif(fieldname == "EDAuthor")
        ED808MessageFields.EDAuthor = fieldvalue;
      elif(fieldname == "EDReceiver")
        ED808MessageFields.EDReceiver = fieldvalue;
      elif(fieldname == "CreationDateTime")
        ED808MessageFields.CreationDateTime = fieldvalue;
      elif(fieldname == "InfoTypeCode")
        ED808MessageFields.InfoTypeCode = fieldvalue;
      elif(fieldname == "ChangeNumber")
        ED808MessageFields.ChangeNumber = fieldvalue;
      end;
    elif(blockname == "CreationReason")
      if(fieldname == beginField)
        ED808MessageFields.CreationReason = TCreationReason();
      end;
    elif(blockname == "CreationReason\\CreationReasonCode")
      if(fieldname == "CreationReasonCode")
        ED808MessageFields.CreationReason.CreationReasonCode[ED808MessageFields.CreationReason.CreationReasonCode.size] = fieldvalue;
      end;
    elif(blockname == "InitialED")
      if(fieldname == beginField)
        ED808MessageFields.InitialED = TInitialED();    
      elif(fieldname == "EDNo")
        ED808MessageFields.InitialED.EDNo = int( fieldvalue );
      elif(fieldname == "EDDate")
        ED808MessageFields.InitialED.EDDate = ToDate( fieldvalue );
      elif(fieldname == "EDAuthor")
        ED808MessageFields.InitialED.EDAuthor = fieldvalue;
      end;
    end; 
  end; // while ( СчитатьПоле(fieldname, fieldvalue, blockname) )

  /*Считываем данные прикрепленного XML-файла, если он есть*/
  if( isNeedXMLParse )
    var XmlAttrsElemsArray : TArray;
    stat = GetXMLElementsAndAttributesArray( xml, @XmlAttrsElemsArray, NodeED808 );
    if( stat )
      ED808MessageFields.isXMLExists = true;
      for( var XmlAttrElem, XmlAttrsElemsArray )
        if(XmlAttrElem.BlockName == "BICDirectoryEntry")
          if(XmlAttrElem.FieldName == beginField)
            
            ED808MessageFields.BICDirectoryEntry = TBICDirectoryEntry();
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.BICDirectoryEntry.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ChangeType")
            ED808MessageFields.BICDirectoryEntry.ChangeType = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\ParticipantInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo = TParticipantInfo();
          elif(XmlAttrElem.FieldName == "NameP")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.NameP = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "EnglName")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.EnglName = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "RegN")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RegN = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CntrCd")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.CntrCd = XmlAttrElem.FieldValue;                                  
          elif(XmlAttrElem.FieldName == "Rgn")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Rgn = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Ind")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Ind = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Tnp")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Tnp = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Nnp")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Nnp = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Adr")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Adr = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "PrntBIC")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.PrntBIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DateIn")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.DateIn = ToDate( XmlAttrElem.FieldValue );
          elif(XmlAttrElem.FieldName == "DateOut")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.DateOut = ToDate( XmlAttrElem.FieldValue );
          elif(XmlAttrElem.FieldName == "PtType")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.PtType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Srvcs")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.Srvcs = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "XchType")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.XchType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "UID")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.UID = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "NPSParticipant")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.NPSParticipant = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ToNPSDate")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.ToNPSDate = ToDate( XmlAttrElem.FieldValue );
          elif(XmlAttrElem.FieldName == "ParticipantStatus")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.ParticipantStatus = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\ParticipantInfo\\RstrList")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList[
              ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList.size] = TRstr();
          elif(XmlAttrElem.FieldName == "Rstr")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList[
              ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList.size - 1].Rstr = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "RstrDate")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList[
              ED808MessageFields.BICDirectoryEntry.ParticipantInfo.RstrList.size - 1].RstrDate = ToDate( XmlAttrElem.FieldValue );
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\ParticipantInfo\\DirectParticipantAccount")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount = TDirectParticipantAccount();
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount.Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\SWBICS")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.SWBICS[ED808MessageFields.BICDirectoryEntry.SWBICS.size] = TSWBIC();
          elif(XmlAttrElem.FieldName == "SWBIC")
            ED808MessageFields.BICDirectoryEntry.SWBICS[ED808MessageFields.BICDirectoryEntry.SWBICS.size - 1].SWBIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DefaultSWBIC")
            ED808MessageFields.BICDirectoryEntry.SWBICS[ED808MessageFields.BICDirectoryEntry.SWBICS.size - 1].DefaultSWBIC = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\Accounts")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size] = TAccount();
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].Account = XmlAttrElem.FieldValue;          
          elif(XmlAttrElem.FieldName == "RegulationAccountType")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].RegulationAccountType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CK")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].CK = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "AccountCBRBIC")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccountCBRBIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DateIn")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].DateIn = ToDate( XmlAttrElem.FieldValue );
          elif(XmlAttrElem.FieldName == "DateOut")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].DateOut = ToDate( XmlAttrElem.FieldValue );
          elif(XmlAttrElem.FieldName == "AccountStatus")
            ED808MessageFields.BICDirectoryEntry.Accounts[ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccountStatus = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "BICDirectoryEntry\\Accounts\\AccRstrList")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.BICDirectoryEntry.Accounts[
              ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList[
                ED808MessageFields.BICDirectoryEntry.Accounts[
                  ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList.size] = TAccRstr();
          elif(XmlAttrElem.FieldName == "AccRstr")
            ED808MessageFields.BICDirectoryEntry.Accounts[
              ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList[
                ED808MessageFields.BICDirectoryEntry.Accounts[
                  ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList.size - 1].AccRstr = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "AccRstrDate")
            ED808MessageFields.BICDirectoryEntry.Accounts[
              ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList[
                ED808MessageFields.BICDirectoryEntry.Accounts[
                  ED808MessageFields.BICDirectoryEntry.Accounts.size - 1].AccRstrList.size - 1].AccRstrDate = ToDate( XmlAttrElem.FieldValue );
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile = TParticipantProfile();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo = TParticipantProfileInfo();
          elif(XmlAttrElem.FieldName == "PtType")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.PtType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ServCBRBIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ServCBRBIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DefaultARMNo")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.DefaultARMNo = XmlAttrElem.FieldValue
          elif(XmlAttrElem.FieldName == "ChannelMode")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ChannelMode = XmlAttrElem.FieldValue
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\UFCFInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo = TUFCFInfo();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\UFCFInfo\\UFBIC")
          if(XmlAttrElem.FieldName == "UFBIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.UFBIC = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\UFCFInfo\\CFBICList")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList = TCFBICList();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\UFCFInfo\\CFBICList\\CFBIC")
          if(XmlAttrElem.FieldName == "CFBIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC.size] = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions = TIntradayRestrictions();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopUrgentFTS")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS = TStopUrgentFTS();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.Applydate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopUrgentFTS\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendFTI")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI = TStopSendFTI();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.Applydate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendFTI\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendRecvEM")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM = TStopSendRecvEM();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.Applydate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendRecvEM\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;  
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendEM")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM = TStopSendEM();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.Applydate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\StopSendEM\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end; 
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\PendingDeletion")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion = TPendingDeletion();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.Applydate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\IntradayRestrictions\\PendingDeletion\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end; 
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\ParticipantAttributes")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes = TParticipantAttributes();
          elif(XmlAttrElem.FieldName == "CanBeAuthorOfConfLiqRsrv")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfConfLiqRsrv = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CanBeAuthorOfLiqRsrv")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfLiqRsrv = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CanBeAuthorOfCover")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfCover = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CanSendDD")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanSendDD = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "CanBeAuthorReqOfRsrv")
            ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorReqOfRsrv = XmlAttrElem.FieldValue;  
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo")
          if(XmlAttrElem.FieldName == beginField)
            
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo = TEPSInfo();
          elif(XmlAttrElem.FieldName == "RCPAllowed")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.RCPAllowed = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size] = TClearingCircuits();
          elif(XmlAttrElem.FieldName == "ClearingCircuit")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].ClearingCircuit = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ClearingCircuitShortName")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].ClearingCircuitShortName = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ClearingCircuitFullName")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].ClearingCircuitFullName = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "AllOrNothingSchema")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].AllOrNothingSchema = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DefaultSchema")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].DefaultSchema = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ClaimLimitsAllowed")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].ClaimLimitsAllowed = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits\\GarFunds")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds = TGarFunds();
          elif(XmlAttrElem.FieldName == "GarFundsUsage")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.GarFundsUsage = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits\\GarFunds\\GarFundNumber")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.GarFundNumber = TGarFundNumber();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits\\GarFunds\\GarFundNumber\\BIC")
          if(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.GarFundNumber.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.GarFundNumber.Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits\\GarFunds\\ClearingAccount")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.ClearingAccount = TGarFundNumber();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\EPSInfo\\ClearingCircuits\\GarFunds\\ClearingAccount\\BIC")
          if(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.ClearingAccount.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.EPSInfo.ClearingCircuits.size - 1].GarFunds.ClearingAccount.Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\AccountsAuthorizedForDD")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD = TAccountsAuthorizedForDD();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\ParticipantProfileInfo\\AccountsAuthorizedForDD\\AccountsList")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList.size] = TAccountsList();
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList.size - 1].BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[
              ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList.size - 1].Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size] = TAccountsInfo();
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].Account = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "AccountType")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccountType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DateOfDeletion")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].DateOfDeletion = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DefaultARMNo")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].DefaultARMNo = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions = TAccIntradayRestrictions();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopDebits")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits = TStopDebits();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopDebits\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopDebits.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopCredits")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits = TStopCredits();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopCredits\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopCredits.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopUrgentFTS")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS = TStopUrgentFTS();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\StopUrgentFTS\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.StopUrgentFTS.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\PendingDeletion")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion = TPendingDeletion();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\PendingDeletion\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.PendingDeletion.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\RouteToCBR")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR = TRouteToCBR();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\RouteToCBR\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.RouteToCBR.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\ManualVerifMode")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode = TManualVerifMode();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\ManualVerifMode\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.ManualVerifMode.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\Arrest")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest = TArrest();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\Arrest\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.Arrest.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\SpecialMode")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode = TSpecialMode();
          elif(XmlAttrElem.FieldName == "Applied")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.Applied = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ApplyDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.ApplyDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AccIntradayRestrictions\\SpecialMode\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AccIntradayRestrictions.SpecialMode.RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PendingDeletionInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PendingDeletionInfo = TPendingDeletionInfo();
          elif(XmlAttrElem.FieldName == "AccountCloseDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PendingDeletionInfo.AccountCloseDate = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PendingDeletionInfo\\DestinationInfo")
          if(XmlAttrElem.Fieldname == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PendingDeletionInfo.DestinationInfo = TDestinationInfo();
          elif(XmlAttrElem.FieldName == "DestinationBIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PendingDeletionInfo.DestinationInfo.DestinationBIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "DestinationAccount")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PendingDeletionInfo.DestinationInfo.DestinationAccount = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\BalanceSweepingAccount")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount = TBalanceSweepingAccount();
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\BalanceSweepingAccount\\DailyTransfer")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.DailyTransfer = TDailyTransfer();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\BalanceSweepingAccount\\DailyTransfer\\TimeTransfer")
          if(XmlAttrElem.FieldName == "TimeTransfer")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.DailyTransfer.TimeTransfer = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\BalanceSweepingAccount\\DailyTransfer\\EventTransfer")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.DailyTransfer.EventTransfer = TEventTransfer();
          elif(XmlAttrElem.FieldName == "EventCode")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.DailyTransfer.EventTransfer.EventCode = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "EventNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].BalanceSweepingAccount.DailyTransfer.EventTransfer.EventNumber = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PoolSPInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo = TPoolSpInfo();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PoolSPInfo\\ListOfSP")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP = TListOfSP();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PoolSPInfo\\ListOfSP\\SPInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo.size] = TSPInfo();
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo.size - 1].BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.ListOfSP.SPInfo.size - 1].Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\PoolSPInfo\\MainPoolParticipant")  
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.MainPoolParticipant = TMainPoolParticipant();
          elif(XmlAttrElem.FieldName == "BIC");
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.MainPoolParticipant.BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account");
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].PoolSPInfo.MainPoolParticipant.Account = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\IPInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].IPInfo = TIPInfo();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\IPInfo\\BIC")
          if(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].IPInfo.BIC[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].IPInfo.BIC.size] = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\LimitsInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo = TLimitsInfo();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\LimitsInfo\\LimitInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size] = TLimitInfo();
          elif(XmlAttrElem.FieldName == "LimitType")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].LimitType = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Value")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].Value = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Utilization")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].Utilization = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].BIC = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Account")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].Account = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "UID")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].UID = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ClearingCircuit")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].LimitsInfo.LimitInfo.size - 1].ClearingCircuit = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AuthorizedClaimAuthors")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors = TAuthorizedClaimAuthors();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AuthorizedClaimAuthors\\AuthorizedClaimAuthorsList")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList.size] = TAuthorizedClaimAuthorsList();
          elif(XmlAttrElem.FieldName == "ClearingCircuit")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList.size - 1].ClearingCircuit = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AuthorizedClaimAuthors\\AuthorizedClaimAuthorsList\\BIC")
          if(XmlAttrElem.FieldName == "BIC")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList.size - 1].BIC = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\AuthorizedClaimAuthors\\AuthorizedClaimAuthorsList\\UID")
          if(XmlAttrElem.FieldName == "UID")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].AuthorizedClaimAuthors.AuthorizedClaimAuthorsList.size - 1].UID = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\ArrestsInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo = TArrestsInfo();
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\ArrestsInfo\\ArrestDetailedInfo")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size] = TArrestDetailedInfo();
          elif(XmlAttrElem.FieldName == "ArrestID")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].ArrestID = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "IndeterminateAmountFlag")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].IndeterminateAmountFlag = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "ArrestAmount")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].ArrestAmount = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "OutstandingAmount")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].OutstandingAmount = XmlAttrElem.FieldValue;
          end;
        elif(XmlAttrElem.BlockName == "ParticipantProfile\\AccountsInfo\\ArrestsInfo\\ArrestDetailedInfo\\RestrictionBasisDoc")
          if(XmlAttrElem.FieldName == beginField)
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].RestrictionBasisDoc = TRestrictionBasisDoc();
          elif(XmlAttrElem.FieldName == "DocDate")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].RestrictionBasisDoc.DocDate = ToDate(XmlAttrElem.FieldValue);
          elif(XmlAttrElem.FieldName == "DocNumber")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].RestrictionBasisDoc.DocNumber = XmlAttrElem.FieldValue;
          elif(XmlAttrElem.FieldName == "Description")
            ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo[
              ED808MessageFields.ParticipantProfile.AccountsInfo[ED808MessageFields.ParticipantProfile.AccountsInfo.size - 1].ArrestsInfo.ArrestDetailedInfo.size - 1].RestrictionBasisDoc.Description = XmlAttrElem.FieldValue;
          end;         
        end;
      end;
    else
      isNeedXMLParse = false;
    end;
  end;

  return TRUE;
end;

macro CheckObjectElem( obj : variant, path : string )

  var SplitPath = Splitter( path, ".");
  
  var CurrentElem = obj;
  var CurrentName = SplitPath.Next();
  
  while( (CurrentName != "") and (ValType(CurrentElem) != V_UNDEF) )
    if(IsEqClass("TArray", CurrentElem))
      CurrentElem = CurrentElem[0];
      continue;
    end;
    if( GenGetProp(CurrentElem, CurrentName) != V_UNDEF )
      CurrentElem = GenGetProp(CurrentElem, CurrentName);
      CurrentName = SplitPath.Next();
    else
      return false;
    end;
  end;
  
  if(ValType(CurrentElem) != V_UNDEF)
    return true;    
  else
    return false;
  end;
end;







