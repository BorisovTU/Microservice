/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Проверка сквитованности платежа                                         */
/*                                                                          */
/*  Имя файла: w110_210.mac                                                 */
/*  Создан:  17.05.00                                        Алешин А.В.    */
/****************************************************************************/
import InsCarryDoc, BankInter, OprInter, RMInter, "rmconst.mac", "wlglobal.mac", "cbsttls.mac";;

RECORD Corschem( corschem );

var PaymentObj:RsbPayment;

const DEBET  = "Д",
      KREDIT = "К";


/**********************************/
/* Выполнение шага                */
/**********************************/
macro ExecuteCaseStep( Kind_Operation, Number_Step, first, KindDoc )
  var stat, KvitType, Cancel, menu_item;

  if( (Corschem.IsKvitOutPaym != "X") or (GetOprStatus(OPR_PAYM_OUT_KVIT) != OPR_PM_ST_UNKVIT) )
     if ( УстановитьСтатусыПлатежа(OPR_PAYM_STATE, OPR_PM_ST_CLOSE) )
        MsgBox("Возникла ошибка при смене статусов операции платежа");
        return 1;
     end;
     PaymentObj.PropStatus = PM_PROP_CLOSED;
     PaymentObj.Paymstatus = PM_FINISHED;
     return "";
  else
     return string(НомерШагаКвитовкаСВыпиской);  /* Несквитованный */
  end;
end;
