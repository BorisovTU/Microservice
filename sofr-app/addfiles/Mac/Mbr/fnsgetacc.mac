/*
  $Name:         fnsgetacc.mac
  $Module:       МБР
  $Description:  Функция для записи счетов из связанного сообщения в объект ФНС
*/

//-----------------------------------------------------------------------------
//          Автоматизированная банковская система RS-Bank               
//                 Copyright (c) R-Style Software Lab
//
// Подсистема   : Межбанковские расчеты
//
// Описание     : Функция для записи счетов из связанного сообщения в объект ФНС
//
// Программист  : Евграфова Л.Н.
//
// Создан       : 27.08.2018
//
//-----------------------------------------------------------------------------
import "fnsRegDecAl_RP.mac", "fnsznsalx.mac";


/*
ObjectID, ObjectType - объект, для которого сохраняются счета
LnkObjectID, LnkObjectType - объект, из сообщения которого считываются счета
*/
macro GetAccFromMes(ObjectID, ObjectType, LnkObjectID, LnkObjectType) : integer
  var stat : integer = 0;

  if (LnkObjectType == OBJTYPE_DECISION) 
     var RegDecision:TRegDecision_RP;
     RegDecision.ReadFields();
     if (not RegDecision.InsertLnkAccList(ObjectID, ObjectType))
        msgbox("Ошибка при вставке связанных счетов");
        return 1362;
     end;

  end;

  if (LnkObjectType == OBJTYPE_REQ) 
     var ReqMes = FnsMessageFormZSN();
     InsertReqLnkAccList(ObjectID, ReqMes, ObjectType);
  end;

  return stat;

  OnError(er) /* обработка ошибок времени выполнения */
    return 1362;
end;
