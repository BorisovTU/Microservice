/*
  $Name:         wlcrdsht.mac
  $Module:       МБР
  $Description:  Формирование штафеля к внебалансовому счету N 90903
*/

/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Формирование штафеля к внебалансовому счету N 90903                     */
/*  Имя файла: wlcrdsht.mac                                                 */
/*  Создан:  27.10.00                                         Бабин А.П.    */
/****************************************************************************/
import "globals.mac";

var SumIncome=0, SumCharge=0;

macro PrintHead( DateBegin, DateEnd, CardDaysStart, Balance )
[
Наименование кредитной организации: #

                                  ШТАФЕЛЬ
                      К ВНЕБАЛАНСОВОМУ СЧЕТУ N 90903
                   ЗА ПЕРИОД с ########## ПО ##########

                                      Количество непрерывных календарных дней,
                                  в течение которых к корреспондентскому счету
                                      (субсчету) кредитной организации имелась
                                       картотека к счету N 90903, по состоянию
                                              на начало отчетного периода ###.

                                                                    (в рублях)
------------------------------------------------------------------------------
|   Дата   |       Приход        |       Расход        |       Остаток       |
|----------|---------------------|---------------------|---------------------|
|    1     |          2          |          3          |          4          |
|----------|---------------------|---------------------|---------------------|
|Остаток на|                     |                     |                     |
|начало от-|                     |                     |                     |
|четного пе|                     |                     |                     |
|риода     |          X          |          X          |#####################|
|----------|---------------------|---------------------|---------------------|]
( {Name_Bank}, DateBegin:f, DateEnd:f, CardDaysStart, Balance:18:2 );
  return TRUE;
end; 


macro PrintNode( Date, Income, Charge, Balance )
   [|##########|#####################|#####################|#####################|]
   (date:f, Income, Charge, Balance);
   [|----------|---------------------|---------------------|---------------------|];
   SumIncome = SumIncome + Income;
   SumCharge = SumCharge + Charge;
   return TRUE;
end;

macro PrintFloor( CardDaysEnd, Balance )

[|Остаток на|                     |                     |                     |
|конец  от-|                     |                     |                     |
|четного пе|                     |                     |                     |
|риода     |          X          |          X          |#####################|
|----------|---------------------|---------------------|---------------------|
|Итого при-|                     |                     |                     |
|ход,  рас-|                     |                     |                     |
|ход за от-|                     |                     |                     |
|четный  пе|                     |                     |                     |
|риод      |#####################|#####################|          X          |
------------------------------------------------------------------------------

Количество непрерывных календарных дней,
в течение которых к корреспондентскому счету
(субсчету) кредитной организации имелась
картотека к счету N 90903, по состоянию
на конец отчетного периода ###.

Ответственный исполнитель (фамилия, подпись)

          #](balance, SumIncome, SumCharge,CardDaysEnd, {Name_Oper});
   return TRUE;
end;