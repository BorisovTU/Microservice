/*
  $Name: wlcsuserfunc.mac
  $Module: МБР
  $Description: Отчёт по результатам групповой обработки схемы расчётов
*/

import PTInter, FIInter;

private const   Ошибка   = 0,
                Первый   = 1,
                Последний= 2;
                
RECORD cor(corschem);

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  if( Вызов==Первый )
[            Отчет о групповом исполнении функции пользователя.                 ];
[┌─────────┬────────┬──────────┬────────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │  Фин.  │ Вид фин. │ Номер  │                        Сообщение                           │];
[│  схемы  │ инстр. │  инстр.  │ ошибки │                                                            │];
[├─────────┼────────┼──────────┼────────┼────────────────────────────────────────────────────────────┤];
  elif ( Вызов == Ошибка )
    setbuff(cor, firstdoc);
    if(Статус == 0)
      Сообщение = "Функция исполнена успешно";
    end;

[│#########│########│##########│########│############################################################│]
( cor.Number:c , ПолучитьКодФинИн(cor.FIID):c , cor.FI_Kind:c , Статус:c , StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└─────────┴────────┴──────────┴────────┴────────────────────────────────────────────────────────────┘];
  end;
END;