/*
  $Name:         gginfpmsendmsrp.mac
  $Module:       Межбанковские расчеты
  $Description:  Протокол групповой обработки запросов по сообщениям в ГИС ГМП через RS-Connect
*/

//-----------------------------------------------------------------------------
//          Автоматизированная банковская система RS-Bank               
//                 Copyright (c) R-Style Software Lab
//
// Подсистема   : Межбанковские расчеты
//
// Описание     : Протокол групповой обработки запросов по сообщениям в ГИС ГМП через RS-Connect
//
// Программист  : Kolyakin V.V.
//
// Создан       : 30.08.2018
//
//-----------------------------------------------------------------------------

import globals, oralib, likepy, WldInter, MesInter, wlglobal, CTInter;

const Ошибка      = 0,
      Первый      = 1,
      Последний   = 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение)

  setbuff (wlpmsend, firstdoc);

  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповой обработке запросов в RS-Connect для ГИС ГМП               ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+---------+------+------------------------------------------------------------+];
    [|  Номер  |Номер |                 Сообщение                                  |];
    [|документа|ошибки|                                                            |];
    [+---------+------+------------------------------------------------------------+];
  elif( Вызов == Ошибка )
   if( Статус == 0 )
     Сообщение = "Обработка запроса выполнена успешно";
   end;
    [|#########|######|############################################################|](wlpmsend.ID,Статус,StrSubst(Сообщение, "|", " " ):w);
  elif (Вызов==Последний)
    [+---------+------+------------------------------------------------------------+];
  end;
end;