/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6.0                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/* Генерация сообщения ED999 транспорта УФЭБС                               */
/*                                                                          */
/*  Имя файла: ufgm999.mac                                                  */
/*  Создан:    05.03.09                                                     */
/****************************************************************************/

import OprInter, BankInter, "ufgenmes.mac", "wluftool.mac", "wlfindpm.mac";

macro GenMes( addrMes, addrReq )
  
  SetBuff( wlmes,  addrMes );
  SetBuff( wlReq,  addrReq );

  var strXml;
  var xml:object = ActiveX("Microsoft.XMLDOM");  
  var mes:object, elem: object;
  var iXml:object = ActiveX("Microsoft.XMLDOM");  

  mes = xml.createElement("ED999");  
  mes.setAttribute("xmlns", "urn:cbr-ru:ed:v2.0");

  var ed_nda = NULL;
  ed_nda = EDNoDateAuthor();
  ed_nda.ConstructByTrn(wlmes.TRN);

  mes.setAttribute("EDNo",       ed_nda.EDNo );
  mes.setAttribute("EDDate",     YYYYMMDD(ed_nda.EDDate));
  mes.setAttribute("EDAuthor",   ed_nda.EDAuthor );  


  ЗаписатьПолеЛог( "xml", mes.xml, TRUE );
  
  return TRUE;
end;
