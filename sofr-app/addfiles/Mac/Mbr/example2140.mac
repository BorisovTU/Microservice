import globals;

/*  Используется в модуле 2140                                               */
macro CreateSelect( RespCode:string , TpID:integer ):string
 var sql:string;
 TpID = 14; //OFK

 /* Основной запрос */
sql = " SELECT DISTINCT wlmes.t_MesID , wlmes.t_RlsFormID , wlmes.t_Kind , wlmes.t_TRN " + 
       " FROM   dwlmes_dbt wlmes , dwltpshem_dbt wltpshem " + 
       " WHERE  wlmes.t_Direct = 'X' " +
       " AND    wlmes.t_State  = 50  " //WLD_STATUS_MES_RECEIV - принято
       " AND    wlmes.t_Kind   = 15  "; // GIS GMP

 if(TpID > 0)
   sql = sql + " AND wlmes.t_TpSchemID = wltpshem.t_TpShemID " + 
        string(" AND wltpshem.t_TpID = ", TpID);
 end;
 
 /* Вернем созданный запрос  */
 return sql;
end;
