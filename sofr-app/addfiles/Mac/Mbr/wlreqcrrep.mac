/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                                            R-Style Software Lab

  File Name   : wlreqcrrep.mac
  Created     : 28.04.2014
  Programmer  : ‹ § à¥­ª® Œ.
  Description : ¥ç âì ®âç¥â  ® ¬ áá®¢®¬ ä®à¬¨à®¢ ­¨¨ § ¯à®á®¢ ­  ¢ë¯¨áªã

ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
import globals, likepy, oralib, WldInter, PaymInter, OprInter;

const   è¨¡ª    = 0,
        ¥à¢ë©   = 1,
        ®á«¥¤­¨©= 2;

MACRO ¥ç âì_âç¥â‘ª ­¨à®¢ ­¨ï (‚ë§®¢,firstdoc,‘â âãá,‘®®¡é¥­¨¥)
   record corschem (corschem);
   setbuff (corschem, firstdoc);
    if (‚ë§®¢==¥à¢ë©)
[
    ª¥â­®¥ ä®à¬¨à®¢ ­¨¥ § ¯à®á®¢ ­  ¢ë¯¨áªã
   ¯¥à æ¨®­­ë© ¤¥­ì:  ##########                                                                    ]
( {curdate} );

[ 
        ‘å¥¬  à áç¥â®¢                      ¥§ã«ìâ â ¢ë¯®«­¥­¨ï
   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ ]; 
    elif (‚ë§®¢==è¨¡ª )
      if (‘â âãá == 0)
         ‘®®¡é¥­¨¥ = "‡ ¯à®á áä®à¬¨à®¢ ­"
      end;
      var query :string = " select  fi.t_FI_Code     "
                          " from dfininstr_dbt fi    "
                          " where fi.t_FIID = :FIID ";

      var params:TArray = makeArray( SQLParam( "FIID", corschem.FIID ) );
      var rs:RsdRecordset = execSQLselect( query, params );
      if( rs.moveNext() )
  
        [  #### ### ############################### ################################################## ]
        ( corschem.Number,
          rs.Value(0),
          corschem.Name, 
          StrSubst(‘®®¡é¥­¨¥, " ", " " ):w );
      end;
  end;
END;
 /*
macro ReqCrReportPrintStr( Number:integer, Result:string )

  var query :string = " select cor.t_Name, fi.t_FI_Code  "
                      " from dcorschem_dbt cor,          "
                      "   dfininstr_dbt fi               "
                      " where cor.t_Number = :Number     "
                      "      and fi.t_FIID = cor.t_FIID  ";

  array StringArray;
  var params:TArray = makeArray( SQLParam( "Number", Number ) );
  var j = 0;
  var rs:RsdRecordset = execSQLselect( query, params );
  if( rs.moveNext() )
    StrSplit( StrSubst(IfThenElse(Result!="",Result," ") , "|", " " ), StringArray, 50 );

[  #### ### ############################### ################################################## ]
( Number,
  rs.Value(2),
  rs.Value(1), 
  StringArray(0) );
  
  j = 1;
    while ( StrLen(StringArray(j) ) > 0)
[                                           ################################################## ]
(StringArray(j));
    j = j + 1;
    end;
  end;
end;                      
 */