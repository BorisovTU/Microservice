/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Печать отчета сканирования подтверждений МБК                            */
/*                                                                          */
/*  Имя файла: wldlmmun.mac                                                 */
/*  Создан:    16.07.01                                    Алешин А.В.      */
/****************************************************************************/

import "wldoc.mac";

const Ошибка   = 0,
      Первый   = 1,
      Последний= 2;

macro Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )
  var stat, Номер;

  setbuff (wldlmm, firstdoc);

  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповом откате шага начальных подтверждений МБК                   ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+----------------+------+-------------------------------------------------------+];
    [| Общий референс |Номер |                 Сообщение                             |];
    [|     сделки     |ошибки|                                                       |];
    [+----------------+------+-------------------------------------------------------+];
  elif( Вызов == Ошибка )
    if( Статус == 0 )
      Сообщение = "Откат успешно выполнен";
    end;    
    [|################|######|#######################################################|](wldlmm.DealCodePS,Статус,StrSubst(Сообщение, "|", " " ):w);
  elif (Вызов==Последний)
    [+----------------+------+-------------------------------------------------------+];
  end;
end;