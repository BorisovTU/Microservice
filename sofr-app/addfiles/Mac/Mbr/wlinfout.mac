/*
 $Name:        wlinfout.mac
 $Module:      Межбанковские расчеты
 $Description: Макрофункции для работы с информационными сообщениями (исходящие)
*/

/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank v6.0                     */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Макрофункции для работы с информационными сообщениями (исходящие)       */
/*                                                                          */
/*  Имя файла: wlinfout.mac                                                 */
/*  Создан:  11.02.2004                                       Панов А.Б.    */
/****************************************************************************/

import "wlinfogt.mac";

macro Функция_Пользователя()
  return 0;
end;
    /*В случае неудачи возвращает пустую строку*/
macro Текст_Запроса_По_Сверке_Счетов( 
CorsArr:TARRAY, FIIDArr:TARRAY, ReportDate:DATE, FirstSignID:INTEGER, 
SecondSignID:INTEGER, ExecutorID:INTEGER )

    Var RetStr = "", i = 0, str;

    /*Шапка*/
    RetStr = ПолучитьШапку( CorsArr(0), FIIDArr(0), ReportDate, 1, CorsArr.Size );
    if(not RetStr)
       return RetStr;
    end;
    while(i < CorsArr.Size)
        if(FIIDArr(i) == NATCUR)
            str = БлокА(CorsArr(i), ReportDate);
        else
            str = БлокБ(CorsArr(i), FIIDArr(i), ReportDate);
        end;
        if(str)
           RetStr = RetStr + Str;
        else
           return ""
        end;
        i = i + 1;
    end;
    str = Подписи(FirstSignID, SecondSignID, ExecutorID);
    if (not str)
       return "";
    end;
    RetStr = RetStr + "Подтверждение просим направить в письменной форме за подписью главного бухгалтера или\n" 
             + "начальника отдела коротношений, заверенной печатью бланка, либо ключеванным сообщением\n"
             + "по электронным каналам связи.\n"
             + str;
    return RetStr;
end;