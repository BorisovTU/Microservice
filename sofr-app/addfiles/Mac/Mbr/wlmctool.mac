/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/* Общие константы и вспомогательные функции для работы с МЦИ               */
/*                                                                          */
/*  Имя файла: wlmctool.mac                                                 */
/*  Создан:  15.08.00                                              AVM      */
/****************************************************************************/

import globals, "wltools.mac";

/* Названия полей форм МЦИ */
const FormFldDoc = "Doc";
const FormFldDsc = "Dsc";
const FormFldE57 = "E57";
const FormFldDel = "Del";
const FormFldDocExt = "DocExt";
const FormFldHeadExt = "HeadExt";

/* чтение даты из строки */
macro СчитатьДату(Строка, Позиция)
  var День, Месяц, Год;

  День  = int( substr( Строка, Позиция,   2 ) );
  Месяц = int( substr( Строка, Позиция+2, 2 ) );
  Год   = int( substr( Строка, Позиция+4, 4 ) );

  return date( День, Месяц, Год );
end;

macro СчитатьВремя(Строка, Позиция)
  var ЧЧ, ММ, СС;

  ЧЧ = int( substr( Строка, Позиция,   2 ) );
  ММ = int( substr( Строка, Позиция+2, 2 ) );
  СС = int( substr( Строка, Позиция+4, 2 ) );

  return time(ЧЧ, ММ, СС);
end;
