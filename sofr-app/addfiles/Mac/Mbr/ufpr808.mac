/*
  $Name: ufpr808.mac
  $Module: Œ¥¦¡ ­ª®¢áª¨¥ à áç¥âë
  $Description: ¥ç â­ ï ä®à¬  á®®¡é¥­¨ï ED808 âà ­á¯®àâ  “”‘
*/


import oralib, MesInter, wlglobal, wluftool, WLTOOLS, WldInter, rsexts, bnk_dirfile, bnk_common, ufgd808_class;

private macro GetPrtKindNameKind( numberKind ):string
  var NameKind = "";
  var select = " select t_NameKind " +  
               " from ddprtkind_dbt " +  
               " where t_NumberKind = :numberKind"; 

  var params = makeArray( SQLParam( "numberKind", numberKind ) );
                        
  var rs = execSQLselect( select, params );
  
  if( rs and rs.moveNext() )
    NameKind = rs.value( "t_NameKind" );
  end;

  return NameKind;
end;

private macro PrintBICDataElement( BICDirectoryEntry: TBICDirectoryEntry )
  const MaxRequisiteLength = 56;
  const MaxChangeTypeTextRequisiteLength = 70;
  var arrItr = 0;
  var tmpReqValArr;

  [ “ç áâ­¨ª ˆŠ (BIC):  #########
  ]( BICDirectoryEntry.BIC );
  
  if( BICDirectoryEntry.ChangeType != "" )
    var ChangeTypeText = Bnk_GetLLValuesName( OBJTYPE_TYPE_LAST_CHANGE_PARTICIPANTS_PS_BR, BICDirectoryEntry.ChangeType );
    if( strlen( ChangeTypeText ) <= MaxChangeTypeTextRequisiteLength )
      [ ’¨¯ ¨§¬¥­¥­¨ï (ChangeType):  #### ######################################################################
      ]( 
         BICDirectoryEntry.ChangeType, 
         ChangeTypeText
       );
    else
      tmpReqValArr = StrSplit2( ChangeTypeText, MaxChangeTypeTextRequisiteLength );
      arrItr = 0;
      while( arrItr < tmpReqValArr.size )
        if( arrItr == 0 )
          [ ’¨¯ ¨§¬¥­¥­¨ï (ChangeType):  #### ######################################################################
          ]( 
             BICDirectoryEntry.ChangeType, 
             tmpReqValArr[ArrItr]:l
           );
        else
          [ ’¨¯ ¨§¬¥­¥­¨ï (ChangeType):  ###########################################################################
          ]( tmpReqValArr[ArrItr]:l );
        end;
        arrItr = arrItr + 1;
      end;
    end;
  end;

  [ ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿ 
    ³ „ ­­ë¥ ®¡ ãç áâ­¨ª¥                                                                                          ³    
  ];

  if( strlen( BICDirectoryEntry.ParticipantInfo.NameP ) <= MaxRequisiteLength )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ NameP              ³  ¨¬¥­®¢ ­¨¥                 ³ ######################################################## ³    
    ]( BICDirectoryEntry.ParticipantInfo.NameP );
  else
    tmpReqValArr = StrSplit2( BICDirectoryEntry.ParticipantInfo.NameP, MaxRequisiteLength );
    arrItr = 0;
    while( arrItr < tmpReqValArr.size )
      if( arrItr == 0 )
        [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ³ NameP              ³  ¨¬¥­®¢ ­¨¥                 ³ ######################################################## ³    
        ]( tmpReqValArr[ArrItr]:l );
      else
        [ ³                    ³                              ³ ######################################################## ³    
        ]( tmpReqValArr[ArrItr]:l );
      end;
      arrItr = arrItr + 1;
    end;
  end;

  if( BICDirectoryEntry.ParticipantInfo.EnglName != "" )
    if( strlen( BICDirectoryEntry.ParticipantInfo.EnglName ) <= MaxRequisiteLength )
      [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ EnglName           ³  ¨¬¥­®¢ ­¨¥ ­               ³ ######################################################## ³
        ³                    ³  ­£«¨©áª®¬                   ³                                                          ³      
      ]( BICDirectoryEntry.ParticipantInfo.EnglName );
    else
      tmpReqValArr = StrSplit2( BICDirectoryEntry.ParticipantInfo.EnglName, MaxRequisiteLength );
      arrItr = 0;
      while( arrItr < tmpReqValArr.size )
        if( arrItr == 0 )
          [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
            ³ EnglName           ³  ¨¬¥­®¢ ­¨¥ ­               ³ ######################################################## ³
          ]( tmpReqValArr[ArrItr]:l );
        elif( arrItr == 1 )
          [ ³                    ³  ­£«¨©áª®¬                   ³ ######################################################## ³      
          ]( tmpReqValArr[ArrItr]:l );
        else
          [ ³                    ³                              ³ ######################################################## ³    
          ]( tmpReqValArr[ArrItr]:l );
        end;
        arrItr = arrItr + 1;
      end;
    end;
  end;

  if( BICDirectoryEntry.ParticipantInfo.RegN != "" )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ RegN               ³ ¥£¨áâà æ¨®­­ë© ­®¬¥à        ³ #########                                                ³      
    ]( BICDirectoryEntry.ParticipantInfo.RegN );
  end;

  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ³ UID                ³ “ˆ‘                          ³ ##########                                               ³
  ]( BICDirectoryEntry.ParticipantInfo.UID );

  if( BICDirectoryEntry.ParticipantInfo.PrntBIC != "" )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ PrntBIC            ³ ˆŠ ƒ                       ³ #########                                                ³
    ]( BICDirectoryEntry.ParticipantInfo.PrntBIC );
  end;

  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ 
    ³ „ ­­ë¥ ®¡  ¤à¥á¥ ãç áâ­¨ª                                                                                    ³
    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ];

  if( BICDirectoryEntry.ParticipantInfo.CntrCD != "" )
    [ ³ CntrCD             ³ Š®¤ áâà ­ë                   ³ ##                                                       ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( BICDirectoryEntry.ParticipantInfo.CntrCD );
  end;

  if( BICDirectoryEntry.ParticipantInfo.Rgn != "" )
    [ ³ Rgn                ³ Š®¤ â¥àà¨â®à¨¨               ³ ##                                                       ³      
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( BICDirectoryEntry.ParticipantInfo.Rgn );
  end;

  if( BICDirectoryEntry.ParticipantInfo.Ind != "" )
    [ ³ Ind                ³ ˆ­¤¥ªá                       ³ ######                                                   ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( BICDirectoryEntry.ParticipantInfo.Ind );
  end;

  if( BICDirectoryEntry.ParticipantInfo.Tnp != "" )
    [ ³ Tnp                ³ ’¨¯ ­ á¥«¥­­®£® ¯ã­ªâ        ³ #####                                                    ³      
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( BICDirectoryEntry.ParticipantInfo.Tnp );
  end;

  if( BICDirectoryEntry.ParticipantInfo.Nnp != "" )
    [ ³ Nnp                ³  ¨¬¥­®¢ ­¨¥                 ³ #########################                                ³
      ³                    ³ ­ á¥«¥­­®£® ¯ã­ªâ            ³                                                          ³      
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ]( BICDirectoryEntry.ParticipantInfo.Nnp );
  end;

  if( strlen( BICDirectoryEntry.ParticipantInfo.Adr ) <= MaxRequisiteLength )
    [ ³ Adr                ³ €¤à¥á                        ³ ######################################################## ³
    ]( BICDirectoryEntry.ParticipantInfo.Adr );
  else
    tmpReqValArr = StrSplit2( BICDirectoryEntry.ParticipantInfo.Adr, MaxRequisiteLength );
    arrItr = 0;
    while( arrItr < tmpReqValArr.size )
      if( arrItr == 0 )
        [ ³ Adr                ³ €¤à¥á                        ³ ######################################################## ³
        ]( tmpReqValArr[ArrItr]:l );
      else
        [ ³                    ³                              ³ ######################################################## ³    
        ]( tmpReqValArr[ArrItr]:l );
      end;
      arrItr = arrItr + 1;
    end;
  end;

  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ 
    ³ “ç áâ¨¥ ¢ ®¡¬¥­¥                                                                                             ³
  ];

  var XchTypeText = Bnk_GetLLValuesName( OBJTYPE_PARTICIPANTS_EXCHANGE, BICDirectoryEntry.ParticipantInfo.XchType );

  if( strlen( XchTypeText ) <= MaxRequisiteLength )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ XchType            ³ “ç áâ­¨ª ®¡¬¥­               ³ # ###################################################### ³
    ]( BICDirectoryEntry.ParticipantInfo.XchType,
       XchTypeText );
  else
    tmpReqValArr = StrSplit2( XchTypeText, MaxRequisiteLength );
    arrItr = 0;
    while( arrItr < tmpReqValArr.size )
      if( arrItr == 0 )
        [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ³ XchType            ³ “ç áâ­¨ª ®¡¬¥­               ³ # ###################################################### ³
        ]( BICDirectoryEntry.ParticipantInfo.XchType,
           tmpReqValArr[ArrItr]:l );
      else
        [ ³                    ³                              ³ ######################################################## ³
        ]( tmpReqValArr[ArrItr]:l );
      end;
      arrItr = arrItr + 1;
    end;
  end;
  
  var i = 1;
  var PtTypeArr = TArray();
  PtTypeArr = StrSplit2(GetPrtKindNameKind( BICDirectoryEntry.ParticipantInfo.PtType ), 53);
  
  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ³ PtType             ³ ’¨¯ ãç áâ­¨ª                 ³ ## ##################################################### ³
  ]( BICDirectoryEntry.ParticipantInfo.PtType,
      PtTypeArr[0]);
  while( i < PtTypeArr.size )
    [ ³                    ³                              ³    ##################################################### ³
    ](PtTypeArr[i]);
    i = i + 1;
  end;
  i = 0;

  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ³ Srvcs              ³ ‘¥à¢¨áë                      ³ # ###################################################### ³
  ]( BICDirectoryEntry.ParticipantInfo.Srvcs,
     Bnk_GetLLValuesName( OBJTYPE_AVAIL_TRANSL_SERV_MONEY, BICDirectoryEntry.ParticipantInfo.Srvcs ) );

  [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ³ DateIn             ³ „ â  ¢ª«îç¥­¨ï               ³ ##########                                               ³
  ]( DDpMMpYYYY( BICDirectoryEntry.ParticipantInfo.DateIn ) );

  if( BICDirectoryEntry.ParticipantInfo.DateOut != date(0,0,0) )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ DateOut            ³ „ â  ¨áª«îç¥­¨ï              ³ ##########                                               ³
    ]( DDpMMpYYYY( BICDirectoryEntry.ParticipantInfo.DateOut ) );
  end;
  
  if ( BICDirectoryEntry.ParticipantInfo.NPSParticipant != "" )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ NPSParticipant     ³ à¨§­ ª ãç áâ. ¢ ‘        ³ #                                                        ³
    ]( BICDirectoryEntry.ParticipantInfo.NPSParticipant );
  end;
  
  if( BICDirectoryEntry.ParticipantInfo.ToNPSDate != date(0,0,0) )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ ToNPSDate          ³ „ â  ¢ª«îç¥­¨ï ¢ ‘        ³ ##########                                               ³
    ]( DDpMMpYYYY( BICDirectoryEntry.ParticipantInfo.ToNPSDate ) );
  end;

  if( BICDirectoryEntry.ParticipantInfo.ParticipantStatus != "" )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ ParticipantStatus  ³ ‘â âãá ãç áâ­¨ª              ³ #### ################################################### ³
    ]( BICDirectoryEntry.ParticipantInfo.ParticipantStatus,
       Bnk_GetLLValuesName( OBJTYPE_STATUS_PARTICIPANT, BICDirectoryEntry.ParticipantInfo.ParticipantStatus ) );
  end;

  if( BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount != null )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ 
      ³ „ ­­ë¥ ¯àï¬®£® ãç áâ­¨ª  (DirectParticipantAccount)                                                          ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ BIC                ³ ˆŠ ¯àï¬®£® ãç áâ­¨ª         ³ #########                                                ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³ Account            ³ ‘ç¥â ¯àï¬®£® ãç áâ­¨ª        ³ ####################                                     ³
    ]( BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount.BIC,
       BICDirectoryEntry.ParticipantInfo.DirectParticipantAccount.Account );
  end;

  if( (BICDirectoryEntry.ParticipantInfo.RstrList and BICDirectoryEntry.ParticipantInfo.RstrList.size) 
   or (BICDirectoryEntry.SWBICS and BICDirectoryEntry.SWBICS.size) 
   or (BICDirectoryEntry.Accounts and BICDirectoryEntry.Accounts.size) )
    [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
    ];
  else
    [ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
    ];
  end;

  if( BICDirectoryEntry.ParticipantInfo.RstrList and BICDirectoryEntry.ParticipantInfo.RstrList.size )
    [ ³ ¥à¥ç¥­ì ®£à ­¨ç¥­¨© ãç áâ­¨ª  (RstrList)                                                                    ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³                Š®¤ ®£à ­¨ç¥­¨ï (Rstr)                ³            „ â  ­ ç «  ¤¥©áâ¢¨ï (RstrDate)            ³
    ];
    for( var Rstr, BICDirectoryEntry.ParticipantInfo.RstrList )
      [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ #### ############################################### ³ ##########                                            ³       
      ]( Rstr.Rstr,
         Bnk_GetLLValuesName( OBJTYPE_RESTR_TRANSL_SERV_MONEY, Rstr.Rstr ),
         DDpMMpYYYY( Rstr.RstrDate )
       );           
    end;

    if( (BICDirectoryEntry.SWBICS and BICDirectoryEntry.SWBICS.size) 
     or (BICDirectoryEntry.Accounts and BICDirectoryEntry.Accounts.size) )
      [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ];
    else
      [ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
      ];
    end;
  end;

  if( BICDirectoryEntry.SWBICS and BICDirectoryEntry.SWBICS.size )
    [ ³ ¥à¥ç¥­ì ˆŠ (‘”ˆ”’), á®®â¢¥âáâ¢ãîé¨å ãç áâ­¨ªã (SWBICS)                                                     ³
      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ³         BIC SWIFT, áâ ­¤ àâ ˆ‘ 9362 (SWBIC)         ³              ® ã¬®«ç ­¨î (DefaultSWBIC)              ³
    ];
    for( var swbic, BICDirectoryEntry.SWBICS )
      [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ ###########                                          ³ #                                                     ³       
      ]( swbic.SWBIC,
         swbic.DefaultSWBIC
       );           
    end;                  

    if( BICDirectoryEntry.Accounts and BICDirectoryEntry.Accounts.size )
      [ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ];         
    else
      [ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ ];
    end;
  end;

  if( BICDirectoryEntry.Accounts and BICDirectoryEntry.Accounts.size )
    var itr = 0;
    var tmpAccSize = BICDirectoryEntry.Accounts.size;
    var wasAccRstrList = false;

    [ ³ ˆ­ä®à¬ æ¨ï ® áç¥â å ãç áâ­¨ª  (Accounts)                                                                     ³ ];

    for( var account, BICDirectoryEntry.Accounts )
      if( itr == 0 )
        [ ÀÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ];
      elif(wasAccRstrList)
        [   ÚÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ];
      else
        [   ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ];
      end;

      [   ³ ‘ç¥â (Account) ####################                                                                        ³
          ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
          ³ RegulationAccountType ³ ‘ç¥â ¯àï¬®£® ãç áâ­¨ª        ³ #### ############################################## ³
          ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ]( account.Account,
         account.RegulationAccountType,
         Bnk_GetLLValuesName( OBJTYPE_TYPE_ACCOUNT_STANDARD, account.RegulationAccountType )
       );           

       if( account.CK != "" )
         [   ³ CK                    ³ Š®­âà®«ì­ë© ª«îç             ³ ##                                                  ³
             ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ]( account.CK );           
       end;

       [   ³ AccountCBRBIC         ³ ˆŠ                       ³ #########                                           ³
           ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
           ³ DateIn                ³ „ â  ®âªàëâ¨ï                ³ ##########                                          ³
           ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ]( account.AccountCBRBIC,
          DDpMMpYYYY( account.DateIn ) );

       if( account.DateOut != date(0,0,0) )
         [   ³ DateOut               ³ „ â  ¨áª«îç¥­¨ï              ³ ##########                                          ³
             ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ]( DDpMMpYYYY( account.DateOut ) );
       end; 

       if( account.AccountStatus != "" )
         [   ³ AccountStatus         ³ ‘â âãá áç¥â                  ³ #### ############################################## ³
         ]( account.AccountStatus,
            Bnk_GetLLValuesName( OBJTYPE_STATUS_ACCOUNT, account.AccountStatus ) );

       end; 

       if( (account.AccRstrList) and (account.AccRstrList.size) )
         [   ÀÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ];
       end;

       wasAccRstrList = false;
       
       if( account.AccRstrList and account.AccRstrList.size )
         [     ³ ¥à¥ç¥­ì ®£à ­¨ç¥­¨© ®¯¥à æ¨© ¯® áç¥âã (AccRstrList)                                                     ³
               ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
               ³              Š®¤ ®£à ­¨ç¥­¨ï (AccRstr)             ³         „ â  ­ ç «  ¤¥©áâ¢¨ï (AccRstrDate)          ³
         ];
         

         for( var accRstr, account.AccRstrList )
           wasAccRstrList = true;
           var AccRstrText = Bnk_GetLLValuesName( OBJTYPE_SIGN_RESTR_TRANSACTIONS_ACCOUNT, accRstr.AccRstr );

           [     ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                 ³ #### ############################################  ³ ##########                                          ³       
           ]( accRstr.AccRstr,
              AccRstrText:w,
              DDpMMpYYYY( accRstr.AccRstrDate ) );
         end;

         if( itr == tmpAccSize - 1 )
           [     ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ ];
         end;           
       end;

       if( (not wasAccRstrList) and (itr == BICDirectoryEntry.Accounts.size - 1) )
         [   ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ ];
       end; 

       itr = itr + 1;
    end;
  end;
end;

private macro PrintTableInfo( ED808MessageFields : TED808MessageFields )

  var RepType = "";
  var i = 0;
  if( ED808MessageFields.InfoTypeCode == "FIRR" )
    RepType = "®«­ë© à®ä¨«ì ãç áâ­¨ª ";
  end;

  [
    ED808 ##################################################

    ®¬¥à C:     #########
    „ â  C:     ##########
    ‘®áâ ¢¨â¥«ì: ########## ##################################################
  ]( RepType,
     ED808MessageFields.EDNo, 
     DDpMMpYYYY(ED808MessageFields.EDDate), 
     ED808MessageFields.EDAuthor, 
     Bnk_GetPartyName( ®«ãç¨âìŠ®¤‘ã¡ê¥ªâ ( ED808MessageFields.EDAuthor, PTCK_UIS, null ) )
   );

  if( ED808MessageFields.EDReceiver != "" )
    [ ®«ãç â¥«ì:  ########## ##################################################
    ]( ED808MessageFields.EDReceiver, 
       Bnk_GetPartyName( ®«ãç¨âìŠ®¤‘ã¡ê¥ªâ ( ED808MessageFields.EDReceiver, PTCK_UIS, null ) ) 
     );
  end;

  [ Š®¤ ¯à¨ç¨­ë ä®à¬¨à®¢ ­¨ï: #### ################################################################################
  ]( ED808MessageFields.CreationReason.CreationReasonCode[0],
     GetWlcodeDescription( TYPE_CODE_UFBS_ED808_CREATIONREASONCODE, ED808MessageFields.CreationReason.CreationReasonCode[0] )
    );
  i = 1;
  while( i < ED808MessageFields.CreationReason.CreationReasonCode.size )
    [                           #### ################################################################################
    ]( ED808MessageFields.CreationReason.CreationReasonCode[i],
       GetWlcodeDescription( TYPE_CODE_UFBS_ED808_CREATIONREASONCODE, ED808MessageFields.CreationReason.CreationReasonCode[i] )
      );
    i = i + 1;
  end;
  i = 0;
  [ „ â  ¨ ¢à¥¬ï á®§¤ ­¨ï:  #########################
    ‚¨¤ ¯à¥¤áâ ¢«¥­¨ï ¨­ä®à¬ æ¨¨: #### ################################################################################
  ]( ED808MessageFields.CreationDateTime, 
     ED808MessageFields.InfoTypeCode,
     GetWlcodeDescription( TYPE_CODE_UFBS_ED801_INFOTYPECODE, string( "/" + ED808MessageFields.InfoTypeCode + "/" ) )
   );
   
  if( ED808MessageFields.InitialED != null )
    [
      ˆ­ä®à¬ æ¨ï ®¡ ¨áå®¤­®¬ ‘ˆ‘:
           ®¬¥à ‘: #########
           „ â  ‘: ##########
           ‘®áâ ¢¨â¥«ì: ########## ##################################################
    ]( ED808MessageFields.InitialED.EDNo, 
       DDpMMpYYYY(ED808MessageFields.InitialED.EDDate), 
       ED808MessageFields.InitialED.EDAuthor,
       Bnk_GetPartyName( ®«ãç¨âìŠ®¤‘ã¡ê¥ªâ ( ED808MessageFields.InitialED.EDAuthor, PTCK_UIS, null ) ) 
     );
  end;

end;

private macro PrintTableElements( ED808MessageFields: TED808MessageFields )
  if( not ED808MessageFields.isXMLExists )
    [ 
      
      ˆ­ä®à¬ æ¨ï ® § ¯¨áïå ¢ á¯à ¢®ç­¨ª¥ ˆŠ, ¯®áâã¯¨¢è ï ¢ ¡ ­ª á ¤ ­­ë¬ ‘, 
      ­¥ ¬®¦¥â ¡ëâì ¢ë¢¥¤¥­ , â.ª. ã¤ «¥­ xml-ä ©« á®®¡é¥­¨ï
    ];
  else
    [ 
      
      ‡€ˆ‘ˆ ‚ ‘€‚—ˆŠ… ˆŠ
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

    ];
   if( ED808MessageFields.BICDirectoryEntry )
     PrintBICDataElement(ED808MessageFields.BICDirectoryEntry);
   end;
  end;
end;

private macro PrintRestriction( Res : object, ResName : string, HeaderFlag : @Bool )

  if(HeaderFlag)                                                                         
[ ÚÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
  end;
  
[ ³######################################################################################³
  ÀÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ Applied            ³ à¨¬¥­¥­® «¨ ®£à ­¨ç¥­¨¥    ³ ########################### ³](ResName,
                                                                                            IfThenElse(Res.Applied == "1", "„ ", "")); 
  if((ValType(Res.ApplyDate) != V_UNDEF) and (strlen(Res.ApplyDate) > 0))
[       ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ ApplyDate          ³ „ â  ãáâ ­®¢«¥­¨ï           ³ ########################### ³ 
        ³                    ³ (á­ ïâ¨ï) ®£à ­¨ç¥­¨ï       ³                             ³](DDpMMpYYYY(ToDate(Res.ApplyDate))); 
  end;
  if(CheckObjectElem( Res, "RestrictionBasisDoc"))
    var DescriptionArr = TArray();
    DescriptionArr = StrSplit2(Res.RestrictionBasisDoc.Description, 27);
    var i = 1;
[       ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ á­®¢ ­¨ï ¤«ï ­ «®¦¥­¨ï ®£à ­¨ç¥­¨ï/ à¥áâ  (RestrictionBasisDoc)               ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ DocDate            ³ „ â  ¤®ªã¬¥­â               ³ ########################### ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ DocNumber          ³ ®¬¥à ¤®ªã¬¥­â              ³ ########################### ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ Description        ³ ¯¨á ­¨¥ ¤®ªã¬¥­â           ³ ########################### ³
](
  DDpMMpYYYY(Res.RestrictionBasisDoc.DocDate),
  IfThenElse(ValType(Res.RestrictionBasisDoc.DocNumber) == V_UNDEF, "", Res.RestrictionBasisDoc.DocNumber),
  IfThenElse(ValType(DescriptionArr[0]) == V_UNDEF, "", DescriptionArr[0])
  );
    while( i < DescriptionArr.size )
[       ³                    ³                             ³ ########################### ³]
(DescriptionArr[i]);
      i = i + 1;
    end;
  end;
  
  HeaderFlag = true;

end;

private macro PrintParticipantProfile( ED808MessageFields: TED808MessageFields )

  var i = 0;

[ 

  ”ˆ‹œ “—€‘’ˆŠ€
  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
  
  ˆ­ä®à¬ æ¨ï ®¡ ãç áâ­¨ª¥ (ParticipantProfileInfo):
  
];
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.PtType" ) )
[ ’¨¯ ãç áâ­¨ª  (PtType): ## ####################################################################################################]
(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.PtType,
 GetPrtKindNameKind(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.PtType));
  end;
  
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.ServCBRBIC") )
[ ˆŠ , ®¡á«ã¦¨¢ îé¥£® ãç áâ­¨ª  ¯¥à¥¢®¤  (ServCBRBIC): #########]
(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ServCBRBIC);
  end;
  
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.DefaultARMNo") )
[ ®¬¥à €Œ ¯® ã¬®«ç ­¨î (DefaultARMNo): ##]
(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.DefaultARMNo);
  end;
  
  if(CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.ChannelMode") ) 
[ à¨§­ ª ®á­®¢­®£® ª ­ «  ¢§ ¨¬®¤¥©áâ¢¨ï á ‘  (ChannelMode): #]
(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ChannelMode);
  end;
  
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.UFCFInfo.UFBIC") )
[ ˆŠ “¯®«­®¬®ç¥­­®£® ä¨«¨ «  (UFCFInfo\UFBIC): 
    ######### ################################################################################################################################################################]
(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.UFBIC,
 Bnk_GetPartyName(GetCodeOwnerID(PTCK_BIC, ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.UFBIC)));
  end;
  
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC") )
[ ‘¯¨á®ª ˆŠ –¥­âà «¨§®¢ ­­ëå ä¨«¨ «®¢ (UFCFInfo\CFBICList\CFBIC):];

    while( i < ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC.size )
[   ######### ################################################################################################################################################################
](ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC[i],
  Bnk_GetPartyName(GetCodeOwnerID(PTCK_BIC, ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.UFCFInfo.CFBICList.CFBIC[i])));
    i = i + 1;
    end;
  end;
 
  if( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions") )
[ 

  £à ­¨ç¥­¨ï, ­ «®¦¥­­ë¥ ­  ãç áâ­¨ª  (IntradayRestrictions): 
];
    var HeaderFlag = false;
[ ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿];
    if( ValType(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS) != V_UNDEF )
      PrintRestriction( ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopUrgentFTS, 
                        "£à ­¨ç¥­¨¥ ¯à¥¤®áâ ¢«¥­¨ï á¥à¢¨á  áà®ç­®£® ¯¥à¥¢®¤  ¤¥­¥¦­ëå áà¥¤áâ¢ (StopUrgentFTS)", @HeaderFlag);
    end;
    if( ValType(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI) != V_UNDEF )
      PrintRestriction( ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendFTI, 
                        "£à ­¨ç¥­¨¥ ­ ¯à ¢«¥­¨ï à á¯®àï¦¥­¨© (StopSendFTI)", @HeaderFlag);
    end;
    if( ValType(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM) != V_UNDEF )
      PrintRestriction( ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendRecvEM, 
                        "£à ­¨ç¥­¨¥ ­ ¯à ¢«¥­¨ï ¨ ¯®«ãç¥­¨ï ‘ (StopSendRecvEM)", @HeaderFlag);
    end;
    if( ValType(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM) != V_UNDEF )
      PrintRestriction( ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.StopSendEM, 
                        "£à ­¨ç¥­¨¥ ­ ¯à ¢«¥­¨ï ‘ (StopSendEM)", @HeaderFlag);
    end;
    if( ValType(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion) != V_UNDEF )
      PrintRestriction( ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.IntradayRestrictions.PendingDeletion, 
                        "‚ ®¦¨¤ ­¨¨ ã¤ «¥­¨ï (PendingDeletion)", @HeaderFlag);
    end;
[       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
  end;
end;

private macro PrintParticipantAttributes( ED808MessageFields : TED808MessageFields )

  if( not CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes") )
    return;
  end;

  var CanBeAuthorOfConfLiqRsrv = "",
      CanBeAuthorOfLiqRsrv = "",
      CanBeAuthorOfCover = "",
      CanSendDD = "",
      CanBeAuthorReqOfRsrv = "";
      
  if(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfConfLiqRsrv == "1")
    CanBeAuthorOfConfLiqRsrv = "„ ";
  end;
  if(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfLiqRsrv == "1")
    CanBeAuthorOfLiqRsrv = "„ ";
  end;
  if(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorOfCover == "1")
    CanBeAuthorOfCover = "„ ";
  end;
  if(ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanSendDD == "1")
    CanSendDD = "„ ";
  end;
  if( ( CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorReqOfRsrv") == true ) and 
       (ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.ParticipantAttributes.CanBeAuthorReqOfRsrv) == "1")
    CanBeAuthorReqOfRsrv = "„ ";
  end;
  
[
  à¨§­ ª¨ ãç áâ­¨ª  (ParticipantAttributes):
 ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄ¿ 
 ³          à¨§­ ª         ³                     ¯¨á ­¨¥                    ³‘®áâ®ï­¨¥³
 ³                          ³                                                 ³ ¯à¨§­ ª ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ´
 ³ CanBeAuthorOfConfLiqRsrv ³ à¨§­ ª â®£®, ¬®¦¥â «¨ ãç áâ­¨ª ¡ëâì            ³         ³
 ³                          ³ á®áâ ¢¨â¥«¥¬ ¯®¤â¢¥à¦¤ îé¥£® á®®¡é¥­¨ï ¢        ³   ##    ³
 ³                          ³ á®®â¢¥âáâ¢¨¨ á® áå¥¬®© à¥§¥à¢¨à®¢ ­¨ï           ³         ³
 ³                          ³ «¨ª¢¨¤­®áâ¨                                     ³         ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ´
 ³ CanBeAuthorOfLiqRsrv     ³ à¨§­ ª â®£®, ¬®¦¥â «¨ ãç áâ­¨ª á®áâ ¢«ïâì      ³         ³
 ³                          ³ ¯« â¥¦­®¥ à á¯®àï¦¥­¨¥ ¢ á®®â¢¥âáâ¢¨¨ á® áå¥¬®© ³   ##    ³
 ³                          ³ à¥§¥à¢¨à®¢ ­¨ï «¨ª¢¨¤­®áâ¨                      ³         ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ´
 ³ CanBeAuthorOfCover       ³ à¨§­ ª â®£®, ¬®¦¥â «¨ ãç áâ­¨ª á®áâ ¢«ïâì      ³         ³
 ³                          ³ ¯« â¥¦­®¥ à á¯®àï¦¥­¨¥ á ¨á¯®«ì§®¢ ­¨¥¬         ³   ##    ³
 ³                          ³ ®¡¥á¯¥ç¥­¨ï ¤¥­¥¦­ë¬¨ áà¥¤áâ¢ ¬¨                ³         ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ´
 ³ CanSendDD                ³ à¨§­ ª â®£®, ¬®¦¥â «¨ ãç áâ­¨ª ¡ëâì            ³         ³
 ³                          ³ á®áâ ¢¨â¥«¥¬ âà¥¡®¢ ­¨ï ¢ ¯®â®ª¥ ®¯¥à æ¨©       ³   ##    ³
 ³                          ³ ¤¥¡¥â®£® ¯¥à¥¢®¤                                ³         ³
 ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄ´
 ³ CanBeAuthorReqOfRsrv     ³ à¨§­ ª, ãª §ë¢ îé¨© ­  ­ «¨ç¨¥ ¢®§¬®¦­®áâ¨     ³         ³
 ³                          ³ ­ ¯à ¢«¥­¨ï § ¯à®á  ® à¥§¥à¢¨à®¢ ­¨¨ áã¬¬ë      ³   ##    ³
 ³                          ³ ¤¥­¥¦­ëå áà¥¤áâ¢ ­  ¨á¯®«­¥­¨¥ à á¯®àï¦¥­¨ï     ³         ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÙ
](CanBeAuthorOfConfLiqRsrv,
  CanBeAuthorOfLiqRsrv,
  CanBeAuthorOfCover,
  CanSendDD,
  CanBeAuthorReqOfRsrv
  );

end;

private macro PrintAccountList( ED808MessageFields )

  if( not CheckObjectElem(ED808MessageFields, "ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList") )
    return;
  end;

  var i = 0;

  
[ 

  ‘¯¨á®ª ãç áâ­¨ª®¢ ¨ ¨å áç¥â®¢, ¤«ï ª®â®àëå ¤ ­­ë© ãç áâ­¨ª ¬®¦¥â ï¢«ïâìáï ã¯®«­®¬®ç¥­­ë¬ á®áâ ¢¨â¥«¥¬ âà¥¡®¢ ­¨© (AccountsAuthorizedForDD): 
  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³                ‘¯¨á®ª ãç áâ­¨ª®¢ ¨ ¨å áç¥â®¢ (AccountsList)                 ³
  ÃÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
  ³ ˆŠ (BIC) ³              ¨¬¥­®¢ ­¨¥                 ³    ‘ç¥â (Account)    ³
];

  while( i < ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList.size)
[ ÃÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
    var DescriptionArr = TArray();
    var Description = Bnk_GetPartyName(GetCodeOwnerID(PTCK_BIC, ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[i].BIC));
    DescriptionArr = StrSplit2(Description, 40);
    var j = 1;
    
[ ³ ######### ³ ######################################## ³ #################### ³
](ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[i].BIC,
  IfThenElse(ValType(DescriptionArr[0]) == V_UNDEF, "", DescriptionArr[0]),
  ED808MessageFields.ParticipantProfile.ParticipantProfileInfo.AccountsAuthorizedForDD.AccountsList[i].Account
  );
    while( j < DescriptionArr.size )
[ ³           ³ ######################################## ³                      ³
](DescriptionArr[j]);
      j = j + 1;
    end;
    
    i = i + 1;
  end;
  
[ ÀÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
];
end;

private macro PrintPendingDeletionInfo( AccountsInfo : TAccountsInfo )
  if( not CheckObjectElem(AccountsInfo, "PendingDeletionInfo") )
    return;
  end;
  
[       ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ „®¯®«¨â¥«ì­ ï ¨­ä®à¬ æ¨ï ¤«ï ®£à ­¨ç¥­¨ï "¢ ®¦¨¤ ­¨¨ ã¤ «¥­¨ï"                 ³ 
        ³ (PendingDeletionInfo)                                                          ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ AccountCloseDate   ³‡ ¯« ­¨à®¢ ­­ ï ¤ â  ã¤ «¥­¨ï³ ########################### ³](DDpMMpYYYY(ToDate(AccountsInfo.PendingDeletionInfo.AccountCloseDate)));
        
  if( not CheckObjectElem(AccountsInfo, "PendingDeletionInfo.DestinationInfo") )
    return;
  end;
[       ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ ˆ­ä®à¬ æ¨ï ¤«ï ¯¥à¥ç¨á«¥­¨ï ¤¥­¥¦­ëå áà¥¤áâ¢ ¢ ª®­æ¥ ¤­ï, ¯à¥¤è¥áâ¢ãîé¥£®      ³
        ³ ¤ â¥ ã¤ «¥­¨ï áç¥â  (DestionationInfo)                                         ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ DestinationBIC     ³ ˆŠ ¡ ­ª , ¢ ª®â®à®¬ ®âªàëâ ³ ########################### ³
        ³                    ³ áç¥â ­ §­ ç¥­¨ï             ³                             ³
        ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
        ³ DestinationAccount ³ ‘ç¥â ­ §­ ç¥­¨ï             ³ ########################### ³]       

 (AccountsInfo.PendingDeletionInfo.DestinationInfo.DestinationBIC,
  AccountsInfo.PendingDeletionInfo.DestinationInfo.DestinationAccount); 
  
end;

private macro PrintAccIntradayRestrictions( AccountsInfo : TAccountsInfo )
  if( CheckObjectElem(AccountsInfo, "AccIntradayRestrictions") )
[ 

  £à ­¨ç¥­¨ï ¯® áç¥âã (AccIntradayRestrictions):
];
    var HeaderFlag = false;
[ ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿];
    if( ValType(AccountsInfo.AccIntradayRestrictions.StopDebits) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.StopDebits, 
                        "áâ ­®¢ª  á¯¨á ­¨ï (StopDebits)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.StopCredits) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.StopCredits, 
                        "áâ ­®¢ª  § ç¨á«¥­¨ï (StopCredits)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.StopUrgentFTS) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.StopUrgentFTS, 
                        "áâ ­®¢ª  ¯à¥¤®áâ ¢«¥­¨ï á¥à¢¨á  áà®ç­®£® ¯¥à¥¢®¤  ¤¥­¥¦­ëå áà¥¤áâ¢ (StopUrgentFTS)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.PendingDeletion) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.PendingDeletion, 
                        "‚ ®¦¨¤ ­¨¨ ã¤ «¥­¨ï (PendingDeletion)", @HeaderFlag);
      PrintPendingDeletionInfo( AccountsInfo );
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.RouteToCBR) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.RouteToCBR, 
                        "Š®­âà®«ì  ¯¥à¥¤ § ç¨á«¥­¨¥¬ (RouteToCBR)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.ManualVerifMode) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.ManualVerifMode, 
                        "à¥¤¢ à¨â¥«ì­ë© ª®­âà®«ì  (ManualVerifMode)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.Arrest) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.Arrest, 
                        "€à¥áâ ¨«¨ ®£à ­¨ç¥­¨¥ ­  ­¥®¯à¥¤¥«¥­­ãî áã¬¬ã (Arrest)", @HeaderFlag);
    end;
    if( ValType(AccountsInfo.AccIntradayRestrictions.SpecialMode) != V_UNDEF )
      PrintRestriction( AccountsInfo.AccIntradayRestrictions.SpecialMode, 
                        " «¨ç¨¥ ª áç¥âã ®ç¥à¥¤¨ ­¥¨á¯®«­¥­­ëå ¢ áà®ª à á¯®àï¦¥­¨© (SpecialMode)", @HeaderFlag);
    end;
    
[       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
  end;
end;

private macro PrintBalanceSweepingAccount( AccountsInfo : TAccountsInfo )
  if( not CheckObjectElem( AccountsInfo, "BalanceSweepingAccount") )
    return;
  end;
  
  var PartyName = Bnk_GetPartyName(GetCodeOwnerID(PTCK_BIC, AccountsInfo.BalanceSweepingAccount.BIC));
  
[

  ‘ç¥â ­ §­ ç¥­¨ï, ­  ª®â®àë© ¯à®¨§¢®¤¨âáï ¯¥à¨®¤¨ç¥áª®¥ ¯¥à¥ç¨á«¥­¨¥ ¤¥­¥¦­ëå áà¥¤áâ¢ (BalanceSweepingAccount):
        ˆŠ (BIC): ######### #############################################################################################################
        ®¬¥à áç¥â  (Account): ####################
](AccountsInfo.BalanceSweepingAccount.BIC,
  PartyName,
  AccountsInfo.BalanceSweepingAccount.Account);

  if( CheckObjectElem( AccountsInfo, "BalanceSweepingAccount.DailyTransfer") )
[

  ˆ­ä®à¬ æ¨ï ® ¥¦¥¤­¥¢­®¬ ¯¥à¥¢®¤¥ ®áâ âª  ¤¥­¥¦­ëå áà¥¤áâ¢ (DailyTransfer):
];
    if( CheckObjectElem( AccountsInfo, "BalanceSweepingAccount.DailyTransfer.TimeTransfer") )
[       ‚à¥¬ï ¤«ï ¯¥à¥¢®¤  (TimeTransfer): ########  
](AccountsInfo.BalanceSweepingAccount.DailyTransfer.TimeTransfer);
    elif( CheckObjectElem( AccountsInfo, "BalanceSweepingAccount.DailyTransfer.EventTransfer")) 
[       ‘®¡ëâ¨¥ ¤«ï ¥¦¥¤­¥¢­®£® ¯¥à¥¢®¤  ®áâ âª  ¤¥­¥¦­ëå áà¥¤áâ¢ (EventTransfer):
              Š®¤ â¨¯  á®¡ëâ¨ï (EventCode): #### ##################################################
](AccountsInfo.BalanceSweepingAccount.DailyTransfer.EventTransfer.EventCode,
  GetWlcodeDescription(91, AccountsInfo.BalanceSweepingAccount.DailyTransfer.EventTransfer.EventCode)
  );
    if( CheckObjectElem( AccountsInfo, "BalanceSweepingAccount.DailyTransfer.EventTransfer.EventNumber") )
[             ®¬¥à á®¡ëâ¨ï (EventNumber): ###](AccountsInfo.BalanceSweepingAccount.DailyTransfer.EventTransfer.EventNumber);
    end;
  
  ;
    end;
  end;
  
end;

private macro PrintLimitsInfo( AccountsInfo : TAccountsInfo )
  if( not CheckObjectElem( AccountsInfo, "LimitsInfo") )
    return;
  end;
  
  var i = 0;
[

  ‡­ ç¥­¨ï ¨ ¨á¯®«ì§®¢ ­¨¥ «¨¬¨â®¢ (LimitsInfo\LimitInfo):
  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³               ’¨¯ «¨¬¨â                  ³     ‡­ ç¥­¨¥ «¨¬¨â      ³    ˆŠ     ³   “ˆ‘      ³                  Š«¨à¨­£®¢ ï áå¥¬                       ³
  ³               (LimitType)                ³        (Value)          ³   (BIC)    ³  (UID)     ³                  (ClearingCircuit)                      ³
];                                                                                                                   
  while( i < AccountsInfo.LimitsInfo.LimitInfo.size )                                                                          
[ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];    
[ ³                  ####                    ³   ###################   ³ ########## ³ ########## ³ #### ################################################## ³
  ³ ######################################## ³                         ³            ³            ³                                                         ³ 
](AccountsInfo.LimitsInfo.LimitInfo[i].LimitType,                                                                    
  money(IfThenElse(valtype(AccountsInfo.LimitsInfo.LimitInfo[i].Value) == V_UNDEF, 0, AccountsInfo.LimitsInfo.LimitInfo[i].Value))/100,
  IfThenElse(ValType(AccountsInfo.LimitsInfo.LimitInfo[i].BIC) == V_UNDEF, "", AccountsInfo.LimitsInfo.LimitInfo[i].BIC),
  IfThenElse(ValType(AccountsInfo.LimitsInfo.LimitInfo[i].UID) == V_UNDEF, "", AccountsInfo.LimitsInfo.LimitInfo[i].UID),
  IfThenElse(ValType(AccountsInfo.LimitsInfo.LimitInfo[i].ClearingCircuit) == V_UNDEF, "", AccountsInfo.LimitsInfo.LimitInfo[i].ClearingCircuit),
  GetWlcodeDescription(TYPE_CODE_UFBS_ED8NN_CLEARINGCIRCUIT, AccountsInfo.LimitsInfo.LimitInfo[i].ClearingCircuit):w,
  GetWlcodeDescription(TYPE_CODE_UFBS_ED8NN_LIMITTYPE, AccountsInfo.LimitsInfo.LimitInfo[i].LimitType):w);
    i = i + 1;
  end;
[ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
end;

private macro PrintAuthorizedClaimAuthors( AccountsInfo : TAccountsInfo )
  if( not CheckObjectElem( AccountsInfo, "AuthorizedClaimAuthors") )
    return;
  end;
  var PartyNameArr = TArray();
  var i = 0;
  
[

  ‘¯¨á®ª ã¯®«­®¬®ç¥­­ëå á®áâ ¢¨â¥«¥© âà¥¡®¢ ­¨© (AuthorizedClaimAuthors\AuthorizedClaimAuthorsList):
  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³     ˆŠ\“ˆ‘     ³              ¨¬¥­®¢ ­¨¥             ³
  ³    (BIC\UID)    ³                                      ³
];                                                                                                                   
  while( i < AccountsInfo.AuthorizedClaimAuthors.AuthorizedClaimAuthorsList.size )        
[ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
    var PartyCodeKind = IfThenElse(ValType(AccountsInfo.AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[i].BIC) == V_UNDEF, PTCK_UIS, PTCK_BIC);
    var PartyCode = IfThenElse(ValType(AccountsInfo.AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[i].BIC) == V_UNDEF, AccountsInfo.AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[i].UID, AccountsInfo.AuthorizedClaimAuthors.AuthorizedClaimAuthorsList[i].BIC);
    var PartyName = Bnk_GetPartyName(GetCodeOwnerID(PartyCodeKind, PartyCode));
    PartyNameArr = StrSplit2(PartyName, 36);
    
    
[ ³   ##########    ³ #################################### ³
](PartyCode,                                                                    
  IfThenElse(ValType(PartyNameArr[0]) == V_UNDEF, "", PartyNameArr[0])
  );
  var j = 1;
    while( j < PartyNameArr.size )
[ ³                 ³ #################################### ³
](PartyNameArr[j]
  );
      j = j + 1;
    end;
    i = i + 1;
  end;
[ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
end;

private macro PrintArrestsInfo( AccountsInfo : TAccountsInfo )
  if( not CheckObjectElem( AccountsInfo, "ArrestsInfo") )
    return;
  end;
  
  var i = 0;
[

  ‘¯¨á®ª  à¥áâ®¢ ¨/¨«¨ ®£à ­¨ç¥­¨© (ArrestsInfo\ArrestDetailedInfo):
  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  ³    ID  à¥áâ     ³ ¥§ áã¬¬ë ³   ‘ã¬¬   à¥áâ /    ³   ‘ã¬¬  §  ¢ëç¥â®¬   ³ „ â  ¤®ª.  ³ ®¬¥à ¤®ª-â  ³               ¯¨á ­¨¥ ¤®ªã¬¥­â                    ³
  ³    (ArrestID)   ³           ³    ®£à ­¨ç¥­¨ï     ³      ¨á¯®«­¥­­ëå     ³ ®á­®¢ ­¨ï  ³  ®á­®¢ ­¨ï   ³                   ®á­®¢ ­¨ï                        ³
  ³                 ³           ³  (ArrestAmount)    ³  (OutstandingAmount) ³ (DocDate)  ³ (DocNumber)  ³                  (Description)                     ³
];                                                                                                                                                           
  while( i < AccountsInfo.ArrestsInfo.ArrestDetailedInfo.size )                                                                           
[ ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];    
    var ResDocDate = "",
        ResDocNumber = "",
        ResDescription = "";
               
    if(CheckObjectElem( AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i], "RestrictionBasisDoc"))
      ResDocDate = AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].RestrictionBasisDoc.DocDate;
      if(ValType(AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].RestrictionBasisDoc.DocNumber) != V_UNDEF)
        ResDocNumber = AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].RestrictionBasisDoc.DocNumber;
      end;
      if(ValType(AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].RestrictionBasisDoc.Description) != V_UNDEF)
        ResDescription = AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].RestrictionBasisDoc.Description;
      end;
    end;
                                                                                                                                                             
[ ³   ##########    ³    ##     ³################### ³ ###################  ³ ########## ³ ############ ³ ################################################## ³
](AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].ArrestID,                                                                                     
  IfThenElse(AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].IndeterminateAmountFlag == "1", "„ ", ""),                                                                                                                                                 
  money(IfThenElse(ValType(AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].ArrestAmount) == V_UNDEF, 0, AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].ArrestAmount))/100,
  money(IfThenElse(ValType(AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].OutstandingAmount) == V_UNDEF, 0, AccountsInfo.ArrestsInfo.ArrestDetailedInfo[i].OutstandingAmount))/100,
  IfThenElse(ResDocDate != "", DDpMMpYYYY(ResDocDate), ""),
  ResDocNumber,
  ResDescription:w
  );
    i = i + 1;
  end;                                                
[ ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
end;


private macro PrintSingleAccountInfo( AccountsInfo : TAccountsInfo)
  var llvalueNote = "";
  GetElementAndNoteLLVALUES(4057/*’‘‘*/, AccountsInfo.AccountType, null, llvalueNote, null);
  
[ 

  ˆ­ä®à¬ æ¨ï ® áç¥â å (AccountsInfo): 
  
  ®¬¥à áç¥â  (Account): ####################
  ’¨¯ ­®¬¥à  áç¥â  (AccountType): #### ####################################################################################################
](AccountsInfo.Account,
  AccountsInfo.AccountType,
  llvalueNote);
  
  if( ValType(AccountsInfo.DateOfDeletion) != V_UNDEF )
[ „ â  ä ªâ¨ç¥áª®£® ¨áª«îç¥­¨ï ¨­ä®à¬ æ¨¨ ® áç¥â¥ (DateOfDeletion): ##########](DDpMMpYYYY(AccountsInfo.DateOfDeletion));
  end;
  
  if( ValType(AccountsInfo.DefaultARMNo) != V_UNDEF )
[ ®¬¥à €Œ ¯® ã¬®«ç ­¨î ¤«ï áç¥â  (DefaultARMNo): ##](AccountsInfo.DefaultARMNo);
  end;
  
  if( CheckObjectElem(AccountsInfo, "AccIntradayRestrictions") )
    PrintAccIntradayRestrictions( AccountsInfo );
  end;
 
    PrintBalanceSweepingAccount( AccountsInfo );
    PrintLimitsInfo( AccountsInfo );
    PrintAuthorizedClaimAuthors( AccountsInfo );
    PrintArrestsInfo(AccountsInfo);
    
end;

private macro PrintAccountsInfo( ED808MessageFields : TED808MessageFields )
  if( not CheckObjectElem(ED808MessageFields, "ParticipantProfile.AccountsInfo") )
    return;
  end;
  var i = 0;
  
  while( i < ED808MessageFields.ParticipantProfile.AccountsInfo.size )
    PrintSingleAccountInfo(ED808MessageFields.ParticipantProfile.AccountsInfo[i]);
    i = i + 1;
  end;

end;


macro PrintForm( addrMes, MassCopy )
  var stat = false;
  var FileDirectory = Bnk_GetTxtFileDir();
  var XmlObj : object = ActiveX("Microsoft.XMLDOM");   

  SetBuff( wlmes, addrMes );
  
  FILE MsgTmpFile() txt;
  var MsgTmpFileName, OldName;
  
  // ¥à¥­ ¯à ¢«ï¥¬ ¢ë¢®¤ á®®¡é¥­¨ï ¢ ä ©«, çâ®¡ë ¯à¨ ¬­®£®ªà â­®© ¯¥ç â¨ ¨á¯®«ì§®¢ âì ¤ ­­ë¥
  //------------------------------------------ 
  MsgTmpFileName = GetTxtFileName("tmpmsprn");
  OldName = SetOutPut( MsgTmpFileName );

  if( not open(MsgTmpFile, MsgTmpFileName) )
    std.msg( String("” ©« ­¥ ®âªàëâ:", "|", MsgTmpFileName) );
    return FALSE;
  end;

  var ImageID = 0;
  var sWlMesID : string = makeObjectID( OBJTYPE_MES, null, wlmes );

  ImageID = Bnk_GetImageID( OBJTYPE_MES, sWlMesID, WLD_MES_IMGTYPE_XML_FILE );

  if( ImageID )
    /* ‡ ¯¨áë¢ ¥¬ ¯à¨ªà¥¯«¥­­ë© ED808 ¢® ¢à¥¬¥­­ë© XML-ä ©« */
    var tmpXMLFileName = FileDirectory + "\\" + wlmes.TRN + ".xml";
    stat = WEB_ShowImageByID( ImageID, tmpXMLFileName );
    if( not stat )
      XmlObj = null;
    else
      if ( not XmlObj.load( tmpXMLFileName ) )
        std.msg( "¥¢¥à­ë© ä®à¬ â á®®¡é¥­¨ï" );
        return FALSE;
      end;
    end;
    /* “¤ «ï¥¬ ¢à¥¬¥­­ë© XML-ä ©« á ED808 */
    RemoveFile( tmpXMLFileName );
  else
    XmlObj = null;
  end;

  var ED808MessageFields = TED808MessageFields();

  ReadED808MessageFields( @ED808MessageFields, XmlObj );

  PrintTableInfo( ED808MessageFields );
  PrintTableElements( ED808MessageFields );
  PrintParticipantProfile( ED808MessageFields );
  PrintParticipantAttributes( ED808MessageFields );
  PrintAccountList( ED808MessageFields );
  PrintAccountsInfo( ED808MessageFields );

  // ¥à¥­ ¯à ¢«ï¥¬ ¢ë¢®¤ ®¡à â­®
  //------------------------------------------
  SetOutPut( OldName, true ); 
  while( MassCopy != 0 )
    rewind( MsgTmpFile );
    while( next(MsgTmpFile) )
      println( MsgTmpFile.str );
    end;
    MassCopy = MassCopy - 1;
  end;
  close( MsgTmpFile ); 

  return true;                                                               

  OnError(er)
    ExeptionMessage(er);
    return false;
end;
