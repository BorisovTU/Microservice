 /*
 $Name: wlingdoc.mac
 $Module: МБР
 $Description: Печать отчета сканирования принятых необработанных сообщений
 */

/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*  Печать отчета сканирования принятых необработанных сообщений            */
/*                                                                          */
/*  Имя файла: wlingdoc.mac                                                 */
/*  Создан:    28.04.00                                     Алешин А.В.     */
/****************************************************************************/

import "wldoc.mac";

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов,firstdoc,Статус,Сообщение )
  var stat;

  Record wlmesRecord("WLMES.DBT");
  
  setbuff( wlmesRecord, firstdoc );

  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповой обработке ответных сообщений                              ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+-----------------------------+------+------------------------------------------------------------+];
    [|        Номер                |Номер |                 Сообщение                                  |];
    [|      сообщения              |ошибки|                                                            |];
    [+-----------------------------+------+------------------------------------------------------------+];
  elif( Вызов == Ошибка )
    if( Статус == 0 )
      Сообщение = "Учетные объекты по сообщению успешно сформированы";
    elif( Статус == 6569 )
      Статус = 0;
      Сообщение = GetErrMsg();
    elif( Статус == 531 )
      Сообщение = "Учетные объекты по сообщению успешно сформированы. При выполнении операции возникли ошибки";

    end;
    [|#############################|######|############################################################|](wlmesRecord.TRN,Статус,StrSubst(Сообщение, "|", " "):w );
         elif (Вызов==Последний)
    [+-----------------------------+------+------------------------------------------------------------+];
  end;

end;