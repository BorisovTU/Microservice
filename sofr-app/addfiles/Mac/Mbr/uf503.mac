/*
  $Name:         uf503.mac
  $Module:       МБР
  $Description:  Функции для сообщений ED503
*/
import "wllog.mac", "bnk_common.mac", fileop, rsexts;

PRIVATE FILE txt_file() txt write;

macro ImportED503(ImportFileName : string, node:object)

  var directory = Bnk_GetRegistryValue("МЕЖБАНКОВСКИЕ РАСЧЕТЫ\\УФЭБС\\ED501\\ED503_Directory", V_STRING, "..\\import\\ufbs\\ED503");
  var name, ext;
  SplitFile(ImportFileName, name, ext);
  var fn = directory + "\\" + name + ext;
  MakeDir(directory);

  if(open(txt_file, fn ))
    insert(txt_file,  node.xml);
    close(txt_file);
  else
    std.msg( "Ошибка записи файла " + fn );
  end;  


  std.msg( "Предупреждение: Сообщение ED503 должно быть загружено по транспорту SWIFT. Файл " + name + ext + " перенесен в " + fn );
end;