/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                  Подсистема "Межбанковские расчеты"                      */
/*                  Формирование имени файла референсом                     */
/*                                                                          */
/*  Имя файла: mnsref.mac                                                   */
/*  Создан:  14.04.08                                            Попова О.  */
/****************************************************************************/

import "wldoc.mac", "wlmnstls.mac", CTInter;

macro GetFileName( SeqValue, ObjKind, ObjAddr )
  var FormatFile : integer = WLD_FORMAT_TXT;

  record Sess(wlsess);
  if(ObjKind == OBJTYPE_SESS)
    SetBuff(Sess, ObjAddr);
    FormatFile = GetFormatFileBySess(Sess);
  end;

  var Ext : string = ".txt";
  if(FormatFile == WLD_FORMAT_XML)
    Ext = ".xml";
  end;

  return string( YYYYMMDD( date() ), SeqValue:6:o ) + Ext;

end;


