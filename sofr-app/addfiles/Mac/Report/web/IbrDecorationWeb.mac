/*
$Name: IbrDecorationWeb.mac
$Module: Отчеты банка
$Description: Транспортный класс декораций (группы\вкладки) для веб-интефрейса
*/

/**
 * Класс декораций (вкладки,группы)
 * Транспортный класс, для веб-интефрейса
 */
class TIbrDecorationWeb()

    /**
     * Идентификатор
     */
    var identifierDecoration: Integer = 0;

    /**
     * Идентификатор родителя
     */
    var identifierParent: Integer = 0;

    /**
     * Идентификатор отчета
     */
    var identifierReport: Integer = 0;

    /**
     * Тип
     */
    var type: Integer = 0;

    /**
     * Наименование
     */
    var name: String = "";

    /**
     * Порядок сортировки
     */
    var sortWeight: Integer = 0;

    /**
     * Признак пользовательской декорации
     */
    var isUser: Bool = FALSE;

    /**
     * Список полей
     */
    var fieldList: TArray = TArray();

    /**
     * Список дочерних элементов
     * TArray of TIbrDecorationWeb
     */
    var children: TArray = TArray();

    /**
     * Отчет
     */
    var report: Object = NULL;

    /**
     * Заполнить занчениями из источника данных
     *
     * @dataSet Object Набор данных
     */
    macro initialize(dataSet: Object)

        if (isUser == NULL)

            throw_web(TIbrUndefinedValueException("TIbrDecorationWeb::initialize", "dataSet"));

        end;

        execExp("TIbrDecoration().initialize(this, dataSet)");

    end;

    /**
     * Установить порядок сортировки
     *
     * @param sortWeightParameter Integer Порядок сортировки
     *
     * @return True, если порядок сортировки изменён успешно, иначе - False.
     */
    macro setSortWeight(sortWeightParameter: Integer): Bool

        if (TIbrSystem.isNullOrEmpty(sortWeightParameter))

            throw_web(TIbrIncorrectParameterException("TIbrDecorationWeb::setSortWeight"));

        end;

        return execExp("TIbrDecoration().setSortWeight(this, sortWeightParameter)");

    end;

    /**
     * Удаление декорации (вкладки, группы)
     *
     * @return True, если операция удалена, иначе - False
     */
    macro delete(): Bool

        return execExp("TIbrDecoration().delete(this)");

    end;

    macro toString()
        var s = "Decoration: "
                        + String(identifierDecoration)
                + " - " + String(identifierReport)
                + " - " + String(type)
                + " - " + String(name)
                + " - " + String(sortWeight)
                + " - " + String(isUser)
                ;
        qsort(fieldList, "cmpIbrObj");
        for (var d, fieldList)
            s = s + "\n" + String(d);
        end;
        qsort(children, "cmpIbrObj");
        for (var e, children)
            s = s + "\n" + String(e);
        end;
        return s;
    end;
end;
