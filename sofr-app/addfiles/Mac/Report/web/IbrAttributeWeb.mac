/*
$Name: IbrAttributeWeb.mac
$Module: Отчеты банка
$Description: Транспортный класс атрибута поля для веб-интефрейса
*/

/**
 * Класс атрубита поля
 * Транспортный класс, для веб-интефрейса
 */
class TIbrAttributeWeb()

    /**
     * Идентификатор
     */
    var identifierAttribute: Integer = 0;

    /**
     * Идентификатор поля
     */
    var identifierField: Integer = 0;

    /**
     * Наименование
     */
    var nameParameter: String = "";

    /**
     * Значение
     */
    var valueParameter: String = "";

    /**
     * Признак пользовательского атрибута
     */
    var isUser: Bool = FALSE;

    /**
     * Поле
     */
    var field: Object = NULL;

    /**
     * Заполнить занчениями из источника данных
     *
     * @dataSet TRsbDataSet Набор данных
     */
    macro initialize(dataSet: Object)

        if (dataSet == NULL)

            throw_web(TIbrUndefinedValueException("TIbrAttributeWeb::initialize", "dataSet"));

        end;

        /**
         * Константы
         */
        var constantColumn: Object = TIbrConstant().attribute.column;

        identifierAttribute = execExp("dataSet." + constantColumn.IDENTIFIER_ATTRIBUTE);
        identifierField     = execExp("dataSet." + constantColumn.IDENTIFIER_FIELD);
        nameParameter       = execExp("dataSet." + constantColumn.NAME_PARAMETER);
        valueParameter      = execExp("dataSet." + constantColumn.VALUE_PARAMETER);
        TIbrSystem.rslBoolean(execExp("dataSet." + constantColumn.IS_USER));

    end;

    /**
     * Удаление атрибута
     *
     * @return True, если атрибут удален, иначе - False
     */
    macro delete(): Bool

        return execExp("TIbrAttribute().delete(this)");

    end;

    macro toString()
        var s = "Attribute: "
                        + String(identifierAttribute)
                + " - " + String(identifierField)
                + " - " + String(nameParameter)
                + " - " + String(valueParameter)
                + " - " + String(isUser)
                ;
        return s;
    end;
end;
