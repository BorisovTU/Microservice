/*
$Name: IbrOperationWeb.mac
$Module: Отчеты банка
$Description: Транспортный класс операции для веб-интефрейса
*/

/**
 * Класс операций отчета
 * Транспортный класс, для веб-интефрейса
 */
class TIbrOperationWeb()

    /**
     * Идентификатор
     */
    var identifierOperation: Integer = 0;

    /**
     * Тип
     */
    var type: Integer = 0;

    /**
     * Наименование
     */
    var name: String = "";

    /**
     * Макрофайл
     */
    var macroFile: String = "";

    /**
     * Сервис выполнения операции
     */
    var serviceOperation: String = "";

    /**
     * Описание
     */
    var description: String = "";

    /**
     * Порядок сортировки
     */
    var sortWeight: Integer = 0;

    /**
     * Признак пользовательской операции
     */
    var isUser: Bool = FALSE;

    /**
     * Отчет
     */
    var report: Object = NULL;

    /**
     * Заполнить занчениями из источника данных
     *
     * @dataSet Object Набор данных
     */
    macro initialize(dataSet: Object)

        if (isUser == NULL)

            throw_web(TIbrUndefinedValueException("TIbrOperationWeb::initialize", "dataSet"));

        end;

        execExp("TIbrOperation().initialize(this, dataSet)");

    end;

    /**
     * Установить порядок сортировки
     *
     * @param sortWeightParameter Integer Порядок сортировки
     *
     * @return True, если порядок сортировки изменён успешно, иначе - False.
     */
    macro setSortWeight(sortWeightParameter: Integer): Bool

        if (sortWeightParameter == NULL)

            throw_web(TIbrIncorrectParameterException("TIbrOperationWeb::setSortWeight", "sortWeightParameter"));

        end;

        return execExp("TIbrOperation().setSortWeight(this, sortWeightParameter)");

    end;

    /**
     * Удаление операции
     *
     * @return True, если операция удалена, иначе - False
     */
    macro delete(): Bool

        return execExp("TIbrOperation().delete(this)");

    end;

    /**
     * Изменить параметры операции
     *
     * @param newOperationWeb TIbrOperationWeb Новые параметры операции
     *
     * @return TRUE, если значения изменены успешно, иначе - FASLE
     */
    macro update(newOperationWeb: TIbrOperationWeb): Bool

        return execExp("TIbrOperation().update(this, newOperationWeb)");

    end;

end;
