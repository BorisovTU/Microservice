/*
$Name: IbrConstructorFacade.mac
$Module: Отчеты банка
$Description: Фасад для работы с конструктором отчетов
*/

import lib_lang;
import rep_lib;
import ReportInter;

import IbrConstructorReport;
import IbrConstructorOperation;
import IbrConstructorTab;
import IbrConstructorGroup;
import IbrConstructorField;
import IbrConstructorAttribute;

/**
 * Фасад для работы с конструктором отчетов
 */
class TIbrConstructorFacade()

    /**
     * Константы тегов
     */
    private var tag: Object = TIbrConstant().attribute.tag;

    /**
     * Типы полей
     */
    private var type: Object = TIbrConstant().field.type;

    /**
     * Справочник llvalues
     */
    private var llvalues: Object = TIbrConstant().llvalues;

    private var fieldsOrder;

    macro resetFieldsOrder()
        fieldsOrder = 1;
    end;

    /**
     * Создать отчет
     *
     * @param name            String   Наименование
     * @param nameDisplayed   String   Отображаемое наименование
     * @param macroFile       String   Макрофайл сервисов
     * @param serviceExecute  String   Сервис выполнения
     * @param serviceValidate String   Сервис проверки
     * @param user            TIbrUser Признак пользовательского отчета (необязательное, по умолчанию TRUE).
     *
     * @result TIbrConstructorReport Объект конструктора отчета
     */
    macro createReport
    (
        name:            String,
        nameDisplayed:   String,
        macroFile:       String,
        serviceExecute:  String,
        serviceValidate: String,
        user:            TIbrUser
    ): Object

        /**
         * Результат - объект конструктора отчета
         */
        var result: Object = NULL;

        user = NVL(user, TIbrUser());

        result = TIbrConstructorReport
        (
            name,
            nameDisplayed,
            macroFile,
            serviceExecute,
            serviceValidate,
            user.getUser()
        );

        return result;

    end;

    /**
     * Создать операцию
     *
     * @param type        Integer  Тип (TIbrConstant.operation.type)
     * @param name        String   Наименование
     * @param macroFile   String   Макрофайл сервисов
     * @param service     String   Сервис операции
     * @param description String   Описание (подсказка)
     * @param sortWeight  Integer  Порядок сортировки
     * @param user        TIbrUser Признак пользовательской операции
     *
     * @result TIbrConstructorOperation Объект конструктора операции
     */
    macro createOperation
    (
        type:        Integer,
        name:        String,
        macroFile:   String,
        service:     String,
        description: String,
        sortWeight:  Integer,
        user:        TIbrUser
    ): Object

        /**
         * Результат - объект конструктора операции
         */
        var result: Object = NULL;

        user = NVL(user, TIbrUser());

        result = TIbrConstructorOperation
        (
            type,
            name,
            macroFile,
            service,
            description,
            sortWeight,
            user.getUser()
        );

        return result;

    end;

    /**
     * Создать вкладку
     *
     * @param name       String   Наименование
     * @param sortWeight Integer  Порядок сортировки
     * @param user       TIbrUser Признак пользовательской вкладки (необязательное, по умолчанию TRUE)
     *
     * @result TIbrConstructorTab Объект вкладки
     */
    macro createTab(name: String, sortWeight: String, user: TIbrUser): Object

        /**
         * Результат - объект конструктора вкладки
         */
        var result: Object = NULL;

        user = NVL(user, TIbrUser());

        result = TIbrConstructorTab(name, sortWeight, user.getUser());

        return result;

    end;

    /**
     * Создать группировку
     *
     * @param name       String   Наименование
     * @param sortWeight Integer  Порядок сортировки
     * @param user       TIbrUser Признак пользовательской группировки (необязательное, по умолчанию TRUE)
     *
     * @result TIbrConstructorGroup Объект группировки
     */
    macro createGroup(name: String, sortWeight: String, user: TIbrUser): Object

        /**
         * Результат - объект конструктора группировки
         */
        var result: Object = NULL;

        user = NVL(user, TIbrUser());

        result = TIbrConstructorGroup(name, sortWeight, user.getUser());

        return result;

    end;

    /**
     * Создать декорацию, которая позволяет размещать поля
     * непосредственно на вкладке или панели, если вкладка не отображается.
     *
     * @param sortWeight Integer Порядок сортировки
     * @param user TIbrUser Признак пользовательской группировки (необязательное, по умолчанию TRUE)
     *
     * @result TIbrConstructorGroup Объект группировки
     */
    macro createNotGroup(sortWeight: String, user: TIbrUser): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        user = NVL(user, TIbrUser());

        result = TIbrConstructorGroup
        (
            TIbrConstant.decoration.group.NOT_GROUP,
            sortWeight,
            user.getUser()
        );

        return result;

    end;

    /**
     * Создать текстовое поле
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Признак отображения кнопки очистки значения (необязательное, по умолчанию - FALSE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldText
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат (поле)
         */
        var result: Object = NULL;

        sortWeight           = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        isClearButtonVisible = NVL(isClearButtonVisible, FALSE);
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.TEXT));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле выпадающего списка
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса
     * @param nameService          String       Наименование сервиса
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Признак отображения кнопки очистки значения (необязательное, по умолчанию - FALSE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldComboBox
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        selectNoneText:       String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат (поле)
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, FALSE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,                   label));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,              nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,            nameService));
        result.add(TIbrConstructorAttribute(tag.ENABLE,                  enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,                 visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,             required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));
        result.add(TIbrConstructorAttribute(tag.SELECT_NONE_TEXT,        selectNoneText));
        result.add(TIbrConstructorAttribute(tag.TYPE,                    type.COMBOBOX));

        return result;

    end;

    /**
     * Создать поле-флажок
     *
     * @param nameField           String       Наименование поля
     * @param label               String       Метка поля (контрола)
     * @param valueBooleanDefault Bool         Значение по умолчанию
     * @param nameMacro           String       Наименование макроса (необязательное)
     * @param nameService         String       Наименование сервиса (необязательное)
     * @param sortWeight          Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable              TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible             TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required            TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldCheckBox
    (
        nameField:           String,
        label:               String,
        valueBooleanDefault: Bool,
        nameMacro:           String,
        nameService:         String,
        sortWeight:          Integer,
        enable:              TIbrEnable,
        visible:             TIbrVisible,
        required:            TIbrRequired,
        user:                TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueBooleanDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.CHECKBOX));

        return result;

    end;

    /**
     * Создать поле даты
     *
     * @param nameField               String       Наименование поля
     * @param label                   String       Метка поля (контрола)
     * @param valueDateDefault        Date         Значение по умолчанию
     * @param nameMacro               String       Наименование макроса (необязательное)
     * @param nameService             String       Наименование сервиса (необязательное)
     * @param sortWeight              Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable                  TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible                 TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required                TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user                    TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isCalendarButtonVisible Bool         Отображение кнопки календаря (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible    Bool         Отображение кнопки очистки (необязательное, по умолчанию - TRUE)
     * @param isSelectOnly            Bool         Признак возможности выбрать только из календаря (необязательное, по умолчанию - FALSE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldDate
    (
        nameField:               String,
        label:                   String,
        valueDateDefault:        Date,
        nameMacro:               String,
        nameService:             String,
        sortWeight:              Integer,
        enable:                  TIbrEnable,
        visible:                 TIbrVisible,
        required:                TIbrRequired,
        user:                    TIbrUser,
        isCalendarButtonVisible: Bool,
        isClearButtonVisible:    Bool,
        isSelectOnly:            Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isCalendarButtonVisible = NVL(isCalendarButtonVisible, TRUE);
        isClearButtonVisible    = NVL(isClearButtonVisible,    TRUE);
        isSelectOnly = NVL(isSelectOnly, FALSE);
        sortWeight   = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable       = NVL(enable,       TIbrEnable());
        visible      = NVL(visible,      TIbrVisible());
        required     = NVL(required,     TIbrRequired(true));
        user         = NVL(user,         TIbrUser());
        nameMacro    = NVL(nameMacro,    "");
        nameService  = NVL(nameService,  "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), nvl(valueDateDefault, {curdate}));

        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CALENDAR_BUTTON_VISIBLE, isCalendarButtonVisible));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE,    isClearButtonVisible));
        result.add(TIbrConstructorAttribute(tag.IS_SELECT_ONLY,             isSelectOnly));
        result.add(TIbrConstructorAttribute(tag.TYPE, type.DATE));

        return result;

    end;

    /**
     * Создать поле листалки с произвольным наполнением
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Значение по умолчанию
     * @param nameMacroData        String       Наименование макроса получения данных
     * @param nameServiceData      String       Наименование сервиса получения данных
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Отображение кнопки очистки (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldList
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacroData:        String,
        nameServiceData:      String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);

        result.add(TIbrConstructorAttribute(tag.LABEL,                   label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,                  enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,                 visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,             required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,              nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,            nameService));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO_DATA,         nameMacroData));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE_DATA,       nameServiceData));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));
        result.add(TIbrConstructorAttribute(tag.TYPE,                    type.LIST));

        return result;

    end;

    /**
     * Создать поле по справочнику llvalues
     *
     * @param nameField     String       Наименование поля
     * @param label         String       Метка поля (контрола)
     * @param valueDefault  Variant      Либо элемент (t_element), либо наименование (t_name) структуры по справочнику llvalues
     * @param classificator Integer      Классификатор
     * @param nameMacro     String       Наименование макроса (необязательное)
     * @param nameService   String       Наименование сервиса (необязательное)
     * @param sortWeight    Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable        TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible       TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required      TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user          TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldLlValues
    (
        nameField:     String,
        label:         String,
        valueDefault:  Variant,
        classificator: Integer,
        list:          Integer,
        nameMacro:     String,
        nameService:   String,
        sortWeight:    Integer,
        enable:        TIbrEnable,
        visible:       TIbrVisible,
        required:      TIbrRequired,
        user:          TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

       /**
         * Элемент структуры по справочнику llvalues
         */
        var elementStructure: Integer = 0;
        
        if ((list == 0) or ( ValType( list ) == V_UNDEF ))

            list = TIbrCommon().getIdentifierLlValues(classificator);   

        else 

            classificator = 0;

        end;
  
        if (valType(valueDefault) == V_STRING)

            elementStructure = rcbWebCommon_getKeyFromValueList
            (
                FALSE, // признак использования справочника nameAlg
                list,
                valueDefault
            );

        else

            if (valType(valueDefault) == V_INTEGER)

                elementStructure = valueDefault;

            else

                elementStructure = 0;

            end;
        end;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), elementStructure);

        result.add(TIbrConstructorAttribute(tag.LABEL,         label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,        enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,       visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,   required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.LIST,          list));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,    nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,  nameService));
        result.add(TIbrConstructorAttribute(tag.CLASSIFICATOR, classificator));
        result.add(TIbrConstructorAttribute(tag.TYPE,          type.LIST_LLVALUES));

        return result;

    end;

    /**
     * Создать поле по справочнику nameAlg
     *
     * @param nameField     String       Наименование поля
     * @param label         String       Метка поля (контрола)
     * @param valueDefault  Variant      Либо номер (t_iNumberAlg), либо наименование (t_szNameAlg) структуры по справочнику nameAlg
     * @param typeAlgorithm Integer      Идентификатор справочника (t_iTypeAlg)
     * @param nameMacro     String       Наименование макроса (необязательное)
     * @param nameService   String       Наименование сервиса (необязательное)
     * @param sortWeight    Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable        TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible       TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required      TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user          TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldNameAlg
    (
        nameField:     String,
        label:         String,
        valueDefault:  Variant,
        typeAlgorithm: Integer,
        nameMacro:     String,
        nameService:   String,
        sortWeight:    Integer,
        enable:        TIbrEnable,
        visible:       TIbrVisible,
        required:      TIbrRequired,
        user:          TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        /**
         * Элемент структуры по справочнику llvalues
         */
        var numberAlgorithm: Integer = 0;

        if (valType(valueDefault) == V_STRING)

            numberAlgorithm = rcbWebCommon_getKeyFromValueList
            (
                TRUE, // признак использования справочника nameAlg
                typeAlgorithm,
                valueDefault
            );

        else

            if (valType(valueDefault) == V_INTEGER)

                numberAlgorithm = valueDefault;

            else

                numberAlgorithm = 0;

            end;
        end;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), numberAlgorithm);

        result.add(TIbrConstructorAttribute(tag.LABEL,          label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,         enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,        visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,    required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE_ALGORITHM, typeAlgorithm));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,     nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,   nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,           type.LIST_NAME_ALG));

        return result;

    end;

    /**
     * Создать поле подразделения
     *
     * @param nameField           String       Наименование поля
     * @param label               String       Метка поля (контрола)
     * @param value               Variant      Код (String) или id (Integer) подразделения. При передаче id он перобразуется в код
     * @param nameMacro           String       Наименование макроса (необязательное)
     * @param nameService         String       Наименование сервиса (необязательное)
     * @param sortWeight          Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param departmentMode      Integer      Режим подразделения (необязательное, по умолчанию - по территориальной и региональной структурах)
     * @param enable              TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible             TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required            TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user                TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldDepartment
    (
        nameField:           String,
        label:               String,
        value:               Variant,
        nameMacro:           String,
        nameService:         String,
        sortWeight:          Integer,
        departmentMode:      Integer,
        enable:              TIbrEnable,
        visible:             TIbrVisible,
        required:            TIbrRequired,
        user:                TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        sortWeight     = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        departmentMode = NVL(departmentMode, ternary(isRegionalStructureUsed(), TIbrConstant().departmentMode.BOTH, TIbrConstant().departmentMode.TERRITORIAL));

        value = nvl(value, {OperDprt});

        // Передали id узла ТС
        if (valType(value) == V_INTEGER)
            value = getDepartmentCode(value);
        end;

        var valueDefault: TIbrValueWeb = TIbrValueWeb
        (
            0,
            value,
            NULL,
            NULL,
            NULL,
            TRUE
        );

        enable      = NVL(enable,   TIbrEnable());
        visible     = NVL(visible,  TIbrVisible());
        required    = NVL(required, TIbrRequired(true));
        user        = NVL(user,     TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField
        (
            nameField,
            sortWeight,
            user.getUser(),
            valueDefault
        );
        result.add(TIbrConstructorAttribute(tag.LABEL,           label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,          enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,         visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,     required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,            type.DEPARTMENT));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,      nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,    nameService));
        result.add(TIbrConstructorAttribute(tag.DEPARTMENT_MODE, departmentMode));

        return result;

    end;

    /**
     * Создать поле структуры
     *
     * @param nameField    String       Наименование поля
     * @param label        String       Метка поля (контрола)
     * @param valueDefault Variant      Либо элемент (t_element), либо наименование (t_name) структуры по справочнику llvalues
     * @param nameMacro    String       Наименование макроса (необязательное)
     * @param nameService  String       Наименование сервиса (необязательное)
     * @param sortWeight   Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable       TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible      TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required     TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user         TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldStructure
    (
        nameField:            String,
        label:                String,
        valueDefault:         Variant,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        /**
         * Элемент структуры по справочнику llvalues
         */
        var elementStructure: Integer = 0;

        if (valType(valueDefault) == V_STRING)
            elementStructure = rcbWebCommon_getKeyFromValueList
            (
                FALSE, // признак использования справочника nameAlg
                TIbrConstant().llvalues.STRUCTURE,
                valueDefault
            );
        else
            if (valType(valueDefault) == V_INTEGER)
                elementStructure = valueDefault;
            else
                REP_GetDefaultParmTS(elementStructure);
            end;
        end;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired(true));
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), elementStructure);
        result.add(TIbrConstructorAttribute(tag.LABEL,         label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,        enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,       visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,   required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,          type.LIST_LLVALUES));
        result.add(TIbrConstructorAttribute(tag.CLASSIFICATOR, 0));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,    nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,  nameService));
        result.add(TIbrConstructorAttribute(tag.LIST,          llvalues.STRUCTURE));

        return result;

    end;

    /**
     * Создать поле режима выпуска
     *
     * @param nameField    String       Наименование поля
     * @param label        String       Метка поля (контрола)
     * @param valueDefault Variant      Либо элемент (t_element), либо наименование (t_name) режима по справочнику llvalues
     * @param nameMacro    String       Наименование макроса (необязательное)
     * @param nameService  String       Наименование сервиса (необязательное)
     * @param sortWeight   Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable       TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible      TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required     TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user         TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldIssueMode
    (
        nameField:            String,
        label:                String,
        valueDefault:         Variant,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        /**
         * Элемент режима по справочнику llvalues
         */
        var elementIssueMode: Integer = 0;

        if (valType(valueDefault) == V_STRING)
            elementIssueMode = rcbWebCommon_getKeyFromValueList
            (
                FALSE, // признак использования справочника nameAlg
                TIbrConstant().llvalues.ISSUE_MODE,
                valueDefault
            );
        else
            if (valType(valueDefault) == V_INTEGER)
                elementIssueMode = valueDefault;
            else
                var dummy;
                REP_GetDefaultParmTS(dummy, elementIssueMode);
            end;
        end;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired(true));
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), elementIssueMode);
        result.add(TIbrConstructorAttribute(tag.LABEL,         label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,        enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,       visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,   required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.LIST,          llvalues.ISSUE_MODE));
        result.add(TIbrConstructorAttribute(tag.CLASSIFICATOR, 0));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,    nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,  nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,          type.LIST_LLVALUES));

        return result;

    end;

    /**
     * Создать поле плана счетов
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Признак отображения кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldChartOfAccounts
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired(true));
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.CHART_OF_ACCOUNTS));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле глав счетов
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - TRUE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Отображение кнопки очистки (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldAccountChapters
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired(true));
        user        = NVL(user,        TIbrUser());

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,                   label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,                  enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,                 visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,             required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,              nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,            nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,                    type.ACCOUNT_CHAPTERS));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле валюты
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param value                Variant      Код (String) или id (Integer) финансового инструмента. Код преобразуется в id
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Видимость кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldCurrency
    (
        nameField:            String,
        label:                String,
        value:                Variant,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        /**
         * Описание
         */
        var identifierFinancialInstrument: Integer = TIbrConstant().system.NONE;

        if (valtype(value) == V_STRING)
            identifierFinancialInstrument = TIbrCommon().getIdentifierFinancialInstrument(value);
        elif (valtype(value) == V_INTEGER)
            identifierFinancialInstrument = value;
        else
            // do nothing
        end;

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), identifierFinancialInstrument);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.CURRENCY));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле клиента
     *
     * @param nameField    String       Наименование поля
     * @param label        String       Метка поля (контрола)
     * @param valueDefault Variant      Либо идентификатор (t_partyid), либо короткое наименование (t_shortname) клиента
     * @param nameMacro    String       Наименование макроса (необязательное)
     * @param nameService  String       Наименование сервиса (необязательное)
     * @param sortWeight   Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable       TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible      TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required     TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user         TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldClient
    (
        nameField:    String,
        label:        String,
        valueDefault: Variant,
        nameMacro:    String,
        nameService:  String,
        sortWeight:   Integer,
        enable:       TIbrEnable,
        visible:      TIbrVisible,
        required:     TIbrRequired,
        user:         TIbrUser
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        /**
         * Идентификатор клиента
         */
        var identifierParty: Integer = TIbrConstant().system.NONE;

        if (valType(valueDefault) == V_STRING)

            identifierParty = TIbrCommon().getIdentifierParty(valueDefault);

        else

            if (valType(valueDefault) == V_INTEGER)

                identifierParty = valueDefault;

            else

                identifierParty = TIbrConstant().system.NONE;

            end;
        end;

        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), identifierParty);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.CLIENT));

        return result;

    end;

    /**
     * Создать поле операциониста
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueDefault         Variant      Либо идентификатор (t_oper), либо наименование (t_name) операциониста
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Видимость кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldUser
    (
        nameField:            String,
        label:                String,
        valueDefault:         Variant,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        /**
         * Идентификатор операциониста
         */
        var identifierUser : Integer = 0;

        if (valType(valueDefault) == V_STRING)
            identifierUser = TIbrCommon().getIdentifierUser(valueDefault);
        else
            if (valType(valueDefault) == V_INTEGER)
                identifierUser = valueDefault;
            else
                identifierUser = {oper};
            end;
        end;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), identifierUser);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.USER));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле балансового счета
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param numberPlan           Integer      Номер плана счетов
     * @param chapter              Integer      Глава плана счетов
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Видимость кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldBalance
    (
        nameField:            String,
        label:                String,
        numberPlan:           Integer,
        chapter:              Integer,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        numberPlan  = NVL(numberPlan,  0);
        chapter     = NVL(chapter,     1);
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.BALANCE));
        result.add(TIbrConstructorAttribute(tag.NUMBER_PLAN,  numberPlan));
        result.add(TIbrConstructorAttribute(tag.CHAPTER,      chapter));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле лицевого счета
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Отображение кнопки очистки (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldAccount
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.ACCOUNT));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле по справочнику typeAc
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param numberType           Integer
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     * @param isOperationVisible   Bool         Отображение списка операций (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldTypeAc
    (
        nameField:            String,
        label:                String,
        numberType:           Integer,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool,
        isOperationVisible:   Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        sortWeight           = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        isOperationVisible   = NVL(isOperationVisible,   TRUE);
        enable               = NVL(enable,               TIbrEnable());
        visible              = NVL(visible,              TIbrVisible());
        required             = NVL(required,             TIbrRequired());
        user                 = NVL(user,                 TIbrUser());
        nameMacro            = NVL(nameMacro,            "");
        nameService          = NVL(nameService,          "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,                   label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,                  enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,                 visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,             required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NUMBER_TYPE,             numberType));
        result.add(TIbrConstructorAttribute(tag.TYPE,                    type.TYPE_AC));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,              nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,            nameService));
        result.add(TIbrConstructorAttribute(tag.IS_OPERATION_VISIBLE,    isOperationVisible));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле сортировки
     *
     * @param nameField            String       Наименование поля
     * @param label                String       Метка поля (контрола)
     * @param valueStringDefault   String       Строковое значение по умолчанию
     * @param classificator        Integer      Классификатор справочника
     * @param nameMacro            String       Наименование макроса (необязательное)
     * @param nameService          String       Наименование сервиса (необязательное)
     * @param sortWeight           Integer      Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable               TIbrEnable   Доступность (необязательное, по умолчанию - TRUE)
     * @param visible              TIbrVisible  Видимость (необязательное, по умолчанию - TRUE)
     * @param required             TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user                 TIbrUser     Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool         Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldSort
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        classificator:        Integer,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        var list: Integer = TIbrCommon().getIdentifierLlValues(classificator);

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,         label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,        enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,       visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,   required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,          type.SORT));
        result.add(TIbrConstructorAttribute(tag.CLASSIFICATOR, classificator));
        result.add(TIbrConstructorAttribute(tag.LIST,          list));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,    nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,  nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле шифра
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldCipher
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,   TIbrEnable());
        visible     = NVL(visible,  TIbrVisible());
        required    = NVL(required, TIbrRequired());
        user        = NVL(user,     TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,        label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,       enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,      visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,  required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.TYPE,         type.CIPHER));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,   nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE, nameService));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле процентного договора
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldPercentContract
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;
        /**
         * Наименование макроса
         */
        var nameMacroData: String = "";
        /**
         * Наименования сервиса
         */
        var nameServiceData: String = "";

        nameMacroData   = TIbrConstant().service.MACRO_DATA_SOURCE;
        nameServiceData = TIbrConstant().service.SERVICE_GET_PERCENT_CONTRACT;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,             label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,            enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,           visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,       required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO_DATA,   nameMacroData));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE_DATA, nameServiceData));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,        nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,      nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,              type.LIST));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле списка графиков расчета
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldScheduleOfCalculation
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;
        /**
         * Наименование макроса получения данных
         */
        var nameMacroData: String = "";
        /**
         * Наименования сервиса получения данных
         */
        var nameServiceData: String = "";

        nameMacroData   = TIbrConstant().service.MACRO_DATA_SOURCE;
        nameServiceData = TIbrConstant().service.SERVICE_GET_SCHEDULE_OF_CALCULATION;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,             label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,            enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,           visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,       required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO_DATA,   nameMacroData));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE_DATA, nameServiceData));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,        nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,      nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,              type.LIST_DOUBLE));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле списка графиков начисления
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldScheduleOfAccrual
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;
        /**
         * Наименование макроса получения данных
         */
        var nameMacroData: String = "";
        /**
         * Наименования сервиса получения данных
         */
        var nameServiceData: String = "";

        nameMacroData        = TIbrConstant().service.MACRO_DATA_SOURCE;
        nameServiceData      = TIbrConstant().service.SERVICE_GET_SCHEDULE_OF_ACCRUAL;

        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,             label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,            enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,           visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,       required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO_DATA,   nameMacroData));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE_DATA, nameServiceData));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,        nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,      nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,              type.LIST_DOUBLE));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

    /**
     * Создать поле списка графиков оплаты
     *
     * @param nameField String Наименование поля
     * @param label String Метка поля (контрола)
     * @param valueStringDefault String Строковое значение по умолчанию
     * @param nameMacro String Наименование макроса (необязательное)
     * @param nameService String Наименование сервиса (необязательное)
     * @param sortWeight Integer Порядок сортировки (необязательное, по умолчанию - 0)
     * @param enable TIbrEnable Доступность (необязательное, по умолчанию - TRUE)
     * @param visible TIbrVisible Видимость (необязательное, по умолчанию - TRUE)
     * @param required TIbrRequired Обязательность заполнения значения (необязательное, по умолчанию - FALSE)
     * @param user TIbrUser Признак пользовательского поля (необязательное, по умолчанию - TRUE)
     * @param isClearButtonVisible Bool Отображение кнопки очистки значения (необязательное, по умолчанию - TRUE)
     *
     * @return TIbrConstructorField Объект поля
     */
    macro createFieldScheduleOfPayment
    (
        nameField:            String,
        label:                String,
        valueStringDefault:   String,
        nameMacro:            String,
        nameService:          String,
        sortWeight:           Integer,
        enable:               TIbrEnable,
        visible:              TIbrVisible,
        required:             TIbrRequired,
        user:                 TIbrUser,
        isClearButtonVisible: Bool
    ): Object

        /**
         * Результат
         */
        var result: Object = NULL;
        /**
         * Наименование макроса получения данных
         */
        var nameMacroData: String = "";
        /**
         * Наименования сервиса получения данных
         */
        var nameServiceData: String = "";

        nameMacroData   = TIbrConstant().service.MACRO_DATA_SOURCE;
        nameServiceData = TIbrConstant().service.SERVICE_GET_SCHEDULE_OF_PAYMENT;
        isClearButtonVisible = NVL(isClearButtonVisible, TRUE);
        sortWeight  = nvl(sortWeight, fieldsOrder); fieldsOrder = fieldsOrder + 1;
        enable      = NVL(enable,      TIbrEnable());
        visible     = NVL(visible,     TIbrVisible());
        required    = NVL(required,    TIbrRequired());
        user        = NVL(user,        TIbrUser());
        nameMacro   = NVL(nameMacro,   "");
        nameService = NVL(nameService, "");

        result = TIbrConstructorField(nameField, sortWeight, user.getUser(), valueStringDefault);
        result.add(TIbrConstructorAttribute(tag.LABEL,             label));
        result.add(TIbrConstructorAttribute(tag.ENABLE,            enable.getEnable()));
        result.add(TIbrConstructorAttribute(tag.VISIBLE,           visible.getVisible()));
        result.add(TIbrConstructorAttribute(tag.IS_REQUIRED,       required.getRequired()));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO_DATA,   nameMacroData));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE_DATA, nameServiceData));
        result.add(TIbrConstructorAttribute(tag.NAME_MACRO,        nameMacro));
        result.add(TIbrConstructorAttribute(tag.NAME_SERVICE,      nameService));
        result.add(TIbrConstructorAttribute(tag.TYPE,              type.LIST_DOUBLE));
        result.add(TIbrConstructorAttribute(tag.IS_CLEAR_BUTTON_VISIBLE, isClearButtonVisible));

        return result;

    end;

end;
