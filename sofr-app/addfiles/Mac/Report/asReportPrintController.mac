/*
$Name:          asReportPrintController.mac
$Module:        Внутренняя отчетность
$Description:   Выписка. Контроллер печати отчета
*/

/**
 * Выписка. Контроллер печати отчета.
 *
 * @since   29.08.2020
 * @author  MFB
 * @version 6.00.020.31.066
 */

class (RcbReportPrintController) TAccountStatementReportPrintController(isPrintTotalsByDays)

	macro printHeader(accInfo, bankName, isFirstPrint)
		getReportView().printHeader(accInfo, bankName, isFirstPrint);
		m_needShowReport = true;
	end;

    macro printFooter(excelAccInfo, document)
       getReportView().printFooter(excelAccInfo, document);
	   m_needShowReport = true;
    end;

	macro printRow(document)
       getReportView().printRow(document);
	   m_needShowReport = true;
    end;

	macro printEmptyData()
		getReportView().printRow();
		m_needShowReport = true;
	end;

	private macro destructor()
        var view = getReportView();
        //view.printSignatureZone();

        view.resetOutputFile();

        if (m_needShowReport)
            view.show();
        end;
    end;

	macro defineFileName(parameters)
		m_reportView.defineFileName(parameters);
	end;

    private macro constructorTAccountStatementReportPrintController(isPrintTotalsByDays)
        initRcbReportPrintController();

		m_reportView     = objectFactoryInstance.createReportExcelView(m_protocolView, isPrintTotalsByDays);
		m_needShowReport = false;
	end;

    constructorTAccountStatementReportPrintController(isPrintTotalsByDays)
end;
