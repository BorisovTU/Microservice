/**
 * Базовый класс печати отчета в ВО.
 *
 * @since   07.02.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */

import templatePrinter;
import rep_lib;
import repException;

/**
 * Заглушка для совместимости с Windows Reports
 */
class TPrintEngine()
    macro printRep()
    end;

    macro printWinRep();
    end;

    macro showWinRep()
    end;

    macro clearAllStr()
    end;
end;

/**
 * Печать отчета.
 */
class TPrintableView(departmentCode : Integer, orgStructure : Integer, templateName)
    /**
     * Ширина отчета.
     */
    private var m_reportWidth : Integer;
    /**
     * Код подразделения, выпускающего отчет.
     */
    private var m_departmentCode : Integer;
    /**
     * Территориальная/региональная структура.
     */
    private var m_orgStructure : Integer;
    /**
     * Шаблон отчета.
     */
    private var m_printer : TTemplatePrinter;

    /**
     * Установить ширину отчета.
     */
    macro setReportWidth(reportWidth : Integer)
        if (reportWidth < 83)
            m_reportWidth = 83;
        else
            m_reportWidth = reportWidth;
        end;
    end;

    /**
     * Получить ширину отчета.
     */
    macro getReportWidth()
        return m_reportWidth;
    end;

    /**
     * Печать шапки банка.
     */
    macro printBankHead()
        PrintBankHeader(m_departmentCode, m_orgStructure, m_reportWidth);
    end;

    /**
     * Печать шапки самого отчета.
     *
     */
    macro printReportHead()
        throw(TPureVirtualMethodCallException("TPrintableView::printReportHead"));
    end;

    /**
     * Печать шапки отчета.
     *
     */
    macro printHead()
        println();
        printBankHead();
        printReportHead();
    end;

    /**
     * Печать данных отчета.
     *
     */
    macro printData()
        throw(TPureVirtualMethodCallException("TPrintableView::printData"));
    end;

    /**
     * Печатать нулевую содержательную часть отчета.
     */
    macro printNullData()
        println("Данные отсутствуют.");
    end;

    /**
     * Печать подписей.
     */
    macro printSignature()
        throw(TPureVirtualMethodCallException("TPrintableView::endReport"));
    end;

    /**
     *  Пуст ли отчет?
     */
    macro isEmpty()
        throw(TPureVirtualMethodCallException("TPrintableReport::isEmpty"));
    end;

    macro getPrintEngine()
        return TPrintEngine();
    end;

    /**
     * Конструктор.
     */
    private macro constructor(departmentCode : Integer, orgStructure : Integer, templateName)
        m_printer        = TTemplatePrinter(templateName);
        m_departmentCode = departmentCode;
        m_orgStructure   = orgStructure;
    end;

    constructor(departmentCode, orgStructure, templateName);
end;