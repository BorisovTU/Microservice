import CompositeTableField;
import repException;
/**
 * Класс, печати шаблона таблицы.
 */
class TTemplateBuilder(resultFileName : String)
    /**
     * Имя файла с результирующим шаблоном.
     */
    private var m_resultFileName : string;

    /**
     *
     */
    private var m_compositeTableField : TCompositeTableField;

    /**
     * Создание структуры таблицы.
     */
    private macro createCompositeTableField() : TCompositeTableField
        throw(TPureVirtualMethodCallException("TTemplateBuilder::createCompositeTableField"));
    end;

    /**
     * Печать шаблона шапки отчета в файл шаблона.
     */
    private macro printHead()
        throw(TPureVirtualMethodCallException("TTemplateBuilder::printHead"));
    end;

    /**
     * Печать шаблона содержательной части отчета в файл шаблона.
     */
    private macro printData()
        throw(TPureVirtualMethodCallException("TTemplateBuilder::printData"));
    end;

    /**
     * Печать шаблона конца таблицы отчета в файл шаблона.
     */
    private macro printEnd()
        throw(TPureVirtualMethodCallException("TTemplateBuilder::printEnd"));
    end;

    macro createResultFile() : String
        printHead();
        printData();
        printEnd();
        return m_resultFileName;
    end;

    /**
     * Получить имя результирующего файла шаблонов.
     */
    macro getTemplateFileName() : string
        return m_resultFileName;
    end;

    macro getTable() : Object
        return m_compositeTableField;
    end;

    macro constructor(resultFileName : String)
        if (resultFileName == null)
            resultFileName = "resulttpl";
        end;
        m_resultFileName = getTxtFileName(resultFileName);
        createCompositeTableField();
    end;
    constructor(resultFileName);
end;