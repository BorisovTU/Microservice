/* ──────────────────────────────────────────────────────────────────────────┐
  RS-Bank version 5.10                             R-Style Software Lab
  Файл подсистемы "Отчеты ГКБО"

 Данный макрофайл содержит процедуры, предназаченные для определения счетов 
 ОВП и необходимости их вывода в отчеты.

FILENAME: OCP.MAC
CREATED:  06.12.2000 Kasatsky
MODIFICATIONS:
NOTES:
└────────────────────────────────────────────────────────────────────────── */

CONST  PathShowOCP  = "REPORT\\SHOW_OCP"; /* Путь к глобальному рубильнику в настройках */

CONST  TA_OCP = 26;  /* Счет ОВП */

/* Процедура возвращает значение рубильника */
macro FlagOfPrintAccountsOCP
  var err, ShowOCP;
  GetRegistryValue(PathShowOCP,V_BOOL,ShowOCP,err);
  if ( err  ==  7 )
    msgbox( "Не определен ключ "+PathShowOCP+" в настройках банка" );
    ShowOCP = FALSE;
  end;
  return ShowOCP;
end;

/* Процедура ищет счет в файле ас и проверяет, не является ли он счетом ОВП*/
macro IsAccountOCP(ac, Chapter, Account, Code_Currency)
  var err,pos, key, stat;
  key = KeyNum( ac, 0 );
  ac.Chapter = Chapter;
  ac.Account = Account;
  ac.Code_Currency = Code_Currency;
  if ( not getEQ( ac ))
    msgbox( "Счет "+Account+" не существует." );
    KeyNum(ac,key);
    return FALSE;
  end;
  if(Index(ac.Type_Account,"Щ") != 0) stat =  TRUE;
  else stat = FALSE; end;
  KeyNum(ac,key);
  return stat;
end;

/* Процедура определяет счет ОВП по его полю Type_Account */
macro IsAccOCPFromType( Type_Account )
  return Index(Type_Account,"Щ") != 0; 
end;