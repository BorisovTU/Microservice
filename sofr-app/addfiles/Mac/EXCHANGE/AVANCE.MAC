/*-RSL---------------------------------------- R-Style Software Lab --*/
/*---------------- Печать заявки на аванс для совершения -------------*/
/*------------------- операций в обменном пункте ---------------------*/
/*              подсистема Обменный пункт            AV  18.05.97     */

IMPORT ExchangeInter, "sprvfunc.mac";
record t ("trans.str", "exchange.def");

MACRO ПечатьЗаявкиНаАванс( trans )
  setbuff( t, trans );

  AvanceDate = t.DateOper;
  GetDate( AvanceDate, "Дата получения аванса:" );

  var FullName = {ExAddress} + "  Рег.номер " + {ExRegNumber};
[
                           ##################################################
   Выдачу разрешаю:

   ______________________
   (подпись руководителя)                                 Бухгалтерия
                                                                банка
                                 ЗАЯВКА
              НА ПОЛУЧЕНИЕ АВАНСА ДЛЯ СОВЕРШЕНИЯ ОПЕРАЦИЙ
                           В ОБМЕННОМ ПУНКТЕ
                                   #

   ##################################################################

   Прошу выдать мне               #

]( {ExName_Bank}:c:w,
   /*StrAddZeroDate( t.DateOper ):c,*/
   StrAddZeroDate( AvanceDate ):c, /* RA 22-04-99 */
   FullName:w,
   GetFullNameEmployee( t.Emp_Ref ):c
 );

[ 1. Аванс:

];
   Наличные_Рубли( t.ReportType, t.Emp_Ref, t.Sess_Ref );
   Иностранная_Валюта_Прописью( t.ReportType, t.Emp_Ref, t.Sess_Ref  );

[ 2. Бланки платежных документов:];

   ПД_и_Бланки_По_Видам( t.ReportType, t.Emp_Ref, t.Sess_Ref );

print(" 3. ");
   if( t.ReportType == TYPE_AVANCE )
     /*ПачкиБланковБСО( t.Emp_Ref, t.Sess_Ref, АвансПачки );*/
     КоличествоБланковБСО( t.Emp_Ref, t.Sess_Ref, АвансПачки );
     if( Office_Add.UseF31 == SET_CHAR )
        КоличествоБланковF31( t.Emp_Ref, t.Sess_Ref, АвансПачки );
     end;
   elif( t.ReportType == TYPE_ALLAVANCE )
     /*ПачкиБланковБСОАвансЗаСмену( t.Emp_Ref, t.Sess_Ref );*/
     КоличествоБланковБСОАвансЗаСмену( t.Emp_Ref, t.Sess_Ref );
     if( Office_Add.UseF31 == SET_CHAR )
        КоличествоБланковF31АвансЗаСмену( t.Emp_Ref, t.Sess_Ref );
     end;
   end;

[
      Кассир обменного пункта _________________ (             #            )
                                  (подпись)
]( GetFIOEmployee(t.Emp_Ref):c );
end;
