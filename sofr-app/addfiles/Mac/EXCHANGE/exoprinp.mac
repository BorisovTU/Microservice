/*
   ************************************************************************
   Обменный пункт
   Inpoper.mac - Пример макроса контроля ввода операции.
   Copyright 1999 (c) R-Style Software Lab.
   Создание: 17.09.99 by RA

   CheckInputOper - стандартное название функции, вызываемой после заполнения
                    полей панели ввода операции
   OperAddr       - адрес буфера с данными об операции

   Переход к завершению операции осуществится после успешного выхода из макроса
   (возврат TRUE).
   Запрет продолжения операции происходит при возврате значения FALSE.

   Вызов макроса осуществляется после вызова системной процедуры проверки
   правильности ввода операции (контроль задания сумм, валют и т.п. ),
   но перед вводом данных для справки БСО.

   ************************************************************************
*/

IMPORT ExchangeInter, define;

RECORD OperData( "operdata.str", "exchange.def" );

macro CheckInputOper( OperAddr )

  SetBuff( OperData, OperAddr ); /* OperData содержит данные об операции */

  /* схемой 170 от 15.12.2002 с 01 января 2003 г. нидерландские гульдены
     принимаются на инкассо для обмена на евро только в Нидерландах. */
  if( ( OperData.Oper_Ref                     == CDF_OperIncasso ) and
      ( GetISOCurr( OperData.IncomeCurr_Ref ) == "NLG" ) )
    msgbox( "Схемой 170 от 15.12.2002 с 01 января 2003 г. нидерландские гульдены|" +
            "принимаются на инкассо для обмена на евро только в Нидерландах" );
    return FALSE;
  end;
  
  return TRUE; /* успешное завершение */
                        
end;      
          
