/*-RSL---------------------------------------- R-Style Software Lab --
               Обменный пункт / Операционная касса

               Печать сводных ордеров для коммерческих банков
                      ~~~~~~~
               Чтение и запись номера кассового ордера

               RA 21-08-01 Создан
*/

file   Реестр0 ( "reestr.dbt", "exchange.def" ) key 0 write;

MACRO SaveCountToReestr( ТипОборота, CountValue )

  Реестр0.Branch = Реестр.Branch;
  Реестр0.ID     = Реестр.ID;
  GetEQ( Реестр0 );

  if  ( ТипОборота == CDF_TurnIncome     )
    Реестр0.IncomeOrderNumber = CountValue;
  elif( ТипОборота == CDF_TurnOut        )
    Реестр0.OutOrderNumber = CountValue;
  elif( ТипОборота == CDF_TurnCom        )
    Реестр0.ComOrderNumber = CountValue;
  elif( ТипОборота == CDF_TurnTaxWithCom )
    Реестр0.TaxOrderNumber = CountValue;
  elif( ТипОборота == CDF_TurnIncTax     )
    Реестр0.IncTaxOrderNumber = CountValue;
  else
    MsgBox( "Неизвестный тип оборота: ", ТипОборота );
  end;

  if( not( Update( Реестр0 ) ) )
    MsgBox( "Файл reestr.dbt:|" +
            "ошибка обновления записи Branch = ", Реестр0.Branch, 
            " ID = ", Реестр0.ID );
  end;

END;

MACRO GetCountFromReestr( ТипОборота, CountValue )

  if  ( ТипОборота == CDF_TurnIncome     )
    CountValue = Реестр.IncomeOrderNumber;
  elif( ТипОборота == CDF_TurnOut        )
    CountValue = Реестр.OutOrderNumber;
  elif( ТипОборота == CDF_TurnCom        )
    CountValue = Реестр.ComOrderNumber;
  elif( ТипОборота == CDF_TurnTaxWithCom )
    CountValue = Реестр.TaxOrderNumber;
  elif( ТипОборота == CDF_TurnIncTax     )
    CountValue = Реестр.IncTaxOrderNumber;
  else
    MsgBox( "Неизвестный тип оборота: ", ТипОборота );
  end;

  if( CountValue != 0 )
    SetParm( 1, CountValue );
    return True;
  else
    return False;
  end;

END;
