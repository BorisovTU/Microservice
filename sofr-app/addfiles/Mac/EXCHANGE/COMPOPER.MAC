/*
   ************************************************************************
   Обменный пункт
   Compoper.mac - Пример макроса завершения операции.
   Copyright 1997 (c) R-Style Software Lab.
   Создание: 28.11.97 by VD

   CompleteOper - стандартное название функции, вызываемой перед завершением
                  операции
   OperAddr     - адрес буфера текущей записи файла операций operat.dbt

   Запись можно отредактировать, занесение в базу осуществится после успешного
   выхода из макроса (возврат TRUE).
   Отказ от завершения происходит при возврате значения FALSE.

   Вызов макроса осуществляется перед вызовом системной процедуры завершения
   операции, т.е. поля Emp_Ref, Sess_Ref, Date, Time содержат старые значения,
   обороты по операции незавершены. В системной процедуре эти поля и обороты
   будут обновлены.

   ************************************************************************
*/

IMPORT ExchangeInter;

RECORD Oper( operat, "exchange.def" );

macro CompleteOper( OperAddr )

  SetBuff( Oper, OperAddr ); /* Oper указывает на текущую запись об операции */

  return TRUE; /* успешное завершение */

end;

