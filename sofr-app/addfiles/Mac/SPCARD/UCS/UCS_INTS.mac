/*
$Name:           UCS_INTS.mac
$Module:         UCS
$Description:    Макрос выбора операции
*/
import "UCS_COMMON.mac";
macro Transmit(param)
    var obj; 
    var isDebet = false;
    var isCredit = false;
    param.Result = 0;
    param.ResultText = "";
    if((param.OpNumOper == 311) or (param.OpNumOper == 312) or (param.OpNumOper == 315) or (param.OpNumOper== 330))
        obj =  UFXMsgApp();
    else
        if((param.step == 2) or param.flagStorn)
            if((param.OpNumOper == 43) or (param.OpNumOper== 44) or (param.OpNumOper== 45) or (param.OpNumOper == 68) )
                if(NOT param.flagStorn)
                    obj = UFXMsgDebet();
                else
                    obj = UFXMsgCredit(); 
                end;
            elif((param.OpNumOper == 41) or (param.OpNumOper== 42))
                if( param.flagStorn)
                    // при откате все в один шаг
                    var objBal = UFXMsgBalance(true,param.depdoc.rec.InSum);
                    objBal.Transmit(param);
                    if(Not param.Result ) 
                        obj = UFXMsgDebet();
                    end;
                else
                    obj = UFXMsgCredit(); 
                end;
            end;
        elif(param.step = 1)
            obj  = UFXMsgBalance(true,param.depdoc.rec.OutSum);        
        end;
    end;
    if(NOT param.Result)
        if(obj)
          obj.Transmit(param);
        else
          ALG_RESULT = ERR_RES;
          param.ResultText = "Неверный номер операции";
          param.Result = -1;
        end;
    end;

end;
