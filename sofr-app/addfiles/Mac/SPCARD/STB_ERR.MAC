/*********************************************************************
*  ---------------------                                             *
*  R-Style Software Lab.                                             *
*  ---------------------                                             *
*  RS-Retail                                                         *
*                                                                    *
*  Пластиковые карточки                                              *
*                                                                    *
*  Функция, возвращающая описание ошибки для STB-Card по ее коду     *
*  Исходные данные:                                                  *
*    - код ошибки (в текстовом представлении "xxx")                  *
*    - код формата файла ("CI","AC","TRI" и т.д.)                    *
*                                                                    *
*  Лебедев С.В.                                                      *
*  17.12.99                                                          *
*********************************************************************/

macro NameError
(
 CodError, /* Код ошибки        */
 CodFile   /* Код формата файла */
)

  var Error = ""; /* Словесное описание ошибки */

  /* ----------------- Ошибки для файла CI, AC, AB, CN ----------------- */
  if ((CodFile == "CI") OR
      (CodFile == "AC") OR
      (CodFile == "AB") OR
      (CodFile == "CN")   )
    if (CodError == "00")
      Error = "Нет ошибок";
    elif (CodError == "10")
      Error = "Данный код операции запрещен для банка";
    elif (CodError == "18")
      Error = "Некорректный BIN карточки";
    elif (CodError == "19")
      Error = "Фамилия клиента пустая";
    elif (CodError == "20")
      Error = "Номер заказа пустой";
    elif (CodError == "21")
      Error = "Адрес клиента пустой";
    elif (CodError == "22")
      Error = "Номер телефона пустой";
    elif (CodError == "23")
      Error = "Код группы неверен";
    elif (CodError == "25")
      Error = "Код языка неверен";
    elif (CodError == "27")
      Error = "Эмбоссируемое имя клиента пустое";
    elif (CodError == "28")
      Error = "Вид пластика неверен";
    elif (CodError == "29")
      Error = "PIN-OFFSET пустой";
    elif (CodError == "30")
      Error = "Код операции неверен";
    elif (CodError == "37")
      Error = "Код филиала пустой";
    elif (CodError == "40")
      Error = "Номер карточки пустой";
    elif (CodError == "50")
      Error = "Номер счета пустой";
    elif (CodError == "55")
      Error = "Код причины блокировки неверен";
    elif (CodError == "56")
      Error = "Описание причины блокировки пустое";
    elif (CodError == "60")
      Error = "Номер карточки должен быть пустым";
    elif (CodError == "63")
      Error = "Плата за обслуживание не Y/N";
    elif (CodError == "65")
      Error = "Дата окончания действия карточки недействительна";
    elif (CodError == "66")
      Error = "Дата окончания действия карточки меньше текущей";
    elif (CodError == "67")
      Error = "Дата окончания действия карточки вне разрешенного интервала";
    elif (CodError == "68")
      Error = "Эмбоссируемое имя клиента содержит запрещенные символы";
    elif (CodError == "69")
      Error = "Дополнительная эмбоссируемая информация содержит запрещенные символы";
    elif (CodError == "70")
      Error = "Тип счета неверен";
    elif (CodError == "71")
      Error = "Код страховки неверен";
    elif (CodError == "72")
      Error = "ATM лимит суммы снятий больше разрешенного";
    elif (CodError == "73")
      Error = "POS лимит суммы покупок больше разрешенного";
    elif (CodError == "74")
      Error = "ATM лимит количества обращений больше разрешенного";
    elif (CodError == "75")
      Error = "POS лимит количества покупок больше разрешенного";
    elif (CodError == "76")
      Error = "Номер карточки не входит в разрешенный интервал";
    elif (CodError == "77")
      Error = "Номер карточки слишком короткий или содержит не только цифры";
    elif (CodError == "78")
      Error = "Номер карточки слишком длинный";
    elif (CodError == "79")
      Error = "Неверный номер SO или идентификатор банка";
    elif (CodError == "80")
      Error = "Код валюты не верен";
    elif (CodError == "81")
      Error = "Номер карточки содержит неверный контрольный разряд";
    elif (CodError == "87")
      Error = "Признак главного счета не Y/N";
    elif (CodError == "90")
      Error = "Номер заказа не уникальный";
    elif (CodError == "95")
      Error = "Код филиала не верен";
    elif (CodError == "96")
      Error = "Сумма меньше 0";
    elif (CodError == "97")
      Error = "Статус счета неверен";
    elif (CodError == "XX")
      Error = "Запись не прошла визуальный контроль";
    elif (CodError == "C1")
      Error = "Номер карточки не найден";
    elif (CodError == "C2")
      Error = "Карточка уже существует";
    elif (CodError == "C3")
      Error = "Карточка не прошла контроль из-за ошибки в связанных с ней счетах";
    elif (CodError == "C4")
      Error = "На новой карточке отсутствуют счета";
    elif (CodError == "A1")
      Error = "Данного номера счета нет среди счетов карточки";
    elif (CodError == "A2")
      Error = "Счет уже есть на карточке";
    elif (CodError == "A3")
      Error = "Счет не прошел контроль из-за ошибки в связанной с ним карточке";
    elif (CodError == "A4")
      Error = "Счет не может быть удален, т.к. на карточке не останется ни одного счета";
    elif (CodError == "A5")
      Error = "Не найдена новая карточка для прикрепления счета";
    elif (CodError == "A6")
      Error = "Счет не найден";
    else
      Error = "Неизвестный код ошибки " + CodError;
    end;
  /* ----------------------- Ошибки для файла RC ----------------------- */
  elif (CodFile == "RC")
    if (CodError == "RC00")
      Error = "Нет ошибки";
    elif (CodError == "RC01")
      Error = "Строка обработана раньше";
    elif (CodError == "RC02")
      Error = "Неверный код Банка в имени файла";
    elif (CodError == "RC03")
      Error = "Неверный номер карточки";
    elif (CodError == "RC04")
      Error = "Неизвестный статус перевыпуска";
    elif (CodError == "RC05")
      Error = "Неизвестное значение поля Необходимость фотографии";
    else
      Error = "Неизвестный код ошибки " + CodError;
    end;
  /* --------------- Ошибки для файла TRI, TRA, TRF, TRC --------------- */
  elif ((CodFile == "TRI") OR
	(CodFile == "TRA") OR
	(CodFile == "TRF") OR
	(CodFile == "TRC")   )
    if (CodError == "00")
      Error = "Нет ошибки";
    elif (CodError == "TR02")
      Error = "Неверный логический номер банка в поле BTPTID";
    elif (CodError == "TR05")
      Error = "Неверно задано расширение файла";
    elif (CodError == "TR21")
      Error = "Счета нет в базе данных";
    elif (CodError == "TR22")
      Error = "Карточки нет в базе данных";
    elif (CodError == "TR23")
      Error = "Карточка не связана со счетом";
    elif (CodError == "TR24")
      Error = "Валюта счета не соответствует валюте процессингового центра";
    elif (CodError == "TR71")
      Error = "Ошибка в формате названия файла";
    elif (CodError == "TR81")
      Error = "Ошибка Btrieve";
    elif (CodError == "TR91")
      Error = "Прочие ошибки";
    elif (CodError == "TR101")
      Error = "Ошибка при открытии файла";
    elif (CodError == "TR131")
      Error = "Не соответствуют поля CTSERV и CTDBCR";
    elif (CodError == "TR132")
      Error = "Для видов платы ISNTP и NTISM не определена транзакция CTSTAN";
    elif (CodError == "TR133")
      Error = "Транзакции с заданным кодом нет в базе данных";
    elif (CodError == "TR134")
      Error = "Поля не соответствуют транзакции";
    elif (CodError == "TR135")
      Error = "Неверно задана сумма платы CTFAMT";
    elif (CodError == "TR151")
      Error = "Состояние транзакции не позволяет провести квитовку";
    elif (CodError == "TR160")
      Error = "Не подлежит занесению в базу данных";
    else
      Error = "Неизвестный код ошибки " + CodError;
    end;
  /* ------------------------ Неизвестный файл ------------------------- */
  else
    Error = "Неизвестный формат файла " + CodFile;
  end;

  if ((SubStr(CodError,1,2) == "RC") AND (CodFile != "RC"))
    Error = "Код ошибки " + CodError + " не соответствует формату файла " + CodFile;
  end;

  if (SubStr(CodError,1,2) == "TR")
    if ((CodFile == "TRI") OR (CodFile == "TRA") OR
	(CodFile == "TRF") OR (CodFile == "TRC")   )
      ;
    else
      Error = "Код ошибки " + CodError + " не соответствует формату файла " + CodFile;
    end;
  end;

  return Error;

end;
