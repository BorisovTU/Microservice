/********************************************************************************
 DESCRIPTION  :   Отчет "Расшифровка долговых ценных бумаг"
                   - форма ввода данных 
 PROGRAMMED BY:   Шайков В.Е.
 CREATION DATE:   **.**.****
*******************************************************************************/
import "DlRepForm_h.mac", "globals.mac";

CONST PNFLD_brokcheck_BEGINDATE              = 0,  /*Дата начала периода*/
      PNFLD_brokcheck_ENDDATE                = 1,  /*Дата конца периода*/
      PNFLD_brokcheck_GROUP_BY_KVARTAL       = 2,  /*Признак группировки данных по-квартально*/
      PNFLD_brokcheck_PRINTMETHOD            = 3;  /*Вид вывода отчета*/

CLASS Dl_brokcheck_Form_Data()
  VAR BeginRepDate, EndRepDate;
  BeginRepDate = {curdate};
  EndRepDate = {curdate};
END;

VAR DlComTrAvrRepFormData = Dl_brokcheck_Form_Data();

PRIVATE MACRO Default( pThis:DL_CPanel, Cmd:INTEGER, Key:INTEGER, FldShowValue:@VARIANT, FldRealValue:@VARIANT ):INTEGER
  if( Cmd == DLG_INIT )
    FldShowValue = FldRealValue;
  elif( Cmd == DLG_CHANGEVALUE ) /*значение поля было изменено*/
    FldRealValue = FldRealValue;
  end;
  return CM_DEFAULT;
END;
                    
CLASS (DL_CPanel) DL_brokcheck_Panel()

  PRIVATE MACRO Init()
     var  d, m, y;
     var  BeginRepDate, EndRepDate, check_mark;
     BeginRepDate = {curdate};
     EndRepDate = {curdate};
     check_mark = "";
     AddFieldProc( 0, PNFLD_brokcheck_BEGINDATE, DL_PNFLD_BEGINDATE, @DL_FldProc_BeginDate, BeginRepDate);
     AddFieldProc( 0, PNFLD_brokcheck_ENDDATE, DL_PNFLD_ENDDATE, @DL_FldProc_EndDate, EndRepDate);
     //AddFieldProc( 0, PNFLD_brokcheck_GROUP_BY_KVARTAL, DL_USERFIELD, @DL_FldProc_GROUP_BY_KVARTAL, check_mark);
     AddFieldProc( 0, PNFLD_brokcheck_PRINTMETHOD, DL_PNFLD_PRINTMETHOD, @DL_FldProc_PrintMethod, DL_OUTREPORT_EXCEL, 43, 13 );
  END;

  PRIVATE MACRO Check():BOOL
     return true;
  END;
  
  initDL_CPanel( "brokcheck.lbr", "brok" );
 
END;