/*
 Библиотека макросов для конвертации строк между
 DOS и WINDOS кодировками

 Выполнил Колобов С.А.  21.04.98 г.
*/
macro OEM2Char(WinChar)
  var DosN, WinN;
  WinN = CodeFor(WinChar);
  if ((WinN > 175) and (WinN < 192))
    DosN = WinN + 64;
  elif ((WinN > 191) and (WinN < 240))
    DosN = WinN - 64;
  elif ((WinN > 239) and (WinN < 256))
    DosN = WinN - 16;
  else
    DosN = WinN;
  end;
  Return StrFor(DosN);
end; /* OEM2Char */

macro Char2OEM(DosChar)
  var DosN, WinN;
  DosN = CodeFor(DosChar);
  if ((DosN > 127) and (DosN < 176))
    WinN = DosN + 64;
  elif ((DosN > 223) and (DosN < 240))
    WinN = DosN + 16;
  else
    WinN = DosN;
  end;
  Return StrFor(WinN);
end; /* Char2OEM */

macro Win2Dos(s)
  var i = 1, ss = "";
  While ( i <= StrLen(s) )
    ss = ss + OEM2Char(SubStr(s,i,1));
    i = i + 1;
  end;
  Return ss;
end; /* Win2Dos */

macro Dos2Win(s)
  var i = 1, ss = "";
  While ( i <= StrLen(s) )
    ss = ss + Char2OEM(SubStr(s,i,1));
    i = i + 1;
  end;
  Return ss;
end; /* Dos2Win */

