/***************************************************************/
/*                                                             */
/*      RS-Retail 2.0                                          */
/*                                                             */
/*      Система обслуживания TCD                               */
/*                                                             */
/*      Макрос обработки ошибок TCD                            */
/*                                                             */
/***************************************************************/

array ErrMes, ErrRecom;

/***  Инициализация массивов сообщений  ***/
macro ErrInit()
  /*  Содержание ошибки  */
  ErrMes( 0) = "Удачное выполнение";
  ErrMes( 1) = "Количество банкнот менее 200";
  ErrMes( 2) = "Кассета пуста";
  ErrMes( 3) = "Лифты находятся внизу";
  ErrMes( 4) = "Предыдущие 4 банктноты забракованы";
  ErrMes( 5) = "Число банкнот не соответствует кол-ву выданных";
  ErrMes( 6) = "Сбой механизма подачи";
  ErrMes( 7) = "Сбой связи TCD с компьютером";
  ErrMes( 8) = "Неверный формат команды";
  ErrMes( 9) = "Обнаружена двойная ошибка";
  ErrMes(10) = "Кассета не установлена или не поднят рычаг фиксации";
  ErrMes(11) = "Неизвестная ошибка";
  ErrMes(12) = "Неизвестная ошибка";
  ErrMes(13) = "Манипуляторы выдачи не работают";
  ErrMes(14) = "Неизвестная ошибка";
  ErrMes(15) = "Не установлена Reject-кассета";
  ErrMes(16) = "Сбой механизма выдачи банкнот";
  ErrMes(17) = "Сбой накопителя";
  ErrMes(18) = "Запрошено слишком много банкнот";
  ErrMes(19) = "Слишком много накопленных банкнот";
  ErrMes(20) = "Число забракованных банкнот более 200";
  ErrMes(21) = "Недопустимый номер кассеты";
  ErrMes(22) = "Отказ основного электродвигателя";
  ErrMes(23) = "Неизвестная ошибка";
  ErrMes(24) = "Высокое давление в механизме подачи";
  ErrMes(25) = "Сбой датчика накопителя";
  ErrMes(26) = "Сбой датчиков механизма подачи";
  ErrMes(27) = "Неизвестная ошибка";
  ErrMes(28) = "Неизвестная ошибка";
  ErrMes(29) = "Банкноты находятся в окошке выдачи";
  ErrMes(30) = "Истекло время установки связи";
  ErrMes(31) = "Неизвестная ошибка";
  ErrMes(32) = "Несоответствие номеров кассет";
  ErrMes(33) = "Reject-кассета переполнена";
  ErrMes(34) = "Неизвестная ошибка";
  ErrMes(35) = "Неизвестная ошибка";
  ErrMes(36) = "Неизвестная ошибка";
  ErrMes(37) = "Неизвестная ошибка";
  ErrMes(38) = "Неизвестная ошибка";
  ErrMes(39) = "Неизвестная ошибка";
  ErrMes(40) = "Неизвестная ошибка";
  ErrMes(41) = "Неизвестная ошибка";
  ErrMes(42) = "Неизвестная ошибка";
  ErrMes(43) = "Сбой оптодатчика";
  ErrMes(44) = "Операция субустройства не выполнилась";
  ErrMes(45) = "Субустройство не обнаружено";
  ErrMes(46) = "Субустройство не установлено";
  ErrMes(47) = "Ошибка связи с субустройством";
  ErrMes(48) = "Неизвестная ошибка";
  ErrMes(49) = "Неизвестная ошибка";
  ErrMes(50) = "Неизвестная ошибка";
  ErrMes(51) = "Неизвестная ошибка";
  ErrMes(52) = "Неизвестная ошибка";
  ErrMes(53) = "Нет сообщений для отправки";
  /*  Рекомендации  */
  ErrRecom( 0) = "Нет рекомендаций";
  ErrRecom( 1) = "Предлагается пополнить кассеты";
  ErrRecom( 2) = "Пополните кассету";
  ErrRecom( 3) = "Выполните загрузку";
  ErrRecom( 4) = "Нет рекомендаций";
  ErrRecom( 5) = "Выполните сброс системы";
  ErrRecom( 6) = "Попытайтесь повторить команду";
  ErrRecom( 7) = "Попытайтесь повторить команду";
  ErrRecom( 8) = "Может быть несоответствие верисий ПО И TCD";
  ErrRecom( 9) = "Попытайтесь повторить команду";
  ErrRecom(10) = "Установите кассету и поднимите рычаг фиксации";
  ErrRecom(11) = "Нет рекомендаций";
  ErrRecom(12) = "Нет рекомендаций";
  ErrRecom(13) = "Возможен зажим банкноты в накопителе";
  ErrRecom(14) = "Нет рекомендаций";
  ErrRecom(15) = "Установите Reject-кассету";
  ErrRecom(16) = "Система заблокирована - снрьезные неполадки";
  ErrRecom(17) = "Сделайте сброс системы";
  ErrRecom(18) = "Число банкнот - не более 100";
  ErrRecom(19) = "Возможен зажим банкнот, сделайте сброс";
  ErrRecom(20) = "Очистите Reject-кассету";
  ErrRecom(21) = "Исправьте номера кассет и ширину банкнот";
  ErrRecom(22) = "Сделайте сброс системы";
  ErrRecom(23) = "Нет рекомендаций";
  ErrRecom(24) = "Перезагрузите кассеты";
  ErrRecom(25) = "Сделайте сброс системы";
  ErrRecom(26) = "Попытайтесь повторить команду";
  ErrRecom(27) = "Нет рекомендаций";
  ErrRecom(28) = "Нет рекомендаций";
  ErrRecom(29) = "Выньте банкноты не позднее чем через 90 сек";
  ErrRecom(30) = "Проверьте настройки СОМ-порта";
  ErrRecom(31) = "Нет рекомендаций";
  ErrRecom(32) = "Перезагрузите TCD";
  ErrRecom(33) = "Очистите Reject-кассету";
  ErrRecom(34) = "Нет рекомендаций";
  ErrRecom(35) = "Нет рекомендаций";
  ErrRecom(36) = "Нет рекомендаций";
  ErrRecom(37) = "Нет рекомендаций";
  ErrRecom(38) = "Нет рекомендаций";
  ErrRecom(39) = "Нет рекомендаций";
  ErrRecom(40) = "Нет рекомендаций";
  ErrRecom(41) = "Нет рекомендаций";
  ErrRecom(42) = "Нет рекомендаций";
  ErrRecom(43) = "Попытайтесь повторить загрузку";
  ErrRecom(44) = "Нет рекомендаций";
  ErrRecom(45) = "Нет рекомендаций";
  ErrRecom(46) = "Нет рекомендаций";
  ErrRecom(47) = "Нет рекомендаций";
  ErrRecom(48) = "Нет рекомендаций";
  ErrRecom(49) = "Нет рекомендаций";
  ErrRecom(50) = "Нет рекомендаций";
  ErrRecom(51) = "Нет рекомендаций";
  ErrRecom(52) = "Нет рекомендаций";
  ErrRecom(53) = "Нет рекомендаций";
end;

/***  Сообщение об ошибке  ***/
macro ErrMess( ErrNum )
  MsgBox( ErrMes( ErrNum ) + "|" + ErrRecom( ErrNum ) );
end;
