//

import BankInter, DeprIntr, DeskInter;
import RCW;

private var agent = CreateObject( "rtbrcash.d32", "TBranchCashAgent", NULL, false );

private var sCur = "RUR", Sum = 0;

var lowDispensable, highDispensable;

/*************************************************************/
//             Проверка возможности выдать сумму.
/*************************************************************/
SetOutPut( NULL, TRUE );

println( " " );
println( "  Проверка возможности выдать сумму." );
println( " " );
println( " " );

if ( agent.login( 2, 2 ) ) 

  if ( ( getString( sCUR, "Задайте код валюты (например: RUR)" ) )  AND  ( strLen( sCur ) == 3 ) )
    if ( getInt( Sum, "Задайте сумму в копейках для проверки" ) )
      if ( agent.Denominate( 1, sCUR, Sum, lowDispensable, highDispensable ) ) 
        println( "Сумму ", (Sum*1.0/100.0):0:2, " ", sCUR, " возможно выдать." );
      else
        println( "Сумму ", (Sum*1.0/100.0):0:2, " ", sCUR, " выдать невозможно." );
      end;
    end;
  end;

else
  println( "Невозможно получить информацию об устройстве" );
end;
