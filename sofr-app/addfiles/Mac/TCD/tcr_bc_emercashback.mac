//

import BankInter, DeprIntr, DeskInter, ListCurr;
import rcw;
import tcr_bc_err;

/***********************************************************/
//                   Аварийная выдача.
/***********************************************************/

  var agent = CreateObject( "rtbrcash.d32", "TBranchCashAgent", NULL, false );
  var bce = BC_ErrCode;
  var Sum = 0;
  var res = 1017;  // Указанную сумму невозможно выдать.

  if ( agent.login( 1, 1 ) )
    if ( agent.EmergencyDispense( "1", Sum ) )
      MsgBox( "Аварийная выдача: сумма = ", Sum );
    else
      MsgBox( "Ошибка при аварийной выдаче: ", bce.ErrMsg( res ) );  // Сообщение об ошибке.
    end;
  end;

end;
