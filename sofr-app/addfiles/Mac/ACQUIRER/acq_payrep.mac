/*********************************************************************
*  ---------------------                                             *
*  R-Style Software Lab.                                             *
*  ---------------------                                             *
*  RS-Retail                                                         *
*  Эквайер                                                           *
*                                                                    *
*  Печать отчета оплаты транзакций                                   *
*                                                                    *
*  Мельникова Н.В.                                                   *
*  17.05.2007                                                        *
*********************************************************************/

var {oper};
const Ошибка   = 0,
      Первый   = 1,
      Последний= 2;

macro Печать_ОтчетСканирования( Вызов, Транзакция, Статус, Сообщение, Номер )
  record Tran(acqtran);   
  setbuff(Tran, Транзакция);

  if( Вызов == Первый )
    [ ];
    [   Отчет о пакетной оплате транзакций эквайринга ];
    [   Дата обработки: ##########  ######## ](date:f, time);
    [   Операционист:   #####                ]({oper});
    [ ];
    [┌──────┬──────────────────────────┬────────────────────┬──────┬────────────────────────────────────────────┐];
    [│№ п/п │      Код транзакции      │    Номер карты     │Номер │                 Сообщение                  │];
    [│      │                          │                    │ошибки│                                            │];
    [├──────┼──────────────────────────┼────────────────────┼──────┼────────────────────────────────────────────┤];

  elif( Вызов == Ошибка )
    if( Статус == 0 )
      Сообщение = "Транзакция оплачена успешно";
    end;    
    [│######│##########################│####################│######│############################################│]
    (Номер, Tran.authCode:r, Tran.cardNumber:r, Статус, Сообщение:w);

  elif (Вызов == Последний)
    [└──────┴──────────────────────────┴────────────────────┴──────┴────────────────────────────────────────────┘];
    [   Итого оплачено: ##### ](Номер);
    [ ];
  end;
end;
