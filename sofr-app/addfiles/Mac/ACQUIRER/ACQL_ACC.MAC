/**************************************************************************\
*  ---------------------                                                   *
*  R-Style Software Lab.                                                   *
*  ---------------------                                                   *
*  RS-Retail                                                               *
*                                                                          *
*  Эквайер                                                                 *
*  Редактируемый скроллинг счетов участника                                *
*                                                                          *
*  Никольский С.О.                                                         *
*  29.07.2003                                                              *
\**************************************************************************/
import acqifc, acqcmn, DeprIntr;
/* ======================================================================= */
/* Адрес этой структуры передается во все функции ======================== */
/* ======================================================================= */
record счетУчастника( "acqAccnt.dbt", "spcard.def" );
/* ======================================================================= */
/* обработчик событий ==================================================== */
/* ======================================================================= */
/*
macro обработчикСобытий( key )
  if( key == F6 )
  end;
  return key;
end;
*/

private macro заимствованиеСчетов( fromCurr, toCurr, branch, termRef )
var 
  accnt = TBFile("acqAccnt.dbt","w",0,null,"spcard.def"),
  stat;

  accnt.rec.Type = "";
  accnt.rec.Branch = 0;
  accnt.rec.ContractID = 0;
  accnt.rec.termRef = 0;
  accnt.rec.varName = "";
  accnt.rec.currCode = 0;

  stat = accnt.getGE();
  while( stat )
    if( (accnt.rec.currCode == fromCurr) and
        (accnt.rec.Branch == branch) and 
        (accnt.rec.termRef == termRef) )
      accnt.rec.currCode = toCurr;
      accnt.insert();
    end;
    stat = accnt.next();
  end;
end;