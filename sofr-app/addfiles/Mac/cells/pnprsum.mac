/******************************************************************************\

		Макрос по расчету штрафа за просрочку: % от суммы
	
			Программист: Крестьянинов Е.А.

\******************************************************************************/
import DeprIntr,CommonInter,Календарь,getstsum, stpencls;

const ProcentForSum = 0.3; /* Процентная доля от суммы */

macro GetPenalty(Contract,Tarif)

var Sum = $0,penDays = 0, SumForPeriod = $0, NumPeriodDays = 0;

  penDays = GetPenaltyDays( Contract );
  penDays = PenDays - Tarif.rec.PrivilegeDays;
  SumForPeriod = GetSum(Contract,Tarif);
  NumPeriodDays = NDays(Contract.rec.OpenDate,Contract.rec.EndDate) + 1;

  if( penDays > 0 )
    Sum = money( (SumForPeriod/NumPeriodDays)*penDays*(1+ProcentForSum) );
  else
    penDays = 0;
  end;

  return String( Sum ) + "|" + String( penDays );
end;