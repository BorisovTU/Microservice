/*! Операция доп соглашение по изменнию типового договора */

import stforcel,classes, Календарь;
import globOp;

class (TOperationExecutor) TDopChangeContract( opObj )

  var contr = operation.contract;
  
/* Ввод клиентов, участвующих в операции */
  macro inputClients()			
    //msgbox ("Выберите из предложенного далее списка клиента,|которому будет выдан ключ от сейфовой ячейки.");
    return accessUI( operationObj );
  end;

  macro runPanel()
    return operationObj.panel.use();
  end;

  macro createDocuments()

    var dsDoc;
    var stat = true;

	/* Начало аренды ячейки ЮЛ */ 
	operationObj.newAddAgreement();
    dsDoc = operationObj.newDsDoc(1);
	operationObj.AddAgreement.SetAddAgreementDoc( dsDoc ); 
    if(not operationObj.multipleClients)
      dsDoc.rec.ClientCode = operationObj.clientCode;
    end;
     stat = GetString (operationObj.AddAgreement.rec.Number, "Введите номер дополнительного соглашения");
     if(stat == false)     
       return false;
     end;  

	dsDoc.rec.Ground  = "Формирование дополнительного соглашения по изменениям";

	if (operationObj.clientList.first)
       dsDoc.rec.clientcode=operationObj.clientList.item.rec.clientcode;
    end;

	operationObj.docList.insert(dsDoc);
        
    return true;

  end;

  InitTOperationExecutor( opObj );
end;

/************************ Основная программа **********************************/
var obj = TDopChangeContract ( operation );

  obj.runOp();

end;
