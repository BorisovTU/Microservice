import RslCellObjects, CommonInter, brparm;

private var IsPrintHead = false;

private var {curdate};

private macro PrintHead()

  var BranchStrNum, DepartName;

  GetBranchParams( numFNcash(), BranchStrNum, null, DepartName );

   [ ];
   [    ВСП: #]
   ( DepartName + "(" + BranchStrNum + ")" );
   [ ];
   [           Обработанные договора по СЯ
               (отнесение платы  на доход)
               ___________________________
               Дата обработки #]
   ( {curdate}:m );
   [ ];

   [  +------------------------------+--------------------+];
   [  |        Номер договора        | Состояние договора |];
   [  +------------------------------+--------------------+];
 
end;

private macro Report( obj )
  var Stat = "";

  if( obj.status == true )
    Stat = " Обработан";
  else
    Stat = " Не обработан";
  end;
  if( not IsPrintHead )
    PrintHead();
    IsPrintHead = true;
  end;

  [  |##############################|####################|]
  (obj.contract.rec.Number:w:c, Stat);
  [  +------------------------------+--------------------+];

end;
