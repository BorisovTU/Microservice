/*   Откат операции - доступ к ячейке */
import stforcel;

private var rollbackdata  = CreateRollbackDataObject();  /* Обьект, необходимый для отката */

macro TrnProc
var stat;

  stat = rollbackdata.footprint.rollback();
  if(not stat)
    AbortTrn();
  end;
 
end;

  if(ProcessTrn( 1, "TrnProc") )
    MsgBox("Откат операции доступа к ячейке прошел успешно");
  else
    rollbackdata.footprint.displayErrorMessage();
    MsgBox("Откат операции доступа к ячейке прошел с ошибками");
  end;

end;