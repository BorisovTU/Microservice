/*! Операция Начало аренды юр. лицом */

import stforcel,classes, Календарь;
import globOp;

class (TOperationExecutor) TAccessContractMembers( opObj )

  var contr = operation.contract;
  
/* Ввод клиентов, участвующих в операции */
  macro inputClients()			
    //msgbox ("Выберите из предложенного далее списка клиента,|которому будет выдан ключ от сейфовой ячейки.");
    return accessUI( operationObj );
  end;

  macro runPanel()
    operationObj.newAddAgreement();
    return operationObj.panel.use();
  end;

  macro createDocuments()

    var dsDoc;
    var stat = true;

	/* Начало аренды ячейки ЮЛ */ 
    dsDoc = operationObj.newDsDoc(1);
	operationObj.AddAgreement.SetAddAgreementDoc( dsDoc ); 
    if(not operationObj.multipleClients)
      dsDoc.rec.ClientCode = operationObj.clientCode;
    end;
    
	dsDoc.rec.Ground  = operationObj.Ground;
	operationObj.docList.insert(dsDoc);
        
    return true;

  end;

  InitTOperationExecutor( opObj );
end;

/************************ Основная программа **********************************/
var obj = TAccessContractMembers ( operation );

  obj.runOp();

end;
