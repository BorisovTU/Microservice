/* Стандартный макрос для расчета суммы Дополнительной платы */
/* Операция Дополнительная плата */

import DeprIntr,CommonInter, stforcel, stprocs;

private var operation     = CreateObjectOfOperation();

// totalFeePerDay - общая сумма платы за один день аренды 
// если она отрицательная, значит по какой-либо ячейке вид тарифа отличен от ДЕНЬ
macro GetExtraSum( totalFeePerDay )

  var contr = operation.contract;
  var Sum = $0;             /* Сумма к оплате */
  var extraDays = 0;

  // если последний день договора рабочий сумма = 0
  if( isHoliday( contr.rec.EndDate ) == 0 )
    return $0;
  end;
  
  extraDays = CalcExtraDays( contr.rec.EndDate );  
  
  Sum = extraDays * totalFeePerDay;
  return Sum;
end;

