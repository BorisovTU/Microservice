/* Определение базового класса для операции доступа к ячейке */

import stforcel,classes;
import globOp;

class (TOperationExecutor) TOperationAccessToCell( opObj )
  var GroundMsg = "";

  macro runPanel()
    return true;
  end;

  macro checkOperation()
    var status = true;
    if( operationObj.Contract.isClaimRegistered )
      PushErrorMessage("По договору зарегистрировано возникновение исковой ситуации.| Доступ к ячейке запрещен");
      status = false;
    end;
    return status;
  end;


  macro createDocuments()
  var doc;
    doc = operationObj.newDsDoc(1);
    if(not operationObj.multipleClients)
      doc.rec.ClientCode = operationObj.clientCode;
    end;
    doc.rec.Ground = GroundMsg;
    operationObj.docList.insert(doc);
    return true;
  end;

  macro runOp()
   var contrTypeID = operationObj.ContractType;

   if ( (contrTypeID == CT_JURIDICAL_DEAL_CONTRACT) or (contrTypeID == CT_PHYSICAL_DEAL_CONTRACT) )
     operationObj.contract.setVarPartFormat("dscondop");
     msgbox( CreateString(operationObj.contract.varPart.rec.Condition) );
   end;
   return runOp();
 end;

  InitTOperationExecutor( opObj );
end;
