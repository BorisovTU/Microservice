/* Доп соглашение на допуск расширенного круга лиц */

import stforcel,classes, Календарь;
import globOp;

class (TOperationExecutor) TAccessExtendedMembers( opObj )

  var contr = operation.contract;
  
  macro inputClients()        
    return accessUI( operationObj );
  end;

  macro runPanel()
    operationObj.newAddAgreement();
    return operationObj.panel.use();
  end;

  macro createDocuments()

   var dsDoc;
   var stat = true;

   dsDoc = operationObj.newDsDoc(1);
   operationObj.AddAgreement.SetAddAgreementDoc( dsDoc );
   if(not operationObj.multipleClients)
     dsDoc.rec.ClientCode = operationObj.clientCode;
   end;
   dsDoc.rec.ground = "Доп. соглашение на допуск расширенного круга лиц."; 
   
   operationObj.docList.insert(dsDoc);

   /* Плата */
	operationObj.runNestedDSOperation(2);

    return true;

  end;

  InitTOperationExecutor( opObj );
end;

/************************ Основная программа **********************************/
var obj = TAccessExtendedMembers ( operation );

  obj.runOp();

end;
