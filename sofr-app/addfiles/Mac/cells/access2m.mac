/* Доступ к ячейке для типа договора "2 Арендатора"*/
import accesscl;

class (TOperationAccessToCell) TOperationAccessToCellWithTwoMen( opObj )

  macro checkClients()
    if (not checkClients())
      return false;
    end;

    var Found1 = false,Found2 = false,stat;
    
    stat = operationObj.clientList.first();
    while( stat )
      if( (strlen(operationObj.clientList.item.rec.Attributes)==0) OR 
	  index(operationObj.clientList.item.rec.Attributes,"Г") OR
	  index(operationObj.clientList.item.rec.Attributes,"Д") )
        if( operationObj.clientList.item.rec.GroupNumber == 1 )
          Found1 = true;
        else
          Found2 = true;
        end;
      end;
      stat = operationObj.clientList.next();
    end;
    return (Found1 AND Found2);
  end;

  InitTOperationAccessToCell( opObj );
end;

/******************** Основная программа ***********************/

var obj = TOperationAccessToCellWithTwoMen( operation );

  obj.runOp();

end;