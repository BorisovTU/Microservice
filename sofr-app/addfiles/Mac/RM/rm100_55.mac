//-----------------------------------------------------------------------------
// Блок      : 29030 - "Обработка невыясненной суммы"
// Шаг       : 55    - "Контроль невыясненной суммы"
// Назначение: Макрос шага
// Описание  : Макрос шага
//-----------------------------------------------------------------------------
import WldInter, "cbsttls.mac", PaymInter;

var PaymentObj:RsbPayment;

//-----------------------------------------------------------------------------
// Выполнение шага
//-----------------------------------------------------------------------------
macro ExecuteStep( Kind_Operation, first, KindDoc, ID_Operation, ID_Step )

  if( not КонтрольПлатежа( PaymentObj, ID_Operation, ID_Step ) )
    MsgBox("Пользователь " + {Oper} + " не может контролировать платеж");
    return 1;
  end;

  PaymentObj.UnknownState = RM_CTRUNKNOWN;

  return 0;
end;