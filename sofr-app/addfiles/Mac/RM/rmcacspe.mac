/* **************************************************************************
  ВЫПИСКА ИЗ СПЕЦИФИКАЦИИ К КОРСЧЕТУ
 ****************************************************************************/
import globals;

var DK = "" ;
var FO = "" ;

/*--------------- Печать Заголовка выписки  --------------------------*/
macro PrintCommonHead( DateRst, CorAcc )
 [

            ВЫПИСКА ИЗ СПЕЦИФИКАЦИИ К КОРРСЧЕТУ ######################### за #

  #######################################################################
  +---------------------------------+-------------------------+-------------------------+
  | ВНЕШНИЕ ПРОВОДКИ                |           Дебет         |         Кредит          |
  |---------------------------------|-------------------------|-------------------------|
 ] ( CorAcc, DateRst:f, {Name_Bank} ) ;
end ;

 /*--------------- Печать Итогов группы ------------------------------*/
macro PrintItog( flagDK, flagFO, Group_Sum )
  var Group_Name, fl;
  ARRAY SG ;
  DK = flagDK ;
  FO = flagFO ;

  if( FO == "Н" )
    Group_Name = "Начальные, " ;
  else
    Group_Name = "Ответные, " ;
  end ;

  if( flagDK == "Д" )
    Group_Name = Group_Name + "дебетовые" ;
  else
    Group_Name = Group_Name + "кредитовые" ;
  end ;

  strsplit( Group_Name, SG, 33, 33, 3 ) ;
  fl = 0 ;
  if( DK == "Д" ) if( FO == "Н" ) fl = 1 ; end ; end ;
  if( DK == "К" ) if( FO == "О" ) fl = 1 ; end ; end ;
  if( fl == 0 )
 
[|#################################|                         |#########################|
 |#################################|                         |                         |
 |#################################|                         |                         |
 |                                 |                         |                         |
 ] (SG(0), Group_Sum, SG(1), SG(2) ) ;                                                  
  else
 
[|#################################|#########################|                         |
 |#################################|                         |                         |
 |#################################|                         |                         |
 |                                 |                         |                         |
 ] (SG(0), Group_Sum, SG(1), SG(2) ) ;
  end ;

end ;


/*------------------------- Состояние коррсчета -------------------------*/
macro PrintStatAcnt( InRest, Debet, Kredit, OutRest )
 [+---------------------------------+-------------------------+-------------------------+


  +---------------------------------+-------------------------+-------------------------+
  | СОСТОЯНИЕ КОРРСЧЕТА             |        Дебет            |         Кредит          |
  |---------------------------------|-------------------------|-------------------------|
  | Входящий остаток                |#########################|                         |
  | Обороты за день                 |#########################|#########################|
  | Исходящий остаток               |#########################|                         |
  +---------------------------------+-------------------------+-------------------------+
 ] ( InRest, Debet, Kredit, OutRest ) ;
end ;


