//-----------------------------------------------------------------------------
// Блок      : 29062 - "Обработка платежа, сквитованного отказом"
// Шаг       : 10   - "Отбработка платежа, сквитованного отказом"
// Назначение: Макрос шага
// Описание  : Макрос шага
//-----------------------------------------------------------------------------
import PaymInter, "wlkvit.mac";

var PaymentObj:RsbPayment;

macro ExecuteStep( doc, first )
  
  //var ch = AskFateRefusalDocument( PaymentObj, Corschem );

  //PaymentObj.PropStatus = PM_PROP_CORREJECTED; 
  /*
  if( ch == Ch_GoIndex )   // Поместить в картотеку
    if( УстановитьСтатусыПлатежа( OPR_PAYM_INDEX, OPR_PAYM_ST_INDEX_NOSTRO ) )
      MsgBox("Возникла ошибка при смене статусов операции платежа");
      return 1;
    end;
  elif( menu_item == Ch_RetSend ) // Вернуть отправителю
    if( УстановитьСтатусыПлатежа( OPR_PAYM_DO, OPR_PM_ST_RETURN ) )
      MsgBox("Возникла ошибка при смене статусов операции платежа");
      return 1;
    end;
  elif(menu_item == Ch_RePos) //Перепозиционировать
    if( УстановитьСтатусыПлатежа( OPR_PAYM_DO, OPR_PM_ST_POS ) )
      MsgBox("Возникла ошибка при смене статусов операции платежа");
      return 1;
    end;
    PaymentObj.PropStatus = PM_PROP_READY;
    PaymentObj.PaymStatus = PM_READY_TO_SEND;
  else
    return 1;
  end;*/

  if( not ExecRefusalDocument(PaymentObj) )
    return 1;
  end;

  return 0;
end;

