/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank v6.0                     */
/****************************************************************************/
/*                      Подсистема "АРМ-Позиционера"                        */
/*                   Разрешение редактирования платежа                      */
/*                                                                          */
/*  Имя файла: rm200_32.mac                                                 */
/*  Создан:    24.01.05                                Фомченкова Л.Н.      */
/****************************************************************************/

import RMInter, WldInter, "rmconst.mac", PaymInter, rmtools;

var PaymentObj:RsbPayment;

macro ExecuteStep( doc, first, KindDoc )
   var stat = 0, err = false;

    /*Если счет не существует или закрыт */
   /*если платеж имеет сокращенный формат*/
   if((not IsAccountsOK( PaymentObj.ReceiverFIID,
                       PaymentObj.IsCredit() OR PaymentObj.IsTransit(),
                       PaymentObj.PayerAccount,
                       (not PaymentObj.IsCredit()) OR PaymentObj.IsTransit(),
                       PaymentObj.ReceiverAccount )) or (PaymentObj.IsShortFormat))
       PaymentObj.IsAllowEdit = SET_CHAR;
   end;
   return stat;
end;