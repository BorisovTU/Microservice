/////////////////////////////////////////////////////////
// Отчет сканирования скролинга открытых дел по переписке
/////////////////////////////////////////////////////////

const DOSSIERERR_CORROVERDUE  = 1, //просрочено
      DOSSIERERR_CORRENDTODAY = 2, //Срок ведения переписки по делу заканчивается сегодня
      DOSSIERERR_WAOVERDUE    = 3, //Истек срок ожидания ответа
      DOSSIERERR_WAENDTODAY   = 4, //Срок ожидания ответа по делу заканчивается сегодня
      DOSSIERERR_PAOVERDUE    = 5, //Истек срок подготовки ответа
      DOSSIERERR_PAENDTODAY   = 6; //Срок подготовки ответа по делу заканчивается сегодня

macro PrintHead( mode )
  if( mode == 1 )
    [ Результаты сканирования списка открытых дел по переписке за ########## г.
           
      Просроченные дела/дела, по которым заканчивается срок ведения переписки  
      ┌────────────┬──────────┬────────────┬─────────────────────────────────────┬──────────────────────────────┐
      │ Номер дела │Дата откр.│ Тип дела   │          Срок ведения переписки     │   Комментарий                │    
      │            │          │            ├─────────────┬───────────┬───────────┤                              │   
      │            │          │            │Макс. срок   │Дата начала│Дата оконч.│                              │   
      ├────────────┼──────────┼────────────┼─────────────┼───────────┼───────────┼──────────────────────────────┤](Date());  
  elif( mode == 2 )
    [ Дела, по которым заканчивается срок ожидания/подготовки ответа 
      ┌────────────┬──────────┬────────────┬─────────────────┬───────────────────┬──────────────────────────────┐
      │ Номер дела │Дата откр.│ Тип дела   │Срок ожид. ответа│Дата послед. сооб. │  Комментарий                 │
      ├────────────┼──────────┼────────────┼─────────────────┼───────────────────┼──────────────────────────────┤];
  end;

end;

macro PrintRecord( mode, Number, DossierType, OpenDate, PeriodName, CorrBeginDate, CorrEndDate, LastMesDate, error)
  var ErrStr = "";
  if( error == DOSSIERERR_CORROVERDUE)
    ErrStr = "Просрочено";
  elif( error == DOSSIERERR_CORRENDTODAY)
    ErrStr = "Срок ведения переписки по делу заканчивается сегодня";
  elif( error == DOSSIERERR_WAOVERDUE)
    ErrStr = "Истек срок ожидания ответа";
  elif( error == DOSSIERERR_WAENDTODAY)
    ErrStr = "Срок ожидания ответа по делу заканчивается сегодня";
  elif( error == DOSSIERERR_PAOVERDUE)
    ErrStr = "Истек срок подготовки ответа";  
  elif( error == DOSSIERERR_PAENDTODAY)
    ErrStr = "Срок подготовки ответа по делу заканчивается сегодня";
  end;

 
  array str1;
  strsplit(ErrStr,str1,30);
  var i = 1;

  if( mode == 1 )
    [ │############│##########│############│#############│########## │########## │##############################│]
    (Number,  OpenDate,DossierType, PeriodName, CorrBeginDate, CorrEndDate, str1(0));
    while( strlen(str1(i)) > 0 )
    [ │            │          │            │             │           │           │##############################│] ( str1(i) );
    i =  i + 1 ;
    end;

  elif( mode == 2 )
    [ │############│##########│############│################ │ ##########        │##############################│]
    (Number, OpenDate,DossierType, PeriodName, LastMesDate, ErrStr);
    while( strlen(str1(i)) > 0 )
    [ │            │          │            │                 │                   │##############################│] ( str1(i) );
    i =  i + 1 ;
    end;
  end;

end;

macro PrintItog(mode)
  if( mode == 1 )
    [ └────────────┴──────────┴────────────┴─────────────┴───────────┴───────────┴──────────────────────────────┘];
  elif( mode == 2 ) 
    [ └────────────┴──────────┴────────────┴─────────────────┴───────────────────┴──────────────────────────────┘];
  end;
end;