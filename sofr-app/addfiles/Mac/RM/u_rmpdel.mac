/*
   Отчет о массовом удалении платежей
   Выводим только ID документа, потому как номер, сумма и дата платежа 
   живут в базах pmprop.dbt, pmpaym.dbt, из которых запись с таким PaymentID уже удалена    
*/

import PaymInter;

const Ошибка      = 0,
      Первый      = 1,
      Последний   = 2;

RECORD pmprop(pmprop);

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение)
  var str, Номер;

 
  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о массовом удалении платежей                                          ];
    [                                                                               ];
    [+---------+------+------------------------------------------------------------+];
    [|  Номер  |Номер |                 Сообщение                                  |];
    [|документа|ошибки|                                                            |];
    [+---------+------+------------------------------------------------------------+];
  elif( Вызов == Ошибка )
    Номер = GetLastPaymentsNumber();
    if( Статус == 0 )
      Сообщение = "Удаление платежа выполнено успешно";
    end;    
    
    [|#########|######|############################################################|](Номер,Статус,Сообщение);
  elif (Вызов==Последний)
    [+---------+------+------------------------------------------------------------+];
  end;
end;