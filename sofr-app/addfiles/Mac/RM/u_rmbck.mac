/*
   Отчет о массовом определении бэк-офиса
*/

import u_rmtls;

const СообщениеОНеопределенномБэкОфисе = "Бэк-офис не определен";

macro Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
   RECORD pmpaymbuf( pmpaym ) ;


   if ( (Вызов==Ошибка) AND (Статус==0) )
      setbuff (pmp, firstdoc);
 
      if ( not FindPayment(pmp.PaymentID, 0, 0, 0, 0, true, pmpaymbuf, null, null)  )
         if ( pmpaymbuf.ToBackOffice=="" )
            Статус =  "";
            Сообщение = СообщениеОНеопределенномБэкОфисе;
         end;
      end;
   end;

   PaymReport (
                 Вызов,
                 firstdoc,
                 Статус,
                 Сообщение,

                 "Отчет о массовом определении бэк-офиса",
                 "Определение бэк-офиса выполнено успешно",
                 ПечататьСообщениеОбУспешномВыполнении
              );
end;
