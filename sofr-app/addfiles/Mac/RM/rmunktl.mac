/* Файл: rmunktl.mac                                    */
/*   Общие функции для печати отчетов по невыясненным   */

import "globals.mac", PaymInter;


FILE rmaket      ( pmrmprop ) key 0;

RECORD pm        (pmpaym);
RECORD rmprop    (pmrmprop);
RECORD ppd       (pmprop);
RECORD ppk       (pmprop);
RECORD rminprop  (rminprop);

FILE ac     ( account ) ;   /* счета                 */

var FL_DEBET = "Д", FL_KREDIT = "К" ;

macro НайтиПлатеж(PaymentID)
  var stat;
  stat = FindPayment( pm.PaymentID, /* Индентификатор */
                      0,            /* Purpose    */
                      0,            /* SubPurpose */
                      0,            /* DocKind    */
                      0,            /* DocId      */
                      true,
                      0,           /* буфер платежа            */
                      ppd,          /* буфер дебетовых свойств  */
                      ppk,         /* буфер кредитовых свойств */
                      rmprop
                    ) ;

  if ( stat )
     MsgBox( "Не найден платеж" );
     return false;
  end;

  return true;
end;


MACRO АП(Остаток)
     if (Остаток<=$0) return "актив";
     else return "пассив";
     end;
END;

macro Заменить_пробелы_нулями( Строка )
  var i ;
  i = index( Строка, " " ) ;
  while( i )
    strset( Строка, i, "0" );
    i = index( Строка, " " );
  end;
  return Строка;
end;
