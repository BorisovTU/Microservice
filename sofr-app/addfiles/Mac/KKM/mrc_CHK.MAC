/*********************************************************************
* ---------------------                                              *
* R-Style SoftWare Lab.                                              *
* ---------------------                                              *
* RS-Retail 1.0                                                      *
*                                                                    *
* Работа с Контрольно-кассовой машиной ПРИМ-07Ф                      *
* Проверка возможности оплаты на ККМ                                 *
*                                                                    *
* Щукин О.И.                                                         *
* 10.12.98                                                           *
*********************************************************************/

import "kkm_val.mac","kkm_err.mac",mercury;


var statM   = 0;                 /* Возвращенное значение функций */


macro MERC_Check

  Message(" Проверка возможности оплаты на контрольно-кассовой машине...");

  /* Определение текущих параметров ККМ */
  statM = CheckMerc();

  if (statM == 7004)   /* Устройство не найдено */
    statM = RSKKMERR_NOT_DEVICE;
  end;
                       /* Крышка ККМ открыта */
  if ( ( statM == 7008 )  or  ( statM == 7009 ) )
    statM = RSKKMERR_COVER_OPEN;
  end;

  KKM_Parm.aRetCode = statM;

end;
