/*********************************************************************
* ---------------------                                              *
* R-Style SoftWare Lab.                                              *
* ---------------------                                              *
* RS-Retail 1.0                                                      *
*                                                                    *
* Работа с Контрольно-кассовой машиной                               *
* Вывод сообщения об ошибки                                          *
*                                                                    *
* 10.12.97                                                           *
*********************************************************************/

macro WriteError (CodeError,Silence)

  var StrErr = "";

  /* Ошибки, инициированные ККМ ------------------------------ */
  if (CodeError == 0)
    StrErr = "Нет ошибки";
  elif (CodeError == 1)
    StrErr = "Недопустимый идентификатор flash chip";
  elif (CodeError == 2)
    StrErr = "Ошибка записи в ФП";
  elif (CodeError == 3)
    StrErr = "Flash chip не может быть очищен";
  elif (CodeError == 4)
    StrErr = "ФП не пуста";
  elif (CodeError == 5)
    StrErr = "Данные в ФП разрушены";
  elif (CodeError == 6)
    StrErr = "Команда в моде принтера игнорируется";
  elif (CodeError == 7)
    StrErr = "Отсутствует код оператора";
  elif (CodeError == 8)
    StrErr = "Неопределен тип документа";
  elif (CodeError == 9)
    StrErr = "Несовпадение заводского номера ПФП/ККМ";
  elif (CodeError == 10)
    StrErr = "Несовпадение пароля";
  elif (CodeError == 11)
    StrErr = "Недопустимые дата/время";
  elif (CodeError == 12)
    StrErr = "Заводская регистрация проведена ранее";
  elif (CodeError == 13)
    StrErr = "Данные заводской регистрации ККМ в ФП разрушены";
  elif (CodeError == 14)
    StrErr = "Фискализация проведена ранее";
  elif (CodeError == 15)
    StrErr = "ККМ работает в нефискальном режиме";
  elif (CodeError == 16)
    StrErr = "Данные фискализации в ФП разрушены";
  elif (CodeError == 17)
    StrErr = "Перерегистрации ККМ исчерпаны";
  elif (CodeError == 18)
    StrErr = "Данные перерегистрации в ФП разрушены";
  elif (CodeError == 19)
    StrErr = "Смена открыта";
  elif (CodeError == 20)
    StrErr = "Смена не была открыта";
  elif (CodeError == 21)
    StrErr = "Слишком много товара в чеке";
  elif (CodeError == 22)
    StrErr = "Данные закрытия смены в ФП разрушены";
  elif (CodeError == 23)
    StrErr = "Неверный формат документа";
  elif (CodeError == 24)
    StrErr = "Перезапись текста документа";
  elif (CodeError == 25)
    StrErr = "Слишком много параметров документа";
  elif (CodeError == 26)
    StrErr = "Недопустимый параметр документа";
  elif (CodeError == 27)
    StrErr = "Недопустимое значение параметра документа";
  elif (CodeError == 28)
    StrErr = "Описание несуществующего объекта";
  elif (CodeError == 29)
    StrErr = "Документ не был завершен";
  elif (CodeError == 30)
    StrErr = "Описание товара или операции не полно";
  elif (CodeError == 31)
    StrErr = "Несоответствие контрольной суммы пакета";
  elif (CodeError == 32)
    StrErr = "Принтер не готов";
  elif (CodeError == 33)
    StrErr = "Вложенные прерывания";
  elif (CodeError == 34)
    StrErr = "Неверный байт подтверждения приема данных";
  elif (CodeError == 35)
    StrErr = "Переполнение ФП";
  elif (CodeError == 36)
    StrErr = "Неизвестная команда";
  elif (CodeError == 37)
    StrErr = "Несовпадение контрольной суммы ОЗУ";
  elif (CodeError == 38)
    StrErr = "Несовпадение контрольной суммы Flash-памяти";
  elif (CodeError == 39)
    StrErr = "Порт данных неисправен";
  elif (CodeError == 40)
    StrErr = "Недопустимый порядок атомов чека";
  elif (CodeError == 41)
    StrErr = "Нулевые координаты для обязательного атома";
  elif (CodeError == 42)
    StrErr = "Недопустимая длина запроса";
  elif (CodeError == 43)
    StrErr = "Разрядность числа больше допустимой";
  elif (CodeError == 44)
    StrErr = "Переполнение";
  elif (CodeError == 45)
    StrErr = "Нет числа";
  elif (CodeError == 46)
    StrErr = "Нет ответа";
  elif (CodeError == 47)
    StrErr = "Ошибка передачи";
  elif (CodeError == 48)
    StrErr = "Мат. переполнение";
  elif (CodeError == 49)
    StrErr = "Нет бумаги...";
  elif (CodeError == 50)
    StrErr = "ККМ не готова!!!";
  elif (CodeError == 51)
    StrErr = "Сбой памяти!!!";
  elif (CodeError == 52)
    StrErr = "Принтер выключен";
  elif (CodeError == 53)
    StrErr = "Не достаточно памяти";
  elif (CodeError == 54)
    StrErr = "Длина номера меньше допустимой";
  elif (CodeError == 55)
    StrErr = "Нулевая длина номера";
  elif (CodeError == 56)
    StrErr = "Длина пароля меньше допустимой";
  elif (CodeError == 57)
    StrErr = "Нулевая длина пароля";
  elif (CodeError == 58)
    StrErr = "Не допустимая величина";
  elif (CodeError == 59)
    StrErr = "Превышено время ожидания принтера";
  /* Ошибки, возвращаемые в EXE-программу -------------------- */
  elif (CodeError ==  RSKKMERR_ALREADY_CLOSE)
    StrErr = "Смена уже была закрыта ранее";
  elif (CodeError ==  RSKKMERR_NO_PERSON)
    StrErr = "Операционист не задан";
  elif (CodeError ==  RSKKMERR_NO_FINDPERSON)
    StrErr = "Операциониста нет в базе данных";
  elif (CodeError ==  RSKKMERR_NO_NAMEPERSON)
    StrErr = "Фамилия операциониста пустая";
  elif (CodeError ==  RSKKMERR_ALREADY_OPEN)
    StrErr = "Смена уже была открыта ранее";
  elif (CodeError ==  RSKKMERR_DELETE_DOC)
    StrErr = "Операция не прошла, документ подлежит удалению";
  elif (CodeError ==  RSKKMERR_BAD_DOC)
    StrErr = "Операция с ошибкой, но зафиксирована в фискальной памяти";
  elif (CodeError ==  RSKKMERR_CANNOT_STORN)
    StrErr = "Не могу сторнировать документ";
  elif (CodeError ==  RSKKMERR_NOT_DEVICE)
    StrErr = "Фискальная плата отсутствует";
  elif (CodeError ==  RSKKMERR_NO_MONEY)
    StrErr = "Сумма операции не задана";
  elif (CodeError ==  RSKKMERR_NO_CLOSE)
    StrErr = "Необходимо закрыть смену на ККМ";
  elif (CodeError ==  RSKKMERR_NO_OPEN)
    StrErr = "Необходимо открыть новую смену на ККМ";

             /*****   Ошибки ККМ ПРИМ-07Ф   *****/

  elif (CodeError ==  RSKKMERR_PRIM01)
    StrErr = "ККМ: Неверный формат сообщения";
  elif (CodeError ==  RSKKMERR_PRIM02)
    StrErr = "ККМ: Неверный формат поля";
  elif (CodeError ==  RSKKMERR_PRIM03)
    StrErr = "ККМ: Неверное дата/время";
  elif (CodeError ==  RSKKMERR_PRIM04)
    StrErr = "ККМ: Неверная контрольная сумма";
  elif (CodeError ==  RSKKMERR_PRIM05)
    StrErr = "ККМ: Неверный пароль передачи данных";
  elif (CodeError ==  RSKKMERR_PRIM06)
    StrErr = "ККМ: Нет команды с таким номером";
  elif (CodeError ==  RSKKMERR_PRIM07)
    StrErr = "ККМ: Необходима команда <Начало сеанса>";
  elif (CodeError ==  RSKKMERR_PRIM08)
    StrErr = "ККМ: Время изменилось больше чем на 24 часа";
  elif (CodeError ==  RSKKMERR_PRIM09)
    StrErr = "ККМ: Превышена максимальная длина строкового поля";
  elif (CodeError ==  RSKKMERR_PRIM10)
    StrErr = "ККМ: Превышена максимальная длина сообщения";
  elif (CodeError ==  RSKKMERR_PRIM11)
    StrErr = "ККМ: Неправильная операция";
  elif (CodeError ==  RSKKMERR_PRIM12)
    StrErr = "ККМ: Значение поля вне диапазона";
  elif (CodeError ==  RSKKMERR_PRIM13)
    StrErr = "ККМ: При данном состоянии документа команда не допустима";
  elif (CodeError ==  RSKKMERR_PRIM14)
    StrErr = "ККМ: Обязательное строковое поле имеет нулевую длину";
  elif (CodeError ==  RSKKMERR_PRIM15)
    StrErr = "ККМ: Слишком большой результат";
  elif (CodeError ==  RSKKMERR_PRIM16)
    StrErr = "ККМ: Переполнение денежного счетчика";
  elif (CodeError ==  RSKKMERR_PRIM17)
    StrErr = "ККМ: Обратная операция невозможна: отсутствует прямая";
  elif (CodeError ==  RSKKMERR_PRIM18)
    StrErr = "ККМ: Нет столько наличных для выполнения операции";
  elif (CodeError ==  RSKKMERR_PRIM19)
    StrErr = "ККМ: Обратная операция превысила итог по прямой операции";
  elif (CodeError ==  RSKKMERR_PRIM20)
    StrErr = "ККМ: Необходимо выполнить сертификацию";
  elif (CodeError ==  RSKKMERR_PRIM21)
    StrErr = "ККМ: Необходимо закрыть смену";
  elif (CodeError ==  RSKKMERR_PRIM22)
    StrErr = "ККМ: Таймаут при печати";
  elif (CodeError ==  RSKKMERR_PRIM23)
    StrErr = "ККМ: Неисправимая ошибка принтера";
  elif (CodeError ==  RSKKMERR_PRIM24)
    StrErr = "ККМ: Принтер не готов к печати";
  elif (CodeError ==  RSKKMERR_PRIM25)
    StrErr = "ККМ: Бумага близка к концу";
  elif (CodeError ==  RSKKMERR_PRIM26)
    StrErr = "ККМ: Необходимо провести фискализацию";
  elif (CodeError ==  RSKKMERR_PRIM27)
    StrErr = "ККМ: Неверный пароль налогового инспектора";
  elif (CodeError ==  RSKKMERR_PRIM28)
    StrErr = "ККМ: Регистратор уже сертифицирован";
  elif (CodeError ==  RSKKMERR_PRIM29)
    StrErr = "ККМ: Исчерпано число фискализаций";
  elif (CodeError ==  RSKKMERR_PRIM30)
    StrErr = "ККМ: Неверный буфер печати";
  elif (CodeError ==  RSKKMERR_PRIM31)
    StrErr = "ККМ: Неверное G-поле";
  elif (CodeError ==  RSKKMERR_PRIM32)
    StrErr = "ККМ: Неверный номер типа оплаты";
  elif (CodeError ==  RSKKMERR_PRIM33)
    StrErr = "ККМ: Таймаут приема";
  elif (CodeError ==  RSKKMERR_PRIM34)
    StrErr = "ККМ: Ошибка приема";
  elif (CodeError ==  RSKKMERR_PRIM35)
    StrErr = "ККМ: Неверное состояние регистратора";
  elif (CodeError ==  RSKKMERR_PRIM36)
    StrErr = "ККМ: Слишком много операций на документе";
  elif (CodeError ==  RSKKMERR_PRIM37)
    StrErr = "ККМ: Необходимо открыть смену";
  elif (CodeError ==  RSKKMERR_PRIM38)
    StrErr = "ККМ: Необходима команда <Печать контрольной ленты>";
  elif (CodeError ==  RSKKMERR_PRIM39)
    StrErr = "ККМ: Неверный номер вида платежа";
  elif (CodeError ==  RSKKMERR_PRIM40)
    StrErr = "ККМ: Неверное состояние принтера";
  elif (CodeError ==  RSKKMERR_PRIM41)
    StrErr = "ККМ: Смена уже открыта";
  elif (CodeError ==  RSKKMERR_PRIM42)
    StrErr = "ККМ: Таймаут ожидания подкладного документа";
  elif (CodeError ==  RSKKMERR_PRIM43)
    StrErr = "ККМ: Неверная дата";
  elif (CodeError ==  RSKKMERR_PRIM44)
    StrErr = "ККМ: Ошибка 44";
  elif (CodeError ==  RSKKMERR_PRIM45)
    StrErr = "ККМ: Ошибка 45";
  elif (CodeError ==  RSKKMERR_PRIM46)
    StrErr = "ККМ: Ошибка 46";
  elif (CodeError ==  RSKKMERR_PRIM47)
    StrErr = "ККМ: Ошибка 47";
  elif (CodeError ==  RSKKMERR_PRIM48)
    StrErr = "ККМ: Фискальная память неисправна";
  elif (CodeError ==  RSKKMERR_PRIM49)
    StrErr = "ККМ: Дата в фискальной памяти позже, чем дата операции";
  elif (CodeError ==  RSKKMERR_PRIM50)
    StrErr = "ККМ: Необходима инициализация фискальной памяти";
  elif (CodeError ==  RSKKMERR_PRIM51)
    StrErr = "ККМ: Заполнена вся фискальная память";
  elif (CodeError ==  RSKKMERR_PRIM52)
    StrErr = "ККМ: Ошибка 52";
  elif (CodeError ==  RSKKMERR_PRIM53)
    StrErr = "ККМ: Ошибка 53";
  elif (CodeError ==  RSKKMERR_PRIM54)
    StrErr = "ККМ: Ошибка 54";
  elif (CodeError ==  7004)
    StrErr = "ККМ: Устройство не отвечает";
  elif (CodeError ==  7008)
    StrErr = "ККМ: Неверная контрольная сумма";
  elif (CodeError ==  7009)
    StrErr = "ККМ: Крышка ККМ открыта";

  /*****   Ошибки ККМ Меркурий-114Ф   *****/

  elif (CodeError == 699)
    StrErr = "ККМ: Исчерпан time-out|ожидания ответа от ККМ";
  elif (CodeError == 700)
    StrErr = "ККМ: Либо ККМ выключена,|либо неправильно задан СОМ-порт";

  elif (CodeError == RSKKMERR_MERC01)
    StrErr = "ККМ: Ошибка в фискальных данных, аппарат блокирован";
  elif (CodeError == RSKKMERR_MERC02)
    StrErr = "ККМ: Не закрыта смена";
  elif (CodeError == RSKKMERR_MERC03)
    StrErr = "ККМ: Исчерпан ресурс сменных записей|в фискальную память";
  elif (CodeError == RSKKMERR_MERC04)
    StrErr = "ККМ: Первышена длина поля команды";
  elif (CodeError == RSKKMERR_MERC05)
    StrErr = "ККМ: Неверный формат поля команды";
  elif (CodeError == RSKKMERR_MERC06)
    StrErr = "ККМ: Ошибка чтения таймера";
  elif (CodeError == RSKKMERR_MERC07)
    StrErr = "ККМ: Неверная дата";
  elif (CodeError == RSKKMERR_MERC08)
    StrErr = "ККМ: Неверное время";
  elif (CodeError == RSKKMERR_MERC09)
    StrErr = "ККМ: Дата меньше последней даты в фискальной памяти";
  elif (CodeError == RSKKMERR_MERC10)
    StrErr = "ККМ: Операция прервана пользователем";
  elif (CodeError == RSKKMERR_MERC11)
    StrErr = "ККМ: Запрещенная команда печатающего устройства";
  elif (CodeError == RSKKMERR_MERC12)
    StrErr = "ККМ: Не открыта смена";
  elif (CodeError == RSKKMERR_MERC13)
    StrErr = "ККМ: Буфер журнала пуст";
  elif (CodeError == RSKKMERR_MERC14)
    StrErr = "ККМ: Переполнение приемного буфера";
  elif (CodeError == RSKKMERR_MERC15)
    StrErr = "ККМ: Ошибка записи в фискальную память";
  elif (CodeError == RSKKMERR_MERC16)
    StrErr = "ККМ: Ошибка установка таймера";
  elif (CodeError == RSKKMERR_MERC17)
    StrErr = "ККМ: Неверный пароль налогового инспектора";
  elif (CodeError == RSKKMERR_MERC18)
    StrErr = "ККМ: Неверный пароль на связь";
  elif (CodeError == RSKKMERR_MERC19)
    StrErr = "ККМ: Исчерпан ресурс перерегистраций";
  elif (CodeError == RSKKMERR_MERC20)
    StrErr = "ККМ: Аппарат не фискализирован";
  elif (CodeError == RSKKMERR_MERC21)
    StrErr = "ККМ: Значение поля команды вне диапазона";
  elif (CodeError == RSKKMERR_MERC22)
    StrErr = "ККМ: Ошибка чтения фискальной памяти";
  elif (CodeError == RSKKMERR_MERC23)
    StrErr = "ККМ: Переполнение счетчика";
  elif (CodeError == RSKKMERR_MERC24)
    StrErr = "ККМ: Обязательное поле команды имеет нулевую длину";
  elif (CodeError == RSKKMERR_MERC25)
    StrErr = "ККМ: Неверный формат команды";
  elif (CodeError == RSKKMERR_MERC26)
    StrErr = "ККМ: Дата или время документа в смене меньше предыдущего";
  elif (CodeError == RSKKMERR_MERC27)
    StrErr = "ККМ: Исчерпан ресурс буфера журнала";
  elif (CodeError == RSKKMERR_MERC28)
    StrErr = "ККМ: Ошибка в расположении реквизитов";
  elif (CodeError == RSKKMERR_MERC29)
    StrErr = "ККМ: Нет такой команды";
  elif (CodeError == RSKKMERR_MERC30)
    StrErr = "ККМ: Неверная контрольная сумма";
  elif (CodeError == RSKKMERR_MERC31)
    StrErr = "ККМ: Нет фискальных записей";
  elif (CodeError == RSKKMERR_MERC32)
    StrErr = "ККМ: Невозможна печать буфера журнала";
  elif (CodeError == RSKKMERR_MERC33)
    StrErr = "ККМ: Оформление документа прервано|по окончанию ожидания принтера";
  elif (CodeError == RSKKMERR_MERC34)
    StrErr = "ККМ: При сторнировании или инкассации|денег меньше суммы операции";
  elif (CodeError == RSKKMERR_MERC35)
    StrErr = "ККМ: Переполнение счетчика сменных платежей";
  elif (CodeError == RSKKMERR_MERC36)
    StrErr = "ККМ: Буфер ответа пуст";

  /*****   Ошибки ККМ NCR 2113   *****/

  elif (CodeError == RSKKMERR_NCR_KEY)
    StrErr = "ККМ: Ключ не в Reg|либо не введен номер кассира";


            /*******   Неопознанные ошибки   **********/

  elif (CodeError ==  RSKKMERR_OTHER_ERR)
    StrErr = "Прочие ошибки";
  else
    StrErr = "Ошибка не описана";
  end;

  if (Silence == 0)
    MsgBox(" Ошибка " + String(CodeError) + " | " + StrErr + " ");
  end;

  return StrErr;

end;
