/*********************************************************************
* ---------------------                                              *
* R-Style SoftWare Lab.                                              *
* ---------------------                                              *
* RS-Retail 1.0                                                      *
*                                                                    *
* Работа с Контрольно-кассовой машиной ПРИМ-07Ф                      *
* Проверка возможности оплаты на ККМ                                 *
*                                                                    *
* Щукин О.И.                                                         *
* 10.12.98                                                           *
*********************************************************************/

import "kkm_val.mac","kkm_err.mac",prim;


var statP   = 0;                 /* Возвращенное значение функций */


macro PRIM_Check

  Message(" Проверка возможности оплаты на контрольно-кассовой машине...");

  /* Определение текущих параметров ККМ */
  statP = CheckPrim();

  if (statP == 7004)   /* Устройство не найдено */
    statP = RSKKMERR_NOT_DEVICE;
  end;
                       /* Крышка ККМ открыта */
  if ( ( statP == 7008 )  or  ( statP == 7009 ) )
    statP = RSKKMERR_COVER_OPEN;
  end;

  KKM_Parm.aRetCode = statP;

end;
