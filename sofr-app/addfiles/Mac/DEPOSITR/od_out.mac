
/* Опердневник ф.24 - процедуры вывода */

import OD_Comm, Acc_Form;

/***********************************************************/
macro Разделитель_1
  if (IsCur == 0)
    [-----------------------------------------------------------------------------------------];
  else
    [-------------------------------------------------------------------------------------------------------------------------------];
  end;
end;

macro OutDelim
  if(not IsCur)
    [------------------------------------------------------------------------------------------------------------------------------]
    (GetBranchName);
  else
    [-------------------------------------------------------------------------------------------------------------------------------];
  end;
end;

macro OutTitle

  var
    FormNo;

  if ( IsCur )
    FormNo = "Ф. 24-в"
  else
    FormNo = "Ф. 24"
  end;
  [ ];
  [Филиал № ###################                                                ##########]
  (GetBranchName, FormNo:r );
end;

macro OutSubTitle(Unit,DiaryNumber)
  OutTitle;
  [ ];
  if( IsCur )
    PrintLn("                                         Операционный дневник");
    PrintLn("                                        по валютным операциям № ", DiaryNumber(), " за ", {curdate});
  else
    PrintLn("                                         Операционный дневник № ", DiaryNumber(), " за ", {curdate});
  end;  
/*  PrintLn("                                                              ", Unit);*/
  [###############################################################################################################################](Unit:c);
  [ ];
end;

/***********************************************************/
macro Заголовок
  Разделитель_1 ();
  if (IsCur == 0)
    [   № лиц. |Содержание |        Наличные         |  Мемориальные обороты   |  Ценности   |];
    [  счета   | операции  |  Приход    |   Расход   | Зачисление |  Списание  |Приход|Расход|];
  else
    [   № лиц. |Содержание |    Наличные в рублях    | Мемор. обор. в рублях   |      Наличные     |Мемориальные обороты | Ценности|];
    [  счета   | операции  |  Приход    |   Расход   | Зачисление |  Списание  | Приход  |  Расход |Зачисление| Списание |Прих|Расх|];  end;
  Разделитель_1 ();
end;

/***********************************************************/
macro Заголовок_по_операционисту
  [ ];
  [ ];
  [     Операционист #### #](prs.Oper, prs.Name);
  Разделитель_1 ();
  if (IsCur == 0)
    [   № лиц. |Содержание |        Наличные         |  Мемориальные обороты   |  Ценности   |];
    [  счета   | операции  |  Приход    |   Расход   | Зачисление |  Списание  |Приход|Расход|];
  else
    [   № лиц. |Содержание |    Наличные в рублях    | Мемор. обор. в рублях   |      Наличные     |Мемориальные обороты | Ценности|];
    [  счета   | операции  |  Приход    |   Расход   | Зачисление |  Списание  | Приход  |  Расход |Зачисление| Списание |Прих|Расх|];
  end;
  Разделитель_1 ();
end;

/********************************************************** RA 21-07-00 */
macro Заголовок_по_операционисту_ОП
  [ ];
  [ ];
  [     Операционист #### #](prs.Oper, prs.Name);
  OutDelim();
  if (not IsCur)
    [                Содержание операции                |        Наличные         |     Мемор. обор.    |         Ценности        |];
    [                                                   |  Приход    |   Расход   |   Зач.   |   Спис.  |   Приход    |   Расход  |];
  else
    [     Содержание      |   Наличные в рублях   |   Мемор.об.в рублях   |      Наличные     |     Мемор. обор. |     Ценности    |];
    [      операции       |  Приход   |   Расход  |    Зач.   |   Спис.   | Приход  |  Расход |  Зач.   |  Спис. | Приход | Расход |];
  end;
  OutDelim();
end;

macro OutOpNameTail

  var i=1;

  while(i<asize(opName))
    [#######################################](opName(i));
    i=i+1;
  end;
end;

/***********************************************************/
macro limitStringSize(stringToLimit, limit)

 if(StrLen(stringToLimit) > limit)
   stringToLimit = SubStr(stringToLimit,1,limit);
 end;
 return stringToLimit;

end;

/***********************************************************/
macro Строка_отчета

  StrSplit(DepGround,opName,32);

  if (IsCur == 0)
    if (doc.InSum != 0) /* Приход       */
      if (doc.VidDoc != 0)/* Наличные   */
        [###################### ############                                        ###### ######
########################################]
         (Acc_Form(doc.Account), /*FIO,*/ doc.InSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      else              /* Безналичные  */
        [######################                           ############              ###### ######
########################################]
         (Acc_Form(doc.Account), /*FIO,*/ doc.InSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      end;
    else                        /* Расход       */
      if (doc.VidDoc != 0)/* Наличные   */
        [######################              ############                           ###### ######
########################################]
         (Acc_Form(doc.Account), /*FIO,*/ doc.OutSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      else              /* Безналичные  */
        [######################                                        ############ ###### ######
########################################]
         (Acc_Form(doc.Account), /*FIO,*/ doc.OutSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      end;
    end;
  else
    if (doc.InSum != 0) /* Приход       */
      if (doc.VidDoc != 0)/* Наличные   */
        [###################### ############                                       ##########                                 #### ####
########################################]
         (Acc_Form(doc.Account), /*FIO,*/Cur2Rub(doc.InSum):12:2:z, doc.InSum:10:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      else              /* Безналичные  */
        if ( doc.IsCur )
          [######################                            ###########                                   #########            #### ####
########################################]
           (Acc_Form(doc.Account), /*FIO,*/Cur2Rub(doc.InSum):12:2:z, doc.InSum:10:2:z, ValFormIn:z, ValFormOut:z,opName(0));
        else
          [######################                            ############                                                       ###### ######
########################################]
           (Acc_Form(doc.Account), /*FIO,*/doc.InSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
        end;
      end;
    else                        /* Расход       */
      if (doc.VidDoc != 0)/* Наличные   */
        [######################              ############                                    ##########                       #### ####
########################################]
         (Acc_Form(doc.Account), /*FIO,*/Cur2Rub(doc.OutSum):12:2:z, doc.OutSum:10:2:z, ValFormIn:z, ValFormOut:z,opName(0));
      else              /* Безналичные  */
        if ( doc.IsCur )
          [######################                                         ###########                                  ######## #### ####
########################################]
           (Acc_Form(doc.Account), /*FIO,*/Cur2Rub(doc.OutSum):12:2:z, doc.OutSum:10:2:z, ValFormIn:z, ValFormOut:z,opName(0));
        else
          [######################                                         ############                                          ###### ######
########################################]
           (Acc_Form(doc.Account), /*FIO,*/doc.OutSum:12:2:z, ValFormIn:z, ValFormOut:z,opName(0));
        end;
      end;
    end;
  end;
  OutOpNameTail;
end;

macro DepShowChVal( Credit, Debet )

  var
    OpCont;

  if ( CashDoc.NumOper == CASHOP_CHVALUE )
    OpCont = "Испорчен бланк";
  else
    /* Аттестаци с Ярославле 16.08.2001 - методолог Князева Ю. А.*/
    return;
    OpCont = "Приход испорченного";
  end;

  if (IsCur == 0)
    [######################                                                     ###### ###### ]
    ( ( OpCont + ": " + TmpCashVal.NameValue ):w, Credit:z,  Debet:z );  
  else 
    [######################                                                                                               #### #### ]
    ( ( OpCont + ": " + TmpCashVal.NameValue ):w, Credit:z,  Debet:z );  
  end;
end;

/***********************************************************/
macro Печать_Сумм

  Разделитель_1;
  if (IsCur == 0)
    [Итого по вкладам:    ############## ############ ############ ############ ###### ######]
    (SumOperIn:14:2,
     SumOperOut:12:2,
     SumBeznIn:12:2,
     SumBeznOut:12:2,
     SumValFormIn:6:2,
     SumValFormOut:6:2);
  else
    [Итого по вкладам:    ############## ############ ############ ############ ######### ######### ########## ########## #### ####]
    (SumOperInE:14:2,
     SumOperOutE:12:2,
     SumBeznInE:12:2,
     SumBeznOutE:12:2,
     SumOperIn:10:2,
     SumOperOut:10:2,
     SumBeznIn:10:2,
     SumBeznOut:10:2,
     SumValFormIn:6:2,
     SumValFormOut:6:2);
  end;
end;

/***********************************************************/
macro Печать_Сумм_ВВ(AccType)

  Разделитель_1;
  if (IsCur == 0)
    [Итого по виду вклада
######################## ############## ############ ############ ############ ###### ######]
    (AccType + ":",
     SumOperInAT:14:2,
     SumOperOutAT:12:2,
     SumBeznInAT:12:2,
     SumBeznOutAT:12:2,
     SumValFormInAT:6:2,
     SumValFormOutAT:6:2);
  else
    [Итого по виду вклада
######################## ############## ############ ############ ############ ######### ######### ########## ########## #### ####]
    (AccType + ":",
     SumOperInATE:14:2,
     SumOperOutATE:12:2,
     SumBeznInATE:12:2,
     SumBeznOutATE:12:2,
     SumOperInAT:10:2,
     SumOperOutAT:10:2,
     SumBeznInAT:10:2,
     SumBeznOutAT:10:2,
     SumValFormInAT:6:2,
     SumValFormOutAT:6:2);
  end;
end;

/***********************************************************/
macro Печать_Сумм_О

  if (IsCur == 0)
    [Итого по пользователю
#########                ############## ############ ############ ############ ###### ######]
    (GroupMember.Oper + ":",
     SumOperInO:14:2,
     SumOperOutO:12:2,
     SumBeznInO:12:2,
     SumBeznOutO:12:2,
     SumValFormInO:6:2,
     SumValFormOutO:6:2);
  else
    [Итого по пользователю
######################   ############## ############ ############ ############ ######### ######### ########## ########## #### ####]
    (GroupMember.Oper + ":",
     SumOperInOE:14:2,
     SumOperOutOE:12:2,
     SumBeznInOE:12:2,
     SumBeznOutOE:12:2,
     SumOperInO:10:2,
     SumOperOutO:10:2,
     SumBeznInO:10:2,
     SumBeznOutO:10:2,
     SumValFormInO:6:2,
     SumValFormOutO:6:2);
  end;
end;

macro OutHead

  OutDelim();
  if (not IsCur)
    [    № лицевого    |      Содержание операции       |        Наличные         |     Мемор. обор.    |         Ценности        |];
    [      счета       |                                |  Приход    |   Расход   |   Зач.   |   Спис.  |   Приход    |   Расход  |];
  else
    [№ лиц.  | Содержание |   Наличные в рублях   |   Мемор.об.в рублях   |      Наличные     |     Мемор. обор. |     Ценности    |];
    [счета   |  операции  | Приход    |   Расход  |    Зач.   |   Спис.   | Приход  |  Расход |  Зач.   |  Спис. | Приход | Расход |];
  end;
  OutDelim();
end;

macro OutOpContentTail

  var
    i = 1;

  while(i < ASize(OpContArr))
    if (IsCur == 0)
      [                   ##############################](OpContArr(i));
    else
      [########################](OpContArr(i));
    end;
    i = i + 1;
  end;
end;


/**************************************************************************
**************************************************************************/
macro OutLine (OpContent, TypeOtherOperation, CreditM, DebetM, CreditN, DebetN, CreditV, DebetV, IsCash, IsConv, IsUnpay)

  var
    TmpIsConv   = false,
    TmpIsUnpay  = false,
    CashDebet   = $0,
    CashCredit  = $0,
    MemDebet    = $0,
    MemCredit   = $0,
    CashDebetR  = $0,
    CashCreditR = $0,
    MemDebetR   = $0,
    MemCreditR  = $0;
  var SaveIsCur = IsCur;

  /* msgbox(CreditN); */

  if ( ValType( IsConv ) != V_UNDEF )
    TmpIsConv = IsConv;
  end;
  if ( ValType( IsUnpay ) != V_UNDEF )
    TmpIsUnpay = IsUnpay;
  end;

  if((IsCur == 0) OR (TypeOtherOperation == TOO_COMM_CONV))
    StrSplit(OpContent, OpContArr, 32);
    if(IsCash)
      CashDebet  = DebetM;
      CashCredit = CreditM;
      MemDebet   = DebetN;
      MemCredit  = CreditN;
    else
      MemDebet   = DebetM;
      MemCredit  = CreditM;
    end;
    [                   ################################ ############ ############ ########## ########## ############# ########### ]
    (
      OpContArr(0),
      CashCredit:z,
      CashDebet:z,
      MemCredit:z,
      MemDebet:z,
      CreditV:z,
      DebetV:z
    );
  else
    StrSplit(OpContent, OpContArr, 21);
    if ( not TmpIsConv )
      if(IsCash)
        CashDebet   = DebetM;
        CashCredit  = CreditM;
        CashCreditR = Cur2Rub(CreditM);
        CashDebetR  = Cur2Rub(DebetM);
      else
        MemDebet    = DebetM;
        MemCredit   = CreditM;
        MemCreditR  = Cur2Rub(CreditM);
        MemDebetR   = Cur2Rub(DebetM);
      end;
    else
      MemCreditR    = CreditM;
      MemDebetR     = DebetM;
    end;
    [##################### ########### ########### ########### ########### ######### ######### ######### ######## ######## ########]
    (
      OpContArr(0),
      CashCreditR:z,
      CashDebetR:z,
      MemCreditR:z,
      MemDebetR:z,
      CashCredit:z,
      CashDebet:z,
      MemCredit:z,
      MemDebet:z,
      CreditV:z,
      DebetV:z
    );
  end;
  if (TypeOtherOperation == TOO_COMM_CONV)
    IsCur = 0;
  end;
  OutOpContentTail();
  IsCur = SaveIsCur;
  if (TypeOtherOperation == TOO_COMM_CONV)
    TotCvCredit     = TotCvCredit     + CashCredit;
    TotCvDebet      = TotCvDebet      + CashDebet;
    TotCvMemCredit  = TotCvMemCredit  + MemCredit;
    TotCvMemDebet   = TotCvMemDebet   + MemDebet;
    TotCvCreditR    = TotCvCreditR    + CashCreditR;
    TotCvDebetR     = TotCvDebetR     + CashDebetR;
    TotCvMemCreditR = TotCvMemCreditR + MemCreditR;
    TotCvMemDebetR  = TotCvMemDebetR  + MemDebetR;
    TotCvCreditV    = TotCvCreditV    + CreditV;
    TotCvDebetV     = TotCvDebetV     + DebetV;
  elif( TmpIsUnpay )
    TotCashCreditU  = TotCashCreditU  + CashCredit;
    TotCashDebetU   = TotCashDebetU   + CashDebet;
    TotMemCredit    = TotMemCredit    + MemCredit;
    TotMemDebet     = TotMemDebet     + MemDebet;
    TotCashCreditRU = TotCashCreditRU + CashCreditR;
    TotCashDebetRU  = TotCashDebetRU  + CashDebetR;
    TotMemCreditR   = TotMemCreditR   + MemCreditR;
    TotMemDebetR    = TotMemDebetR    + MemDebetR;
    TotCreditVU     = TotCreditVU     + CreditV;
    TotDebetVU      = TotDebetVU      + DebetV;
  else
    TotCashCredit   = TotCashCredit   + CashCredit;
    TotCashDebet    = TotCashDebet    + CashDebet;
    TotMemCredit    = TotMemCredit    + MemCredit;
    TotMemDebet     = TotMemDebet     + MemDebet;
    TotCashCreditR  = TotCashCreditR  + CashCreditR;
    TotCashDebetR   = TotCashDebetR   + CashDebetR;
    TotMemCreditR   = TotMemCreditR   + MemCreditR;
    TotMemDebetR    = TotMemDebetR    + MemDebetR;
    TotCreditV      = TotCreditV      + CreditV;
    TotDebetV       = TotDebetV       + DebetV;
  end;

end;


/***************************************************************************
                        Вывод строки отчета для ОП  RA 21-07-00
***************************************************************************/
macro OutLineExch( NameOperation, R_In, R_Out, MR_In, MR_Out, C_In, C_Out, MC_In, MC_Out, Q_In, Q_Out, UR_In, UR_Out, UC_In, UC_Out, UQ_In, UQ_Out )
  if(not IsCur)
/*
    [                Содержание операции                |        Наличные         |     Мемор. обор.    |         Ценности        |];
    [                                                   |  Приход    |   Расход   |   Зач.   |   Спис.  |   Приход    |   Расход  |];
*/
    [################################################### ############ ############ ########## ########## ############# ########### ]
    ( NameOperation :w,
      (R_In +UR_In ):z,
      (R_Out+UR_Out):z,
       MR_In        :z,
       MR_Out       :z,
      (Q_In +UQ_In ):z,
      (Q_Out+UQ_Out):z
    );

/*
    [     Содержание      |   Наличные в рублях   |   Мемор.об.в рублях   |      Наличные     |     Мемор. обор. |     Ценности    |];
    [      операции       |  Приход   |   Расход  |    Зач.   |   Спис.   | Приход  |  Расход |  Зач.   |  Спис. | Приход | Расход |];
*/
  else
    [##################### ########### ########### ########### ########### ######### ######### ######### ######## ######## ########]
    ( NameOperation :w,
      (R_In +UR_In ):z,
      (R_Out+UR_Out):z,
       MR_In        :z,
       MR_Out       :z,
      (C_In +UC_In ):z,
      (C_Out+UC_Out):z,
       MC_In        :z,
       MC_Out       :z,
      (Q_In +UQ_In ):z,
      (Q_Out+UQ_Out):z
    );
                                           
  end;
    /* накопление сумм для печати итогов */

    TotExCreditR    = TotExCreditR    + R_In;  
    TotExDebetR     = TotExDebetR     + R_Out; 
    TotExMemCreditR = TotExMemCreditR + MR_In; 
    TotExMemDebetR  = TotExMemDebetR  + MR_Out;

    TotExCredit     = TotExCredit     + C_In;  
    TotExDebet      = TotExDebet      + C_Out; 
    TotExMemCredit  = TotExMemCredit  + MC_In; 
    TotExMemDebet   = TotExMemDebet   + MC_Out;

    TotExCreditV    = TotExCreditV    + Q_In;  
    TotExDebetV     = TotExDebetV     + Q_Out; 

    TotExCreditU    = TotExCreditU    + UC_In;
    TotExDebetU     = TotExDebetU     + UC_Out; 
    TotExCreditRU   = TotExCreditRU   + UR_In;
    TotExDebetRU    = TotExDebetRU    + UR_Out; 
    TotExCreditVU   = TotExCreditVU   + UQ_In;
    TotExDebetVU    = TotExDebetVU    + UQ_Out; 

  if( not IsCur )
    TotExCredit     = TotExCredit     + R_In;  
    TotExDebet      = TotExDebet      + R_Out; 
    TotExMemCredit  = TotExMemCredit  + MR_In; 
    TotExMemDebet   = TotExMemDebet   + MR_Out;
    TotExCreditU    = TotExCreditU    + UR_In;  
    TotExDebetU     = TotExDebetU     + UR_Out; 
  end;

end;


/***************************************************************************
***************************************************************************/
macro OutTotals

  OutDelim;
  if(not IsCur)
    [ ################################################## ############ ############ ########## ########## ############# ###########]
    (
      "Итого по прочим операциям:",
      TotCashCredit + TotCashCreditU,
      TotCashDebet  + TotCashDebetU,
      TotMemCredit,
      TotMemDebet ,
      TotCreditV    + TotCreditVU,
      TotDebetV     + TotDebetVU
    );
  else
    [#################### ########### ########### ########### ########### ######### ######### ######### ######## ######## ########]
    (
      "Итого по прочим операциям:":w,
      TotCashCreditR + TotCashCreditRU,
      TotCashDebetR  + TotCashDebetRU,
      TotMemCreditR,
      TotMemDebetR,
      TotCashCredit  + TotCashCreditU,
      TotCashDebet   + TotCashDebetU,
      TotMemCredit,
      TotMemDebet,
      TotCreditV     + TotCreditVU,
      TotDebetV      + TotDebetVU
    );
  end;
end;


/***************************************************************************
***************************************************************************/
macro OutTotalsCv

  OutDelim;
  if(not IsCur)
    [ ################################################## ############ ############ ########## ########## ########### #########]
    (
      "Итого по конвертациям:",
      TotCvCredit,
      TotCvDebet,
      TotCvMemCredit,
      TotCvMemDebet,
      TotCvCreditV,
      TotCvDebetV
    );
  else
    [########################### ######### ########### ########### ########### ######### ######### ######### ######## ###### ######]
    (
      "Итого по конвертациям:",
      TotCvCreditR,
      TotCvDebetR,
      TotCvMemCreditR,
      TotCvMemDebetR,
      TotCvCredit,
      TotCvDebet,
      TotCvMemCredit,
      TotCvMemDebet,
      TotCvCreditV,
      TotCvDebetV
    );
  end;
end;


/***************************************************************************
                        Вывод итога по обмену валюты  RA 21-07-00
***************************************************************************/
macro OutTotalsEx

  OutDelim;
  if(not IsCur)
/*
    [                Содержание операции                |        Наличные         |     Мемор. обор.    |         Ценности        |];
    [                                                   |  Приход    |   Расход   |   Зач.   |   Спис.  |   Приход    |   Расход  |];
*/
    [ ################################################## ############ ############ ########## ########## ############# ###########]
    (
      "Итого по обмену валюты:",
      TotExCredit   + TotExCreditU,
      TotExDebet    + TotExDebetU,
      TotExMemCredit,
      TotExMemDebet,
      TotExCreditV  + TotExCreditVU,
      TotExDebetV   + TotExDebetVU
    );
  else
/*
    [     Содержание      |   Наличные в рублях   |   Мемор.об.в рублях   |      Наличные     |     Мемор. обор. |     Ценности    |];
    [      операции       |  Приход   |   Расход  |    Зач.   |   Спис.   | Приход  |  Расход |  Зач.   |  Спис. | Приход | Расход |];

*/
    [##################### ########### ########### ########### ########### ######### ######### ######### ######## ######## ########]
    (
      "Итого по обмену валюты:":w,
      TotExCreditR   + TotExCreditRU,
      TotExDebetR    + TotExDebetRU,
      TotExMemCreditR,
      TotExMemDebetR,
      TotExCredit    + TotExCreditU,
      TotExDebet     + TotExDebetU,
      TotExMemCredit,
      TotExMemDebet,
      TotExCreditV   + TotExCreditVU,
      TotExDebetV    + TotExDebetVU
    );
  end;
end;


macro OutTotalsHead( DiaryNumber )

  [ ];
  [ ];
  if( IsCur )
    PrintLn("                        Итоги валютного операционного дневника № ", DiaryNumber, " за ", {curdate});
  else
    PrintLn("                                  Итоги операционного дневника № ", DiaryNumber, " за ", {curdate});
  end;
  [ ];
end;

macro OutSignForm

  [ ];
  [ ];
  [------------------------------------------------------------------------------------------------------------------------------];
  [Ст. контролер(контролер) ________________________________________________ Кассир _____________________________________________];
  [ ];
  [Отчет проверил "___" ________________ _______ г.                          Бухгалтер __________________________________________];
  [ ];
  PrintLn(StrFor(12));
end;

macro OutTotalsR(
  PrevRestCn,
  RestCn,
  PrevRestCnV,
  RestCnV,
  PrevRestM,
  PrevRestME,
  PrevRestV,
  RestM,
  RestME,
  RestV,
  CurRestM,
  CurRestV )

  OutDelim;
  [                                                   |        Наличные         |      Безналичные        |      Ценности       |];
  [                                                   |  Приход    |   Расход   | Зачисление |  Списание  |  Приход  |   Расход |];
  OutDelim;
  [Остаток на начало дня (платежные)                  #############                                        ##########              ]
  (PrevRestM, PrevRestV:z);
  if ( not ExternPantry )
    [В том числе монеты                                 #############                                                                  ]
    (PrevRestCn);
  end;
  [Итого по операциям за день - Вклады                ############# ############ ############ ############ ########## ##########]
  (SumOperIn       :12:2:z,
   SumOperOut      :12:2:z,
   SumBeznIn       :12:2:z,
   SumBeznOut      :12:2:z,
   /*Money(SumValFormIn  * 100)*/ 0:12:0:z,
   /*Money(SumValFormOut * 100)*/ 0:12:0:z);
  [Итого по операциям за день - Прочие операции       ############# ############ ############ ############ ########## ##########]
  (TotCashCredit   :12:2:z,
   TotCashDebet    :12:2:z,
   TotMemCredit    :12:2:z,
   TotMemDebet     :12:2:z,
   /*TotCreditV*/      0:12:0:z,
   /*TotDebetV*/       0:12:0:z);
   /* RA 18-07-00 */
  [Итого по операциям за день - Обмен валюты          ############# ############ ############ ############ ########## ##########]
  (TotExCredit     :12:2:z,
   TotExDebet      :12:2:z,
   TotExMemCredit  :12:2:z,
   TotExMemDebet   :12:2:z,
   /*TotExCreditV*/    0:12:0:z,
   /*TotExDebetV*/     0:12:0:z);
  if (BrigadeCur == 3)
    [Итого по операциям за день - Операции конвертации  ############# ############ ############ ############ ########## ##########]
    (TotCvCredit   :12:2:z,
     TotCvDebet    :12:2:z,
     TotCvMemCredit:12:2:z,
     TotCvMemDebet :12:2:z,
     /*TotCvCreditV*/  0:12:0:z,
     /*TotCvDebetV*/   0:12:0:z);
  else
    TotCvCredit    =
    TotCvDebet     =
    TotCvMemCredit =
    TotCvMemDebet  =
    TotCvCreditV   =
    TotCvDebetV    = $0;
  end;
  [Итого по операциям за день - Всего                 ############# ############ ############ ############ ########## ##########]
  (
    ( SumOperIn                  + TotCashCredit + TotCvCredit    + TotExCredit    ):12:2:z,
    ( SumOperOut                 + TotCashDebet  + TotCvDebet     + TotExDebet     ):12:2:z,
    ( SumBeznIn                  + TotMemCredit  + TotCvMemCredit + TotExMemCredit ):12:2:z,
    ( SumBeznOut                 + TotMemDebet   + TotCvMemDebet  + TotExMemDebet  ):12:2:z,
    /*( Money(SumValFormIn  * 100) + TotCreditV    + TotCvCreditV   + TotExCreditV   )*/ 0:12:0:z,
    /*( Money(SumValFormOut * 100) + TotDebetV     + TotCvDebetV    + TotExDebetV    )*/ 0:12:0:z
  );
  [Остаток на конец дня (платежные)                   #############                                        ##########]
  (RestM, RestV:z);
  if ( not ExternPantry )
    [В том числе монеты                                 #############                                                     ]
    (RestCn);
  end;
  if((CurRestM != RestM ) /*OR (CurRestV != RestV + RestCnV)*/)
    [ВНИМАНИЕ!!!! ОСТАТОК НА КОНЕЦ ДНЯ НЕ СОВПАДАЕТ С ОСТАТКОМ КАССЫ];
  end;
  OutDelim;
end;

/* неплатежка */
macro OutTotalsR_Unpay(
  PrevRestCn,
  RestCn,
  PrevRestCnV,
  RestCnV,
  PrevRestM,
  PrevRestME,
  PrevRestV,
  RestM,
  RestME,
  RestV,
  CurRestM,
  CurRestV )
/*
  OutDelim;
  [                                                   |        Наличные         |      Безналичные        |      Ценности       |];
  [                                                   |  Приход    |   Расход   | Зачисление |  Списание  |  Приход  |   Расход |];
  OutDelim;
*/
  [Остаток на начало дня (неплатежные)                #############                                        ##########              ]
  (PrevRestM, PrevRestV:z);
  if ( not ExternPantry )
    [В том числе монеты                                 #############                                                                  ]
    (PrevRestCn);
  end;
  [Итого по операциям за день - Вклады                ############# ############ ############ ############ ########## ##########]
  (0             :12:2:z,
   0             :12:2:z,
   0             :12:2:z,
   0             :12:2:z,
   0             :12:0:z,
   0             :12:0:z);
  [Итого по операциям за день - Прочие операции       ############# ############ ############ ############ ########## ##########]
  (TotCashCreditU:12:2:z,
   TotCashDebetU :12:2:z,
   0             :12:2:z,
   0             :12:2:z,
   /*TotCreditVU*/   0:12:0:z,
   /*TotDebetVU*/    0:12:0:z);
   /* RA 18-07-00 */
  [Итого по операциям за день - Обмен валюты          ############# ############ ############ ############ ########## ##########]
  (TotExCreditU  :12:2:z,
   TotExDebetU   :12:2:z,
   0             :12:2:z,
   0             :12:2:z,
   /*TotExCreditVU*/ 0:12:0:z,
   /*TotExDebetVU*/  0:12:0:z);
  if (BrigadeCur == 3)
    [Итого по операциям за день - Операции конвертации  ############# ############ ############ ############ ########## ##########]
    (0           :12:2:z,
     0           :12:2:z,
     0           :12:2:z,
     0           :12:2:z,
     0           :12:0:z,
     0           :12:0:z);
  else
    TotCvCredit    =
    TotCvDebet     =
    TotCvMemCredit =
    TotCvMemDebet  =
    TotCvCreditV   =
    TotCvDebetV    = $0;
  end;
  [Итого по операциям за день - Всего                 ############# ############ ############ ############ ########## ##########]
  (
    ( /*SumOperIn                 */0 + TotCashCreditU/*+ TotCvCredit*/  + TotExCreditU    ):12:2:z,
    ( /*SumOperOut                */0 + TotCashDebetU /*+ TotCvDebet */  + TotExDebetU     ):12:2:z,
    ( /*SumBeznIn                 */0/*+TotMemCredit    + TotCvMemCredit + TotExMemCredit*/):12:2:z,
    ( /*SumBeznOut                */0/*+TotMemDebet     + TotCvMemDebet  + TotExMemDebet */):12:2:z,
    /*( Money(SumValFormIn  * 100) + TotCreditVU   /*+ TotCvCreditV*/ + TotExCreditVU   ) */ 0:12:0:z,
    /*( Money(SumValFormOut * 100) + TotDebetVU    /*+ TotCvDebetV */ + TotExDebetVU    ) */ 0:12:0:z
  );
  [Остаток на конец дня (неплатежные)                 #############                                        ##########]
  (RestM, RestV:z);
  if ( not ExternPantry )
    [В том числе монеты                                 #############                                                     ]
    (RestCn);
  end;
  if((CurRestM != RestM - RestCn ) /*OR (CurRestV != RestV + RestCnV)*/)
    [ВНИМАНИЕ!!!! ОСТАТОК НА КОНЕЦ ДНЯ НЕ СОВПАДАЕТ С ОСТАТКОМ КАССЫ];
  end;
  OutDelim;
end;

macro OutTotalsC(
  PrevRestCn,
  RestCn,
  PrevRestCnV,
  RestCnV,
  PrevRestM,
  PrevRestME,
  PrevRestV,
  RestM,
  RestME,
  RestV,
  CurRestM,
  CurRestV )

  OutDelim;
  [                           |    Наличные в рублях    |Безналичные в рублях |   Наличные      |   Безналичные   |    Ценности  |];
  [                           |  Приход    |   Расход   |Зачисление| Списание | Приход | Расход |Зачислен|Списаниe|Приход |Расход|];
  OutDelim;
  [Остаток на начало дня      #############                                  ##########                            #######
  (платежные)]
  (PrevRestME, PrevRestM, PrevRestV:z);
  [Итого по операциям за день];
  [         - Вклады          ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (SumOperInE        :12:2:z,
   SumOperOutE       :12:2:z,
   SumBeznInE        :12:2:z,
   SumBeznOutE       :12:2:z,
   SumOperIn         :10:2:z,
   SumOperOut        :10:2:z,
   SumBeznIn         :10:2:z,
   SumBeznOut        :10:2:z,
   /*Money(SumValFormIn  * 100)*/ 0:12:0:z,
   /*Money(SumValFormOut * 100)*/ 0:12:0:z);
  [         - Прочие операции ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (TotCashCreditR    :12:2:z,
   TotCashDebetR     :12:2:z,
   TotMemCreditR     :12:2:z,
   TotMemDebetR      :12:2:z,
   TotCashCredit     :10:2:z,
   TotCashDebet      :10:2:z,
   TotMemCredit      :10:2:z,
   TotMemDebet       :10:2:z,
   /*TotCreditV*/        0:12:0:z,
   /*TotDebetV*/         0:12:0:z);
   /* RA 18-07-00 */
  [         - Обмен валюты    ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (TotExCreditR      :12:2:z,
   TotExDebetR       :12:2:z,
   TotExMemCreditR   :12:2:z,
   TotExMemDebetR    :12:2:z,
   TotExCredit       :10:2:z,
   TotExDebet        :10:2:z,
   TotExMemCredit    :10:2:z,
   TotExMemDebet     :10:2:z,
   /*TotExCreditV*/      0:12:0:z,
   /*TotExDebetV*/       0:12:0:z);
  if (BrigadeCur == 1)
    [         - Конвертации     ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
    (TotCvCreditR    :12:2:z,
     TotCvDebetR     :12:2:z,
     TotCvMemCreditR :12:2:z,
     TotCvMemDebetR  :12:2:z,
     TotCvCredit     :10:2:z,
     TotCvDebet      :10:2:z,
     TotCvMemCredit  :10:2:z,
     TotCvMemDebet   :10:2:z,
     /*TotCvCreditV*/    0:12:0:z,
     /*TotCvDebetV*/     0:12:0:z);
  end;
  [         - Итого           ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  ((SumOperInE                 + TotCashCreditR + TotCvCreditR    + TotExCreditR    ):12:2:z,
   (SumOperOutE                + TotCashDebetR  + TotCvDebetR     + TotExDebetR     ):12:2:z,
   (SumBeznInE                 + TotMemCreditR  + TotCvMemCreditR + TotExMemCreditR ):12:2:z,
   (SumBeznOutE                + TotMemDebetR   + TotCvMemDebetR  + TotExMemDebetR  ):12:2:z,
   (SumOperIn                  + TotCashCredit  + TotCvCredit     + TotExCredit     ):10:2:z,
   (SumOperOut                 + TotCashDebet   + TotCvDebet      + TotExDebet      ):10:2:z,
   (SumBeznIn                  + TotMemCredit   + TotCvMemCredit  + TotExMemCredit  ):10:2:z,
   (SumBeznOut                 + TotMemDebet    + TotCvMemDebet   + TotExMemDebet   ):10:2:z,
   /*(Money(SumValFormIn  * 100) + TotCreditV     + TotCvCreditV    + TotExCreditV    )*/ 0:12:0:z,
   /*(Money(SumValFormOut * 100) + TotDebetV      + TotCvDebetV     + TotExDebetV     )*/ 0:12:0:z );
  [Остаток на конец дня       #############                                  ##########                            #######
  (платежные)]
  (RestME, RestM, RestV:z);
  if((CurRestM != RestM - RestCn ) /*OR (CurRestV != RestV + RestCnV)*/)
    [ВНИМАНИЕ!!!! ОСТАТОК НА КОНЕЦ ДНЯ НЕ СОВПАДАЕТ С ОСТАТКОМ КАССЫ];
  end;
  OutDelim;
  if(Curr.Code_Currency != 0 )
  [Потрачено в руб. на покупку вал. мелочи  ############]
    (CentsBought);
    [Положительная курсовая разница                                            ##########]
    (TotConvYield);
    OutDelim;
  end;
end;

/* неплатежка */
macro OutTotalsC_Unpay(
  PrevRestCn,
  RestCn,
  PrevRestCnV,
  RestCnV,
  PrevRestM,
  PrevRestME,
  PrevRestV,
  RestM,
  RestME,
  RestV,
  CurRestM,
  CurRestV )
/*
  OutDelim;
  [                           |    Наличные в рублях    |Безналичные в рублях |   Наличные      |   Безналичные   |    Ценности  |];
  [                           |  Приход    |   Расход   |Зачисление| Списание | Приход | Расход |Зачислен|Списаниe|Приход |Расход|];
  OutDelim;
*/
  [Остаток на начало дня      #############                                  ##########                            #######
  (неплатежные)]
  (PrevRestME, PrevRestM, PrevRestV:z);
  [Итого по операциям за день];
  [         - Вклады          ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (0               :12:2:z,
   0               :12:2:z,
   0               :12:2:z,
   0               :12:2:z,
   0               :10:2:z,
   0               :10:2:z,
   0               :10:2:z,
   0               :10:2:z,
   0               :12:0:z,
   0               :12:0:z);
  [         - Прочие операции ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (TotCashCreditRU :12:2:z,
   TotCashDebetRU  :12:2:z,
   0               :12:2:z,
   0               :12:2:z,
   TotCashCreditU  :10:2:z,
   TotCashDebetU   :10:2:z,
   0               :10:2:z,
   0               :10:2:z,
   /*TotCreditVU*/     0:12:0:z,
   /*TotDebetVU*/      0:12:0:z);
   /* RA 18-07-00 */
  [         - Обмен валюты    ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  (TotExCreditRU   :12:2:z,
   TotExDebetRU    :12:2:z,
   0               :12:2:z,
   0               :12:2:z,
   TotExCreditU    :10:2:z,
   TotExDebetU     :10:2:z,
   0               :10:2:z,
   0               :10:2:z,
   /*TotExCreditVU*/  0:12:0:z,
   /*TotExDebetVU*/   0:12:0:z);
  if (BrigadeCur == 1)
    [         - Конвертации     ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
    (0             :12:2:z,
     0             :12:2:z,
     0             :12:2:z,
     0             :12:2:z,
     0             :10:2:z,
     0             :10:2:z,
     0             :10:2:z,
     0             :10:2:z,
     0             :12:0:z,
     0             :12:0:z);
  end;
  [         - Итого           ############# ############ ########## ########## ######## ######## ######## ######## ####### #######]
  ((/*SumOperInE                */0  + TotCashCreditRU/*+ TotCvCreditR */ + TotExCreditRU    ):12:2:z,
   (/*SumOperOutE               */0  + TotCashDebetRU /*+ TotCvDebetR  */ + TotExDebetRU     ):12:2:z,
   (/*SumBeznInE                */0/*+ TotMemCreditR    + TotCvMemCreditR + TotExMemCreditR*/):12:2:z,
   (/*SumBeznOutE               */0/*+ TotMemDebetR     + TotCvMemDebetR  + TotExMemDebetR */):12:2:z,
   (/*SumOperIn                 */0  + TotCashCreditU /*+ TotCvCredit  */ + TotExCreditU     ):10:2:z,
   (/*SumOperOut                */0  + TotCashDebetU  /*+ TotCvDebet   */ + TotExDebetU      ):10:2:z,
   (/*SumBeznIn                 */0/*+ TotMemCredit     + TotCvMemCredit  + TotExMemCredit */):10:2:z,
   (/*SumBeznOut                */0/*+ TotMemDebet      + TotCvMemDebet   + TotExMemDebet  */):10:2:z,
   /*(Money(SumValFormIn  * 100)  + TotCreditVU    /*+ TotCvCreditV */ + TotExCreditVU    )*/ 0:12:0:z,
   /*(Money(SumValFormOut * 100)  + TotDebetVU     /*+ TotCvDebetV  */ + TotExDebetVU     )*/ 0:12:0:z );
  [Остаток на конец дня       #############                                  ##########                            #######
  (неплатежные)]
  (RestME, RestM, RestV:z);
  if((CurRestM != RestM - RestCn ) /*OR (CurRestV != RestV + RestCnV)*/)
    [ВНИМАНИЕ!!!! ОСТАТОК НА КОНЕЦ ДНЯ НЕ СОВПАДАЕТ С ОСТАТКОМ КАССЫ];
  end;
  OutDelim;
  /*
  if(Curr.Code_Currency != 0 )
  [Потрачено в руб. на покупку вал. мелочи  ############]
    (CentsBought);
    [Положительная курсовая разница                                            ##########]
    (TotConvYield);
    OutDelim;
  end;
  */
end;

/* печать итога по ценностям */
macro OutTotalsQ( PrevRest, Rest, CurRest, DiaryNumber )

   PrintLn( "   Итоги операционного дневника № ", DiaryNumber );
   PrintLn( "        за ", {curdate}, " по ценностям" );  
  [------------------------------------------------------];
  [                           |         Ценности        |];
  [                           |   Приход   |   Расход   |];
  [------------------------------------------------------];

  [Остаток на начало дня                      #
  (ценности)]
  (PrevRest);
  [Итого по операциям за день];
  [         - Вклады                      #            # ]
  (SumValFormIn_2  :12:2:z,
   SumValFormOut_2 :12:2:z);
  [         - Прочие операции             #            # ]
  (TotCreditV_2    :12:2:z,
   TotDebetV_2     :12:2:z);
  [         - Обмен валюты                #            # ]
  (TotExCreditV_2  :12:2:z,
   TotExDebetV_2   :12:2:z);
  if ((TotCvCreditV_2 != 0) or (TotCvDebetV_2 != 0))
    [         - Конвертации                 #            # ]
    (TotCvCreditV_2:12:2:z,
     TotCvDebetV_2 :12:2:z);
  end;
  [         - Итого                       #            # ]
  ((SumValFormIn_2 + TotCreditV_2 + TotCvCreditV_2 + TotExCreditV_2 ):12:2:z,
   (SumValFormOut_2 + TotDebetV_2  + TotCvDebetV_2  + TotExDebetV_2  ):12:2:z );
  [Остаток на конец дня                       #
  (ценности)]
  (Rest);
  if( CurRest != Rest )
    [ВНИМАНИЕ!!!! ОСТАТОК НА КОНЕЦ ДНЯ НЕ СОВПАДАЕТ С ОСТАТКОМ КАССЫ];
  end;
  OutDelim;

end;