
/*
**  Объявление на взнос наличными для Прочих операций
**
*/

import CashDecl;

record OC_PAY_DOC ( "pay_doc.np" );
record OC_PAY_DOC_PMNT_PROP("RTPaymentProp.dbt");
file   PayDoc     ( "pay_doc.dbt") write key 2;

var
  {curdate},
  Decl : TCashDecl,
  Operation,
  Number;

  GetInt( Number, "Введите номер объявления" );
  if ( ValType( Number ) == V_INTEGER )

   /* Номер объявления на взнос наличными сохраняем в pay_doc.NDoc */
    PayDoc.iApplicationKind = OC_PAY_DOC.iApplicationKind;
    PayDoc.ApplicationKey = OC_PAY_DOC.ApplicationKey;
    if ( GetEQ( PayDoc ) )
      PayDoc.NDoc = Number;
      Update( PayDoc );
    end;

    Decl.Number = Number;
    Decl.DocDate = OC_PAY_DOC.Date_Document;
    Decl.PayerName = OC_PAY_DOC.ClientLastName + " " + OC_PAY_DOC.ClientFirstName + " " + OC_PAY_DOC.ClientSecondName;
    Decl.RcvBank = OC_PAY_DOC_PMNT_PROP.BankName;
    Decl.RcvBIC = OC_PAY_DOC_PMNT_PROP.BankCode;
    Decl.RcvName = OC_PAY_DOC_PMNT_PROP.Name;
    Decl.Ground = OC_PAY_DOC.Ground;

    if( OC_PAY_DOC.ApplType )
      Operation = OC_PAY_DOC.NumOpert * 1000 + OC_PAY_DOC.ApplType;
    else
      Operation = OC_PAY_DOC.NumOpert;
    end;

    Decl.Sum = OC_PAY_DOC.InSum;

    Decl.Print;
  end;
end;
