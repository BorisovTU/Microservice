import rsd, CommonInter;

macro SetRtGlobalVariables

  private var flag_Cur    = NumFlagCur();
  private var FNCash      = NumFNCash();
  private var RealFNCash  = NumRealFNcash();
  private var {CNum};
  private var {curdate};
  private var {Name_Bank};
  private var {EoyProcRunning} = GetCurrentMode;
  
  private var {oper} ;
  private var OperBrigade = GetOperBrigade;
  private var TrnNumber   = GetTransactionNumber;


  var cmdSetVar;
  // Определим глобальные переменные
  cmdSetVar = RsdCommand( "begin RSU_RTLCOMMON.SetRtGlobalVariables( ?, ?, ?, ?, ?, ?, ?, ? ); end;" );
  cmdSetVar.addParam( "CNum",        RSDBP_IN );  cmdSetVar.value( "CNum" )        = {CNum};
  cmdSetVar.addParam( "TrnNumber",   RSDBP_IN );  cmdSetVar.value( "TrnNumber" )   = TrnNumber;
  cmdSetVar.addParam( "FNCash",      RSDBP_IN );  cmdSetVar.value( "FNCash" )      = FNCash; 
  cmdSetVar.addParam( "RealFNCash",  RSDBP_IN );  cmdSetVar.value( "RealFNCash" )  = RealFNCash;
  cmdSetVar.addParam( "FlagCur",     RSDBP_IN );  cmdSetVar.value( "FlagCur" )     = flag_Cur;
  cmdSetVar.addParam( "Oper",        RSDBP_IN );  cmdSetVar.value( "Oper" )        = {Oper};
  cmdSetVar.addParam( "CurDate",     RSDBP_IN );  cmdSetVar.value( "CurDate" )     = {curdate};
  cmdSetVar.addParam( "OperBrigade", RSDBP_IN );  cmdSetVar.value( "OperBrigade" ) = OperBrigade ;

  cmdSetVar.execute;

  OnError ( e )
    var i = 0;
    while ( i < RslDefEnv.ErrorCount )
      println ( " Системная ошибка - " + RslDefEnv.Error(i).descr );
      i = i + 1;
    end;
end;

