/*

    Общий макрос для ЗАПРЕТА опреаций вносителю в валюте

*/
Import alg_vars;

Private const ACCOUNT_IMPORTER = StrFor (4);   /* Вноситель */

Private const OP_OPENCAS =  1;  // Открытие счета наличными.
Private const OP_OPENNCS = 51;  // Открытие счета безналичными.
Private const OP_OPENTRN = 58;  // Открытие счета переводом.

macro CheckOwner

   ALG_RESULT = OK_RES;
   
   if ( ALG_SBDEPDOC.Author == ACCOUNT_IMPORTER )
     if ( GetBankStandart() == 0 )  /* Только для Сбербанка */
       if ( ( ALG_SBDEPDOC.TypeOper != OP_OPENCAS )  AND  // Открытие счета наличными.
            ( ALG_SBDEPDOC.TypeOper != OP_OPENNCS )  AND  // Открытие счета безналичными.
            ( ALG_SBDEPDOC.TypeOper != OP_OPENTRN ) )     // Открытие счета переводом.
           MsgBox("Для вносителя операции запрещены");
           ALG_RESULT = ERR_RES;
       end;
     end;
   elif ((ALG_SBDEPDOC.Type_Account == "Европейский") /* Сравнение- в валюте счета */
     OR  (ALG_SBDEPDOC.Type_Account == "Универсальн.")
     OR  (ALG_SBDEPDOC.Type_Account == "Нов.европ.1г")
     OR  (ALG_SBDEPDOC.Type_Account == "Нов.европ.2г")
     OR  (ALG_SBDEPDOC.Type_Account == "ЕВРО-деп. 1м")
     OR  (ALG_SBDEPDOC.Type_Account == "ЕВРО-деп. 3м")
     OR  (ALG_SBDEPDOC.Type_Account == "ЕВРО-деп. 6м") )
     if (ALG_SBDEPDOC.InSum < ALG_PARAM.prmD)
         MsgBox ("Минимальная сумма прихода - ",ALG_PARAM.prmD);
         ALG_RESULT = ERR_RES;
       else
       ALG_RESULT = SKIP_RES;
     end;
   end;

end;
