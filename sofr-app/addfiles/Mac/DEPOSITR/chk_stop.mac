/***************************************************************************\
  Образец макроса проверки по стоп-листам

  Главная программа CheckStopList(typeOp, rec)
    входные параметры:
      typeOp - код типа операции               |  rec - структура таблицы
   --------------------------------------------+---------------------------
        1 - ввод / обновление записи о клиенте |    TDepClient
        2 - вкладная финансовая                |    sbdepdoc.dbt
        3 - вкладная нефинансовая              |    depositr.dbt
        4 - прочая приходная / расходная       |    pay_doc.dbt
        5 - ценные бумаги и ценности           |    ci_doc.dbt
        6 - валютно-обменная операция          |    exoperat.dbt

    возвращаемый результат:
      0 - проверка прошла успешно, операция продолжается
     -1 - проверка не прошла, операция завершается
      1 - проверка прошла успешно, продолжить проверку в стандартном режиме

\***************************************************************************/

import CommonInter; 

const FIO      = 1,
      Document = 2;

macro CheckDepClient(dep:TDepClient):integer

//  здесь находится код проверки 
//  println("CheckDepClient. Код клиента: " + string(dep.rec.CodClient));

  return 0;
end;

macro CheckSbDepDoc(rec):integer

  record r( "sbdepdoc" );

  setBuff( r, rec );

//  здесь находится код проверки 
//  println("CheckSbDepDoc. Счет: " + r.Account);

  return 0;
end;

macro CheckDepositr(rec):integer

  record r( "depositr" );

  setBuff( r, rec );

//  здесь находится код проверки 
//  println("CheckDepositr. Код клиента: " + string(r.CodClient));

  return 0;
end;

macro CheckPay_Doc(rec):integer

  record r( "pay_doc" );

  setBuff( r, rec );

//  здесь находится код проверки 
//  println("CheckPay_Doc. Номер операции: " + string(r.NumOpert));

  return 0;
end;

macro CheckCi_Doc(rec):integer

  record r( "ci_doc" );

  setBuff( r, rec );

//  здесь находится код проверки 
//  println("CheckCi_Doc. Сумма: " + string(r.Sum));

  return 0;
end;

macro CheckExOperat(rec):integer

  record r( "exoperat", "exchange.def" );

  setBuff( r, rec );

//  здесь находится код проверки 
//  println("CheckExOperat. Вид операции: " + string(r.Kind_Oper));

  return 0;
end;

macro CheckMonTrans(rec):integer

  record r( "rmto_trans" );

  setBuff( r, rec );

//  здесь находится код проверки 

  return 0;
end;

macro CheckStopList(typeOp:integer, rec): integer

  var result = -1;

  if (typeOp == 1)
    result = CheckDepClient(rec);
  elif (typeOp == 2)
    result = CheckSbDepDoc(rec);
  elif (typeOp == 3)
    result = CheckDepositr(rec);
  elif (typeOp == 4)
    result = CheckPay_Doc(rec);
  elif (typeOp == 5)
    result = CheckCi_Doc(rec);
  elif (typeOp == 6)
    result = CheckExOperat(rec);
  elif (typeOp == 7)
    result = CheckMonTrans(rec);
  end;
/*
  if (result == -1)
    msgbox("проверка по блокирующим стоп-листам не прошла");
  elif (result == -2)
    msgbox("проверка по предупреждающим стоп-листам не прошла");
  else 
    msgbox("проверка по стоп-листам прошла");
  end;
*/
  return result;
end;


macro ChkOnTerrorists( paymAppKind : integer, paymAppKey : string, payfId : integer, typeFind )
// Здесь проверяем стоп листы
end;
