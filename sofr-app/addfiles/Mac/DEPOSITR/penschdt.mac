
/* Смена вида вклада для зачисления пенсии */

record ALG_OPERPRM("oper_prm.1");

CONST
  ПЕНСИЯ                                       =  2,
  ПЕНСИЯ_МО                                    =  5,
  ПЕНСИЯ_МВД                                   =  6,
  ПЕНСИЯ_ФСБ                                   =  7,
  ПЕНСИЯ_ФСНП                                  =  8,
  ПЕНСИЯ_ПРОКУРАТУРЫ                           =  9;

import deprintr, OperCode;

record DepDc("sbdepdoc.dbt");

macro ChangeDepTypeIfNeeded(DocAddr)

  SetBuff(DepDc, DocAddr);
  if((DepDc.Type_Account == "ДО ВОСТРЕБ.") and
     (DepDc.TypeOper == Зачисление_В_Пак_Режиме) and
     ((DepDc.ApplType      == ПЕНСИЯ)     OR  /* Пенсии */
      (DepDc.ApplType      == ПЕНСИЯ_МО)  OR
      (DepDc.ApplType      == ПЕНСИЯ_МВД) OR
      (DepDc.ApplType      == ПЕНСИЯ_ФСБ) OR
      (DepDc.ApplType      == ПЕНСИЯ_ФСНП)  OR
      (DepDc.ApplType      == ПЕНСИЯ_ПРОКУРАТУРЫ)))
      ClearRecord(ALG_OPERPRM);
      ALG_OPERPRM.Account         = ALG_DEPOSITOR.Account;
      ALG_OPERPRM.Type_Account    = ALG_DEPOSITOR.Type_Account;
      ALG_OPERPRM.Code_Currency   = ALG_DEPOSITOR.Code_Currency;
      ALG_OPERPRM.Type_Oper       = Перевод_В_Другой_Вид_Вклада;
      ALG_OPERPRM.Show_Panel      = 0;
      ALG_OPERPRM.UseMaxDate      = 1;
      ALG_OPERPRM.NoPrint         = 1;
      ALG_OPERPRM.NonCashCommission = 0;
      ALG_OPERPRM.TypeComplexOper = Перевод_В_Другой_Вид_Вклада;
      return not Выполнение_Операции(ALG_OPERPRM,ALG_SBDEPDOC);
  end;
  return true;
end;