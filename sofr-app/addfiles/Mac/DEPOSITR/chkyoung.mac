/*

   R-Style Softlab

   RS-Retail

   Макрос проверки возраста для вклада "Молодежный"

*/
import alg_vars;

const UPDATE_DEP  = 2,  /* Обновить счет */
      UPDATE_DOC  = 4;  /* Обновить документ   */

  /*---------- Инициализируемые структуры -----------*/
  var b_day, b_mon, b_year;
  var c_day, c_mon, c_year;
  var ClientYears;
  var Stat = OK_RES;

  DateSplit( ALG_COMDEPCLNT.rec.Born, b_day, b_mon, b_year );
  DateSplit( {curdate}, c_day, c_mon, c_year );

  if ( ( b_day == 0 )  AND  ( b_mon == 0 )  AND  ( b_year == 0 ) )
    MsgBox( "Не задана дата рождения клиента" );
    Stat = ERR_RES;
  end;

  if ( Stat == OK_RES )
    ClientYears = c_year - b_year;

    if ( ClientYears > 0 )
      if ( b_mon > c_mon )
        ClientYears = ClientYears - 1;
      elif ( ( b_mon == c_mon )  AND  ( b_day > c_day ) )
        ClientYears = ClientYears - 1;
      end;
    else
      ClientYears = 1;
    end;

    if ( ClientYears < 14 )
      MsgBox( "Вкладчик моложе 14 лет. Открытие счета запрещено!" );
      Stat = ERR_RES;
    end;

    if ( ClientYears > 23 )
      MsgBox( "Вкладчик старше 23 лет. Открытие счета запрещено!" );
      Stat = ERR_RES;
    end;

  end;

  ALG_RESULT = Stat;

  end;
