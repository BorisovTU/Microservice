/*

  R-Style SoftLab.

  RS-Retail.

  Специальные счета вкладчиков.

  Помещение кода валютной операции в основание документа.

*/

import DeprIntr;

 const sSpecA  = "Счет типа И";
 const sSpecB1 = "Счет типа В1";
 const sSpecB2 = "Счет типа В2";
 const sSpecC  = "Счет типа С";
 const sSpecO  = "Счет типа О";
 const sSpecN  = "Счет Н 40820";
 const sSpecF  = "Счет типа Ф";

 const sCodeA  = "15";
 const sCodeB1 = "17";
 const sCodeB2 = "18";
 const sCodeC  = "14";
 const sCodeO  = "16";
 const sCodeN  = "00";
 const sCodeF  = "11";

macro DoSetSpecCode( IsCur, Type_Account, Ground )

  var vDIR;
  var vCategory = "";
  var vCode = "";

  if ( SubStr( Trim( Ground ), 1, 3 ) != "{VO" ) 
   if ( IsCur == 0 )
     vDIR = I_DIR117_NR;  /* Рубли */
   else
     vDIR = I_DIR117_RN;  /* Валюта */
   end;

   if ( Type_Account == sSpecA ) 
     vCode = sCodeA;
   end;

   if ( Type_Account == sSpecB1 ) 
     vCode = sCodeB1;
   end;

   if ( Type_Account == sSpecB2 ) 
     vCode = sCodeB2;
   end;

   if ( Type_Account == sSpecC  ) 
     vCode = sCodeC;
   end;

   if ( Type_Account == sSpecO  ) 
     vCode = sCodeO;
   end;

   if ( Type_Account == sSpecN  ) 
     vCode = sCodeN;
   end;

   if ( Type_Account == sSpecF  ) 
     vCode = sCodeF;
   end;

   if ( ListValidCategory_117( vCode, vDIR, NULL, vCategory ) )
     Ground = "{VO" + vCategory + "} " + Ground;
   end;

  end;  

 return Ground;
 end;
