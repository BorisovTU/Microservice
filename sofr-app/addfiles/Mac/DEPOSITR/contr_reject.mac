/****************************************************************

  R-Style SoftLab.

  RS-Retail.

  Уведомление об отказе в обслуживании.

*****************************************************************/

import CommonInter, DeprIntr, alg_vars;

private var ddep  = TRecHandler( "i_dp_dep.rec" );
private var party = TRecHandler( "i_party.rec" );

private var vFIO = "";
private var sOper = "";
private var vNumCntr = "10014916";
private var vBody = " ";
private var nBody = 0, i = 0;

private var ClientList = TClientList;
private var {curdate};

private file opr ( person ) key 0;

private array aBody;

  [ ];

  if ( findDepartment( ALG_DEPOSITOR.FNCash, NULL, ddep, party ) )
    [                                                      ############################]
    ( party.rec.Name:w );
  end;

  [ ];
  [ ];

  if ( ClientList.GetRecord( ALG_DEPOSITOR.CodClient ) )
    vFIO = Trim( ClientList.CurRec.rec.Name1 ) + " " +
           Trim( ClientList.CurRec.rec.Name2 ) + " " +
           Trim( ClientList.CurRec.rec.Name3 );
  end;

  vBody = "Уважаемый(ая) " + vFIO +
          "!  Пользуясь правом, данным статьей № 859 Гражданского кодекса РФ, банк уведомляет Вас, что отказывается от исполнения обязательств "
          "по договору № " + ALG_DEPOSITOR.SvodAccount +
          " по основаниям, предусмотренным п.5.2 статьи 7 115-ФЗ от 07.08.2001 г. \"О противодействии легализации (отмыванию) доходов, полученных преступным путем, и финансированию терроризма\"."
          " Вам надлежит в течение 60 календарных дней получить остаток средств по договору, в противном случае они будут перечислены на специальный счет в Банк России.";

  StrSplit( vBody, aBody, 70 );

  nBody = aSize( aBody );

  while ( i < nBody )
    println( aBody( i ) );
    i = i + 1;
  end;

  opr.Oper = {oper};
  if ( GetEQ( opr ) )
    sOper = opr.Name;
  end;

  [ ];
  [ ];

  [ #                                                  # ] 
  ( {curdate}:m, sOper );

end;
