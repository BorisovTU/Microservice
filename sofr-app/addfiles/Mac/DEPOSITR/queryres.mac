
/*
**  Спросить пользователя о результате
**  вывода форм
**
*/

import DeprIntr, BankInter, ChkPrn, Alg_Vars;

macro QueryResult( Message )

  var
   Type = V_INTEGER,
   RegPath = "RS-RETAIL\\СЕРВИСНЫЕ\\ВКЛАДЫ\\КОНТРОЛЬ_ВЫПУСКА_ФОРМ",
   Value,
   ErrCode;


  if ( MacroOutput != "PRN" )
    return;
  end;

  if ( not OutputPrinted )
    PrintLn( StrFor( 12 ) );
    PrintOutput;
  end;

  if ( ALG_RESULT != ERR_RES )
    if ( GetRegistryValue( RegPath, Type, Value, ErrCode ) == V_INTEGER )
      if ( Value != 0 )
        if ( not GetTrue( true, Message ) )
          ALG_RESULT = ERR_RES;
        end;
      end;
    end;
  end;
end;

