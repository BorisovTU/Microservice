import rsd, acc_form;
var {curdate};

macro PrintHeader(Branch)
   var rs;

   rs = RsdRecordset( String("select t_name from ddp_dep_dbt where t_code = ", Branch) );
   rs.moveNext();

   [  Отчет об автоматической обработке внешних платежей без реестра за ##########. Подразделение #](string({curdate}), rs.Value(0));
   [  ];
   [+---------------+----------------------+------------------+--------+-----------------------------------------------------+];
   [| Номер платежа |       Номер счета    |       Сумма      | Валюта |                        Результат                    |];
   [+---------------+----------------------+------------------+--------+-----------------------------------------------------+];   
end;

macro PrintLine(PaymentID, mes)
   var rs = RsdRecordset( String("select rm.t_number, pm.t_ReceiverAccount, pm.t_PayAmount, fi.t_FI_CODE from dpmpaym_dbt pm, dpmrmprop_dbt rm, dfininstr_dbt fi where pm.t_PaymentID=",PaymentID,
                                 " and rm.t_PaymentID=pm.t_PaymentID and fi.T_FIID=pm.t_PayFIID and fi.T_FI_KIND=1") );
   rs.moveNext();

   [|###############|######################|##################| ###### |#####################################################|]
   (rs.Value(0), Acc_Form(String(rs.Value(1))), rs.Value(2), rs.Value(3), mes);
end;

macro PrintFooter()
   [+---------------+----------------------+------------------+--------+-----------------------------------------------------+];
end;