/**************************************************************************\
*  ---------------------                                                   *
*  R-Style Software Lab.                                                   *
*  ---------------------                                                   *
*  RS-Retail                                                               *
*                                                                          *
*  Вклады                                                                  *
*                                                                          *
*  Валютная операция 71. "Зачисление средств" - подвид 32 "в Россию"       *
*                                                                          *
*  Макрос установки основания документа                                    *
*                                                                          *
\**************************************************************************/

import DeprIntr;

record ALG_SBDEPDOC ("sbdepdoc.dbt");

/*---------- Коды возврата макроса ----------*/
const  OK_RES   =  0,  /* продолжать проводку */
       SKIP_RES =  1,  /* пропустить выполнение предопределенного модуля */
       END_RES  =  2,  /* завершить проводку */
       ERR_RES  = -1;  /* аваpийно завершить проводку */

const UPDATE_ALL  = 1;
const UPDATE_DEP  = 2;
const UPDATE_DOC  = 4;

array sGround;

var sel;

sGround( 0) = "з\п,стипендия,пенсия,алименты,пособие др.";
sGround( 1) = "командировочные расходы";
sGround( 2) = "по наследству";
sGround( 3) = "на погребение";
sGround( 4) = "компенсация репрессированным";
sGround( 5) = "судебные выплаты";
sGround( 6) = "за участие в мероприятиях";
sGround( 7) = "авторские вознаграждения";
sGround( 8) = "за гастроли";

if ( ALG_SBDEPDOC.ApplType == 32 )  /* Зачисление средств в Россию */

  sel = Menu( sGround, " Выберите основание", "Основания зачислений" );

  ALG_SBDEPDOC.Ground = sGround( sel );

  UpdateAlgRecords( UPDATE_DOC, TRUE );

end;

ALG_RESULT = OK_RES;

Exit( 1 );

end;
