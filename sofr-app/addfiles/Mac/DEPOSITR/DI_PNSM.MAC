/****************************************************************

  R-Style SoftLab.

  RS-Retail.

  Страхование частных вкладов.

  Расчет сумм обязательств в разрезе каждого счета.

  Панель параметров расчета сумм обязательств.

*****************************************************************/

import DeprIntr, DI_Def;

record dlg_prnt ( "DIP_SUMM", "rtusrmac" ) dialog;

var ClntPS = TClientList;

var vCodClient = 0;

/****************************************************************/
/*                   Обработка событий панели.                  */
/****************************************************************/
macro EventProcSum( dlg, cmd, id, key )

  if ( cmd == DLG_KEY )
    /* msgbox(key); */
    if   ( key == KEY_F2 )
      if ( dlg.DateMake == Date( 0, 0, 0 ) )
        MsgBox( "Дата не должна быть нулевой!" );
        SetFocus( dlg, 0 );
        /* return CM_IGNORE; */
      else
        return CM_SAVE;
      end;
    elif ( key == KEY_F3 )
      if ( id == 1 )
        ClntPS.Select_Search();
        vCodClient = ClntPS.CurRec.Rec.CodClient;
        dlg.CodClient = ClntPS.CurRec.ConvertFIO();
        /* dlg.CodClient = ClntPS.CurRec.ConvertFIOFull(); */
      end;
    elif ( key == KEY_F9 )
      return CM_IGNORE;
    elif ( key == KEY_ESC )
      panSumEscape = TRUE;
      return CM_SAVE;
    end;
  end;

end;

/****************************************************************/
/*            Панель параметров формирования реестра.           */
/****************************************************************/
macro DI_Panel_Summ()

  /* Установка начальных значений полей панели */
  dlg_prnt.DateMake  = panSumDateMake;
  dlg_prnt.CodClient = "";
  panSumEscape = FALSE;

  /* Работа с панелью */
  RunDialog( dlg_prnt, "EventProcSum" );

  /* Установка параметров для предварительного формирования реестра */
  panSumDateMake = dlg_prnt.DateMake;
  panSumClient   = vCodClient;

end;

/* DI_Panel_Summ(); */
