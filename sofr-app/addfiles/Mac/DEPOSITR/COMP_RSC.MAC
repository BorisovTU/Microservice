/*
*  ---------------------
*  R-Style Software Lab.
*  ---------------------
*  RS-Retail
*
*  Компенсации по вкладам
*
*  Реестр начисленных и выплаченных компенсаций
*
*  Макрос для выпуска ресстра из процедуры завершения опер.дня
*
*/

import comp_rst;

file na ( "comp_typ.dbt" ) key 0;

private var {curdate};

var ret  = TRUE;
var kind = -1;

/* Поиск последнего вида компенсаций */
ReWind( na );
Prev( na );  /* Added by Martinov SCR 11656*/
kind = na.CompensTypeID;
if (kind==999)
  Prev (na);
  kind = na.CompensTypeID;
end;
/*
na.iTypeAlg = 966;
while ( ret )
  if ( Next( na )  AND
       ( na.iTypeAlg == 966 )  AND
       ( na.iNumberAlg == 999 ) )
    ret = FALSE;
  end;
  if ( ret )
    kind = na.iNumberAlg;
  end;
end;
*/
/* Процедура выпуска реестра */
CompensationReestr( kind, -1, {curdate}, {curdate} );
