/*
  Общие макросы работы с файлами

  Ромодин Александр Васильевич
  Создан: 01.08.96
*/

/**********************************************************/

macro Выделение_имени_файла (Name)
/*
  Из полного идентификатора файла выделяет
  его имя с расширением

  01.08.96
*/
  var NewName = Name;
  var len = 0,
      i = 0;
  var Cont = TRUE;

  len = StrLen (NewName);
  i = len;
  while ((i>0) AND Cont)
    if (SubStr(NewName,i,1) == "\\")
      NewName = SubStr (NewName,i+1);
      Cont = False;
    end;
    i = i - 1;
  end;
  return NewName;
end;

/**********************************************************/

macro Выделение_каталога (Name)
/*
  Из полного идентификатора файла выделяет
  все, что стоит до имени файла

  06.08.96
*/
  var NewName = Name;
  var len = 0,
      i = 0;
  var Cont = TRUE;

  len = StrLen (NewName);
  i = len;
  while ((i>0) AND Cont)
    if (SubStr(NewName,i,1) == "\\")
      NewName = SubStr (NewName,1,i);
      Cont = False;
    end;
    i = i - 1;
  end;
  return NewName;
end;
