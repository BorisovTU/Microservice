
/*  Макрос для проверки взятия платы за перевод вклада в "свой" или
    "чужой" филиал.
                                               04.09.98 - Макашов М.
*/     


import Opercode;

/*---------- Инициализируемые структуры ---------------------------------*/
 record ALG_DEPOSITOR("depositr.dbt");
 record ALG_SBDEPDOC ("sbdepdoc.dbt");
 record ALG_PARAM    ("sb_algop.dbt");

/*---------- Коды возврата макроса --------------------------------------*/
 const  OK_RES   =  0,  /* продолжать проводку */
        SKIP_RES =  1,  /* пропустить выполнение предопределенного модуля */
        END_RES  =  2,  /* завершить проводку */
        ERR_RES  = -1;  /* аваpийно завершить проводку */

 var {curdate};

alg_param.prmD = 0;

  if(ALG_SBDEPDOC.TYPEOPER == Списание_В_Свой_Филиал)
         if(ALG_SBDEPDOC.ApplType == 0)               /*на свое имя */
                 alg_param.prmI = 0;
                 ALG_RESULT = SKIP_RES;
                 ALG_UPDATE = 1;
          end;
  else   
      if(ALG_SBDEPDOC.TYPEOPER == Списание_В_Чужой_Филиал)
         if(ALG_SBDEPDOC.ApplType == 0)              /* на чужое имя */
           if(({curdate} - ALG_DEPOSITOR.Open_Date) > 90)
               alg_param.prmI = 0;
               ALG_RESULT = SKIP_RES;
               ALG_UPDATE = 1;
           end;
         end;
      end;
  end;

  ALG_RESULT = OK_RES;


end;