/*

    Макрос проверки того, что данный счет - пенсионный

*/

array sPens;

RECORD acc ( "depositr.dbt" );   /* Документ по безналичным платежам */

MACRO CheckProc( Addr )

  var nPens, i;

  /* Список пенсионных видов вкладов */
  sPens(0) = "Пенсионный";
  sPens(1) = "Ср.пенсион.";
  sPens(2) = "Ср.пенс.6мес";
  sPens(3) = "Ср.пен.1г1м";

  SetBuff( acc, Addr );
  SetOutput( NULL );

  nPens = aSize(sPens);
  i = 0;

  while ( i < nPens )
    if ( acc.Type_Account == sPens(i) )
      return 0;
    end;
    i = i + 1;
  end;

  return 1;

END;
