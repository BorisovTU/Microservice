import CommonInter;
import CryptDlm;

var textDir = GetRegVal( "BANK_INI\\ОБЩИЕ ПАРАМЕТРЫ\\ДИРЕКТОРИИ\\TEXTDIR", true ), 
    fName, 
    cryptoApi = RsCryptoAPI();

if ( SelectFile( fName, textDir + "\\*.*" ) )
  if ( not cryptoAPI.SignFile( "RS-Retail|Транспорт|ПередачаФайла", fName ) )
    msgBox( "Ошибка при подписании файла|", fName, "|", cryptoApi.getErrorDescription );
  end;
end;