/*-RSL----------------------------------------------------JV R-Style--*/
/*--------------- Печать ордера вкладчика ----------------------------*/

import DeprIntr;

 var clntL = TClientList;

 file   cr (currency) Key 0;            /* открыть файл валют */

 record dr ("depositr.dbt");
 record dd ("sbdepdoc.1");

 macro getNameBranch

  var NameBranch;

  if (not findDepartment(dd.FNCash, NameBranch))
    NameBranch = "";
  end;

  return NameBranch;

 end;

 macro PutDeprOrder_143 ( pdr, pcl, pdd )
  var sKNF;

  setbuff( dr, pdr );
  setbuff( dd, pdd );
  if (pcl != 0)
    if ( NOT clntL.GetRecord( pcl ) )
      clntL.CurRec.rec.Name1 = "";
      clntL.CurRec.rec.Name2  = "";
      clntL.CurRec.rec.Name3 = "";
    end;
  else
    clntL.CurRec.rec.Name1 = "";
    clntL.CurRec.rec.Name2  = "";
    clntL.CurRec.rec.Name3 = "";
  end;

  if ( Index( dr.UserTypeAccount, "Ф" ) != 0 )  /* Счета типа "Ф" */
    sKNF = "KNF" + String( dd.KNFCode );
  else
    sKNF = "";
  end;

  if( dr.Code_Currency > 0 )
    /* Найти Валюту в файле */
    cr.Code_Currency = dr.Code_Currency;
    geteq( cr );
  end;
  /* Подготовка строк к печати */
  /* Выбор - наличный или безналичный расчет */
/*  if(dd.VidDoc == 1)       */            /* наличные */
/*  if( dd.InSum )           */       /* приход */
 /*   Sum  = dd.InSum;
    head = "Приходный ордер";
    main_Sum = "Прошу ПРИНЯТЬ вклад в сумме";
    get_in = "Принято";
    sop1 = "Начислены %%";
   elif (dd.OutSum)  */              /* расход */
/*    sop  = "Получил:";
    Sum  = dd.OutSum;
    head = "Расходный ордер";
    main_Sum = "Прошу ВЫДАТЬ вклад в сумме";
    get_in = "Выдано";
    sop1 = "Отчислены %%";
   else
    return; */                     /* Нулевые суммы прихода и расхода */
/*   end;

   S=Money( Double(Sum) ); */
  /* Сумма прописью */
/*  str_sum = rubtostr( S );
  if( dr.Code_Currency > 0 )*/
    /* Замена рублей на название валюты */
/*    PosRub  = index( str_sum, "руб" );
    PosKop  = index( str_sum, "коп" );
    SumRub  = substr( str_sum, 1, PosRub-1 );
    SumKop  = substr( str_sum, PosRub+4, strlen( str_sum ) - PosKop );
    str_sum = SumRub + cr.Short_Name + SumKop;
  end;  */

[В филиал N ____________                                                              Ф. N 143
_______________________________________
          (наименование)
                                               От гр. #
  отделения Сберегательного банка                     ----------------------------------------
_______________________________________                      (фамилия, имя, отчество)
 (местонахождение филиала, в котором
хранится вклад или в который вносятся         проживающего____________________________________
         деньги для перевода)                                       (адрес)

                                              #
                       З А Я В Л Е Н И Е  О  П Е Р Е В О Д Е  В К Л А Д А

     Прошу перевести в филиал N ______________________________________________________________
                                                        наименование
отделения Сберегательного банка, адрес которого ______________________________________________
кор./счет N  #________________________________________________________________________________
____________________________________________ (МФО #__________________, код #_________________)
- списав со счета N #                        сумму

- внесенную мною наличными деньгами сумму

Переведенную сумму зачислите на счет N
на имя
- выдайте наличными деньгами гр.

адрес которого

              Условие по вкладу              │  Если плата за перевод подлежит удержанию, то
__________________________________________  │  спишите ее с моего счета.
__________________________________________  │  Плату за перевод вношу наличными деньгами
__________________________________________  │  в сумме _______________________________________
__________________________________________  │                  (ненужное зачеркнуть)

                          Порядок взимания платы мне известен
К заявлению прилагаю _________________________________________________________________________
______________________________________________________________________________________________
Подпись вкладчика или лица, внесшего наличные деньги за перевод ______________________________
#

─────────────────────────────────────────────────┬────────────────────────────────────────────
            Счет N #                              │  Составил _________________________________
Расчет по переводу:                       РАСЧЕТ │           бухгалтер или контролер(оператор)
Остаток вклада по счету                     по   │ #
Присоединено %% #                        ПЕРЕВОДУ│ Проверил __________________________________
Удержана                                         │           бухгалтер или контролер(оператор)
--------------------------  плата за перевод     │ #
Внесена наличными деньгами                         Кассир ____________________________________
                                                              (при приеме наличных денег)
Сумма перевода
ОСТАТКИ (после списания)                           Выписано платежное поручение N_____________
вклада     #                                       #
процентов  #                                       Главный бухгалтер
]
     ( clntL.CurRec.rec.Name1 + " " +
       clntL.CurRec.rec.Name2 + " " +
       clntL.CurRec.rec.Name3,
      sKNF,
      Acc_Form(dd.CorAcc_Receiver):l,
      dd.MFO_Receiver:l,
      dd.CodeCur_Receiver:l,
      Acc_Form(dr.Account):l,
      dd.DepDate_Document:l:m,
      Acc_Form(dr.Account):l,
      dd.DepDate_Document:l:m,
      dd.PercOprSum:a:l,
      dd.DepDate_Document:l:m,
      dd.Rest:a:l,
      dd.DepDate_Document:l:m,
      dd.PercRest:a:l);
if (dd.TypeComplexOper==96)  /* Закрытие переводом */
[процентов по нарушению    #
 дата открытия-пролонгации #
 дата окончания договора   #
 филиал-отправитель перевода  #
](dd.PercTrnAlt:a:l,
  dd.DateTrnOpen:l:m,
  dr.End_DateDep:l:m,
  getNameBranch():l);
end;
/*   (sop1:l,
    dd.PercOprSum:l,
    cr.Short_Name:l,
    head:c,
    dr.Account:l,
    dd.Date_Document:l:m,
    clntL.CurRec.rec.Name1 + " " +
    clntL.CurRec.rec.Name2 + " " +
    clntL.CurRec.rec.Name3,
    main_Sum:c,
    str_sum:w,
    sop:c,
    get_in:l,
    S:a:l,
    dd.Rest:a:l,
    dd.PercRest:a:l);
    return;
  end;  */
 end;

