/***************************************************************************\
| DETDATE.MAC  RS-Retail Автор: Саввин Д.                                   |
| Для шага "Ограничения при приходе"(?) операций открытия вкладов первокла- |
| ccников.                                                                  |
\***************************************************************************/

/* Для вкладов первоклассников отслеживается дата открытия счета (счет
открывается, если дата открытия до 1 сентября, при открытии счета
в период с 1 сентября по 1 октября возникает предупреждаюшее сообщение */



/*---------- Инициализируемые структуры ---------------------------------*/
 record ALG_DEPOSITOR("depositr.dbt");
 record ALG_SBDEPDOC("sbdepdoc.dbt");
 record ALG_PARAM("sb_algop.dbt");

/*---------- Коды возврата макроса --------------------------------------*/
 const  OK_RES   =  0,  /* продолжать проводку */
        SKIP_RES =  1,  /* пропустить выполнение предопределенного модуля */
        END_RES  =  2,  /* завершить проводку */
        ERR_RES  = -1;  /* аваpийно завершить проводку */
/*-----------------------------------------------------------------------*/
 var day=0, mon=0, year=0, {curdate},
     DateLine1=date(0,0,0), DateLine2=date(0,0,0);

 DateSplit({curdate},day,mon,year);
 DateLine1=date(1,9,year);
 DateLine2=date(1,10,year);
 if({curdate}<=DateLine1)
   ALG_RESULT=OK_RES;
   Exit(1); /* Убрать вывод на экран */
   return;
 elif(({curdate}>DateLine1) and ({curdate}<=DateLine2))
   if(GetTrue(NULL,"Вы уверенны в том что вы хотите открыть счет?"))

     ALG_RESULT=OK_RES;
     Exit(1); /* Убрать вывод на экран */
     return;
   else

     ALG_RESULT=ERR_RES;
     Exit(1); /* Убрать вывод на экран */
     return;
   end;
 else
   ALG_RESULT=ERR_RES;
   Exit(1); /* Убрать вывод на экран */
   return;

 end
