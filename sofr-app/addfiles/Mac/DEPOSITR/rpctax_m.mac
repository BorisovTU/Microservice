/*
$Name:             rpctax_m.mac
$Module:           RS-Retail
$Description:      Формирование налоговых карточек и справок о доходах
*/

/*
  RS-Retail

  Выпуск налоговой карточки
  "Филиал Сбербанка"

  Ромодин Александр Васильевич
  29.12.99
============================================================
  04.09.01  Ромодин Александр Васильевич
  Выпуск налоговой карточки переработан в соответствии
  с ТЗ 693-01-1,2-НДФЛ
  Заполняются разделы: 2,3,5,6
============================================================
*/

Import rpctax_c,rtkladr;

private var {Name_Bank};

/***********************************************************
                  Тип населенного пункта.
***********************************************************/
macro Тип_населенного_пункта()
  return String(COMCLNT.CurRec.rec.lCodePlace);
end;


/**********************************************************/

macro Раздел_3
/*
  Выпуск таблицы для нерезидента
*/
  var stat = True,
      i;
[
 Раздел 3. РАСЧЕТ НАЛОГОВОЙ БАЗЫ И НАЛОГА НА ДОХОДЫ ФИЗИЧЕСКОГО ЛИЦА

 (для доходов, облагаемых по ставкам 13% и 30%)
  ];
[+-------------------------+---------------------+--------------------+];
[|На начало налогового     |Долг по налогу       |                    |];
[|периода                  |за налогоплательщиком|                    |];
[|                         +---------------------+--------------------+  +------------------------------------------------------+----------------+];
[|                         |Долг по налогу       |                    |  | Сумма дохода, облагаемого по ставке 13%              |                |];
[|                         |за налоговым агентом |                    |  | с предыдущего места работы:                          |                |];
[+-------------------------+---------------------+--------------------+  +------------------------------------------------------+----------------+];
[                                                                                                                                                                                         ];
[+-------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+];
[|Наименование показателя  | Январь    | Февраль   | Март      | Апрель    | Май       | Июнь      | Июль      | Август    | Сентябрь  | Октябрь   | Ноябрь    | Декабрь   |   Итого     |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
i = 0;
while( i < ASize( p_1_23 ) )
if( ( p_1_25(i) != $0l ) or ( ( СуммаМассива(p_1_25) == $0 ) and ( p_1_23(i) == КодыДоходов(RPCB_TAX_SBDEPR_RETAIL) ) ) )
[|    ##########           |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_23(i),p_1_24(i)(0),p_1_24(i)(1),p_1_24(i)(2),p_1_24(i)(3),p_1_24(i)(4),p_1_24(i)(5),p_1_24(i)(6),p_1_24(i)(7),p_1_24(i)(8),p_1_24(i)(9),p_1_24(i)(10),p_1_24(i)(11),p_1_25(i));
[+---------------+---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
end;
 i = i + 1;
end;
[|Налоговые      | Код     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|вычеты, за     +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|исключением    | Код     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|стандартных    +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|               | Код     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---------------+---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Общая сумма    |За месяц |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_26(0),p_1_26(1),p_1_26(2),p_1_26(3),p_1_26(4),p_1_26(5),p_1_26(6),p_1_26(7),p_1_26(8),p_1_26(9),p_1_26(10),p_1_26(11),p_1_27);
[|доходов за     +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|минусом        |С начала |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_26b(0),p_1_26b(1),p_1_26b(2),p_1_26b(3),p_1_26b(4),p_1_26b(5),p_1_26b(6),p_1_26b(7),p_1_26b(8),p_1_26b(9),p_1_26b(10),p_1_26b(11),p_1_27b);
[|вычетов        |года     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |         |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---------------+---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Стандартные    |За месяц |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|налоговые      |(101)    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|вычеты         +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|(статья 218    |За месяц |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|Налогового     |(102)    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|кодекса        +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Российской     |За месяц |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|Федерации)     |(103)    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|               |За месяц |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |(104)    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|               |За месяц |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |(105)    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               +---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|               |Общая    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |сумма    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |с начала |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|               |года     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---------------+---------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Налоговая база (с начала |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_28(0),p_1_28(1),p_1_28(2),p_1_28(3),p_1_28(4),p_1_28(5),p_1_28(6),p_1_28(7),p_1_28(8),p_1_28(9),p_1_28(10),p_1_28(11),p_1_29);
[|года)                    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Налог исчисленный        |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_30(0)),RoundToRuble(p_1_30(1)),RoundToRuble(p_1_30(2)),
  RoundToRuble(p_1_30(3)),RoundToRuble(p_1_30(4)),RoundToRuble(p_1_30(5)),
  RoundToRuble(p_1_30(6)),RoundToRuble(p_1_30(7)),RoundToRuble(p_1_30(8)),
  RoundToRuble(p_1_30(9)),RoundToRuble(p_1_30(10)),RoundToRuble(p_1_30(11)),
  RoundToRuble(m_1_31));
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Налог удержанный         |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_32(0)),RoundToRuble(p_1_32(1)),RoundToRuble(p_1_32(2)),
  RoundToRuble(p_1_32(3)),RoundToRuble(p_1_32(4)),RoundToRuble(p_1_32(5)),
  RoundToRuble(p_1_32(6)),RoundToRuble(p_1_32(7)),RoundToRuble(p_1_32(8)),
  RoundToRuble(p_1_32(9)),RoundToRuble(p_1_32(10)),RoundToRuble(p_1_32(11)),
  RoundToRuble(m_1_33));
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Долг по налогу           |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_34(0)),RoundToRuble(p_1_34(1)),RoundToRuble(p_1_34(2)),
  RoundToRuble(p_1_34(3)),RoundToRuble(p_1_34(4)),RoundToRuble(p_1_34(5)),
  RoundToRuble(p_1_34(6)),RoundToRuble(p_1_34(7)),RoundToRuble(p_1_34(8)),
  RoundToRuble(p_1_34(9)),RoundToRuble(p_1_34(10)),RoundToRuble(p_1_34(11)),
  RoundToRuble(r_1_56+p_1_35));
[|за налогоплательщиком    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Долг по налогу за        |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_36(0)),RoundToRuble(p_1_36(1)),RoundToRuble(p_1_36(2)),
  RoundToRuble(p_1_36(3)),RoundToRuble(p_1_36(4)),RoundToRuble(p_1_36(5)),
  RoundToRuble(p_1_36(6)),RoundToRuble(p_1_36(7)),RoundToRuble(p_1_36(8)),
  RoundToRuble(p_1_36(9)),RoundToRuble(p_1_36(10)),RoundToRuble(p_1_36(11)),
  RoundToRuble(r_1_57+p_1_37));
[|налоговым агентом        |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Сумма налога, переданная |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|на взыскание в налоговый |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|орган                    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|Возвращена налоговым     |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_38(0)),RoundToRuble(p_1_38(1)),RoundToRuble(p_1_38(2)),
  RoundToRuble(p_1_38(3)),RoundToRuble(p_1_38(4)),RoundToRuble(p_1_38(5)),
  RoundToRuble(p_1_38(6)),RoundToRuble(p_1_38(7)),RoundToRuble(p_1_38(8)),
  RoundToRuble(p_1_38(9)),RoundToRuble(p_1_38(10)),RoundToRuble(p_1_38(11)),
  RoundToRuble(p_1_39+r_1_55));
[|агентом излишне          |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|удержанная сумма налога  |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+-------------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[ ];
[ ПРАВО НА СТАНДАРТНЫЕ НАЛОГОВЫЕ ВЫЧЕТЫ:];
[                                                          +-+ ];
[ 3.1 Необлагаемый минимум дохода в размере: 3000 рублей - | |,];
[              +-+                +-+                      +-+ ];
[ 500 рублей - | |,  400 рублей - | | - (в нужном поле проставить любой знак)];
[              +-+                +-+];
[ Основание для предоставления налогового вычета ____________________________];
[ ];
[                                                             +-+ ];
[ 3.2 Расходы на содержание 1 ребенка в размере: 300 рублей - | |,];
[                        +-+                                  +-+ ];
[ в размере 600 рублей - | | - (в нужном поле проставить любой знак);];
[                        +-+];
[ Количество детей __________________________________________________];
[ Период действия вычета ____________________________________________];
[ Основание для предоставления налогового вычета ____________________];
[ Документы, подтверждающие статус вдовы (вдовца), одинокого ];
[ родителя, опекуна или попечителя __________________________________];
[ ];
  return stat;
end;

/**********************************************************/

macro Раздел_4
[
 Раздел 4. РАСЧЕТ НАЛОГОВОЙ БАЗЫ И НАЛОГА НА ДОХОДЫ ФИЗИЧЕСКОГО
 ЛИЦА ОТ ДОЛЕВОГО УЧАСТИЯ В ДЕЯТЕЛЬНОСТИ ОРГАНИЗАЦИИ (ДИВИДЕНТЫ)
  ];
[+---+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+];
[| N | Показатели          | Январь    | Февраль   | Март      | Апрель    | Май       | Июнь      | Июль      | Август    | Сентябрь  | Октябрь   | Ноябрь    | Декабрь   |   Итого     |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 1 | Сумма дивидендов,   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | распределенная в    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | пользу физического  |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | лица -              |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | налогоплательщика   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 2 | Облагаемая сумма    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | дивидендов          |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 3 | Сумма налога        |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | исчисленная         |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 4 | Сумма налога        |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | удержанная          |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 5 | Долг по налогу за   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | налогоплательщиком  |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 6 | Долг по налогу за   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | налоговым агентом   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   |                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 7 | Сумма налога,       |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | переданная на       |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | взыскание в         |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | налоговый орган     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| 8 | Возвращена          |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | налоговым агентом   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | излишне удержанная  |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|   | сумма налога        |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
end;

/**********************************************************/

macro Раздел_5
/*
  Выпуск таблицы для резидентов
*/
  var stat = True,
      i;
[
 Раздел 5. РАСЧЕТ НАЛОГА С ДОХОДОВ, ОБЛАГАЕМЫХ ПО СТАВКЕ 35 %
  ];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[| N|Показатель        | Январь    | Февраль   | Март      | Апрель    | Май       | Июнь      | Июль      | Август    | Сентябрь  | Октябрь   | Ноябрь    | Декабрь   |   Итого     |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
i = 0;
while( i < ASize( p_1_23 ) )
if( ( p_1_23(i) == КодыДоходов( RPCB_TAX_SBDEPR_RETAIL ) ) )
[|1 |Код дохода ###### |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_23(i),p_1_40(i)(0),p_1_40(i)(1),p_1_40(i)(2),p_1_40(i)(3),p_1_40(i)(4),p_1_40(i)(5),p_1_40(i)(6),p_1_40(i)(7),p_1_40(i)(8),p_1_40(i)(9),p_1_40(i)(10),p_1_40(i)(11),p_1_41(i));
[|  |сумма дохода      |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
i = ASize( p_1_23 );
end;
 i = i + 1;
end;
[|2 |Налоговый вычет,  |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |предусмотренный   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |пунктом 28 статьи |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |217 Налогового    |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |кодекса Российской|           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |Федерации по      |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |выигрышам и призам|           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |в целях рекламы   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|3 |Налоговая база    |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (p_1_42(0),p_1_42(1),p_1_42(2),p_1_42(3),p_1_42(4),p_1_42(5),p_1_42(6),p_1_42(7),p_1_42(8),p_1_42(9),p_1_42(10),p_1_42(11),p_1_43);
[|  |(стр.1-стр.2)     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|4 |Сумма налога      |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_44(0)),RoundToRuble(p_1_44(1)),RoundToRuble(p_1_44(2)),
  RoundToRuble(p_1_44(3)),RoundToRuble(p_1_44(4)),RoundToRuble(p_1_44(5)),
  RoundToRuble(p_1_44(6)),RoundToRuble(p_1_44(7)),RoundToRuble(p_1_44(8)),
  RoundToRuble(p_1_44(9)),RoundToRuble(p_1_44(10)),RoundToRuble(p_1_44(11)),
  RoundToRuble(p_1_45));
[|  |исчисленная       |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|5 |Сумма налога      |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_46(0)),RoundToRuble(p_1_46(1)),RoundToRuble(p_1_46(2)),
  RoundToRuble(p_1_46(3)),RoundToRuble(p_1_46(4)),RoundToRuble(p_1_46(5)),
  RoundToRuble(p_1_46(6)),RoundToRuble(p_1_46(7)),RoundToRuble(p_1_46(8)),
  RoundToRuble(p_1_46(9)),RoundToRuble(p_1_46(10)),RoundToRuble(p_1_46(11)),
  RoundToRuble(p_1_47));
[|  |удержанная        |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|6 |Долг по налогу за |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_48(0)),RoundToRuble(p_1_48(1)),RoundToRuble(p_1_48(2)),
  RoundToRuble(p_1_48(3)),RoundToRuble(p_1_48(4)),RoundToRuble(p_1_48(5)),
  RoundToRuble(p_1_48(6)),RoundToRuble(p_1_48(7)),RoundToRuble(p_1_48(8)),
  RoundToRuble(p_1_48(9)),RoundToRuble(p_1_48(10)),RoundToRuble(p_1_48(11)),
  RoundToRuble(p_1_49));
[|  |налогоплательщиком|           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|7 |Долг по налогу за |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_50(0)),RoundToRuble(p_1_50(1)),RoundToRuble(p_1_50(2)),
  RoundToRuble(p_1_50(3)),RoundToRuble(p_1_50(4)),RoundToRuble(p_1_50(5)),
  RoundToRuble(p_1_50(6)),RoundToRuble(p_1_50(7)),RoundToRuble(p_1_50(8)),
  RoundToRuble(p_1_50(9)),RoundToRuble(p_1_50(10)),RoundToRuble(p_1_50(11)),
  RoundToRuble(p_1_51));
[|  |налоговым агентом |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|8 |Сумма налога,     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |переданная на     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |взыскание в       |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |налоговый орган   |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|9 |Возвращена        |###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|###########|#############|]
 (RoundToRuble(p_1_52(0)),RoundToRuble(p_1_52(1)),RoundToRuble(p_1_52(2)),
  RoundToRuble(p_1_52(3)),RoundToRuble(p_1_52(4)),RoundToRuble(p_1_52(5)),
  RoundToRuble(p_1_52(6)),RoundToRuble(p_1_52(7)),RoundToRuble(p_1_52(8)),
  RoundToRuble(p_1_52(9)),RoundToRuble(p_1_52(10)),RoundToRuble(p_1_52(11)),
  RoundToRuble(p_1_53));
[|  |налоговым агентом |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |излишне удержанная|           |           |           |           |           |           |           |           |           |           |           |           |             |];
[|  |сумма налога      |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+--+------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
  return stat;
end;
/**********************************************************/

macro Раздел_6
/*
  Выпуск итоговой таблицы
*/
  var stat = True;
/* переменные для таблицы по ТЗ */
  var p_1_54 = p_1_31,
      p_1_55 = p_1_33,
      p_1_56 = p_1_35,
      p_1_57 = p_1_37,
      p_1_58 = p_1_39,
      p_1_59 = p_1_45,
      p_1_60 = p_1_47,
      p_1_61 = p_1_49,
      p_1_62 = p_1_51,
      p_1_63 = p_1_53,
      p_1_64 = r_1_53 + p_1_54 + p_1_59,
      p_1_65 = r_1_54 + p_1_55 + p_1_60,
      p_1_66 = r_1_56 + p_1_56 + p_1_61,
      p_1_67 = r_1_57 + p_1_57 + p_1_62,
      p_1_68 = r_1_55 + p_1_58 + p_1_63;
[
 Раздел 6. ОБЩАЯ СУММА НАЛОГА ПО ИТОГАМ НАЛОГОВОГО ПЕРИОДА
  ];
[+-------------+---------------------------+-------------+-----------------------------+---------------------------+];
[| Показатели  |     Общая сумма налога    |Передано на  |По перерасчету за предшеству-|     Долг по налогу        |];
[|             |                           |взыскание в  |ющие налоговые периоды       |                           |];
[|             +-------------+-------------+налоговый    +-------------+---------------+-------------+-------------+];
[|             | Исчисленная | Удержанная  |орган        |Возвращено   |Зачтено в счет |За налогопла-|За налоговым |];
[|             |             |             |             |             |налоговых обя- |тельщиком    |агентом      |];
[|             |             |             |             |             |зательств      |             |             |];
[|             |             |             |             |             |отчетного года |             |             |];
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
[|по ставке 6% |             |             |             |             |               |             |             |];
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
[|по ставке 13%|#############|#############|             |#############|               |#############|#############|]
 (RoundToRuble(r_1_53),RoundToRuble(r_1_54),RoundToRuble(r_1_55),
  RoundToRuble(r_1_56),RoundToRuble(r_1_57));
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
[|По ставке 30%|#############|#############|             |#############|               |#############|#############|]
 (RoundToRuble(p_1_54),RoundToRuble(p_1_55),RoundToRuble(p_1_58),
  RoundToRuble(p_1_56),RoundToRuble(p_1_57));
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
[|По ставке 35%|#############|#############|             |#############|               |#############|#############|]
 (RoundToRuble(p_1_59),RoundToRuble(p_1_60),RoundToRuble(p_1_63),
  RoundToRuble(p_1_61),RoundToRuble(p_1_62));
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
[|Итого        |#############|#############|             |#############|               |#############|#############|]
 (RoundToRuble(p_1_64),RoundToRuble(p_1_65),RoundToRuble(p_1_68),
  RoundToRuble(p_1_66),RoundToRuble(p_1_67));
[+-------------+-------------+-------------+-------------+-------------+---------------+-------------+-------------+];
  return stat;
end;

/**********************************************************/

macro Разделы_7_8_9 ()
[
 Раздел 7. СВЕДЕНИЯ О ДОХОДАХ, НАЛОГООБЛОЖЕНИЕ КОТОРЫХ
 ОСУЩЕСТВЛЯЕТСЯ НАЛОГОВЫМИ ОРГАНАМИ
  ];
[+---------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------+];
[| Код дохода          | Январь    | Февраль   | Март      | Апрель    | Май       | Июнь      | Июль      | Август    | Сентябрь  | Октябрь   | Ноябрь    | Декабрь   |   Итого     |];
[+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[|                     |           |           |           |           |           |           |           |           |           |           |           |           |             |];
[+---------------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-------------+];
[
 Раздел 8. РЕЗУЛЬТАТЫ ПЕРЕРАСЧЕТА НАЛОГА ЗА ПРЕДШЕСТВУЮЩИЕ НАЛОГОВЫЕ ПЕРИОДЫ
  ];
[+----------------------+-----------------------------------------------------------------------------------------+];
[|                      |   Общая   |  Общая  |   Общая   |  Сумма  |   Сумма   | Долг по  | Долг по  |   Сумма   |];
[|                      |   сумма   |  сумма  |   сумма   |исчислен-|удержанного|налогу за |налогу за |   налога, |];
[|                      |  доходов, |налоговых|  доходов, |   ного  |   налога  |налоговым |налогопла-|переданная |];
[|                      |включаемых | вычетов,|включаемых |  налога |           | агентом  |тельщиком |    на     |];
[|                      |в налоговую|исключае-|в налоговую|         |           |  перед   |          | взыскание |];
[|                      |    базу   |  мых из |  базу и   |         |           |налогопла-|          |в налоговый|];
[|                      |           |налоговой| уменьшен- |         |           |тельщиком |          |   орган   |];
[|                      |           |   базы  |  ных на   |         |           |          |          |           |];
[|                      |           |         | налоговые |         |           |          |          |           |];
[|                      |           |         |   вычеты  |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Отражено в налоговой  |           |         |           |         |           |          |          |           |];
[|карточке за ______ год|           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Результаты перерасчета|           |         |           |         |           |          |          |           |];
[|налога за ______ год  |           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Отражено в налоговой  |           |         |           |         |           |          |          |           |];
[|карточке за ______ год|           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Результаты перерасчета|           |         |           |         |           |          |          |           |];
[|налога за ______ год  |           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Отражено в налоговой  |           |         |           |         |           |          |          |           |];
[|карточке за ______ год|           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[|Результаты перерасчета|           |         |           |         |           |          |          |           |];
[|налога за ______ год  |           |         |           |         |           |          |          |           |];
[+----------------------+-----------+---------+-----------+---------+-----------+----------+----------+-----------+];
[
 Раздел 9. СВЕДЕНИЯ О ПРЕДОСТАВЛЕНИИ СПРАВОК:

 а) налоговому органу о доходах: N справки ____________ дата _______________
 б) налогоплательщику о доходах: N справки ____________ дата _______________
 в) налоговому органу о сумме задолженности, переданной на
 взыскание: N справки (письма)  ____________ дата __________________________
  ];
  return TRUE;
end;

/**********************************************************/

macro Хвостовик_по_клиенту
  var stat = True;
[
  Правильность заполнения налоговой карточки проверена:

             ##############################  ##############################
  ---------- ------------------------------  ------------------------------  -----------
    (Дата)           (Должность)                (Фамилия, Имя, Отчество)      (Подпись)
]
(
  /* {curdate}:c, */ Post_Boss:c,  FIO_Boss:c
);
  return stat;
end;
/**********************************************************/

macro Заголовок_по_клиенту
/*
  Заголовок по вкладчику
*/
  var stat = True;
  ARRAY org_a, adr_a, prev_a;
  var Citizenship = 1; /* Пока резидент */
  var sCountry1 = "RUS";
  var sCountry2 = "RUS";
  var m,y, i;
  var st = True;
  var IDType = "",
      IDCode = "";
  var sPostIndex = "";
  var sRegion = "";
  var sDistrict = "";
  var sProvince = "";
  var sPlace = "";
  var sPlaceType = "";
  var iCorpus = 0, sCorpus = "";
  var Name_Depart = " ( Филиал " + {Name_Bank} + " )";

[
 ############################################################################################   Форма 1-НДФЛ]
 (Name_Bank + Name_Depart);
[
                 НАЛОГОВАЯ КАРТОЧКА ПО УЧЕТУ ДОХОДОВ И НАЛОГА
                 НА ДОХОДЫ ФИЗИЧЕСКИХ ЛИЦ ЗА #### ГОД N ______ ](InputPanel_Year_InAll);
[
 Раздел 1. СВЕДЕНИЯ О НАЛОГОВОМ АГЕНТЕ (ИСТОЧНИКЕ ДОХОДОВ)
  ];
[1.1. ИНН/КПП (для организации или ИНН для налогового агента-индивидуального предпринимателя) ______________/____________]; /*(Bank_INN);*/
[1.2. Код налогового органа, где налоговый агент состоит на учете ####___________________________________________________](CodeTaxAgency);
[1.3. Код ОКТМО ##########](CodeOKATO);
[1.4. Наименование (фамилия, имя, отчество) налогового агента ___________________________________________________________];
[________________________________________________________________________________________________________________________];
[
 Раздел 2. СВЕДЕНИЯ О НАЛОГОПЛАТЕЛЬЩИКЕ (ПОЛУЧАТЕЛЕ ДОХОДА)
  ];

COMCLNT.GetRecord( COMCLNT.CurRec.rec.CodClient );

if (COMCLNT.CurRec.rec.NotResident == StrFor(0))
  Citizenship = 1;
  if ( COMCLNT.CurRec.rec.Country != "" )
    sCountry1 = COMCLNT.CurRec.rec.Country;
  else
    sCountry1 = "RUS";
  end;
  sCountry2  = "";
  sPostIndex = COMCLNT.CurRec.rec.PostIndex;
  sRegion    = getRegionNumber(COMCLNT.CurRec);
else
  Citizenship = 2;
  sCountry1   = COMCLNT.CurRec.rec.Country;
  sCountry2   = ""; // COMCLNT.CurRec.rec.Country;
                    // РАВ - у нас нет поля "Страна проживания"
  sPostIndex  = "";
  sRegion = "";
end;

sPlaceType = Тип_населенного_пункта();
sPlace = TRIM(sPlaceType) + " " + TRIM(COMCLNT.CurRec.rec.Place);
sProvince = COMCLNT.CurRec.rec.Province;
sDistrict = COMCLNT.CurRec.rec.District;

/* Обработка строки "Корпус" */
iCorpus = Index( StrUpr( COMCLNT.CurRec.rec.NumCorp ), "КОРПУС" );
if ( iCorpus > 0 )
  if ( StrLen(COMCLNT.CurRec.rec.NumCorp) > ( iCorpus + 5 ) )
    sCorpus = SubStr( COMCLNT.CurRec.rec.NumCorp, iCorpus + 6 );
  else
    sCorpus = "";
  end;
else
  sCorpus = COMCLNT.CurRec.rec.NumCorp;
end;
[2.1. ИНН ###############  2.2. Номер страхового свидетельства ПФР ______________________________________________________](COMCLNT.CurRec.rec.INN);
[2.3. Фамилия, имя, отчество ######################## ######################## ########################      ](COMCLNT.CurRec.rec.Name1,COMCLNT.CurRec.rec.Name2,COMCLNT.CurRec.rec.Name3);
  if (GetPaprKind(COMCLNT.CurRec.rec.PaperKind))
    IDType = PAPRKIND.Name;
    IDCode = PAPRKIND.CodeDocum;
  end;
[2.4. Вид документа, удостоверяющего личность: Код ####   2.5. Серия, номер документа ############ ################ ](IDCode,COMCLNT.CurRec.rec.PaperSeries,COMCLNT.CurRec.rec.PaperNumber);
[2.6. Дата рождения (число, месяц, год) ##########        2.7. Гражданство (код страны) ###### ](COMCLNT.CurRec.rec.Born,sCountry1);
/* if (COMCLNT.CurRec.rec.Address != "") */
if (COMCLNT.CurRec.rec.Region == 0 )
  StrSplit (COMCLNT.CurRec.rec.Address, adr_a, 50, 50, 2);
[2.8. Адрес постоянного места жительства (в старом формате) ##################################################](adr_a(0));
if (adr_a(1) != "")
[    ##################################################](adr_a(1));
end
else
[2.8. Адрес постоянного места жительства: Код страны ### Почтовый индекс ###### Код региона ############](sCountry2,sPostIndex,sRegion);
[Район ##################################################  Город #####################################################](sProvince,sDistrict);
[#############################################################################################################################################################################################################]
("Населенный пункт " + sPlace +
 "  Улица " + Тип_улицы() + " " +
 TRIM(COMCLNT.CurRec.rec.StreetName) +
 "  Дом " + COMCLNT.CurRec.rec.House +
 "  Корпус " + sCorpus +
 "  Квартира " + COMCLNT.CurRec.rec.Flat);
end;
[2.9. Статус (1-резидент, 2-нерезидент) # Реквизиты документа, подтверждающего статус ############################# ############ ################]
 (Citizenship, IDType, COMCLNT.CurRec.rec.PaperSeries, COMCLNT.CurRec.rec.PaperNumber);
[2.10. Стандартные налоговые вычеты заявлены (1), не заявлены (2)  2];
  return stat;
end;
/***********************************************************
***********************************************************/

macro Выпуск_налоговой_карточки
/*
  Цикл по вкладчикам
*/
  var stat = ERR_OK;
  var st;
  var NumCycle = 0;

  while ((stat == ERR_OK)
      OR (stat == ERR_SKIP))
    NumCycle = NumCycle + 1;
    stat = Выбрать_Данные_По_Очередному_клиенту (NumCycle);
    if (stat == ERR_OK)
      st = Заголовок_по_клиенту();
      if (st)
        /* if (COMCLNT.CurRec.rec.NotResident != StrFor(0)) */
          st = Раздел_3 ();  /* Для нерезидентов */
        /* end; */
      end;
      Раздел_4 ();
      if (st)
        if (COMCLNT.CurRec.rec.NotResident == StrFor(0))
          st = Раздел_5 ();  /* Для резидентов   */
        end;
      end;
      if (st)
        st = Раздел_6 ();
      end;
      if (st)
        st = Разделы_7_8_9 ();
      end;
      if (st)
        st = Хвостовик_по_клиенту ();
      end;
      if (NOT st)
        [ ];
        [ !!! ОШИБКА !!! при заполнении таблицы по вкладчику с кодом ##########](COMCLNT.CurRec.rec.CodClient);
        [ ];
      end;
    end;
  end;
  if (stat == ERR_REPEAT)
    st = False; /* Требуется повторить ввод данных */
  else
    st = True;
  end;
  return st;
end;
/***********************************************************
************************************************************
***********************************************************/

macro rpc_MakeTaxCard
/*
  Головной макрос
*/
  var stat = False;
  while (NOT stat)
    if (Ввод_исходных_данных ("Выпуск налоговой карточки"))
      stat = Выпуск_налоговой_карточки();
    else
      [ Отказались от выпуска налоговой карточки ];
      stat = True;
    end;
  end;
end;
/* --- */
rpc_MakeTaxCard ();
/* ----- Конец файла ----- */
