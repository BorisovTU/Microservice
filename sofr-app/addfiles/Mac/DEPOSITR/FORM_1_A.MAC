/*
  ---------------
  R-Style Softlab
  ---------------
  RS-Retail
  ---------------
  Вклады

  Макрос дооформления карточки формы 1-у

*/

import DeprIntr, ChkPrn, Alg_Vars;

macro CheckPrn

  var
    RegPath = "RS-RETAIL\\ПЕЧАТИ\\ВКЛАДЫ\\ФОРМА_1";

  CheckPrinter(RegPath, StrFor(0));
end;

macro printForm( Address )
  [


















       ####################################################################








  ]
  (
    ( "                 " + Address ):w
  );
end;

macro AddForm1( CodClient, Flags )
  var strAdress = Client_Address( CodClient );

  /* Убираем вывод на экран*/
  if ( StrFor( GetProgramID ) == "П" )
    ALG_RESULT = OK_RES;
    Exit(1); /* Убрать вывод на экран */
    return;
  end;
  CheckPrn();
  if ( GetBitFlag( Flags, 12 ) == 0 )
    MsgBox( "Карточка ф.1-у по счету не печаталась" );
    ALG_RESULT = ERR_RES;
    Exit(1); /* Убрать вывод на экран */
  else
    if ( StrLen( strAdress ) == 0 )
      MsgBox( "Адрес клиента на задан" );
      ALG_RESULT = ERR_RES;
      Exit(1); /* Убрать вывод на экран */
    else
      if ( ConfDlg( "Дооформить карточку ф.1?", NULL, "Да", "Нет" ) == 0 )
        printForm( strAdress );
        ALG_RESULT = OK_RES;
      else
        ALG_RESULT = SKIP_RES;
      end;
    end;
  end;
  ExitMacro;
  end;
end;
