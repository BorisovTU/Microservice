/*

  R-Style SoftLab.

  RS-Retail.

  Специальные счета вкладчиков.

  Помещение кода валютной операции в основание документа.

*/

 import DeprIntr, Alg_Vars, SpecMain;

 const UPDATE_DOC = 4;

 var vDIR;
 var vCategory = "";
 var vGround = "";
 var RegVal = false;
 var error = 0;

 ALG_RESULT = OK_RES;

 GetRegistryValue( "COMMON\\ВЕДЕНИЕ БД ВО В ПРИКЛАДНЫХ БО", V_BOOL, RegVal, error );
 if( error != 0 )
   RegVal = false;
 end;
 if ( RegVal )

   if ( DoSetSpecCode( ALG_SBDEPDOC.IsCur, ALG_SBDEPDOC.Type_Account, ALG_SBDEPDOC.Ground ) )
     /* Update записи документа по операции */
     if ( UpdateAlgRecords( UPDATE_DOC, TRUE ) )
       ALG_RESULT = OK_RES;
     else
       ALG_RESULT = ERR_RES;
     end;
   end;
  end;

 Exit( 1 );
