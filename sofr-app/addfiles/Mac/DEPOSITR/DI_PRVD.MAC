/****************************************************************

  R-Style SoftLab.

  RS-Retail.

  Страхование частных вкладов.

  Формирование реестра обязательств.

  Вызов из пункта меню.

*****************************************************************/

import DI_ExeVd;

var ErrCodePV;

/******************************************************************/
/*  Головная процедура формирования Реестра при запуске из меню   */
/******************************************************************/

  if ( ( GetRegistryValue( RegP_LNS1, V_BOOL, RegVD_LNS1, ErrCodePV ) != V_BOOL )  OR
       ( ErrCodePV != 0 ) )
    RegVD_LNS1 = 0;
  end;

  if ( ( GetRegistryValue( RegP_LNS2, V_BOOL, RegVD_LNS2, ErrCodePV ) != V_BOOL )  OR
       ( ErrCodePV != 0 ) )
    RegVD_LNS2 = 0;
  end;

  /* Флаги: Loans Online и Loans Offline */
  if ( ( RegVD_LNS1 != 0 )  OR  ( RegVD_LNS2 != 0 ) )
    vLoansOn  = TRUE;
    vLoansOff = FALSE;
  else
    vLoansOn  = FALSE;
    vLoansOff = TRUE;
  end;

  /* Флаг выполнения расчета */
  if ( vLoansOn  OR  vLoansOff )
    vNeedCalc = TRUE;
  else
    vNeedCalc = FALSE;
  end;

  Main_Insurance_Reestr( DateZero,
                         vLoansOn,   /* Флаг: Loans Online */
                         vLoansOff,  /* Флаг: Loans Offline */
                         vNeedCalc,  /* Флаг выполнения расчета */
                         FALSE,
                         "",
                         "" );
