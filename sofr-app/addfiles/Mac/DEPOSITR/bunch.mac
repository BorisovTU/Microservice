/**************************************************************************\
*  ---------------------                                                   *
*  R-Style Software Lab.                                                   *
*  ---------------------                                                   *
*  RS-Retail                                                               *
*                                                                          *
*  Касса                                                                   *
*                                                                          *
*   Класс "Детализация по кассовому документу"                             *
*                                                                          *
*  RA 10-04-03                                                             *
\**************************************************************************/

// Если какой-либо параметр не нужен - укажите null
class TBunch( _BagAppKind_, _BagAppKey_, _Type_, _Nominal_, _Series_, _Min_ )

  // Данные класса. По смыслу - private
  // private написать нельзя, потому что отвалится this
  var
    bunch = TBFile( "bunch.dbt", "r", 0 ),
    _BagAppKind = _BagAppKind_,
    _BagAppKey  = _BagAppKey_ ,
    _Type       = _Type_      ,
    _Nominal    = _Nominal_   ,
    _Series     = _Series_    ,
    _Min        = _Min_       ;

  macro firstDoc
  
    bunch.clear();
    bunch.rec.Nominal = 9.22e16;

    if ( _BagAppKind != null )  bunch.rec.BagAppKind = _BagAppKind;  end;
    if ( _BagAppKey  != null )  bunch.rec.BagAppKey  = _BagAppKey ;  end;
    if ( _Type       != null )  bunch.rec.Type       = _Type      ;  end;
    if ( _Nominal    != null )  bunch.rec.Nominal    = _Nominal   ;  end;
    if ( _Series     != null )  bunch.rec.Series     = _Series    ;  end;
    if ( _Min        != null )  bunch.rec.Min        = _Min       ;  end;
    return ( 
              bunch.getGE()
      and ( ( _BagAppKind == null ) or ( bunch.rec.BagAppKind == _BagAppKind ) )
      and ( ( _BagAppKey  == null ) or ( bunch.rec.BagAppKey  == _BagAppKey  ) )
      and ( ( _Type       == null ) or ( bunch.rec.Type       == _Type       ) )
      and ( ( _Nominal    == null ) or ( bunch.rec.Nominal    == _Nominal    ) )
      and ( ( _Series     == null ) or ( bunch.rec.Series     == _Series     ) )
      and ( ( _Min        == null ) or ( bunch.rec.Min        == _Min        ) )
           );
  end;

  macro nextDoc

    return ( 
              bunch.next()
      and ( ( _BagAppKind == null ) or ( bunch.rec.BagAppKind == _BagAppKind ) )
      and ( ( _BagAppKey  == null ) or ( bunch.rec.BagAppKey  == _BagAppKey  ) )
      and ( ( _Type       == null ) or ( bunch.rec.Type       == _Type       ) )
      and ( ( _Nominal    == null ) or ( bunch.rec.Nominal    == _Nominal    ) )
      and ( ( _Series     == null ) or ( bunch.rec.Series     == _Series     ) )
      and ( ( _Min        == null ) or ( bunch.rec.Min        == _Min        ) )
           );
  end;

  macro GetFile()
    return bunch;
  end;
  
  macro BagAppKind()
    return bunch.rec.BagAppKind;
  end;
  
  macro BagAppKey()
    return bunch.rec.BagAppKey;
  end;

  macro Type()
    return bunch.rec.Type;
  end;

  macro Nominal()
    return bunch.rec.Nominal;
  end;

  macro Series()
    return bunch.rec.Series;
  end;

  macro Min()
    return bunch.rec.Min;
  end;

end;
