import rtutils;

/*!
 * Вызывает функцию fn с параметрами, которые содержатся в массиве parms (TArray, vector)
 * fn одно из
 * V_STRING имя функции ExecMacro3("fn", parms)
 * V_PROC ссылка на функцию ExecMacro3(@fn, parms)
 * V_R2M ссылка на функцию член ExecMacro3(R2M(obj,"fn"), parms)
 * @return результат вызова функции fn
 * @throw нет
 */
macro ExecMacro3(fn, parms)
  var i = 0;
  var parmstr = null;
  
  if( parms.size > 0 )
    parmstr = "";
    while( i < parms.size - 1 )
      parmstr = parmstr + "parms(" + string(i) + "),";
      inc(i);
    end;
    parmstr = parmstr + "parms(" + string(parms.size-1) + ")";
  end;
  
  var stmt = "ExecMacro2(fn";
  if( parmstr != null )
    stmt = stmt + ", " + parmstr;
  end;
  stmt = stmt + ");";
  
  return ExecExp(stmt);
end;

