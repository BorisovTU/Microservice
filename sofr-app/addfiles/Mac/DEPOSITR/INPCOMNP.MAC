/******************************************************
*  СБЕРБАНК 1.0                                       *
*  R-Style SoftWare Lab.                              *
*                                                     *
*  Ввод комиссии по наличным перечислениям            *
*                                                     *
*  Лебедев С.В.                                       *
*  30.12.97                                           *
******************************************************/

 record Recipient  ("cp_recip.dbt");
 record OC_PAY_DOC ("pay_doc.np");   /* Глобальная переменная */
 var PerCentOper = 0.0;
 var str;
 
 if (OC_PAY_DOC.GroupOpert == 11)
   if (GetDouble(PerCentOper,"Введите процент комиссии",8))
     OC_PAY_DOC.CommCodCur = OC_PAY_DOC.CodCur;
     OC_PAY_DOC.CommSum = Money((OC_PAY_DOC.InSum * PerCentOper) / 100);
     OC_PAY_DOC.InSum = OC_PAY_DOC.InSum - OC_PAY_DOC.CommSum;
     str = String(OC_PAY_DOC.CommSum:15:2:a);
     str = "Сумма комиссии " + Trim(str);
     MsgBox(str);
   else
     MsgBox("Отказались от взимания комиссии");
   end;
 elif (OC_PAY_DOC.GroupOpert == 41) /* Выплата */
   if (GetDouble(PerCentOper,"Введите процент комиссии",8))
     OC_PAY_DOC.CommCodCur = OC_PAY_DOC.CodCur;
     OC_PAY_DOC.CommSum = Money((OC_PAY_DOC.InSum * PerCentOper) / 100);
     str = String(OC_PAY_DOC.CommSum:15:2:a);
     str = "Сумма комиссии " + Trim(str);
     MsgBox(str);
   else
     MsgBox("Отказались от взимания комиссии");
   end;
 else
   MsgBox("Вид кассовой операции не соответствует взятию комиссии");
 end;

end;
