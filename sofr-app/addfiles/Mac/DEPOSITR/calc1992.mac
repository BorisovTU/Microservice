/* Расчет дохода для сертификатов 1992 г. */

var
  Tax = $0, 
  Yield=$0;    /* "Возвращаемое" значение */

array
  Yield_1996,
  Yield_1997;

Yield_1996(1)=44.44;
Yield_1996(2)=44.67;
Yield_1996(3)=44.78;
Yield_1996(4)=44.57;
Yield_1996(5)=43.71;
Yield_1996(6)=42.78;
Yield_1996(7)=41.80;
Yield_1996(8)=40.83;
Yield_1996(9)=40.49;
Yield_1996(10)=40.11;
Yield_1996(11)=40.43;
Yield_1996(12)=39.32;

Yield_1997(1)=76.46;
Yield_1997(2)=74.31;
Yield_1997(3)=72.19;
Yield_1997(4)=69.56;
Yield_1997(5)=66.98;
Yield_1997(6)=64.44;
Yield_1997(7)=61.95;
Yield_1997(8)=43.41;
Yield_1997(9)=41.02;
Yield_1997(10)=38.50;
Yield_1997(11)=36.73;
Yield_1997(12)=35.17;

macro CalcYield(Issue,Par,Duration,SellDate,DemandDate)

  var
    Year,Month,Day;

  [ Расчет дохода по сертификату ];
  [ ============================ ];
  [ ];
  [ Дата выдачи:      ########### ]( SellDate );
  [ Дата оплаты:      ########### ]( DemandDate );

  if ( ( SellDate < Date( 1, 1, 1993 ) ) or ( SellDate > Date( 31, 12, 1994 ) ) )
    return false;
  end;

  if ( ( Par == $5 ) and ( SellDate > Date( 31, 12, 1993 ) ) )
    return false;
  end;

  DateSplit(SellDate,Day,Month,Year);
  if(Year+3==1996)
    Yield=Yield_1996(Month)*Par/5 - Par;
    [ Цена покупки:    ########### ]( Money( Yield_1996(Month) * Par / 5 ) );	
  elif((Year+3==1997) and (Par != $5))
    Yield=Yield_1997(Month)*Par/10 - Par;
    [ Цена покупки:    ########### ]( Money( Yield_1996(Month) * Par / 10 ) );	
  end;
  [ ---------------------------- ];
  [ Доход:           ########### ]( Money( Yield ) );	
  return true;
end;

  