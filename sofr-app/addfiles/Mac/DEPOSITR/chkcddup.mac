
/*
**  Проверка на дублирование кассового документа
*/

private file cashDoc( "sb_casdc.dbt" ) key 7;
private file cashVal( "sb_casvl.dbt" ) key 1;


macro checkCashDocDuplication( cdParm )

  cashVal.Type = cdParm.Type;
  cashVal.TypeValue = cdParm.TypeValue;
  cashVal.CodIntValue = cdParm.CodIntValue;
  if ( getEQ( cashVal ) )
    cashDoc.RefValue = cashVal.RefValue;
    cashDoc.ApplicationKind = cdParm.ApplicationKind;
    cashDoc.ApplicationKey = cdParm.ApplicationKey;
    if ( getEQ( cashDoc ) )
      return false;
    end;
  end;

  return true;
end;