/*
  RS-Retail

  Проверка правомочности выполнения расходных операций
  для вклада на предъявителя

  Ромодин Александр Васильевич
  23.05.00
*/
Import bankinter;

var {oper};
var ErrCode;

const  OK_RES   =  0,  /* продолжать проводку                            */
       SKIP_RES =  1,  /* пропустить выполнение предопределенного модуля */
       END_RES  =  2,  /* завершить проводку                             */
       ERR_RES  = -1;  /* аваpийно завершить проводку                    */

/* *********************************************************
  Точка входа
*/
  var RegPath = "RS-RETAIL\\СЕРВИСНЫЕ\\ВКЛАДЫ\\ЗАПРЕТ_РАСХОДА_НА_ПРЕДЪЯВИТЕЛЯ";
  var Value;
  var May = False;

  if (GetRegistryValue(RegPath, V_INTEGER, Value, ErrCode) == V_INTEGER)
    if (Value == 0)
      May = True;
    end;
  end;
  if (May)
    ALG_RESULT = OK_RES;
  else
    ALG_RESULT = ERR_RES;
    MsgBox ("Вам запрещено проводить расходные операции");
  end;
end;
/* -- Конец макроса -- */
