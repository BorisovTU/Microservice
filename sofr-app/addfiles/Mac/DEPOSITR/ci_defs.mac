/* Общие определения для ценных бумаг */

import deprIntr, od_com, od_desk, ci_class, brParm;

const
  SB_CAPISSUE=300;

var
  cert = TBFile( "cert.dbt", "r", 1 ), 
  capIssueDoc = TBFile( "ci_doc.dbt", "r", 2 ), 
  capIssueRec = TBFile( "ci_rec.dbt", "r", 0 );


macro checkCIDoc

  if ( ( capIssueDoc.rec.Action == D_STORN ) or ( capIssueDoc.rec.Action == D_DELETE ) )
    return false;
  end;

  /* Непроведенный документ */
  if ( ( capIssueDoc.rec.IsSuspended != "" ) and ( capIssueDoc.rec.IsSuspended != "X" ) )
    return false;
  end;

  return true;

end;
