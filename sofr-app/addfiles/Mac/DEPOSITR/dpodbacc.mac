import DeprIntr, alg_vars;
     
file sb_dtyp ( sb_dtyp ) key 2;
file currency ( currency ) key 0;

private var userAttrs;
private var varUserAttrs;


/**************************************************************************\
|                                                                          |
\**************************************************************************/
private macro FindDepType( )

  ClearRecord( sb_dtyp );
  KeyNum( sb_dtyp, 2 );

  sb_dtyp.FlagCur = ALG_SBDEPDOC.IsCur;
  sb_dtyp.Kind = ALG_SBDEPDOC.Type_Account;

  return GetEQ( sb_dtyp );

end;


/**************************************************************************\
|                                                                          |
\**************************************************************************/
private macro FindCurr( )

  ClearRecord( currency );
  KeyNum( currency, 0 );

  currency.Code_Currency = ALG_SBDEPDOC.Code_Currency;

  return GetEQ( currency );

end;


/**************************************************************************\
|                                                                          |
\**************************************************************************/

  ALG_RESULT = OK_RES;

  if ( FindDepType( ) and FindCurr( ) )
    ;
  else
    ALG_RESULT = ERR_RES;
  end;

  if ( ALG_RESULT == OK_RES )
    if ( Index( sb_dtyp.UserTypeAccount, "Œ" ) > 0 ) /* Œ¥â ««¨ç¥áª¨¥ áç¥â  */

      userAttrs = getDocUserAttrPool( );
      userAttrs.clear( );
      userAttrs.rec.Branch           = NumFNCash( );
      userAttrs.rec.iApplicationKind = ALG_SBDEPDOC.iApplicationKind;
      userAttrs.rec.ApplicationKey   = ALG_SBDEPDOC.ApplicationKey;
      userAttrs.rec.AttrID           = "ODB_ACCOUNTS";

      varUserAttrs = userAttrs.overlayRecord( "cvodbacc.rec", 0, false );
      varUserAttrs.clear( );

      if ( ( currency.ExternalCode == "98"  ) or  /* „®ªã¬¥­â ¤«ï §®«®â  */
           ( currency.ExternalCode == "€98" ) or 
           ( currency.ExternalCode == "A98" )   )
        varUserAttrs.rec.Account1 = "20302€98Š’’0100";
        varUserAttrs.rec.Account2 = "20302€98Š’’02";
        varUserAttrs.rec.Account3 = "20302810Š’’0100";
        varUserAttrs.rec.Account4 = "20302810Š’’02";
      else
        varUserAttrs.rec.Account1 = "20303‚‚‚Š’’0100";
        varUserAttrs.rec.Account2 = "20303‚‚‚Š’’02";
        varUserAttrs.rec.Account3 = "20303810Š’’0100";
        varUserAttrs.rec.Account4 = "20303810Š’’02";
      end;

      if ( userAttrs.insert( varUserAttrs.recSize ) )
        ;
      else
        ALG_RESULT = ERR_RES;
      end;

    end;
  end;

end;
