/****************************************************************
*  ---------------------                                        *
*  R-Style Software Lab.                                        *
*  ---------------------                                        *
*  RS-Retail                                                    *
*                                                               *
*  Отчет для группового начисления наращенных процентов         *
*  Имя файла и главной макрофункции менять нельзя               *
*                                                               *
*  Лебедев С.В.                                                 *
*  08.09.99                                                     *
28.11.2002г -KIN поменяны местами столбцы отчета по резерву

****************************************************************/

file currency (currency) key 0;

var WasPrintHeader = FALSE;


/****************************************************************
                         Печать заголовка
****************************************************************/
macro PrintHeader

  [ ];
  [            Групповой расчет и начисление накопленных процентов];
  [ ];
  [ +--------------------+------+-------------------------------+-------------+];
  [ |                    |      |          Сумма процентов      |             |];
  [ |     Вид вклада     |Валюта+-------------------------------+     Дата    |];
  [ |                    |      |   Начисленная |  Начисленная  |             |];
  [ |                    |      |    на дату    |     всего     |             |];
  [ +--------------------+------+---------------+---------------+-------------+];

  WasPrintHeader = TRUE;

end;


/****************************************************************
                Г Л А В Н А Я   П Р О Г Р А М М А
****************************************************************/
macro PcEstim 
(
 TypeAccount,
 CodCur,
 CalcPayDate,
 SummaCalc,
 SummaCalcAll,
 SummaPay,
 SummaCalcNRez,
 SummaCalcAllNRez,
 SummaPayNRez
)

  var NameCur = "";

  if (NOT WasPrintHeader)
    PrintHeader();
  end;

  if ((SummaCalc != 0) OR (SummaCalcAll != 0) OR (SummaPay != 0))
    currency.Code_Currency = CodCur;
    if (GetEQ(currency))
      NameCur = currency.Short_Name;
    end;
    [  ####################  ###   ############### ###############    ##########]
    (TypeAccount,NameCur,SummaPay:11:2:a,SummaCalcAll:11:2:a,CalcPayDate);

/* KIN поменяны местами столбцы отчета по резерву    
    (TypeAccount,NameCur,SummaCalcAll:11:2:a,SummaPay:11:2:a,CalcPayDate); */
  end;

  if ((SummaCalcNRez != 0) OR (SummaCalcAllNRez != 0) OR (SummaPayNRez != 0))
    currency.Code_Currency = CodCur;
    if (GetEQ(currency))
      NameCur = currency.Short_Name;
    end;
    [  ####################  ###   ############### ###############    ##########]
    (TypeAccount + " (н/р)",NameCur,SummaPayNRez:11:2:a,SummaCalcAllNRez:11:2:a,CalcPayDate);
    
/* KIN поменяны местами столбцы отчета по резерву      
     (TypeAccount + " (н/р)",NameCur,SummaCalcAllNRez:11:2:a,SummaPayNRez:11:2:a,CalcPayDate); */
  end;

end;
