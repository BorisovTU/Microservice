/*

   R-Style SoftLab

   RS-Retail

   Макрос выпуска ф.31 и ф.187 при открытии "Блокированного целевого для ГЖС"

*/

const
  RES_OK   =  0,  /* продолжать проводку                            */
  RES_SKIP =  1,  /* пропустить выполнение предопределенного модуля */
  RES_END  =  2,  /* завершить проводку                             */
  RES_ERR  = -1;  /* аваpийно завершить проводку                    */

var Res31 = ExecMacroFile( "dep_f31.mac", "CarryForm31", TRUE );

println("\n\n");

ExecMacroFile( "blockir1.mac" );

ExecMacroFile( "f187comm.mac", "CheckPrn" );

ExecMacroFile( "order187.mac", "PrintOrder187", FALSE );

ExecMacroFile( "blockir2.mac" );

if ( Res31 )
  ALG_RESULT = RES_OK;
else
  ALG_RESULT = RES_ERR;
end;

ExecMacroFile( "chkprn.mac", "ExitMacro" );
