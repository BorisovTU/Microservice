
/* Макрос управления выполнением процедуры завершения отчетного периода */

import CommonInter;

record ALG_PARAM( "sb_algop.dbt" );

/*---------- Коды возврата макроса --------------------------------------*/
 const  OK_RES   =  0,  /* продолжать проводку */
        SKIP_RES =  1,  /* пропустить выполнение предопределенного модуля */
        END_RES  =  2,  /* завершить проводку */
        ERR_RES  = -1;  /* аваpийно завершить проводку */
/*-----------------------------------------------------------------------*/

const
  ALGEOY_PENS           = 1000,         /* Ревизия пенсионных вкладов */
  ALGEOY_CONTR          = 1010,         /* Обработка просроченных договоров */
  ALGEOY_PUTPC          = 1020,         /* Расчет и причисление %% */
  ALGEOY_USER           = 1080;         /* Макрос пользователя */

var
  {curdate},
  {BatchMode},
  d, m, y;

ALG_RESULT = OK_RES;

if ( ALG_PARAM.prmI == ALGEOY_PENS )
  DateSplit( {curdate}, d, m, y );
  if ( m != 12 )
    ALG_RESULT = END_RES;
    if ( not {BatchMode} )
      MsgBox( "Шаг 'Ревизия пенсионных' выполняется только в конце года" );
    end; 
  end;
end;
  

