file CIMisc("ci_misc.dbt") key 0;

var
  Price=$0;

array Pr1,Pr2;

Pr1(0)=$1.03; Pr2(0)=$1.01;
Pr1(1)=$1.02; Pr2(1)=$1.03;
Pr1(2)=$1.01; Pr2(2)=$1.02;

const  
  O_LOTTERY_SELL=1;

macro CalcPrice(Type,Issue,Operation,SubOp,DocDate)

  var
    dd,mm,yy;

  if(Operation==O_LOTTERY_SELL)
    DateSplit(DocDate,dd,mm,yy);
    CIMisc.Type=Type;
    CIMisc.IssueID=Issue;
    GetEQ(CIMisc);
    if(dd<=15)
      Price=Money(Pr1(mm-4*Int(mm/4))*(CIMisc.Price));
    else                   
      Price=Money(Pr2(mm-4*Int(mm/4))*(CIMisc.Price));
    end;
  end;
end;

