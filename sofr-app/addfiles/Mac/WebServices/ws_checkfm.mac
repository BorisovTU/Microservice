/*
$Name:               ws_checkfm.mac
$Module:             WebEO
$Description:        Макрос ФМ
*/

import FMInter, ws_validation, deprintr, rtutils, ws_file, wf_appUtils;

macro fm_ResumeCheck ( operationId : integer, Interactive : bool, AsAService : bool, HumBenCheckMode : integer )
  var FM_Operation = RsbFMOperation();
  var result = -1;
  if( FM_Operation.Find( operationId ) )
    result = FM_Operation.CheckOprParties( Interactive, false, HumBenCheckMode, AsAService );
  end;

  return result;
end;

macro fm_StopCheck ( operationId : integer )
  var FM_Operation = RsbFMOperation();
  if( FM_Operation.Find( operationId ) )
    FM_Operation.StopOperation();
  end;
  return 0;
end;

macro fm_GetMessage ( operationId : integer, typeMsg : integer )
  var FM_Operation = RsbFMOperation();
  var msg = "";
  if( FM_Operation.Find( operationId ) )
    if ( typeMsg == 1 )
      msg = FM_Operation.GetCheckMessage();
    elif( typeMsg == 2 )
      msg = FM_Operation.ErrorMessage();
    end;    
  end;

  return msg;
end;