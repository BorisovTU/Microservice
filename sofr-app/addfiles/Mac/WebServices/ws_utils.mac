/*
$Name:               ws_utils.mac
$Module:             WebEO
$Description:        дополнительные функции для ЕО
*/
import rsd;

private const V_SPECVAL = 26;

macro convertNull(v)
  if (valType(v) == V_SPECVAL)
    return null;
  else
    return v;
  end;
end;  

macro GetLLValue
(
  List : integer,
  Number : integer,
  Name
)
  var cmd, rs, result;
  cmd = RsdCommand( "SELECT T_NAME FROM DLLVALUES_DBT WHERE T_LIST = ? AND T_ELEMENT = ?" );
  cmd.AddParam( "ListNumber", RSDBP_IN, List );
  cmd.AddParam( "ElementNumber", RSDBP_IN, Number );
  cmd.NullConversion = true;
  cmd.execute;
  rs = RsdRecordSet( cmd );

  if ( rs.moveNext )
    Name = rs.value( "T_NAME" );
    result = true;
  else
    Name = "";
    result = false;
  end;

  SetParm( 2, Name );
  return result;
end;
