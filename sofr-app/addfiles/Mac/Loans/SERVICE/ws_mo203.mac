/*------------------------------------------------------------------------------
                     Библиотека интерпретируемых модулей

 Filename    : ws_mo203.mac
 Description : Печать МО из Сервиса "Мемориальный ордер №203"

 Programmer  : TFS
 23.05.2014  : Создан
------------------------------------------------------------------------------*/

IMPORT mo_203, ws_file;

/*
$Name:         ws_mo203.mac
$Module:       Кредитование
$Description:  Макрос печати документов из Единого Окна
*/
/*
 Сервис передает массив ID Документов
*/
MACRO PrintDoc(DocAccID: TArray)
   VAR FC = "", I = 0, opnmode = "C"; // Режим открытия файла. При первом обращении файл очищаем
   RECORD Документ ("doc_acc.dbt");

   WHILE (I < DocAccID.Size) 
      IF (Loans_FindDocAcc(0, "", 0, DocAccID(i), Документ))
         FC = ПечатьМемориальногоОрдера (Документ, true, opnmode);
      END;
      opnmode = "A"; // При повторном - открываем в режиме Append
      I = I + 1;
   END;

   RETURN GetTextFile(FC);

onError
   RETURN 0;
END;