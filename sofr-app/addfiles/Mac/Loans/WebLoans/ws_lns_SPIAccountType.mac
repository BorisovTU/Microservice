/*
$Name: ws_lns_SPIAccountType.mac
$Module: WebLoans
$Description: Сервис источника данных для листалки "тип счета внешней подсистемы"
*/
IMPORT RsbDataSet, "total.mac";

PRIVATE CLASS CLnsSPIAccountType
  var TypeAccID:   integer = 0,
      Chapter:     string  = "",
      Name:        string  = "",
      Description: string  = "",
      SysType:     string  = "";
END;

MACRO lns_SPIAccountTypeList()
    VAR result = TArray(), obj = NULL;
    VAR rs = NULL;
    VAR query = "select * from digtypacc_dbt";
    rs = TRsbDataSet(query);
    
    WHILE (rs.moveNext())
        obj = CLnsSPIAccountType();
        obj.TypeAccID   = rs.TypeAccID;
        obj.Chapter     = rs.Chapter;
        obj.Name        = rs.Name;
        obj.Description = rs.Description;
        obj.SysType     = rs.SysType;
        result[result.size] = obj;
    END;
  
    RETURN result;
END;

MACRO lns_SPIAccountTypeByID(TypeAccID: integer)
    VAR result = CLnsSPIAccountType();
    VAR rs = NULL;
    VAR query = "select * from digtypacc_dbt where t_typeaccid = " + TypeAccID;
    rs = TRsbDataSet(query);
    
    if (rs.moveNext())
        result.TypeAccID   = rs.TypeAccID;
        result.Chapter     = rs.Chapter;
        result.Name        = rs.Name;
        result.Description = rs.Description;
        result.SysType     = rs.SysType;
    end;
  
    RETURN result;

END;


