/*
$Name: ws_lns_RejReason.mac
$Module: WebLoans
$Description: Макрос для работы со справочником "Основания отказов в выдаче кредита"
*/
IMPORT RsbDataSet;

PRIVATE CLASS DirectoryDataList
  VAR RejReasonID = 0,
      Name        = "";
END;

MACRO Lns_GetDirectoryDataList(FilterConditionItems)
    VAR result = TArray();
    VAR query = "select * from dlrejreason_dbt where t_RejReasonID > 0 order by 1";
    VAR RS = TRsbDataSet(query);

    WHILE (RS.MoveNext)
        var item = DirectoryDataList();
      
        item.RejReasonID  = RS.RejReasonID;
        item.Name = RS.Name;

        result.value(result.Size) = item;
    END;

    return result;
END;

MACRO Lns_GetRejReasonByID(RejReasonID)
    VAR result = DirectoryDataList();
    VAR query = "select * from dlrejreason_dbt where t_RejReasonID = " + RejReasonID;
    VAR RS = TRsbDataSet(query);

    if (RS.MoveNext)
        result.RejReasonID  = RS.RejReasonID;
        result.Name = RS.Name;
    end;

    return result;
END;