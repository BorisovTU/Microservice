import "total.mac";

private file accrd   ("acc_crd.dbt", "loans.def") key 4;
private file sbacc   ("sb_acc.dbt", "loans.def") key 0;
private file taccred ("taccred.dbt", "loans.def");

macro ¥ç âì‘ç¥â®¢(CredOperID:integer)
   array tc;
   var stat:string;
    
   [                           âªàëâë¥/§ à¥§¥à¢¨à®¢ ­ë¥ áç¥â ];
   [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿];
   [³       §¢ ­¨¥ ª â¥£®à¨¨      ³‚ «îâ ³ƒ« ¢ ³          ‘ç¥â           ³       ‘®áâ®ï­¨¥   ³];
   [ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];

   accrd.CredOperID = CredOperID;
   if (getGE(accrd) and (accrd.CredOperID == CredOperID))
       prev(accrd);
       while (next(accrd) and (accrd.CredOperID == CredOperID))
           taccred.TypeAccCred = accrd.CreditAccountType;
           if (getEQ(taccred))
              StrSplit(taccred.NameTypeAccount, tc, 30, 30, 3);
           end;

           sbacc.CurCode = accrd.CurCode;
           sbacc.AccountNumber = accrd.AccountNumber_Ref;
           if (getGE(sbacc))
              if (sbacc.AccountState == CF_OPEN)
                 stat = "âªàëâ";
              elif (sbacc.AccountState == CF_CLOSE)
                 stat = "‡ ªàëâ";
              elif (sbacc.AccountState == "")
                 stat= "‡ à¥§¥à¢¨à®¢ ­";
              end;
           end;

   [³##############################³      ³     ³                         ³                   ³](tc(0));
   [³##############################³######³#####³#########################³###################³](tc(1), FindShortName(accrd.CurCode):c, accrd.Chapter:c, accrd.AccountNumber_Ref, stat);
   [³##############################³      ³     ³                         ³                   ³](tc(2));
       end;
   end;
   [ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÁÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];

    return 1;
end;