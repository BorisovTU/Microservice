/*------------------------------------------------------------------------------
                     Библиотека интерпретируемых модулей

 Filename    : limit.mac
 Description : Расчёт лимита заявки

 Programmer  : KOE
 27.12.04    : Создан
 Изменения   :
------------------------------------------------------------------------------*/
import "total.mac";
private file ClaimF  ("claim.dbt",    "loans.def");
/*
   Вызывается по CTRLF6 из панели заявки на лимит
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   Входные параметры:
      ClaimID - ID кредитной заявки
*/
macro CalcClaimLimit (ClaimID)

  ClaimF.ClaimID = ClaimID;
  if( not GetEQ(ClaimF) )
    MsgBox("Не найдена кредитная заявка");
     Exit(1);
  end;

  if (not depclnt.GetRecord(ClaimF.LoanerID_Ref))
     MsgBox("Заемщик в справочнике клиентов не найден!");
     Exit(1);
  end;

  return $0;
END;