/*------------------------------------------------------------------------------
                     Библиотека интерпретируемых модулей

 Filename    : spvaruse_report.mac
 Description : Печать протокола мест использования спецпеременной

 Programmer  : Kirjuhin	R.D.
 14.05.2012  : Создан
------------------------------------------------------------------------------*/

IMPORT ActiveX, total , SbCrdInter, BankInter, global;
var
	SpVarID:integer;
macro GetSpVarName (SpID : integer)
	return CRSDCommand ("SELECT T_SPVARIABLENAME FROM DSPVARIABLE_DBT WHERE T_SPVARIABLEID = ?",
						"number", SpID,
						V_STRING);
end;

Macro Печать (SpVarID:integer)
var rs= null;
var precision = 0, ErrCode = 0;

[ г--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------┐];
[ │ Список формул, в которых используется прежнее название спецпеременной ##################################################                                                                                                                               │]
(GetSpVarName (SpVarID));
[ ------------------------------------------+---------------------------------------------------+----------------------------------------------------+-----------------------------------------------------------------------------------------------------│];
[ │ Вид формулы                             │ Название владельца формулы                        │ Ссылка на доровор/вид договора                     │ Местонахождение формулы                                                                             │];
		



  rs = LnGetRecordSet(" SELECT * from dspvaruse_tmp");
    if (rs == null)
        return 0;
    end;
    while (rs.MoveNext())
[ +-----------------------------------------+---------------------------------------------------+----------------------------------------------------+-----------------------------------------------------------------------------------------------------│];
[ │######################################## │ ##################################################│ ################################################## │ ####################################################################################################│]
          (rs.Value("T_TYPEFORMULA",          NULL, V_String), 
		   rs.Value("T_FORMULAOWNER",     NULL, V_String), 
		   rs.Value("T_EXAMPLEOWNER",     NULL, V_String),
                 rs.Value("T_PLACE",     NULL, V_String));
    end;



 [ L--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]

end;
