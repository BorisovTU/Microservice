/*макрос проверки счета для операции Изменения номера счета*/
import SbCrdInter;

record СчетДоговор("acc_crd.dbt", "loans.def");
file   ЛицевойСчет("sb_acc.dbt",  "loans.def");

MACRO ПроверкаСчета()
  var {Филиал};
  ЛицевойСчет.OperDprt      = {Филиал};
  ЛицевойСчет.CurCode       = СчетДоговор.CurCode;
  ЛицевойСчет.AccountNumber = СчетДоговор.AccountNumber_Ref;
  IF (NOT GetEQ(ЛицевойСчет))
    MsgBox("Не найден лицевой счет " + СчетДоговор.AccountNumber_Ref);
    RETURN 1;
  END;

  IF ((СчетДоговор.CreditAccountType == PERC) or
      (СчетДоговор.CreditAccountType == REZ_ACC) or
      (СчетДоговор.CreditAccountType == REZ_EXP) or
      (СчетДоговор.CreditAccountType == CLAIM) or
      (СчетДоговор.CreditAccountType == NO_PERC_2))
      msgbox("Не забудьте изменить номера счетов этого же типа для других сроков");
  END;
  RETURN 0;
END;
