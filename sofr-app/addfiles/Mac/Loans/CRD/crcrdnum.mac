 /*
 $Name: crcrdnum.mac
 $Module: crcrdnum
 $Description: Обработка Шаблона
 */
/*
 Any text.
*/
import "sbcrdnum.mac";

macro ОбработкаШаблона(buff, Template)
   SetBuff(С_Договор, buff);
   ClearRecord(С_Обеспечение);
   if (С_Договор.CRD_KIND!=LO_GENAGGR)
      if (С_Договор.ClientID_Ref == 0)
         MsgBox("Не задан клиент!");
         return;
      end;
   end;
   if ((С_Договор.CreditTypeID_Ref == 0) and (С_Договор.Crd_kind != LO_GENAGGRDEP))
      MsgBox("Не задан вид кредита");
      return;
   end;

   if (С_Договор.RegDate == date(0,0,0))
      MsgBox("Не задана дата регистрации");
      return;
   end;

   С_Договор.UsCreditNumber = СтрокаПоШаблону(Template, С_Договор.Crd_kind);
end;

macro ОбработкаШаблонаЗаявки(buff,Маска,Объект,ИзЗаявки)
	SetBuff(С_Заявка, buff);
    С_Заявка.ClaimNumber = СтрокаПоШаблону(Маска, LO_CLAIM, ИзЗаявки);
end;