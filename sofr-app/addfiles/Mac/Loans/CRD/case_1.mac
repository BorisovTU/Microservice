/*---------------------------------------------------------------------------------
                     Библиотека интерпретируемых модулей

 Filename    : case_1.mac
 Description : Создание документа по шагу операции (формирование/расформирование портфеля)
 Programmer  : TFS
 11.10.04    : Создан
-----------------------------------------------------------------------------------*/
import SbCrdInter;

record ШагОперации ("step_op.dbt",  "loans.def");     /* Запись шага операции */
record Документ    ("doc_acc.dbt",  "loans.def");     /* Буфер документа      */
record Операция    ("crd_op.dbt",   "loans.def");     /* Операция по договору */
record Договор     ("credit_c.dbt", "loans.def");
record RghData     ("rghdata.dat",  "loans.def");

macro ВыполнитьШаг (OperDate, Sum, Data)

  IF (Операция.ObjectTypeID_Ref == LO_CASE)
     RETURN 0;
  END;

  if(( Договор.RiskGroup > 1) and (Договор.FlagOB == FlagOB_SetValue)) return 0; end;
  setbuff(RghData, Data);
  Документ.CarrySum = RghData.Rest;
  return СоздатьДокумент(Документ);
end;
