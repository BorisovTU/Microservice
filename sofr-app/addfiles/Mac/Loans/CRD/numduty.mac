import "sbcrdnum.mac";

macro ОбработкаШаблона(buff, Template, CreditNumber)
   var ObjTypeID = 0;

   SetBuff(С_Обязательство, buff);

   Ф_Договор.CreditNumber = CreditNumber;
   if (GetEQ(Ф_Договор))
      Copy(С_Договор, Ф_Договор);
   else
      MsgBox("Не найден кредитный договор ID = ", CreditNumber);
      return;
   end;

   if (С_Договор.Crd_Kind = LO_GUARANTEE)
      ObjTypeID = LO_BANKGUARANTEE;
   else
      ObjTypeID = LO_DUTY;
   end;

   С_Обязательство.UserNumber = СтрокаПоШаблону(Template, ObjTypeID);
end;
