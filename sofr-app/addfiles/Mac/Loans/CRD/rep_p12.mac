/*
$Name:        rep_p12.mac
$Module:      Кредитование
$Description: Приложение 12 к форме 135
*/

/*Приложение 12 к форме 135*/
IMPORT Календарь, SbCrdInter, total, CommonInter;//, "totalovc.mac";

var ddep = TRecHandler( "i_dp_dep.rec" );
FILE Credit   ("credit_c.dbt", "loans.def");
FILE Karta    ("ov_karta.dbt", "loans.def");
FILE DutyCrd  ("duty_crd.dbt", "loans.def");
FILE AcCrd   ("acc_crd.dbt",  "loans.def") key 1;
FILE TurnAcc ("turn_acc.dbt", "loans.def");
FILE Rep  () txt write;
FILE RepA () txt;

CONST _DAY_      = 1,
      _YEAR_     = 2;

CONST Tbl ="123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0";

VAR NameFile;

private var ErrCode;

if(GetRegistryValue ("RS-RETAIL\\INI\\ДИРЕКТОРИИ\\TEXTDIR", V_STRING, NameFile, ErrCode) != V_STRING)
    msgBox(ErrCode);
    return true;
end;

var OutShem = 0;
if(GetRegistryValue ("RS-LOANS\\ОТЧЕТЫ\\СХЕМА_ВЫГРУЗКИ", V_STRING, OutShem, ErrCode) != V_STRING)
    msgBox(ErrCode);
    return true;
end;
VAR RepDate:date,
    FN:string;
VAR day:integer,
    mon:integer,
    year:integer,
    c:integer = 0,
    i:integer = 0,
    fb:bool;

VAR {ФИЛИАЛ};

CLASS Data
    VAR P:string;
    VAR D:moneyl;
END;

VAR Out = TArray(0);

MACRO InputDate()
    var Ext = "";

    if (ValType(OutShem) == V_UNDEF)
       MsgBox("Не определена схема выгрузки!");
       OutShem = "F";
    else
       OutShem = StrUpr(Substr(trim(OutShem), 1, 1));
    end;

    if (OutShem == "F")
       Ext = "BNK";
    else
       Ext = String({ФИЛИАЛ}:3:o)
    end;

    RepDate = {curdate};

    IF (not GetDate(RepDate, "Введите дату отчета"))
        Exit(1);
    END;
    IF (RepDate > {curdate})
        MsgBox("Дата отчета превышает текущую");
    END;

    DateSplit(RepDate, day, mon, year);
    FN = "#1"+SubStr(Tbl, mon, 1)+SubStr(Tbl, day, 1)+SubStr(String(year),3,2)+"1"+OutShem+"."+Ext;
END;


MACRO CheckDate(BD:date, ED:date, FD:integer, TFD:integer, LD:integer, TLD:integer)
    VAR day = ED - BD;

    IF ((TFD == _DAY_) AND (TLD == _DAY_))
        IF ((day >= FD) AND (day <= LD))
            RETURN TRUE;
        END;
    ELIF ((TFD == _DAY_) AND (TLD == _YEAR_))
        IF (LD == 999)
            IF (day >= FD)
                RETURN TRUE;
            END;
        ELIF ((day >= FD) AND ((DateAfterCalenMonths(BD, LD*12) - BD) >= day))
            RETURN TRUE;
        END;
    ELSE
        IF (LD == 999)
            IF ((BD+day) > DateAfterCalenMonths(BD, FD*12))
                RETURN TRUE;
            END;
        ELIF (((BD+day) > DateAfterCalenMonths(BD, FD*12)) AND ((DateAfterCalenMonths(BD, LD*12) - BD) >= day))
            RETURN TRUE;
        END;
    END;

    RETURN FALSE;
END;

/*макросы получения остатка на счете*/
macro GetAccount( type, KartaID , CurCode)
  ClearRecord(AcCrd);
  AcCrd.ObjectID          = LO_KARTA;
  AcCrd.ObjectNumber      = KartaID;
  AcCrd.CreditAccountType = type;
  AcCrd.Applic            = 1;
  AcCrd.CurCode           = CurCode;
  return GetEQ(AcCrd);
end;

macro RestAccount(IsCur, CurCode, AccountNumber_Ref, TurnOverDate)
  var rest;

  TurnAcc.IsCur = IsCur;
  TurnAcc.CurCode = CurCode;
  TurnAcc.AccountNumber_Ref = AccountNumber_Ref;
  TurnAcc.TurnOverDate = TurnOverDate;
  TurnAcc.Applic = 1;
  if( GetLE( TurnAcc )
     and (TurnAcc.Applic == 1)
     and (TurnAcc.IsCur == IsCur)
     and (TurnAcc.CurCode == CurCode)
     and (TurnAcc.AccountNumber_Ref == AccountNumber_Ref)
    )
    rest = TurnAcc.TurnOverRest;
    if( rest < 0.0 )
      rest = -rest;
    end;
  else
    return $0.0;
  end;
  return rest;
end;

macro SetIsCur( CurCode )
  if( CurCode != 0 )
    return 1;
  else
    return 0;
  end;
end;


macro GetRest(KartaID, type, RestDate, CurCode)
  if( GetAccount( type, KartaID, CurCode ))
     return RestAccount( SetIsCur(AcCrd.CurCode), AcCrd.CurCode, AcCrd.AccountNumber_Ref, RestDate);
  end;
  return $0;
end;


MACRO GetDutyRestDuration(CurCode:integer,
                          FD:integer,
                          TFD:integer,
                          LD:integer,
                          TLD:integer,
                          IsRes:string,
                          TypeRest:integer,
                          IsOverdraft:bool)
    VAR LastDate:date,
        Sum:moneyl = $0;

    i = i + 1;
    UseProgress(i);
    IF (IsOverdraft)
        ReWind(Karta);
        WHILE (Next(Karta))
            IF ((Karta.CurCode == CurCode) AND
                (FindClient (Karta.ClientID_Ref) != "") AND
                (DepClnt.OffshoreResident == IsRes) AND
                (Karta.EndDate >= (RepDate-1)) AND
                (CheckDate(Karta.RegDate, Karta.EndDate, FD, TFD, LD, TLD)))
                Sum = Sum + GetRest(Karta.Karta_ID, TypeRest, RepDate-1, Karta.CurCode);
            END;
        END;
    ELSE
        ReWind(Credit);
        WHILE (Next(Credit))
            IF ((Credit.CurCode == CurCode) AND
                (FindClient (Credit.ClientID_Ref) != "") AND
                (DepClnt.OffshoreResident == IsRes))
                ReWind(DutyCrd);
                WHILE (Next(DutyCrd))
                    IF ((DutyCrd.CreditNumber_Ref == Credit.CreditNumber) AND
                        (DutyCrd.DutyType == 0) AND
                        (DutyCrd.DutyLastDate >= (RepDate-1)))
                        IF (CheckDate(DutyCrd.DutyFirstDate, DutyCrd.DutyLastDate, FD, TFD, LD, TLD))
                            Sum = Sum + ОстатокСО(DutyCrd.DutyID, TypeRest, RepDate-1);
                        END;
                    END;
                END;
            END;
        END;
    END;

    RETURN money(round(Sum * GetRate(RepDate, CurCode)));
END;

MACRO GetSum(CurCode:integer,
             FD:integer,
             TFD:integer,
             LD:integer,
             TLD:integer,
             IsRes:string,
             TypeRest:integer,
             FirstEndDate:date,
             LastEndDate:date,
             IsOverdraft:bool)
    VAR Sum:moneyl = $0;

    i = i + 1;
    UseProgress(i);
    IF (IsOverdraft)
        ReWind(Karta);
        WHILE (Next(Karta))

            IF ((Karta.CurCode == CurCode) AND
                (FindClient (Karta.ClientID_Ref) != "") AND
                (DepClnt.OffshoreResident == IsRes) AND
                (Karta.EndDate >= (RepDate-1)) AND
                (Karta.EndDate > FirstEndDate) AND
                (Karta.EndDate <= LastEndDate) AND
                (CheckDate(Karta.RegDate, Karta.EndDate, FD, TFD, LD, TLD)))
                Sum = Sum + GetRest(Karta.Karta_ID, TypeRest, RepDate-1, Karta.CurCode);
            END;
        END;
    ELSE
        ReWind(Credit);
        WHILE (Next(Credit))
            IF ((Credit.CurCode == CurCode) AND
                (FindClient (Credit.ClientID_Ref) != "") AND
                (DepClnt.OffshoreResident == IsRes))
                ReWind(DutyCrd);
                WHILE (Next(DutyCrd))
                    IF ((DutyCrd.CreditNumber_Ref == Credit.CreditNumber) AND
                        (DutyCrd.DutyType == 0) AND
                        (DutyCrd.DutyLastDate >= (RepDate-1)) AND
                        (DutyCrd.DutyLastDate > FirstEndDate) AND
                        (DutyCrd.DutyLastDate <= LastEndDate))
                        IF (CheckDate(DutyCrd.DutyFirstDate, DutyCrd.DutyLastDate, FD, TFD, LD, TLD))
                            Sum = Sum + ОстатокСО(DutyCrd.DutyID, TypeRest, RepDate-1);
                        END;
                    END;
                END;
            END;
        END;
    END;

    RETURN money(round(Sum * GetRate(RepDate, CurCode)));
END;

InputDate();
InitProgress(184, "Ждите...", "Формирование отчета \"Остатки размещенных средств\"");
Out(0) = GenObject("Data");
Out(0).P = "124550221";
Out(0).D = GetSum(0, 1, _DAY_, 1, _DAY_, "", TDR_MAINREST, RepDate-1, RepDate, false);

Out(1) = GenObject("Data");
Out(1).P = "124570121";
Out(1).D = GetSum(0, 1, _DAY_, 1, _DAY_, "X", TDR_MAINREST, RepDate-1, RepDate, false);

Out(2) = GenObject("Data");
Out(2).P = "124550222";
Out(2).D = GetSum(1, 1, _DAY_, 1, _DAY_, "", TDR_MAINREST, RepDate-1, RepDate, false);

Out(3) = GenObject("Data");
Out(3).P = "124570122";
Out(3).D = GetSum(1, 1, _DAY_, 1, _DAY_, "X", TDR_MAINREST, RepDate-1, RepDate, false);

Out(4) = GenObject("Data");
Out(4).P = "134550221";
Out(4).D = GetSum(0, 2, _DAY_, 7, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(5) = GenObject("Data");
Out(5).P = "134570121";
Out(5).D = GetSum(0, 2, _DAY_, 7, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(6) = GenObject("Data");
Out(6).P = "134550231";
Out(6).D = GetDutyRestDuration(0, 2, _DAY_, 7, _DAY_, "", TDR_MAINREST, false) - Out(4).D;

Out(7) = GenObject("Data");
Out(7).P = "134570131";
Out(7).D = GetDutyRestDuration(0, 2, _DAY_, 7, _DAY_, "X", TDR_MAINREST, false) - Out(5).D;

Out(8) = GenObject("Data");
Out(8).P = "134550222";
Out(8).D = GetSum(1, 2, _DAY_, 7, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(9) = GenObject("Data");
Out(9).P = "134570122";
Out(9).D = GetSum(1, 2, _DAY_, 7, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(10) = GenObject("Data");
Out(10).P = "134550232";
Out(10).D = GetDutyRestDuration(1, 2, _DAY_, 7, _DAY_, "", TDR_MAINREST, false) - Out(8).D;

Out(11) = GenObject("Data");
Out(11).P = "134570132";
Out(11).D = GetDutyRestDuration(1, 2, _DAY_, 7, _DAY_, "X", TDR_MAINREST, false) - Out(9).D;

Out(12) = GenObject("Data");
Out(12).P = "144550221";
Out(12).D = GetSum(0, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(13) = GenObject("Data");
Out(13).P = "144570121";
Out(13).D = GetSum(0, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(14) = GenObject("Data");
Out(14).P = "144550231";
Out(14).D = GetSum(0, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(15) = GenObject("Data");
Out(15).P = "144570131";
Out(15).D = GetSum(0, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(16) = GenObject("Data");
Out(16).P = "144550241";
Out(16).D = GetDutyRestDuration(0, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, false) - Out(14).D - Out(12).D;

Out(17) = GenObject("Data");
Out(17).P = "144570141";
Out(17).D = GetDutyRestDuration(0, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, false) - Out(15).D - Out(13).D;

Out(18) = GenObject("Data");
Out(18).P = "144550222";
Out(18).D = GetSum(1, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(19) = GenObject("Data");
Out(19).P = "144570122";
Out(19).D = GetSum(1, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(20) = GenObject("Data");
Out(20).P = "144550232";
Out(20).D = GetSum(1, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(21) = GenObject("Data");
Out(21).P = "144570132";
Out(21).D = GetSum(1, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(22) = GenObject("Data");
Out(22).P = "144550242";
Out(22).D = GetDutyRestDuration(1, 8, _DAY_, 30, _DAY_, "", TDR_MAINREST, false) - Out(20).D - Out(18).D;

Out(23) = GenObject("Data");
Out(23).P = "144570142";
Out(23).D = GetDutyRestDuration(1, 8, _DAY_, 30, _DAY_, "X", TDR_MAINREST, false) - Out(21).D - Out(19).D;

Out(24) = GenObject("Data");
Out(24).P = "154550321";
Out(24).D = GetSum(0, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(25) = GenObject("Data");
Out(25).P = "154570221";
Out(25).D = GetSum(0, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(26) = GenObject("Data");
Out(26).P = "154550331";
Out(26).D = GetSum(0, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(27) = GenObject("Data");
Out(27).P = "154570231";
Out(27).D = GetSum(0, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(28) = GenObject("Data");
Out(28).P = "154550341";
Out(28).D = GetSum(0, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(29) = GenObject("Data");
Out(29).P = "154570241";
Out(29).D = GetSum(0, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(30) = GenObject("Data");
Out(30).P = "154550351";
Out(30).D = GetDutyRestDuration(0, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, false) - Out(28).D - Out(26).D - Out(24).D;

Out(31) = GenObject("Data");
Out(31).P = "154570251";
Out(31).D = GetDutyRestDuration(0, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, false) - Out(29).D - Out(27).D - Out(25).D;

Out(32) = GenObject("Data");
Out(32).P = "154550322";
Out(32).D = GetSum(1, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(33) = GenObject("Data");
Out(33).P = "154570222";
Out(33).D = GetSum(1, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(34) = GenObject("Data");
Out(34).P = "154550332";
Out(34).D = GetSum(1, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(35) = GenObject("Data");
Out(35).P = "154570232";
Out(35).D = GetSum(1, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(36) = GenObject("Data");
Out(36).P = "154550342";
Out(36).D = GetSum(1, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(37) = GenObject("Data");
Out(37).P = "154570242";
Out(37).D = GetSum(1, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(38) = GenObject("Data");
Out(38).P = "154550352";
Out(38).D = GetDutyRestDuration(1, 31, _DAY_, 90, _DAY_, "", TDR_MAINREST, false) - Out(36).D - Out(34).D - Out(32).D;

Out(39) = GenObject("Data");
Out(39).P = "154570252";
Out(39).D = GetDutyRestDuration(1, 31, _DAY_, 90, _DAY_, "X", TDR_MAINREST, false) - Out(37).D - Out(35).D - Out(33).D;

Out(40) = GenObject("Data");
Out(40).P = "164550421";
Out(40).D = GetSum(0, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(41) = GenObject("Data");
Out(41).P = "164570321";
Out(41).D = GetSum(0, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(42) = GenObject("Data");
Out(42).P = "164550431";
Out(42).D = GetSum(0, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(43) = GenObject("Data");
Out(43).P = "164570331";
Out(43).D = GetSum(0, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(44) = GenObject("Data");
Out(44).P = "164550441";
Out(44).D = GetSum(0, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(45) = GenObject("Data");
Out(45).P = "164570341";
Out(45).D = GetSum(0, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(46) = GenObject("Data");
Out(46).P = "164550451";
Out(46).D = GetSum(0, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(47) = GenObject("Data");
Out(47).P = "164570351";
Out(47).D = GetSum(0, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(48) = GenObject("Data");
Out(48).P = "164550461";
Out(48).D = GetDutyRestDuration(0, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, false) - Out(46).D - Out(44).D - Out(42).D - Out(40).D;

Out(49) = GenObject("Data");
Out(49).P = "164570361";
Out(49).D = GetDutyRestDuration(0, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, false) - Out(47).D - Out(45).D - Out(43).D - Out(41).D;

Out(50) = GenObject("Data");
Out(50).P = "164550422";
Out(50).D = GetSum(1, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(51) = GenObject("Data");
Out(51).P = "164570322";
Out(51).D = GetSum(1, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(52) = GenObject("Data");
Out(52).P = "164550432";
Out(52).D = GetSum(1, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(53) = GenObject("Data");
Out(53).P = "164570332";
Out(53).D = GetSum(1, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(54) = GenObject("Data");
Out(54).P = "164550442";
Out(54).D = GetSum(1, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(55) = GenObject("Data");
Out(55).P = "164570342";
Out(55).D = GetSum(1, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(56) = GenObject("Data");
Out(56).P = "164550452";
Out(56).D = GetSum(1, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(57) = GenObject("Data");
Out(57).P = "164570352";
Out(57).D = GetSum(1, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(58) = GenObject("Data");
Out(58).P = "164550462";
Out(58).D = GetDutyRestDuration(1, 91, _DAY_, 180, _DAY_, "", TDR_MAINREST, false) - Out(56).D - Out(54).D - Out(52).D - Out(50).D;

Out(59) = GenObject("Data");
Out(59).P = "164570362";
Out(59).D = GetDutyRestDuration(1, 91, _DAY_, 180, _DAY_, "X", TDR_MAINREST, false) - Out(57).D - Out(55).D - Out(53).D - Out(51).D;

Out(60) = GenObject("Data");
Out(60).P = "174550521";
Out(60).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(61) = GenObject("Data");
Out(61).P = "174570421";
Out(61).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(62) = GenObject("Data");
Out(62).P = "174550531";
Out(62).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(63) = GenObject("Data");
Out(63).P = "174570431";
Out(63).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(64) = GenObject("Data");
Out(64).P = "174550541";
Out(64).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(65) = GenObject("Data");
Out(65).P = "174570441";
Out(65).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(66) = GenObject("Data");
Out(66).P = "174550551";
Out(66).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(67) = GenObject("Data");
Out(67).P = "174570451";
Out(67).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(68) = GenObject("Data");
Out(68).P = "174550561";
Out(68).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(69) = GenObject("Data");
Out(69).P = "174570461";
Out(69).D = GetSum(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(70) = GenObject("Data");
Out(70).P = "174550571";
Out(70).D = GetDutyRestDuration(0, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, false) - Out(68).D - Out(66).D - Out(64).D - Out(62).D - Out(60).D;

Out(71) = GenObject("Data");
Out(71).P = "174570471";
Out(71).D = GetDutyRestDuration(0, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, false) - Out(69).D - Out(67).D - Out(65).D - Out(63).D - Out(61).D;

Out(72) = GenObject("Data");
Out(72).P = "174550522";
Out(72).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(73) = GenObject("Data");
Out(73).P = "174570422";
Out(73).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(74) = GenObject("Data");
Out(74).P = "174550532";
Out(74).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(75) = GenObject("Data");
Out(75).P = "174570432";
Out(75).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(76) = GenObject("Data");
Out(76).P = "174550542";
Out(76).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(77) = GenObject("Data");
Out(77).P = "174570442";
Out(77).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(78) = GenObject("Data");
Out(78).P = "174550552";
Out(78).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(79) = GenObject("Data");
Out(79).P = "174570452";
Out(79).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(80) = GenObject("Data");
Out(80).P = "174550562";
Out(80).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(81) = GenObject("Data");
Out(81).P = "174570462";
Out(81).D = GetSum(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(82) = GenObject("Data");
Out(82).P = "174550572";
Out(82).D = GetDutyRestDuration(1, 181, _DAY_, 1, _YEAR_, "", TDR_MAINREST, false) - Out(80).D - Out(78).D - Out(76).D - Out(74).D - Out(72).D;

Out(83) = GenObject("Data");
Out(83).P = "174570472";
Out(83).D = GetDutyRestDuration(1, 181, _DAY_, 1, _YEAR_, "X", TDR_MAINREST, false) - Out(81).D - Out(79).D - Out(77).D - Out(75).D - Out(73).D;

Out(84) = GenObject("Data");
Out(84).P = "184550621";
Out(84).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(85) = GenObject("Data");
Out(85).P = "184570521";
Out(85).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(86) = GenObject("Data");
Out(86).P = "184550631";
Out(86).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(87) = GenObject("Data");
Out(87).P = "184570531";
Out(87).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(88) = GenObject("Data");
Out(88).P = "184550641";
Out(88).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(89) = GenObject("Data");
Out(89).P = "184570541";
Out(89).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(90) = GenObject("Data");
Out(90).P = "184550651";
Out(90).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(91) = GenObject("Data");
Out(91).P = "184570551";
Out(91).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(92) = GenObject("Data");
Out(92).P = "184550661";
Out(92).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(93) = GenObject("Data");
Out(93).P = "184570561";
Out(93).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(94) = GenObject("Data");
Out(94).P = "184550671";
Out(94).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(95) = GenObject("Data");
Out(95).P = "184570571";
Out(95).D = GetSum(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(96) = GenObject("Data");
Out(96).P = "184550681";
Out(96).D = GetDutyRestDuration(0, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, false) - Out(94).D - Out(92).D - Out(90).D - Out(88).D - Out(86).D - Out(84).D;

Out(97) = GenObject("Data");
Out(97).P = "184570581";
Out(97).D = GetDutyRestDuration(0, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, false) - Out(95).D - Out(93).D - Out(91).D - Out(89).D - Out(87).D - Out(85).D;

Out(98) = GenObject("Data");
Out(98).P = "184550622";
Out(98).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(99) = GenObject("Data");
Out(99).P = "184570522";
Out(99).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(100) = GenObject("Data");
Out(100).P = "184550632";
Out(100).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(101) = GenObject("Data");
Out(101).P = "184570532";
Out(101).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(102) = GenObject("Data");
Out(102).P = "184550642";
Out(102).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(103) = GenObject("Data");
Out(103).P = "184570542";
Out(103).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(104) = GenObject("Data");
Out(104).P = "184550652";
Out(104).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(105) = GenObject("Data");
Out(105).P = "184570552";
Out(105).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(106) = GenObject("Data");
Out(106).P = "184550662";
Out(106).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(107) = GenObject("Data");
Out(107).P = "184570562";
Out(107).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(108) = GenObject("Data");
Out(108).P = "184550672";
Out(108).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(109) = GenObject("Data");
Out(109).P = "184570572";
Out(109).D = GetSum(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(110) = GenObject("Data");
Out(110).P = "184550682";
Out(110).D = GetDutyRestDuration(1, 1, _YEAR_, 3, _YEAR_, "", TDR_MAINREST, false) - Out(108).D - Out(106).D - Out(104).D - Out(102).D - Out(100).D - Out(98).D;

Out(111) = GenObject("Data");
Out(111).P = "184570582";
Out(111).D = GetDutyRestDuration(1, 1, _YEAR_, 3, _YEAR_, "X", TDR_MAINREST, false) - Out(109).D - Out(107).D - Out(105).D - Out(103).D - Out(101).D - Out(99).D;

Out(112) = GenObject("Data");
Out(112).P = "194550721";
Out(112).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(113) = GenObject("Data");
Out(113).P = "194570621";
Out(113).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(114) = GenObject("Data");
Out(114).P = "194550731";
Out(114).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(115) = GenObject("Data");
Out(115).P = "194570631";
Out(115).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(116) = GenObject("Data");
Out(116).P = "194550741";
Out(116).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(117) = GenObject("Data");
Out(117).P = "194570641";
Out(117).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(118) = GenObject("Data");
Out(118).P = "194550751";
Out(118).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(119) = GenObject("Data");
Out(119).P = "194570651";
Out(119).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(120) = GenObject("Data");
Out(120).P = "194550761";
Out(120).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(121) = GenObject("Data");
Out(121).P = "194570661";
Out(121).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(122) = GenObject("Data");
Out(122).P = "194550771";
Out(122).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(123) = GenObject("Data");
Out(123).P = "194570671";
Out(123).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(124) = GenObject("Data");
Out(124).P = "194550781";
Out(124).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(125) = GenObject("Data");
Out(125).P = "194570681";
Out(125).D = GetSum(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(126) = GenObject("Data");
Out(126).P = "194550791";
Out(126).D = GetDutyRestDuration(0, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, false) - Out(124).D - Out(122).D - Out(120).D - Out(118).D - Out(116).D - Out(114).D - Out(112).D;

Out(127) = GenObject("Data");
Out(127).P = "194570691";
Out(127).D = GetDutyRestDuration(0, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, false) - Out(125).D - Out(123).D - Out(121).D - Out(119).D - Out(117).D - Out(115).D - Out(113).D;

Out(128) = GenObject("Data");
Out(128).P = "194550722";
Out(128).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate, RepDate+1, false);

Out(129) = GenObject("Data");
Out(129).P = "194570622";
Out(129).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate, RepDate+1, false);

Out(130) = GenObject("Data");
Out(130).P = "194550732";
Out(130).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(131) = GenObject("Data");
Out(131).P = "194570632";
Out(131).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+1, RepDate+7, false);

Out(132) = GenObject("Data");
Out(132).P = "194550742";
Out(132).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(133) = GenObject("Data");
Out(133).P = "194570642";
Out(133).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+7, RepDate+30, false);

Out(134) = GenObject("Data");
Out(134).P = "194550752";
Out(134).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(135) = GenObject("Data");
Out(135).P = "194570652";
Out(135).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+30, RepDate+90, false);

Out(136) = GenObject("Data");
Out(136).P = "194550762";
Out(136).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(137) = GenObject("Data");
Out(137).P = "194570662";
Out(137).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+90, RepDate+180, false);

Out(138) = GenObject("Data");
Out(138).P = "194550772";
Out(138).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(139) = GenObject("Data");
Out(139).P = "194570672";
Out(139).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(140) = GenObject("Data");
Out(140).P = "194550782";
Out(140).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(141) = GenObject("Data");
Out(141).P = "194570682";
Out(141).D = GetSum(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(142) = GenObject("Data");
Out(142).P = "194550792";
Out(142).D = GetDutyRestDuration(1, 3, _YEAR_, 999, _YEAR_, "", TDR_MAINREST, false) - Out(140).D - Out(138).D - Out(136).D - Out(134).D - Out(132).D - Out(130).D - Out(128).D;

Out(143) = GenObject("Data");
Out(143).P = "194570692";
Out(143).D = GetDutyRestDuration(1, 3, _YEAR_, 999, _YEAR_, "X", TDR_MAINREST, false) - Out(141).D - Out(139).D - Out(137).D - Out(135).D - Out(133).D - Out(131).D - Out(129).D;

Out(144) = GenObject("Data");
Out(144).P = "1045815Z1";
Out(144).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "", 1, true); //OV_EXPCRD

Out(145) = GenObject("Data");
Out(145).P = "1045817Z1";
Out(145).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "X", 1, true);//OV_EXPCRD

Out(146) = GenObject("Data");
Out(146).P = "104581521";
Out(146).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate, RepDate+1, false);

Out(147) = GenObject("Data");
Out(147).P = "104581721";
Out(147).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate, RepDate+1, false);

Out(148) = GenObject("Data");
Out(148).P = "104581531";
Out(148).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+1, RepDate+7, false);

Out(149) = GenObject("Data");
Out(149).P = "104581731";
Out(149).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+1, RepDate+7, false);

Out(150) = GenObject("Data");
Out(150).P = "104581541";
Out(150).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+7, RepDate+30, false);

Out(151) = GenObject("Data");
Out(151).P = "104581741";
Out(151).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+7, RepDate+30, false);

Out(152) = GenObject("Data");
Out(152).P = "104581551";
Out(152).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+30, RepDate+90, false);

Out(153) = GenObject("Data");
Out(153).P = "104581751";
Out(153).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+30, RepDate+90, false);

Out(154) = GenObject("Data");
Out(154).P = "104581561";
Out(154).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+90, RepDate+180, false);

Out(155) = GenObject("Data");
Out(155).P = "104581761";
Out(155).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+90, RepDate+180, false);

Out(156) = GenObject("Data");
Out(156).P = "104581571";
Out(156).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(157) = GenObject("Data");
Out(157).P = "104581771";
Out(157).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(158) = GenObject("Data");
Out(158).P = "104581581";
Out(158).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(159) = GenObject("Data");
Out(159).P = "104581781";
Out(159).D = GetSum(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(160) = GenObject("Data");
Out(160).P = "104581591";
Out(160).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, false) - Out(158).D - Out(156).D - Out(154).D - Out(152).D - Out(150).D - Out(148).D - Out(146).D;

Out(161) = GenObject("Data");
Out(161).P = "104581791";
Out(161).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, false) - Out(159).D - Out(157).D - Out(155).D - Out(153).D - Out(151).D - Out(149).D - Out(147).D;

Out(162) = GenObject("Data");
Out(162).P = "1045815Z2";
Out(162).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "", 1, true);//OV_EXPCRD

Out(163) = GenObject("Data");
Out(163).P = "1045817Z2";
Out(163).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "X", 1, true);//OV_EXPCRD

Out(164) = GenObject("Data");
Out(164).P = "104581522";
Out(164).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate, RepDate+1, false);

Out(165) = GenObject("Data");
Out(165).P = "104581722";
Out(165).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate, RepDate+1, false);

Out(166) = GenObject("Data");
Out(166).P = "104581532";
Out(166).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+1, RepDate+7, false);

Out(167) = GenObject("Data");
Out(167).P = "104581732";
Out(167).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+1, RepDate+7, false);

Out(168) = GenObject("Data");
Out(168).P = "104581542";
Out(168).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+7, RepDate+30, false);

Out(169) = GenObject("Data");
Out(169).P = "104581742";
Out(169).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+7, RepDate+30, false);

Out(170) = GenObject("Data");
Out(170).P = "104581552";
Out(170).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+30, RepDate+90, false);

Out(171) = GenObject("Data");
Out(171).P = "104581752";
Out(171).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+30, RepDate+90, false);

Out(172) = GenObject("Data");
Out(172).P = "104581562";
Out(172).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+90, RepDate+180, false);

Out(173) = GenObject("Data");
Out(173).P = "104581762";
Out(173).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+90, RepDate+180, false);

Out(174) = GenObject("Data");
Out(174).P = "104581572";
Out(174).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(175) = GenObject("Data");
Out(175).P = "104581772";
Out(175).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, RepDate+180, DateAfterCalenMonths(RepDate,12), false);

Out(176) = GenObject("Data");
Out(176).P = "104581582";
Out(176).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(177) = GenObject("Data");
Out(177).P = "104581782";
Out(177).D = GetSum(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, DateAfterCalenMonths(RepDate,12), DateAfterCalenMonths(RepDate,36), false);

Out(178) = GenObject("Data");
Out(178).P = "104581592";
Out(178).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "", TDR_EXPREST, false) - Out(176).D - Out(174).D - Out(172).D - Out(170).D - Out(168).D - Out(166).D - Out(164).D;

Out(179) = GenObject("Data");
Out(179).P = "104581792";
Out(179).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "X", TDR_EXPREST, false) - Out(177).D - Out(175).D - Out(173).D - Out(171).D - Out(169).D - Out(167).D - Out(165).D;

Out(180) = GenObject("Data");
Out(180).P = "1Z45509Z1";
Out(180).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "", 2, true); //OV_OVCRD_YES

Out(181) = GenObject("Data");
Out(181).P = "1Z45708Z1";
Out(181).D = GetDutyRestDuration(0, 1, _DAY_, 999, _YEAR_, "X", 2, true);//OV_OVCRD_YES

Out(182) = GenObject("Data");
Out(182).P = "1Z45509Z2";
Out(182).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "", 2, true);//OV_OVCRD_YES

Out(183) = GenObject("Data");
Out(183).P = "1Z45508Z2";
Out(183).D = GetDutyRestDuration(1, 1, _DAY_, 999, _YEAR_, "X", 2, true);//OV_OVCRD_YES
RemProgress();

findDepartment({ФИЛИАЛ}, null, ddep);

[ ###########
                                               Ведомость остатков размещенных средств
                                                             за ##########
                                                                                                                          тыс. руб.
+-------------+-------+----------+--------------------------------------------------------------------------------------------------+
|   Срок, на  | Номер |  Остаток |                             Суммы по срокам, оставшимся до погашения                             |
|   который   | счета | размещен.|----------+----------+----------+----------+----------+----------+----------+----------+----------+
|  размещены  |  2-го |  средств |овердрафт |  1 день  |    2-7   |   8-30   |   31-90  |  91-180  | 181 день |   1-3    |  Свыше   |
|   средства  |порядка|          |          |          |   дней   |   дней   |   дней   |   дней   | - 1 год  |   лет    |  3 лет   |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
|овердрафт    | 45509 |##########|##########|          |          |          |          |          |          |          |          |
|             | 45708 |##########|##########|          |          |          |          |          |          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 1 день      | 45502 |##########|          |##########|          |          |          |          |          |          |          |
|             | 45701 |##########|          |##########|          |          |          |          |          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 2-7 дней    | 45502 |##########|          |##########|##########|          |          |          |          |          |          |
|             | 45701 |##########|          |##########|##########|          |          |          |          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 8-30 дней   | 45502 |##########|          |##########|##########|##########|          |          |          |          |          |
|             | 45701 |##########|          |##########|##########|##########|          |          |          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 31-90 дней  | 45503 |##########|          |##########|##########|##########|##########|          |          |          |          |
|             | 45702 |##########|          |##########|##########|##########|##########|          |          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 91-180 дней | 45504 |##########|          |##########|##########|##########|##########|##########|          |          |          |
|             | 45703 |##########|          |##########|##########|##########|##########|##########|          |          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 181 день -  | 45505 |##########|          |##########|##########|##########|##########|##########|##########|          |          |
| 1 год       | 45704 |##########|          |##########|##########|##########|##########|##########|##########|          |          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| 1-3 лет     | 45506 |##########|          |##########|##########|##########|##########|##########|##########|##########|          |
|             | 45705 |##########|          |##########|##########|##########|##########|##########|##########|##########|          |
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
| Свыше 3 лет | 45507 |##########|          |##########|##########|##########|##########|##########|##########|##########|##########|
|             | 45706 |##########|          |##########|##########|##########|##########|##########|##########|##########|##########|
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
|Просроченная | 45815 |##########|##########|##########|##########|##########|##########|##########|##########|##########|##########|
|задолженность| 45817 |##########|##########|##########|##########|##########|##########|##########|##########|##########|##########|
+-------------+-------+----------+----------+----------+----------+----------+----------+----------+----------+----------+----------+
]
(ddep.rec.Name,
 RepDate,
 (Out(180).D + Out(182).D)/1000:r:10:2, (Out(180).D + Out(182).D)/1000:r:10:2,
 (Out(181).D + Out(183).D)/1000:r:10:2, (Out(181).D + Out(183).D)/1000:r:10:2,
 (Out(0).D + Out(2).D)/1000:r:10:2, (Out(0).D + Out(2).D)/1000:r:10:2,
 (Out(1).D + Out(3).D)/1000:r:10:2, (Out(1).D + Out(3).D)/1000:r:10:2,
 (Out(4).D + Out(8).D + Out(6).D + Out(10).D)/1000:r:10:2,
    (Out(4).D + Out(8).D)/1000:r:10:2, (Out(6).D + Out(10).D)/1000:r:10:2,
 (Out(5).D + Out(9).D + Out(7).D + Out(11).D)/1000:r:10:2,
    (Out(5).D + Out(9).D)/1000:r:10:2, (Out(7).D + Out(11).D)/1000:r:10:2,
 (Out(12).D + Out(18).D + Out(14).D + Out(20).D + Out(16).D + Out(22).D)/1000:r:10:2,
    (Out(12).D + Out(18).D)/1000:r:10:2, (Out(14).D + Out(20).D)/1000:r:10:2, (Out(16).D + Out(22).D)/1000:r:10:2,
 (Out(13).D + Out(19).D + Out(15).D + Out(21).D + Out(17).D + Out(23).D)/1000:r:10:2,
    (Out(13).D + Out(19).D)/1000:r:10:2, (Out(15).D + Out(21).D)/1000:r:10:2, (Out(17).D + Out(23).D)/1000:r:10:2,
 (Out(24).D + Out(32).D + Out(26).D + Out(34).D + Out(28).D + Out(36).D + Out(30).D + Out(38).D)/1000:r:10:2,
    (Out(24).D + Out(32).D)/1000:r:10:2, (Out(26).D + Out(34).D)/1000:r:10:2, (Out(28).D + Out(36).D)/1000:r:10:2, (Out(30).D + Out(38).D)/1000:r:10:2,
 (Out(25).D + Out(33).D + Out(27).D + Out(35).D + Out(29).D + Out(37).D + Out(31).D + Out(39).D)/1000:r:10:2,
    (Out(25).D + Out(33).D)/1000:r:10:2, (Out(27).D + Out(35).D)/1000:r:10:2, (Out(29).D + Out(37).D)/1000:r:10:2, (Out(31).D + Out(39).D)/1000:r:10:2,
 (Out(40).D + Out(50).D + Out(42).D + Out(52).D + Out(44).D + Out(54).D + Out(46).D + Out(56).D + Out(48).D + Out(58).D)/1000:r:10:2,
    (Out(40).D + Out(50).D)/1000:r:10:2, (Out(42).D + Out(52).D)/1000:r:10:2, (Out(44).D + Out(54).D)/1000:r:10:2, (Out(46).D + Out(56).D)/1000:r:10:2,
    (Out(48).D + Out(58).D)/1000:r:10:2,
 (Out(41).D + Out(51).D + Out(43).D + Out(53).D + Out(45).D + Out(55).D + Out(47).D + Out(57).D + Out(49).D + Out(59).D)/1000:r:10:2,
    (Out(41).D + Out(51).D)/1000:r:10:2, (Out(43).D + Out(53).D)/1000:r:10:2, (Out(45).D + Out(55).D)/1000:r:10:2, (Out(47).D + Out(57).D)/1000:r:10:2,
    (Out(49).D + Out(59).D)/1000:r:10:2,
 (Out(60).D + Out(72).D + Out(62).D + Out(74).D + Out(64).D + Out(76).D + Out(66).D + Out(78).D + Out(68).D + Out(80).D + Out(70).D + Out(82).D)/1000:r:10:2,
    (Out(60).D + Out(72).D)/1000:r:10:2, (Out(62).D + Out(74).D)/1000:r:10:2, (Out(64).D + Out(76).D)/1000:r:10:2, (Out(66).D + Out(78).D)/1000:r:10:2,
    (Out(68).D + Out(80).D)/1000:r:10:2, (Out(70).D + Out(82).D)/1000:r:10:2,
 (Out(61).D + Out(73).D + Out(63).D + Out(75).D + Out(65).D + Out(77).D + Out(67).D + Out(79).D + Out(69).D + Out(81).D + Out(71).D + Out(83).D)/1000:r:10:2,
    (Out(61).D + Out(73).D)/1000:r:10:2, (Out(63).D + Out(75).D)/1000:r:10:2, (Out(65).D + Out(77).D)/1000:r:10:2, (Out(67).D + Out(79).D)/1000:r:10:2,
    (Out(69).D + Out(81).D)/1000:r:10:2, (Out(71).D + Out(83).D)/1000:r:10:2,
 (Out(84).D + Out(98).D + Out(86).D + Out(100).D + Out(88).D + Out(102).D + Out(90).D + Out(104).D + Out(92).D + Out(106).D + Out(94).D + Out(108).D + Out(96).D + Out(110).D)/1000:r:10:2,
    (Out(84).D + Out(98).D)/1000:r:10:2, (Out(86).D + Out(100).D)/1000:r:10:2, (Out(88).D + Out(102).D)/1000:r:10:2, (Out(90).D + Out(104).D)/1000:r:10:2,
    (Out(92).D + Out(106).D)/1000:r:10:2, (Out(94).D + Out(108).D)/1000:r:10:2, (Out(96).D + Out(110).D)/1000:r:10:2,
 (Out(85).D + Out(99).D + Out(87).D + Out(101).D + Out(89).D + Out(103).D + Out(91).D + Out(105).D + Out(93).D + Out(107).D + Out(95).D + Out(109).D + Out(97).D + Out(111).D)/1000:r:10:2,
    (Out(85).D + Out(99).D)/1000:r:10:2, (Out(87).D + Out(101).D)/1000:r:10:2, (Out(89).D + Out(103).D)/1000:r:10:2, (Out(91).D + Out(105).D)/1000:r:10:2,
    (Out(93).D + Out(107).D)/1000:r:10:2, (Out(95).D + Out(109).D)/1000:r:10:2, (Out(97).D + Out(111).D)/1000:r:10:2,
 (Out(112).D + Out(128).D + Out(114).D + Out(130).D + Out(116).D + Out(132).D + Out(118).D + Out(134).D + Out(120).D + Out(136).D + Out(122).D + Out(138).D + Out(124).D + Out(140).D + Out(126).D + Out(142).D)/1000:r:10:2,
    (Out(112).D + Out(128).D)/1000:r:10:2, (Out(114).D + Out(130).D)/1000:r:10:2, (Out(116).D + Out(132).D)/1000:r:10:2, (Out(118).D + Out(134).D)/1000:r:10:2,
    (Out(120).D + Out(136).D)/1000:r:10:2, (Out(122).D + Out(138).D)/1000:r:10:2, (Out(124).D + Out(140).D)/1000:r:10:2, (Out(126).D + Out(142).D)/1000:r:10:2,
 (Out(113).D + Out(129).D + Out(115).D + Out(131).D + Out(117).D + Out(133).D + Out(119).D + Out(135).D + Out(121).D + Out(137).D + Out(123).D + Out(139).D + Out(125).D + Out(141).D + Out(127).D + Out(143).D)/1000:r:10:2,
    (Out(113).D + Out(129).D)/1000:r:10:2, (Out(115).D + Out(131).D)/1000:r:10:2, (Out(117).D + Out(133).D)/1000:r:10:2, (Out(119).D + Out(135).D)/1000:r:10:2,
    (Out(121).D + Out(137).D)/1000:r:10:2, (Out(123).D + Out(139).D)/1000:r:10:2, (Out(125).D + Out(141).D)/1000:r:10:2, (Out(127).D + Out(143).D)/1000:r:10:2,
 (Out(146).D + Out(164).D + Out(148).D + Out(166).D + Out(150).D + Out(168).D + Out(152).D + Out(170).D + Out(154).D + Out(172).D + Out(156).D + Out(174).D + Out(158).D + Out(176).D + Out(160).D + Out(178).D)/1000:r:10:2,
 (Out(144).D + Out(162).D)/1000:r:10:2,
    (Out(146).D + Out(164).D)/1000:r:10:2, (Out(148).D + Out(166).D)/1000:r:10:2, (Out(150).D + Out(168).D)/1000:r:10:2, (Out(152).D + Out(170).D)/1000:r:10:2,
    (Out(154).D + Out(172).D)/1000:r:10:2, (Out(156).D + Out(174).D)/1000:r:10:2, (Out(158).D + Out(176).D)/1000:r:10:2, (Out(160).D + Out(178).D)/1000:r:10:2,
 (Out(147).D + Out(165).D + Out(149).D + Out(167).D + Out(151).D + Out(169).D + Out(153).D + Out(171).D + Out(155).D + Out(173).D + Out(157).D + Out(175).D + Out(159).D + Out(177).D + Out(161).D + Out(179).D)/1000:r:10:2,
 (Out(145).D + Out(163).D)/1000:r:10:2,
    (Out(147).D + Out(165).D)/1000:r:10:2, (Out(149).D + Out(167).D)/1000:r:10:2, (Out(151).D + Out(169).D)/1000:r:10:2, (Out(153).D + Out(171).D)/1000:r:10:2,
    (Out(155).D + Out(173).D)/1000:r:10:2, (Out(157).D + Out(175).D)/1000:r:10:2, (Out(159).D + Out(177).D)/1000:r:10:2, (Out(161).D + Out(179).D)/1000:r:10:2);

i = 0;
IF (Open(RepA, NameFile + FN))
    ReWind(RepA);
    Next(RepA);Next(RepA);
    WHILE (Next(RepA))
        i = Index(RepA.str, "=");
        c = 0;
        fb = false;
        WHILE ((c < Out.size) and (not fb))
            IF (Out(c).P == SubStr(RepA.str, 1, i-1))
                fb = true;
            END;
            c = c + 1;
        END;
        IF (not fb)
            Out(Out.size) = GenObject("Data");
            Out(Out.size-1).P = SubStr(RepA.str, 1, i-1);
            Out(Out.size-1).D = MoneyL(SubStr(RepA.str, i+1));
        END;
    END;
    Close(RepA);
END;

IF (Open(Rep, NameFile + FN))

    Rep.str = "";
    i = 0;
    WHILE (i < 100)
        Rep.str = Rep.str + " ";
        i = i + 1;
    END;
    Insert(Rep);

    i = c = 0;
    WHILE (i < Out.size)
        IF (Out(i).D != 0)
            c = c + 1;
        END;
        i = i + 1;
    END;

    Rep.str = OutShem + "=" + ddep.rec.Name + "=";
    DateSplit(RepDate, day, mon, year);
    Rep.str = Rep.str + string(day:2:o)+string(mon:2:o)+SubStr(string(year), 2, 3)+"1=";
    DateSplit(RepDate-1, day, mon, year);
    Rep.str = Rep.str + string(day:2:o)+string(mon:2:o)+SubStr(string(year), 2, 3)+"2=";
    DateSplit(RepDate-1, day, mon, year);
    Rep.str = Rep.str + string(day:2:o)+string(mon:2:o)+SubStr(string(year), 2, 3)+"3=";
    DateSplit(date(), day, mon, year);
    Rep.str = Rep.str + string(day:2:o)+string(mon:2:o)+SubStr(string(year), 2, 3)+"4=";
    TimeSplit(time(), day, mon, year);
    Rep.str = Rep.str + string(day:2:o)+string(mon:2:o)+"="+string(c:9:o)+"="+FN;
    Insert(Rep);
    // 3-я строка - пустая
    Rep.str = "";
    Insert(Rep);

    i = 0;
    WHILE (i < Out.size)
        IF (Out(i).D != 0)
            Rep.str = Out(i).P+"="+string(Out(i).D);
            Insert(Rep);
        END;
        i = i + 1;
    END;

    Close(Rep);
END;
