/************************************************************************/
/*         Автоматизированная банковская система RS-Loans               */
/*                 Copyright (c) R-Style Software Lab 2004              */
/*                                                                      */
/*  Имя файла        : statdef.mac                                      */
/*                                                                      */
/*  Описание         : Макрос шага                                      */
/*                                                                      */
/*  Программист      : KOE                                              */
/*                                                                      */
/*  Создан           : 14.02.2005                                       */
/*                                                                      */
/************************************************************************/
import SbCrdInter, InsCarryDoc;

VAR VerdictID = 0;

/******************************************/
/* Пользовательская часть выполнения шага */
/******************************************/

MACRO ExecuteStep(doc, claim, DocKind, ID_Operation)
  record PrimClaim (claim); 
  setbuff (PrimClaim,claim);
  var StatusID:integer = 0;

  if(VerdictID != 0)
      if(VerdictID == DEC_POSITIVE)
          StatusID = CL_CONSIDERING;
      elif(VerdictID == DEC_NEGATIVE)
          StatusID = CL_CONSIDERING;
      elif(VerdictID == DEC_FINISH)
          StatusID = CL_FINISHING;
      elif(VerdictID == DEC_APPROVE)
          StatusID = CL_APPROVED;
      elif(VerdictID == DEC_REJECT)
          StatusID = CL_REJECTED;
      end;

     if(StatusID != 0)
         if( not InsertClaimStatus(PrimClaim.ClaimID, StatusID))
             msgbox("Ошибка при вставке статуса заявки");
             return 1;
         end;
     end; 
  end;

  return 0;
END;


