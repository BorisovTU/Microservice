/************************************************************************/
/*         Автоматизированная банковская система RS-Loans               */
/*                 Copyright (c) R-Style Software Lab 2004              */
/*                                                                      */
/*  Имя файла        : route1.mac                                      */
/*                                                                      */
/*  Описание         : Шаг - Переход к следующему этапу?                */
/*                        Операция - Маршрут-1                          */
/*                                                                      */
/*  Программист      : VOE                                              */
/*                                                                      */
/*  Создан           : 24.02.2004                                       */
/*                                                                      */
/************************************************************************/
import SbCrdInter;
/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, claim, KindDoc)
  VAR ПризнакВыполнения:bool;
  var  СледующийШаг:string = "";
  record PrimClaim (claim); 
  
  setbuff (PrimClaim,claim);
  
  ПризнакВыполнения = ПроверкаВыполненностиЭтапа();

  if(ПризнакВыполнения == true)
     if(Kind_Operation == LN_ROUTE_1)
         if((Number_Step == 30) OR
            (Number_Step == 40))
             СледующийШаг = "50,60,70";
         elif((Number_Step == 80) OR
              (Number_Step == 90) OR
              (Number_Step == 100))
             СледующийШаг = "110";
         end;
     elif(Kind_Operation == LN_ROUTE_2)
         if((Number_Step == 60) OR
            (Number_Step == 70) OR
            (Number_Step == 80) OR
            (Number_Step == 90))
             СледующийШаг = "100";
         end;
     end;
     
     if(trim(СледующийШаг) != "")
         return СледующийШаг;                               
     else
         return 0;
     end;
  else
      return 0;
  end;

  return 0;
END;


