/*
   RS-Loans
   Programmer: TFS
   24.01.05
   Макрос тестирования объекта "Лицевые счета"
 */

IMPORT RsbObjFactory, SbCrdInter, Total;

VAR Enscontr, t1;
VAR Factory  = RsbObjectFactory();
VAR RSCredit = Factory.GetObject("RSCOMCredit");


VAR ДатаНачала   = date(15,03,2000),
    ДатаЗакрытия = date(01,01,2008),
    ДатаОтчета   = {curdate};

   RSCredit.SetCalcRezFlag(false);
   RSCredit.FillData (ДатаНачала, ДатаЗакрытия, ДатаОтчета);
   RSCredit.ApplyFilter();
   t1 = time;

   [ ];
   [ ╔═══════════════════════════════════ Лицевые счета ══════════════════════════════════════════╗];
   [ ╟──────────┬─────────────┬────────────┬─────────────┬────────┬─────────┬─────────────┬───────╢];
   [ ║ Номер    │ Вид         │ Контрагент │ Стоимость   │ Валюта │ Эмитент │ Коэффициент │  ID   ║];
   [ ║ договора │ обеспечения │            │ обеспечения │        │         │             │       ║];
   [ ╟──────────┼─────────────┼────────────┼─────────────┼────────┼─────────┼─────────────┼───────╢];
   WHILE (RSCredit.Next())
      Enscontr = RSCredit.Enscontr();
      Enscontr.ApplyFilter();
      WHILE (Enscontr.Next())
   [ ║ ######## │ ########### │ ########## │ ########### │ ###### │ ####### │ ########### │ ##### ║]
   ( Enscontr.CreditNumber,
     Enscontr.EnsSysType,
     Enscontr.IssuerParty,
     Enscontr.RatingSum,
     Enscontr.RatingCurCode,
     Enscontr.IssuerEns,
     Enscontr.Coefficient,
     Enscontr.EnsContractID
   );
      END;
   END;
   [ ╙──────────┴─────────────┴────────────┴─────────────┴────────┴─────────┴─────────────┴───────╜];
   println(time - t1);