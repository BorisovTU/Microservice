/*
$Name:         forma.mac
$Module:       ┼Ю╔╓╗Б╝╒═╜╗╔
$Description:  ▄═╙Ю╝А Б╔АБ╗Ю╝╒═╜╗О ╝БГ╔Б═ ╞╝ ▐Ю╗╚╝╕╔╜╗Н 7
*/
/*******************************************************************************
 * RS-Loans                                                                    *
 * Programmer: TFS                                                             *
 * 24.01.05                                                                    *
 * ▄═╙Ю╝А Б╔АБ╗Ю╝╒═╜╗О ╝БГ╔Б═ ╞╝ ▐Ю╗╚╝╕╔╜╗Н 7                                  *
 *******************************************************************************/

IMPORT RsbObjFactory, SbCrdInter, Total, fcdepemp;

VAR RecHandler = TRecHandler ("rsvox", "sbcrd.lbr", TRUE);
VAR Factory = RsbObjectFactory();

VAR MasMove = TArray(0);
VAR fname = string({oper})+".txt";


PRIVATE VAR CreditNumber: integer = 0;

PRIVATE VAR GCurCode = TArray(0);
PRIVATE VAR GObjType = TArray(0);
PRIVATE VAR GRegName = TArray(0);
PRIVATE VAR GOperName= TArray(0);
PRIVATE VAR GPayType = TArray(0);


// ■Ц╜╙Ф╗О ╓╚О ╝║Е╝╓═ "undefine"
MACRO isFIELDVAL( str:STRING)
    IF(str == NULL)            RETURN " ";
    END;
    return str;
END;

// ▐Ю╔╝║Ю═╖╝╒═╜╗╔ 0 ╙ ""
MACRO ConvZeroToEmptyStr(val)
  var retval = val;
  
  if(ValType(val) == V_INTEGER)
    if(val == 0)
      retval = "";
    end;
  end;  
  
  return retval;
END; 

MACRO ┌╗╓▓Ю╔║╝╒═╜╗О(Kind: integer)
   IF   (Kind ==     I_REQUIR) RETURN         "▒Ю╝Г╜╝╔ БЮ╔║╝╒═╜╗╔";
   ELIF (Kind ==  I_EXP_DEBTS) RETURN "▐Ю╝АЮ╝Г╔╜╜═О ╖═╓╝╚╕╔╜╜╝АБЛ";
   ELIF (Kind ==   I_EXP_PERC) RETURN      "▐Ю╝АЮ╝Г╔╜╜К╔ ╞Ю╝Ф╔╜БК";
   ELIF (Kind ==  I_LIMIT_PAY) RETURN        "█╔╗А╞╝╚Л╖╝╒═╜╜К╔ ┼▀";
   ELIF (Kind == I_LIMIT_DUTY) RETURN    "█╔╗А╞╝╚Л╖╝╒═╜╜К╔ ▀╗╛╗БК";
   END;

   RETURN "";
END;

MACRO █═╞Ю═╒╚╔╜╗╔(Movemean: integer)
   IF   (Movemean == I_ACCOM) RETURN  "░═╖╛╔И╔╜╗╔";
   ELIF (Movemean ==  I_ATTR) RETURN "▐Ю╗╒╚╔Г╔╜╗╔";
   END;

   RETURN "";
END;

MACRO ▓╗╞▓Ю╔║╝╒═╜╗О(Type: integer)
   IF   (Type ==  I_TYPE_CREDIT) RETURN  "┼Ю╔╓╗Б";
   ELIF (Type == I_TYPE_DEPOSIT) RETURN "└╔╞╝╖╗Б";
   END;

   RETURN "";
END;

MACRO ┌▌(ObjID: integer)
   IF (ValType(ObjID) == V_UNDEF)
      RETURN "";
   END;

   IF (ValType(GObjType(ObjID)) == V_UNDEF)
      GObjType(ObjID) = CRsdCommand("SELECT T_SHORTNAME FROM DLOBJECT_DBT WHERE T_OBJECTID = ?", "SHORTNAME", ObjID, V_STRING);
   END;

   RETURN GObjType(ObjID);
END;

MACRO ┌═╚НБ═(CurCode: integer)
   IF (ValType(CurCode) == V_UNDEF)
      RETURN "";
   END;

   IF (ValType(GCurCode(CurCode)) == V_UNDEF)
      GCurCode(CurCode) = CRsdCommand("SELECT T_CCY FROM DFININSTR_DBT WHERE T_FIID = ?", "CURCODE", CurCode, V_STRING);
   END;

   RETURN GCurCode(CurCode);
END;

MACRO ▌╞╔Ю═Ф╗О(OP: integer)
   IF (ValType(OP) == V_UNDEF)
      RETURN "";
   END;

   IF (ValType(GOperName(OP)) == V_UNDEF)
      GOperName(OP) = CRsdCommand("SELECT T_SYSTEMOPERATIONNAME FROM DSYST_OP_DBT WHERE T_SYSTEMOPERATIONID = ?", "SYSOP", OP, V_STRING);
   END;

   RETURN GOperName(OP);
END;

MACRO ┌╗╓░╔ё╗АБЮ═(RegID: integer)
   IF (ValType(RegID) == V_UNDEF)
      RETURN "";
   END;

   IF (ValType(GRegName(RegID)) == V_UNDEF)
      GRegName(RegID) = CRsdCommand("SELECT T_NAME FROM DSPR_REG_DBT WHERE T_REGID = ?", "REGID", RegID, V_STRING);
   END;

   RETURN GRegName(RegID);
END;

MACRO getObjectFC (ObjID: string, ObjN: string, CreditNumber: integer)
   // █═╘╓╔╛ ┌╗╓ ▌║Й╔╙Б═
   VAR RS1, RS2, str: string = "";
   RS1 = CRsdCommand("SELECT T_CRD_KIND FROM DCREDIT_C_DBT WHERE T_CREDITNUMBER = ?", "CREDITNUMBER", CreditNumber, V_INTEGER);
   IF ((RS1 == LO_CREDIT) OR (RS1 == LO_KARTA))
      RS2 = CRsdCommand("SELECT T_DUTYID FROM DDUTY_CRD_DBT WHERE T_CREDITNUMBER_REF = ?", "CREDITNUMBER", CreditNumber, V_GENOBJ);
      WHILE (RS2.MoveNext())
         IF (str == "")
            str = string("(" + ObjID + " = " + LO_DUTY + " AND (" + ObjN + " = " + SQL_NVL(RS2.Value("T_DUTYID"), V_INTEGER));
         ELSE
            str = str + string(" OR " + ObjN + " = " + SQL_NVL(RS2.Value("T_DUTYID"), V_INTEGER));
         END;
      END;
      IF (str != "")
          str = str + ")) OR (" +  string(ObjID + " = " + RS1 + " AND " + ObjN + " = " + CreditNumber) + ")";
      ELSE
          str = string(ObjID + " = " + RS1 + " AND " + ObjN + " = " + CreditNumber);
      END;
      RETURN str;
   ELSE
      RETURN string(ObjID + " = " + RS1 + " AND " + ObjN + " = " + CreditNumber);
   END;
END;

MACRO ▓╗╞┌К╓═Г╗(PayType)
   IF (ValType(PayType) == V_UNDEF)
      RETURN "";
   END;

   IF (ValType(GPayType(PayType)) == V_UNDEF)
      GPayType(PayType) = CRsdCommand("SELECT T_CODE FROM DLLVALUES_DBT WHERE T_LIST = ? AND T_ELEMENT = ?",
                             "LIST",    1403,
                             "ELEMENT", PayType, V_STRING);
   END;

   RETURN GPayType(PayType);
END;

MACRO └═█╔Б(val)
   VAR str:string = "";  
   IF (ValType(val) != V_UNDEF)  
      IF (val == 1) 
         str = "└═";
      ELSE
         str = "█╔Б";
      END;
   END;

   RETURN str;
END;

MACRO ┌К╒╔АБ╗┬АБ╝Ю╗Н▌╞╔Ю═Ф╗╘()

VAR Factory = NULL,
    RSOper  = NULL;

    Factory = RsbObjectFactory();
    RSOper  = Factory.GetObject("RSVOXOperation", 1);
    RSOper.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    RSOper.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

    IF (CreditNumber != 0) RSOper.SetFilter("CreditNumber = " + CreditNumber); END;

    RSOper.ApplyFilter();

   PrintLn("");
   Println("▌║Й╔╙Б: ┬АБ╝Ю╗О ╝╞╔Ю═Ф╗╘ (RSVOXOperation)");
      [жддддддбддддбдддддддддддбдддддддддддддддддддддддддддддддддбдддддддддддбддддддддддддддддддбддддддддбддддддддддддбдддддддддддбдддддддддбдддддддддбддддддддддбдддддддддддбддддддддддддбддддддддддддддддддддддбдддддддддддддддддддддддбддддддддддддддддддддбддддддддддддддддддбдддддддддддддддддддддддддддбддддддддддддд╥];
      [╨ Э    Ё ┌▌ Ё Э ╝║Й╔╙Б═ Ё Э ╝╞╔Ю═Ф╗╗                      Ё └═Б═      Ё ▒Ц╛╛═            Ё ┌═╚НБ═ Ё ▒Ю╝╙       Ё └═Б═ ╙╝ЮЮ.Ё▓╗╞      Ё ▓╗╞     Ё ┤╜═Г╔╜╗╔ Ё ┬АБ╝Г╜╗╙  Ё ▐Ю╝╚╝╜ё═Ф  Ё ID ╓╝ё╝╒╝Ю═ ╓╚О      Ё ░╔ё╗АБЮ═Ф╗╝╜╜К╘ ╜╝╛╔Ю Ё ▒Ц╛╛═, Ц╞╚═Г╔╜╜═О  Ё ▒Ц╛╛═ Ц╞╚═Г╔╜╜КЕ Ё ▒Ц╛╛═ Ц╞╚═Г╔╜╜КЕ ╙╝╛╗АА╗╘ Ё ▒Ю╝╙        ╨];  
      [╨ ┼└   Ё    Ё           Ё                                 Ё ╝╞╔Ю═Ф╗╗  Ё ╝╞╔Ю═Ф╗╗         Ё        Ё Ю═╖╛╔И╔╜╗О Ё ╝╞╔Ю═Ф╗╗  Ё╝╞╔Ю═Ф╗╗ Ё АБ═╒╙╗  Ё          Ё ╞╝ё═Х╔╜╗О Ё ╜═ Б╔Е ╕╔  Ё ╞╝ё═Х╔╜╗О ╗╜╝╘ ААЦ╓К Ё АБ╝Ю╝╜╜╔╘ ┼▌          Ё ╞╝ ╝А╜╝╒╜╝╛Ц ╓╝╚ёЦ Ё ╞Ю╝Ф╔╜Б╝╒        Ё ХБЮ═Д╝╒, ╜╔ЦАБ╝╔╙         Ё ╞Ю╗╒╚╔Г╔╜╗О ╨]; 
      [гддддддеддддедддддддддддедддддддддддддддддддддддддддддддддедддддддддддеддддддддддддддддддеддддддддеддддддддддддедддддддддддедддддддддедддддддддеддддддддддедддддддддддеддддддддддддеддддддддддддддддддддддедддддддддддддддддддддддеддддддддддддддддддддеддддддддддддддддддедддддддддддддддддддддддддддеддддддддддддд╤];

    WHILE (RSOper.Next())
      [╨ #####Ё ###Ё ##########Ё ################################Ё ##########Ё #################Ё #######Ё ###########Ё ##########Ё ####### Ё ####### Ё ######## Ё ######### Ё ########## Ё #################### Ё ##################### Ё ################## Ё ################ Ё ######################### Ё ########### ╨]
      (
       RSOper.CREDITNUMBER,
    ┌▌(RSOper.OBJECTID),
       RSOper.OBJECTNUMBER,
▌╞╔Ю═Ф╗О(RSOper.OPERTYPE)+"("+RSOper.OPERTYPE+")",
       RSOper.OPERDATE,
       RSOper.OPERSUM,
┌═╚НБ═(RSOper.CURCODE),
       RSOper.PERIOD,
       RSOper.CORRDATE,
isFIELDVAL(RSOper.OPERATIONTYPE),
       RSOper.TARIFTYPE,
       RSOper.TARIFVALUE,
       RSOper.SOURCEPAYMENT,
       RSOper.PROLONG,
       RSOper.IdDog,
       RSOper.RegNum,
       RSOper.SUMOD, 
       RSOper.SUMPERC,
       RSOper.SUMKOMISS,
       isFIELDVAL(RSOper.PERIODATTRACT)
      );
    END;
      [хммммммоммммомммммммммммомммммммммммммммммммммммммммммммммомммммммммммоммммммммммммммммммоммммммммоммммммммммммомммммммммммомммммммммомммммммммоммммммммммомммммммммммоммммммммммммоммммммммммммммммммммммомммммммммммммммммммммммоммммммммммммммммммммоммммммммммммммммммомммммммммммммммммммммммммммоммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗┬АБ╝Ю╗Н┐Ю═Д╗╙╝╒▐╝ё═Х╔╜╗О()

VAR Factory = NULL,
     RSPlan = NULL,
     PAYPERIOD, PERCPERIOD;

    Factory = RsbObjectFactory();
    RSPlan  = Factory.GetObject("RSLNS_PlanPay", 1);
    RSPlan.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    RSPlan.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

    IF (CreditNumber != 0) RSPlan.SetFilter("CreditNumber = " + CreditNumber); END;

    RSPlan.ApplyFilter();

   PrintLn("");
   Println("▌║Й╔╙Б: ┬АБ╝Ю╗О ёЮ═Д╗╙╝╒ ╞╝ё═Х╔╜╗О (RSLNS_PlanPay)");
      [ждддддддддддбдддддддддддбдддддддддддбдддддддддддбдддддддддддддддбддддддддддддбддддддддддддбддддддддддддддбдддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддддддддбддддддддддддддбдддддддддддддд╥];
      [╨ ▒АК╚╙═ ╜═ Ё ▒АК╚╙═ ╜═ Ё ▒АК╚╙═ ╜═ Ё ▒АК╚╙═ ╜═ Ё └═Б═ ╝╞╔Ю═Ф╗╗ Ё └═Б═       Ё └═Б═       Ё ▒Ц╛╛═        Ё ▒Ц╛╛═         Ё ┌╗╓ ╞Ю╔╓АБ═╒╚╔╜╗О АЦ╛╛К                   Ё   ▐╔Ю╗╝╓     Ё ▓╗╞ ╞╔Ю╗╝╓═  Ё   ▐╔Ю╗╝╓     Ё ▓╗╞ ╞╔Ю╗╝╓═  ╨];
      [╨ ╓╝ё╝╒╝Ю   Ё БЮ═╜Х ID  Ё БЮ═╜Х NUM Ё ╝╞╔Ю═Ф╗Н  Ё Ю═АГ╔Б═ ┐▐    Ё ╞╚═Б╔╕═    Ё ╞Ю╝АЮ╝Г╙╗  Ё ╞╝ё═Х╔╜╗О ▌└ Ё ╞╝ё═Х╔╜╗О %%  Ё                                           Ё ╞╝ё═Х╔╜╗О ▌└ Ё ╞╝ё═Х╔╜╗О ▌└ Ё ╞╝ё═Х╔╜╗О %% Ё ╞╝ё═Х╔╜╗О %% ╨];
      [гдддддддддддедддддддддддедддддддддддедддддддддддедддддддддддддддеддддддддддддеддддддддддддеддддддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддддддддддеддддддддддддддеддддддддддддддеддддддддддддддедддддддддддддд╤];

    WHILE (RSPlan.Next())
      PAYPERIOD = 0; PERCPERIOD = 0;
      IF (ValType(RSPlan.PAYPERIOD)  != V_UNDEF) PAYPERIOD  = int(RSPlan.PAYPERIOD);  END;
      IF (ValType(RSPlan.PERCPERIOD) != V_UNDEF) PERCPERIOD = int(RSPlan.PERCPERIOD); END;

      [╨     ##### Ё       ### Ё ##########Ё ##########Ё    ########## Ё ########## Ё ########## Ё  ########### Ё  ###########  Ё  ######################################## Ё ############ Ё ############ Ё #############Ё ############ ╨]
      (
       RSPlan.CREDITNUMBER,
    ┌▌(RSPlan.OBJECTID),
       RSPlan.OBJECTNUMBER,
       RSPlan.CREDOPERID,
       RSPlan.OPERDATE,
       RSPlan.PLANNEDPAYDATE,
       RSPlan.PLANNEDEXPDATE,
       RSPlan.PLANNEDPAYSUM,
       RSPlan.PLANNEDPERCENTSUM,
       RSPlan.REPRESENTATIONSUM,
       RSPlan.PERIODPAYOD,
       PAYPERIOD,
       RSPlan.PERIODPAYPERC,
       PERCPERIOD
   );
    END;
      [хмммммммммммомммммммммммомммммммммммомммммммммммомммммммммммммммоммммммммммммоммммммммммммоммммммммммммммомммммммммммммммомммммммммммммммммммммммммммммммммммммммммммоммммммммммммммоммммммммммммммоммммммммммммммомммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗└╝╙Ц╛╔╜БК▐╝▒Г╔БЦ()

   VAR RSCOMDocument, Factory  = RsbObjectFactory();

   RSCOMDocument = Factory.GetObject("RSCOMDocument", 1);
   RSCOMDocument.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSCOMDocument.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   IF (CreditNumber != 0) RSCOMDocument.SetFilter("CreditNumber = " + CreditNumber); END;
   RSCOMDocument.ApplyFilter();

   PrintLn("");
   Println("▌║Й╔╙Б: └╝╙Ц╛╔╜БК ╞╝ АГ╔БЦ (RSCOMDocument)");

      [ждддддддддддддддддддддддбддддддбдддддддддддддддддддддбдддддддддддддддддддддбдддддддддддбддддддддбддддддддбдддддддддддддддбддддддддддддддбддддддддддддддддддддддддддддддддбддддддбдддддддбдддддддддд╥];
      [╨ Э └╝ё╝╒╝Ю═            Ё ID   Ё └╔║╔Б               Ё ┼Ю╔╓╗Б              Ё └═Б═      Ё ┌═╚НБ═ Ё ┌═╚НБ═ Ё ▒Ц╛╛═ ╓╔║╔Б═  Ё▒Ц╛╛═ ╙Ю╔╓╗Б═ Ё  ▌А╜╝╒═╜╗╔                     Ё ID   Ё ID    Ё ID       ╨];
      [╨                       Ё ╓╝╙. Ё                     Ё                     Ё           Ё ╓╔║╔Б═ Ё ╙Ю╔╓╗Б═Ё               Ё              Ё                                Ё ╒КёЮ.Ё АГ╔Б═ Ё ╝╞╔Ю═Ф╗╗ ╨];
      [гдддддбдддддддддддддддддеддддддедддддддддддддддддддддедддддддддддддддддддддедддддддддддеддддддддеддддддддедддддддддддддддеддддддддддддддеддддддддддддддддддддддддддддддддеддддддедддддддедддддддддд╤];

   WHILE (RSCOMDocument.Next())
      [╨ ####Ё ################Ё #####Ё ####################Ё ####################Ё ##########Ё #######Ё #######Ё ##############Ё##############Ё ############################## Ё #####Ё ######Ё   ###### ╨]
      (
        RSCOMDocument.CreditNumber,
        RSCOMDocument.UsCreditNumber,
        RSCOMDocument.DOCACCID,
        RSCOMDocument.DEBIT,
        RSCOMDocument.CREDIT,
        RSCOMDocument.CARRYDATE,
 ┌═╚НБ═(RSCOMDocument.CURCODE),
 ┌═╚НБ═(RSCOMDocument.CURCODECREDIT),
        RSCOMDocument.CARRYSUM,
        RSCOMDocument.CARRYSUMCREDIT,
        RSCOMDocument.GROUND,
        RSCOMDocument.OUTDOCID,
        RSCOMDocument.AccID,
   RSCOMDocument.CredOperID
      );
   END;
      [хмммммомммммммммммммммммоммммммомммммммммммммммммммммомммммммммммммммммммммомммммммммммоммммммммоммммммммомммммммммммммммоммммммммммммммоммммммммммммммммммммммммммммммммоммммммомммммммомммммммммм╪];
END;

MACRO ┌К╒╔АБ╗┬АБ╝Ю╗Н░╔ё╗АБЮ╝╒()
VAR RSRegHist, Factory  = RsbObjectFactory();
   RSRegHist = Factory.GetObject("RSVOXRegHist", 1);
   RSRegHist.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSRegHist.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   Println("▌║Й╔╙Б: ┬АБ╝Ю╗О Ю╔ё╗АБЮ╝╒ (RSVOXRegHist)");
   IF (CreditNumber != 0) RSRegHist.SetFilter(getObjectFC("OBJECTID", "OBJECTNUMBER", CreditNumber)); END;

   [ждддддбдддддддддддбдддддддддддддддддддддддддддддддддддддддддбдддддддддддддддбдддддддддддбдддддддд╥];
   [╨  ┌▌ Ё Э ╝║Й╔╙Б═ Ё ┌╗╓ Ю╔ё╗АБЮ═                            Ё ▌АБ═Б╝╙       Ё └═Б═      Ё ┌═╚НБ═ ╨];
   [╨     Ё           Ё                                         Ё               Ё           Ё        ╨];
   [гдддддедддддддддддедддддддддддддддддддддддддддддддддддддддддедддддддддддддддедддддддддддедддддддд╤];

    RSRegHist.ApplyFilter();

    WHILE (RSRegHist.Next())
      IF (RSRegHist.DATEREST <= RecHandler.rec.EndDate)

   [╨ ####Ё ##########Ё ########################################Ё ##############Ё ##########Ё #######╨]
      (
    ┌▌(RSRegHist.OBJECTID),
       RSRegHist.OBJECTNUMBER,
┌╗╓░╔ё╗АБЮ═(RSRegHist.TYPEREG)+" ("+RSRegHist.TYPEREG+")",
       RSRegHist.REGREST,
       RSRegHist.DATEREST,
┌═╚НБ═(RSRegHist.CURCODE));
   END;
   END;
   [хмммммомммммммммммомммммммммммммммммммммммммммммммммммммммммомммммммммммммммомммммммммммомммммммм╪];
END;

MACRO ┌К╒╔АБ╗▒Г╔Б═()
VAR Account, Factory  = RsbObjectFactory();
   Account = Factory.GetObject("RSCOMAccount", 1);
   Account.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   Account.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   Println("▌║Й╔╙Б: ▀╗Ф╔╒К╔ АГ╔Б═ (RSCOMAccount)");
   IF (CreditNumber != 0) Account.SetFilter("CreditNumber = " + CreditNumber); END;
   [ жддддбддддддддддддддбддддддддддддддддддддддбдддддддбдддддддддбдддддддддддддддддбдддддбддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддбдддддддддддддбддддддддддддддддддддддбддддддддддддбдддддддддддддддддддддддддддбдддддддбддддддддддддддддддддддддддддддбддддддбдддддддбдддддддддбдддддддддддд╥];
   [ ╨ Э  Ё              Ё                      Ё       Ё         Ё ┼═Б╔ё╝Ю╗О ЦГ╔Б═ Ё▒╗АБ.Ё █═╗╛╔╜╝╒═╜╗╔                     Ё                         Ё └═Б═        Ё ▌А╜╝╒═╜╗╔            Ё └═Б═       Ё ▌А╜╝╒═╜╗╔                 Ё ■╗╚╗═╚Ё ▌АБ═Б╝╙                      Ё ▓╔Е. Ё       Ё ▌Б╒О╖╙═ Ё     └═Б═   ╨];
   [ ╨ ┼└ Ё █╝╛╔Ю ╝║Й╔╙Б═Ё Э АГ╔Б═              Ё ┐╚═╒═ Ё ┌═╚НБ═  Ё                 ЁБ╗╞  Ё       АГ╔Б═                      Ё ▒Г╔Б ▌└│                Ё ▌Б╙ЮКБ╗О    Ё ▌Б╙ЮКБ╗О             Ё ╖═╙ЮКБ╗О   Ё ┤═╙ЮКБ╗О                  Ё       Ё ╒Е╝╓ОИ╗╘     Ё ╗АЕ╝╓ОИ╗╘     Ё АГ╔Б Ё ID    Ё  АГ╔Б═  Ё   ╝Б╒О╖╙╗  ╨];
   [ гддддедддддбддддддддеддддддддддддддддддддддедддддддедддддддддедддддддддддддддддедддддеддддддддддддддддддддддддддддддддддедддддддддддддддддддддддддедддддддддддддеддддддддддддддддддддддеддддддддддддедддддддддддддддддддддддддддедддддддеддддддддддддддедддддддддддддддеддддддедддддддедддддддддедддддддддддд╤];
   Account.ApplyFilter();
   WHILE (Account.Next())
   [ ╨####Ё#####Ё #######Ё #####################Ё ######Ё ########Ё ################Ё ####Ё #################################Ё ####################### Ё ########### Ё #################### Ё ########## Ё ######################### Ё ######Ё #############Ё ##############Ё #####Ё ######Ё   ###   Ё ########## ╨]
   (
      Account.CreditNumber,
   ┌▌(Account.ObjectID),
      Account.ObjectNumber,
      Account.AccountNumber,
      Account.Chapter,
┌═╚НБ═(Account.CurCode),
      Account.ACCOUNTTYPE,
      Account.SYSTYPE,
      Account.NameAccount,
      Account.ODBAccount,
      Account.OpenDate,
      Account.GroundOpenAcc,
      Account.CloseDate,
      Account.GroundCloseAcc,
      Account.FnCash,
      Account.AccountInRest,
      Account.AccountOutRest,
      Account.IsTechAccount,
      Account.AccID,
      └═█╔Б(Account.ACCUNTIE),
      Account.ACCUNTIEDATE
   );
   END;
   [ сддддадддддаддддддддаддддддддддддддддддддддадддддддадддддддддадддддддддддддддддадддддаддддддддддддддддддддддддддддддддддадддддддддддддддддддддддддадддддддддддддаддддддддддддддддддддддаддддддддддддадддддддддддддддддддддддддддадддддддаддддддддддддддадддддддддддддддаддддддадддддддадддддддддадддддддддддд╫];
END;

MACRO ┌К╒╔АБ╗┬АБ╝Ю╗Н┬╖╛╔╜╔╜╗О┼┼⌠▌()
VAR RiskRVP, Factory  = RsbObjectFactory();
    RiskRVP = Factory.GetObject("RSCOMRiskRVP", 1);
    RiskRVP.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    RiskRVP.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┬АБ╝Ю╗О ┼┼⌠▌ (RSCOMRiskRVP)");
   IF (CreditNumber != 0) RiskRVP.SetFilter("CreditNumber = " + CreditNumber); END;
   RiskRVP.ApplyFilter();
   [ждддддддддбддддддддддбдддддддддддддбддддддддддддддбддддддддддддддддд╥];
   [╨ ┌╗╓     Ё █╝╛╔Ю    Ё └═Б═        Ё    ┼┼⌠▌      Ё ▐Ю╝Ф╔╜Б         ╨];
   [╨ ╝║Й╔╙Б═ Ё ╝║Й╔╙Б═  Ё ╗╖╛╔╜╔╜╗О   Ё              Ё Ю╔╖╔Ю╒╗Ю╝╒═╜╗О  ╨];
   [гдддддддддеддддддддддедддддддддддддеддддддддддддддеддддддддддддддддд╤];
   WHILE (RiskRVP.Next())
   [╨   ##### Ё    ##### Ё ########### Ё ############ Ё ########        ╨]
   (
      ┌▌ (RiskRVP.ObjectTypeID),
      RiskRVP.CreditNumber,
      RiskRVP.DateRVP,
      RiskRVP.RiskGroup,
      RiskRVP.PercReserve
   );
   END;
   [хмммммммммоммммммммммомммммммммммммоммммммммммммммоммммммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗_UnsafeDepository(UnsafeDepository: integer)
var str:string = UnsafeDepository;
if (UnsafeDepository == -1);
    str = "";
END; 
return str;
END;

MACRO ┌К╒╔АБ╗▌║╔А╞╔Г╔╜╗О()
VAR Enscontr, Factory  = RsbObjectFactory();
    Enscontr = Factory.GetObject("RSCOMEnscontr", 1);
    Enscontr.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    Enscontr.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▌║╔А╞╔Г╔╜╗╔ (RSCOMEnscontr)");
   IF (CreditNumber != 0) Enscontr.SetFilter("CreditNumber = " + CreditNumber); END;
   Enscontr.ApplyFilter();
   [ жддддддддддбдддддддддддддддддбддддддддддддбддддддддддддбдддддддддддддбдддддддддддддбдддддбдддддддддддддбдддддбдддддддддддддбдддддбдддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбддддддддддддддддддддддддбдддддддддддбдддддддддддддбддддддддддддддд╥];
   [ ╨ █╝╛╔Ю    Ё ┌╗╓ ╝║╔А╞╔Г╔╜╗О Ё ▒╗АБ╔╛╜К╘  Ё    ▓╗╞     Ё ┼╝╜БЮ═ё╔╜Б  Ё ▒Б╝╗╛╝АБЛ   Ё ┌═╚ Ё ▒Б╝╗╛╝АБЛ   Ё ┌═╚ Ё ▒Б╝╗╛╝АБЛ   Ё ┌═╚ Ё ²╛╗Б╔╜Б Ё ┼╝МДД╗Ф╗╔╜Б Ё √╔╜╜═О      Ё ┼╝╚╗Г╔АБ╒╝  Ё ID АЦ║Й╔╙Б═ Ё ▒Д╝Ю╛. Ю╔╖. Ё  ┌╗╓ ╝║╔А╞╔Г╔╜╗О 1-╘   Ё    ┼╝╓    Ё ┌╗╓ ╝║╔А╞╔Г Ё └═Б═          ╨];
   [ ╨ ╓╝ё╝╒╝Ю═ Ё                 Ё Б╗╞        Ё╝║╔А╞╔Г╔╜╗О Ё             Ё ╓╚О Ю╔╖╔Ю╒═ Ё     Ё ЮК╜╝Г╜═О    Ё     Ё ╝Ф╔╜╝Г╜═О   Ё     Ё         Ё             Ё ║Ц╛═ё═      Ё ╔╓╗╜╗Ф      Ё╜╔╜═╓╔╕ ╓╔╞╝╖Ё  ╞╝ 2732-⌠. Ё ╗ 2-╘ ╙═Б╔ё╝Ю╗╗ ╙═Г-╒═ Ё╓Ю═ё╛╔Б═╚╚═Ё ╒ А╝╝Б╒╔БАБ.Ё ╒╝╖╜╗╙╜╝╒╔╜╗О ╨];
   [ гддддддддддедддддбдддддддддддеддддддддддддеддддддддддддедддддддддддддедддддддддддддедддддедддддддддддддедддддедддддддддддддедддддедддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддеддддддддддддддддддддддддедддддддддддедддддддддддддеддддддддддддддд╤];

   WHILE (Enscontr.Next())
   [ ╨ #########Ё ####Ё ##########Ё ###########Ё ###########Ё ############Ё ############Ё ####Ё ############Ё ####Ё ############Ё ####Ё ########Ё ############Ё ############Ё ############Ё ############Ё ############Ё           #            Ё ######### Ё ########### Ё ##############╨]
   (
       Enscontr.CreditNumber,
    ┌▌(Enscontr.ObjectTypeID),
       Enscontr.EnsContractID,
       Enscontr.EnsSysType,
       Enscontr.TypeEnsID,
       Enscontr.IssuerParty,
       Enscontr.RezSum,
┌═╚НБ═(Enscontr.RezCurCode),
       Enscontr.MarketSum,
┌═╚НБ═(Enscontr.MarketCurCode),
       Enscontr.RatingSum,
┌═╚НБ═(Enscontr.RatingCurCode),
isFIELDVAL(Enscontr.IssuerEns),
       Enscontr.Coefficient,
       Enscontr.Security,
       Enscontr.CountUnit,
┌К╒╔АБ╗_UnsafeDepository(Enscontr.UnsafeDepository),
       Enscontr.CurResSecur,
       Enscontr.TypeEnsure,
GetFiCode(Enscontr.MetalFIID),
       Enscontr.TypeCode,
       Enscontr.OCCURRENCE
   )
   END;
   [ сддддддддддадддддадддддддддддаддддддддддддаддддддддддддадддддддддддддадддддддддддддадддддадддддддддддддадддддадддддддддддддадддддадддддддддадддддддддддддадддддддддддддадддддддддддддадддддддддддддадддддддддддддаддддддддддддддддддддддддадддддддддддадддддддддддддаддддддддддддддд╫];
END;

MACRO ┬АБ╝Ю╗О┬╖╛╔╜╔╜╗О┼┼▒()
VAR CatState, Factory  = RsbObjectFactory();
    CatState = Factory.GetObject("RSCOMRisk", 1);
    CatState.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    CatState.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┬АБ╝Ю╗О ┼┼▒ (RSCOMRisk)");
   IF (CreditNumber != 0) CatState.SetFilter("CreditNumber = " + CreditNumber); END;

   CatState.ApplyFilter();
   [ждддддддддбддддддддддбдддддддддддбдддддддддддддддддбдддддддддддддддд╥];
   [╨ ┌╗╓     Ё █╝╛╔Ю    Ё    ┼┼▒    Ё ▐Ю╝Ф╔╜Б         Ё └═Б═ ╗╖╛╔╜╔╜╗О ╨];
   [╨ ╝║Й╔╙Б═ Ё ╝║Й╔╙Б═  Ё           Ё Ю╔╖╔Ю╒╗Ю╝╒═╜╗О  Ё                ╨];
   [гдддддддддеддддддддддедддддддддддедддддддддддддддддедддддддддддддддд╤];
   
   WHILE (CatState.Next())
   [╨   ##### Ё    ##### Ё ######### Ё ############### Ё ############## ╨]
   (
      ┌▌ (CatState.ObjectTypeID),
      CatState.CreditNumber,
      CatState.Category,
      CatState.PercRez,
      CatState.ChangeDate
   );
   END;
   [хмммммммммоммммммммммомммммммммммомммммммммммммммммомммммммммммммммм╪];
END;

MACRO ┬АБ╝Ю╗О┬╖╛╔╜╔╜╗О▒Б═╒╙╗()
MACRO ▓╗╞▒Б═╒╙╗(t)
   IF (t == 1)
      RETURN "╞Ю╝АБ═О";
   ELIF (t == 2)
      RETURN "╞╚═╒═НИ═О";
   ELIF (t == 3)
      RETURN "А╚╝╕╜═О";

   END;
END;

VAR HistPercRate, RS: integer, Factory  = RsbObjectFactory();
    HistPercRate = Factory.GetObject("RSCOMHistPerc", 1);
    HistPercRate.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    HistPercRate.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

    VAR Str = " (SELECT T_OBJECTTYPEID AS A_OBJECTTYPEID, "
                      "T_OBJECTNUMBER AS A_OBJECTNUMBER "
                " FROM LNSLISTOBJECT_VIEW ";
    IF (CreditNumber != 0) 
      Str = Str + " WHERE T_OBJECTNUMBER = " + CreditNumber + ")";
    ELSE
      Str = Str + ")"; 
    END;

   VAR cmd;
   cmd = RsdCommand(RslDefCon, "{ CALL LoansVOX.FillHistPerc(?, ?, ?) }" );

   cmd.addParam("BeginDate", RSDBP_IN, RecHandler.rec.StartDate);
   cmd.addParam("EndDate" ,  RSDBP_IN, RecHandler.rec.EndDate);
   cmd.addParam("dt",        RSDBP_IN, Str);
   cmd.execute();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┬АБ╝Ю╗О ╗╖╛╔╜╔╜╗О ╞Ю╝Ф╔╜Б╜╝╘ АБ═╒╙╗ (RSCOMHistPerc)");

   [жддддддддддбддддддддддддддддбдддддддддддбдддддддддддбддддддддддддбдддддддддддддддддддддддбддддддддддддддддддддддбддддддддддбдддддддддддддддд╥];
   [╨ ID       Ё └═Б═ ╗╖╛╔╜╔╜╗О Ё ▒Б═╒╙═    Ё ▓╗╞       Ё ┌╗╓ Б═Ю╗Д═ Ё ▒Б═╒╙═ Б═Ю╗Д═ ╜═ ╓═Б═ Ё    ┌╗╓ ╙╝╛╞╝╜╔╜Б═    Ё ▐╔Ю╗╝╓   Ё ▒Б═╒╙═ ╜═ ╓═БЦ ╨];
   [╨ ▓Ю═╜Х═   Ё                Ё Б═Ю╗Д═    Ё АБ═╒╙╗    Ё            Ё ╖═╙╚НГ╔╜╗О ╓╝ё╝╒╝Ю═   Ё    ╓╚О ╞╚═╒.АБ═╒╙╗   Ё Д╗╙А═Ф╗╗ Ё ╒К╓═Г╗         ╨];
   [гддддбдддддеддддддддддддддддедддддддддддедддддддддддеддддддддддддедддддддддддддддддддддддеддддддддддддддддддддддеддддддддддедддддддддддддддд╤];
   WHILE (HistPercRate.Next())
   [╨ ###Ё ####Ё ############## Ё ######### Ё ######### Ё    ####    Ё     #########         Ё #################### Ё  ####### Ё ###############╨]
   (
   ┌▌(HistPercRate.ObjectID),
      HistPercRate.ObjectNumber,
      HistPercRate.RestDate,
      HistPercRate.Rate,
▓╗╞▒Б═╒╙╗(HistPercRate.RateType),
      HistPercRate.TariffKind,
      HistPercRate.RateValRegContr,
      SQL_NVL(HistPercRate.TYPECOMPFLOATRATE, V_STRING),
      ConvZeroToEmptyStr(HistPercRate.PERIODFIX),
      HistPercRate.RateValPayContr
   );
   END;
   [хммммомммммоммммммммммммммммомммммммммммомммммммммммоммммммммммммомммммммммммммммммммммммоммммммммммммммммммммммоммммммммммомммммммммммммммм╪];
END;

MACRO ┬╖╛╔╜╔╜╗╔▒Ц╛╛░╔ё╗АБЮ╝╒▐╝▌╞╔Ю═Ф╗О╛()
VAR ChRegSum, RS: integer, Factory  = RsbObjectFactory(), ChTrnch = Factory.GetObject("RSCOMTranches", 1);
    ChTrnch.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    ChTrnch.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┬АБ╝Ю╗О ╗╖╛╔╜╔╜╗О Ю╔ё╗АБЮ╝╒ ╞╝ ╝╞╔Ю═Ф╗О╛ (RsLns_ChangeRegSum)");
   IF (CreditNumber != 0) ChTrnch.SetFilter("CreditNumber = " + CreditNumber); END;

   ChTrnch.ApplyFilter();

   [ждддддддддддддддддддддддддддддддддддддддддддбддддддддддддддддбдддддддддддддддддддбддддддддддддддбддддддддддддддддддддддддддддддддддддддд╥];
   [╨ ┌╗╓ Ю╔ё╗АБЮ═                              Ё └═Б═ ╝╞╔Ю═Ф╗╗  Ё ▐Ю╗Е╝╓            Ё ░═АЕ╝╓       Ё ▒╗АБ╔╛╜═О ╝╞╔Ю═Ф╗О                    ╨];
   [╨                                           Ё                Ё                   Ё              Ё                                       ╨];
   [гдддддддддддддддддддддддддддддддддддддддддддеддддддддддддддддедддддддддддддддддддеддддддддддддддеддддддддддддддддддддддддддддддддддддддд╤];
   WHILE (ChTrnch.Next())
      ChRegSum = ChTrnch.ChangeRegSum;
      ChRegSum.ApplyFilter();
   WHILE (ChRegSum.Next())
      IF (ValType(ChRegSum.CREDOPERDATE) == V_UNDEF) CONTINUE; END;
      IF (ChRegSum.CREDOPERDATE > RecHandler.rec.EndDate) CONTINUE; END;

   [╨ ########################################  Ё ###############Ё ################# Ё ############ Ё ######################################╨]
   (
┌╗╓░╔ё╗АБЮ═(ChRegSum.REGID),
      ChRegSum.CREDOPERDATE,
      ChRegSum.PRIHOD,
      ChRegSum.RASHOD,
▌╞╔Ю═Ф╗О(ChRegSum.SYSTEMOPERATIONID)
   );
   END;
   END;
   [хмммммммммммммммммммммммммммммммммммммммммммоммммммммммммммммомммммммммммммммммммоммммммммммммммоммммммммммммммммммммммммммммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗└╝ё╝╒╝Ю═()
VAR RSCredit, RS: integer, Factory  = RsbObjectFactory();
    RSCredit = Factory.GetObject("RSCOMCredit", 1);
    RSCredit.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    RSCredit.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: └╝ё╝╒╝Ю═ (RSCOMCredit)");
   IF (CreditNumber != 0) RSCredit.SetFilter("CreditNumber = " + CreditNumber); END;
   RSCredit.ApplyFilter();

   [жддддбдддддддбдддддддбддддддбдддддддддддддддддддддддддддддддддддддбддддддддддддддддддддддддбдддддддддбдддддддддддбдддддддддддддбддддддддддддбдддддддддддбддддддддддддбдддддддддддддддддддддддбдддддддддддддддддддддддбдддддбдддддддбдддддбддддддбдддддддддддддддбдддддддддбддддддддб----------------бддддддддддддддддбдддддддддддбдддддддддддддддбдддддддддддддддбдддддддддддддддддддддддддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддддддддддддддддддбддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддбддддддддддддддддддбддддддддддддддддддддддддбдддддддддддддддддддбддддддддддддддддддддбддддддддддддддддддддбдддддддддддддбдддддддддддддддддддддддбддддддддддддддддддддбддддддддддддддддбддддддддддддддддддбдддддддддддддддддддддддбдддддддддбдддддддддддддбдддддддддддддддбдддддддддбддддддддддддбдддддбддддддддддддбддддддддддддбдддддддддддд╥];
   [╨ ID Ё ■╗╚╗═╚Ё ┌▒▐   Ё ▓╗╞  Ё Э ┼└                                Ё ▓╗╞ ╒К╓═Г╗             Ё ID      Ё └═Б═ Ю╔ё. Ё └═Б═ ╝╙╝╜Г. Ё └═Б═ ╖═╙Ю. Ё ▐Ю╗╖╜═╙   Ё └═Б═       Ё      ▌ёЮ═╜╗Г╔╜╗╔      Ё └═Б═ ЦАБ═╜╝╒╙╗ ╝ёЮдО  Ё √╔╚.Ё ID    Ё ▐Ю╝╚Ё ▀╗╛╗БЁ ▐Ю╗╖╜═╙       Ё   ▓╗╞   Ё  ╙╝╚.  Ё└═Б═ ╞╝А╚╔╓╜╔╘  Ё ▄╗╜. АЦ╛╛═     Ё └═Б═ Ю╔ё. Ё  └═Б═ ╒╝╖╜.   Ё  └═Б═ ╞Ю╔╙Ю.  Ё  ▌┼─▓▌ ╞╝╓Ю═╖╓╔╚╔╜╗О,             Ё ▄═╙А АБ═╒╙═ Ё     ▓╗╞     Ё       ID ╓╝ё╝╒╝Ю═ ╝         Ё       ID ╓╝ё╝╒╝Ю═ ╛╔╕╓Ц          Ё     └═Б═ ╓╝ё╝╒╝Ю═ ╛╔╕╓Ц         Ё  ▒╞╔Ф. ЦА╚╝╒╗О   Ё   ▒Ц╛╛═ Д═╙Б╗Г╔А╙╗Е    Ё  ▒Ц╛╛═ ╓╝ё╝╒╝Ю═   Ё   ▒Ц╛╛═ ╓╝ё╝╒╝Ю═   Ё   ▐╔Ю╒╝╜═Г. ╓═Б═   Ё     ┌╗╓     Ё   ▌Ф╔╜╙═ ААЦ╓К ╜═     Ё ▒Ц╛╛═, Ц╞╚═Г╔╜╜═О  Ё     ▒Ц╛╛═      Ё ▒Ц╛╛═ Ц╞╚═Г╔╜╜КЕ Ё √╔╚╗ ╙Ю╔╓╗Б╝╒═╜╗О √│  Ё ▒Ц║╝Ю╓. Ё ┐═Ю═╜Б╗╘╜К╘ Ё │╔А╞Ю╝Ф╔╜Б╜К╘ Ё ▒Ц║╝Ю╓. Ё ▐Ю╗╖╜═╙ ═╙БЁ ┼▌└ Ё ▌║╔А╞╔Г╔╜╗╔Ё ▌║╔А╞╔Г╔╜╗╔Ё ▌║╔А╞╔Г╔╜╗╔╨];
   [╨    Ё       Ё       Ё      Ё                                     Ё                        Ё ╙╚╗╔╜Б═ Ё ┼└        Ё             Ё            Ё ▌Б╜╔А ┼┼▒ Ё ▌Б╜╔А ┼┼▒  Ё"▌БАЦБАБ. Ю╔═╚. ╓╔ОдБ╗"Ё"▌БАЦБАБ. Ю╔═╚. ╓╔ОдБ" Ё ╙Ю╔╓Ё ▐░▓■▀ Ё     Ё      Ё╞Ю╗Г╗А╚╔╜╗О %% Ё ╖═╔╛И╗╙═ЁЮ╔АБЮЦ╙БЁЮ╔АБЮЦ╙БЦЮ╗╖═Ф╗╗Ё ╓╔╞╝╖╗Б═       Ё ╗╞╝Б╔╙╗   Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё   ╝Б╙ЮК╒Х╔ё╝ ╓╔╞╝╖╗Б              Ё ╞╝ ╓╝ё╝╒╝ЮЦ Ё  ё═Ю═╜Б╗╗   Ё ╞Ю╗╝║Ю╔Б╔╜╗╗ ╞Ю═╒ БЮ╔║╝╒═╜╗ОЁ╞╔Ю╒.╖═╔╛И╗╙╝╗ ╗ ╞╔Ю╒ ╙Ю╔╓╗Б╝Ю╝╛  Ё╞╔Ю╒.╖═╔╛И╗╙╝╗ ╗ ╞╔Ю╒ ╙Ю╔╓╗Б╝Ю╝╛ Ё   ╞╝ ╓╝ё╝╒╝ЮЦ    Ё ╖═БЮ═Б ╜═ ╞Ю╗╝║Ю╔Б╔╜╗╔ Ё ╒ ╒═╚НБ╔ ╓╝ё╝╒╝Ю═ Ё А ЦГ╔Б╝╛ ╗╖╛╔╜╔╜╗╘ Ё ╝╙╝╜Г═╜╗О ╓╝ё╝╒╝Ю═ Ё АБЮ═Е╝╒═╜╗О Ё ╗╜╓╗╒. ╗ ╞╝ЮБД. ╝А╜╝╒╔Ё ╞╝ ╝А╜╝╒╜╝╛Ц ╓╝╚ёЦ Ё  Ц╞╚═Г╔╜╜КЕ %  Ё ╞Ю╝Г╗Е ╞╚═Б╔╕╔╘  Ё                       Ё ╙Ю╔╓╗Б  Ё ╓╔╞╝╖╗Б     Ё ╞╔Ю╗╝╓        Ё ╓╔╞╝╖╗Б Ё ╞╝╒КХ.Ю╗А╙ Ё     Ё ╝А╜╝╒╜╝╔   Ё ╞Ю╝Ф╔╜БК   Ё ЦА╚╝╒╜╝╔   ╨];
   [гддддедддддддедддддддеддддддедддддддддддддддддддддддддддддддддддддеддддддддддддддддддддддддедддддддддедддддддддддедддддддддддддеддддддддддддедддддддддддеддддддддддддедддддддддддддддддддддддедддддддддддддддддддддддедддддедддддддедддддеддддддедддддддддддддддедддддддддедддддддде----------------еддддддддддддддддедддддддддддедддддддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддедддддддддддддедддддддддддддедддддддддддддддддддддддддддддеддддддддддддддддддддддддддддддддддедддддддддддддддддддддддддддддддддеддддддддддддддддддеддддддддддддддддддддддддедддддддддддддддддддеддддддддддддддддддддеддддддддддддддддддддедддддддддддддедддддддддддддддддддддддеддддддддддддддддддддеддддддддддддддддеддддддддддддддддддедддддддддддддддддддддддедддддддддедддддддддддддедддддддддддддддедддддддддеддддддддддддедддддеддддддддддддеддддддддддддедддддддддддд╤];
   WHILE (RSCredit.Next())
   [╨####Ё ######Ё ######Ё #####Ё ####################################Ё #######################Ё ########Ё ##########Ё ##########  Ё ########## Ё ######### Ё ########## Ё ##################### Ё      ##########       Ё ### Ё ##### Ё ### Ё #####Ё #             Ё   ##    Ё########Ё  ##########    Ё  ############# Ё ##########Ё     ##########Ё     ##########Ё###################################Ё#############Ё     ##      Ё          #####              Ё               #####              Ё           ##########            Ё       #####      Ё    #################   Ё ################# Ё  ################# Ё     ##########     Ё     ##      Ё           #           Ё ################## Ё ############## Ё ################ Ё ##################### Ё  #####  Ё   #######   Ё     #####     Ё ####### Ё ########## Ё ### Ё ########## Ё ########## Ё ########## ╨]
   (
       RSCredit.CreditNumber,
       RSCredit.FNCash,
       RSCredit.TerritorialStruct,
    ┌▌(RSCredit.Type),
       RSCredit.Number,
       RSCredit.PayType+"("+▓╗╞┌К╓═Г╗(RSCredit.PayType)+")",
       RSCredit.ClientID_Ref,
       RSCredit.BegDate,
       RSCredit.EndDate,
       RSCredit.CloseDate,
       RSCredit.MarkHighGr,
       RSCredit.DateMarkHighGroup,
       RSCredit.LimNoRealActiv,
       SQL_NVL(RSCredit.DateLimNoRealActiv, V_DATE),
       RSCredit.Specific,
       RSCredit.BriefcaseID,
       RSCredit.CountProl,
       RSCredit.CountLim,
       RSCredit.AddPercent,
       RSCredit.TypeDebtor,
       RSCredit.RebuildCount,
       RSCredit.DateLastRebuild,
       RSCredit.MinDepositSum,
       RSCredit.MortageRegDate,
       RSCredit.GuarDutyBegDate,
       RSCredit.GuarDutyEndDate,
       RSCredit.OkatoTsOpenDep,
       RSCredit.MaxTarifValue,
       RSCredit.GuarantType,
       RSCredit.RightsOfClaimID,
       RSCredit.FirstCreditID,
       RSCredit.FirstCreditDate,
       RSCredit.SpecCondCredit,
       SQL_NVL(RSCredit.SumFactCostAcq, V_STRING),
       RSCredit.CreditSum,
       RSCredit.FirstCreditSum,
       RSCredit.FirstReturnDate,
       RSCredit.TypeOfInsurance,
       RSCredit.AssessmentOfLoans,
       RSCredit.SumPaidOD, 
       RSCredit.SumPaidPerc,
       RSCredit.SumPaidOther, 
       SQL_NVL(RSCredit.Purple, V_STRING),
       └═█╔Б(RSCredit.SubOrd),
       └═█╔Б(RSCredit.GuarDep),
       └═█╔Б(RSCredit.IsNoProcentPeriod),
       └═█╔Б(RSCredit.SubOrdDep),
       RSCredit.RiskFactor,
       RSCredit.Quality,
       RSCredit.SumEnsRVPS,
       RSCredit.SumPercEnsRVPS,
       RSCredit.SumEnsRVP
   );                                                                                                                                                                                                                                                                                                      
   END;
   [хммммомммммммомммммммоммммммомммммммммммммммммммммммммммммммммммммоммммммммммммммммммммммммомммммммммомммммммммммомммммммммммммоммммммммммммомммммммммммоммммммммммммомммммммммммммммммммммммомммммммммммммммммммммммомммммомммммммомммммоммммммомммммммммммммммомммммммммоммммммммоммммммммммммммммоммммммммммммммммомммммммммммомммммммммммммммомммммммммммммммомммммммммммммммммммммммммммммммммммомммммммммммммомммммммммммммомммммммммммммммммммммммммммммоммммммммммммммммммммммммммммммммммомммммммммммммммммммммммммммммммммоммммммммммммммммммоммммммммммммммммммммммммомммммммммммммммммммоммммммммммммммммммммоммммммммммммммммммммомммммммммммммомммммммммммммммммммммммоммммммммммммммммммммоммммммммммммммммоммммммммммммммммммомммммммммммммммммммммммомммммммммомммммммммммммомммммммммммммммомммммммммоммммммммммммомммммоммммммммммммоммммммммммммомммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗▐Ю╝Ф╔╜БК()
VAR LNSPerc, RS: integer, Factory  = RsbObjectFactory();
    LNSPerc = Factory.GetObject("RSLNS_Percent", 1);
    LNSPerc.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    LNSPerc.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   VAR cmd = RsdCommand(RslDefCon, "CALL LoansVOX.FillPercent(?, ?) " );
   cmd.addParam("BeginDate", RSDBP_IN, RecHandler.rec.StartDate);
   cmd.addParam("EndDate" ,  RSDBP_IN, RecHandler.rec.EndDate);   
   cmd.execute(); 

   PrintLn("");
   PrintLn("▌║Й╔╙Б: █═Ю═И╔╜╜К╔ ╞Ю╝Ф╔╜БК (RSLNS_Percent)");
   IF (CreditNumber != 0) LNSPerc.SetFilter("CreditNumber = " + CreditNumber); END;
   LNSPerc.ApplyFilter();

   [ждддддддддбддддддддбдддддддддбддддддддддддддддбдддддддддддбдддддддд╥];
   [╨ ID ┼└   Ё ID     Ё █╝╛╔Ю   Ё      ▒Ц╛╛═     Ё     └═Б═  Ё ┌═╚НБ═ ╨];
   [╨         Ё ╝║Й╔╙Б═Ё ▌║Й╔╙Б═ Ё                Ё           Ё        ╨];
   [гдддддддддеддддддддедддддддддеддддддддддддддддедддддддддддедддддддд╤];

   WHILE (LNSPerc.Next())
   [╨#########Ё########Ё#########Ё################Ё###########Ё ###### ╨]
   (
       LNSPerc.CreditNumber,
       LNSPerc.OBJECTTYPEID,
       LNSPerc.OBJECTNUMBER,
       LNSPerc.PERCENTSUM,
       LNSPerc.PAYDATE,
       ┌═╚НБ═(LNSPerc.CURCODE)
   );
   END;
   [хмммммммммоммммммммомммммммммоммммммммммммммммомммммммммммомммммммм╪];
END;

MACRO ┌К╒╔АБ╗▒Ю╝Г╜К╔▓Ю╔║╝╒═╜╗О()
VAR RSLNS_ExpDemand, RS: integer, Factory = RsbObjectFactory();
    RSLNS_ExpDemand = Factory.GetObject("RSLNS_ExpDemand", 1);
    RSLNS_ExpDemand.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    RSLNS_ExpDemand.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

    VAR cmd = RsdCommand(RslDefCon, "CALL LoansVOX.FillExpDemand(?, ?) " );
    cmd.addParam("BeginDate", RSDBP_IN, RecHandler.rec.StartDate);
    cmd.addParam("EndDate" ,  RSDBP_IN, RecHandler.rec.EndDate);   
    cmd.execute();  

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▒Ю╝Г╜К╔ БЮ╔║╝╒═╜╗О (RSLNS_ExpDemand)");
   IF (CreditNumber != 0) RSLNS_ExpDemand.SetFilter(getObjectFC("OBJECTTYPEID", "OBJECTNUMBER", CreditNumber)); END;
   RSLNS_ExpDemand.ApplyFilter();

   [ждддддбддддддддбдддддддддддбддддддддддддддддбддддддбддддддддбдддддддддддддддбдддддддддддддбддддддддддддддддддддддбддддддддддддддддддддддддддбдддддддддддддддд╥];
   [╨ ┌╗╓ Ё Э      Ё ┼╚╗╔╜Б    Ё └═Б═ ╝╙╝╜Г═╜╗О Ё ▒Ю╝╙ Ё ┌═╚НБ═ Ё ▌АБ═Б╝╙       Ё └═Б═ ╞╔Ю╒╝╘ Ё ▒Г╔Б                 Ё ▒Г╔Б ▌└│                 Ё ▒Ц╛╛═ АЮ╝Г╜╝ё╝ ╨];
   [╨ ╝║Й╔╙Б═      Ё           Ё                Ё      Ё        Ё               Ё ╒К╓═Г╗      Ё                      Ё                          Ё БЮ╔║╝╒═╜╗О     ╨];
   [гдддддеддддддддедддддддддддеддддддддддддддддеддддддеддддддддедддддддддддддддедддддддддддддеддддддддддддддддддддддеддддддддддддддддддддддддддедддддддддддддддд╤];
   WHILE (RSLNS_ExpDemand.Next())
   [╨ ####Ё #######Ё ##########Ё ###############Ё #####Ё #######Ё ##############Ё ############Ё #####################Ё #########################Ё ###############╨]
   (
   ┌▌(RSLNS_ExpDemand.ObjectTypeID),
      RSLNS_ExpDemand.ObjectNumber,
      RSLNS_ExpDemand.CLIENTID,
      RSLNS_ExpDemand.ENDDATE,
      RSLNS_ExpDemand.DURATION,
┌═╚НБ═(RSLNS_ExpDemand.CURCODE),
      RSLNS_ExpDemand.RESTSUM,
      RSLNS_ExpDemand.PAYDATE,
      RSLNS_ExpDemand.ACCOUNT,
      RSLNS_ExpDemand.ODBACCOUNT,
      RSLNS_ExpDemand.SUMDEMAND
   );
   END;
   [хмммммоммммммммомммммммммммоммммммммммммммммоммммммоммммммммомммммммммммммммомммммммммммммоммммммммммммммммммммммоммммммммммммммммммммммммммомммммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗▓Ю═╜Х╗()
VAR Tranches, RS: integer, Factory  = RsbObjectFactory();
    Tranches = Factory.GetObject("RSCOMTranches", 1);
    Tranches.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    Tranches.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▓Ю═╜Х╗ (RSCOMTranches)");
   IF (CreditNumber != 0) Tranches.SetFilter("CreditNumber = " + CreditNumber); END;
   Tranches.ApplyFilter();

   [ждддддддддддддбдддддддбдддддддддддддддддддддддддддддддддддддбдддддддддддддбддддддддддддбддддддддддддбддддддддддддбддддддддддддддддддддддддддддбдддддддддддддддддддддддддддбддддддддддддбддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддбдддддбддддддддддбдддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбдддддддддддддбддддддддддддддддддддбддддддддддддддддбддддддддддддддддддбдддддддддддбдддддддддддддддбдддддддддддддддбдддддддддддддддддбдддддддддддддддддбддддддддддддддбддддддддддддддддддддбдддддддддддбдддддддддддбдддддддддбдддддддбддддддддд╥];
   [╨ ID ╓╝ё╝╒╝Ю═ Ё ID/N  Ё        ▐╝╚Л╖╝╒═Б╔╚ЛА╙╗╘             Ё └═Б═ ╒К╓═Г╗ Ё └═Б═ ╞Ю╝╚. Ё└═Б═ ╝╙╝╜Г. Ё ▒Ю╝╙ БЮ═╜Х═Ё  Э АА. АГ╔Б═               Ё ЭАГ╔Б═ ▌└│                Ё └═Б═ ▌Б╙Ю  Ё └═Б═ ┤═╙Ю  Ё █═╗╛╔╜╝╒═╜╗╔ АГ╔Б═                                    Ё ▒Ц╛╛═       Ё ┌═╚ Ё └═Б═     Ё ■╗╙Б╗╒╜К╘ Ё▒Ц╛.Ю═А. ░┌▐▒Ё ▒Ц╛.АД╝Ю╛.  Ё▒Ц╛.Ю═А. ░┌▐▒Ё ▒Ц╛.АД╝Ю╛.  Ё▒Ц╛.Ю═АГ.░┌▐▒Ё▒Ц╛.Ю═АГ.░┌▐▒Ё▒Ц╛.АД╝Ю.░┌▐ Ё▒Ц╛.АД╝Ю.░┌▐ Ё ▒Ц╛╛═, Ц╞╚═Г╔╜╜═О  Ё     ▒Ц╛╛═      Ё ▒Ц╛╛═ Ц╞╚═Г╔╜╜КЕ Ё ┬АБ╝Г╜╗╙  Ё   └═Б═ ╒╝╖╜.  Ё  └═Б═ ╞Ю╔╙Ю.  Ё  ▒Ц╛.А╝╖╓.░┌▐   Ё ▒Ц╛.Ю═АГ.░┌▐    Ё   └═Б═       Ё ▒Ц╛╛═ ╞╔Ю╒╝╜═Г═╚Л╜╝Ё ▐Ю╗╖╜═╙   Ё └═Б═      Ё ▐Ю╗╖╜═╙ Ё ┼▌└   Ё ┼╝╚д╒╝  ╨];
   [╨             Ё       Ё        ╜╝╛╔Ю ┼└ ╗╚╗ ▒▌              Ё             Ё            Ё            Ё            Ё                            Ё                           Ё            Ё            Ё                                                       Ё             Ё     Ё          Ё           Ё    ╞╝ ▌└    Ё ░┌▐▒ ╞╝ ▌└  Ё    ╞╝ ▐└    Ё ░┌▐▒ ╞╝ ▐└  Ё  ╞╝ АЮ╝Г.%  Ё╞╝ ╞Ю╝АЮ╝Г.% Ё ╞╝ АЮ╝Г. %  Ё╞╝ ╞Ю╝АЮ╝Г.% Ё ╞╝ ╝А╜╝╒╜╝╛Ц ╓╝╚ёЦ Ё  Ц╞╚═Г╔╜╜КЕ %  Ё ╞Ю╝Г╗Е ╞╚═Б╔╕╔╘  Ё ╞╝ё═Х╔╜╗О Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё╞╝ ╒К╓═╜.ё═Ю═╜Б╗╗Ё╞╝ ╒К╓═╜.ё═Ю═╜Б╗╗Ё╞╝А╚╔╓.╞╚═Б╔╕═Ё ╒К╓═Г╗             Ё ╝Б╜╔А ┼┼▒ Ё ╝Б╜╔А ┼┼▒ Ё ═╙Б╗╒═  Ё       Ё Ю╔АБЮЦ╙ ╨]; 
   [гддддддбддддддедддддддедддддддддддддддддддддддддддддддддддддедддддддддддддеддддддддддддеддддддддддддеддддддддддддеддддддддддддддддддддддддддддедддддддддддддддддддддддддддеддддддддддддеддддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддедддддеддддддддддедддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддедддддддддддддеддддддддддддддддддддеддддддддддддддддеддддддддддддддддддедддддддддддедддддддддддддддедддддддддддддддедддддддддддддддддедддддддддддддддддеддддддддддддддеддддддддддддддддддддедддддддддддедддддддддддедддддддддедддддддеддддддддд╤];
   WHILE (Tranches.Next())
   [╨ #####Ё #####Ё ######Ё ################################### Ё ########### Ё ###########Ё ########## Ё ###### ##  Ё ########################## Ё########################## Ё ###########Ё ########## Ё ######################################################Ё ########### Ё#####Ё##########Ё    ###    Ё ########### Ё ########### Ё ########### Ё ########### Ё ########### Ё ########### Ё ########### Ё ########### Ё ################## Ё ############## Ё ################ Ё   ###     Ё  ##########   Ё  ##########   Ё ############### Ё ############### Ё  ##########  Ё ###################Ё ##########Ё ##########Ё ####### Ё ######Ё ########╨]
   (
      Tranches.CreditNumber,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      Tranches.ObjectID,
      Tranches.ObjectNumber,
      Tranches.UserNumber,
      Tranches.BegDate,
      Tranches.PayDate,
      Tranches.EndDate,
      Tranches.Period,
     "╓╜",
      Tranches.Account,
      Tranches.ODBAccount,
      Tranches.DateOpenAccount,
      Tranches.DateCloseAccount,
      Tranches.NameAccount,
      Tranches.SumDem,
      Tranches.CurDem,
      Tranches.DateDem,
      Tranches.Fictive,
      Tranches.CalcRVPSOD,
      Tranches.RVPSOD,
      Tranches.CalcRVPSPD,
      Tranches.RVPSPD,
      Tranches.CalcRVPPerc,
      Tranches.CAlcRVPExpPerc,
      Tranches.RVPPerc,
      Tranches.RVPExpPerc,
      Tranches.SumPaidOD, 
      Tranches.SumPaidPerc,
      Tranches.SumPaidOther,
      Tranches.SourcePayment,
      Tranches.GuarDutyBegDate,
      Tranches.GuarDutyEndDate,
      Tranches.RVPIssGuar,
      Tranches.CalcRVPIssGuar,
      Tranches.LastPayDate,
      Tranches.PaySum,
      Tranches.MarkHighGr,
      Tranches.DateMarkHighGroup,
      Tranches.RiskFactor,
      Tranches.Quality,
      Tranches.RebuildCount
   )
   END;
   [хммммммоммммммомммммммомммммммммммммммммммммммммммммммммммммомммммммммммммоммммммммммммоммммммммммммоммммммммммммоммммммммммммммммммммммммммммомммммммммммммммммммммммммммоммммммммммммоммммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммомммммммммммммомммммоммммммммммомммммммммммомммммммммммммомммммммммммммомммммммммммммомммммммммммммомммммммммммммомммммммммммммомммммммммммммомммммммммммммоммммммммммммммммммммоммммммммммммммммоммммммммммммммммммомммммммммммомммммммммммммммомммммммммммммммомммммммммммммммммомммммммммммммммммоммммммммммммммоммммммммммммммммммммомммммммммммомммммммммммомммммммммомммммммоммммммммм╪];
END;

MACRO ┌К╒╔АБ╗▐╝╚Л╖╝╒═Б╔╚ЛА╙╗╔▐╝╚О()
VAR UsField, RS: integer, Factory  = RsbObjectFactory();
    UsField = Factory.GetObject("RSLNS_LUFIELD", 1);
    UsField.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
    UsField.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▐╝╚Л╖╝╒═Б╔╚ЛА╙╗╔ ╞╝╚О (RSLNS_LUFIELD)");
   UsField.ApplyFilter();

   [ждддддддддддддбдддддддддддддбддддддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╥];
   [╨ Б╗╞ ╝║Й╔╙Б═ Ё█╝╛╔Ю ╝║Й╔╙Б═Ё  ID ╞╝╚О   Ё                  █═╗╛╔╜╝╒═╜╗╔ ╞╝╚О               Ё ┤╜═Г╔╜╗╔ ╞╝╚О                                     ╨];
   [гдддддддддддддедддддддддддддеддддддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╤];
   WHILE (UsField.Next())
   [╨ ##########  Ё ############Ё ###########Ё ################################################ Ё####################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################################╨]
   (
      UsField.OBJECTTYPEID,
      UsField.OBJECTNUMBER,
      UsField.FIELDID,
      UsField.FIELDNAME,
      isFIELDVAL(UsField.FIELDVAL)
   )
   END;
   [хмммммммммммммомммммммммммммоммммммммммммоммммммммммммммммммммммммммммммммммммммммммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪];
END;


MACRO ┌К╒╔АБ╗▐╝ЮБД╔╚╗()
   VAR Type: string = "", RSCOMCase = Factory.GetObject("RSCOMCase", 1);
   RSCOMCase.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSCOMCase.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   RSCOMCase.SetCalcRezFlag(false);
   //!!! RSCOMCase.SetFilter("BriefCaseID = 2"); !!!//
   RSCOMCase.ApplyFilter();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▐╝ЮБД╔╚╗ (RSCOMCase)");
   [жддддбддддддддддддбддддддддддддбддддддддддддддбддддддддбддддддддддддбдддддддбддддддддддбдддддддддддбдддддддддддддбддддддддддддбддддддддддддбдддддддддддддддбдддддддддддддбдддддддддбдддддддддбдддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддбдддддддддддддддбддддддддбддддддддддддддддбддддддддддддддддддбдддддддддддддддддбддддддддддддддддддбдддддддддддддддддд╥];
   [╨ ID Ё ▓╗╞        Ё█═╗╛╔╜╝╒═╜╗╔Ё ▒АК╚╙═ ╜═    Ё ┐ЮЦ╞╞═ Ё ┼╝╚╗Г╔АБ╒╝ Ё ▓╗╞   Ё ▓╗╞      Ё ▓╗╞       Ё   √╔╚Л      Ё ┼╝╜БЮ═ё╔╜Б Ё    └═Б═    Ё ▌А╜╝╒╜╝╘ ╓╝╚ё Ё ▐Ю╝АЮ╝Г╙═   Ё┼═Б╔ё╝Ю╗ОЁ %%      Ё ░╔╖╔Ю╒ АД╝Ю╛╗Ю╝╒═╜╜К╘ ╞╝                      Ё ░═ААГ╗Б═╜К╘ Ю╔╖╔Ю╒ ╞╝                         Ё    ░╔╖╔Ю╒ АД╝Ю╛╗Ю╝╒═╜╜К╘ ╞╝   Ё    ▌АБ═Б╝╙ БЮ╔║╝╒═╜╗╘ ╞╝      Ё▒Д╝Ю╛╗Ю╝╒═╜╜К╘ Ё▌║╔А╞╔Г.Ё √╔╚╔╒╝╔        Ё▐Ю╗╖╜═╙ ╝Б╜╔А╔╜╗О Ё└═Б═ ╝Б╜╔А╔╜╗О   Ё└═Б═ Д╝Ю╛╗Ю╒╝═╜╗О Ё└═Б═ Д╝Ю╛╗Ю╒╝═╜╗О ╨];
   [╨    Ё ╞╝ЮБД╔╚О   Ё╞╝ЮБД╔╚О    Ё Ю╝╓╗Б╔╚ЛА╙╗╘ Ё ▌▓     Ё ААЦ╓       Ё ААЦ╓  Ё ╓╝ё╝╒╝Ю═ Ё ╖═╔╛И╗╙╝╒ Ё   ╙Ю╔╓╗Б═   Ё            ЁД╝Ю╛╗Ю╝╒═╜╗ОЁ               Ё             Ё╙═Г╔АБ╒═ ЁЮ╔╖╔Ю╒═  цдддддддддддддддбдддддддддддддддбдддддддддддддддеддддддддддддддбддддддддддддддддбдддддддддддддддедддддддддддддддбдддддддддддддддедддддддддддддддбддддддддддддддд╢   Ю╔╖╔Ю╒ ╞╝   Ё ААЦ╓ ╒ Ё ╜═╖╜═Г╔╜╗╔     Ё╙ ║╝╚╔╔ ╒КА╝╙╝╘   Ё╙ ║╝╚╔╔ ╒КА╝╙╝╘  ЁЮ╔╖╔Ю╒═ ░┌▐       ЁЮ╔╖╔Ю╒═ ░┌▐ ╞╝    ╨];
   [╨    Ё            Ё            Ё ╞╝ЮБД╔╚Л     Ё        Ё            Ё       Ё          Ё           Ё             Ё            Ё   Ю╔╖╔Ю╒═  Ё               Ё             Ё         Ё         Ё ▌└            Ё █╔╗А╞╝╚.╚╗╛.  Ё ▐Ю╝АЮ╝Г╙╔     Ё ▌└           Ё █╔╗А╞╝╚.╚╗╛╗БЦ Ё ▐Ю╝АЮ╝Г╙╔     Ё   ▐Ю╝Ф╔╜Б═╛   Ё ▐Ю. ▐Ю╝Ф╔╜Б═╛ Ё   ▐Ю╝Ф╔╜Б═╛   Ё ▐Ю. ▐Ю╝Ф╔╜Б═╛ Ё   ╙╝╛╗АА╗О╛   Ё╞╝ЮБД╔╚╔Ё                Ё┼┼▒               Ё┼┼▒              Ё                  Ё╜╔╗А╞╝╚Л╖.╚╗╛БЦ   ╨];
   [гддддеддддддддддддеддддддддддддеддддддддддддддеддддддддеддддддддддддедддддддеддддддддддедддддддддддедддддддддддддеддддддддддддеддддддддддддедддддддддддддддедддддддддддддедддддддддедддддддддедддддддддддддддедддддддддддддддедддддддддддддддеддддддддддддддеддддддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддеддддддддеддддддддддддддддеддддддддддддддддддедддддддддддддддддеддддддддддддддддддедддддддддддддддддд╤];
   WHILE (RSCOMCase.Next())
      Type = "";
      IF   (RSCOMCase.Type == 0) Type = "⌠А╚. ╝║О╖";
      ELIF (RSCOMCase.Type == 1) Type = "▒АЦ╓";
      END;
   [╨####Ё ###########Ё ###########Ё #############Ё #######Ё ###########Ё ######Ё #########Ё ##########Ё ########### Ё ###########Ё ########## Ё ###########   Ё ########### Ё ####### Ё ####### Ё ############# Ё ############# Ё ############# Ё ############ Ё #############  Ё ############# Ё ############# Ё ############# Ё ############# Ё ############# Ё ############# Ё    #   Ё ############## Ё ################ Ё ############### Ё ###############  Ё ###############  ╨]
   (
      RSCOMCase.BriefCaseID,
      Type,
      RSCOMCase.UserNumber,
      RSCOMCase.ReferenceID,      // ▒АК╚╙═ ╜═ ╞╝ЮБД╔╚Л
      RSCOMCase.GroupOT,          // ┐ЮЦ╞╞═ ▌▓
      RSCOMCase.CountLoan,
      RSCOMCase.TypeCredit,       // ▓╗╞ ААЦ╓К
      RSCOMCase.TypeContract,     // T╗╞ ╓╝ё╝╒╝Ю═
      RSCOMCase.TypeDebtor,       // T╗╞ ╖═╔╛И╗╙╝╒
      SQL_NVL(RSCOMCase.AimCredit, V_STRING),
      RSCOMCase.ContractingParty,
      RSCOMCase.DateRezerv,       // └═Б═ Д╝Ю╛╗Ю╝╒═╜╗О Ю╔╖╔Ю╒═
      RSCOMCase.Rest,
      RSCOMCase.ExpRest,
      RSCOMCase.RiskGroup,
      RSCOMCase.PercRez,
      RSCOMCase.RezSum,
      RSCOMCase.RezSum_NLG,
      RSCOMCase.RezExpSum,
      RSCOMCase.CalcRezSum,
      RSCOMCase.CalcRezSum_NLG,
      RSCOMCase.CalcRezExpSum,
      RSCOMCase.SumRezPerc,
      RSCOMCase.SumRezPercExp,
      RSCOMCase.PercDemand,
      RSCOMCase.ExpPercDemand,
      RSCOMCase.SumKomissRVP,
      RSCOMCase.Secured,
      RSCOMCase.Specific,
      RSCOMCase.MarkHighGr,
      RSCOMCase.DateMarkHighGroup,
      RSCOMCase.DateRezRVP,
      RSCOMCase.DateRezRVP_NLG
   );
   END;
   [хммммоммммммммммммоммммммммммммоммммммммммммммоммммммммоммммммммммммомммммммоммммммммммомммммммммммомммммммммммммоммммммммммммоммммммммммммомммммммммммммммомммммммммммммомммммммммомммммммммомммммммммммммммомммммммммммммммомммммммммммммммоммммммммммммммоммммммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммоммммммммоммммммммммммммммоммммммммммммммммммомммммммммммммммммоммммммммммммммммммомммммммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗█╔╜═╓╔╕╜К╘└╔╞╝╖╗Б═Ю╗╘()
   VAR RSLNS_UnSafeDepository = Factory.GetObject("RSLNS_UnSafeDepository", 1);
   RSLNS_UnSafeDepository.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSLNS_UnSafeDepository.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

//   RSLNS_UnSafeDepository.SetFilter("DepoID = 5");
//   RSLNS_UnSafeDepository.ApplyFilter();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: █╔╜═╓╔╕╜К╘└╔╞╝╖╗Б═Ю╗╘ (RSLNS_UnSafeDepository)");
   [жддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддбддддддддддддддддддбддддддддддддбддддддддддддддддбддддддддддддддд╥];
   [╨              █═╗╛╔╜╝╒═╜╗╔              Ё ┬██ ╓╔╞╝╖╗Б═Ю╗О Ё    Э ╚╗Ф╔╜╖╗╗    Ё ┼╝╚╗Г╔АБ╒╝ Ё   ▒Б╝╗╛╝АБЛ    Ё     ▒Ц╛╛═     ╨];
   [╨              ╓╔╞╝╖╗Б═Ю╗О               Ё                 Ё                  Ё     √│     Ё      √│        Ё    Ю╔╖╔Ю╒═    ╨];
   [╨                                        Ё                 Ё                  Ё            Ё                Ё               ╨];
   [гддддддддддддддддддддддддддддддддддддддддедддддддддддддддддеддддддддддддддддддеддддддддддддеддддддддддддддддеддддддддддддддд╤];
   WHILE (RSLNS_UnSafeDepository.Next())
   [╨########################################Ё ################Ё #################Ё ###########Ё ###############Ё ############# ╨]
   (
      RSLNS_UnSafeDepository.Name,
      RSLNS_UnSafeDepository.CodeINN,
      RSLNS_UnSafeDepository.CodeLicense,
      RSLNS_UnSafeDepository.EnsObjNumber,
      RSLNS_UnSafeDepository.SecCost,
      RSLNS_UnSafeDepository.RezSum
   );
   END;
   [хммммммммммммммммммммммммммммммммммммммммомммммммммммммммммоммммммммммммммммммоммммммммммммоммммммммммммммммоммммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗▌╞Б╗╛╗╖╗Ю╝╒═╜╜К╘░╔╖╔Ю╒()
   VAR RSLNS_Rezerve = Factory.GetObject("RSLNS_Rezerve", 1);
   RSLNS_Rezerve.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSLNS_Rezerve.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));
   VAR Str = "(SELECT T_CRD_KIND AS A_TYPE, T_CREDITNUMBER AS A_CREDITNUMBER FROM DCREDIT_C_DBT ";
   IF (CreditNumber != 0) 
      Str = Str + " WHERE T_CREDITNUMBER = " + CreditNumber + ")";
   ELSE
      Str = Str + ")";
   END;

   VAR cmd;

   cmd = RsdCommand(RslDefCon, "{ CALL LoansVOX.fillLoansRezData(?, ?, ?) }" );

   cmd.addParam("BeginDate", RSDBP_IN, RecHandler.rec.StartDate);
   cmd.addParam("EndDate" ,  RSDBP_IN, RecHandler.rec.EndDate);
   cmd.addParam("dt",        RSDBP_IN, Str);

   VAR t1 = Time;
   cmd.execute();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▌╞Б╗╛╗╖╗Ю╝╒═╜╜К╘ Ю╔╖╔Ю╒ (RSLNS_Rezerve)");
   PrintLn("┌Ю╔╛О Ю═║╝БК: ", (Time - t1));

   [ждддддддддбдддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддбддддддддбддддддддддддддбдддддддддддддддддддбдддддддддддддбддддддддбдддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддбдддддддддддддддддддддбдддддддддддддддддддд];
   [╨ ┌╗╓     Ё █╝╛╔Ю     Ё                   ░═ААГ╗Б═╜╜К╘                                    Ё ░┌▐▒         Ё ┌═╚НБ═ Ё     ░┌▐▒     Ё     ┌═╚НБ═        Ё     ░┌▐     Ё ┌═╚НБ═ Ё ░┌▐ ╞╝      Ё                 ▒Ц╛╛═ ╝║╔А╞╔Г╔╜╗О ╓╚О:                              Ё                         ▒Ц╛╛═ А╝╖╓═╜╜╝ё╝                      Ё              ▒Ц╛╛═ Ю═АГ╔Б╜╝ё╝                                 Ё         └═Б═ Д╝Ю╛╗Ю╝╒═╜╗О Ю╔╖╔Ю╒═                              Ё          └═Б═ Д╝Ю╛╗Ю╝╒═╜╗О ░┌▐ ╞╝                            Ё       ▐Ю╝Ф╔╜Б       Ё     ▐Ю╝Ф╔╜Б        ╨];
   [╨ ╝║Й╔╙Б═ Ё ╝║Й╔╙Б═   Ё   ░┌▐▒      Ё ░┌▐▒ ╞╝ ╞Ю╝АЮ╝Г╙╔ Ё     ░┌▐     Ё ░┌▐ ╞╝ ╜╔А╞╝╚.╚╗╛.Ё              Ё  ░┌▐▒  Ё ╞╝ ╞Ю╝АЮ╝Г╙╔ Ё ░┌▐▒ ╞╝ ╞Ю╝АЮ╝Г╙╔ Ё             Ё   ░┌▐  Ё ╜╔╗А╞╝╚.╚╗╛.Ё  ░┌▐▒ ╞╝ ▌└ Ё ░┌▐▒ ╞╝ ╞Ю╝АЮ╝Г.▌└ Ё ░┌▐         Ё ░┌▐ ╞╝ ╜╔╗А╞╝╚.╚╗╛.Ё ░┌▐ ╞╝ АЮ╝Г╜К╛ %% Ё ░┌▐ ╞╝ ╞Ю╝АЮ╝Г╔╜╜К╛ %% Ё ░┌▐ ╞╝ ╙╝╛╗АА╗О╛ Ё ░┌▐ ╞╝ АЮ╝Г╜К╛ %% Ё ░┌▐ ╞╝ ╞Ю╝АЮ╝Г╔╜╜К╛ %% Ё ░┌▐ ╞╝ ╙╝╛╗АА╗О╛ Ё    ░┌▐▒   Ё ░┌▐▒ ╞╝ ╞Ю╝АЮ╝Г╙╔ Ё    ░┌▐    Ё ░┌▐ ╞╝ ╜╔╗А╞╝╚.╚╗╛.Ё  АЮ╝Г╜К╛ ╞Ю╝Ф╔╜Б═╛ Ё ╞Ю╝АЮ╝Г╔╜╜К╛ ╞Ю╝Ф╔╜Б═╛ Ё  ╙╝╛╗АА╗О╛     Ё Ю╔╖╔Ю╒╗Ю╝╒═╜╗О ░┌▐▒ Ё Ю╔╖╔Ю╒╗Ю╝╒═╜╗О ░┌▐ ╨];
   [гдддддддддедддддддддддедддддддддддддедддддддддддддддддддедддддддддддддедддддддддддддддддддеддддддддддддддеддддддддеддддддддддддддедддддддддддддддддддедддддддддддддеддддддддедддддддддддддедддддддддддддеддддддддддддддддддддедддддддддддддеддддддддддддддддддддедддддддддддддддддддеддддддддддддддддддддддддеддддддддддддддддддеддддддддддддддддддддддддддддддддддддддддддддеддддддддддддддддддедддддддддддедддддддддддддддддддедддддддддддеддддддддддддддддддддеддддддддддддддддддддеддддддддддддддддддддддддеддддддддддддддддедддддддддддддддддддддедддддддддддддддддддд╤];
   WHILE (RSLNS_Rezerve.Next())
   [╨ ####### Ё ##########Ё ############Ё ##################Ё ############Ё    ############   Ё #############Ё #######Ё #############Ё ##################Ё ############Ё #######Ё ########### Ё ############Ё ###################Ё ############Ё    ############    Ё ##################Ё #######################Ё #################Ё ##################Ё ###################### Ё #################Ё ##########Ё      ##########   Ё ##########Ё     ##########     Ё     ##########     Ё       ##########       Ё   ##########   Ё     ##########      Ё     ##########     ╨]
   (
      RSLNS_Rezerve.ObjectTypeID,
      RSLNS_Rezerve.ObjectNumber,
      RSLNS_Rezerve.CalcRVPS,
      RSLNS_Rezerve.CalcExpRVPS,
      RSLNS_Rezerve.CalcRVP,
      RSLNS_Rezerve.CalcRVP_NLG,
      RSLNS_Rezerve.RezRVPS,
      ┌═╚НБ═(RSLNS_Rezerve.CurRVPS),
      RSLNS_Rezerve.RezExpRVPS,
      ┌═╚НБ═(RSLNS_Rezerve.CurExpRVPS),
      RSLNS_Rezerve.RezRVP,
      ┌═╚НБ═(RSLNS_Rezerve.CurRVP),
      RSLNS_Rezerve.RVP_NLG,
      RSLNS_Rezerve.Sum_RVPS,
      RSLNS_Rezerve.Sum_ExpRVPS,
      RSLNS_Rezerve.Sum_RVP,
      RSLNS_Rezerve.Sum_RVP_NLG,
      RSLNS_Rezerve.SumPercRVP,
      RSLNS_Rezerve.SumExpPercRVP,
      RSLNS_Rezerve.SumKomissRVP,
      RSLNS_Rezerve.CalcSumPercRVP,
      RSLNS_Rezerve.CalcSumExpPercRVP,
      RSLNS_Rezerve.RVP_CALC_KOMISS,
      RSLNS_Rezerve.RVPS_DATE,
      RSLNS_Rezerve.RVPS_EXP_DATE,
      RSLNS_Rezerve.RVP_REZ_DATE,
      RSLNS_Rezerve.RVP_NLG_DATE,
      RSLNS_Rezerve.RVP_PERC_DATE,
      RSLNS_Rezerve.RVP_EXP_PERC_DATE,
      RSLNS_Rezerve.RVP_KOMISS_DATE,
      SQL_NVL(RSLNS_Rezerve.RVPS_PERC_VAL, V_DOUBLE),
      SQL_NVL(RSLNS_Rezerve.RVP_PERC_VAL, V_DOUBLE)
   );
   END;
   [хмммммммммомммммммммммомммммммммммммомммммммммммммммммммомммммммммммммомммммммммммммммммммоммммммммммммммоммммммммоммммммммммммммомммммммммммммммммммомммммммммммммоммммммммомммммммммммммомммммммммммммоммммммммммммммммммммомммммммммммммоммммммммммммммммммммомммммммммммммммммммоммммммммммммммммммммммммоммммммммммммммммммомммммммммммммммммммоммммммммммммммммммммммммоммммммммммммммммммомммммммммммомммммммммммммммммммомммммммммммоммммммммммммммммммммоммммммммммммммммммммоммммммммммммммммммммммммоммммммммммммммммомммммммммммммммммммммомммммммммммммммммммм╪];

END;

MACRO ┌К╒╔АБ╗└╝ё╝╒╝Ю▐Ю╗╝║▐Ю═╒▓Ю╔║╝╒═╜╗╘()
   VAR RSCOMCession = Factory.GetObject("RSCOMCession", 1);
   RSCOMCession.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSCOMCession.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   IF(CreditNumber != 0) RSCOMCession.SetFilter("ID = " + CreditNumber); END;
   RSCOMCession.ApplyFilter();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: └╝ё╝╒╝Ю ╝ ╞Ю╗╝║Ю╔Б╔╜╗╗ ╞Ю═╒ БЮ╔║╝╒═╜╗О (RSCOMCession)");
   [жддддддддддддддд дбдддддддддддддддддддддддддддбдддддддддддддддбддддддддддддбдддддддддддддддддддбдддддддддддддддддддбддддддддддддддддбддддддддддддд╥];
   [╨ ID ╓╝ё╝╒╝Ю═     Ё                           Ё               Ё            Ё                   Ё ░╔ё╗АБЮ═Ф╗╝╜╜К╘   Ё    ▌┼▒▄        Ё    ▌┐░█┬▐   ╨];
   [╨ ╝ ╞Ю╗╝║Ю╔Б╔╜╗╗  Ё      █╝╛╔Ю ╓╝ё╝╒╝Ю═       Ё └═Б═ ╓╝ё╝╒╝Ю═ Ё ┼╝╜БЮ═ё╔╜Б Ё ▌┐░█ ╙╝╜БЮ═ё╔╜Б═  Ё ╜╝╛╔Ю ╙╝╜БЮ═ё╔╜Б═ Ё ╙╝╜БЮ═ё╔╜Б═    Ё             ╨];
   [╨ ╞Ю═╒ БЮ╔║╝╒═╜╗О Ё                           Ё               Ё            Ё                   Ё                   Ё                Ё             ╨];
   [гдддддддддддддддддедддддддддддддддддддддддддддедддддддддддддддеддддддддддддедддддддддддддддддддедддддддддддддддддддеддддддддддддддддеддддддддддддд╨];
   WHILE (RSCOMCession.Next())
   [╨    ######       Ё ##########################Ё  ##########   Ё  ######    Ё ################# Ё ################# Ё ############## Ё#############╨]
   (
      RSCOMCession.ID,
      RSCOMCession.UserNumber,
      RSCOMCession.RegDate,
      RSCOMCession.Client,
      RSCOMCession.OGRN,
      RSCOMCession.RegNum,
      RSCOMCession.OKCM,
      RSCOMCession.OGRMIP
   );
   END;
   [хмммммммммммммммммомммммммммммммммммммммммммммомммммммммммммммоммммммммммммомммммммммммммммммммомммммммммммммммммммоммммммммммммммммоммммммммммммм╪];
END;

MACRO ┌К╒╔АБ╗▒Ц╓╔║╜К╔┬А╙╗()
   VAR RSCOMLawsuits = Factory.GetObject("RSCOMLawsuits", 1);
   RSCOMLawsuits.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSCOMLawsuits.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

  // RSCOMLawsuits.SetFilter("ID = 5");
  // RSCOMLawsuits.ApplyFilter();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┬╜Д╝Ю╛═Ф╗О ╝ АЦ╓╔║╜КЕ ╗А╙═Е (RSCOMLawsuits)");
   [ждддддддддддддбддддддддддддддддддддддддддддддбддддддддддддбддддддддддддддддддддддбддддддддддддбдддддддддддддддддддбддддддддбдддддддддддддбддддддддд╥];
   [╨ ID ╓╝ё╝╒╝Ю═ Ё └═Б═ ╞Ю╗╜ОБ╗О ╗А╙. ╖═О╒╚╔╜╗О Ё └═Б═ ╒╒╝╓═ Ё   ▒Ц╛╛═ ╗А╙═ А╝      Ё ┼╝╓ ╒═╚НБК Ё  ▒Ц╛╛═            Ё ┌═╚НБ═ Ё └═Б═        Ё ▐Ю╗╖╜═╙ ╨];
   [╨             Ё ╙ ╞Ю╝╗╖-╒Ц ═Ю║╗Б. АЦ╓═       Ё            Ё АБ╝Ю╝╜К ╙Ю╔╓ ╝Юё═╜-╗ Ё АЦ╛╛К ╗А╙═ Ё ╒╖КА╙═╜╗О         Ё        Ё ╞╝╓═Г╗ ╗А╙═ Ё АЦ╓═    ╨];  
   [гдддддддддддддеддддддддддддддддддддддддддддддеддддддддддддеддддддддддддддддддддддеддддддддддддедддддддддддддддддддеддддддддедддддддддддддеддддддддд╤];
   WHILE (RSCOMLawsuits.Next())
   [╨    ######   Ё         ##########           Ё ########## Ё  #################   Ё    ###     Ё ################# Ё   ###  Ё  ########## Ё   ###   ╨]
   (
      RSCOMLawsuits.ID,
      SQL_NVL(RSCOMLawsuits.DATECLAIM, V_DATE),
      RSCOMLawsuits.BEGDATE,
      SQL_NVL(RSCOMLawsuits.AMOUNTOFCLAIM, V_STRING),
      SQL_NVL(RSCOMLawsuits.AMOUNTCURCODE, V_STRING),
      RSCOMLawsuits.SUM,
      RSCOMLawsuits.CURCODE,
      SQL_NVL(RSCOMLawsuits.DATEFILINGSUIT, V_DATE),
      SQL_NVL(RSCOMLawsuits.LAWCOURT, V_STRING)
   );
   END;
   [хмммммммммммммоммммммммммммммммммммммммммммммоммммммммммммоммммммммммммммммммммммоммммммммммммомммммммммммммммммммоммммммммомммммммммммммоммммммммм╪];
END;

MACRO ▐╝╚╜═О▒Б╝╗╛╝АБЛ┌╙╚═╓═┬▐()
   VAR RSCOMCostDepEmp = Factory.GetObject("RSCOMCostDepEmp", 1);
   RSCOMCostDepEmp.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSCOMCostDepEmp.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));
   
   FillCostDepEmp(RecHandler.rec.StartDate, RecHandler.rec.EndDate, CreditNumber);

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▐╝╚╜═О АБ╝╗╛╝АБЛ ╒╙╚═╓═ ┬▐");
   [ждддддддддддддбдддддддддддддддддддддддддддддддбдддддддддддддддддддддддддбдддддддддддддддддддддддддбддддддддддддддддддддд╥];
   [╨ ID ╓╝ё╝╒╝Ю═ Ё ┐Ю═Д╗╙ ╒К╞╚═БК/╞Ю╗Г╗А╚╔╜╗О %% Ё ▐╝╚╜═О АБ╝╗╛╝АБЛ ╒╙╚═╓═ Ё   ▒Ю╝╙ ╞Ю╗╒╚╔Г╔╜╗О, ╓╜. Ё └═Б═ Ю═АГ╔Б═ ▐▒┌ ┬▐ ╨];
   [╨             Ё                               Ё                         Ё                         Ё                     ╨];  
   [гдддддддддддддедддддддддддддддддддддддддддддддедддддддддддддддддддддддддедддддддддддддддддддддддддеддддддддддддддддддддд╤];
   WHILE (RSCOMCostDepEmp.Next())
   [╨  ########   Ё            ###                Ё  #####################  Ё         ######          Ё     ##########      ╨]
   (
      RSCOMCostDepEmp.ID,
      RSCOMCostDepEmp.GRAPHPAY,
      RSCOMCostDepEmp.PSV,
      RSCOMCostDepEmp.DURATIONATTR,
      RSCOMCostDepEmp.DATECALCPSV
   );
   END;
   [хмммммммммммммомммммммммммммммммммммммммммммммомммммммммммммммммммммммммомммммммммммммммммммммммммоммммммммммммммммммммм╪];
END;

MACRO ┐Ю═Д╗╙▐╝ё═Х╔╜╗О┼╝╛╗АА╗╘()
   VAR RsLnsGraphCommission, RS: integer;
   VAR Factory  = RsbObjectFactory();
   VAR ChTrnch = Factory.GetObject("RSCOMTranches", 1);  

   ChTrnch.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   ChTrnch.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ┐Ю═Д╗╙ ╞╝ё═Х╔╜╗О ╙╝╛╗АА╗╘ RsLns_GraphCommission");
   IF (CreditNumber != 0) ChTrnch.SetFilter("CreditNumber = " + CreditNumber); END;

   ChTrnch.ApplyFilter();

   [ждддддддддддддддддддддддддддддбдддддддддддддддддддддддддддддддддддддддбддддддддддддддддбдддддддддддддддддбдддддддддддддддд╥];
   [╨       ID БЮ═╜Х═             Ё    █═╗╛╔╜╝╒═╜╗╔ ╙╝╛╗АА╗╗              Ё ▒Ц╛╛═ ╙╝╛╗АА╗╗ Ё ┌═╚НБ═ ╙╝╛╗АА╗╗ Ё └═Б═ ╞╝ё═Х╔╜╗О ╨];
   [╨ ▓╗╞ ╝║Й╔╙Б═ Ё ╜╝╛╔Ю ╝║Й╔╙Б═ Ё                                       Ё                Ё                 Ё ╙╝╛╗А╗╗        ╨];  
   [гдддддддддддддедддддддддддддддедддддддддддддддддддддддддддддддддддддддеддддддддддддддддедддддддддддддддддедддддддддддддддд╤];
 
   WHILE (ChTrnch.Next())
      RsLnsGraphCommission = ChTrnch.GraphCommission;
      RsLnsGraphCommission.ApplyFilter();
      WHILE (RsLnsGraphCommission.Next())
   [╨    ##       Ё   #########   Ё ##################################### Ё  ############# Ё   ##########    Ё  ###########   ╨]
   (
      RsLnsGraphCommission.OBJECTTYPEID,
      RsLnsGraphCommission.OBJECTNUMBER,
      RsLnsGraphCommission.NAMECOMMISSION,
      RsLnsGraphCommission.SUMCOMMISSION,
      ┌═╚НБ═(RsLnsGraphCommission.CURCODE),
      RsLnsGraphCommission.DATEPAYMENT
   );
      END;
  END;   
  [хмммммммммммммомммммммммммммммомммммммммммммммммммммммммммммммммммммммоммммммммммммммммомммммммммммммммммомммммммммммммммм╪]; 
END;

MACRO ▌║Ю╔╛╔╜╔╜╗╔▐╝└╝ё╝╒╝ЮЦ()  
   VAR RSLns_Encum = Factory.GetObject("RSLns_Encum", 1);
   RSLns_Encum.SetParmValue("BeginDate", string(RecHandler.rec.StartDate:f));
   RSLns_Encum.SetParmValue("EndDate",   string(RecHandler.rec.EndDate:f));

   IF (CreditNumber != 0) 
       RSLns_Encum.SetFilter("CreditNumber = " + CreditNumber);
   END;
   RSLns_Encum.ApplyFilter();

   PrintLn("");
   PrintLn("▌║Й╔╙Б: ▌║Ю╔╛╔╜╔╜╗╔ ╞╝ ╓╝ё╝╒╝ЮЦ (RSLns_Encum)");
   [ждддддддддддддбдддддддддддддбдддддддддддддд-бддддддддддддбдддддддддддддддбдддддддддддддддбдддддддддддддддбдддддддддддддддд╥];
   [╨ ID ╓╝ё╝╒╝Ю═ Ё ┌╗╓ ╝║Й╔╙Б═ Ё █╝╛╔Ю ╝║Й╔╙Б═ Ё ID ┼╚╗╔╜Б═ Ё ┌╗╓           Ё ┌═╚НБ═        Ё ▒Б╝╗╛╝АБЛ     Ё └═Б═ ╞╝ё═Х╔╜╗О ╨];
   [╨             Ё             Ё               Ё            Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё ╝║О╖═Б╔╚ЛАБ╒═ Ё ╝║О╖═Б╔╚ЛАБ╒═  ╨];  
   [гдддддддддддддедддддддддддддедддддддддддддд-еддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддедддддддддддддддд╤];
   WHILE (RSLns_Encum.Next())
   [╨    ######   Ё    #####    Ё ############  Ё  ######### Ё       ###     Ё      ###      Ё ############# Ё  ##########    ╨]
   (
      RSLns_Encum.CREDITNUMBER,
      ┌▌(RSLns_Encum.OBJECTTYPEID),
      RSLns_Encum.OBJECTNUMBER,
      RSLns_Encum.CLIENTID,
      RSLns_Encum.KINDOBLIG,
      RSLns_Encum.CURCODE_OBLIG,
      RSLns_Encum.COSTOBLIG,
      RSLns_Encum.DATEDUTYOBLIG
   );
   END;
   [хмммммммммммммомммммммммммммомммммммммммммммоммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммомммммммммммммммм╪];
END;

CONST RSCOMCredit        = 3,
      RSCOMAccount       = 4,
      RSCOMTranches      = 5,
      RSCOMDocument      = 6,
      RSVOXRegHist       = 7,
      RSVOXOperation     = 8,
      RSCOMHistPerc      = 9,
      RSCOMRiskRVP       = 10, 
      RsLns_ChangeRegSum = 11,   
      RSCOMRisk          = 12,
      RSLNS_ExpDemand    = 13,      
      RSCOMEnscontr      = 14,
      Percent            = 15,      
      RSCOMCase          = 16,
      RSLNS_UnSafeDepository = 17,
      RSLNS_PlanPay      = 18,
      RSLNS_LUFIELD      = 19,
      RSLNS_Rezerve      = 20,       
      RSCOMCession       = 21,
      RSCOMLawsuits      = 22,
      RSCOMCostDepEmp    = 23,
      RsLns_GraphCommission = 24,
      RSLns_Encum        = 25;

MACRO checkBox(value)
   IF (value == "X")
      SetParm(0, "");
   ELSE
      SetParm(0, "X");
   END;
END;

MACRO ValStr(Val)
   IF (Val == "X")
      RETURN Val;
   END;
   RETURN "0";
END;

MACRO ▒╝ЕЮ═╜╗БЛ▐═Ю═╛╔БЮК()
   FILE ini_file_write() txt write;
   Open(ini_file_write, fname);
   Insert(ini_file_write, "CreditNumber\t"  + RecHandler.rec.CreditNumber);
   Insert(ini_file_write, "StartDate\t"     + RecHandler.rec.StartDate);
   Insert(ini_file_write, "EndDate\t"       + RecHandler.rec.EndDate);
   Insert(ini_file_write, "RSCOMCredit\t"   + ValStr(RecHandler.rec.RSCOMCredit));
   Insert(ini_file_write, "RSCOMAccount\t"  + ValStr(RecHandler.rec.RSCOMAccount));
   Insert(ini_file_write, "RSCOMTranches\t" + ValStr(RecHandler.rec.RSCOMTranches));
   Insert(ini_file_write, "RSCOMDocument\t" + ValStr(RecHandler.rec.RSCOMDocument));
   Insert(ini_file_write, "RSVOXRegHist\t"  + ValStr(RecHandler.rec.RSVOXRegHist));
   Insert(ini_file_write, "RSVOXOperation\t"+ ValStr(RecHandler.rec.RSVOXOperation));
   Insert(ini_file_write, "RSCOMRiskRVP\t"  + ValStr(RecHandler.rec.RSCOMRiskRVP));
   Insert(ini_file_write, "RSCOMHistPerc\t" + ValStr(RecHandler.rec.RSCOMHistPerc));
   Insert(ini_file_write, "RSCOMRisk\t"     + ValStr(RecHandler.rec.RSCOMRisk));
   Insert(ini_file_write, "RsLns_ChangeRegSum\t" + ValStr(RecHandler.rec.RsLns_ChangeRegSum));
   Insert(ini_file_write, "RSCOMEnscontr\t"  + ValStr(RecHandler.rec.RSCOMEnscontr));
   Insert(ini_file_write, "RSCOMCase\t"      + ValStr(RecHandler.rec.RSCOMCase));
   Insert(ini_file_write, "RSLNS_ExpDemand\t"+ ValStr(RecHandler.rec.RSLNS_ExpDemand));
   Insert(ini_file_write, "Percent\t"       + ValStr(RecHandler.rec.Percent));
   Insert(ini_file_write, "RSLNS_PlanPay\t" + ValStr(RecHandler.rec.RSLNS_PlanPay));
   Insert(ini_file_write, "RSLNS_UnSafeDepository\t" + ValStr(RecHandler.rec.RSLNS_UnSafeDepository));
   Insert(ini_file_write, "RSLNS_Rezerve\t" + ValStr(RecHandler.rec.RSLNS_Rezerve));
   Insert(ini_file_write, "RSLNS_LUFIELD\t" + ValStr(RecHandler.rec.RSLNS_LUFIELD));
   Insert(ini_file_write, "RSCOMCession\t" + ValStr(RecHandler.rec.RSCOMCession));  
   Insert(ini_file_write, "RSCOMLawsuits\t" + ValStr(RecHandler.rec.RSCOMLawsuits));
   Insert(ini_file_write, "RSCOMCostDepEmp\t" + ValStr(RecHandler.rec.RSCOMCostDepEmp));
   Insert(ini_file_write, "RsLns_GraphCommission\t" + ValStr(RecHandler.rec.RsLns_GraphCommission));
   Insert(ini_file_write, "RSLns_Encum\t" + ValStr(RecHandler.rec.RSLns_Encum));

   Close (ini_file_write);
END;

MACRO EventHandler(dlg, cmd, id, key)
   IF (key == 32)
      IF (id == RSCOMCredit       ) checkBox(RecHandler.rec.RSCOMCredit);        END;
      IF (id == RSCOMAccount      ) checkBox(RecHandler.rec.RSCOMAccount);       END;
      IF (id == RSCOMTranches     ) checkBox(RecHandler.rec.RSCOMTranches);      END;
      IF (id == RSCOMDocument     ) checkBox(RecHandler.rec.RSCOMDocument);      END;
      IF (id == RSVOXRegHist      ) checkBox(RecHandler.rec.RSVOXRegHist);       END;
      IF (id == RSVOXOperation    ) checkBox(RecHandler.rec.RSVOXOperation);     END;
      IF (id == RSCOMRiskRVP      ) checkBox(RecHandler.rec.RSCOMRiskRVP);       END;
      IF (id == RSCOMHistPerc     ) checkBox(RecHandler.rec.RSCOMHistPerc);      END;
      IF (id == RSCOMRisk         ) checkBox(RecHandler.rec.RSCOMRisk);          END;
      IF (id == RsLns_ChangeRegSum) checkBox(RecHandler.rec.RsLns_ChangeRegSum); END;
      IF (id == RSCOMEnscontr     ) checkBox(RecHandler.rec.RSCOMEnscontr);      END;
      IF (id == RSCOMCase         ) checkBox(RecHandler.rec.RSCOMCase);          END;
      IF (id == RSLNS_ExpDemand   ) checkBox(RecHandler.rec.RSLNS_ExpDemand);    END;
      IF (id == Percent           ) checkBox(RecHandler.rec.Percent);            END;
      IF (id == RSLNS_PlanPay     ) checkBox(RecHandler.rec.RSLNS_PlanPay);      END;
      IF (id == RSLNS_UnSafeDepository ) checkBox(RecHandler.rec.RSLNS_UnSafeDepository); END;
      IF (id == RSLNS_Rezerve     ) checkBox(RecHandler.rec.RSLNS_Rezerve);      END;
      IF (id == RSLNS_LUFIELD     ) checkBox(RecHandler.rec.RSLNS_LUFIELD);      END;
      IF (id == RSCOMCession      )  checkBox(RecHandler.rec.RSCOMCession);      END; 
      IF (id == RSCOMLawsuits     )  checkBox(RecHandler.rec.RSCOMLawsuits);     END;       
      IF (id == RSCOMCostDepEmp   ) checkBox(RecHandler.rec.RSCOMCostDepEmp);    END;      
      IF (id == RsLns_GraphCommission) checkBox(RecHandler.rec.RsLns_GraphCommission); END;      
      IF (id == RSLns_Encum       ) checkBox(RecHandler.rec.RSLns_Encum);        END;       
   END;

   IF (key == 323) // F9
      ▒╝ЕЮ═╜╗БЛ▐═Ю═╛╔БЮК();

      println("▌БГ╔Б ╜═ ╓═БК: " + RecHandler.rec.StartDate +","+ RecHandler.rec.EndDate);
      CreditNumber = RecHandler.rec.CreditNumber;

      BegAction(2000, "┬╓╔Б ╝║Ю═║╝Б╙═...", TRUE);
      InitProgress(18, "▒Б═╓╗О ╝║Ю═║╝Б╙╗...", "▐╝АБЮ╝╔╜╗╔ ╝БГ╔Б═");

      IF (RecHandler.rec.RSCOMCredit        == "X") ┌К╒╔АБ╗└╝ё╝╒╝Ю═();                   END; UseProgress (1);
      IF (RecHandler.rec.Percent            == "X") ┌К╒╔АБ╗▐Ю╝Ф╔╜БК();                   END; UseProgress (2);
      IF (RecHandler.rec.RSCOMTranches      == "X") ┌К╒╔АБ╗▓Ю═╜Х╗();                     END; UseProgress (3);     
      IF (RecHandler.rec.RSVOXRegHist       == "X") ┌К╒╔АБ╗┬АБ╝Ю╗Н░╔ё╗АБЮ╝╒();           END; UseProgress (4);      
      IF (RecHandler.rec.RSVOXOperation     == "X") ┌К╒╔АБ╗┬АБ╝Ю╗Н▌╞╔Ю═Ф╗╘();            END; UseProgress (5);
      IF (RecHandler.rec.RSCOMHistPerc      == "X") ┬АБ╝Ю╗О┬╖╛╔╜╔╜╗О▒Б═╒╙╗();            END; UseProgress (6);
      IF (RecHandler.rec.RSCOMRiskRVP       == "X") ┌К╒╔АБ╗┬АБ╝Ю╗Н┬╖╛╔╜╔╜╗О┼┼⌠▌();       END; UseProgress (7);
      IF (RecHandler.rec.RSCOMRisk          == "X") ┬АБ╝Ю╗О┬╖╛╔╜╔╜╗О┼┼▒();               END; UseProgress (8);
      IF (RecHandler.rec.RsLns_ChangeRegSum == "X") ┬╖╛╔╜╔╜╗╔▒Ц╛╛░╔ё╗АБЮ╝╒▐╝▌╞╔Ю═Ф╗О╛(); END; UseProgress (9);
      IF (RecHandler.rec.RSCOMEnscontr      == "X") ┌К╒╔АБ╗▌║╔А╞╔Г╔╜╗О();                END; UseProgress (10);
      IF (RecHandler.rec.RSCOMAccount       == "X") ┌К╒╔АБ╗▒Г╔Б═();                      END; UseProgress (11);
      IF (RecHandler.rec.RSCOMDocument      == "X") ┌К╒╔АБ╗└╝╙Ц╛╔╜БК▐╝▒Г╔БЦ();           END; UseProgress (12);
      IF (RecHandler.rec.RSCOMCase          == "X") ┌К╒╔АБ╗▐╝ЮБД╔╚╗();                   END; UseProgress (13);
      IF (RecHandler.rec.RSLNS_ExpDemand    == "X") ┌К╒╔АБ╗▒Ю╝Г╜К╔▓Ю╔║╝╒═╜╗О();          END; UseProgress (14);
      IF (RecHandler.rec.RSLNS_PlanPay      == "X") ┌К╒╔АБ╗┬АБ╝Ю╗Н┐Ю═Д╗╙╝╒▐╝ё═Х╔╜╗О();   END; UseProgress (15);
      IF (RecHandler.rec.RSLNS_UnSafeDepository == "X") ┌К╒╔АБ╗█╔╜═╓╔╕╜К╘└╔╞╝╖╗Б═Ю╗╘();  END; UseProgress (16);
      IF (RecHandler.rec.RSLNS_Rezerve      == "X") ┌К╒╔АБ╗▌╞Б╗╛╗╖╗Ю╝╒═╜╜К╘░╔╖╔Ю╒();     END; UseProgress (17);
      IF (RecHandler.rec.RSLNS_LUFIELD      == "X") ┌К╒╔АБ╗▐╝╚Л╖╝╒═Б╔╚ЛА╙╗╔▐╝╚О();       END; UseProgress (18);
      IF (RecHandler.rec.RSCOMCession       == "X") ┌К╒╔АБ╗└╝ё╝╒╝Ю▐Ю╗╝║▐Ю═╒▓Ю╔║╝╒═╜╗╘(); END; UseProgress (19);
      IF (RecHandler.rec.RSCOMLawsuits      == "X") ┌К╒╔АБ╗▒Ц╓╔║╜К╔┬А╙╗();               END; UseProgress (20);
      IF (RecHandler.rec.RSCOMCostDepEmp    == "X") ▐╝╚╜═О▒Б╝╗╛╝АБЛ┌╙╚═╓═┬▐();           END; UseProgress (21);
      IF (RecHandler.rec.RsLns_GraphCommission  == "X") ┐Ю═Д╗╙▐╝ё═Х╔╜╗О┼╝╛╗АА╗╘();       END; UseProgress (22);
      IF (RecHandler.rec.RSLns_Encum        == "X") ▌║Ю╔╛╔╜╔╜╗╔▐╝└╝ё╝╒╝ЮЦ();             END; UseProgress (23);

      RemProgress (23);
      EndAction();

      RETURN CM_CANCEL;
   END;

   RETURN cmd;
END;

MACRO ▐Ю╝Г╗Б═БЛ█═АБЮ╝╘╙╗();
   VAR cnt = 0;
   FILE ini_file_read () txt;

   MACRO X(V: string)
      IF (V == "X")
         RETURN "X";
      ELSE
         RETURN "";
      END;
   END;

   MACRO SetDefaultValue()
      RecHandler.rec.CreditNumber = CreditNumber;
      RecHandler.rec.StartDate    = date(01,01,1990);
      RecHandler.rec.EndDate      = {curdate};

      RecHandler.rec.RSCOMCredit   = "X";
      RecHandler.rec.RSCOMAccount  = "X";
      RecHandler.rec.RSCOMTranches = "X";
      RecHandler.rec.RSCOMDocument = "X";
      RecHandler.rec.RSVOXRegHist  = "X";
      RecHandler.rec.RSVOXOperation= "X";
      RecHandler.rec.RSCOMRiskRVP  = "X";
      RecHandler.rec.RSCOMHistPerc = "X";
      RecHandler.rec.RSCOMRisk     = "X";
      RecHandler.rec.RsLns_ChangeRegSum = "X";
      RecHandler.rec.RSCOMEnscontr = "X";
      RecHandler.rec.RSCOMCase     = "X";
      RecHandler.rec.RSLNS_ExpDemand="X";
      RecHandler.rec.Percent       = "X";
      RecHandler.rec.RSLNS_PlanPay = "X";
      RecHandler.rec.RSLNS_UnSafeDepository = "X";
      RecHandler.rec.RSLNS_Rezerve = "X";
      RecHandler.rec.RSLNS_LUFIELD = "X";
      RecHandler.rec.RSCOMCession = "X";
      RecHandler.rec.RSCOMLawsuits = "X";
      RecHandler.rec.RSCOMCostDepEmp = "X";  
      RecHandler.rec.RsLns_GraphCommission = "X"; 
      RecHandler.rec.RSLns_Encum = "X";      
   END;

   IF (NOT ExistFile(fname, 0))
      SetDefaultValue();
   ELSE
      Open(ini_file_read,  fname);

      WHILE (Next(ini_file_read))
         IF (ini_file_read[0] == "CreditNumber")   RecHandler.rec.CreditNumber   = ini_file_read[1]; END;
         IF (ini_file_read[0] == "StartDate")      RecHandler.rec.StartDate      = date(ini_file_read[1]); END;
         IF (ini_file_read[0] == "EndDate")        RecHandler.rec.EndDate        = date(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMCredit")    RecHandler.rec.RSCOMCredit    = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMAccount")   RecHandler.rec.RSCOMAccount   = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMTranches")  RecHandler.rec.RSCOMTranches  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMDocument")  RecHandler.rec.RSCOMDocument  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSVOXRegHist")   RecHandler.rec.RSVOXRegHist   = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSVOXOperation") RecHandler.rec.RSVOXOperation = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMRiskRVP")   RecHandler.rec.RSCOMRiskRVP   = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMHistPerc")  RecHandler.rec.RSCOMHistPerc  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMRisk")      RecHandler.rec.RSCOMRisk      = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RsLns_ChangeRegSum") RecHandler.rec.RsLns_ChangeRegSum = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMEnscontr")  RecHandler.rec.RSCOMEnscontr  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMCase")      RecHandler.rec.RSCOMCase      = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLNS_ExpDemand")RecHandler.rec.RSLNS_ExpDemand= X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "Percent")        RecHandler.rec.Percent        = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLNS_PlanPay")  RecHandler.rec.RSLNS_PlanPay  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLNS_UnSafeDepository")  RecHandler.rec.RSLNS_UnSafeDepository  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLNS_Rezerve")  RecHandler.rec.RSLNS_Rezerve  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLNS_LUFIELD")  RecHandler.rec.RSLNS_LUFIELD  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMCession")   RecHandler.rec.RSCOMCession   = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMLawsuits")  RecHandler.rec.RSCOMLawsuits  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSCOMCostDepEmp") RecHandler.rec.RSCOMCostDepEmp  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RsLns_GraphCommission") RecHandler.rec.RsLns_GraphCommission  = X(ini_file_read[1]); END;
         IF (ini_file_read[0] == "RSLns_Encum")    RecHandler.rec.RSLns_Encum    = X(ini_file_read[1]); END;
         cnt = cnt + 1;
      END;
      IF (cnt != 26) SetDefaultValue(); END;

      close(ini_file_read);
   END;
END;

   ▐Ю╝Г╗Б═БЛ█═АБЮ╝╘╙╗();

   RunDialog(RecHandler, "EventHandler");