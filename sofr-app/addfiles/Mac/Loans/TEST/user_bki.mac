VAR xml = NULL, root = NULL, newElem = NULL;

MACRO СформироватьXMLФайл(FileName, TFID: integer, SendKind: integer)
   VAR RS = NULL, RCLN = NULL, cnt = 0;

   xml = ActiveX( "MSXML.DOMDocument" );
   xml.loadXML("");
   xml.appendChild(xml.createProcessingInstruction("xml", " version='1.0' encoding='windows-1251'"));
   root = xml.createElement("Import");
   newElem = xml.createElement("Title");
   newElem.appendChild( xml.createTextNode(ToANSI("hi, tester")) );
   root.appendChild(newElem);
   xml.appendChild(root);
   xml.Save(FileName);
END;

////////////////////////////////////////////////////////////////////////////////
//
// Функция вызывается из Сишника, при индивидуальной передаче информации
// Параметры:
//    TFID         - ID Транспортного файла
//    BkiID        - ID БКИ
//    CreditNumber - ID Договора
//    SendKind     - Вид передачи (2 - Полная    КИ)
//    Path         - Путь
//    FileName     - Имя файла
//
MACRO СформироватьТранспортныйФайл(TFID: integer, BkiID: Integer, CreditNumber: integer, SendKind: integer, Path: string, FileName: string)
   Path = TRIM(Path) + "\\" + TRIM(FileName);
   
   СформироватьXMLФайл(Path, TFID, SendKind);

   RETURN TRUE;
END;

