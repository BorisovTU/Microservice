/**
 @file 		uentcompare_dlg24.mac
 @brief 	Интеграция с внешними системами. Далоговое окно для отчета-сверки счетов и проводок, выгруженных в ЦФТ из СОФР

 # tag
 - functional_block: Отчетность_внутренняя
 - code_type: Report
*/
import "uentcompare_pan.mac";
import "uentcompare_const.mac";

PRIVATE MACRO  GetRelay ( p_RelayName: STRING )
  var ErrCode, FlagValue:bool;

  GetRegistryValue( p_RelayName, V_BOOL, FlagValue, ErrCode );
  if ( ErrCode != 0 )
     FlagValue = false;
  end;

  return FlagValue;
onError(erru)  
  return false;
END;

PRIVATE MACRO DoIt
  //вызов панели (в функциональности RM_24)
  var UserEntCompareProcPanel :TRsbPanel = UserEntComparePanel( DateRep, RM_24 );
      ExitCode = UserEntCompareProcPanel.Run;
  //вызов панели

  if( ExitCode == 316 )
   //перестроить скроллинг
   //перестроить скроллинг
  end;
END;


PRIVATE MACRO CheckRelay
  var xRelayName: STRING = "РСХБ\\ИНТЕГРАЦИЯ\\СВЕРКА_ПРОВОДОК_ЦФТ_24";
  var xUseUEntCompare24: BOOL = GetRelay( xRelayName );
  if(not xUseUEntCompare24)
    msgbox("Нет настройки \n'"+xRelayName+"'\n или ее значение = 'NO'");
  else
    DoIt();
  end;
end;

CheckRelay();




