//А.Киселев 20.05.2019 Request на получение из Бисквит данных по загруженным проводкам в Бисквит из СОФР
import globals;


private class TIntegrationSymbolicIdentifierX
var ObjectId :string,
    SystemId :string,
    SystemNodeId :string;

end;


private class TEntry( DebitAccount_ :string, CreditAccount_ :string, PersonalNumber_ :string )
var DebitAccount :string,
    CreditAccount :string,
    PersonalNumber :string;

 private macro InitConditions( DebitAccount_ :string, CreditAccount_ :string, PersonalNumber_ :string )

  if( (ValType(DebitAccount_) != V_UNDEF) and (ValType(DebitAccount_) != 26) and (DebitAccount_ != "") )
   DebitAccount = DebitAccount_;
  end;

  if( (ValType(CreditAccount_) != V_UNDEF) and (ValType(CreditAccount_) != 26) and (CreditAccount_ != "") )
   CreditAccount = CreditAccount_;
  end;

  if( (ValType(PersonalNumber_) != V_UNDEF) and (ValType(PersonalNumber_) != 26) and (PersonalNumber_ != "") )
   PersonalNumber = PersonalNumber_;
  end;


 end;

 InitConditions( DebitAccount_, CreditAccount_, PersonalNumber_ );

end;


private class TConditions( DateIn_ :date, DateOut_ :date, BranchId_ :string )
var DateIn :date,
    DateOut :date,
    BranchId :string;

 private macro InitConditions( DateIn_ :date, DateOut_ :date, BranchId_ :string )

   if( (ValType(DateIn_) != V_UNDEF) and (ValType(DateIn_) != 26) and (DateIn_ != date("00.00.00")) )
    DateIn = DateIn_;
   end;

   if( (ValType(DateOut_) != V_UNDEF) and (ValType(DateOut_) != 26) and (DateOut_ != date("00.00.00")) )
    DateOut = DateOut_;
   else
    DateOut = DateIn_;
   end;

   if( (ValType(BranchId_) != V_UNDEF) and (ValType(BranchId_) != 26) and (BranchId_ != "") )
    BranchId = BranchId_;
   end;

 end;

 InitConditions( DateIn_, DateOut_, BranchId_ );

end;


private class TGetEntriesForVerifyReq(  ReqId :string )
   var RequestId :TIntegrationSymbolicIdentifierX,
       Conditions :TConditions,
       EntriesList :object /*TArray*/;


   private macro InitGetEntriesForVerifyReq( ReqId :string )


    if( (ValType(ReqId) != V_UNDEF) and (ValType(ReqId) != 26) and (ReqId != "") )
     RequestId = TIntegrationSymbolicIdentifierX();
     RequestId.ObjectId = ReqId;
    end;

   end;


   macro AddConditins( DateIn :date, DateOut :date, BranchId :string )

     Conditions = TConditions( DateIn :date, DateOut :date, BranchId :string );

   end;

   macro AddEntry( DebitAccount :string, CreditAccount :string, PersonalNumber :string )
   var trn :TEntry;

      trn = Null;
      trn = TEntry( DebitAccount, CreditAccount, PersonalNumber );
      if( ValType(EntriesList) == V_UNDEF )
       EntriesList = TArray();
      end;
      EntriesList[EntriesList.Size] = trn;
      trn = Null;
   end;

   InitGetEntriesForVerifyReq( ReqId );

end;

      
private class TGetEntriesForVerifyReqMsg( ReqId :string )
var GetEntriesForVerifyReq;

   GetEntriesForVerifyReq = TGetEntriesForVerifyReq( ReqId );

end;   
 

private class TGetEntriesForVerifyRequest( ReqId :string )
var GetEntriesForVerifyReqMsg :TGetEntriesForVerifyReqMsg;

 GetEntriesForVerifyReqMsg = TGetEntriesForVerifyReqMsg( ReqId );
 
end;


macro GetEntriesForVerifyReq( ReqId :string ) //параметры запроса
var req_obj :TGetEntriesForVerifyRequest;

  req_obj = TGetEntriesForVerifyRequest( ReqId );

  return req_obj;
end;


/*
var rq_res;

rq_res = GetEntriesForVerifyReq("7613db77-2256-4feb-90b9-e208c9892f82");
rq_res.GetEntriesForVerifyReqMsg.GetEntriesForVerifyReq.AddConditins( {CurDate} );
rq_res.GetEntriesForVerifyReqMsg.GetEntriesForVerifyReq.AddEntry( "89756959", "070970970" );
rq_res.GetEntriesForVerifyReqMsg.GetEntriesForVerifyReq.AddEntry( "897999999959", "0709711111111" );

MsgBox("BEBEBEBEB");
*/
