//А.Киселев 08.01.2011 интерфейсная загрузка RUData Общая информация по ценным бумагам, купоны и частичные погашения облигаций
import "loadRUData.mac";


var StrCode = "",
    Mode :integer;

if( ( GetString( StrCode, "Укажите биржевой код ценной бумаги.", 35 ) ) and ( StrCode != "" ) )
 if( ( {Oper} == 1 ) and (MsgBoxEx( "Новая ценная бумага?", MB_YES+MB_NO, IND_YES, "Предупреждение", "") == IND_YES) )
  Mode = 1;
 else
  Mode = 0;
 end;

 if( SOFR_LoadRuDataByCode( StrCode, Mode ) )
  MsgBox("Ценная бумага с биржевым кодом " + StrCode + " загружена.");
 else
  MsgBox("Ценная бумага с биржевым кодом " + StrCode + " не загружена.");
 end;
elif( ( {Oper} == 1 ) and (MsgBoxEx( "Загружаем данные по всем бумагам справочника СОФР?", MB_YES+MB_NO, IND_YES, "Предупреждение", "") == IND_YES) )
 Mode = 0;
 if( SOFR_LoadRuDataByCode( StrCode, Mode ) )
  MsgBox("Ценные бумаги загружены.");
 else
  MsgBox("Ошибки при загрузке ценных бумаг.");
 end;

end;

Exit(1);
