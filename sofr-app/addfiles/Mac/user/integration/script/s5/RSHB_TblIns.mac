import RSD;
macro TableInsert(ContractID:TArray)
var param = "";
var n = 1;
param = param + ContractID[0];

while (n<= ContractID.Size-1)
param = param + ", "+ contractId[n];
n = n+1;
end;

var cmd = "INSERT INTO SOFR_CONTRACTBOOUT (CONTRACTID, "+
"                                CONTRACTNUMBER, "+
"                                CONTRACTDATE, "+
"                                CLIENTTYPE, "+
"                                CLIENTID, "+
"                                BRANCHID) "+
"   SELECT dl.t_dlcontrid, "+
"          contr.t_number, "+
"          contr.t_datebegin, "+
"          party.t_legalform, "+
"          contr.t_partyid, "+
"          contr.t_department "+
"     FROM ddlcontr_dbt dl  "+
"     left join dsfcontr_dbt contr on DL.T_SFCONTRID = contr.t_id "+
"          LEFT JOIN dparty_dbt party ON contr.t_partyid = party.t_partyid "+
"    WHERE dl.t_dlcontrid IN ( "+param + " ) ";
cmd = RSDCommand(cmd);
cmd.execute;
end;

