import RSD;
macro TableInsert(ContractID:TArray)
var param = "";
var n = 1;
param = param + ContractID[0];

while (n<= ContractID.Size-1)
param = param + ", "+ contractId[n];
n = n+1;
end;

var cmd = "INSERT INTO SOFR_CONTRACTBOOUT (CONTRACTID, "+
"                                CONTRACTNUMBER, "+
"                                CONTRACTDATE, TYPETP, "+
"                                CLIENTTYPE, "+
"                                CLIENTID, "+
"                                BRANCHID) "+
"   SELECT dl.t_dlcontrid, "+
"          contr.t_number, "+
"          contr.t_datebegin, 1, "+
"          party.t_legalform, "+
"          contr.t_partyid, "+
"          contr.t_department "+
"     FROM ddlcontr_dbt dl  "+
"     left join dsfcontr_dbt contr on DL.T_SFCONTRID = contr.t_id "+
"          LEFT JOIN dparty_dbt party ON contr.t_partyid = party.t_partyid "+
"    WHERE dl.t_dlcontrid IN ( "+param + " ) ";
cmd = RSDCommand(cmd);
cmd.execute;
end;


var cmd = " SELECT dl.t_dlcontrid "+
"     FROM ddlcontr_dbt dl "+
"     left join dsfcontr_dbt contr on DL.T_SFCONTRID = contr.t_id "+
"     where CONTR.T_DATEBEGIN = to_date(:datain, dd.mm.yyyy) ";
cmd  = RSDCommand(cmd);
cmd.AddParam("datain", RSDBP_IN, "02.07.2018");
var myArray = tArray;
var n= 0;
var rs = RsdRecordset(cmd);
while(rs.movenext)
myArray(n) = rs.value(0);
n = n+1;
end;
Tableinsert(myArray);
