// ѕреобразование типа clob в текст. ID записи в таблице, длина CLOB (32000), им€ таблицы, название пол€ с CLOBданными
private macro GetPartClobData(ID, substrsize, offset, _tablename, _datafield)
   var PartClobData = "";
   var cmd, DataSet;

   cmd = RSDCommand(  " select NVL(DBMS_LOB.SUBSTR(" + _datafield + ", ?, ?), CHR(1)) PartClobData "
                    + "   from " + _tablename + " "
                    + "  where t_ID = ?"
                   );

   cmd.AddParam("", RSDBP_IN, substrsize );
   cmd.AddParam("", RSDBP_IN, offset );
   cmd.AddParam("", RSDBP_IN, ID );

   cmd.Execute();

   DataSet = TRsbDataSet(cmd);
   if(DataSet.moveNext())
      PartClobData = DataSet.PartClobData;
   end;

   return PartClobData;
end;

 macro GetClobData(ID:integer, LengthClob:integer, tablename:string, datafield:string)
   var substrsize = 4000; //!!!Ѕольше нельз€
   var cmd;
   var ClobData = "", PartClobData = "";
   var i = 0;

   PartClobData = GetPartClobData(ID, substrsize, i*substrsize+1, tablename, datafield);
   while(PartClobData != "")
      ClobData = ClobData + PartClobData;
      i = i + 1;

      PartClobData = GetPartClobData(ID, substrsize, i*substrsize+1, tablename, datafield);
   end;

   return ClobData;
end;
