import rsd;

private var sql, cmd;
private var p_accountid;// = 164673;
private var p_choise = 0;

GetInt(p_choise, "Счет клиента типа:\n0 - \"Внутренний\"\n1 - Банковский счет\n2 - Счет ЮЛ\n3 - Счет ФЛ");
if(p_choise == 0)
   p_accountid = 166248;
elif(p_choise == 1)
   p_accountid = 166212;
elif(p_choise == 2)
   p_accountid = 165565;
elif(p_choise == 3)
   p_accountid = 2899;
else
   msgbox("Введенный вариант не соответствует списку ожидаемых");
   RunError();
end;

sql =       "UPDATE daccount_dbt ";
sql = sql + "   SET t_nameaccount = SUBSTR(t_nameaccount, 1, (LENGTH(t_nameaccount) - 1)) || (TO_NUMBER(SUBSTR(t_nameaccount, -1, 1)) + 1) ";
sql = sql + " WHERE t_accountid = :p_accountid ";
cmd = RSDCommand(sql);
cmd.addParam("p_accountid", RSDBP_IN, p_accountid);
cmd.execute();

cmd.close(); cmd = NULL; sql = NULL;

msgbox("Успех!");

onError(err)
   msgbox("Неудача");

/*
-- kva: Используемые для подбора счетов запросы:

-- "Внутренние" счета:
SELECT * FROM daccount_dbt
WHERE t_open_close = CHR(0)
AND t_client IN (SELECT t_partyid FROM ddp_dep_dbt)
AND t_chapter IN (1, 3, 4)
AND t_balance NOT LIKE '306%'
AND t_balance NOT LIKE '47423%'
ORDER BY t_accountid DESC

-- Банковские счета (кроме "нашего" Банка):
SELECT * FROM daccount_dbt
WHERE t_open_close = CHR(0)
AND t_client IN (SELECT t_partyid FROM dpartyown_dbt WHERE t_partykind = 2)
AND t_client NOT IN (SELECT t_partyid FROM ddp_dep_dbt)
AND t_chapter IN (1, 3, 4)
AND t_balance NOT LIKE '306%'
AND t_balance NOT LIKE '47423%'
ORDER BY t_accountid DESC

-- Счета ЮЛ (кроме Банков):
SELECT * FROM daccount_dbt
WHERE t_open_close = CHR(0)
AND t_client IN (SELECT t_partyid FROM dparty_dbt WHERE t_legalform = 1)
AND t_client NOT IN (SELECT t_partyid FROM dpartyown_dbt WHERE t_partykind = 2)
AND t_client NOT IN (SELECT t_partyid FROM ddp_dep_dbt)
AND t_chapter IN (1, 3, 4)
AND t_balance NOT LIKE '306%'
AND t_balance NOT LIKE '47423%'
ORDER BY t_accountid DESC

-- Счета ФЛ:
SELECT * FROM daccount_dbt
WHERE t_open_close = CHR(0)
AND t_client IN (SELECT t_partyid FROM dparty_dbt WHERE t_legalform = 2)
AND t_chapter IN (1, 3, 4)
AND t_balance NOT LIKE '306%'
AND t_balance NOT LIKE '47423%'
ORDER BY t_accountid DESC
*/