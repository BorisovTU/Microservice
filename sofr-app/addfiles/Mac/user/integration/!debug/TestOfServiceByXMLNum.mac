     /*------------------------------------------------------------------------------------------*/
/* Макрос для отладки работы интеграционного сервиса по заданному id запроса из dxr_log_dbt */
/*                                                                                          */
/* Автор: Карпов В.                                                                         */
/*------------------------------------------------------------------------------------------*/

import auxCaptureXML;

private var outObj;
private var XRLOG_MSG_NUMBER : integer;

macro uServiceExecuteByLog()
   var incomeXMLobj;
   var serviceResult;
   var serviceName; /* Наименование сервиса (функции) из dxr_log_dbt */
   var macroName;   /* Наименование сервиса (макроса) из dxr_log_dbt */

   incomeXMLobj = uConvertXMLtoRSL(uGetXrLogMsg(XRLOG_MSG_NUMBER, macroName, serviceName));
   msgbox(string("Макрос: ", macroName, "; Сервис: ", serviceName));
   InstLoadModule(macroName);

   serviceResult = ExecMacroFile(macroName, serviceName, incomeXMLobj.methodparms[0],
                                                         incomeXMLobj.methodparms[1],
                                                         incomeXMLobj.methodparms[2],
                                                         incomeXMLobj.methodparms[3],
                                                         incomeXMLobj.methodparms[4],
                                                         incomeXMLobj.methodparms[5],
                                                         incomeXMLobj.methodparms[6],
                                                         incomeXMLobj.methodparms[7],
                                                         incomeXMLobj.methodparms[8],
                                                         incomeXMLobj.methodparms[9]);

   return serviceResult;
end;

/* НОМЕР СООБЩЕНИЯ В ЛОГЕ */
XRLOG_MSG_NUMBER = uGetContextVal(); /* Получить из контекста */
getInt(XRLOG_MSG_NUMBER); /* Получение номера запроса */
if(XRLOG_MSG_NUMBER != 0)
   uSetContextVal(XRLOG_MSG_NUMBER); /* Сохранить в контекст */

   outObj = uServiceExecuteByLog();
else
   msgbox("Требуется указать идентификатор XML-сообщения из Журнала удаленного вызова (dxr_log_dbt)");
end;

msgbox("Done!");
Exit(1);