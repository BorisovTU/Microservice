/** 
 @file importDU.mac
 @brief Прослойка для запуска загрузки операции вывода из ДУ из RS-Bank
  
 Прослойка для запуска загрузки операции вывода из ДУ из RS-Bank

 # tag 
 - functional_block:СО
 - code_type:API
 - BIQ-15249


 # changeLog 
 |date       |author         |tasks            |note                            
 |-----------|---------------|-----------------|--------------------------------
 |2023.12.12 |Фаршатов Г. К. |CCBO-7947        | Реализация прослойки             
 |           |               |                 |                   

*/ 
import importDU;

FILE outFile() txt;

/**
 @brief Запустить загрузку операции вывода из ДУ
*/
private macro ImportDU_Run()
  var dateDU = "";
  if (GetString( dateDU, "Введите дату вывода из ДУ в формате <ddmmyyyy>", 8 ))
    importDU(dateDU, false);
    var reportNameImport = GetFullPath("..\\TxtFile\\") + "ImportDU_" + UserNumber + ".txt";

    if(open (outFile,reportNameImport))
      ViewFile(outFile);
      close(outFile);
      if (MsgBoxEx("Выполнить перерасчет связей по обработанным данным?", MB_YES + MB_NO, IND_YES) == IND_YES)
        CalcTX ();
        var reportNameLinksCalcDU = GetFullPath("..\\TxtFile\\") + "LinksCalcDU_" + UserNumber + ".txt";
        if(open (outFile,reportNameLinksCalcDU))
          ViewFile(outFile);
          close(outFile);
        end;
      end;
    end;
  end;
end;

ImportDU_Run()