/*BIQ-1291 Загрузка выводов ДС            */
/*Дорохов А.Н.                            */
/*Запуск процедуры по заданию планировщика*/

import LoadNPTXfunc;

private const SS_RESPONSE_END = 3; /* Успешное завершение всего сервиса */

private class c_ssRunResult(p_ProcessState, p_ErrorNumber, p_ErrorText)
   var ProcessState;
   var ErrorNumber;
   var ErrorText;

   private macro init_ssRunResult(p_ProcessState, p_ErrorNumber, p_ErrorText)
      if(ValType(p_ProcessState) != V_UNDEF)
         ProcessState = p_ProcessState;
      end;
      if(ValType(p_ErrorNumber) != V_UNDEF)
         ErrorNumber = p_ErrorNumber;
      end;
      if(ValType(p_ErrorText) != V_UNDEF)
         ErrorText = p_ErrorText;
      end;
   end;

   init_ssRunResult(p_ProcessState, p_ErrorNumber, p_ErrorText);
end;


macro ShedullerRun()
  var ResultSheduler :object;
  runLoadNPTX(True);
  return ResultSheduler = c_ssRunResult(SS_RESPONSE_END);
end;


