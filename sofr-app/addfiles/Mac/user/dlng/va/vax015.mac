/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : vax015.mac
                                va-вексель
                                 x-операция мены векселей (bart)
                               015-номер (соответствующий шагу)
  Операция    : Мена векселей
  Шаг         : Оформление договора мены
  Comment     :
└───────────────────────────────────────────────────────────────────────────*/

/* Запуск шага
*/
MACRO ExecuteStep(Buffer, dl_tick)
var stat = 0;

    record tick( dl_tick );
    SetBuff( tick, dl_tick );

    if( tick.DealDate > {curdate} )
       return VA_Err("Преждевременное выполнение шага запрещено.");
    end;

//Печать договора мены

    return stat;

END;


/* Макрос постобработки 
*/
MACRO PostStep (    
                CommitOrRollback, /*1-выполнение шага,2 -откат шага*/
                errTrn,        /* Статус выполнения шага-!0-произошла ошибка */
                FirstDoc,      /* Указатель на первичный документ */
                ID_Operation,  /* Номер экземпляра операции */
                Num_Step,      /* Номер шага операции(из настроек) */
                Kind_Operation,/* Вид операции */
                KindDoc,       /* Вид первичного документа */
                KindStep,      /* Вид шага операции */
                ID_Step)       /* Номер шага операции */

    if (errTrn OR (CommitOrRollback==2)) 
        /* Произошла ошибка или происходит откат */
        return;
    end;
    
    return 1;

END;


/* Макрос печати 
*/
MACRO PrintStepDocs (
                ID_Operation,  /* Номер экземпляра операции */
                ID_Step,       /* Номер шага операции */
                Kind_Operation,/* Вид операции */
                KindStep)      /* Вид шага операции */

//    PrintDecAccOpen(MAN_PRINT, ID_Operation, ID_Step, Kind_Operation, OpAccTemplName);

    exit(1) ;

END;


