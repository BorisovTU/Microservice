/*
vs_account_rep.mac
Привязанные счета к векселям
*/
import oralib, likepy, RsbFormsInter;

class (TRsbPanel) Veksel_account_panel
var FT_INT     = 0,
    FT_DOUBLE  = 4,
    FT_STRING  = 7,
    FT_DATE    = 9,
    FT_CHR     = 12,
    FT_NUMERIC = 25;

var ESC  = 27,
    F3   = 317,
    F9   = 323,
    SHF6 = 345;

  macro Init ()
    var control = TRsbEditField;

    SetSize    (30, 4); 
    SetPosition(20,  10);

    setCaption("Список привязанных счетов");

    addLabel(TRsbLabel(2, 0, "Дата отчета:"));

    control.name       = "dt";
    control.dataType   = FT_DATE;
    control.textLength = 10;
    control.setPosition(11, 0);
    control.setSize    (10, 1);
    control.Editable  = true;
    addControl(control);

    addLabel(TRsbLabel(2, 1, "Диапазон номеров:"));

    control = TRsbEditField;
    control.name       = "StartNum";
    control.dataType   = FT_STRING;
    control.textLength = 10;
    control.setPosition(2, 2);
    control.setSize    (10, 1);
    control.Editable  = true;
    addControl(control);

    addLabel(TRsbLabel(12, 2, "-"));

    control = TRsbEditField;
    control.name       = "EndNum";
    control.dataType   = FT_STRING;
    control.textLength = 10;
    control.setPosition(13, 2);
    control.setSize    (10, 1);
    control.Editable  = true;
    addControl(control);

    addEventHandler(RSB_EV_KEY_PRESSED, r2m(this, "eventHandler"));
  End;

  macro eventHandler(EV)
    if (EV.KeyCode == F9)
      close(0);
      return true;
    end;

    EV.ID;

    if (EV.KeyCode == ESC)
      if (GetControl("Priz").checked or (NOT GetControl("Priz").checked) )
        return true;
      end;
    end;

    return true;
  end;

  InitTRsbPanel();
  Init();
END;

macro vs_account_rep ()
  var Pn = Veksel_account_panel();
  Pn.Run();
End;

vs_account_rep();
exit(1)