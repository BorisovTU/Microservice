/*-------------------------------------------------------------------------

	Имя файла	: BaseBuilder.mac 

	Описание	: Базовый класс построителей 

	Программист	: Селезнёв Роман

	Создан		: 14.02.2008


-------------------------------------------------------------------------*/

  
class BaseBuilder
   private var res = "";	// Результат построителя
   private var bIsFirst = true;	// Признак того, что добавляемое значение -- 1е
   private var count = 0;	// Кол-во добавленных значений

   // Добавить новое значение
   macro Add( val )
      if(bIsFirst)
         bIsFirst = false;
      end;

      count = count+1;
      res = res + val;
   end;

   // Добавить массив значений
   macro AddAll( arr )
      var i=0;

      while (i<arr.Size)
         this.Add(arr(i));
         i=i+1;
      end;  
   end;

   // Построить запрос с парами значений
   macro Build()
      return res;
   end;

   // Получить кол-во элменетов
   macro Size()
      return count;
   end;
end;
