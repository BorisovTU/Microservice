IMPORT funk,fx_globals;

   private var que,rs9,jj0,dealid,rs5,j0,que0,rs,ii;
   array mass1,mass2,mass3;

  que0=" from ddl_tick_dbt a  where a.t_partyid=343   and a.T_DEALTYPE=12300  and a.t_dealdate < '01.01.2019' ";
  que0=que0+" and (select count(*) from dpmpaym_dbt b where b.t_dockind=102 and b.t_documentid=a.t_dealid ) > 3 ";
  que0=que0+" and  (select count(*)  from dmmPayMode_dbt c where c.t_dealId = a.t_dealid ) = 0 " ;
  que=" select count(*) "+que0; 
  // msgbox(que);
   rs9 = LnGetRecordSet(que);
   if(rs9 != null)
     while(rs9.moveNext())
       jj0=int(rs9.value(0));
     end;
   end;

   InitProgress( jj0, "¥¤ ªæ¨ï ¯ à ¬¥âà ¬ ¯® £à ä¨ªã ¯« â¥¦¥© ŒŠ" );  

   j0=0;
   que=" select a.t_dealid,t_dealcode  "+que0; 
   rs9 = LnGetRecordSet(que);
   if(rs9 != null)
     while(rs9.moveNext())
       j0=j0+1;
       useprogress(j0);
       dealid=int(rs9.value(0));
       que="Insert into dmmPayMode_dbt (T_DEALID,T_ODPAYTYPE,T_ODDAY,T_ODSUM,T_ODDELAY,T_PCPAYTYPE,T_PCDAY,T_PCSUM,T_PCDELAY,T_RESERVE ) ";
       que=que+" Values ("+dealid+",0,0,0,0,1,20,0,0,' ' )";  
       rs = LnGetRecordSet(que);
       println(rs9.value(1));
     end;
   end;



mass1(0)="ŒŠ-…‹€ƒŒ€Š-20042018";
mass2(0)=15;
mass3(0)=3;

mass1(1)="ŒŠ-…‹€ƒŒ€Š-30052018";
mass2(1)=26;
mass3(1)=3;

mass1(2)="ŒŠ-BELARUSBANK-13122018";
mass2(2)=13;
mass3(2)=3;

mass1(3)="ŒŠ-BELARUSBANK-21122018";
mass2(3)=19;
mass3(3)=3;

mass1(4)="ŒŠ-BELARUSBANK-27122018";
mass2(4)=27;
mass3(4)=3;

mass1(5)="ŒŠ-BELINVESTBANK-22032018";
mass2(5)=21;
mass3(5)=6;

mass1(6)="ŒŠ-BELVEB_10092018";
mass2(6)=10;
mass3(6)=3;

mass1(7)="ŒŠ-DEVEL-BANK-OF-BELAR2809201";
mass2(7)=28;
mass3(7)=3;

mass1(8)="ŒŠ-DEVEL-BANK-OF-BELARUS25122";
mass2(8)=26;
mass3(8)=3;
mass1(9)="ŒŠ-DEVEL-BANK-OF-BELARUS_2310";
mass2(9)=25;
mass3(9)=3;

mass1(10)="ŒŠ-MOSKVA-MINSK-22022018";
mass2(10)=22;
mass3(10)=6;


mass1(11)="ŒŠ-Œ‘_€Š_8-Š-1608/16";
mass2(11)=30;
mass3(11)=0;


mass1(12)="ŒŠ-Œ‘_€Š_8-Š-1624/16";
mass2(12)=30;
mass3(12)=0;


   ii=0;
              while (ii < 13 )
   que=" select t_dealid , a.t_dealcode  from ddl_tick_dbt a  where ";
   que=que+ "a.t_dealcode='"+mass1(ii)+"' and (select count(*) from dpmpaym_dbt b where b.t_dockind=102 and b.t_documentid=a.t_dealid ) > 3 "; 
   que=que+" and  (select count(*)  from dmmPayMode_dbt c where c.t_dealId = a.t_dealid ) = 0 ";
   rs9 = LnGetRecordSet(que);
   if(rs9 != null)
     while(rs9.moveNext())
       j0=j0+1;
       useprogress(j0);
       dealid=int(rs9.value(0));
       que="Insert into dmmPayMode_dbt (T_DEALID,T_ODPAYTYPE,T_ODDAY,T_ODSUM,T_ODDELAY,T_PCPAYTYPE,T_PCDAY,T_PCSUM,T_PCDELAY,T_RESERVE ) ";
       if ( ii  > 10 )
         que=que+" Values ("+dealid+",0,0,0,0,1,"+mass2(ii)+",0,0,' ' )";  
       else
         que=que+" Values ("+dealid+",0,0,0,0,2,"+mass2(ii)+",0,"+mass3(ii)+",' ' )";  
       end;

       rs = LnGetRecordSet(que);
       println(rs9.value(1));
     end;
   end;

                ii=ii+1;
              end;

   que="update  dmmPayMode_dbt set T_PCPAYTYPE=1, T_PCDAY=30 where t_dealid=440";
   rs = LnGetRecordSet(que);



   RemProgress; 
END;

