//import globals, BankInter, CurrInter, utils, plib;
//import funk,"cb_sql.mac","cbsfinv.mac","reference.mac";
//import funk,"cb_sql.mac","fdocclass.mac","reference.mac","utils.mac";
// ,"remote_lib.mac";
Import rcw, rsexts, bankinter, "cb_sql.mac" ; 
import funk,"cb_sql.mac","fdocclass.mac";



record pmpaymm ("pmpaym.dbt");
record pmrmpropm ("pmrmprop.dbt");
private var rs1,rs,ss,que,docc;



macro platmem(id1,ground,sch1,sch2,su,da)
private var newdada,bb,BBDocID;

     ss=string(id1);
     que = "select  *  from dpmpaym_dbt  where t_paymentid ="+id1;
     rs1 = LnGetRecordset(que);
     if(rs1 != null)
      if (rs1.moveNext) 
        CopyRSetToFBuff( pmpaymm, rs1 ) ;
      end;
     end;

     que = "select  *  from dpmrmprop_dbt  where t_paymentid="+pmpaymm.paymentid;
     rs1 = LnGetRecordset(que);
     if(rs1 != null)
      if (rs1.moveNext) 
        CopyRSetToFBuff( pmrmpropm, rs1 ) ;
      end;
     end;

  
    pmpaymm.amount =su;
    pmpaymm.baseamount=pmpaymm.amount;

    pmpaymm.PayerAccount=sch1;
    pmpaymm.ReceiverAccount=sch2;
    pmrmpropm.Number ="0000";
    pmrmpropm.Ground =ground;
    pmpaymm.ValueDate={curdate};

    pmrmpropm.PayerINN = ®«ãç¨âìŠ®¤‘ã¡ê¥ªâ  ( pmpaymm.Payer, 16 );
    pmrmpropm.ReceiverINN  = ®«ãç¨âìŠ®¤‘ã¡ê¥ªâ  ( pmpaymm.Receiver, 16 );
    pmpaymm.DocKind                  = 70;
    pmpaymm.Purpose                  = 48;
    pmpaymm.NumberPack               = 0;

       bb = TBBPrimDoc();

        bb.m_Kind_Operation	=    10306;
	bb.m_Oper		=   {oper};
	bb.m_PayerAccount       =   pmpaymm.PayerAccount;
	bb.m_ReceiverAccount    =   pmpaymm.ReceiverAccount;

	bb.m_Origin             = 1;
	bb.m_Department 	= 1;
	bb.m_docKind            = 70;
	bb.m_ShifrOper          = "06";
	bb.m_Kind_Oper		= " 4";

	bb.m_docNumber          = 1;

	bb.m_Ground		= pmrmpropm.Ground;
	bb.m_AmountDt           = pmpaymm.baseamount;
	bb.m_docDate            = da;
	bb.m_NumberPack 	= 0;

        // bb.m_PayerName          = OSNOVANIE(bb.m_PayerAccount);
        // bb.m_ReceiverName       = OSNOVANIE(bb.m_ReceiverAccount);

          BBDocID = bb.Insert();
          if ( BBDocID > 0 )
          end;



end;




