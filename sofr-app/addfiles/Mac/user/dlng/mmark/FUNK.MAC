import rsd;

macro LnGetRecordSet(Query, MsgPrint)
    var i = 0;
    var rs = null, RSDcmd = null;

    trace(Query);
    RSDcmd = RsdCommand(RslDefCon, Query);
    if (RSDcmd != null)
       rs  = RsdRecordset(RSDcmd);
    end;
    RSDcmd.execute;
    return rs;

    onError(er)
      while( i < RslDefEnv.ErrorCount )
        if (MsgPrint)
           println(RslDefEnv.error(i).descr);
        end;
        trace(RslDefEnv.error(i).descr);
        i = i + 1;
      end;
      return null;
end;

end;