IMPORT RSEXTS;

  var RootDir = "$D:\\RSHB_SOFR_TEST",
      MsgDir   = RootDir + "\\PUBLIC",
      TempImportDir   = MsgDir + "\\Temp",
      ImportDir  = MsgDir + "\\Import",
      ArchDir  = MsgDir + "\\Arch";

      var tdl = tDirList, del, dir;
      var td2 = TDirList(TempImportDir+"\\*","D");
      var td3;
        td2.Sort(0);
        var i = 0;
        var i_x = 0;

while (i < td2.Count)

        if (td2.isDir (i))
         dir = "<DIR>"
         else
         dir = ""
         end;

         if (td2.isDel (i))
           del = "Del"
         else
           del = ""
         end;
if ((td2.name (i)!=".") and (td2.name (i)!="..")) 
//	[ #############    #########   ########## ###########  ##### ###### ]
//	  (td2.name (i),  td2.size (i), td2.fdate (i), td2.ftime (i) , dir , del);
       td3 =  TDirList(TempImportDir + "\\" + td2.name (i)+ "\\*","f");
           td3.sort(0);
           i_x = 0;
           while (i_x < td3.Count)
  //               	[                #############    #########   ########## ########### ]
  //             	  (td3.name (i_x),  td3.size (i_x), td3.fdate (i_x), td3.ftime (i_x) );
                   i_x = i_x + 1;
           end;

           if (not td3.Copy (TempImportDir + "\\" + td2.name (i)+"\\" + "*.xml", "f", ImportDir + "\\" + "*.*"))
//             msgbox("Ошибка копирования!");
           end;
           makedir(ArchDir + "\\" + td2.name (i));
           if (not td3.Copy (TempImportDir + "\\" + td2.name (i)+"\\" + "*.*", "f", ArchDir + "\\" + td2.name (i) + "\\" + "*.*"))
//             msgbox("Ошибка копирования!");
           end;
           TD3.remove(TempImportDir + "\\" + td2.name (i) + "\\*");  
           RemoveDir(TempImportDir + "\\" + td2.name (i));
end;
	
       i = i + 1;

end;

