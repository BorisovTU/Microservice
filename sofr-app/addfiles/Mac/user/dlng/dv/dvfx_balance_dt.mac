import InsCarryDoc, "dv_categ.mac", "dv_car.mac";

MACRO ExecuteCaseStep( Kind_Operation, Number_Step, FDoc, KindDoc )

	record deal(dvndeal);
	var FD;
	SetBuff(deal, FDoc);
	FD = DVFirstDocFXDeal(DL_DVFXDEAL, deal);
       var ДатаОбязательства = FD.ДатаОбязательства(); /*PNV*/
       var ДатаТребования = FD.ДатаТребования(); /*PNV*/

       GetOprDate(DV_FXDEAL_OPRDATE_OBL, ДатаОбязательства); /*PNV*/
       GetOprDate(DV_FXDEAL_OPRDATE_REQ, ДатаТребования); /*PNV*/

	if (FD.СрокСделки == 0)
		if ( ДатаТребования() > ДатаОбязательства() )
			return "59";
		else
			return "55";
		end;
	else   if ( ДатаТребования() > ДатаОбязательства() )
			return "59";
		elif ( ДатаТребования() < ДатаОбязательства() )
			return "55";
		else
    		     return "50";
              end;
	end;

END;

