/*
$Module:      Производные инструменты
*/
import InsCarryDoc, "dv_categ.mac", "dv_car.mac",dv_lib,funk;

macro ExecuteStep( doc, FDoc, DocKind, ID_Operation, ID_Step )

  record deal(dvndeal);
  var FD;
  var sta,bs,ii;
  var ДатаИсполненияШага:date;

  SetBuff(deal, FDoc);
  FD = DVFirstDocFXDeal(DL_DVFXDEAL, deal);


  if (dmdm(deal.id) > 0)
       execmacrofile("dvswift.mac", "DV_MsgSWIFT_MT600", deal.id,1) ;
  else
    if (not FD.IsSwap())
      //ii=DV_DealsGenMes(deal.docKind,deal.ID,300);
    end;
  end;

  return 0;
end;


/*
DV_DealsGenMes(ndeal.docKind,ndeal.ID);
где: 
ndeal.docKind первичный документ ПИ:
4813, Конверсионная сделка ФИСС и КО
4815, Сделка Т+3
199, Внебиржевая операции с ПИ
ndeal.ID идентификатор сделки.

*/