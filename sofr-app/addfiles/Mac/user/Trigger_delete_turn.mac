import rsd, RsbDataSet;


Const DACCTRN_DELETE = "DACCTRN_DBT_DELETE";
Const Enable = "ENABLED";
Const Disable = "DISABLED";

macro Turn_on()

  var sql :string = "", cmd;

  sql = " ALTER TRIGGER DACCTRN_DBT_DELETE ENABLE; ";

  cmd = RSDCommand(sql);
  cmd.execute();

end;

macro Turn_off()

  var sql :string = "", cmd;

  sql = " ALTER TRIGGER DACCTRN_DBT_DELETE DISABLE; ";

  cmd = RSDCommand(sql);
  cmd.execute();

end;

macro GetTriggerStatus()

  var sql :string = "", cmd,rs;

  sql = " select status from user_triggers where trigger_name = 'DACCTRN_DBT_DELETE' ";

  cmd = RSDCommand(sql);
  rs = RSDRecordSet(cmd);

  if( rs.moveNext() )
      return rs.value("status");
  end;

end;


macro trigger()
  var выбор;
  array masm;
  masm(0) = "  Отключить триггер ";
  masm(1) = "  Включить триггер ";
  masm(2) = "  В Ы Х О Д ";

  while (выбор != 2)
    выбор = menu(masm," ESC - отмена, <Enter> - выбор действия ", "Выберите действие, которое необходимо сделать с триггером ");

    if(выбор == 0)
      Turn_off();
      if(GetTriggerStatus() == Disable)
         MsgBox("Триггер отключен");
      else
         MsgBox("Не удалось отключить триггер!");
      end;
    elif(выбор == 1)
      Turn_on();
      if (GetTriggerStatus() == Enable)
         MsgBox("Триггер включен");
      else
         MsgBox("Не удалось включить триггер!");
      end;
    end;
  end;
  
end;

trigger();
exit(1);