import календарь, oralib;


  if ( GetDateAfterWorkDays (date (), 0) != date () ) //выходной
    exit (1);
  end;

  var days;
  if ( not getCmdLineParm ("days", days, V_INTEGER) )
    days = 20;
  end;

  var cmd = RsdCommand("select t_curdate, t_branch " 
                       "  from dcurdate_dbt " +
                       " where t_isclosed = chr(0) " +
                       "   and t_curdate <= ? " +
                       "order by t_curdate, t_branch desc");

  cmd.addParam("", RSDBP_IN, GetDateAfterWorkDays(date(), - days));
  cmd.execute();
    
  var rs = RsdRecordset(cmd);

  while(rs.MoveNext())
    CB_CloseDate (rs.value(1), rs.value(0));
  end;
exit (1);