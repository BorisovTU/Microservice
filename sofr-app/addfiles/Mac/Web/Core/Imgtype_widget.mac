/*
$Name:        Imgtype_widget.mac
$Module:      Главная книга
$Description: Макрос WEB. Типы прикрепленных объектов
*/

import RsbDataSet, globals, oralib, likepy;
import BankInter;
import "ws_partycommon.mac";
import "ws_validation.mac";

class TWebImageType
  var ImageType;
  var Name;
end;

macro WebCore_GetImageTypes(ObjectType)

  var cmd, rs;

  var Arr = TArray;

  var query = " SELECT T_IMAGETYPE, T_NAME "
              "  FROM DIMGTYPE_DBT WHERE T_OBJECTTYPE = " + string(ObjectType);

  query = query + " ORDER BY T_IMAGETYPE ";

  cmd = RsdCommand(query);

  rs = RsdRecordset(cmd);

  while(rs.movenext)

    var obj = TWebImageType;

    obj.ImageType = SQL_ConvType(rs.value("T_IMAGETYPE"));
    obj.Name  = SQL_ConvType(rs.value("T_NAME"));

    Arr[Arr.size] = obj;

  end;

  return Arr;

end;