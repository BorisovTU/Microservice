/*
$Name:        acctrn_print.mac
$Module:      Главная книга
$Description: Макрос печати проводок
*/

Import "ws_file.mac";
Import "prmo.mac";


macro _WebCore_PrintAcctrn( acctrn, FileName : string )

  var FullFilePath = GetTxtFileName(FileName);

  Copy( pr_document, acctrn );

  SetOutput(FullFilePath);

  PrintDocument( 1 );

  SetOutput();

  FullFilePath = ConvertTxt2Html(FullFilePath);

  return GetTextFile(FullFilePath);

end;


macro WebCore_PrintAcctrn( AccTrnID : integer, FileName : string )

  file acctrn("acctrn.dbt");

  ClearRecord( acctrn );
  
  acctrn.AccTrnID = AccTrnID;

  GetEQ( acctrn );

  return _WebCore_PrintAcctrn( acctrn, FileName);

end;

macro WebCore_PrintAcctrnList( AccTrnIDList : TArray, FileName : string )

  file acctrn("acctrn.dbt");

  var i : integer;
  
  var AccTrnCount = AccTrnIDList.Size;

  var FullFilePath = GetTxtFileName(FileName);

  SetOutput(FullFilePath);

  i = 0;

  while( i < AccTrnCount )

    ClearRecord(acctrn);

    acctrn.AccTrnID = AccTrnIDList[i];

    if( GetEQ(acctrn) )

      Copy( pr_document, acctrn );

      PrintDocument( 1 );

    end;

    println;

    i = i + 1;

  end;

  SetOutput();

  FullFilePath = ConvertTxt2Html(FullFilePath);

  return GetTextFile(FullFilePath);

end;
