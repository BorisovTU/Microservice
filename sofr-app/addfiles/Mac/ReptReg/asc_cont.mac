/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank version 4.31                                   R-Style Software Lab
   Файл подсистемы "Отчеты ЦБ"
   Расширения отчетов ЦБ

  Подтверждение на продолжение операции в том случае, если данные уже есть

CREATED: 27.01.98 Молоков С.
MODIFICATIONS:
  14.06.01.  Sal.    SCR 11603.
     Убрал флаги "Рекурсивный рачет" и "Пересчет исходных данных"
  15.06.01.  Sal.    Откатка предыдущего изменения.
└───────────────────────────────────────────────────────────────────────────*/

IMPORT ReptCBInter;

MACRO ПроверкаСтарыхЗначений()
VAR
   DeletePrev = false;

  if ( ПроверитьСохраненнДаты( НомерПодразделения, {Название отчета}, {Вид переменной}, ДатаОтчета, ПредДатаОтчета) )
    if ( not GL_FLG_REC )
      if ( not GetTrue( DeletePrev, "За текущий период баланс рассчитан. Пересчитать форму \"Баланс\"?") )
        УстановитьФлагВозврата( OK_MACRO_FLAG+STOP_PROC_FLG); /* Успешное завершение макроса */
        exit( 1);
      end;
    else
      /* При рекурсивном пересчете не выдается запрос на подтверждение */
      УстановитьФлагВозврата( OK_MACRO_FLAG+STOP_PROC_FLG); /* Успешное завершение макроса */
      exit( 1);
    end;
  end;
END;

/*═══════════════════════════════╕
│    Точка входа в программу     │
╘═══════════════════════════════*/
if ( {Название отчета} == "Балансовые счета" )
  УстановитьФлагВозврата( OK_MACRO_FLAG); /* Успешное завершение макроса */
  Exit( 1); /* Окончание работы макроса без вывода на экран */
end;

if ( not (GL_FLG_REC and GL_FLG_SRC) )
  ПроверкаСтарыхЗначений();
end;

УстановитьФлагВозврата( OK_MACRO_FLAG); /* Успешное завершение макроса */
Exit( 1); /* Окончание работы макроса без вывода на экран */

/*eof*/