/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                  R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Печать приложения 8. Глава 1.

  Создан: 23.05.2005
└───────────────────────────────────────────────────────────────────────────*/
import pr_prl81, pr_prl82, pr_prl83, pr_prl84, pr_prl85;

private const CHAPTER_LABEL = "-ch:";
private const SPOD_LABEL    = "-spod:";

private const CHAPTER_NUM_0 = 0;
private const CHAPTER_NUM_1 = 1;
private const CHAPTER_NUM_2 = 2;
private const CHAPTER_NUM_3 = 3;
private const CHAPTER_NUM_4 = 4;
private const CHAPTER_NUM_5 = 5;


private macro GetChapterNum( StrParm )
   var ind = Index( StrParm, CHAPTER_LABEL );

   if ( ind <= 0 )
      RRG_PRL8_XThrow( RRG_PRL8_XError, "Неверно задана буква главы в параметрах шага операции" );
   end;

   return int(SubStr(StrParm,ind+StrLen(CHAPTER_LABEL),1));
end;

private macro isSpodMode( strParm )
    return index(strParm, SPOD_LABEL) > 0;
end;

private macro Main()

    var chapter = getChapterNum(CmdArgs());
    var reports = TArray();

    if (isSpodMode(CmdArgs()))
        reports[CHAPTER_NUM_1] = RRG_PRL8_Report1Spod();
        reports[CHAPTER_NUM_2] = RRG_PRL8_Report2Spod();
        reports[CHAPTER_NUM_3] = RRG_PRL8_Report3Spod();
        reports[CHAPTER_NUM_4] = RRG_PRL8_Report4Spod();
        reports[CHAPTER_NUM_5] = RRG_PRL8_Report5Spod();
    else
        reports[CHAPTER_NUM_1] = RRG_PRL8_Report1();
        reports[CHAPTER_NUM_2] = RRG_PRL8_Report2();
        reports[CHAPTER_NUM_3] = RRG_PRL8_Report3();
        reports[CHAPTER_NUM_4] = RRG_PRL8_Report4();
        reports[CHAPTER_NUM_5] = RRG_PRL8_Report5();
    end;

    return RRG_PRL8_Main(chapter, reports);

end;

Exit( Main() );
