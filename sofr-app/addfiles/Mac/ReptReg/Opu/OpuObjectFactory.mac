/*
$Name:        OpuObjectFactory.mac
$Module:      Регламентируемая отчетность
$Description: Фабрика объектов
*/
/*
*/

class (RcbObjectFactoryBase)TObjectFactory()
    macro createCalculationOperation() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createCalculationOperation"));
    end;

    macro createNormalizationOperation() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createNormalizationOperation"));
    end;

    macro createFinalCalculate() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createFinalCalculate"));
    end;

    macro createControlSourceData() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createControlSourceData"));
    end;

    macro createControlCalculatedData() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createControlCalculatedData"));
    end;

    macro createPrintOperation() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintOperation"));
    end;

    macro createViewApplication4() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createViewApplication4"));
    end;

    macro createViewForm102() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createViewForm102"));
    end;

    macro createExportPtkOperation() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createExportPtkOperation"));
    end;

    macro createExportObvedOperation() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createExportObvedOperation"));
    end;
end;

class (TObjectFactory) TObjectFactory1881()
    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation");
    end;

    macro createNormalizationOperation() : Object
        return genObject("TNormalizationOperation");
    end;

    macro createFinalCalculate() : Object
        return genObject("TCalculate32090");
    end;

    macro createControlSourceData() : Object
        return genObject("TControlSourceData");
    end;

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation");
    end;

    macro createPrintOperation() : Object
        return genObject("TPrintOperation");
    end;

    macro createViewApplication4() : Object
        return genObject("TViewApplication4");
    end;
    macro createViewForm102() : Object
        return genObject("TViewForm102");
    end;

    macro createExportPtkOperation() : Object
        return genObject("OpuExportPtkPsdOperation");
    end;

    macro createExportObvedOperation() : Object
        return genObject("OpuExportObvedOperation");
    end;
end;

class (TObjectFactory) TObjectFactorySpod(concreteObjectFactory)
    var m_concreteObjectFactory = concreteObjectFactory;

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperationSpod", m_concreteObjectFactory.createCalculationOperation());
    end;

    macro createNormalizationOperation() : Object
        return m_concreteObjectFactory.createNormalizationOperation();
    end;

    macro createFinalCalculate() : Object
        return m_concreteObjectFactory.createFinalCalculate();
    end;


    macro createControlSourceData() : Object
        return m_concreteObjectFactory.createControlSourceData();
    end;

    macro createControlCalculatedData() : Object
        return genObject("TControlCalculatedData4", m_concreteObjectFactory.createCalculationOperation());
    end;

    macro createExportKlikoOperation() : Object
        return m_concreteObjectFactory.createExportKlikoOperation();
    end;

    macro createPrintOperation() : Object
        return m_concreteObjectFactory.createPrintOperation();
    end;

    macro createViewApplication4() : Object
        var viewApplication4 = m_concreteObjectFactory.createViewApplication4();
        var spodPrinting = false;
        if (    (rcbApplication.currentReport.form.name == "Приложение 4 со СПОД")
            and global.parameters.getRegistry().getIsSpodLinePrint().getValue())
            viewApplication4.setSpodView(genObject("TViewApplication4Spod"));
        end;
        return viewApplication4;
    end;

    macro createViewForm102() : Object
        return m_concreteObjectFactory.createViewForm102();
    end;

    macro createExportPtkOperation() : Object
        return m_concreteObjectFactory.createExportPtkOperation();
    end;

    macro createExportObvedOperation() : Object
        return m_concreteObjectFactory.createExportObvedOperation();
    end;
end;

class (TObjectFactory1881) TObjectFactory2055()
    initTObjectFactory1881();

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation2055");
    end;

    macro createFinalCalculate() : Object
        return genObject("TCalculate32055");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022055");
    end;
end;

class (TObjectFactory2055) TObjectFactory2090()
    initTObjectFactory2055();

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation2090");
    end;

    macro createFinalCalculate() : Object
        return genObject("TCalculate32090");
    end;

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation2090");
    end;

    macro createViewApplication4() : Object
        return genObject("TViewApplication42090");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022090");
    end;

    macro createExportPtkOperation() : Object
        return genObject("OpuExportPtkPsdOperation2090");
    end;
end;

class (TObjectFactory2090) TObjectFactory2332()
    initTObjectFactory2090();
    macro createViewApplication4() : Object
        return genObject("TViewApplication42332");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022332");
    end;
end;

class (TObjectFactory2332) TObjectFactory2477()
    initTObjectFactory2332();
    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation2477");
    end;

    macro createViewApplication4() : Object
        return genObject("TViewApplication42477");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022477");
    end;

    macro createNormalizationOperation() : Object
        return genObject("TNormalizationOperation2477");
    end;
end;

class (TObjectFactory2477) TObjectFactory2514()
    initTObjectFactory2477();

    macro createFinalCalculate() : Object
        return genObject("TCalculate32514");
    end;

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation2514");
    end;

    macro createExportPtkOperation() : Object
        return genObject("OpuExportPtkPsdOperation2514");
    end;

    macro createViewApplication4() : Object
        return genObject("TViewApplication42514");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022514");
    end;

end;

class (TObjectFactory2514) TObjectFactory2679()
    initTObjectFactory2514();

    macro createViewApplication4() : Object
        return genObject("TViewApplication42679");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022679");
    end;
end;

class (TObjectFactory2679) TObjectFactory2654()
    initTObjectFactory2679();

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation2654");
    end;

    macro createViewApplication4() : Object
        return genObject("TViewApplication42654");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022654");
    end;

    macro createNormalizationOperation() : Object
        return genObject("TNormalizationOperation2654");
    end;

end;

class (TObjectFactory2654) TObjectFactory2736()
    initTObjectFactory2654();

    macro createViewApplication4() : Object
        return genObject("TViewApplication42736");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022736");
    end;

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation2736");
    end;
end;

class (TObjectFactory2736) TObjectFactory2742()
    initTObjectFactory2736();

    macro createViewForm102() : Object
        return genObject("TViewForm1022742");
    end;
end;

class (TObjectFactory2742) TObjectFactory2800()
    initTObjectFactory2742();

    macro createViewApplication4() : Object
        return genObject("TViewApplication42800");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022800");
    end;
end;

class (TObjectFactory2800) TObjectFactory2835()
    initTObjectFactory2800();

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation2835");
    end;

    macro createExportPtkOperation() : Object
        return genObject("OpuExportPtkPsdOperation2835");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1022835");
    end;

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation2835");
    end;

    macro createNormalizationOperation() : Object
        return genObject("TNormalizationOperation2835");
    end;
end;

class (TObjectFactory2835) TObjectFactory385()
    initTObjectFactory2835();

    macro createViewApplication4();
        return genObject("TViewApplication4385");
    end;

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation385");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm102385");
    end;
end;

class (TObjectFactory385) TObjectFactory3053()
    initTObjectFactory385();

    macro createFinalCalculate() : Object
        return genObject("TCalculate33053");
    end;

    macro createViewForm102() : Object
        return genObject("TViewForm1023053");
    end;

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperation3053");
    end;

    macro createExportKlikoOperation() : Object
        return genObject("TExportKlikoOperation3053");
    end;

    macro createExportPtkOperation() : Object
        return genObject("OpuExportPtkPsdOperation3053");
    end;

    macro createViewApplication4();
        return genObject("TViewApplication43053");
    end;

    macro createNormalizationOperation() : Object
        return genObject("TNormalizationOperation3053");
    end;
end;

class (TObjectFactory3053) TObjectFactory3468()
    initTObjectFactory3053();

    macro createViewForm102() : Object
        return genObject("TViewForm1023468");
    end;

    macro createViewApplication4();
        return genObject("TViewApplication43468");
    end;

    macro createCalculateProtocolView(protocolName : String)
        return genObject("TOpuCalculateProtocolView", protocolName);
    end;
end;

class (TObjectFactorySpod) TObjectFactorySpod2654(concreteObjectFactory)
    InitTObjectFactorySpod(concreteObjectFactory);

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperationSpod2654", m_concreteObjectFactory.createCalculationOperation());
    end;
end;

class (TObjectFactorySpod2654) TObjectFactorySpod385(concreteObjectFactory)
    initTObjectFactorySpod2654(concreteObjectFactory);

    macro createCalculationOperation() : Object
        return genObject("TCalculationOperationSpod385", m_concreteObjectFactory.createCalculationOperation());
    end;

    macro createCalculateProtocolView(protocolName : String)
        return genObject("TOpuCalculateProtocolView", protocolName);
    end;
end;

if (objectFactoryInstance == null)
    if   (global.instructionName() == "3468У")
        objectFactoryInstance = TObjectFactory3468();
    elif (global.instructionName() == "3053У")
        objectFactoryInstance = TObjectFactory3053();
    elif (global.instructionName() == "385П")
        objectFactoryInstance = TObjectFactory385();
    elif (global.instructionName() == "2835У")
        objectFactoryInstance = TObjectFactory2835();
    elif (global.instructionName() == "2800У")
        objectFactoryInstance = TObjectFactory2800();
    elif (global.instructionName() == "2742У")
        objectFactoryInstance = TObjectFactory2742();
    elif (global.instructionName() == "2736У")
        objectFactoryInstance = TObjectFactory2736();
    elif (global.instructionName() == "2654У")
        objectFactoryInstance = TObjectFactory2654();
    elif (global.instructionName() == "2679У")
        objectFactoryInstance = TObjectFactory2679();
    elif (global.instructionName() == "2514У")
        objectFactoryInstance = TObjectFactory2514();
    elif (global.instructionName() == "2477У")
        objectFactoryInstance = TObjectFactory2477();
    elif (global.instructionName() == "2332У")
        objectFactoryInstance = TObjectFactory2332();
    elif (global.instructionName() == "2090У")
        objectFactoryInstance = TObjectFactory2090();
    elif (global.instructionName() == "2055У")
        objectFactoryInstance = TObjectFactory2055();
    else
        objectFactoryInstance = TObjectFactory1881();
    end;

    if (rcbApplication.currentReport.form.name == "Приложение 4 со СПОД")
        var objectFactory = objectFactoryInstance;

        if (rcbApplication.currentReport.context.period.endDate >= RCB_I385_DATE)
            objectFactoryInstance = TObjectFactorySpod385(objectFactory);
        elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2654_DATE)
            objectFactoryInstance = TObjectFactorySpod2654(objectFactory);
        else
            objectFactoryInstance = TObjectFactorySpod(objectFactory);
        end;

    end;
end;
