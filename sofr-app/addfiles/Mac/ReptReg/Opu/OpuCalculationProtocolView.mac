/*
$Name:        OpuCalculationProtocolView.mac
$Module:      ¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì
$Description: Š« ááë ¤«ï ¢ë¢®¤  ¯à®â®ª®«  à áç¥â 
*/
/*
*/

class (TProtocolView) TCalculationProtocolView()
    initTProtocolView("’Š‹ €‘—…’€", "”");

    private var m_isHeadPrinted = false;

    private var m_shouldPrintDocumentHead = true;

    private var m_spodPrintDocumentHead = true;

    private var m_isAdvisoryHeadPrinted = false;

    private var m_shouldPrintDocumentAdvisoryHead = true;

    macro printInstructionName(instructionName)
            [ áç¥â ¢ë¯®«­¥­ ¯® ãª § ­¨î #                                                                                                     ]
            (instructionName);
            [                                                                                                                                  ];
    end;

    macro printTableBottom()
        [ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
        [ ];
    end;

    macro printTableHead()
        [ÚÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿];
        [³ ‘¨¬¢®« ³ ã¡/ ³     ‹¨æ¥¢®© áç¥â     ³   ¨¬¥­®¢ ­¨¥ «¨æ¥¢®£® áç¥â    ³ áâ â®ª ­  ¤ âã  ³ áâ â®ª §  ¤ âã  ³   ‘ã¬¬  àã¡     ³   ‘ã¬¬   ¢ «    ³      ‚á¥£®       ³];
        [³        ³ ‚ «  ³                      ³                                ³      ­ ç «       ³      ª®­æ        ³                 ³¢ àã¡.íª¢¨¢ «¥­â¥³                  ³];
        [ÃÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
        end;

    macro printAccount(symbol, isForCurrency, account, accountName, inRest, outRest, rubSum, curSum, Sum)
        [³                                                                                                                                                                    ³];
        [³ #####    ###    ####################   ##############################   ################   ################   ################  ################  ################ ³]
        (symbol, ternary(isForCurrency, "‚ «", "ã¡"), account, accountName, inRest, outRest, rubSum, curSum, Sum);

        m_shouldPrintDocumentHead = true;
        m_spodPrintDocumentHead   = true;

        m_isEmpty = false;
    end;

/*    macro printAccountsDocument(number, carryDate, debetAccount, creditAccount, sum)
        if (m_shouldPrintDocumentHead)
        [³ ¢ â.ç. ü¤®ªã¬¥­â        „ â         ‘ç¥â ¯® ¤¥¡¥âã       ‘ç¥â ¯® ªà¥¤¨âã                              ‘ã¬¬                                                         ³];
            m_shouldPrintDocumentHead = false;
            m_isEmpty = false;
        end;
        [³  ################ ##########  ####################  ####################                   ################                                                        ³]
        (number:r, carryDate, debetAccount, creditAccount, sum);
    end;  */

    macro printAccountsDocument(symbol, isForCurrency, account, number, carryDate, debetAccount, creditAccount, rubSum, curSum, sum)
        if (m_shouldPrintDocumentHead)
        [³                                           ü ¤®ªã¬¥­â        „ â         ‘ç¥â ¯® ¤¥¡¥âã       ‘ç¥â ¯® ªà¥¤¨âã                                                       ³];
            m_shouldPrintDocumentHead = false;
            m_isEmpty = false;
        end;
        [³ #####    ###    #################### ################ ##########  ####################  ####################  ################  ################  ################ ³]
        (symbol, ternary(isForCurrency, "‚ «", "ã¡"), account, number:r, carryDate, debetAccount, creditAccount, rubSum, curSum, sum);
    end;

    macro printDocument(symbol, account, number, carryDate, debetAccount, creditAccount, rubSum, curSum, sum)
        if (m_shouldPrintDocumentHead)
        [³                                                                                                                                                                    ³];
        [³                                           ü ¤®ªã¬¥­â        „ â         ‘ç¥â ¯® ¤¥¡¥âã       ‘ç¥â ¯® ªà¥¤¨âã         ‘ã¬¬  àã¡  ‘ã¬¬  ¢ «(¢ àã¡)             ‚á¥£® ³];
            m_shouldPrintDocumentHead = false;
            m_isEmpty = false;
        end;
        [³ #####           #################### ################ ##########  ####################  ####################  ################  ################  ################ ³]
        (symbol, account, number:r, carryDate, debetAccount, creditAccount, rubSum, curSum, sum);
    end;

    macro printSpodDocument(symbol, isForCurrency, account, number, carryDate, debetAccount, creditAccount, rubSum, curSum, sum)
        if (m_spodPrintDocumentHead)
        [³                                      ü ¤®ªã¬¥­â  ‘„       „ â         ‘ç¥â ¯® ¤¥¡¥âã       ‘ç¥â ¯® ªà¥¤¨âã                                                       ³];
            m_spodPrintDocumentHead = false;
        end;
        [³ #####    ###    #################### ################ ##########  ####################  ####################  ################  ################  ################ ³]
        (symbol, ternary(isForCurrency, "‚ «", "ã¡"), account, number:r, carryDate, debetAccount, creditAccount, rubSum, curSum, sum);
    end;

    macro printSymbolAccount(account, rubSum, curSum, sum, isSignResult)
        [³ ˆâ®£® ¯® áç¥âã  #################### ###                                                                      ################  ################  ################ ³]
        (account, ternary(isSignResult == 0, ternary(Sum < 0, "(-)", "(+)"), " "), rubSum, curSum, Sum);
    end;

    macro printSymbol(symbol, rubValue, curValue, value)
        if (global.parameters.getRegistry().getIsAccountCalculation().getValue() == true)
        [³ˆâ®£® ¯® á¨¬¢®«ã  #####                                                                                                                            ################ ³]
        (symbol, value);
        else
        [³ˆâ®£® ¯® á¨¬¢®«ã  #####                                                                                        ################  ################  ################ ³]
        (symbol, rubValue, curValue, value);
        end;
        m_shouldPrintDocumentHead = true;
    end;

    macro printSymbolRub(symbol, rubValue)
        [³ˆâ®£® ¯® á¨¬¢®«ã  ##### àã¡.                                                                                   ################                                     ³]
        (symbol, rubValue);
        m_shouldPrintDocumentHead = true;
    end;

    macro printSymbolCur(symbol, curValue)
        [³ˆâ®£® ¯® á¨¬¢®«ã  ##### ¢ «.                                                                                                     ################                   ³]
        (symbol, curValue);
        m_shouldPrintDocumentHead = true;
    end;

    macro printSpodSymbol(rubValue, curValue, value)
        if ((value != null) and ((rubValue != 0.0) or (curValue != 0.0)))
        [³‚ â®¬ ç¨á«¥ ‘„                                                                                               ################  ################  ################ ³]
            (rubValue, curValue, value);
        end;
        m_spodPrintDocumentHead = true;
    end;

    macro printAdvisoryTableBottom()
        if (m_isAdvisoryHeadPrinted)
        [ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
        [ ];
        end;
    end;

    macro printAdvisoryAccount(stringSymbol, symbol, account, name, inRest, outRest, value)
        if (not m_isAdvisoryHeadPrinted)
        [ ‘€‚—                                                                                                                           ];
        [ÚÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿];
        [³ ‘âà®ª   ³ ‘¨¬¢®« ³     ‹¨æ¥¢®© áç¥â     ³   ¨¬¥­®¢ ­¨¥ «¨æ¥¢®£® áç¥â    ³ áâ â®ª ­  ¤ âã  ³ áâ â®ª §  ¤ âã  ³      ‚á¥£®       ³];
        [³ à §¤¥«  ³        ³                      ³                                ³      ­ ç «       ³      ª®­æ        ³                  ³];
        [ÃÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
            m_isAdvisoryHeadPrinted = true;
        else
        [³                                                                                                                                   ³];
        end;

        [³ #######    #####   ####################   ##############################   ################   ################   ################ ³]
        (stringSymbol:c, symbol, account, name, inRest, outRest, value);

        m_shouldPrintDocumentAdvisoryHead = true;

        m_isEmpty = false;
    end;

    macro printAdvisoryAccountsDocument(number, carryDate, debetAccount, creditAccount, sum)
        if (m_shouldPrintDocumentHead)
        [³ ¢ â.ç.    ü¤®ªã¬¥­â        „ â         ‘ç¥â ¯® ¤¥¡¥âã       ‘ç¥â ¯® ªà¥¤¨âã                              ‘ã¬¬                     ³];
            m_shouldPrintDocumentHead = false;
            m_isEmpty = false;
        end;
        [³     ################ ##########  ####################  ####################                   ################                    ³]
        (number:r, carryDate, debetAccount, creditAccount, sum);
    end;

    macro printAdvisorySymbol(value)
        if (not m_shouldPrintDocumentAdvisoryHead)
        [³                                                                                                                                   ³];
        end;
        [³ ˆâ®£®                                                                                                            ################ ³]
        (value);
    end;
end;