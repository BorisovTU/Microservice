/*
$Name:        OpuControlCalculatedDataProtocolView.mac
$Module:      Регламентируемая отчетность
$Description: Макрос печати протокола контроля рассчитанных данных
*/
/*
класс TOpuControlCalculatedDataProtocolView() предостовляет методы для печати протокола контроля РД
*/

class (TProtocolView) TOpuControlCalculatedDataProtocolView()
    initTProtocolView("ПРОТОКОЛ КОНТРОЛЯ РАССЧИТАННЫХ ДАННЫХ");

    macro printTableHead()
        [┌──────┬───────────────┬──────────────────┬───────────────┬───────────────────────────────────────────────────────────┐];
        [│Символ│     Сумма     │  Имя переменной  │   Значение    │                        Примечание                         │];
        [├──────┼───────────────┼──────────────────┼───────────────┼───────────────────────────────────────────────────────────┤];
    end;

    macro printLineTable(symbolName, symbolExact, valueName, valueExact, note)
        [  ##### ###############  ################# ############### ########################################################### ]
        (symbolName:r, symbolExact:r, valueName:r:w, valueExact:r, note:w);
    end;

    macro printTableBottom()
        [└──────┴───────────────┴──────────────────┴───────────────┴───────────────────────────────────────────────────────────┘];
    end;

    macro printBottom(successfulNumber, errorNumber, balanceReport)
        [ ];
        [Всего выполнено успешно: #](successfulNumber);
        [Всего ошибок:            #](errorNumber);
        [Для контроля использовалась форма "Балансовые счета" с ########## по ##########](balanceReport.context.period.beginDate, balanceReport.context.period.endDate);
    end;
end;
