/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank V6                                                                        R-Style Softlab
  ” ©« ¯®¤á¨áâ¥¬ë "¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì"

  Š®­âà®««¥à ¯¥ç â¨ ä®à¬ë 664.

  ‘®§¤ ­: 09.08.2010 - Shestakov Dmitry
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
import calc_f664_b2470u;

import print_f664i1_b2470u; // print_f664i1_b2470u.mac
import print_f664i2_b2470u; // print_f664i2_b2470u.mac
import print_f664i3_b2470u; // print_f664i3_b2470u.mac
import print_f664i4_b2470u; // print_f664i4_b2470u.mac

private class TPrinterController
    
    private var m_report = TPrintableForm664();
    private var m_issue1 = objectFactoryInstanceF664.createIssue1PrintableForm("”664_ §¤¥«_1");
    private var m_issue2 = objectFactoryInstanceF664.createIssue2PrintableForm("”664_ §¤¥«_2");
    private var m_issue3 = objectFactoryInstanceF664.createIssue3PrintableForm("”664_ §¤¥«_3_", "”664_ §¤¥«_3_”");
    private var m_issue4 = objectFactoryInstanceF664.createIssue4PrintableForm("”664_ §¤¥«_4_", "”664_ §¤¥«_4_”");

    m_report.setReportWidth(m_issue1.getWidth()); //max(m_issue1.getWidth(), m_issue2.getWidth())

    macro view()

        m_report.createF();
        m_report.addHeader();

        if (not m_report.isEmpty())

            m_issue1.printIssue();

            if (not m_issue1.isEmpty())

                m_issue2.printIssue();

            end;

            m_issue3.printIssue();

            if (not m_issue3.isEmpty())

                m_issue4.printIssue();

            end;


        end;

        m_report.addFooter();

        m_report.view();

    end;

end;

TPrinterController().view();

OnError(error)
    exceptionMessage(error);
    exit(1);
