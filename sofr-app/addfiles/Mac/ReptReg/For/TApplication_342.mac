/*
$Name:          TApplication_342.mac
$Module:        Регламентируемая отчетность
$Description:   ФОР. Классы приложений ФОР
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Классы приложений ФОР

  Создан: 22.10.2009 - Ser.
└─────────────────────────────────────────────────────────────────────────────────────────────────*/
/***************************************************************************************************
 *  Класс Приложения 1
 **************************************************************************************************/
class (TApplication) TApplication342()
    initTApplication();

    macro updateBalanceValues()
        var i = 0;
        while (i < m_rows.size)
            m_rows[i].updateBalanceValues();
            i = i + 1;
        end;
    end;
end;
/***************************************************************************************************
 *  Класс Приложения 1
 **************************************************************************************************/
class (TApplication342) TApplication342_1()
    initTApplication342();

    m_reportWidth = 80;

    private macro printHeader()
        [                                                                  Приложение 1 ];
        [                                                      к Положению Банка России ];
        [                                          от 7 августа 2009 года  года № 342-П ];
        [                                                     "Об обязательных резервах ];
        [                                                        кредитных организаций" ];
        [                                                                               ];
        [           ┌──────────┬───────────────────────────────────────────────────────┐];
        [           │   Код    │          Код кредитной организации(филиала)           │];
        [           │территории├──────────┬───────────────┬───────────────┬────────────┤];
        [           │ по ОКАТО │ по ОКПО  │   Основной    │Регистрационный│    БИК     │];
        [           │          │          │государственный│     номер     │            │];
        [           │          │          │регистрационный│               │            │];
        [           │          │          │    номер      │               │            │];
        [           ├──────────┼──────────┼───────────────┼───────────────┼────────────┤];
        [           │##########│##########│###############│###############│############│](Код_СОАТО:c, Код_ОКПО:c, ОГРН:c,   РегНомерБанка:c, {MFO_Bank}:c );
        [           └──────────┴──────────┴───────────────┴───────────────┴────────────┘];
        [                                                                               ];
        [                        РАСЧЕТ РАЗМЕРА ОБЯЗАТЕЛЬНЫХ РЕЗЕРВОВ,                  ];
        [                       ПОДЛЕЖАЩИХ ДЕПОНИРОВАНИЮ В БАНКЕ РОССИИ                 ];
        [                                          #                                    ](getPeriod():c );
        [                                                                               ];

        printNameLendingAgency();

        [ ############################################################################# ]("Почтовый адрес " + TNamesZone().getLendingAgencyPostalAdress():w);
        [                                                                               ];
        [                                                                    Ежемесячно ];
        [                                                                     тыс. руб. ];
    end;

    private macro printFooterComments()
        [ ############################################################################# ]("(1) Приводятся показатели приложения 2 к настоящему Положению.":w);
        [ ############################################################################# ]("(2) Заполняется кредитной организацией при намерении получить право на усреднение обязательных резервов. В ином случае проставляется нулевое значение.":w);
        [ ############################################################################# ]("(3) Указывается фактический остаток средств обязательных резервов на счетах по учету обязательных резервов на дату, установленную для представления Расчета.":w);
        [ ############################################################################# ]("(4) При наличии отрицательных значений проставляется нулевое значение.":w);
        [ ############################################################################# ]("(5) В случае если зачет не проводится, проставляется прочерк.":w);
    end;

    private macro printFooter()
        printFooter();
        printFooterComments();
    end;

    macro exportToKliko()
        var valueArray = TArray();

        if (global.reportingPeriodIsVror)
            global.klikoExportFile.printID("F_P1VV");
        else
            global.klikoExportFile.printID("F_P1M");
        end;

        valueArray[valueArray.size] = "NBNR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNotresidentLegalPersonRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NFLR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNaturalPersonRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NIOR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getOthersRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NBNV";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNotresidentLegalPersonCurrency() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NFLV";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNaturalPersonCurrency() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NIOV";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getOthersCurrency() * 100;
        global.klikoExportFile.printString(valueArray);

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение1";
        m_rows[m_rows.size] = TApplicationRow342_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_8(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_9(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_10(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_8(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_9(m_name);
    end;
    constructor();
end;

class (TApplication342_1) TApplication342_1_2963
    initTApplication342_1();

    private macro printHeader()
        var okatoCode = substr(Код_СОАТО, 1, 5);
        okatoCode = nvl(String(okatoCode) + MkStr("0", 5 - strlen(String(okatoCode))), "");

        [                                                                  Приложение 1 ];
        [                                                      к Положению Банка России ];
        [                                          от 7 августа 2009 года  года № 342-П ];
        [                                                     "Об обязательных резервах ];
        [                                                        кредитных организаций" ];
        [                                                                               ];
        [           ┌────────────────────┬─────────────────────────────────────────────┐];
        [           │   Код территории   │          Код кредитной организации          │];
        [           │      по ОКАТО      ├────────────────┬────────────────────────────┤];
        [           │                    │    по ОКПО     │   Регистрационный номер    │];
        [           ├────────────────────┼────────────────┼────────────────────────────┤];
        [           │####################│############### │############################│](okatoCode:c, Код_ОКПО:c, РегНомерБанка:c);
        [           └────────────────────┴────────────────┴────────────────────────────┘];
        [                                                                               ];
        [###############################################################################](global.getAppTitle(m_name):c:w);
        printPeriod();
        [                                     (отчетный период)                         ];
        [                                                                               ];
        printNameLendingAgency();
        printPostalAddress();
        [                                                                               ];
        [                                                                    Ежемесячно ];
        [                                                                     тыс. руб. ];
    end;

    macro constructor()
        m_name = "Приложение1";
        m_applicationLength = 80;
        m_rows[m_rows.size] = TApplicationRow342_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_8(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_9(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_10(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_8_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_9(m_name);
    end;
end;

class (TApplication342_1_2963) TApplication342_1_3115
    initTApplication342_1_2963();

    private macro printBottom()
        var m_signature = TSignatureZone();

        m_signature.excludeAttribute(AC_SECOND_PERSON);

        [Уполномоченное лицо           ];
        [кредитной организации         ];
        m_signature.print(80);
        [______________________________];
    end;

    private macro printFooter()
        printBottom();
        printFooterComments();
    end;

    macro constructor()
        m_name = "Приложение1";
        m_applicationLength = 80;
        m_rows[m_rows.size] = TApplicationRow342_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_6(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_8(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_9(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_2_10(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_7_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_8_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_1_9(m_name);
    end;
end;

class (TSignatureZone) TFForSignatureZone()
    initTSignatureZone();

    macro print(reportWidth)
        var datePrintableReport = string(m_reportIssueDate : f : m);

        var lenFPA = strLen(m_firstPersonAppointment);
        var lenSPA = strLen(m_secondPersonAppointment);
        var lenEx  = strLen("Исполнитель");
        var lenPh  = strLen("телефон:");
        var lenDPR = strLen(datePrintableReport);

        var maxLen = max(
                         max(lenFPA,lenSPA),
                         max(lenEx,
                             max(lenPh,lenDPR)
                            )
                        ) + 4;

        println();

        if (not isAttributeExcluded(AC_FIRST_PERSON))
            println(strAlign(m_firstPersonAppointment  + mkstr(" ", maxLen - lenFPA) + m_firstPersonName,  reportWidth, STR_ALIGN_LEFT));
        end;
        if (not isAttributeExcluded(AC_SECOND_PERSON))
            println(strAlign(m_secondPersonAppointment + mkstr(" ", maxLen - lenSPA) + m_secondPersonName, reportWidth, STR_ALIGN_LEFT));
        end;
            println(strAlign("М.П.", reportWidth, STR_ALIGN_LEFT));
        if (not isAttributeExcluded(AC_EXECUTOR))
            println(strAlign("Исполнитель"             + mkstr(" ", maxLen - lenEx)  + m_executorName  ,   reportWidth, STR_ALIGN_LEFT));
            [ ];
            [______________________  ___________________________];
            [      (подпись)             (инициалы, фамилия)];
        end;
        if (not isAttributeExcluded(AC_EXECUTOR_PHONE_NUMBER))
            println(strAlign("телефон:"                + mkstr(" ", maxLen - lenPh)  + m_executorPhoneNumber, reportWidth, STR_ALIGN_LEFT));
        end;
        println(strAlign(datePrintableReport, reportWidth, STR_ALIGN_LEFT));
    end;
end;

/***************************************************************************************************
 *  Класс Приложения 2
 **************************************************************************************************/
class (TApplication342) TApplication342_2()
    initTApplication342();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + getDateAsString(restDate) + "     │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/
                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по балансовому счету,",                m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("по коду обозначения",                          m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("на каждую календарную дату отчетного периода", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;


            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │        Наименование показателя,         │";
            stringArray[stringArray.size] = "│строки│        номер балансового счета,         │";
            stringArray[stringArray.size] = "│      │            код обозначения              │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                  Приложение 2 ", m_applicationLength, " "));
            printLn(strLpad("      к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 7 августа 2009 года  № 342-П", m_applicationLength, " "));
            printLn(strLpad("    \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("       кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printApplicationTitle();
            printPeriod();

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России." , m_applicationLength));
        printarray(StrTransferByWord("(2) Показатель рассчитывается по формуле средней хронологической величины, указанной в пункте 1 приложения 9 к настоящему Положению." , m_applicationLength));
    end;

    private macro printFooter()
        printFooter();
        printFooterComments();
    end;

    macro exportToKliko()
        if (global.reportingPeriodIsVror)
            global.klikoExportFile.printID("F_P2V");
        else
            global.klikoExportFile.printID("F_P2");
        end;

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow342_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_6(m_name);

        calculateNumberBlocks();
    end;

    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 2 по 2341-У
 **************************************************************************************************/
class (TApplication342_2) TApplication2__2341()
    initTApplication342_2();

    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow342_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2__2341(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_6(m_name);

        calculateNumberBlocks();
    end;
end;

class (TApplication2__2341) TApplication2__2963()
    initTApplication2__2341();

    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow342_2_1_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_2_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_6(m_name);

        calculateNumberBlocks();
    end;

    macro normalizeDecoding()
        local class TFilter()

            macro isSuitable(v : Object)
                return ((v.fieldValue("roubleRest").exact < $0.0) or (v.fieldValue("currencyRest").exact < $0.0))
            end;

        end;

        var iterator = TApplicationRow(m_name).getAttributeValueIterator(m_name, TFilter());
        var i = 0;

        iterator.moveFirst();
        while (not iterator.isDone())
            if (iterator.currentItem.fieldValue("roubleRest").exact < $0.0)
                iterator.currentItem.fieldValue("roubleRest").scaled = $0.0;
            end;
            if (iterator.currentItem.fieldValue("currencyRest").exact < $0.0)
                iterator.currentItem.fieldValue("currencyRest").scaled = $0.0;
            end;
            iterator.moveNext();
        end;

        while (i < m_rows.size)
            m_rows[i].normalizeDecoding();
            i = i + 1;
        end;
    end;

end;

class (TApplication2__2963) TApplication2_3115()
    initTApplication2__2963();

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                              ];
        printFooterComments();
    end;

    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow342_2_1_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_2_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow342_2_3_6(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс Приложения 3
 **************************************************************************************************/
class (TApplication342) TApplication342_3()
    initTApplication342();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + getDateAsString(restDate:f) + "     │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/
                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по отдельному лицевому счету,",        m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("по коду обозначения",                          m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("на каждую календарную дату отчетного периода", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │        Наименование показателя,         │";
            stringArray[stringArray.size] = "│строки│        номер балансового счета          │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                  Приложение 3 ", m_applicationLength, " "));
            printLn(strLpad("      к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 7 августа 2009 года № 342-П ", m_applicationLength, " "));
            printLn(strLpad("    \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("       кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printApplicationTitle();
            printPeriod();

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России." , m_applicationLength));
    end;

    private macro printFooter()
        printFooter();
        printFooterComments();
    end;

    macro exportToKliko()
        if (global.reportingPeriodIsVror)
            global.klikoExportFile.printID("F_P3V");
        else
            global.klikoExportFile.printID("F_P3");
        end;

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение3";
        m_rows[m_rows.size] = TApplicationRow342_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_4(m_name);

        calculateNumberBlocks();
    end;

    constructor();
end;

class (TApplication342_3) TApplication342_3_3115()
    initTApplication342_3();

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                              ];
        printFooterComments();
    end;

    macro constructor()
        m_name = "Приложение3";
        m_rows[m_rows.size] = TApplicationRow342_3_1_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_1_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_3_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_4(m_name);

        calculateNumberBlocks();
    end;
end;

class (TApplication342_3_3115) TApplication342_3_3654()
    initTApplication342_3_3115();

    macro constructor()
        m_name = "Приложение3";
        m_rows[m_rows.size] = TApplicationRow342_3_1_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_1_3654(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_3_3654(m_name);
        m_rows[m_rows.size] = TApplicationRow342_3_1_4(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс Приложения4
 **************************************************************************************************/
class (TApplication342) TApplication342_4()
    initTApplication342();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + getDateAsString(restDate:f) + "     │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "   в рублях   │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/

                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по балансовому счету,",                m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("отдельному лицевому счету балансового счета,", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("коду обозначения ",                            m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[4] = substr(stringArray[4], 1, POS) + strAlign("на каждую календарную дату отчетного периода", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │         Наименование показателя,        │";
            stringArray[stringArray.size] = "│строки│         номер балансового счета         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                   Приложение 4 ", m_applicationLength, " "));
            printLn(strLpad("       к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 7 августа 2009 года  № 342-П ", m_applicationLength, " "));
            printLn(strLpad("     \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("        кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printApplicationTitle();
            printPeriod();

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России.", m_applicationLength));
        printarray(StrTransferByWord("(2) Балансовые счета № 52005, 52006 включаются в настоящее приложение за минусом остатков по кодам обозначения 520051, 520061, указанным в приложении 2 к настоящему Положению", m_applicationLength));
    end;

    private macro printFooter()
        printFooter();
        printFooterComments();
    end;

    macro exportToKliko()
        if (global.reportingPeriodIsVror)
            global.klikoExportFile.printID("F_P4V");
        else
            global.klikoExportFile.printID("F_P4N");
        end;

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение4";
        m_rows[m_rows.size] = TApplicationRow342_4_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_3(m_name);

        calculateNumberBlocks();
    end;

    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения4 по 2341-У
 **************************************************************************************************/
class (TApplication342_4) TApplication4__2341()
    initTApplication342_4();

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России.", m_applicationLength));
        printarray(StrTransferByWord("(2) Балансовый счет № 52005 включается в настоящее приложение за минусом остатков по коду обозначения 520051, указанному в приложении 2 к настоящему Положению.", m_applicationLength));
    end;

    macro constructor()
        m_name = "Приложение4";
        m_rows[m_rows.size] = TApplicationRow4_1__2341(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_3(m_name);

        calculateNumberBlocks();
    end;
end;

class (TApplication4__2341) TApplication4_3115()
    initTApplication4__2341();

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России.", m_applicationLength));
        printarray(StrTransferByWord("(2) Балансовый счет № 52005 включается в настоящее приложение за минусом остатков по коду обозначения 520051, указанному в приложении 2 к настоящему Положению.", m_applicationLength));
    end;

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                              ];
        printFooterComments();
    end;

    macro constructor()
        m_name = "Приложение4";
        m_rows[m_rows.size] = TApplicationRow4_1__2341(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_4_3(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс Приложения 5
 **************************************************************************************************/
class (TApplication342) TApplication342_5()
    initTApplication342();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "─────────────────┬";
                arr[arr.size] = "                 │";
                arr[arr.size] = "на " + getDateAsString(restDate:f) + " │";
                arr[arr.size] = "                 │";
                arr[arr.size] = "─────────────────┼";
                arr[arr.size] = "      " + strLPad(String(number + 1), 2, " ") + "         │";

                return arr;
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │        Наименование показателя,         │";
            stringArray[stringArray.size] = "│строки│        номер балансового счета          │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
        m_isFistBlock = false;
            printLn(strLpad("                  Приложение 5 ", m_applicationLength, " "));
            printLn(strLpad("      к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 7 августа 2009 года № 342-П ", m_applicationLength, " "));
            printLn(strLpad("    \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("       кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printApplicationTitle();
            printPeriod();

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro calculateNumberBlocks()
        m_reportWidth  = global.parameters.getReportLength();

        const HEADER_BLOCK_WIDTH = 50;

        const DATA_BLOCK_WIDTH   = 18;

        m_numberDatesInOneBlock = int((m_reportWidth - HEADER_BLOCK_WIDTH)/DATA_BLOCK_WIDTH);

        var dateCount = global.parameters.getEndDate() + 2 - global.parameters.getBeginDate();
        if (m_numberDatesInOneBlock > dateCount)
            m_numberDatesInOneBlock = dateCount;
        end;
    end;

    private macro printFooterComments()
        printarray(StrTransferByWord("(1) При проведении внеочередного регулирования размера обязательных резервов указываются даты (дата) отчетного периода, установленного Банком России." , m_applicationLength));
    end;

    private macro printFooter()
        printFooter();
        printFooterComments();
    end;

    macro exportToKliko()
        if (global.reportingPeriodIsVror)
            global.klikoExportFile.printID("F_P5V");
        else
            global.klikoExportFile.printID("F_P5N");
        end;

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение5";
        m_rows[m_rows.size] = TApplicationRow342_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_5(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

class (TApplication342_5) TApplication342_5_3115()
    initTApplication342_5();

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                              ];
        printFooterComments();
    end;

    macro constructor()
        m_name = "Приложение5";
        m_rows[m_rows.size] = TApplicationRow342_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_3(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_4(m_name);
        m_rows[m_rows.size] = TApplicationRow342_5_5(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс Приложения 6
 **************************************************************************************************/
class (TApplication342) TApplication342_6()
    initTApplication342();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + getDateAsString(restDate) + "     │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/

                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по отдельному лицево-", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("му счету на каждую календар-",  m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("ную дату отчетного периода(1)", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";

            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │      Наименование показателя,           │";
            stringArray[stringArray.size] = "│строки│      номер балансового счета            │";
            stringArray[stringArray.size] = "│      │          второго порядка                │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                   Приложение 6 ", m_applicationLength, " "));
            printLn(strLpad("       к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 7 августа 2009 года  № 342-П ", m_applicationLength, " "));
            printLn(strLpad("     \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("        кредитных организаций\" ", m_applicationLength, " "));
            printLn();

            printApplicationTitle();
            printPeriod();

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro constructor()
        m_name = "Приложение6";
        m_rows[m_rows.size] = TApplicationRow342_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_3(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

class (TApplication342_6) TApplication342_6_2963()
    initTApplication342_6();

    macro normalizeDecoding()
        local class TFilter()

            macro isSuitable(v : Object)
                return ((v.fieldValue("roubleRest").exact < $0.0) or (v.fieldValue("currencyRest").exact < $0.0))
            end;

        end;

        var iterator = TApplicationRow(m_name).getAttributeValueIterator(m_name, TFilter());
        var i = 0;

        iterator.moveFirst();
        while (not iterator.isDone())
            if (iterator.currentItem.fieldValue("roubleRest").exact < $0.0)
                iterator.currentItem.fieldValue("roubleRest").scaled = $0.0;
            end;
            if (iterator.currentItem.fieldValue("currencyRest").exact < $0.0)
                iterator.currentItem.fieldValue("currencyRest").scaled = $0.0;
            end;
            iterator.moveNext();
        end;

        while (i < m_rows.size)
            m_rows[i].normalizeDecoding();
            i = i + 1;
        end;
    end;

    macro constructor()
        m_name = "Приложение6";
        m_rows[m_rows.size] = TApplicationRow342_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_2_2963(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_3(m_name);

        calculateNumberBlocks();
    end;
end;

class (TApplication342_6_2963) TApplication342_6_3115()
    initTApplication342_6_2963();

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                              ];
    end;

    macro constructor()
        m_name = "Приложение6";
        m_rows[m_rows.size] = TApplicationRow342_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_2_3115(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_3(m_name);

        calculateNumberBlocks();
    end;
end;

class (TApplication342_6_3115) TApplication342_6_3654()
    initTApplication342_6_3115();

    macro constructor()
        m_name = "Приложение6";
        m_rows[m_rows.size] = TApplicationRow342_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_2_3654(m_name);
        m_rows[m_rows.size] = TApplicationRow342_6_3(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс отчета "ДАННЫЕ О ПРИЛОЖЕНИЯХ, НЕ ВОШЕДШИХ В СОСТАВ ОТЧЕТА"
 **************************************************************************************************/
class (TApplication8) TApplication342_8()
    initTApplication8();

    macro constructor()
        m_name = "ОтчетОбОтсутствииОстатков";
        m_rows[0] = TApplicationRow342_8(m_name);
    end;
end;

class (TApplication342_8) TApplication342_8_3115()
    initTApplication342_8();

    private macro printFooter()
        var m_signature = TSignatureZone();
        var nameBoss  : String = {Name_Boss};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));

        m_signature.excludeAttribute(AC_SECOND_PERSON);
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченное лицо           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        m_signature.print(80);
        [                              ];
    end;

    macro constructor()
        m_name = "ОтчетОбОтсутствииОстатков";
        m_rows[0] = TApplicationRow342_8(m_name);
    end;
end;
