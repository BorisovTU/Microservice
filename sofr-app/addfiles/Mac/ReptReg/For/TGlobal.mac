/*
$Name:          TGlobal.mac
$Module:        ¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì
$Description:   ”Ž. ƒ«®¡ «ì­ë¥ ¯¥à¥¬¥­­ë¥ (§ ¯®«­ïîâáï ¢ ®á­®¢­®¬ ¢ á¥ªæ¨ïå ¨­¨æ¨ «¨§ æ¨¨ ¬ ªà®á®¢) ¨ äã­ªæ¨¨
*/
/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank V6                                                                        R-Style Softlab
  ” ©« ¯®¤á¨áâ¥¬ë "¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì"

  Š« áá ¤«ï £«®¡ «ì­®£® ¤®áâã¯ 

  ‘®§¤ ­: 20.04.2007 - Ser.
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
const NATIONAL_CURRENCY = true;
const FOREIGN_CURRENCY = false;

//ª« áá ¯à®â®ª®«  à áç¥â 
class (RcbCalculateProtocolView) TForCalculateProtocolView()
    initRcbCalculateProtocolView("”Ž", "à®â®ª®« à áç¥â ");

    macro initialize()
    end;
end;

class (TGlobalBase) TGlobal()
    //§ £®«®¢ª¨ ¯à¨«®¦¥­¨© (­¥ ­ §¢ ­¨ï, â.ª. á®¤¥à¦¨â ¯¥à¥¢®¤ áâà®ª¨!)
    private var titleApp1 = "€‘—…’ €‡Œ…€ ŽŸ‡€’…‹œ›• …‡…‚Ž‚,\nŽ„‹…†€™ˆ• „…ŽˆŽ‚€ˆž ‚ €Š… Ž‘‘ˆˆ";
    private var titleApp2 = "„€›… Ž Ž‘’€’Š€• …‡…‚ˆ“…Œ›• ŽŸ‡€’…‹œ‘’‚";
    private var titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ „……†›• ‘…„‘’‚,\nˆ‚‹…—…›• Ž’ žˆ„ˆ—…‘Šˆ• ‹ˆ– € ‘ŽŠ … Œ……… ’…• ‹…’";
    private var titleApp4 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“\n‚›“™…›• „Ž‹ƒŽ‚›• –…›• “Œ€ƒ";
    private var titleApp5 = "€‘—…’\n‚…‹ˆ—ˆ› €‹ˆ—›• „……†›• ‘…„‘’‚\n‚ ‚€‹ž’… Ž‘‘ˆ‰‘ŠŽ‰ ”…„…€–ˆˆ ‚ Š€‘‘… Š…„ˆ’Ž‰ Žƒ€ˆ‡€–ˆˆ, ˆ‘Š‹ž—€…Œ›• ˆ\n€‘—…’… ŽŒ€’ˆ‚Ž‰ ‚…‹ˆ—ˆ› ŽŸ‡€’…‹œ›• …‡…‚Ž‚";
    private var titleApp6 = "€‘˜ˆ”Ž‚Š€ Ž’„…‹œ›• ŽŸ‡€’…‹œ‘’‚,\n… Ž„‹…†€™ˆ• …‡…‚ˆŽ‚€ˆž";
    private var titleApp8 = "„€›…\nŽ ˆ‹Ž†…ˆŸ•, … ‚Ž˜…„˜ˆ• ‚ ‘Ž‘’€‚ Ž’—…’€";

    var parameters             : Object = NULL;
    var form                   : Object = NULL;
    var userDataInputer        : Object = NULL;
    var balanceData            : Object = NULL;
    var ptkPsdExportFile       : Object = NULL;
    var klikoExportFile        : Object = NULL;
    var exportBalanceProcessor : Object = NULL;

    var rowCode      : String = "";
    var balanceGroup : String = "";
    var balance      : String = "";

    var tempTable : Object = null;

    //¯à®â®ª®« à áç¥â 
    var m_calculateProtocol = TForCalculateProtocolView();
    m_calculateProtocol.setProtocolOutput();
    m_calculateProtocol.printHead();
    m_calculateProtocol.resetProtocolOutput();

    //¢¨¤ ®âç¥â­®£® ¯¥à¨®¤  (¬¥áïæ/­¥ ¬¥áïæ)
    var reportingPeriodIsEqualMonth = RcbApplication.currentReport.context.period.kind == RCB_PK_MONTH;

    const ALL_CURRENSY  : Integer = 0;
    const ROUBLE_ONLY   : Integer = 1;
    const CURRENCY_ONLY : Integer = 2;

    //¯¥à¨®¤ ®âç¥â  á®®â¢¥âáâ¢ã¥â ‚Ž (‚­¥®ç¥à¥¤­®¥ ¥£ã«¨à®¢ ­¨¥ Ž¡ï§ â¥«ì­ëå ¥§¥à¢®¢)?
    private macro isVror() : Bool
        if (rcbApplication().currentReport.context.period.kind != RCB_PK_MONTH)
            return true;
        else
            return false;
        end;
    end;

    var reportingPeriodIsVror = isVror();

    //¤ â  ¢ ä®à¬ â¥ ƒƒƒƒŒŒ„„
    macro getDate_YYYYMMDD(_date : Date)
        var s = String(_date:f);
        return SubStr(s, 7) + SubStr(s, 4, 2) + SubStr(s, 1, 2);
    end;

    //§ £®«®¢®ª ¯à¨«®¦¥­¨ï (­¥ ­ §¢ ­¨¥, â.ª. á®¤¥à¦¨â ¯¥à¥¢®¤ áâà®ª¨!)
    macro getAppTitle(appCode)
        if ((appCode == "à¨«®¦¥­¨¥1") or (appCode == 1))
            return titleApp1;
        elif ((appCode == "à¨«®¦¥­¨¥2") or (appCode == 2))
            return titleApp2;
        elif ((appCode == "à¨«®¦¥­¨¥3") or (appCode == 3))
            return titleApp3;
        elif ((appCode == "à¨«®¦¥­¨¥4") or (appCode == 4))
            return titleApp4;
        elif ((appCode == "à¨«®¦¥­¨¥5") or (appCode == 5))
            return titleApp5;
        elif ((appCode == "à¨«®¦¥­¨¥6") or (appCode == 6))
            return titleApp6;
        elif ((appCode == "Žâç¥âŽ¡Žâáãâáâ¢¨¨Žáâ âª®¢") or (appCode == 8))
            return titleApp8;
        else
            return "";
        end;
    end;

    macro toAnsiNorm(str, mode)
        if (NormalizationAlgorithm.getReportNormalizationAlgorithm() == CPP_MMB_NORMALIZER)
            return toAnsi(str, mode);
        end;

        return str;
    end;

    macro toOemNorm(str, mode)
        if (NormalizationAlgorithm.getReportNormalizationAlgorithm() == CPP_MMB_NORMALIZER)
            return toOem(str, mode);
        end;

        return str;
    end;

    initializeRepDataPackage(RcbApplication.currentReport);
end;

class (TGlobal) TGlobal_507()
    initTGlobal();

    titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ „……†›• ‘…„‘’‚,\nˆ‚‹…—…›• Ž’ žˆ„ˆ—…‘Šˆ• ‹ˆ– ˆ ˆ„ˆ‚ˆ„“€‹œ›• …„ˆˆŒ€’…‹…‰ € ‘ŽŠ … Œ……… ’…• ‹…’";
end;

class (TGlobal) TGlobal_4217()
    initTGlobal();

    titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ ‘“Ž„ˆˆŽ‚€›• Š…„ˆ’Ž‚\n(„…Ž‡ˆ’Ž‚, ‡€‰ŒŽ‚, Ž‹ˆƒ€–ˆŽ›• ‡€‰ŒŽ‚)";
end;

class (TGlobal) TGlobal_5036()
    initTGlobal();

    titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ ‘“Ž„ˆˆŽ‚€›• Š…„ˆ’Ž‚\n(„…Ž‡ˆ’Ž‚, ‡€‰ŒŽ‚, Ž‹ˆƒ€–ˆŽ›• ‡€‰ŒŽ‚)";
end;

class (TGlobal) TGlobal_5087()
    initTGlobal();

    titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ ‘“Ž„ˆˆŽ‚€›• Š…„ˆ’Ž‚\n(„…Ž‡ˆ’Ž‚, ‡€‰ŒŽ‚, Ž‹ˆƒ€–ˆŽ›• ‡€‰ŒŽ‚)";
end;

class (TGlobal) TGlobal_5242()
    initTGlobal();

    titleApp3 = "€‘˜ˆ”Ž‚Š€ €‹€‘Ž‚›• ‘—…’Ž‚ Ž “—…’“ ‘“Ž„ˆˆŽ‚€›• Š…„ˆ’Ž‚\n(„…Ž‡ˆ’Ž‚, ‡€‰ŒŽ‚, Ž‹ˆƒ€–ˆŽ›• ‡€‰ŒŽ‚)";
end;

/***************************************************************************************************
 *  ƒ«®¡ «ì­ë¥ ¯¥à¥¬¥­­ë¥ ¨ äã­ªæ¨¨
 **************************************************************************************************/
var global = null;

if (RcbApplication.currentReport.context.period.endDate >= RCB_I5242_DATE)
    global = TGlobal_5242();
elif (RcbApplication.currentReport.context.period.endDate >= RCB_I5087_DATE)
    global = TGlobal_5087();
elif (RcbApplication.currentReport.context.period.endDate >= RCB_I5036_DATE)
    global = TGlobal_5036();
elif (RcbApplication.currentReport.context.period.endDate >= RCB_I4217_DATE)
    global = TGlobal_4217();
elif (RcbApplication.currentReport.context.period.endDate >= RCB_I507_DATE)
    global = TGlobal_507();
else
    global = TGlobal();
end;
