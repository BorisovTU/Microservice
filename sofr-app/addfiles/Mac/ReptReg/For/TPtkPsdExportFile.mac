/*
$Name:          TPtkPsdExportFile.mac
$Module:        Регламентируемая отчетность
$Description:   ФОР. Класс файла экспорта в ПТК ПСД
*/
private class(RcbPtkPsdExportController) TForPtkPsdExportController()
    macro printString(appCode, rowCode, columnCode, value)
        var valueArray = TArray();

        valueArray[0] = appCode;
        valueArray[1] = rowCode;
        valueArray[2] = columnCode;
        valueArray[3] = value;

        m_view.printRow(valueArray);
    end;

    private macro getDescriptorInfo()
        if (m_report.getRcbReport().context.period.endDate >= PSD_FR2_2_REZ_20190617.getBeginDate())
            return PSD_FR2_2_REZ_20190617.getAlbumVersion();
        elif (m_report.getRcbReport().context.period.endDate >= PSD_507P_CHANGES_20181204.getBeginDate())
            return PSD_507P_CHANGES_20181204.getAlbumVersion();
        elif (m_report.getRcbReport().context.period.endDate >= PSD_ALB2_2_2018_01_12.getBeginDate())
            return PSD_ALB2_2_2018_01_12.getAlbumVersion();
        elif (m_report.getRcbReport().context.period.endDate >= PSD_136_AVP_20170201.getBeginDate())
            return PSD_136_AVP_20170201.getAlbumVersion();
        elif (m_report.getRcbReport().context.period.endDate >= PTKPSD_2_2_4.getReleaseDate())
            return "alb2_2_4.doc от 01.10.2014";
        else
            return "";
        end;
    end;

    macro printDataZone()
        global.form.getApplication1().exportToPtkPsd();
        global.form.getApplication2().exportToPtkPsd();
        global.form.getApplication3().exportToPtkPsd();
        global.form.getApplication4().exportToPtkPsd();
        global.form.getApplication5().exportToPtkPsd();
        global.form.getApplication6().exportToPtkPsd();
    end;

    macro constructorTForPtkPsdExportController()
        initRcbPtkPsdExportController("фор", RcbReportBase(null, true));

         m_view = TPtkPsdView("фор", rcbApplication().currentReport.context.period.endDate + 1, "rsansi");
    end;

    constructorTForPtkPsdExportController();
end;

/*Создаем единственный экземпляр класса*/
global.ptkPsdExportFile = TForPtkPsdExportController();
