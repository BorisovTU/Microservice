/*
$Name:          TApplication.mac
$Module:        Регламентируемая отчетность
$Description:   Классы приложений ФОР
*/
/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Классы приложений ФОР

  Создан: 20.04.2007 - Ser.
└─────────────────────────────────────────────────────────────────────────────────────────────────*/
/***************************************************************************************************
 *  Базовый класс приложений отчета
 **************************************************************************************************/
class TApplication()
    const GORIZONTAL_BOUNDARY = 196;    //196 - ASCII-код символа "─"

    private var m_name            : String;
    private var m_balanceMasksSet : TRcbSet;
    private var m_reportWidth     : Integer;
    private var m_report          : Object = RcbApplication().currentReport;
    private var m_rows                     = TArray();
    private var m_numberDatesInOneBlock    = 0;
    private var m_isFistBlock              = true;
    private var m_applicationLength        = null;

    private macro unionArray(arr1, arr2)
        var i = 0;
        while (i < arr1.size)
            arr1[i] = arr1[i] + arr2[i];
            i = i + 1;
        end;
    end;

    private macro printArray(stringArray : TArray)
        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    private macro getPeriod()
        var month : String = "";
        var year  : String = "";
        if (видПериода == RCB_PK_MONTH)
            dateSplit(global.parameters.getBeginDate(), NULL, month, year);

            return StrLwr(monName(Int(month))) + " " + string(year) + " г.";
        else
            return String("за период с ", global.parameters.getBeginDate():f," по ", (global.parameters.getEndDate() + 1):f );
        end;
    end;

    //формирование строки требуемой длины из требуемого символа
    macro getStringOfChar(char, strLength) : String
        var s = "";

        for (var i, 1, strLength, 1)
            if (ValType(char) == V_STRING)
                s = s + char;
            elif (ValType(char) == V_INTEGER)
                s = s + StrFor(char);
            end;
        end;

        return s;
    end;

    //печать даты отчета
    private macro printPeriod()
        const template1 = "за ";
        const template2 = "за период с ";
        const template3 = " года";

        var month : String = "";
        var year  : String = "";
        var dateString     = "";
        var dateWidth      = 0;
        var pre            = "";  //пустая (пробельная) подстрока перед выводом подчеркивания

        if (видПериода == RCB_PK_MONTH)
            dateSplit(global.parameters.getBeginDate(), NULL, month, year);

            dateString = StrLwr(monName(Int(month))) + " " + string(year);
            dateWidth  = StrLen(dateString);
            pre = getStringOfChar(" ", (m_applicationLength - (StrLen(template1) + dateWidth + StrLen(template3)))/2);

            printLn(pre + template1 + dateString + template3);
            printLn(pre + getStringOfChar(" ", StrLen(template1)) + getStringOfChar(GORIZONTAL_BOUNDARY, dateWidth));
        else
            dateString = String(global.parameters.getBeginDate():f," по ", (global.parameters.getEndDate() + 1):f);
            dateWidth  = StrLen(dateString);
            pre = getStringOfChar(" ", (m_applicationLength - (StrLen(template2) + dateWidth))/2);

            printLn(pre + template2 + dateString);
            printLn(pre + getStringOfChar(" ", StrLen(template2)) + getStringOfChar(GORIZONTAL_BOUNDARY, dateWidth));
        end;
    end;

    //печать наименования кредитной организации
    private macro printNameLendingAgency()
        var attrTitle = ternary(global.parameters.getEndDate() < RCB_I1951_DATE,
                                "Наименование кредитной организации ",
                                "Полное или сокращенное фирменное наименование кредитной организации ");
        var arr = strTransferByWord(attrTitle + {Name_Bank}, m_applicationLength);
        var pre = "";  //пустая (пробельная) подстрока перед выводом подчеркивания

        printLn();

        var i = 0;

        while (i < arr.size)
            printLn(arr[i]);
            if (i == 0)
                pre = getStringOfChar(" ", StrLen(attrTitle));
                printLn(pre + getStringOfChar(GORIZONTAL_BOUNDARY, StrLen(arr[i]) - StrLen(attrTitle)));
            else
                pre = "";
                printLn(pre + getStringOfChar(GORIZONTAL_BOUNDARY, StrLen(trim(arr[i]))));
            end;

            i = i + 1;
        end;
    end;

    //печать почтового адреса КО
    private macro printPostalAddress()
        var addressTitle = "Почтовый адрес ";
        var arr = strTransferByWord(addressTitle + TNamesZone().getLendingAgencyPostalAdress(), m_applicationLength);
        var pre = "";  //пустая (пробельная) подстрока перед выводом подчеркивания

        var i = 0;

        while (i < arr.size)
            printLn(arr[i]);
            if (i == 0)
                pre = getStringOfChar(" ", StrLen(addressTitle));
                printLn(pre + getStringOfChar(GORIZONTAL_BOUNDARY, StrLen(arr[i]) - StrLen(addressTitle)));
            else
                pre = "";
                printLn(pre + getStringOfChar(GORIZONTAL_BOUNDARY, StrLen(trim(arr[i]))));
            end;

            i = i + 1;
        end;
    end;

    private macro getDateAsString(reportDate : Date) : String
        if (in(reportDate, global.parameters.getBeginDate(), global.parameters.getEndDate() + 1))
            return String(reportDate:f) + "(1)";
        end;

        return String(reportDate:f) + "   ";
    end;

    private macro printHeader()
    end;

    private macro printBody(beginDateInBlock)
        var i : Integer = 0;
        while (i < m_rows.size)
            m_rows[i].print(ternary(m_applicationLength == null, m_reportWidth, m_applicationLength), beginDateInBlock, m_numberDatesInOneBlock);
            i = i + 1;
        end;
    end;

    private macro printFooter()
        var nameBoss  : String = {Name_Boss};
        var nameBook  : String = {Name_Book};
        var sign      : String = "       (подпись, ФИО)";
        var maxLength : Integer = max(strLen({Name_Boss}), strLen({Name_Book}));
        nameBoss = strRPad({Name_Boss}, maxLength, " ");
        nameBook = strRPad({Name_Book}, maxLength, " ");
        sign     = strLPad(sign       , maxLength + strLen(sign), " ");

        [                              ];
        [                              ];
        [Уполномоченные лица           ];
        [кредитной организации     #   ]((nameBoss + "______________________" + {FIO_Boss}):l);
        [                          #   ](sign);
        [МП                            ];
        [                          #   ]((nameBook + "______________________" + {FIO_Book}):l);
        [                          #   ](sign);
        [                              ];
    end;

    private macro initializeBalanceMasksSet()
        var set = TRcbSet();

        macro fillSet(str : String)
            var pos : Integer = index(str, ",");

            if (pos > 0)
                while (pos > 0)
                    set.insert(trim(substr(str, 1, pos - 1)));
                    str = trim(substr(str, pos + 1));
                    pos = index(str, ",");
                end;
            end;

            if (str != "")
                set.insert(trim(str));
            end;
        end;

        var i = 0;
        while (i < m_rows.size)
            fillSet(m_rows[i].getBalanceMasks());
            fillSet(m_rows[i].getDecodingBalanceMasks());
            i = i + 1;
        end;

        m_balanceMasksSet = set;
    end;

    macro getName()
        return m_name;
    end;

    private macro getValueIterator(isFilter : bool)

        var attributeValue = m_report.attributeValue(m_name);
        var iterator = attributeValue.createValueIterator();

        if (isFilter)
            iterator.setFilter(FILTER_FOR_NONZERO_REST);
        end;

        return iterator;
    end;

    macro isEmpty()
        if ((m_name == "Приложение1") or (m_name == "ОтчетОбОтсутствииОстатков"))
            return false;
        end;

        return getValueIterator(true).count == 0;
    end;

    private macro printBlocks()

        var fistDateInBlock = global.parameters.getBeginDate();

        if ((m_name == "Приложение1") or (m_name == "ОтчетОбОтсутствииОстатков"))
            printHeader();
            printBody();
            printFooter();
        else
            while (fistDateInBlock <= global.parameters.getEndDate() + 1)
                printHeader(fistDateInBlock);
                printBody(fistDateInBlock);
                fistDateInBlock = fistDateInBlock + m_numberDatesInOneBlock;
            end;
            printFooter();
        end;
    end;

    macro print()
        var iterator : Object = NULL;
        if (m_name == "Приложение1")
            iterator = getValueIterator(false);
            iterator.moveFirst();
            if (iterator.isDone())
                RepErrorsQueue().add(0, "Операция печати ФОР. Для выполнения операции печати необходимо рассчитать отчет.");
                msgBox("Операция печати ФОР. Для выполнения операции печати необходимо рассчитать отчет.");
                установитьФлагВозврата(STOP_PROC_FLG);
                exit(1);
            end;
        end;

        if ((not isEmpty) or (global.parameters.isPrintApplicationZero()))
            printBlocks();
        end;
    end;

    macro fillTempTable(tempTable : TTempTable)
        var i = 0;
        while (i < m_rows.size)
            m_rows[i].fillTempTable(tempTable);
            i = i + 1;
        end;
    end;

    macro fillTempTableForBalanceData(tempTable : TTempTable)
        var i = 0;
        while (i < m_rows.size)
            m_rows[i].fillTempTableForBalanceData(tempTable);
            i = i + 1;
        end;
    end;

    macro normalizeDecoding()
        var i = 0;
        while (i < m_rows.size)
            m_rows[i].normalizeDecoding();
            i = i + 1;
        end;
    end;

    macro getBalanceMasksSet()
        if (m_balanceMasksSet == NULL)
            initializeBalanceMasksSet();
        end;
        return m_balanceMasksSet;
    end;

    macro getRow(code : String)
        var i = 0;
        while (i < m_rows.size)
            if (m_rows[i].getCode == code)
                return m_rows[i];
            end;
            i = i + 1;
        end;

        return NULL;
    end;

    macro saveAttributes()
        var i = 0;

        while (i < m_rows.size)
            m_rows[i].saveAttributes();
            i = i + 1;
        end;
    end;

    macro completeAttributes()
        var i = 0;

        while (i < m_rows.size)
            m_rows[i].completeAttributes();
            i = i + 1;
        end;
    end;

    macro exportToPtkPsd()
        var i = 0;

        while (i < m_rows.size)
            m_rows[i].exportToPtkPsd();
            i = i + 1;
        end;
    end;

    macro exportToKliko()
        var i = 0;

        while (i < m_rows.size)
            m_rows[i].exportToKliko();
            i = i + 1;
        end;
    end;

    macro calculateNumberBlocks()
        m_reportWidth           = global.parameters.getReportLength();
        m_numberDatesInOneBlock = int((m_reportWidth-50)/30);
        var dateCount           = global.parameters.getEndDate() + 2 - global.parameters.getBeginDate();
        if (m_numberDatesInOneBlock > dateCount)
            m_numberDatesInOneBlock = dateCount;
        end;
    end;

    //печать заголовка приложения
    macro printApplicationTitle()
        var strArray = StrCut(global.getAppTitle(m_name), "\n", false);
        for (var counter, 0, strArray.Size - 1)
            printLn(strAlign(strArray(counter), m_applicationLength, STR_ALIGN_CENTER));
        end;
    end;
end;


/***************************************************************************************************
 *  Класс Приложения 1
 **************************************************************************************************/
class (TApplication) TApplication1()
    initTApplication();

    m_reportWidth = 80;

    private macro printHeader()
        [                                                                  Приложение 1 ];
        [                                                      к Положению Банка России ];
        [                                                 от 29 марта 2004 года № 255-П ];
        [                                                     "Об обязательных резервах ];
        [                                                        кредитных организаций" ];
        [                                                                               ];
        [           ┌──────────┬───────────────────────────────────────────────────────┐];
        [           │   Код    │          Код кредитной организации(филиала)           │];
        [           │территории├──────────┬───────────────┬───────────────┬────────────┤];
        [           │ по ОКАТО │ по ОКПО  │   Основной    │Регистрационный│    БИК     │];
        [           │          │          │государственный│     номер     │            │];
        [           │          │          │регистрационный│               │            │];
        [           │          │          │    номер      │               │            │];
        [           ├──────────┼──────────┼───────────────┼───────────────┼────────────┤];
        [           │##########│##########│###############│###############│############│](Код_СОАТО:c, Код_ОКПО:c, ОГРН:c,   РегНомерБанка:c, {MFO_Bank}:c );
        [           └──────────┴──────────┴───────────────┴───────────────┴────────────┘];
        [                                                                               ];
        [                        РАСЧЕТ РАЗМЕРА ОБЯЗАТЕЛЬНЫХ РЕЗЕРВОВ,                  ];
        [                       ПОДЛЕЖАЩИХ ДЕПОНИРОВАНИЮ В БАНКЕ РОССИИ                 ];
        [                                          #                                    ](getPeriod():c );
        [                                                                               ];

        printNameLendingAgency();

        [ ############################################################################# ]("Почтовый адрес " + TNamesZone().getLendingAgencyPostalAdress():w);
        [                                                                               ];
        [                                                                    Ежемесячно ];
        [                                                                     тыс. руб. ];
    end;

    macro exportToKliko()
        var valueArray = TArray();

        global.klikoExportFile.printID("<F_P1M>");

        valueArray[valueArray.size] = "NBNR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNotresidentLendingAgencyRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NFLR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNaturalPersonRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NIOR";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getOthersRouble() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NBNV";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getNotresidentLendingAgencyCurrency() * 100;
        global.klikoExportFile.printString(valueArray);

        valueArray.size = 0;
        valueArray[valueArray.size] = "NIOV";
        valueArray[valueArray.size] = "";
        valueArray[valueArray.size] = global.parameters.getReservation().getOthersCurrency() * 100;
        global.klikoExportFile.printString(valueArray);

        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение1";
        m_rows[m_rows.size] = TApplicationRow1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow1_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow1_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_5(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_6(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_7(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_8(m_name);
        m_rows[m_rows.size] = TApplicationRow1_2_9(m_name);
        m_rows[m_rows.size] = TApplicationRow1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow1_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow1_4_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_4_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow1_5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow1_6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_7(m_name);
        m_rows[m_rows.size] = TApplicationRow1_7_1(m_name);
        m_rows[m_rows.size] = TApplicationRow1_7_2(m_name);
        m_rows[m_rows.size] = TApplicationRow1_8(m_name);
        m_rows[m_rows.size] = TApplicationRow1_9(m_name);
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 2
 **************************************************************************************************/
class (TApplication) TApplication2()
    initTApplication();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + String(restDate:f) + "        │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/
                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по балансовому счету,", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("по коду обозначения расшиф-",   m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("ровки на каждую календарную",   m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[4] = substr(stringArray[4], 1, POS) + strAlign("дату отчетного периода",        m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │      Наименование показателя,           │";
            stringArray[stringArray.size] = "│строки│      номер балансового счета            │";
            stringArray[stringArray.size] = "│      │          второго порядка                │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                 Приложение 2 ", m_applicationLength, " "));
            printLn(strLpad("     к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 29 марта 2004 года № 255-П ", m_applicationLength, " "));
            printLn(strLpad("   \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("      кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printLn(strAlign("ДАННЫЕ ОБ ОСТАТКАХ РЕЗЕРВИРУЕМЫХ ОБЯЗАТЕЛЬСТВ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign(getPeriod(), m_applicationLength, STR_ALIGN_CENTER));

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro exportToKliko()
        global.klikoExportFile.printID("<F_P2>");
        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4_1(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 2 после 1827У
 **************************************************************************************************/
class (TApplication2) TApplication2_1827()
    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1827(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1827(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4_1(m_name);

        calculateNumberBlocks();
    end;

    initTApplication2();
end;

/***************************************************************************************************
 *  Класс Приложения 2 после 1951У
 **************************************************************************************************/
class (TApplication2_1827) TApplication2_1951()
    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1827(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1951(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2_1951(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4_1(m_name);

        calculateNumberBlocks();
    end;

    initTApplication2_1827();
end;

/***************************************************************************************************
 *  Класс Приложения 2 после 2184У
 **************************************************************************************************/
class (TApplication2_1951) TApplication2_2184()
    macro constructor()
        m_name = "Приложение2";
        m_rows[m_rows.size] = TApplicationRow2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_1_6(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_2184(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_2_2(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2184(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_2_1951(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_3(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_3_5(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4(m_name);
        m_rows[m_rows.size] = TApplicationRow2_4_1(m_name);

        calculateNumberBlocks();
    end;

    initTApplication2_1827();
end;

/***************************************************************************************************
 *  Класс Приложения 3 до 1951У
 **************************************************************************************************/
class (TApplication) TApplication3()
    initTApplication();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + String(restDate:f) + "        │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/
                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по отдельному лицево-", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("му счету, по коду обозначения", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("расшифровки на каждую кален-",  m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[4] = substr(stringArray[4], 1, POS) + strAlign("дарную дату отчетного периода", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │      Наименование показателя,           │";
            stringArray[stringArray.size] = "│строки│      номер балансового счета            │";
            stringArray[stringArray.size] = "│      │          второго порядка                │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                 Приложение 3 ", m_applicationLength, " "));
            printLn(strLpad("     к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 29 марта 2004 года № 255-П ", m_applicationLength, " "));
            printLn(strLpad("   \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("      кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printLn(strAlign("РАСШИФРОВКА БАЛАНСОВЫХ СЧЕТОВ ПО УЧЕТУ ДЕНЕЖНЫХ СРЕДСТВ,",  m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("ПРИВЛЕЧЕННЫХ ОТ ЮРИДИЧЕСКИХ ЛИЦ НА СРОК НЕ МЕНЕЕ ТРЕХ ЛЕТ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign(getPeriod(), m_applicationLength, STR_ALIGN_CENTER));

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro exportToKliko()
        global.klikoExportFile.printID("<F_P3>");
        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение3";
        m_rows[m_rows.size] = TApplicationRow3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_3(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_4(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 3 после 1951У
 **************************************************************************************************/
class (TApplication3) TApplication3_1951()
    initTApplication3();

    macro constructor()
        m_name = "Приложение3";
        m_rows[m_rows.size] = TApplicationRow3_1(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_1__1951U(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_2(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_3__1951U(m_name);
        m_rows[m_rows.size] = TApplicationRow3_1_4(m_name);

        calculateNumberBlocks();
    end;
end;

/***************************************************************************************************
 *  Класс Приложения 5
 **************************************************************************************************/
class (TApplication) TApplication5()
    initTApplication();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + String(restDate:f) + "        │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/

                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по балансовому счету,", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("отдельному лицевому счету ба-", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("лансового счета, коду обозна-", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[4] = substr(stringArray[4], 1, POS) + strAlign("чения расшифровки на каждую",   m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[5] = substr(stringArray[5], 1, POS) + strAlign("календарную дату отчетного",    m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[6] = substr(stringArray[6], 1, POS) + strAlign("периода (1)",                   m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │      Наименование показателя,           │";
            stringArray[stringArray.size] = "│строки│      номер балансового счета            │";
            stringArray[stringArray.size] = "│      │          второго порядка                │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                 Приложение 5 ", m_applicationLength, " "));
            printLn(strLpad("     к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 29 марта 2004 года № 255-П ", m_applicationLength, " "));
            printLn(strLpad("   \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("      кредитных организаций\" ", m_applicationLength, " "));
            printLn();



            printLn(strAlign("РАСШИФРОВКА БАЛАНСОВЫХ СЧЕТОВ ПО УЧЕТУ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("ВЫПУЩЕННЫХ ЦЕННЫХ БУМАГ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign(getPeriod(), m_applicationLength, STR_ALIGN_CENTER));

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro exportToKliko()
        global.klikoExportFile.printID("<F_P5>");
        exportToKliko();
    end;

    macro constructor()
        m_name = "Приложение5";
        m_rows[m_rows.size] = TApplicationRow5_1(m_name);
        m_rows[m_rows.size] = TApplicationRow5_1_1(m_name);
        m_rows[m_rows.size] = TApplicationRow5_2(m_name);
        m_rows[m_rows.size] = TApplicationRow5_2_1(m_name);
        m_rows[m_rows.size] = TApplicationRow5_3(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 6
 **************************************************************************************************/
class (TApplication) TApplication6()
    initTApplication();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────┬";
                arr[arr.size] = "              │";
                arr[arr.size] = "на " + String(restDate:f) + " │";
                arr[arr.size] = "              │";
                arr[arr.size] = "──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number + 1), 2, " ") + "       │";

                return arr;
            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │        Наименование показателя,         │";
            stringArray[stringArray.size] = "│строки│        номер балансового счета          │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
        m_isFistBlock = false;
            printLn(strLpad("                 Приложение 6 ", m_applicationLength, " "));
            printLn(strLpad("     к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 29 марта 2004 года № 255-П ", m_applicationLength, " "));
            printLn(strLpad("   \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("      кредитных организаций\" ", m_applicationLength, " "));
            printLn();
            printLn(strAlign("РАСЧЕТ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("ВЕЛИЧИНЫ НАЛИЧНЫХ ДЕНЕЖНЫХ СРЕДСТВ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("В ВАЛЮТЕ РОССИЙСКОЙ ФЕДЕРАЦИИ В КАССЕ, ИСКЛЮЧАЕМЫХ ПРИ РАСЧЕТЕ НОРМАТИВНОЙ ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("ВЕЛИЧИНЫ ОБЯЗАТЕЛЬНЫХ РЕЗЕРВОВ ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign(getPeriod(), m_applicationLength, STR_ALIGN_CENTER));

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro exportToKliko()
        global.klikoExportFile.printID("<F_P6>");
        exportToKliko();
    end;

    macro calculateNumberBlocks()
        m_reportWidth  = global.parameters.getReportLength();
        if (m_reportWidth < 80)
            RepErrorsQueue().add(0, "Для Приложения 6 ширина отчета не может быть меньше 80, измените величину настройки REPTREG/REP_GROUPS/COMMON/ШИРИНА_ОТЧЕТА.");
            msgBox("Для Приложения 6 ширина отчета не может быть меньше 80, измените величину настройки REPTREG/REP_GROUPS/COMMON/ШИРИНА_ОТЧЕТА.");
            exit(1);
        end;
        m_numberDatesInOneBlock = int((m_reportWidth-50)/15);
        var dateCount = global.parameters.getEndDate() + 2 - global.parameters.getBeginDate();
        if (m_numberDatesInOneBlock > dateCount)
            m_numberDatesInOneBlock = dateCount;
        end;
    end;

    macro constructor()
        m_name = "Приложение6";
        m_rows[m_rows.size] = TApplicationRow6_1(m_name);
        m_rows[m_rows.size] = TApplicationRow6_2(m_name);
        m_rows[m_rows.size] = TApplicationRow6_3(m_name);
        m_rows[m_rows.size] = TApplicationRow6_4(m_name);
        m_rows[m_rows.size] = TApplicationRow6_5(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс Приложения 7
 **************************************************************************************************/
class (TApplication) TApplication7()
    initTApplication();

    private macro printHeader(beginDateInBlock)
        var stringArray = TArray();
        macro makeHeader(beginDateInBlock)
            macro closeTable()
                var arr = TArray;
                arr[arr.size] = "┐";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "│";
                arr[arr.size] = "┤";
                arr[arr.size] = "│";
                var i : Integer = 0;
                while (i < stringArray.size)
                    stringArray[i] = subStr(stringArray[i], 1, strLen(stringArray[i]) - 1);
                    i = i + 1;
                end;

                unionArray(stringArray, arr);
            end;

            macro getArray(restDate, number)
                var arr = TArray;
                arr[arr.size] = "──────────────────────────────";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "                              ";
                arr[arr.size] = "─────────────────────────────┬";
                arr[arr.size] = "        на " + String(restDate:f) + "        │";
                arr[arr.size] = "──────────────┬──────────────┼";
                arr[arr.size] = "  в рублях    │ иностранная  │";
                arr[arr.size] = "              │   валюта в   │";
                arr[arr.size] = "              │   рублевом   │";
                arr[arr.size] = "              │ эквиваленте  │";
                arr[arr.size] = "──────────────┼──────────────┼";
                arr[arr.size] = "     " + strLPad(String(number * 2 - 1), 2, " ") + "       │     " + strLPad(String(number * 2), 2, " ") +"       │";

                return arr;
            end;

            macro correctHeader()
                const  POS = 50;/*позиция начала вывода*/

                stringArray[1] = substr(stringArray[1], 1, POS) + strAlign("Остаток по отдельному лицево-", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[2] = substr(stringArray[2], 1, POS) + strAlign("му счету на каждую календар-",  m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";
                stringArray[3] = substr(stringArray[3], 1, POS) + strAlign("ную дату отчетного периода(1)", m_applicationLength - POS - 1, STR_ALIGN_CENTER) + "│";

            end;

            stringArray[stringArray.size] = "┌──────┬─────────────────────────────────────────┬";
            stringArray[stringArray.size] = "│Номер │      Наименование показателя,           │";
            stringArray[stringArray.size] = "│строки│      номер балансового счета            │";
            stringArray[stringArray.size] = "│      │          второго порядка                │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         ├";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "│      │                                         │";
            stringArray[stringArray.size] = "├──────┼─────────────────────────────────────────┼";
            stringArray[stringArray.size] = "│  1   │                    2                    │";

            var dateCount : Integer = m_numberDatesInOneBlock;
            var i         : Integer = 0;

            while ((i < dateCount) and (beginDateInBlock + i <= global.parameters.getEndDate() + 1))
                unionArray(stringArray, getArray(beginDateInBlock + i, i + 2));
                i = i + 1;
            end;

            m_applicationLength = strLen(stringArray[0]);
            correctHeader();
            closeTable();
        end;

        makeHeader(beginDateInBlock);

        if (m_isFistBlock)
            m_isFistBlock = false;
            printLn(strLpad("                 Приложение 7 ", m_applicationLength, " "));
            printLn(strLpad("     к Положению Банка России ", m_applicationLength, " "));
            printLn(strLpad("от 29 марта 2004 года № 255-П ", m_applicationLength, " "));
            printLn(strLpad("   \"Об обязательных резервах ", m_applicationLength, " "));
            printLn(strLpad("      кредитных организаций\" ", m_applicationLength, " "));
            printLn();

            printLn(strAlign("РАСШИФРОВКА ОТДЕЛЬНЫХ ОБЯЗАТЕЛЬСТВ,", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign("НЕ ПОДЛЕЖАЩИХ РЕЗЕРВИРОВАНИЮ", m_applicationLength, STR_ALIGN_CENTER));
            printLn(strAlign(getPeriod(), m_applicationLength, STR_ALIGN_CENTER));

            printNameLendingAgency();

            printLn(strLpad("      тыс. руб. ", m_applicationLength, " "));
        end;

        var i : Integer = 0;
        while (i < stringArray.size)
            println(stringArray[i]);
            i = i + 1;
        end;
    end;

    macro constructor()
        m_name = "Приложение7";
        m_rows[m_rows.size] = TApplicationRow7_1(m_name);
        m_rows[m_rows.size] = TApplicationRow7_2(m_name);
        m_rows[m_rows.size] = TApplicationRow7_3(m_name);

        calculateNumberBlocks();
    end;
    constructor();
end;

/***************************************************************************************************
 *  Класс отчета "ДАННЫЕ О ПРИЛОЖЕНИЯХ, НЕ ВОШЕДШИХ В СОСТАВ ОТЧЕТА"
 **************************************************************************************************/
class (TApplication) TApplication8()
    initTApplication();
    var m_printedReport : Object = CTableReport();

    private macro printHeader()
        var numberStringWidth            : Integer = 6;
        var applicationNumberStringWidth : Integer = 16;
        var balanceListStringWidth       : Integer = 80;

        m_reportWidth = 2 + numberStringWidth + 3 + applicationNumberStringWidth + 3 + balanceListStringWidth + 2;

        m_printedReport.addColumn("Номер|строки", numberStringWidth, AL_CENTER);
        m_printedReport.addColumn("Номер приложения" , applicationNumberStringWidth, AL_CENTER);
        m_printedReport.addColumn("Балансовые счета",  balanceListStringWidth);

        printLn();

        m_applicationLength = m_reportWidth;
        printApplicationTitle();
        printPeriod();

        printNameLendingAgency();

        var i : Integer = 0;
        var arr = strTransferByWord(" В связи с нулевыми значениями по балансовым счетам (отдельным лицевым счетам) в течение отчетного периода в состав отчетности не включаются следующие приложения к расчету по Положению об обязательных резервах:", m_reportWidth);
        printLn();
        while (i < arr.size)
        printLn(strAlign(arr[i], m_reportWidth, STR_ALIGN_LEFT));
            i = i + 1;
        end;

        m_printedReport.printHead();
    end;

    private macro printBody()
        var i : Integer = 0;
        while (i < m_rows.size)
            m_rows[i].print(m_printedReport);
            i = i + 1;
        end;
    end;

    macro constructor()
        m_name = "ОтчетОбОтсутствииОстатков";
        m_rows[m_rows.size] = TApplicationRow8_N(m_name);
    end;
    constructor();
end;
