/*
$Name:          TForm342.mac
$Module:        Регламентируемая отчетность
$Description:   Класс формы ФОР
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Класс формы ФОР по 342-П

  Создан: 22.10.2009 - Ser.
└─────────────────────────────────────────────────────────────────────────────────────────────────*/

class (TForm) TForm342
    initTForm();

    private var m_application4;

    private var m_balanceMasksSetForApplication4;

    macro getApplication4()
        return m_application4;
    end;

    private macro initializeSourceRows()
        m_sourceRows[m_sourceRows.size] = m_application1.getRow("5.1");
        m_sourceRows[m_sourceRows.size] = m_application1.getRow("5.2");
        m_sourceRows[m_sourceRows.size] = m_application2.getRow("1");
        m_sourceRows[m_sourceRows.size] = m_application2.getRow("2");
        m_sourceRows[m_sourceRows.size] = m_application2.getRow("3");
        m_sourceRows[m_sourceRows.size] = m_application2.getRow("3.2");
        m_sourceRows[m_sourceRows.size] = m_application3.getRow("1.1");
        m_sourceRows[m_sourceRows.size] = m_application3.getRow("1.3");
        m_sourceRows[m_sourceRows.size] = m_application4.getRow("1");
        m_sourceRows[m_sourceRows.size] = m_application5.getRow("1");
        m_sourceRows[m_sourceRows.size] = m_application6.getRow("1");
        m_sourceRows[m_sourceRows.size] = m_application6.getRow("2");
        m_sourceRows[m_sourceRows.size] = m_application6.getRow("3");
        m_sourceRows[m_sourceRows.size] = m_application8.getRow("-");
    end;

    private macro initializeDependencies()
        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("1.2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application1.getRow("1.3");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[3] = m_application1.getRow("1.4");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[4] = m_application1.getRow("1.5");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[5] = m_application1.getRow("1.6");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1.4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("2.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.5");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1.5");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("2.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("1.6"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.6");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.6");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("2.10");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("2.2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application1.getRow("2.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application5.getRow("5");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.6"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.4");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("2.5");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.7"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.8"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.5");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.9"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1.6");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("2.10"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.7");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("2.8");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application1.getRow("2.9");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("3.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("3.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("3.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.6");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("3.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("3.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.10");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("3.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("3.3"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("4.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("4.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("4.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.6");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("3.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("4.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.10");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("3.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("5.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("5.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("5.1"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("5.2"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("6"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("6.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("6.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("6.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("4.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("5.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("6.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("4.2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("5.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("7"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("7.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("7.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("7.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("5.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("4.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("7.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("5.2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("4.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("8"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("6");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("7");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application1.getRow("9"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("6");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("7");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application6.getRow("1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application6.getRow("2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application6.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application3.getRow("1.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application2.getRow("1.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1.4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("1.5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application6.getRow("1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application6.getRow("2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application6.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("2.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("2.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("2.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("2.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("2.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application2.getRow("2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application6.getRow("1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[3] = m_application6.getRow("2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[4] = m_application6.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application3.getRow("1.4");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application4.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application2.getRow("3.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application2.getRow("3.6"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3.4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application3.getRow("1"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application3.getRow("1.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application3.getRow("1.2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application3.getRow("1.1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application3.getRow("1.3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application3.getRow("1.4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application3.getRow("1.3");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application4.getRow("1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application2.getRow("3");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application2.getRow("3.2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application4.getRow("1.1"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application4.getRow("1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application4.getRow("2"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application4.getRow("3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application4.getRow("1.1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application4.getRow("2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application5.getRow("1"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application5.getRow("2"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application5.getRow("1");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application5.getRow("3"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application5.getRow("2");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application5.getRow("4"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("2.4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application5.getRow("5"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application5.getRow("3");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application5.getRow("4");

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application6.getRow("1"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application6.getRow("2"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application6.getRow("3"), TArray());

        m_rowsDependencies[m_rowsDependencies.size]      = TRcbPair(m_application8.getRow("-"), TArray());
        m_rowsDependencies[m_rowsDependencies.size - 1].second[0] = m_application1.getRow("1");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[1] = m_application1.getRow("2");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[2] = m_application1.getRow("3");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[3] = m_application1.getRow("4");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[4] = m_application1.getRow("5");
        m_rowsDependencies[m_rowsDependencies.size - 1].second[5] = m_application1.getRow("6");
    end;

    private macro makeBalanceMasks()
        var set = TRcbSet();

        macro fillSet(masks : TRcbSet)
            var iterator = masks.createIterator();

            iterator.moveFirst();
            while (not iterator.isDone())
                set.insert(iterator.getCurrentItem());
                iterator.moveNext();
            end;
        end;

        macro makeString()
            var iterator = set.createIterator();
            var masksString  : String = "";

            iterator.moveFirst();
            while (not iterator.isDone())
                masksString = masksString + "," + iterator.getCurrentItem();
                iterator.moveNext();
            end;

            return subStr(masksString, 2);
        end;


        var masksString = "";

        fillSet(m_balanceMasksSetForApplication1);
        fillSet(m_balanceMasksSetForApplication2);
        fillSet(m_balanceMasksSetForApplication3);
        fillSet(m_balanceMasksSetForApplication4);
        fillSet(m_balanceMasksSetForApplication5);
        fillSet(m_balanceMasksSetForApplication6);
        m_balanceMasks = makeString();
    end;

    private macro initializeMasksSet()
        m_balanceMasksSetForApplication1 = m_application1.getBalanceMasksSet();
        m_balanceMasksSetForApplication2 = m_application2.getBalanceMasksSet();
        m_balanceMasksSetForApplication3 = m_application3.getBalanceMasksSet();
        m_balanceMasksSetForApplication4 = m_application4.getBalanceMasksSet();
        m_balanceMasksSetForApplication5 = m_application5.getBalanceMasksSet();
        m_balanceMasksSetForApplication6 = m_application6.getBalanceMasksSet();
    end;

    macro getMasksSetForApplication(applicationName : String)
        if (    (m_balanceMasksSetForApplication1 == NULL)
            and (m_balanceMasksSetForApplication2 == NULL)
            and (m_balanceMasksSetForApplication3 == NULL)
            and (m_balanceMasksSetForApplication4 == NULL)
            and (m_balanceMasksSetForApplication5 == NULL)
            and (m_balanceMasksSetForApplication6 == NULL))
            initializeMasksSet();
        end;

        if (applicationName == "Приложение1")
            return m_balanceMasksSetForApplication1;
        elif (applicationName == "Приложение2")
            return m_balanceMasksSetForApplication2;
        elif (applicationName == "Приложение3")
            return m_balanceMasksSetForApplication3;
        elif (applicationName == "Приложение4")
            return m_balanceMasksSetForApplication4;
        elif (applicationName == "Приложение5")
            return m_balanceMasksSetForApplication5;
        elif (applicationName == "Приложение6")
            return m_balanceMasksSetForApplication6;
        end;
    end;

    private macro fillTempTable(tempTable : TTempTable)

        if (global.parameters.isDataBalance())
            m_application6.fillTempTableForBalanceData(tempTable);
            m_application2.fillTempTableForBalanceData(tempTable);
            m_application3.fillTempTableForBalanceData(tempTable);
            m_application4.fillTempTableForBalanceData(tempTable);
            m_application5.fillTempTableForBalanceData(tempTable);
        else
            m_application6.fillTempTable(tempTable);
            m_application2.fillTempTable(tempTable);
            m_application3.fillTempTable(tempTable);
            m_application4.fillTempTable(tempTable);
            m_application5.fillTempTable(tempTable);
        end;
    end;

    private macro saveAttributes()
        m_application1.saveAttributes();
        m_application2.saveAttributes();
        m_application4.saveAttributes();
        m_application3.saveAttributes();
        m_application5.saveAttributes();
        m_application6.saveAttributes();
        m_application8.saveAttributes();
    end;

    private macro normalizeDecoding()
        m_application1.normalizeDecoding();
        m_application2.normalizeDecoding();
        m_application4.normalizeDecoding();
        m_application3.normalizeDecoding();
        m_application5.normalizeDecoding();
        m_application6.normalizeDecoding();
        m_application8.normalizeDecoding();
    end;

    macro print()
        initProgress(-1, "Печать Приложения 1", "Печать Приложения 1");
        m_application1.print();
        remProgress();

        initProgress(-1, "Печать Приложения 2", "Печать Приложения 2");
        m_application2.print();
        remProgress();

        initProgress(-1, "Печать Приложения 3", "Печать Приложения 3");
        m_application3.print();
        remProgress();

        initProgress(-1, "Печать Приложения 4", "Печать Приложения 4");
        m_application4.print();
        remProgress();

        initProgress(-1, "Печать Приложения 5", "Печать Приложения 5");
        m_application5.print();
        remProgress();

        initProgress(-1, "Печать Приложения 6", "Печать Приложения 6");
        m_application6.print();
        remProgress();

        initProgress(-1, "Печать данных о приложениях, не вошедших в состав отчета", "Печать данных о приложениях, не вошедших в состав отчета");
        m_application8.print();
        remProgress();
    end;

    macro recalculateItogValues(isCalcMethod : Bool)
        var isCalculateMethod = nvl(isCalcMethod, true);
        const ARG_LABEL  = "-isCalculateMethod:";

        if (index(cmdArgs, ARG_LABEL) > 0)
            isCalculateMethod = int(SubStr(CmdArgs, index(cmdArgs, ARG_LABEL) + strlen(ARG_LABEL), 1));
        end;

        m_isRecalculationInProcess = true;

        initProgress(-1, "Удаление итоговых значений", "Удаление итоговых значений");
        var i : Integer = 0;

        while (i < m_rowsDependencies.size)
            if (isSourceRow(m_rowsDependencies[i].first))
                m_rowsDependencies[i].first.setSaved(true);
            else
                m_rowsDependencies[i].first.setSaved(false);
                m_rowsDependencies[i].first.removeValues();
            end;

            i = i + 1;
        end;
        remProgress();

        initProgress(-1, "Обновление значений по данным формы \"Балансовые счета\"", "Обновление значений по данным формы \"Балансовые счета\"");

        if (not isCalculateMethod)
            m_application2.updateBalanceValues();
            m_application4.updateBalanceValues();
            m_application3.updateBalanceValues();
            m_application5.updateBalanceValues();
            m_application6.updateBalanceValues();
        end;

        remProgress();

        initProgress(-1, "Нормализация расшифровок", "Нормализация расшифровок");
        normalizeDecoding();
        remProgress();

        initProgress(-1, "Пересчет итоговых значений", "Пересчет итоговых значений");
        saveAttributes();
        remProgress();

        if (not isCalculateMethod)
            initProgress(-1, "Сохранение итоговых значений", "Сохранение итоговых значений");
            rcbApplication().transactionManager.commit();
            remProgress();
        end;

        m_isRecalculationInProcess = true;
    end;

    private macro constructor()

        m_application1 = TApplication342_1();
        m_application2 = TApplication342_2();
        m_application3 = TApplication342_3();
        m_application4 = TApplication342_4();
        m_application5 = TApplication342_5();
        m_application6 = TApplication342_6();
        m_application8 = TApplication342_8();
        initializeDependencies();
    end;
end;

class (TForm342) TForm2341
    initTForm342();

    private macro constructor()
        m_application1 = TApplication342_1();
        m_application2 = TApplication2__2341();
        m_application3 = TApplication342_3();
        m_application4 = TApplication4__2341();
        m_application5 = TApplication342_5();
        m_application6 = TApplication342_6();
        m_application8 = TApplication342_8();
        initializeDependencies();
    end;
end;

class (TForm2341) TForm2963
    initTForm2341();

    private macro constructor()
        m_application1 = TApplication342_1_2963();
        m_application2 = TApplication2__2963();
        m_application3 = TApplication342_3();
        m_application4 = TApplication4__2341();
        m_application5 = TApplication342_5();
        m_application6 = TApplication342_6_2963();
        m_application8 = TApplication342_8();
        initializeDependencies();
    end;

    private macro saveAttributes()
        m_application1.saveAttributes();

        m_application2.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application2.completeAttributes();
        end;

        m_application4.saveAttributes();

        m_application3.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application3.completeAttributes();
        end;

        m_application5.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application5.completeAttributes();
        end;

        m_application6.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application6.completeAttributes();
        end;

        m_application8.saveAttributes();
    end;

    private macro normalizeDecoding()
        if (global.parameters.isOverallNormalizationDisabled())
            return;
        end;

        m_application1.normalizeDecoding();
        m_application2.normalizeDecoding();
        m_application4.normalizeDecoding();
        m_application3.normalizeDecoding();
        m_application5.normalizeDecoding();
        m_application6.normalizeDecoding();
        m_application8.normalizeDecoding();

        /**
         * Нормализация по приложению 2 и 6
         */

         //рубли
        var normalizer = TForNormalizer(RcbApplication.currentReport.multiplier);
        var normalizerWithCondition = TForNormalizerWithCondition(RcbApplication.currentReport.multiplier);

        var balanceIterator = normalizer.getBalanceIterator("Приложение2");
        var prevBalanceTranscript = "";
        var balance;

        while (not balanceIterator.isDone())

            var balanceTranscript = balanceIterator.currentItem.fieldValue("balance").current;
            if (prevBalanceTranscript == balanceTranscript)
                balanceIterator.next();
                continue;
            end;

            if (balanceTranscript == "409011")
                balance = "40901";
            else
                balance = "40902";
            end;

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 true,
                                 RCB_RS_EQUAL
                                );

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 true,
                                 RCB_RS_EQUAL
                                );

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 false,
                                 RCB_RS_EQUAL
                                );

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 false,
                                 RCB_RS_EQUAL
                                );

            prevBalanceTranscript = balanceTranscript;
            balanceIterator.moveNext();
        end;

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("47431"),
                               true,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409021"),
                                                     TDecodingData("Приложение6", "1",   "40902" ),
                                                     TDecodingData("Приложение6", "2",   "40902" ),
                                                     TDecodingData("Приложение6", "3",   "40902" )),
                               RcbArray().initialize("47410"),
                               true,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" ),
                                                     TDecodingData("Приложение2", "3.2", "409021"),
                                                     TDecodingData("Приложение6", "1",   "40902" ),
                                                     TDecodingData("Приложение6", "2",   "40902" ),
                                                     TDecodingData("Приложение6", "3",   "40902" )),
                               RcbArray().initialize("47431", "47410"),
                               true,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40901"),
                                                     TDecodingData("Приложение2", "2", "40901"),
                                                     TDecodingData("Приложение2", "3", "40901"),
                                                     TDecodingData("Приложение6", "1", "40901"),
                                                     TDecodingData("Приложение6", "2", "40901"),
                                                     TDecodingData("Приложение6", "3", "40901")),
                               RcbArray().initialize("40901"),
                               true,
                               RCB_RS_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40902"),
                                                     TDecodingData("Приложение2", "2", "40902"),
                                                     TDecodingData("Приложение2", "3", "40902"),
                                                     TDecodingData("Приложение6", "1", "40902"),
                                                     TDecodingData("Приложение6", "2", "40902"),
                                                     TDecodingData("Приложение6", "3", "40902")),
                               RcbArray().initialize("40902"),
                               true,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30420", "30421"),
                               RcbArray().initialize("30416", "30417"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304211"),
                                                     TDecodingData("Приложение6", "1", "30420" ),
                                                     TDecodingData("Приложение6", "2", "30420" ),
                                                     TDecodingData("Приложение6", "3", "30420" ),
                                                     TDecodingData("Приложение6", "1", "30421" ),
                                                     TDecodingData("Приложение6", "2", "30421" ),
                                                     TDecodingData("Приложение6", "3", "30421" )),
                               RcbArray().initialize("30420", "30421", "-30416", "-30417"),
                               true,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30422", "30423"),
                               RcbArray().initialize("30418", "30419"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304231"),
                                                     TDecodingData("Приложение6", "1", "30422" ),
                                                     TDecodingData("Приложение6", "2", "30422" ),
                                                     TDecodingData("Приложение6", "3", "30422" ),
                                                     TDecodingData("Приложение6", "1", "30423" ),
                                                     TDecodingData("Приложение6", "2", "30423" ),
                                                     TDecodingData("Приложение6", "3", "30423" )),
                               RcbArray().initialize("30422", "30423", "-30418", "-30419"),
                               true,
                               RCB_RS_EQUAL);

        //валюта
        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("47431"),
                               false,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409021"),
                                                     TDecodingData("Приложение6", "1",   "40902" ),
                                                     TDecodingData("Приложение6", "2",   "40902" ),
                                                     TDecodingData("Приложение6", "3",   "40902" )),
                               RcbArray().initialize("47410"),
                               false,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" ),
                                                     TDecodingData("Приложение2", "3.2", "409021"),
                                                     TDecodingData("Приложение6", "1",   "40902" ),
                                                     TDecodingData("Приложение6", "2",   "40902" ),
                                                     TDecodingData("Приложение6", "3",   "40902" )),
                               RcbArray().initialize("47431", "47410"),
                               false,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40901"),
                                                     TDecodingData("Приложение2", "2", "40901"),
                                                     TDecodingData("Приложение2", "3", "40901"),
                                                     TDecodingData("Приложение6", "1", "40901"),
                                                     TDecodingData("Приложение6", "2", "40901"),
                                                     TDecodingData("Приложение6", "3", "40901")),
                               RcbArray().initialize("40901"),
                               false,
                               RCB_RS_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40902"),
                                                     TDecodingData("Приложение2", "2", "40902"),
                                                     TDecodingData("Приложение2", "3", "40902"),
                                                     TDecodingData("Приложение6", "1", "40902"),
                                                     TDecodingData("Приложение6", "2", "40902"),
                                                     TDecodingData("Приложение6", "3", "40902")),
                               RcbArray().initialize("40902"),
                               false,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30420", "30421"),
                               RcbArray().initialize("30416", "30417"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304211"),
                                                     TDecodingData("Приложение6", "1", "30420" ),
                                                     TDecodingData("Приложение6", "2", "30420" ),
                                                     TDecodingData("Приложение6", "3", "30420" ),
                                                     TDecodingData("Приложение6", "1", "30421" ),
                                                     TDecodingData("Приложение6", "2", "30421" ),
                                                     TDecodingData("Приложение6", "3", "30421" )),
                               RcbArray().initialize("30420", "30421", "-30416", "-30417"),
                               false,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30422", "30423"),
                               RcbArray().initialize("30418", "30419"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304231"),
                                                     TDecodingData("Приложение6", "1", "30422" ),
                                                     TDecodingData("Приложение6", "2", "30422" ),
                                                     TDecodingData("Приложение6", "3", "30422" ),
                                                     TDecodingData("Приложение6", "1", "30423" ),
                                                     TDecodingData("Приложение6", "2", "30423" ),
                                                     TDecodingData("Приложение6", "3", "30423" )),
                               RcbArray().initialize("30422", "30423", "-30418", "-30419"),
                               false,
                               RCB_RS_EQUAL);

        normalizer.normalize();
        normalizerWithCondition.normalize();

    end;

end;

class (TForm2963) TForm_3115
    initTForm2963();

    private macro constructor()
        m_application1 = TApplication342_1_3115();
        m_application2 = TApplication2_3115();
        m_application3 = TApplication342_3_3115();
        m_application4 = TApplication4_3115();
        m_application5 = TApplication342_5_3115();
        m_application6 = TApplication342_6_3115();
        m_application8 = TApplication342_8_3115();
        initializeDependencies();
    end;

    private macro saveAttributes()
        m_application1.saveAttributes();

        m_application2.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application2.completeAttributes();
        end;

        m_application4.saveAttributes();

        m_application3.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application3.completeAttributes();
        end;

        m_application5.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application5.completeAttributes();
        end;

        m_application6.saveAttributes();
        if (not m_isRecalculationInProcess)
            m_application6.completeAttributes();
        end;

        m_application8.saveAttributes();

        RcbApplication().TransactionManager().commit();
    end;

    private macro normalizeDecoding()
        if (global.parameters.isOverallNormalizationDisabled())
            return;
        end;

        normalizationProtocol.beginProtocol();
        normalizationProtocolWithErrors.beginProtocol();

        m_application1.normalizeDecoding();
        m_application2.normalizeDecoding();
        m_application4.normalizeDecoding();
        m_application3.normalizeDecoding();
        m_application5.normalizeDecoding();
        m_application6.normalizeDecoding();
        m_application8.normalizeDecoding();

        /**
         * Нормализация по приложению 2 и 6
         */
         //рубли
        var normalizer = TForNormalizer(RcbApplication.currentReport.multiplier);
        var normalizerWithCondition = TForNormalizerWithCondition(RcbApplication.currentReport.multiplier);

        var balanceIterator = normalizer.getBalanceIterator("Приложение2");
        var prevBalanceTranscript = "";
        var balance;

        while (not balanceIterator.isDone())

            var balanceTranscript = balanceIterator.currentItem.fieldValue("balance").current;
            if (prevBalanceTranscript == balanceTranscript)
                balanceIterator.next();
                continue;
            end;

            balance = substr(balanceTranscript, 1, 5);

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 true,
                                 RCB_RS_EQUAL
                                );

            normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", balanceTranscript),
                                                       TDecodingData("Приложение6", "1", balance),
                                                       TDecodingData("Приложение6", "2", balance),
                                                       TDecodingData("Приложение6", "3", balance)
                                                      ),
                                 RcbArray().initialize(balance),
                                 false,
                                 RCB_RS_EQUAL
                                );

            prevBalanceTranscript = balanceTranscript;
            balanceIterator.moveNext();
        end;

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("47431", "47410"),
                               true,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("40901", "40902"),
                               true,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40901"),
                                                     TDecodingData("Приложение2", "2", "40901"),
                                                     TDecodingData("Приложение2", "3", "40901"),
                                                     TDecodingData("Приложение6", "1", "40901"),
                                                     TDecodingData("Приложение6", "2", "40901"),
                                                     TDecodingData("Приложение6", "3", "40901")),
                               RcbArray().initialize("40901"),
                               true,
                               RCB_RS_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40902"),
                                                     TDecodingData("Приложение2", "2", "40902"),
                                                     TDecodingData("Приложение2", "3", "40902"),
                                                     TDecodingData("Приложение6", "1", "40902"),
                                                     TDecodingData("Приложение6", "2", "40902"),
                                                     TDecodingData("Приложение6", "3", "40902")),
                               RcbArray().initialize("40902"),
                               true,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30420", "30421"),
                               RcbArray().initialize("30416", "30417"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304211"),
                                                     TDecodingData("Приложение6", "1", "30420" ),
                                                     TDecodingData("Приложение6", "2", "30420" ),
                                                     TDecodingData("Приложение6", "3", "30420" ),
                                                     TDecodingData("Приложение6", "1", "30421" ),
                                                     TDecodingData("Приложение6", "2", "30421" ),
                                                     TDecodingData("Приложение6", "3", "30421" )),
                               RcbArray().initialize("30420", "30421", "-30416", "-30417"),
                               true,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30422", "30423"),
                               RcbArray().initialize("30418", "30419"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304231"),
                                                     TDecodingData("Приложение6", "1", "30422" ),
                                                     TDecodingData("Приложение6", "2", "30422" ),
                                                     TDecodingData("Приложение6", "3", "30422" ),
                                                     TDecodingData("Приложение6", "1", "30423" ),
                                                     TDecodingData("Приложение6", "2", "30423" ),
                                                     TDecodingData("Приложение6", "3", "30423" )),
                               RcbArray().initialize("30422", "30423", "-30418", "-30419"),
                               true,
                               RCB_RS_EQUAL);

        //валюта
        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("47431", "47410"),
                               false,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "3.2", "409011"),
                                                     TDecodingData("Приложение6", "1",   "40901" ),
                                                     TDecodingData("Приложение6", "2",   "40901" ),
                                                     TDecodingData("Приложение6", "3",   "40901" )),
                               RcbArray().initialize("40901", "40902"),
                               false,
                               RCB_RS_LESS_OR_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40901"),
                                                     TDecodingData("Приложение2", "2", "40901"),
                                                     TDecodingData("Приложение2", "3", "40901"),
                                                     TDecodingData("Приложение6", "1", "40901"),
                                                     TDecodingData("Приложение6", "2", "40901"),
                                                     TDecodingData("Приложение6", "3", "40901")),
                               RcbArray().initialize("40901"),
                               false,
                               RCB_RS_EQUAL);

        normalizer.addRelation(RcbArray().initialize(TDecodingData("Приложение2", "1", "40902"),
                                                     TDecodingData("Приложение2", "2", "40902"),
                                                     TDecodingData("Приложение2", "3", "40902"),
                                                     TDecodingData("Приложение6", "1", "40902"),
                                                     TDecodingData("Приложение6", "2", "40902"),
                                                     TDecodingData("Приложение6", "3", "40902")),
                               RcbArray().initialize("40902"),
                               false,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30420", "30421"),
                               RcbArray().initialize("30416", "30417"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304211"),
                                                     TDecodingData("Приложение6", "1", "30420" ),
                                                     TDecodingData("Приложение6", "2", "30420" ),
                                                     TDecodingData("Приложение6", "3", "30420" ),
                                                     TDecodingData("Приложение6", "1", "30421" ),
                                                     TDecodingData("Приложение6", "2", "30421" ),
                                                     TDecodingData("Приложение6", "3", "30421" )),
                               RcbArray().initialize("30420", "30421", "-30416", "-30417"),
                               false,
                               RCB_RS_EQUAL);

        normalizerWithCondition.addRelation(RcbArray().initialize("30422", "30423"),
                               RcbArray().initialize("30418", "30419"),
                               RCB_RS_GREATER,
                               RcbArray().initialize(TDecodingData("Приложение2", "3", "304231"),
                                                     TDecodingData("Приложение6", "1", "30422" ),
                                                     TDecodingData("Приложение6", "2", "30422" ),
                                                     TDecodingData("Приложение6", "3", "30422" ),
                                                     TDecodingData("Приложение6", "1", "30423" ),
                                                     TDecodingData("Приложение6", "2", "30423" ),
                                                     TDecodingData("Приложение6", "3", "30423" )),
                               RcbArray().initialize("30422", "30423", "-30418", "-30419"),
                               false,
                               RCB_RS_EQUAL);

        normalizer.normalize();
        normalizerWithCondition.normalize();

        normalizationProtocolWithErrors.endProtocol();
        normalizationProtocol.endProtocol();
    end;
end;

class (TForm_3115) TForm_3654
    initTForm_3115();

    private macro constructor()
        m_application1 = TApplication342_1_3115();
        m_application2 = TApplication2_3115();
        m_application3 = TApplication342_3_3654();
        m_application4 = TApplication4_3115();
        m_application5 = TApplication342_5_3115();
        m_application6 = TApplication342_6_3654();
        m_application8 = TApplication342_8_3115();

        initializeDependencies();
    end;
end;
