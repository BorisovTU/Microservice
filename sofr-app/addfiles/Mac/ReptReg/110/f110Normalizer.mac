/*
$Name:          f110Normalizer.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 110. Нормализатор.
*/

import balanceAttribute;
import Календарь;

const CHAPTER_1 = 1;

const TOTAL_OUTREST_ACTIVE     = 1;
const TOTAL_OUTREST_PASSIVE    = 2;
const CURRENCY_OUTREST_ACTIVE  = 3;
const CURRENCY_OUTREST_PASSIVE = 4;
const ROUBLE_OUTREST_ACTIVE    = 5;
const ROUBLE_OUTREST_PASSIVE   = 6;
const CREDIT                   = 7;

private class TBalanceSumInfo(balance, sumKind, sign)
    var m_balance = balance; //б/с
    var m_sumKind = sumKind; //что именно учитывается (REST_ACTIVE/REST_PASSIVE/...)
    var m_sign    = sign;    //PLUS или MINUS
end;

class (ReportNormalizer) TF110ReportNormalizer(protocolView)
    private var m_report = objectFactoryInstance.createReport();
    private var m_protocolView;
    private var m_part;
    private var m_rows   = RcbArray();

    macro contructorTF110ReportNormalizer(protocolView)
        initReportNormalizer(rcbApplication.currentReport.multiplier);
        m_protocolView = protocolView;
    end;

    macro setPart(part)
        m_part = part;
    end;

    macro getReportForNormalization()
    end;

    macro addRules()
    end;

    macro getExact(attributeName)
        var attribute = m_report.getPart(m_part).getAttribute(attributeName);

        if (attribute != null)
            return m_report.getPart(m_part).getAttribute(attributeName).getExactValue;
        end;

        return 0;
    end;

    macro setScaledValue(attributeName, value)
        m_report.getPart(m_part).getAttribute(attributeName).setScaledValue(value);
    end;

    macro addRule(leftValues : RcbArray, sign, rightValue)
        var relation;
        var node;
        var relationSign = sign;
        var exactLeft    = 0;
        var attribute;

        leftValues.moveFirst();

        if ((sign == RCB_RS_LESS_OR_EQUAL) or (sign == RCB_RS_GREATER_OR_EQUAL))
            while (leftValues.moveNext())
                exactLeft  = exactLeft  + getExact(leftValues.getCurrentItem());
            end;

            if   (exactLeft == rightValue.exact)
                relationSign = RCB_RS_EQUAL;
            elif (sign == RCB_RS_LESS_OR_EQUAL)
                relationSign == RCB_RS_LESS;
            else
                relationSign == RCB_RS_GREATER;
            end;
        end;

        relation = ReportLinearRelation(relationSign);

        leftValues.moveFirst();
        while (leftValues.moveNext())
            if (ValType(normalizer.node(leftValues.getCurrentItem())) == V_UNDEF)
                node       = normalizer.addNode(leftValues.getCurrentItem());
                node.exact = getExact(leftValues.getCurrentItem());
                node.recalculateScaled();
                node.setDef(2.0);

                relation.lhs.plus(node);

                m_rows.push_back(leftValues.getCurrentItem());
            end;
        end;

        if (IsEqClass("RcbNode", rightValue))
            relation.rhs.plus(rightValue);
        else
            relation.rhs.plus(double(nvl(rightValue.scaled, 0)));
        end;

        this.addRelation(relation);
    end;

    macro getBalanceSum(balanceReport, balanceArray : RcbArray)
        var value = TValue();
        var sign;
        var sumKind;
        var currentBalance;
        var balanceAttribute;

        balanceAttribute = TBalanceAttribute("БАЛАНС", balanceReport);

        balanceArray.moveFirst();
        while (balanceArray.moveNext())
            currentBalance = balanceArray.getCurrentItem().m_balance;
            sumKind        = balanceArray.getCurrentItem().m_sumKind;
            sign           = balanceArray.getCurrentItem().m_sign;

            if (balanceAttribute.getBalanceAttribute(CHAPTER_1, currentBalance, false) != null)
                if   (sumKind == TOTAL_OUTREST_ACTIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestActive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestActive().scaled;
                elif (sumKind == TOTAL_OUTREST_PASSIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestPassive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestPassive().scaled;
                elif (sumKind == CURRENCY_OUTREST_ACTIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestCurActive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestCurActive().scaled;
                elif (sumKind == CURRENCY_OUTREST_PASSIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestCurPassive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestCurPassive().scaled;
                elif (sumKind == ROUBLE_OUTREST_ACTIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestNatCurActive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestNatCurActive().scaled;
                elif (sumKind == ROUBLE_OUTREST_PASSIVE)
                    value.exact  = value.exact  + sign * balanceAttribute.getOutRestNatCurPassive().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getOutRestNatCurPassive().scaled;
                elif (sumKind == CREDIT)
                    value.exact  = value.exact  + sign * balanceAttribute.getCredit().exact;
                    value.scaled = value.scaled + sign * balanceAttribute.getCredit().scaled;
                end;
            end;
        end;

        return value;
    end;

    macro getOfrSum(ofrReport, symbolsOfr : RcbArray)
        var attributeValue = ofrReport.attributeValue("Символы");
        var keyValue       = attributeValue.createKeyValue();
        var value          = TValue();
        var compositeValue;

        symbolsOfr.moveFirst();
        while (symbolsOfr.moveNext())
            keyValue.fieldValue("code") = symbolsOfr.getCurrentItem();
            compositeValue = attributeValue.value(keyValue);

            if (valType(compositeValue) != V_UNDEF)
                value.exact  = value.exact  + compositeValue.fieldValue("totalValue").exact;
                value.scaled = value.scaled + compositeValue.fieldValue("totalValue").scaled;
            end;
        end;

        return value;
    end;

    macro saveValues()
        m_rows.moveFirst();
        while (m_rows.moveNext())
            setScaledValue(m_rows.getCurrentItem(), node(m_rows.getCurrentItem()).getScaled());

            m_protocolView.printString(m_rows.getCurrentItem(), getExact(m_rows.getCurrentItem()), node(m_rows.getCurrentItem()).getScaled());
        end;
    end;

    macro execute()
        if (getReportForNormalization())
            addRules();

            normalize();

            if (isNormalized())
                saveValues();
            else
                m_protocolView.printLine("Данные нормализовать не удалось.(смотри лог-файл:" + getLogFilePath() + ").");
            end;
        end;
    end;

    contructorTF110ReportNormalizer(protocolView);
end;

class (TF110ReportNormalizer) TPart1Normalizer(protocolView)
    var m_balanceReport;

    macro constructorTPart1Normalizer(protocolView)
        initTF110ReportNormalizer(protocolView);

        setPart(1);
    end;

    macro getReportForNormalization()
        var currentReport = RcbApplication().currentReport;
        var beginDateBalance = currentReport.context.period.beginDate;
        var endDateBalance   = currentReport.context.period.endDate;
        var contextBalance   = RcbReportContext(RcbPeriod(beginDateBalance, endDateBalance),
                                                currentReport.context.departmentCode,
                                                currentReport.context.issueMode,
                                                currentReport.context.organizationStructure,
                                                currentReport.context.isSummaryMode);
        m_balanceReport = RcbApplication().objectFactory.createReport("Балансовые счета", contextBalance).createBalanceReport();

        if (not TBaseBalanceAttribute("БАЛАНС", m_balanceReport).isBalanceCalculated(CHAPTER_1, currentReport.dimension))
            m_protocolView.printReportAbsence("0409101", currentReport.context.period.beginDate, currentReport.context.period.endDate);

            return false;
        else
            m_protocolView.printReportInfo("0409101", currentReport.context.period.beginDate, currentReport.context.period.endDate);

            return true;
        end;
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("A102/16"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("102", TOTAL_OUTREST_PASSIVE, 1))));
        /* 2 */
        addRule(RcbArray().initialize("A20321/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20321", TOTAL_OUTREST_PASSIVE, 1))));
        /* 3 */
        addRule(RcbArray().initialize("A30126/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30126", TOTAL_OUTREST_PASSIVE, 1))));
        /* 4 */
        addRule(RcbArray().initialize("A30226/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30226", TOTAL_OUTREST_PASSIVE, 1))));
        /* 5 */
        addRule(RcbArray().initialize("A30215/2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30215", TOTAL_OUTREST_ACTIVE, 1))));
        /* 6, 7 */
        addRule(RcbArray().initialize("A40109/5.1", "A40109/9.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40109", TOTAL_OUTREST_ACTIVE, 1))));
        /* 8, 9 */
        addRule(RcbArray().initialize("A50505/4", "A50505/6.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50505", TOTAL_OUTREST_ACTIVE, 1))));
        /* 10,11 */
        addRule(RcbArray().initialize("A50507/4", "A50507/6.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50507", TOTAL_OUTREST_PASSIVE, 1))));
        /* 12 */
        addRule(RcbArray().initialize("A50319/17"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50319", TOTAL_OUTREST_PASSIVE, 1))));

        /* 13 */
        addRule(RcbArray().initialize("A50719/17"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50719", TOTAL_OUTREST_PASSIVE, 1))));
        /* 14 */
        addRule(RcbArray().initialize("A60206/6.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60206", TOTAL_OUTREST_PASSIVE, 1))));
        /* 15 */
        addRule(RcbArray().initialize("A/3.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20317", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("20318", TOTAL_OUTREST_ACTIVE, 1))));
        /* 16 */
        addRule(RcbArray().initialize("A/3.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30420", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("30421", TOTAL_OUTREST_PASSIVE, 1))));
        /* 17 */
        addRule(RcbArray().initialize("A/3.4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30422", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("30421", TOTAL_OUTREST_PASSIVE, 1))));
        /* 18 */
        addRule(RcbArray().initialize("A/5.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20321", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32115", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32311", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32403", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45615", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45715", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47308", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47425", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51610", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51710", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51810", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51910", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("60324", TOTAL_OUTREST_PASSIVE, 1))));
        /* 19 */
        addRule(RcbArray().initialize("A/5.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47404", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47408", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47423", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60312", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47407", TOTAL_OUTREST_PASSIVE,-1))));
        /* 20 */
        addRule(RcbArray().initialize("A/6.4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60201", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60202", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60203", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60204", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60205", TOTAL_OUTREST_ACTIVE, 1))));
        /* 21 */
        addRule(RcbArray().initialize("A/9.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30607", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47425", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("60324", TOTAL_OUTREST_PASSIVE, 1))));
        /* 22 */
        addRule(RcbArray().initialize("A/9.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("51201", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51202", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51203", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51204", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51205", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51206", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51207", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51208", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51209", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51301", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51302", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51303", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51304", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51305", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51306", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51307", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51308", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51309", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51401", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51402", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51403", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51404", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51405", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51406", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51407", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51408", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51409", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51501", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51502", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51503", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51504", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51505", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51506", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51507", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51508", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51509", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51601", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51602", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51603", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51604", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51605", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51606", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51607", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51608", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51609", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51701", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51702", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51703", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51704", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51705", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51706", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51707", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51708", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51709", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51801", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51802", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51803", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51804", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51805", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51806", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51807", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51808", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51807", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51901", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51902", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51903", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51904", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51905", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51906", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51907", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51908", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51909", TOTAL_OUTREST_ACTIVE, 1))));
        /* 23 */
        addRule(RcbArray().initialize("A/12"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30601", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47418", TOTAL_OUTREST_PASSIVE, 1))));
        /* 24 */
        addRule(RcbArray().initialize("A/13.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40804", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40805", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40806", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40809", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40812", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40814", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40815", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40819", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40821", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("421",   TOTAL_OUTREST_PASSIVE, 1))));
        /* 25 */
        addRule(RcbArray().initialize("A/13.1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40806", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40809", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40812", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40814", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40815", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40819", TOTAL_OUTREST_PASSIVE, 1))));
        /* 26 */
        addRule(RcbArray().initialize("A/13.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522",   TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52404", TOTAL_OUTREST_PASSIVE, 1))));
        /* 27 */
        addRule(RcbArray().initialize("A/14.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316", TOTAL_OUTREST_PASSIVE, 1))));
        /* 28 */
        addRule(RcbArray().initialize("A/14.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("423", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("426", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("427", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("428", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("429", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("430", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("431", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("432", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("438", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440", TOTAL_OUTREST_PASSIVE, 1))));
        /* 29 */
        addRule(RcbArray().initialize("A60302/8"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60302", TOTAL_OUTREST_ACTIVE, 1))));
        /* 30 */
        addRule(RcbArray().initialize("A60301/16"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60301", TOTAL_OUTREST_PASSIVE, 1))));
        /* 31 */
        addRule(RcbArray().initialize("A10610/28"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("10610", TOTAL_OUTREST_ACTIVE, 1))));
    end;

    constructorTPart1Normalizer(protocolView);
end;

class (TPart1Normalizer) TPart1Normalizer_3875(protocolView)
    macro constructorTPart1Normalizer_3875(protocolView)
        initTPart1Normalizer(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("A102/16"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("102", TOTAL_OUTREST_PASSIVE, 1))));
        /* 2 */
        addRule(RcbArray().initialize("A20321/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20321", TOTAL_OUTREST_PASSIVE, 1))));
        /* 3 */
        addRule(RcbArray().initialize("A30126/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30126", TOTAL_OUTREST_PASSIVE, 1))));
        /* 4 */
        addRule(RcbArray().initialize("A30226/3.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30226", TOTAL_OUTREST_PASSIVE, 1))));
        /* 5 */
        addRule(RcbArray().initialize("A30215/2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30215", TOTAL_OUTREST_ACTIVE, 1))));
        /* 6, 7 */
        addRule(RcbArray().initialize("A40109/5.1", "A40109/9.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40109", TOTAL_OUTREST_ACTIVE, 1))));
        /* 8, 9 */
        addRule(RcbArray().initialize("A50505/4", "A50505/6.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50505", TOTAL_OUTREST_ACTIVE, 1))));
        /* 10,11 */
        addRule(RcbArray().initialize("A50507/4", "A50507/6.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50507", TOTAL_OUTREST_PASSIVE, 1))));
        /* 12 */
        addRule(RcbArray().initialize("A50319/17"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50319", TOTAL_OUTREST_PASSIVE, 1))));

        /* 13 */
        addRule(RcbArray().initialize("A50719/17"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50719", TOTAL_OUTREST_PASSIVE, 1))));
        /* 14 */
        addRule(RcbArray().initialize("A60206/6.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60206", TOTAL_OUTREST_PASSIVE, 1))));
        /* 15 */
        addRule(RcbArray().initialize("A/3.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20317", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("20318", TOTAL_OUTREST_ACTIVE, 1))));
        /* 16 */
        addRule(RcbArray().initialize("A/3.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30420", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("30421", TOTAL_OUTREST_PASSIVE, 1))));
        /* 17 */
        addRule(RcbArray().initialize("A/3.4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30422", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("30421", TOTAL_OUTREST_PASSIVE, 1))));
        /* 18 */
        addRule(RcbArray().initialize("A/5.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("20321", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32115", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32311", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("32403", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45615", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45715", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("45818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47308", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47425", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51610", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51710", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51810", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("51910", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("60324", TOTAL_OUTREST_PASSIVE, 1))));
        /* 19 */
        addRule(RcbArray().initialize("A/5.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47404", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47408", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47423", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60312", TOTAL_OUTREST_ACTIVE, 1))));

        /* 20 */
        addRule(RcbArray().initialize("A/5.4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47407", TOTAL_OUTREST_PASSIVE, 1))));

        /* 21 */
        addRule(RcbArray().initialize("A/6.4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60201", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60202", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60203", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60204", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60205", TOTAL_OUTREST_ACTIVE, 1))));
        /* 22 */
        addRule(RcbArray().initialize("A/9.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30607", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47425", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("60324", TOTAL_OUTREST_PASSIVE, 1))));
        /* 23 */
        addRule(RcbArray().initialize("A/9.3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("51201", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51202", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51203", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51204", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51205", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51206", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51207", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51208", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51209", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51301", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51302", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51303", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51304", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51305", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51306", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51307", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51308", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51309", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51401", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51402", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51403", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51404", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51405", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51406", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51407", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51408", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51409", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51501", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51502", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51503", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51504", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51505", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51506", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51507", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51508", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51509", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51601", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51602", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51603", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51604", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51605", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51606", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51607", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51608", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51609", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51701", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51702", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51703", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51704", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51705", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51706", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51707", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51708", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51709", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51801", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51802", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51803", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51804", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51805", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51806", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51807", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51808", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51807", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51901", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51902", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51903", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51904", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51905", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51906", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51907", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51908", TOTAL_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("51909", TOTAL_OUTREST_ACTIVE, 1))));
        /* 24 */
        addRule(RcbArray().initialize("A/12"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("30601", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("47418", TOTAL_OUTREST_PASSIVE, 1))));
        /* 25 */
        addRule(RcbArray().initialize("A/13.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40802", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40803", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40804", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40805", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40806", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40809", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40812", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40813", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40814", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40815", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40817", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40819", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40820", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40821", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40823", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40824", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40825", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("421",   TOTAL_OUTREST_PASSIVE, 1))));
        /* 26 */
        addRule(RcbArray().initialize("A/13.1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40806", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40809", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40812", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40814", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40815", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40818", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40819", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40823", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("40824", TOTAL_OUTREST_PASSIVE, 1))));
        /* 27 */
        addRule(RcbArray().initialize("A/13.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522",   TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52404", TOTAL_OUTREST_PASSIVE, 1))));
        /* 28 */
        addRule(RcbArray().initialize("A/14.1"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316", TOTAL_OUTREST_PASSIVE, 1))));
        /* 29 */
        addRule(RcbArray().initialize("A/14.2"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("423", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("426", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("427", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("428", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("429", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("430", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("431", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("432", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("438", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", TOTAL_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440", TOTAL_OUTREST_PASSIVE, 1))));
        /* 30 */
        addRule(RcbArray().initialize("A60302/8"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60302", TOTAL_OUTREST_ACTIVE, 1))));

        /* 31 */
        addRule(RcbArray().initialize("A60301/16"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("60301", TOTAL_OUTREST_PASSIVE, 1))));

        /* 32 */
        addRule(RcbArray().initialize("A10609/28"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("10609", TOTAL_OUTREST_PASSIVE, 1))));

        /* 33 */
        addRule(RcbArray().initialize("A10610/28"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("10610", TOTAL_OUTREST_ACTIVE, 1))));
    end;

   constructorTPart1Normalizer_3875(protocolView);
end;

class (TF110ReportNormalizer) TPart2Normalizer(protocolView)
    var m_ofrReport;

    macro constructorTPart2Normalizer(protocolView)
        initTF110ReportNormalizer(protocolView);

        setPart(2);
    end;

    macro getReportForNormalization()
        var currentReport = RcbApplication().currentReport;
        var d, m, y;
        dateSplit(currentReport.context.period.beginDate, d, m, y);

        var beginDate = date(1, 1, y);
        var endDate   = currentReport.context.period.endDate;
        var context   = RcbReportContext(RcbPeriod(beginDate, endDate),
                                         currentReport.context.departmentCode,
                                         currentReport.context.issueMode,
                                         currentReport.context.organizationStructure,
                                         currentReport.context.isSummaryMode);

        m_ofrReport = RcbApplication().objectFactory.createReport("ОПУ", context);

        if (not(m_ofrReport.isCalculated()))
            m_protocolView.printReportAbsence("0409102", beginDate, currentReport.context.period.endDate);

            return false;
        end;

        return true;
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("S12406/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("12406")));
        /* 2, 3 */
        addRule(RcbArray().initialize("S131/6", "S131/7"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("13101", "13102", "13103", "13104", "13105", "13106", "13107", "13108")));
        /* 4 */
        addRule(RcbArray().initialize("S15101/6"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15101")));
        /* 5,6,7 */
        addRule(RcbArray().initialize("S152/6", "S152/7", "S152/8"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15201", "15203")));
        /* 8 */
        addRule(RcbArray().initialize("S16203/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("16203")));
        /* 9,12,13 */
        addRule(RcbArray().initialize("S16305/4", "S16305/14", "S16305/15"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("16305")));
       /* 10, 11 */
       addRule(RcbArray().initialize("S16305/4.1", "S16305/4.2"),
                RCB_RS_LESS_OR_EQUAL,
                node("S16305/4"));
        /* 14 */
        addRule(RcbArray().initialize("S17101/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("17101")));
        /* 15 */
        addRule(RcbArray().initialize("S17201/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("17201")));
        /* 16,17 */
        addRule(RcbArray().initialize("S231/6", "S231/7"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("23101", "23102", "23103", "23104", "23105", "23106", "23107", "23108", "23109")));
         /* 18 */
        addRule(RcbArray().initialize("S24101/6"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("24101")));
        /* 19,20,21 */
        addRule(RcbArray().initialize("S242/6", "S242/7", "S242/8"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("24201", "24203")));
        /* 22,25,26 */
        addRule(RcbArray().initialize("S25302/4", "S25302/14", "S25302/15"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("25302")));
       /* 23,24 */
       addRule(RcbArray().initialize("S25302/4.1", "S25302/4.2"),
                RCB_RS_LESS_OR_EQUAL,
                node("S25302/4"));
        /* 27 */
        addRule(RcbArray().initialize("S27101/2.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27101")));
        /* 28 */
        addRule(RcbArray().initialize("S27201/2.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27201")));
    end;

   constructorTPart2Normalizer(protocolView);
end;

class (TPart2Normalizer) TPart2Normalizer_3875(protocolView)

    macro constructorTPart2Normalizer_3875(protocolView)
        initTPart2Normalizer(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("S155/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15501", "15502", "15503", "15504", "15506", "15507", "15508")));
        /* 2*/
        addRule(RcbArray().initialize("S155/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15601", "15602", "15603", "15604", "15606", "15607", "15608")));
        /* 3, 4, 5, 6*/
        addRule(RcbArray().initialize("S256/6", "S256/8", "S256/9", "S256/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("25601")));
        /* 7 */
        addRule(RcbArray().initialize("S27801/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27801")));
        /* 8 */
        addRule(RcbArray().initialize("S278/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27802", "27803", "27804")));
        /* 9*/
        addRule(RcbArray().initialize("S28401/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28401")));
       /* 10, 11 */
       addRule(RcbArray().initialize("S28802/1.1", "S28802/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28802")));
        /* 12 */
        addRule(RcbArray().initialize("S/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("151", "152", "153", "154", "157")));
        /* 13 */
        addRule(RcbArray().initialize("S/4.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("155", "156")));
        /* 14 */
        addRule(RcbArray().initialize("S/18.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15116", "15117", "15119", "15120", "15214", "15216", "15303", "15403", "15506", "15507", "15508", "15606", "15607", "15608", "15707", "15708")));
        /* 15 */
        addRule(RcbArray().initialize("S375/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37501", "37502", "37503", "37504", "37505", "37506", "37507", "37508")));
        /* 16*/
        addRule(RcbArray().initialize("S376/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37601", "37602", "37603", "37604", "37605", "37606", "37607", "37608")));
        /* 17, 18, 19, 20 */
        addRule(RcbArray().initialize("S456/6", "S456/8", "S456/9", "S456/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("45601")));
        /* 21 */
        addRule(RcbArray().initialize("S47401/2.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47401")));
        /* 22,23 */
        addRule(RcbArray().initialize("S47802/2.1", "S47802/2.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47802")));
        /* 24 */
        addRule(RcbArray().initialize("S/4.3"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("371", "372", "373", "374", "377")));
        /* 25 */
        addRule(RcbArray().initialize("S/4.4"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("375", "376")));
        /* 26 */
        addRule(RcbArray().initialize("S/18.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37116", "37117", "37119", "37120", "37214", "37216", "37303", "37403", "37506", "37507", "37508", "37606", "37607", "37608", "37707", "37708")));
    end;

   constructorTPart2Normalizer_3875(protocolView);
end;

class (TPart2Normalizer_3875) TPart2Normalizer_4033(protocolView)
    macro constructorTPart2Normalizer_4033(protocolView)
        initTPart2Normalizer_3875(protocolView);
    end;

    //ОФР по 446-П
    macro getOfrSum(ofrReport, symbolsOfr : RcbArray)
        var attributeValue = ofrReport.attributeValue("Символы");
        var keyValue       = attributeValue.createKeyValue();
        var compositeValue;
        var value = TValue();

        symbolsOfr.moveFirst();

        while (symbolsOfr.moveNext())
            keyValue.fieldValue("symbol") = symbolsOfr.getCurrentItem();
            compositeValue = attributeValue.value(keyValue);

            if (valType(compositeValue) != V_UNDEF)
                value.exact  = value.exact  + compositeValue.fieldValue("total").exact;
                value.scaled = value.scaled + compositeValue.fieldValue("total").scaled;
            end;
        end;

        return value;
    end;

    macro getReportForNormalization()
        var currentReport = RcbApplication().currentReport;
        var d, m, y;
        dateSplit(currentReport.context.period.beginDate, d, m, y);

        var beginDate = date(1, 1, y);
        var endDate   = currentReport.context.period.endDate;
        var context   = RcbReportContext(RcbPeriod(beginDate, endDate),
                                         currentReport.context.departmentCode,
                                         currentReport.context.issueMode,
                                         currentReport.context.organizationStructure,
                                         currentReport.context.isSummaryMode);

        m_ofrReport = RcbApplication().objectFactory.createReport("ОФР", context);

        if (not(m_ofrReport.isCalculated()))
            m_protocolView.printReportAbsence("0409102", beginDate, currentReport.context.period.endDate);
            return false;
        else
            m_protocolView.printReportInfo("0409102", beginDate, currentReport.context.period.endDate);
            return true;
        end;
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("S155/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15501", "15502", "15503", "15504", "15505", "15506", "15507", "15508")));
        /* 2*/
        addRule(RcbArray().initialize("S156/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15601", "15602", "15603", "15604", "15505", "15606", "15607", "15608")));
        /* 3, 4, 5, 6*/
        addRule(RcbArray().initialize("S256/6", "S256/8", "S256/9", "S256/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("25601")));
        /* 7 */
        addRule(RcbArray().initialize("S27801/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27801")));
        /* 8 */
        addRule(RcbArray().initialize("S278/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27802", "27803", "27804")));
        /* 9*/
        addRule(RcbArray().initialize("S28401/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28401")));
       /* 10, 11 */
       addRule(RcbArray().initialize("S28802/1.1", "S28802/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28802")));
        /* 12 */
        addRule(RcbArray().initialize("S/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("151", "152", "153", "154", "157")));
        /* 13 */
        addRule(RcbArray().initialize("S/4.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("155", "156")));
        /* 14 */
        addRule(RcbArray().initialize("S/18.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15116", "15117", "15119", "15120", "15214", "15216", "15303", "15403", "15506", "15507", "15508", "15606", "15607", "15608", "15707", "15708")));
        /* 15 */
        addRule(RcbArray().initialize("S375/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37501", "37502", "37503", "37504", "37505", "37506", "37507", "37508")));
        /* 16*/
        addRule(RcbArray().initialize("S376/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37601", "37602", "37603", "37604", "37605", "37606", "37607", "37608")));
        /* 17, 18, 19, 20 */
        addRule(RcbArray().initialize("S456/6", "S456/8", "S456/9", "S456/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("45601")));
        /* 21 */
        addRule(RcbArray().initialize("S47401/2.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47401")));
        /* 22,23 */
        addRule(RcbArray().initialize("S47802/2.1", "S47802/2.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47802")));
        /* 24 */
        addRule(RcbArray().initialize("S/4.3"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("371", "372", "373", "374", "377")));
        /* 25 */
        addRule(RcbArray().initialize("S/4.4"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("375", "376")));
        /* 26 */
        addRule(RcbArray().initialize("S/18.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37116", "37117", "37119", "37120", "37214", "37216", "37303", "37403", "37506", "37507", "37508", "37606", "37607", "37608", "37707", "37708")));
        /* 27 */
        addRule(RcbArray().initialize("S28204/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28204")));
        /* 28 */
        addRule(RcbArray().initialize("S47304/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47304")));
        /* 29 */
        addRule(RcbArray().initialize("S/4.5"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28203", "28204", "29301", "29302", "29304")));
        /* 30 */
        addRule(RcbArray().initialize("S/4.6"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47303", "47304", "48501", "48502", "48504")));
    end;

    constructorTPart2Normalizer_4033(protocolView);
end;

class (TPart2Normalizer_4033) TPart2Normalizer_4637(protocolView)
    macro constructorTPart2Normalizer_4637(protocolView)
        initTPart2Normalizer_4033(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("S155/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15501", "15502", "15503", "15504", "15505", "15506", "15507", "15508")));
        /* 2*/
        addRule(RcbArray().initialize("S156/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15601", "15602", "15603", "15604", "15505", "15606", "15607", "15608")));
        /* 3, 4, 5, 6*/
        addRule(RcbArray().initialize("S256/6", "S256/8", "S256/9", "S256/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("25601")));
        /* 7 */
        addRule(RcbArray().initialize("S27801/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27801")));
        /* 8 */
        addRule(RcbArray().initialize("S278/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("27802", "27803", "27804")));
        /* 9*/
        addRule(RcbArray().initialize("S28401/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28401")));
       /* 10, 11 */
       addRule(RcbArray().initialize("S28802/1.1", "S28802/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28802")));
        /* 12 */
        addRule(RcbArray().initialize("S/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("151", "152", "153", "154", "157")));
        /* 13 */
        addRule(RcbArray().initialize("S/4.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("155", "156")));
        /* 14 */
        addRule(RcbArray().initialize("S/18.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("15116", "15117", "15119", "15120", "15214", "15216", "15303", "15403", "15506", "15507", "15508", "15606", "15607", "15608", "15707", "15708")));
        /* 15 */
        addRule(RcbArray().initialize("S375/16"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37501", "37502", "37503", "37504", "37505", "37506", "37507", "37508")));
        /* 16*/
        addRule(RcbArray().initialize("S376/17"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37601", "37602", "37603", "37604", "37605", "37606", "37607", "37608")));
        /* 17, 18, 19, 20 */
        addRule(RcbArray().initialize("S456/6", "S456/8", "S456/9", "S456/10"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("45601")));
        /* 21 */
        addRule(RcbArray().initialize("S47401/2.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47401")));
        /* 22,23 */
        addRule(RcbArray().initialize("S47802/2.1", "S47802/2.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47802")));
        /* 24 */
        addRule(RcbArray().initialize("S/4.3"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("371", "372", "373", "374", "377")));
        /* 25 */
        addRule(RcbArray().initialize("S/4.4"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("375", "376")));
        /* 26 */
        addRule(RcbArray().initialize("S/18.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("37116", "37117", "37119", "37120", "37214", "37216", "37303", "37403", "37506", "37507", "37508", "37606", "37607", "37608", "37707", "37708")));
        /* 27 */
        addRule(RcbArray().initialize("S28204/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28204")));
        /* 28 */
        addRule(RcbArray().initialize("S47304/4.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47304")));
        /* 29 */
        addRule(RcbArray().initialize("S/4.5"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("28203", "28204", "29301", "29302", "29304")));
        /* 30 */
        addRule(RcbArray().initialize("S/4.6"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("47303", "47304", "48501", "48502", "48504")));
        /* 31 */
        addRule(RcbArray().initialize("S211/1.1"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("21118", "21119", "21215", "21216", "21217")));
        /* 32 */
        addRule(RcbArray().initialize("S211/1.2"),
                RCB_RS_LESS_OR_EQUAL,
                getOfrSum(m_ofrReport, RcbArray().initialize("21101", "21102", "21103", "21104", "21105", "21106", "21107", "21108", "21109", "21110",
                                                             "21111", "21112", "21113", "21114", "21115", "21116", "21117", "21120", "21201", "21202",
                                                             "21203", "21204", "21218", "21219", "21220")));
    end;

    constructorTPart2Normalizer_4637(protocolView);
end;

class (TF110ReportNormalizer) TPart3Normalizer(protocolView)
    var m_balanceReports = TArray();
    var m_previousReport;
    var m_reportsDay, m_reportsMonth, m_reportYear;

    macro constructorTPart3Normalizer(protocolView)
        initTF110ReportNormalizer(protocolView);

        dateSplit(RcbApplication().currentReport.context.period.endDate, m_reportsDay, m_reportsMonth, m_reportYear);

        setPart(3);
    end;

    macro getBalanceReport(beginDate, endDate, isAnyBeginningDate)
        var currentReport = RcbApplication().currentReport;
        var beginDateBalance = beginDate;
        var endDateBalance   = endDate;
        var balanceReport;
        var balanceReportCurrent;
        var contextBalance   = RcbReportContext(RcbPeriod(beginDateBalance, endDateBalance),
                                                currentReport.context.departmentCode,
                                                currentReport.context.issueMode,
                                                currentReport.context.organizationStructure,
                                                currentReport.context.isSummaryMode);
        var contextBalanceCurrent;
        var d, m, y;
        dateSplit(currentReport.context.period.beginDate, d, m, y);
        var _begin = date( 1, 12, y - 1);
        var _end   = date(31, 12, y - 1);
        var hasBalanceReport = true;

        if ((not isAnyBeginningDate) or (valType(isAnyBeginningDate == V_UNDEF)))
            balanceReport = RcbApplication().objectFactory.createReport("Балансовые счета", contextBalance).createBalanceReport();
        else
            balanceReport = RcbApplication().objectFactory.createReport("Балансовые счета", contextBalance).createBalanceReport(RCB_CBR_IS_ANY_BEGINNING_DATE);
        end;

        if (m_report.isAtQuarterlyDate())
            while (_begin <= currentReport.context.period.endDate)
                contextBalanceCurrent = RcbReportContext(RcbPeriod(_begin, _end),
                                                         currentReport.context.departmentCode,
                                                         currentReport.context.issueMode,
                                                         currentReport.context.organizationStructure,
                                                         currentReport.context.isSummaryMode);
                balanceReportCurrent = RcbApplication().objectFactory.createReport("Балансовые счета", contextBalanceCurrent).createBalanceReport();
                if (not TBaseBalanceAttribute("БАЛАНС", balanceReportCurrent).isBalanceCalculated(CHAPTER_1, currentReport.dimension))
                    m_protocolView.printReportAbsence("0409101", _begin, _end);

                    hasBalanceReport = false;
                else
                    m_protocolView.printReportInfo("0409101", _begin, _end);
                    m_balanceReports[m_balanceReports.size] = balanceReportCurrent;
                end;

                _begin = dateAfterCalenMonths(_begin, 1);
                _end = dateAfterCalenMonths(_end, 1);
                dateSplit(_end, d, m, y);
                _end = Date(getDaysInMonth(_end), m, y); // необходимо, чтобы после февраля не было дат типа 1.03.ХХХХ - 28.03.ХХХХ, 1.04.2015 - 28.04.ХХХХ и т.д.
            end;
        else
            if (not TBaseBalanceAttribute("БАЛАНС", balanceReport).isBalanceCalculated(CHAPTER_1, currentReport.dimension))
                m_protocolView.printReportAbsence("БАЛАНСОВЫЕ СЧЕТА", beginDate, endDate);

                hasBalanceReport = false;
            else
                m_protocolView.printReportInfo("БАЛАНСОВЫЕ СЧЕТА", beginDate, endDate);
                m_balanceReports[m_balanceReports.size] = balanceReport;
            end;
        end;

        return hasBalanceReport;
    end;

    macro getReportForNormalization()
        var i = 1;

        if (not getBalanceReport(RcbApplication().currentReport.context.period.beginDate, RcbApplication().currentReport.context.period.endDate, true))
            return false;
        end;

        if (m_reportsMonth >= 6)
            var currentReport = RcbApplication().currentReport;

            var beginDate = date(1, m_reportsMonth - 3, m_reportYear);
            var endDate   = date(1, m_reportsMonth - 2, m_reportYear) - 1;
            var context   = RcbReportContext(RcbPeriod(beginDate, endDate),
                                             currentReport.context.departmentCode,
                                             currentReport.context.issueMode,
                                             currentReport.context.organizationStructure,
                                             currentReport.context.isSummaryMode);

            m_previousReport = RcbApplication().objectFactory.createReport("Форма 110", context);

            if (not(m_previousReport.isCalculated()))
                m_protocolView.printReportAbsence("Форма 110", beginDate, endDate);

                return false;
            else
                m_protocolView.printReportInfo("Форма 110", beginDate, endDate);
            end;

        end;

        return true;
    end;

    macro sumBalanceForPeriod(balanceArray : RcbArray)
        var tempValue = TValue(0);
        var result    = TValue(0);
        var i = 1;

        while (i < m_balanceReports.size)
            tempValue = getBalanceSum(m_balanceReports[i], balanceArray);

            result.exact  = result.exact  + tempValue.exact;
            result.scaled = result.scaled + tempValue.scaled;

            i = i + 1;
        end;

        return result;
    end;

    macro addRules()
        /* 1 */
        var balance10801PreviousYear = getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("10801", TOTAL_OUTREST_PASSIVE, 1))).exact;
        var balance10901PreviousYear = getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("10901", TOTAL_OUTREST_ACTIVE, 1)));
        var balance70802CurrentYear  = getBalanceSum(m_balanceReports[m_reportsMonth], RcbArray().initialize(TBalanceSumInfo("70802", TOTAL_OUTREST_PASSIVE, 1))).exact;
        var balance10901CurrentYear  = getBalanceSum(m_balanceReports[m_reportsMonth], RcbArray().initialize(TBalanceSumInfo("10901", TOTAL_OUTREST_ACTIVE, 1))).exact;
        var previouse5101 = TValue();
        var compositeValue;
        var keyValue;

        //5101, условие 1
        if (    (balance10801PreviousYear > 0)
            and ((balance70802CurrentYear - balance10901PreviousYear.exact) > 0)
            and (   (RcbApplication().currentReport.context.period.endDate == Date(31, 3, m_reportYear))
                 or (RcbApplication().currentReport.context.period.endDate == Date(30, 6, m_reportYear))
                 or (RcbApplication().currentReport.context.period.endDate == Date(30, 9, m_reportYear))))

            addRule(RcbArray().initialize("5101"),
            RCB_RS_GREATER_OR_EQUAL,
            TValue(0));
        end;

        if (    (getExact("5101") > 0)
            and (   (RcbApplication().currentReport.context.period.endDate == Date(31, 3, m_reportYear))
                 or (RcbApplication().currentReport.context.period.endDate == Date(30, 6, m_reportYear))
                 or (RcbApplication().currentReport.context.period.endDate == Date(30, 9, m_reportYear))))

            var sumCredit10901_70802 = sumBalanceForPeriod(RcbArray().initialize(TBalanceSumInfo("10901", CREDIT, 1), TBalanceSumInfo("70802", CREDIT, 1)));

            //5101, условие 2
            if (balance10901PreviousYear.exact == 0)
                addRule(RcbArray().initialize("5101"),
                        RCB_RS_EQUAL,
                        sumCredit10901_70802);
            end;

            //5101, условие 3
            if (    (balance10901PreviousYear.exact > 0)
                and (balance10901CurrentYear == 0)
                and (   (RcbApplication().currentReport.context.period.endDate == Date(31, 3, m_reportYear))
                     or (RcbApplication().currentReport.context.period.endDate == Date(30, 6, m_reportYear))
                     or (RcbApplication().currentReport.context.period.endDate == Date(30, 9, m_reportYear))))

                var sum = TValue();

                sum.exact  = sumCredit10901_70802.exact  - balance10901PreviousYear.exact;
                sum.scaled = sumCredit10901_70802.scaled - balance10901PreviousYear.scaled;

                addRule(RcbArray().initialize("5101"),
                        RCB_RS_EQUAL,
                        sum);
            end;
        end;

        //5101, условие 4
        if (    (RcbApplication().currentReport.context.period.endDate >= Date(30,  6, m_reportYear))
            and (RcbApplication().currentReport.context.period.endDate <  Date(31, 12, m_reportYear)))

            compositeValue = m_previousReport.attributeValue("ПользовательскийВвод");
            keyValue = compositeValue.createKeyValue();
            keyValue.fieldValue("decode")     = "5101";

            previouse5101.exact  = compositeValue.findValue(keyValue).fieldValue("value").exact;
            previouse5101.scaled = compositeValue.findValue(keyValue).fieldValue("value").scaled;
            addRule(RcbArray().initialize("5101"),
                    RCB_RS_EQUAL,
                    previouse5101);
        end;
        //5101 - иначе условие 5 (математическое округление)

        /* 2 */
        addRule(RcbArray().initialize("6101"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[m_reportsMonth], RcbArray().initialize(TBalanceSumInfo("70602", TOTAL_OUTREST_PASSIVE, 1))));
        /* 3 */
        addRule(RcbArray().initialize("6102"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[m_reportsMonth], RcbArray().initialize(TBalanceSumInfo("70607", TOTAL_OUTREST_ACTIVE, 1))));
    end;

   constructorTPart3Normalizer(protocolView);
end;

class (TPart3Normalizer) TPart3Normalizer_4033(protocolView)
    macro constructorTPart3Normalizer_4033(protocolView)
        initTPart3Normalizer(protocolView);
    end;

    macro getReportForNormalization()
        var currentReport = RcbApplication().currentReport;
        var beginDateBalance = currentReport.context.period.beginDate;
        var endDateBalance   = currentReport.context.period.endDate;
        var contextBalance   = RcbReportContext(RcbPeriod(beginDateBalance, endDateBalance),
                                                currentReport.context.departmentCode,
                                                currentReport.context.issueMode,
                                                currentReport.context.organizationStructure,
                                                currentReport.context.isSummaryMode);
        m_balanceReports[0] = RcbApplication().objectFactory.createReport("Балансовые счета", contextBalance).createBalanceReport();

        if (not TBaseBalanceAttribute("БАЛАНС", m_balanceReports[0]).isBalanceCalculated(CHAPTER_1, currentReport.dimension))
            m_protocolView.printReportAbsence("0409101", currentReport.context.period.beginDate, currentReport.context.period.endDate);

            return false;
        else
            m_protocolView.printReportInfo("0409101", currentReport.context.period.beginDate, currentReport.context.period.endDate);

            return true;
        end;
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("6101"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("70602", TOTAL_OUTREST_PASSIVE, 1))));
        /* 2 */
        addRule(RcbArray().initialize("6102"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("70607", TOTAL_OUTREST_ACTIVE, 1))));
    end;

   constructorTPart3Normalizer_4033(protocolView);
end;

class (TPart3Normalizer_4033) TPart3Normalizer_4927(protocolView)
    macro constructorTPart3Normalizer_4927(protocolView)
        initTPart3Normalizer_4033(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("6101"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("70602", TOTAL_OUTREST_PASSIVE, 1))));
        /* 2 */
        addRule(RcbArray().initialize("6102"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("70607", TOTAL_OUTREST_ACTIVE, 1))));

        /* 3 */
        addRule(RcbArray().initialize("6103"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReports[0], RcbArray().initialize(TBalanceSumInfo("47446", TOTAL_OUTREST_PASSIVE, 1),
                                                                         TBalanceSumInfo("47451", TOTAL_OUTREST_ACTIVE, -1))));
    end;

   constructorTPart3Normalizer_4033(protocolView);
end;

class (TPart1Normalizer) TPart4Normalizer(protocolView)
    macro constructorTPart4Normalizer(protocolView)
        initTPart1Normalizer(protocolView);

        setPart(4);
    end;

    macro getExact(attributeName)  //В четвертом значении атрибуты разбиваются по графам
        var attribute = subStr(attributeName, 1, strLen(attributeName)-2);
        var column    = int(subStr(attributeName, strLen(attributeName)));

        if (column == 3)
            return m_report.getPart(m_part).getAttribute(attribute).getExactNationalValue();
        elif (column == 4)
            return m_report.getPart(m_part).getAttribute(attribute).getExactForeignValue();
        else
            return 0.0;
        end;
    end;

    macro setScaledValue(attributeName, value)
        var attribute = subStr(attributeName, 1, strLen(attributeName)-2);
        var column    = int(subStr(attributeName, strLen(attributeName)));

        if (column == 3)
            return m_report.getPart(m_part).getAttribute(attribute).setScaledNationalValue(value);
        elif (column == 4)
            return m_report.getPart(m_part).getAttribute(attribute).setScaledForeignValue(value);
        end;
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("D/0_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 2 */
        addRule(RcbArray().initialize("D/1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 3 */
        addRule(RcbArray().initialize("D/2_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

         /* 4 */
        addRule(RcbArray().initialize("D/3_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

         /* 5 */
        addRule(RcbArray().initialize("D/5_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
         /* 6 */
        addRule(RcbArray().initialize("D/7_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

          /* 7 */
        addRule(RcbArray().initialize("D/9_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("32201", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32202", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32203", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32204", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32205", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32206", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32207", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32208", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32209", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/9_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("32201", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32202", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32203", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32204", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32205", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32206", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32207", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32208", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32209", CURRENCY_OUTREST_ACTIVE, 1))));
          /* 8 */
        addRule(RcbArray().initialize("D/10_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("32301", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32302", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32303", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32304", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32305", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32306", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32307", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32308", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32309", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47301", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47302", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47303", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47304", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47305", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47306", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47307", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/10_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("32301", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32302", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32303", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32304", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32305", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32306", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32307", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32308", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("32309", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47301", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47302", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47303", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47304", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47305", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47306", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47307", CURRENCY_OUTREST_ACTIVE, 1))));
         /* 9 */
        addRule(RcbArray().initialize("D/11_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("46401", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46402", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46403", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46404", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46405", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46406", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46407", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46701", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46702", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46703", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46704", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46705", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46706", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46707", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47001", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47002", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47003", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47004", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47005", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47006", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47007", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/11_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("46401", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46402", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46403", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46404", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46405", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46406", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46407", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46701", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46702", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46703", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46704", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46705", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46706", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46707", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47001", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47002", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47003", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47004", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47005", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47006", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47007", CURRENCY_OUTREST_ACTIVE, 1))));

         /* 10 */
        addRule(RcbArray().initialize("D/12_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("46501", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46502", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46503", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46504", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46505", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46506", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46507", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46601", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46602", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46603", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46604", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46605", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46606", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46607", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46901", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46902", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46903", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46904", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46905", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46906", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46907", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/12_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("46501", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46502", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46503", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46504", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46505", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46506", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46507", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46601", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46602", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46603", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46604", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46605", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46606", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46607", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46901", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46902", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46903", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46904", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46905", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46906", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("46907", CURRENCY_OUTREST_ACTIVE, 1))));

         /* 11 */
        addRule(RcbArray().initialize("D/13_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47101", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47102", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47103", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47104", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47105", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47106", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47107", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47201", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47202", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47203", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47204", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47205", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47206", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47207", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/13_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47101", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47102", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47103", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47104", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47105", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47106", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47107", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47201", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47202", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47203", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47204", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47205", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47206", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47207", CURRENCY_OUTREST_ACTIVE, 1))));

         /* 12,13,17 */
        addRule(RcbArray().initialize("D/14_3", "D/15_3", "D/16_3", "D/17_3", "D/18_3", "D/19_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50618", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", ROUBLE_OUTREST_ACTIVE, 1))));

         /* 14,15,16 */
        addRule(RcbArray().initialize("D/14_4", "D/15_4", "D/16_4", "D/17_4", "D/18_4", "D/19_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50618", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", CURRENCY_OUTREST_ACTIVE, 1))));

         /* 18 */
        addRule(RcbArray().initialize("IL/1_3", "IL/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47411", TOTAL_OUTREST_PASSIVE, 1))));

         /* 19,20,21,22,23,24,25,26,27,28,29 */
        addRule(RcbArray().initialize("IL/2_3", "IL/3_3", "IL/4_3", "IL/5_3", "IL/6_3", "IL/7_3", "IL/8_3", "IL/9_3", "IL/10_3", "IL/11_3", "IL/12_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("IL/2_4", "IL/3_4", "IL/4_4", "IL/5_4", "IL/6_4", "IL/7_4", "IL/8_4", "IL/9_4", "IL/10_4", "IL/11_4", "IL/12_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", CURRENCY_OUTREST_PASSIVE, 1))));

         /* 30,31,32,33,34,35,36,37,38,39 */
        addRule(RcbArray().initialize("IA/1_3", "IA/2_3", "IA/3_3", "IA/4_3", "IA/5_3", "IA/6_3", "IA/7_3", "IA/8_3", "IA/9_3", "IA/10_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("IA/1_4", "IA/2_4", "IA/3_4", "IA/4_4", "IA/5_4", "IA/6_4", "IA/7_4", "IA/8_4", "IA/9_4", "IA/10_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", CURRENCY_OUTREST_ACTIVE, 1))));

         /* 40,41,42,43,44,45 */
        addRule(RcbArray().initialize("R/1_3", "R/1_4", "R/2_3", "R/2_4", "R/3_3", "R/3_4", "R/4_3", "R/4_4", "R/5_3", "R/5_4", "R/6_3", "R/6_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50121", TOTAL_OUTREST_ACTIVE,     1),
                                                                     TBalanceSumInfo("50221", TOTAL_OUTREST_ACTIVE,     1),
                                                                     TBalanceSumInfo("50120", TOTAL_OUTREST_PASSIVE,   -1),
                                                                     TBalanceSumInfo("50220", TOTAL_OUTREST_PASSIVE,   -1))));

         /* 46,47,48 */
        addRule(RcbArray().initialize("R/7_3", "R/7_4", "R/8_3", "R/8_4", "R/9_3", "R/9_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50621", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50721", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50620", TOTAL_OUTREST_PASSIVE, -1),
                                                                     TBalanceSumInfo("50720", TOTAL_OUTREST_PASSIVE, -1))));
    end;

    constructorTPart4Normalizer(protocolView)
end;

class (TPart4Normalizer) TPart4Normalizer_4212(protocolView)
    macro constructorTPart4Normalizer(protocolView)
        initTPart4Normalizer(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("D/0_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 2 */
        addRule(RcbArray().initialize("D/0.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 3 */
        addRule(RcbArray().initialize("D/1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 4 */
        addRule(RcbArray().initialize("D/1.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 5 */
        addRule(RcbArray().initialize("D/2_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 6 */
        addRule(RcbArray().initialize("D/2.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 7 */
        addRule(RcbArray().initialize("D/3_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 8 */
        addRule(RcbArray().initialize("D/3.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 9 */
        addRule(RcbArray().initialize("D/5_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 10 */
        addRule(RcbArray().initialize("D/5.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 11 */
        addRule(RcbArray().initialize("D/7_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 12 */
        addRule(RcbArray().initialize("D/7.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 13, 14, 15, 16, 17, 18 */
        addRule(RcbArray().initialize("D/14_3", "D/15_3", "D/16_3", "D/17_3", "D/18_3", "D/19_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50618", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/14_4", "D/15_4", "D/16_4", "D/17_4", "D/18_4", "D/19_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50618", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 19 */
        addRule(RcbArray().initialize("IL/1_3", "IL/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47411", TOTAL_OUTREST_PASSIVE, 1))));

        /* 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30 */
        addRule(RcbArray().initialize("IL/2_3", "IL/3_3", "IL/4_3", "IL/5_3", "IL/6_3", "IL/7_3", "IL/8_3", "IL/9_3", "IL/10_3", "IL/11_3", "IL/12_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("IL/2_4", "IL/3_4", "IL/4_4", "IL/5_4", "IL/6_4", "IL/7_4", "IL/8_4", "IL/9_4", "IL/10_4", "IL/11_4", "IL/12_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 31, 32, 33, 34, 35, 36, 37, 38, 39, 40 */
        addRule(RcbArray().initialize("IA/1_3", "IA/2_3", "IA/3_3", "IA/4_3", "IA/5_3", "IA/6_3", "IA/7_3", "IA/8_3", "IA/9_3", "IA/10_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("IA/1_4", "IA/2_4", "IA/3_4", "IA/4_4", "IA/5_4", "IA/6_4", "IA/7_4", "IA/8_4", "IA/9_4", "IA/10_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 41, 42, 43, 44, 45, 46 */
        addRule(RcbArray().initialize("R/1_3", "R/1_4", "R/2_3", "R/2_4", "R/3_3", "R/3_4", "R/4_3", "R/4_4", "R/5_3", "R/5_4", "R/6_3", "R/6_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50121", TOTAL_OUTREST_ACTIVE,     1),
                                                                     TBalanceSumInfo("50221", TOTAL_OUTREST_ACTIVE,     1),
                                                                     TBalanceSumInfo("50120", TOTAL_OUTREST_PASSIVE,   -1),
                                                                     TBalanceSumInfo("50220", TOTAL_OUTREST_PASSIVE,   -1))));

        /* 47, 48, 49 */
        addRule(RcbArray().initialize("R/7_3", "R/7_4", "R/8_3", "R/8_4", "R/9_3", "R/9_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50621", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50721", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50620", TOTAL_OUTREST_PASSIVE, -1),
                                                                     TBalanceSumInfo("50720", TOTAL_OUTREST_PASSIVE, -1))));
    end;

    constructorTPart4Normalizer(protocolView)
end;

class (TPart4Normalizer_4212) TPart4Normalizer_4637(protocolView)
    macro constructorTPart4Normalizer(protocolView)
        initTPart4Normalizer_4212(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("D/0_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 2 */
        addRule(RcbArray().initialize("D/0.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 3 */
        addRule(RcbArray().initialize("D/1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 4 */
        addRule(RcbArray().initialize("D/1.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 5 */
        addRule(RcbArray().initialize("D/2_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 6 */
        addRule(RcbArray().initialize("D/2.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 7 */
        addRule(RcbArray().initialize("D/3_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 8 */
        addRule(RcbArray().initialize("D/3.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 9 */
        addRule(RcbArray().initialize("D/5_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 10 */
        addRule(RcbArray().initialize("D/5.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 11 */
        addRule(RcbArray().initialize("D/7_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 12 */
        addRule(RcbArray().initialize("D/7.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 13, 14, 15, 16, 17, 18, 19 */
        addRule(RcbArray().initialize("D/14_3", "D/15_3", "D/16_3", "D/17_3", "D/18_3", "D/19_3", "D/20_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/14_4", "D/15_4", "D/16_4", "D/17_4", "D/18_4", "D/19_4", "D/20_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 20, 21, 22, 23 */
        addRule(RcbArray().initialize("D/21_3", "D/22_3", "D/23_3", "D/24_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50618", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60118", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/21_4", "D/22_4", "D/23_4", "D/24_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50618", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60118", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 24, 25, 26 */
        addRule(RcbArray().initialize("D/25_3", "D/26_3", "D/27_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40901", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/25_4", "D/26_4", "D/27_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40901", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 27, 28, 29, 30 */
        addRule(RcbArray().initialize("D/28_3", "D/29_3", "D/30_3", "D/31_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40903", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/28_4", "D/29_4", "D/30_4", "D/31_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40903", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 31, 32, 33, 34, 35 */
        addRule(RcbArray().initialize("D/32_3", "D/33_3", "D/34_3", "D/35_3", "D/36_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47801", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47802", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47803", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/32_4", "D/33_4", "D/34_4", "D/35_4", "D/36_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47801", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47802", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47803", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 36 */
        addRule(RcbArray().initialize("IL/1_3", "IL/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47411", TOTAL_OUTREST_PASSIVE, 1))));

        /* 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47 */
        addRule(RcbArray().initialize("IL/2_3", "IL/3_3", "IL/4_3", "IL/5_3", "IL/6_3", "IL/7_3", "IL/8_3", "IL/9_3", "IL/10_3", "IL/11_3", "IL/12_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("IL/2_4", "IL/3_4", "IL/4_4", "IL/5_4", "IL/6_4", "IL/7_4", "IL/8_4", "IL/9_4", "IL/10_4", "IL/11_4", "IL/12_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 48, 49, 50, 51, 52, 53, 54, 55, 56, 57 */
        addRule(RcbArray().initialize("IA/1_3", "IA/2_3", "IA/3_3", "IA/4_3", "IA/5_3", "IA/6_3", "IA/7_3", "IA/8_3", "IA/9_3", "IA/10_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("IA/1_4", "IA/2_4", "IA/3_4", "IA/4_4", "IA/5_4", "IA/6_4", "IA/7_4", "IA/8_4", "IA/9_4", "IA/10_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 58, 59, 60, 61, 62, 63 */
        addRule(RcbArray().initialize("R/1_3", "R/1_4", "R/2_3", "R/2_4", "R/3_3", "R/3_4", "R/4_3", "R/4_4", "R/5_3", "R/5_4", "R/6_3", "R/6_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50121", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50221", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50120", TOTAL_OUTREST_PASSIVE, -1),
                                                                     TBalanceSumInfo("50220", TOTAL_OUTREST_PASSIVE, -1))));

        /* 64, 65, 66 */
        addRule(RcbArray().initialize("R/7_3", "R/7_4", "R/8_3", "R/8_4", "R/9_3", "R/9_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50621", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50721", TOTAL_OUTREST_ACTIVE,   1),
                                                                     TBalanceSumInfo("50620", TOTAL_OUTREST_PASSIVE, -1),
                                                                     TBalanceSumInfo("50720", TOTAL_OUTREST_PASSIVE, -1))));

        /* 67, 68, 69 */
        addRule(RcbArray().initialize("DS/1_3", "DS/2_3", "DS/3_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("521", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("DS/1_4", "DS/2_4", "DS/3_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("521", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 70 */
        addRule(RcbArray().initialize("DS/4_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("DS/4_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522", CURRENCY_OUTREST_PASSIVE, 1))));
    end;

    constructorTPart4Normalizer(protocolView)
end;

class (TPart4Normalizer_4637) TPart4Normalizer_4927(protocolView)
    macro constructorTPart4Normalizer(protocolView)
        initTPart4Normalizer_4637(protocolView);
    end;

    macro addRules()
        /* 1 */
        addRule(RcbArray().initialize("D/0_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 2 */
        addRule(RcbArray().initialize("D/0.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/0.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42309", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42310", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42311", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42312", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42313", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42314", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 3 */
        addRule(RcbArray().initialize("D/1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 4 */
        addRule(RcbArray().initialize("D/1.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/1.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("315", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 5 */
        addRule(RcbArray().initialize("D/2_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 6 */
        addRule(RcbArray().initialize("D/2.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/2.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("42609", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42610", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42611", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42612", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42613", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42614", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("42615", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("316",   CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("440",   CURRENCY_OUTREST_PASSIVE, 1))));

        /* 7 */
        addRule(RcbArray().initialize("D/3_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 8 */
        addRule(RcbArray().initialize("D/3.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/3.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("431", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("434", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("437", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 9 */
        addRule(RcbArray().initialize("D/5_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 10 */
        addRule(RcbArray().initialize("D/5.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/5.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("432", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("433", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("435", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("436", CURRENCY_OUTREST_PASSIVE, 1))));
        /* 11 */
        addRule(RcbArray().initialize("D/7_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 12 */
        addRule(RcbArray().initialize("D/7.1_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/7.1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("438", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("439", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 13, 14, 15, 16, 17, 18, 19 */
        addRule(RcbArray().initialize("D/14_3", "D/15_3", "D/16_3", "D/17_3", "D/18_3", "D/19_3", "D/20_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/14_4", "D/15_4", "D/16_4", "D/17_4", "D/18_4", "D/19_4", "D/20_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50118", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50218", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50318", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 20, 21, 22, 23 */
        addRule(RcbArray().initialize("D/21_3", "D/22_3", "D/23_3", "D/24_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50618", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60118", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/21_4", "D/22_4", "D/23_4", "D/24_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("50618", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("50718", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("60118", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 24, 25, 26 */
        addRule(RcbArray().initialize("D/25_3", "D/26_3", "D/27_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40901", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/25_4", "D/26_4", "D/27_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40901", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 27, 28, 29, 30 */
        addRule(RcbArray().initialize("D/28_3", "D/29_3", "D/30_3", "D/31_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40903", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("D/28_4", "D/29_4", "D/30_4", "D/31_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("40903", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 31, 32, 33, 34, 35 */
        addRule(RcbArray().initialize("D/32_3", "D/33_3", "D/34_3", "D/35_3", "D/36_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47801", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47802", ROUBLE_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47803", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("D/32_4", "D/33_4", "D/34_4", "D/35_4", "D/36_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47801", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47802", CURRENCY_OUTREST_ACTIVE, 1),
                                                                     TBalanceSumInfo("47803", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 36 */
        addRule(RcbArray().initialize("IL/1_3", "IL/1_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47411", TOTAL_OUTREST_PASSIVE, 1))));

        /* 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47 */
        addRule(RcbArray().initialize("IL/2_3", "IL/3_3", "IL/4_3", "IL/5_3", "IL/6_3", "IL/7_3", "IL/8_3", "IL/9_3", "IL/10_3", "IL/11_3", "IL/12_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", ROUBLE_OUTREST_PASSIVE, 1))));

        addRule(RcbArray().initialize("IL/2_4", "IL/3_4", "IL/4_4", "IL/5_4", "IL/6_4", "IL/7_4", "IL/8_4", "IL/9_4", "IL/10_4", "IL/11_4", "IL/12_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47426", CURRENCY_OUTREST_PASSIVE, 1))));

        /* 48, 49, 50, 51, 52, 53, 54, 55, 56, 57 */
        addRule(RcbArray().initialize("IA/1_3", "IA/2_3", "IA/3_3", "IA/4_3", "IA/5_3", "IA/6_3", "IA/7_3", "IA/8_3", "IA/9_3", "IA/10_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", ROUBLE_OUTREST_ACTIVE, 1))));

        addRule(RcbArray().initialize("IA/1_4", "IA/2_4", "IA/3_4", "IA/4_4", "IA/5_4", "IA/6_4", "IA/7_4", "IA/8_4", "IA/9_4", "IA/10_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("47427", CURRENCY_OUTREST_ACTIVE, 1))));

        /* 67, 68, 69 */
        addRule(RcbArray().initialize("DS/1_3", "DS/2_3", "DS/3_3"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("521", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52403", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52405", ROUBLE_OUTREST_PASSIVE, 1)
                                                                    )));

        addRule(RcbArray().initialize("DS/1_4", "DS/2_4", "DS/3_4"),
                RCB_RS_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("521", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52403", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52405", CURRENCY_OUTREST_PASSIVE, 1)
                                                                    )));

        /* 70 */
        addRule(RcbArray().initialize("DS/4_3"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52404", ROUBLE_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52405", ROUBLE_OUTREST_PASSIVE, 1)
                                                                    )));

        addRule(RcbArray().initialize("DS/4_4"),
                RCB_RS_LESS_OR_EQUAL,
                getBalanceSum(m_balanceReport, RcbArray().initialize(TBalanceSumInfo("522", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52404", CURRENCY_OUTREST_PASSIVE, 1),
                                                                     TBalanceSumInfo("52405", CURRENCY_OUTREST_PASSIVE, 1)
                                                                     )));
    end;

    constructorTPart4Normalizer(protocolView)
end;
