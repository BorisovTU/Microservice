import ReptCBInter, lib_exp;

var counter = 0;
var ИмяФайла:string;

CONST НачалоРаздела1 = 0,
      НачалоРаздела2 = 21,
      НачалоРаздела3 = 41;

var Переменные = TArray; 
/*раздел 1*/
    Переменные(0) = "A10702/17";    Переменные(1) = "A30126/3";      Переменные(2) = "A40109/5.3";
    Переменные(3) = "A40109/9";     Переменные(4) = "A50205/6.1";    Переменные(5) = "A50206/6.1";
    Переменные(6) = "A50207/6.1";   Переменные(7) = "A50208/6.1";    Переменные(8) = "A50209/6.1";
    Переменные(9) = "A50210/6.1";   Переменные(10) = "A50211/6.1";   Переменные(11) = "A50406/4.1";                         
    Переменные(12) = "A50406/6.1";  Переменные(13) = "A50505/4.1";   Переменные(14) = "A50505/6.1";
    Переменные(15) = "A/5.1";       Переменные(16) = "A/5.2";        Переменные(17) = "A/6.2";
    Переменные(18) = "A/7.2";       Переменные(19) = "A/10";         Переменные(20) = "A/13";
/*раздел 2*/
    Переменные(21) = "S17311/12";   Переменные(22) = "S17311/13";    Переменные(23) = "S17312/12";
    Переменные(24) = "S17312/13";   Переменные(25) = "S17313/12";    Переменные(26) = "S17313/13";
    Переменные(27) = "S17314/12";   Переменные(28) = "S17314/13";    Переменные(29) = "S17315/1";
    Переменные(30) = "S29410/12";   Переменные(31) = "S29410/13";    Переменные(32) = "S29411/12";
    Переменные(33) = "S29411/13";   Переменные(34) = "S29412/12";    Переменные(35) = "S29412/12"; 
    Переменные(36) = "S29413/12";   Переменные(37) = "S29413/13";    Переменные(38) = "S29414/7"; 
    Переменные(39) = "3101";        Переменные(40) = "3201"; 
/*раздел 3*/
    Переменные(41) = "1111";    Переменные(42) = "1112";    Переменные(43) = "1113";
    Переменные(44) = "1114";    Переменные(45) = "1121";    Переменные(46) = "1122";
    Переменные(47) = "1123";    Переменные(48) = "1124";    Переменные(49) = "2111";
    Переменные(50) = "2112";    Переменные(51) = "2113";    Переменные(52) = "2121";
    Переменные(53) = "2122";    Переменные(54) = "2123";    Переменные(55) = "1211";
    Переменные(56) = "1212";    Переменные(57) = "1213";    Переменные(58) = "1214"; 
    Переменные(59) = "1221";    Переменные(60) = "1222";    Переменные(61) = "1223";
    Переменные(62) = "1224";    Переменные(63) = "1301";    Переменные(64) = "1302";
    Переменные(65) = "1303";    Переменные(66) = "1304";    Переменные(67) = "2401";
    Переменные(68) = "2402";    Переменные(69) = "2403";    Переменные(70) = "3301"; 
    Переменные(71) = "4101";    Переменные(72) = "4201";    Переменные(73) = "4202"; 
    Переменные(74) = "4301";    Переменные(75) = "4302";    Переменные(76) = "5101";

var Счет = TArray;
/*раздел 1*/
    Счет(0) = "10702";    Счет(1) = "30126";    Счет(2) = "40109";
    Счет(3) = "40109";    Счет(4) = "50205";    Счет(5) = "50206";
    Счет(6) = "50207";    Счет(7) = "50208";    Счет(8) = "50209";
    Счет(9) = "50210";    Счет(10) = "50211";   Счет(11) = "50406";                         
    Счет(12) = "50406";   Счет(13) = "50505";   Счет(14) = "50505";
    Счет(15) = "*";       Счет(16) = "*";       Счет(17) = "*";
    Счет(18) = "*";       Счет(19) = "*";       Счет(20) = "*";
/*раздел 2*/
    Счет(21) = "*";  Счет(22) = "*";  Счет(23) = "*";  Счет(24) = "*";  Счет(25) = "*";  Счет(26) = "*";
    Счет(27) = "*";  Счет(28) = "*";  Счет(29) = "*";  Счет(30) = "*";  Счет(31) = "*";  Счет(32) = "*";
    Счет(33) = "*";  Счет(34) = "*";  Счет(35) = "*";  Счет(36) = "*";  Счет(37) = "*";  Счет(38) = "*"; 
    Счет(39) = "*";  Счет(40) = "*"; 
/*раздел 3*/
    Счет(41) = "*";    Счет(42) = "*";    Счет(43) = "*";    Счет(44) = "*";    Счет(45) = "*";    Счет(46) = "*";
    Счет(47) = "*";    Счет(48) = "*";    Счет(49) = "*";    Счет(50) = "*";    Счет(51) = "*";    Счет(52) = "*";
    Счет(53) = "*";    Счет(54) = "*";    Счет(55) = "*";    Счет(56) = "*";    Счет(57) = "*";    Счет(58) = "*"; 
    Счет(59) = "*";    Счет(60) = "*";    Счет(61) = "*";    Счет(62) = "*";    Счет(63) = "*";    Счет(64) = "*";
    Счет(65) = "*";    Счет(66) = "*";    Счет(67) = "*";    Счет(68) = "*";    Счет(69) = "*";    Счет(70) = "*"; 
    Счет(71) = "*";    Счет(72) = "*";    Счет(73) = "*";    Счет(74) = "*";    Счет(75) = "*";    Счет(76) = "*";

var Код = TArray;
/*раздел 1*/
    Код(0) = "17";    Код(1) = "3";    Код(2) = "5.3";    Код(3) = "9";    Код(4) = "6.1";    Код(5) = "6.1";
    Код(6) = "6.1";   Код(7) = "6.1";  Код(8) = "6.1";    Код(9) = "6.1";  Код(10) = "6.1";   Код(11) = "4.1";                         
    Код(12) = "6.1";  Код(13) = "4.1"; Код(14) = "6.1";   Код(15) = "5.1"; Код(16) = "5.2";   Код(17) = "6.2";
    Код(18) = "7.2";  Код(19) = "10";  Код(20) = "13";
/*раздел 2*/
    Код(21) = "12";  Код(22) = "13";  Код(23) = "12";  Код(24) = "13";  Код(25) = "12";  Код(26) = "13";
    Код(27) = "12";  Код(28) = "13";  Код(29) = "1";   Код(30) = "12";  Код(31) = "13";  Код(32) = "12";
    Код(33) = "13";  Код(34) = "12";  Код(35) = "13";  Код(36) = "12";  Код(37) = "13";  Код(38) = "7"; 
    Код(39) = "*";   Код(40) = "*"; 
/*раздел 3*/
    Код(41) = "*";    Код(42) = "*";    Код(43) = "*";    Код(44) = "*";    Код(45) = "*";    Код(46) = "*";
    Код(47) = "*";    Код(48) = "*";    Код(49) = "*";    Код(50) = "*";    Код(51) = "*";    Код(52) = "*";
    Код(53) = "*";    Код(54) = "*";    Код(55) = "*";    Код(56) = "*";    Код(57) = "*";    Код(58) = "*"; 
    Код(59) = "*";    Код(60) = "*";    Код(61) = "*";    Код(62) = "*";    Код(63) = "*";    Код(64) = "*";
    Код(65) = "*";    Код(66) = "*";    Код(67) = "*";    Код(68) = "*";    Код(69) = "*";    Код(70) = "*"; 
    Код(71) = "*";    Код(72) = "*";    Код(73) = "*";    Код(74) = "*";    Код(75) = "*";    Код(76) = "*";

private MACRO CheckLen(valr, len)

   if (strlen(string(valr)) > len)
    MsgBox("Превышена максимальная длина содержимого графы ");
    exit(1);
   end;

END;
                           
private MACRO GetFileName() 

   var day, mon, year;

    datesplit(ДатаОтчета, day, mon, year);

    if(StrLen(string(day))==1) day= "0" + day; end;
    if(StrLen(string(mon))==1) mon= "0" + mon; end;

    ИмяФайла = day + mon + string(year) + ".110";

    if( not GetExpFileName( ИмяФайла ) )
     exit(1);
    end;

    SetOutPut(ИмяФайла, FALSE); 

END;

private MACRO PrintUnit(Unit, Bot, Top)

 var valr, valt, i = Bot;    

  println("<F110_", Unit, ">");

     while (i < Top)

       ПрочитатьПеременную2( valr, valt, ДатаОтчета, ПредДатаОтчета, {Название Отчета}, "Ф110_" + Переменные(i));

       if(valr == NULL)
        SetOutPut(NULL, TRUE);
        println("Не определена переменная ", "Ф110_" + Переменные(i));
        SetOutPut(ИмяФайла, TRUE); 
       else
       println("\"", i + 1, "\",\"", valr,"\",\"", Счет(i),"\",\"", Код(i), "\"" );
       counter = counter + 1;
       end;
       i = i + 1;
     end;

END;

/*Точка входа*/ 
    
     GetFileName();

     PrintUnit(1, НачалоРаздела1, НачалоРаздела2);
     PrintUnit(2, НачалоРаздела2, НачалоРаздела3);
     PrintUnit(3, НачалоРаздела3, Переменные.size);

     SetOutPut(Null, TRUE);
     println( "                    Файл: ", ИмяФайла );
     println( date, " ", time, " Выгружено записей: ", counter );
     println( date, " ", time, " Окончание экспорта данных формы 110." );

