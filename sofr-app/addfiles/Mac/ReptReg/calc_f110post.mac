/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                  R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Завершающие операции. Форма 110.
└───────────────────────────────────────────────────────────────────────────*/
import calc_f110;
/****************************************************************************************************
 *  Временное решение!                                                                              *
 *  Все ниже следующие импортируемые макросы, по идее должны вызываться отдельными шагами операций, *
 *  но так как форма реализованна без временной таблицы, а нам нужно выводить сообщение "Нет данных *
 *  для отчета" в случае отсутствия таковых, то приходится выполнять весь расчет одним шагом.       *
 ****************************************************************************************************/
import calc_f110pre;
import calc_f110cb;
import calc_f110ln;
import calc_f110ibc;
import calc_f110scr;
import calc_f110uv;

macro viewProtocol()
    if (isEmptyProtocol_110)
        println("  Нет данных для отчета");
    end;

    viewFileLog(ProtocolFileName);
    setOutput(NULL, false);
end;

/***************************************************************************************************
 *  Основная функция
 **************************************************************************************************/
macro main()
    charProcessor.processAll();

    viewProtocol();
end;

/***************************************************************************************************
 *  Точка входа
 **************************************************************************************************/
main();
установитьФлагВозврата( OK_MACRO_FLAG ); // Успешное завершение макроса 
exit(1);
