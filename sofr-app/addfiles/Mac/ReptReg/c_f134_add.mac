import rcbCoreInter;
import reptCbInter;

class F134AdditionalCalculate()
    private var m_report;

    private macro initialize()
        m_report = rcbApplication.currentReport;
    end;

    macro SetAttributeValue(attributeName : String, value)
        var attributeValue = m_report.attributeValue(attributeName);

        attributeValue.exact  = value;
        attributeValue.recalculateScaled();
    end;

    macro nullingDependentVariables()
        var nulValue = $0.0;
        SetAttributeValue("EqИстДоп", nulValue);
        SetAttributeValue("Eq3_1", nulValue);
        SetAttributeValue("Eq3_3", nulValue);
        SetAttributeValue("Eq3_4", nulValue);
        SetAttributeValue("Eq3_4переоценка", nulValue);
        SetAttributeValue("Eq3_5", nulValue);
        SetAttributeValue("Eq3_6", nulValue);
        SetAttributeValue("Eq3_7", nulValue);
        SetAttributeValue("Eq3_9", nulValue);
        SetAttributeValue("Eq3_10", nulValue);

        RcbApplication().transactionManager.Commit();
    end;

    macro execute()
       if (m_report.attributeValue("EqИстДоп").scaled <= 0)
           nullingDependentVariables();
       end;
    end;

    initialize();
end;

macro executeAdditionalCalculate()
    F134AdditionalCalculate().execute();
end;

установитьФлагВозврата(OK_MACRO_FLAG);
Exit(1);
