/**
 * Форма 125. Отчет.
 * 
 * @since   15.04.2009
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
/**
 * Отчет.
 */
class (RcbReportBase) T125Report(report : RcbReport, isLazyInitialization : Bool)
    initRcbReportBase(report, isLazyInitialization);

    /**
     * Получить раздел отчета.
     *                
     * @param     partId
     */
    macro getPart(partId : String) : RcbPartBase
        m_parts.moveFirst();
        while (m_parts.moveNext())
            if (m_parts.getCurrentItem().getId() == partId)
                return m_parts.getCurrentItem();
            end;
        end;

        return m_parts.push_back(objectFactoryInstance.createPart(partId, this, m_rcbReport.attributeValue("РассчитанныеДанные")));
    end;    

    /**
     * Добавить раздел к отчету.
     * 
     * @param     partId    номер
     */
    macro addPart(partId : Integer) /*: TPart*/
        return (m_parts(m_parts.size) = objectFactoryInstance().createPart(partId, this, m_rcbReport.attributeValue("РассчитанныеДанные")));
    end;

    /**
     * Отчет пуст.
     */
    macro isEmpty() : Bool
        var i : Integer = 0;
        var j : Integer = 0;

        while (i < m_parts.size)
            if (not m_parts[i].isEmpty())
                return false;    
            end;
            i = i + 1;
        end;

        return true;
    end;
end;

/**
 * Отчет от 1881-У.
 */
class (T125Report) T125Report1881(report : RcbReport, isLazyInitialization : Bool)
    initT125Report(report, isLazyInitialization);

    /**
     * Конструктор.
     */
    private macro initialize()
        addPart(1);
    end;
end;
