/*
$Name:        f125ObjectFactory.mac
$Module:      Регламентируемая отчетность
$Description: Фабрика объектов формы 125
*/
/**
 * Форма 125. фабрика объектов отчетной формы.
 *
 * @since   14.04.2009
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
class (RcbObjectFactoryBase) T125ObjectFactory1881()
    initRcbObjectFactoryBase();

    macro createReport(report : RcbReport, isLazy : Bool) /*: RcbReportBase*/
        return genObject("T125Report1881", report, isLazy);
    end;

    macro createPart(partId : Integer, report, compositeValue) /*: RcbPartBase*/
        return genObject("T125Part", partId, report, compositeValue);
    end;

    macro createAttribute(id /*: Integer*/, part /*: RcbPartBase*/, compositeValue : Object) /*: RcbAttributeBase*/
        return genObject("T125Attribute", id, part, compositeValue);
    end;

    macro createDataSources(/*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T125DataSources");
    end;

    macro createDataSourceFilters() /*: RcbDataSourceFilters*/
        return genObject("T125DataSourceFilters");
    end;

    macro createCalculateProtocolView() /*: RcbCalculateProtocolView*/
        return genObject("T125CalculateProtocolView");
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController");
    end;

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable1881");
    end;

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView1881");
    end;

    macro createReportView() /*: RcbReportView*/
        return genObject("T125ReportView1881");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("T125PrintProtocolView", protocolName);
    end;

    macro createReportPrintController() /*: RcbReportPrintController*/
        return genObject("T125ReportPrintController1881");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("T125KlikoExportController1881");
    end;

    macro createKlikoView() /*: TKlikoView*/
        return genObject("T125KlikoView1881");
    end;

    macro createPtkPsdView() /*: TPtkPsdView*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPtkPsdView"));
    end;

    macro createPtkPsdExportController() /*: TKlikoExportController*/
        msgBox("Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2539-У " , "|" , " (окончание отчетного периода - не ранее 01.01.2011г.)");
        RepErrorsQueue().add(0, String("Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2539-У " , "\n" , " (окончание отчетного периода - не ранее 01.01.2011г.)"));
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    macro createNormalizationController()
    end;
end;

class (T125ObjectFactory1881) T125ObjectFactory2332()
    initT125ObjectFactory1881();

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController2332");
    end;

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView2332");
    end;

    macro createReportView() /*: RcbReportView*/
        return genObject("T125ReportView2332");
    end;

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable2332");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("T125KlikoExportController2332");
    end;
end;

class (T125ObjectFactory2332) T125ObjectFactory2539()
    initT125ObjectFactory2332();

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView2539");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdExportController*/
        return genObject("T125PtkPsdExportController2539");
    end;

    macro createPtkPsdView() /*: TPtkPsdView*/
        return genObject("T125PtkPsdView2539");
    end;
end;

class (T125ObjectFactory2539) T125ObjectFactory2835()
    initT125ObjectFactory2539();

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable2835");
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController2835");
    end;

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView2835");
    end;
end;

class (T125ObjectFactory2835) T125ObjectFactory2851()
    initT125ObjectFactory2835();

    macro createReportView() /*: RcbReportView*/
        return genObject("T125ReportView2851");
    end;
end;

class (T125ObjectFactory2851) T125ObjectFactory2926()
    initT125ObjectFactory2851();

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable2926");
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController2926");
    end;
end;

class (T125ObjectFactory2926) T125ObjectFactory2922()
    initT125ObjectFactory2926();

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController2922");
    end;
end;

class (T125ObjectFactory2922) T125ObjectFactory2926_2()
    initT125ObjectFactory2922();

    macro createDataSources(/*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T125DataSources2926_2");
    end;

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView2926_2");
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController2926_2");
    end;

    macro createNormalizationController()
        return genObject("T125NormalizationController2926_2");
    end;

    macro createReportPrintController() /*: RcbReportPrintController*/
        return genObject("T125ReportPrintController2926_2");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("T125KlikoExportController2926_2");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdExportController*/
        return genObject("T125PtkPsdExportController2926_2");
    end;

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable2926_2");
    end;

    macro createDataSourceFilters() /*: RcbDataSourceFilters*/
        return genObject("T125DataSourceFilters_2926_2");
    end;
end;

class (T125ObjectFactory2926_2) T125ObjectFactory3875()
    initT125ObjectFactory2926_2();

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController3875");
    end;

    macro createTuneTable() /*: RcbTuneTable*/
        return genObject("T125TuneTable3875");
    end;
end;

class (T125ObjectFactory3875) T125ObjectFactory4099()
    initT125ObjectFactory3875();

    macro createDataSources(/*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T125DataSources4099");
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        return genObject("T125ReportCalculateController4099");
    end;
end;

class (T125ObjectFactory4099) T125ObjectFactory4212()
    initT125ObjectFactory4099();

    macro createReportView() /*: RcbReportView*/
        return genObject("T125ReportView4212");
    end;

    macro createPartView() /*: RcbReportView*/
        return genObject("T125PartView4212");
    end;

    macro createReportPrintController() /*: RcbReportPrintController*/
        return genObject("T125ReportPrintController4212");
    end;

    macro createKlikoExportController()
        return genObject("T125KlikoExportController4212");
    end;
end;

/**
 * Точка доступа к объекту-одиночке TObjectFactory()
 */
if (objectFactoryInstance == null)
    if   (rcbApplication.currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = T125ObjectFactory4212();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4099_DATE)
        objectFactoryInstance = T125ObjectFactory4099();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3875_DATE2)
        objectFactoryInstance = T125ObjectFactory3875();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2926_DATE2)
        objectFactoryInstance = T125ObjectFactory2926_2();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2922_DATE)
        objectFactoryInstance = T125ObjectFactory2922();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2926_DATE)
        objectFactoryInstance = T125ObjectFactory2926();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2851_DATE)
        objectFactoryInstance = T125ObjectFactory2851();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2835_DATE)
        objectFactoryInstance = T125ObjectFactory2835();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2539_DATE)
        objectFactoryInstance = T125ObjectFactory2539();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2332_DATE)
        objectFactoryInstance = T125ObjectFactory2332();
    else
        objectFactoryInstance = T125ObjectFactory1881();
    end;
end;
