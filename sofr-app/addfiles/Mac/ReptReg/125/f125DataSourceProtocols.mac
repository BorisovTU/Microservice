/*
$Name:        f125DataSourceProtocols.mac
$Module:      ¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì
$Description: à®â®ª®«ë ¨áâ®ç­¨ª®¢ ¤ ­­ëå ¤«ï ä®à¬ë 125
*/
/**
 * ”®à¬  125. à®â®ª®« ¨áâ®ç­¨ª  ¤ ­­ëå.
 *
 * @since   14.04.2009
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
import rsbDataSet;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â .
 */
class TDataSourceProtocol(view : String)

    /**
     * Ž¡ê¥ªâ ¤«ï ¯¥ç â¨ ¯® è ¡«®­ã.
     */
    private var m_view;

    /**
     * Š®­áâàãªâ®à.
     */
    private macro constructor(view : String)
        m_view = view;
    end;

    /**
     * ¥ç âì á®®¡é¥­¨ï ®¡ ®âáãâáâ¢¨¥ ¤ ­­ëå.
     */
    private macro printNullData()
        println("   ¥â ¤ ­­ëå.");
    end;

    /**
     * ¥ç âì è ¯ª¨ â ¡«¨æë.
     */
    private macro beginTable()
    end;

    /**
     * ¥ç âì áâà®ª¨ ¤ ­­ëå.
     *
     *  @param     dataSet   áâà®ª  ¨§ ­ ¡®à  § ¯¨á¥©
     */
    private macro printString(dataSet)
    end;

    /**
     * ¥ç âì áâà®ª¨.
     *
     *  @param     text   â¥ªáâ áâà®ª¨
     */
    private macro endTable(dataSet)
    end;

    /**
     * ¥ç âì áâà®ª¨.
     *
     *  @param     text   áâà®ª 
     */
    macro printLine(text)
        println(text);
    end;

    /**
     * ¥ç âì ¯à®â®ª®« .
     *
     *  @param     dataSet   ­ ¡®à § ¯¨á¥©
     */
    macro printProtocol(dataSet /*: TRsbDataSet*/)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTable(dataSet);
            while (dataSet.moveNext())
                printString(dataSet);
            end;
            endTable(itogRecord);
        else
            printNullData();
        end;
    end;

    constructor(view);
end;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â  ¯® ¤ ­­ë¬ "‘ç¥â®¢ ƒŠ".
 */
class (TDataSourceProtocol) TCbAccountDataSourceProtocol()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
        [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
         ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³   „ â    ³ Žáâ â®ª áç¥â   ³ íª-®ä¨á/³   „ â    ³‘ã¬¬  ­ à é¥­­ëå³                                                         ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
         ³                         ³  à¨ï  ³          ³                ³  ­®¬¥à   ³ ¯®£ è¥­¨ï³   ¯à®æ¥­â®¢    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ³                         ³ª ç¥áâ-³ ¯®£ è¥­¨ï³   ¢ àã¡«ïå     ³  ¯à®æ.   ³ ¯à®æ¥­â®¢³   ¢ àã¡«ïå     ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³    ¤® 30 ¤­¥©  ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
         ³                         ³  ¢    ³          ³                ³ ¤®£®¢®à  ³          ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro beginTableRow1()
        [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
         ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³ Žáâ â®ª áç¥â   ³    ‡­ ç¥­¨¥    ³      ‘ã¬¬ ,    ³                                                         ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
         ³                         ³  à¨ï  ³                ³   ¯à¨¬¥ç ­¨ï   ³   ¢®è¥¤è ï ¢   ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ³                         ³ª ç¥áâ-³   ¢ àã¡«ïå     ³  "¥á­¨¦ ¥¬ë©  ³      ®âç¥â     ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³    ¤® 30 ¤­¥©  ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
         ³                         ³  ¢    ³                ³    ®áâ â®ª"    ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro beginTableRow1_2922()
        [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
         ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³ Žáâ â®ª áç¥â   ³    ‡­ ç¥­¨¥    ³   ®¬¥à áç¥â  à¥§¥à¢    ³ Žáâ â®ª áç¥â   ³      ‘ã¬¬ ,    ³                                                         ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
         ³                         ³  à¨ï  ³                ³   ¯à¨¬¥ç ­¨ï   ³                         ³                ³   ¢®è¥¤è ï ¢   ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ³                         ³ª ç¥áâ-³   ¢ àã¡«ïå     ³  "¥á­¨¦ ¥¬ë©  ³                         ³    à¥§¥à¢      ³      ®âç¥â     ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³    ¤® 30 ¤­¥©  ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
         ³                         ³  ¢    ³                ³    ®áâ â®ª"    ³                         ³                ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
//   ‘¯¥æ¨ä¨ª æ¨ï:
//       à¨¬¥à à á¯¥ç â ­­®£® ¯à®â®ª®« :
//             32502810200000000022       1                    56000.00                                               56000.00         56000.00         56000.00         56000.00         56000.00         56000.00         56000.00         56000.00         56000.00         56000.00
//             32502810800000000011       1                    42300.00                                               42300.00         42300.00         42300.00         42300.00         42300.00         42300.00         42300.00         42300.00         42300.00         42300.00
//             45917810000000000011       1                   150000.00                                              150000.00        150000.00        150000.00        150000.00        150000.00        150000.00        150000.00        150000.00        150000.00        150000.00
//             50905810800000000001       1  1.12.2010          7500.00                                                7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00
//             50905810800000000001       1                                      1   1.12.2011            75.00          75.00            75.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00
//             50905810800000000001       1                                      1   1.01.2012            75.00          75.00            75.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00
//             50905810800000000001       1                                      2   1.12.2010            75.00          75.00            75.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00          7500.00
//             45917810400000000022       1                    87000.00                                               87000.00         87000.00         87000.00         87000.00         87000.00         87000.00         87000.00         87000.00         87000.00         87000.00

        var boStr = "";
        if ((dataSet.backOffice != null) or (dataSet.number != null))
            boStr = string(nvl(dataSet.backOffice, "")) + "/" + string(nvl(dataSet.number, ""));
        end;

        [ #########################       # ########## ################ ########## ########## ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
        (
            dataSet.account:r,
            NVL(dataSet.qualityCategory, ""),
            NVL(dataSet.acc_maturityDate, ""),
            NVL(dataSet.acc_outCoverRest, ""):0:2,
            boStr,
            NVL(dataSet.maturitydate, ""):0:2,
            NVL(dataSet.roubleSum, ""):0:2,
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    private macro printStringRow1(dataSet)
        var boStr = "";
        if ((dataSet.backOffice != null) or (dataSet.number != null))
            boStr = string(nvl(dataSet.backOffice, "")) + "/" + string(nvl(dataSet.number, ""));
        end;

        [ #########################       # ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]

        (
            dataSet.account:r,
            NVL(dataSet.qualityCategory, ""),
            NVL(dataSet.rest, ""):0:2,
            NVL(dataSet.restNotDown, ""):0:2,
            NVL(dataSet.acc_outCoverRest, ""):0:2,
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

   private macro printStringRow1_2922(dataSet)
        var boStr = "";
        if ((dataSet.backOffice != null) or (dataSet.number != null))
            boStr = string(nvl(dataSet.backOffice, "")) + "/" + string(nvl(dataSet.number, ""));
        end;

        [ #########################       # ################ ################ ######################### ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]

        (
            dataSet.account:r,
            NVL(dataSet.qualityCategory, ""),
            NVL(dataSet.rest, ""):0:2,
            NVL(dataSet.restNotDown, ""):0:2,
            NVL(dataSet.reserveAccount, ""):r,
            NVL(dataSet.reserveSum, ""):0:2,
            NVL(dataSet.acc_outCoverRest, ""):0:2,
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    /**
     * ¥ç âì ¯®¤¢ «  ¯à®â®ª®« .
     */
    private macro endTable(dataSet)
  // ‘¯¥æ¨ä¨ª æ¨ï:
  //      à¨¬¥à à á¯¥ç â ­­®£® ¯à®â®ª®« :
  //      ˆ’ŽƒŽ                                                                                                      342800.00        342800.00        342800.00        342800.00        342800.00        342800.00        342800.00        342800.00        342800.00        342800.00
        [ ˆ’ŽƒŽ                                                                                                ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
        (
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    private macro endTableRow1(dataSet)
        [ ˆ’ŽƒŽ                                                                                ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
        (
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    private macro endTableRow1_2922(dataSet)
        [ ˆ’ŽƒŽ                                                                                                                           ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
        (
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    macro printProtocolRow1(dataSet)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTableRow1(dataSet);
            while (dataSet.moveNext())
                printStringRow1(dataSet);
            end;
            endTableRow1(itogRecord);
        else
            printNullData();
        end;
    end;

    macro printProtocolRow1_2922(dataSet)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTableRow1_2922(dataSet);
            while (dataSet.moveNext())
                printStringRow1_2922(dataSet);
            end;
            endTableRow1_2922(itogRecord);
        else
            printNullData();
        end;
    end;

end;

class (TCbAccountDataSourceProtocol) TCbAccountDataSourceProtocol2926_2()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
        [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
         ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³   „ â    ³ Žáâ â®ª áç¥â   ³    áç¥â­ë©   ³ íª-®ä¨á/³   „ â    ³‘ã¬¬  ­ ç¨á«¥­- ³                                                         ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
         ³                         ³  à¨ï  ³          ³                ³    à¥§¥à¢     ³  ­®¬¥à   ³ ¯®£ è¥­¨ï³ ­ëå/­ à é¥­­ëå ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ³                         ³ª ç¥áâ-³ ¯®£ è¥­¨ï³   ¢ àã¡«ïå     ³               ³  ¯à®æ.   ³ ¯à®æ¥­â®¢³  ¯à®æ¥­â®¢ ¢   ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³    ¤® 30 ¤­¥©  ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
         ³                         ³  ¢    ³          ³                ³               ³ ¤®£®¢®à  ³          ³     àã¡«ïå     ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro beginTableRow1()
        [ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
         ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³     à®æ¥­â    ³ Žáâ â®ª áç¥â   ³    ‡­ ç¥­¨¥    ³   ®¬¥à áç¥â  à¥§¥à¢    ³ Žáâ â®ª áç¥â   ³      ‘ã¬¬ ,    ³                                                         ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
         ³                         ³  à¨ï  ³ à¥§¥à¢¨à®¢ ­¨ï ³                ³   ¯à¨¬¥ç ­¨ï   ³                         ³    à¥§¥à¢  /   ³   ¢®è¥¤è ï ¢   ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
         ³                         ³ª ç¥áâ-³                ³   ¢ àã¡«ïå     ³  "¥á­¨¦ ¥¬ë©  ³                         ³    áç¥â­ë©    ³      ®âç¥â     ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³    ¤® 30 ¤­¥©  ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
         ³                         ³  ¢    ³                ³                ³    ®áâ â®ª"    ³                         ³     à¥§¥à¢     ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
         ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
        var boStr = "";

        if ((dataSet.backOffice != null) or (dataSet.number != null))
            boStr = string(nvl(dataSet.backOffice, "")) + "/" + string(nvl(dataSet.number, ""));
        end;

        [ #########################       # ########## ################ ############### ########## ########## ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
        (
            dataSet.account:r,
            NVL(dataSet.qualityCategory, ""),
            NVL(dataSet.acc_maturityDate, ""),
            NVL(dataSet.acc_outCoverRest, ""):0:2,
            ternary(dataSet.qualityCategory == 2, NVL(dataSet.calcReserveAmount, ""), "-"):r,
            boStr,
            NVL(dataSet.maturitydate, ""):0:2,
            NVL(dataSet.roubleSum, ""):0:2,
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    private macro printRevaluationString(dataSet)

        [ #########################       # ########## ################]
        (
            dataSet.account:r,
            "",
            "",
            NVL(dataSet.acc_outCoverRest, ""):0:2
        );
    end;

   private macro printStringRow1(dataSet)
        var boStr = "";
        if ((dataSet.backOffice != null) or (dataSet.number != null))
            boStr = string(nvl(dataSet.backOffice, "")) + "/" + string(nvl(dataSet.number, ""));
        end;

        [ #########################       # ################ ################ ################ ######################### ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]

        (
            dataSet.account:r,
            ternary((SubStr(dataSet.account, 1, 3) == "202"), "-", NVL(dataSet.qualityCategory, "")),
            NVL(dataSet.reservePercent, ""):0:2,
            NVL(dataSet.rest, ""):0:2,
            NVL(dataSet.restNotDown, ""):0:2,
            NVL(dataSet.reserveAccount, "-"):r,
            NVL(dataSet.reserveSum, "-"):r,
            NVL(dataSet.acc_outCoverRest, ""):0:2,
            dataSet.column2:0:2,
            dataSet.column3:0:2,
            dataSet.column4:0:2,
            dataSet.column5:0:2,
            dataSet.column6:0:2,
            dataSet.column7:0:2,
            dataSet.column8:0:2,
            dataSet.column9:0:2,
            dataSet.column10:0:2,
            dataSet.column11:0:2
        );
    end;

    macro printProtocol(dataSet, dataSetRevaluation)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTable(dataSet);
            while (dataSet.moveNext())
                printString(dataSet);
                if (dataSetRevaluation != null)
                    dataSetRevaluation.moveFirst();
                    while (not dataSetRevaluation.EOF)
                        if (dataSet.t_accountId == dataSetRevaluation.t_accountIdRef)
                            printRevaluationString(dataSetRevaluation);
                        end;

                        dataSetRevaluation.moveNext()
                    end;
                end;
            end;
        else
            printNullData();
        end;
    end;

    macro printProtocolRow1(dataSet)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTableRow1(dataSet);
            while (dataSet.moveNext())
                printStringRow1(dataSet);
            end;
        else
            printNullData();
        end;
    end;
end;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â  ¯® ¤ ­­ë¬ "„®£®¢®à  Loans".
 */
class (TDataSourceProtocol) T125LoansCreditDataSourceProtocol()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³      ®¬¥à ¤®£®¢®à      ³   ’¨¯   ³         ’¨¯       ³   „ â    ³      ‚¨¤ à¥£¨áâà         ³     Cã¬¬       ³                                                          ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
 ³                         ³ ¤®£®¢®à ³       ¢ë¤ ç¨      ³ ¯®£ è¥­¨ï³          /               ³                ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                         ³         ³                   ³          ³      ¤®¯. ¯à¨§­ ª        ³                ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³   ¤® 30 ¤­¥©   ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤    ³
 ³                         ³         ³                   ³          ³                          ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                 ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
[ ######################### ######### ################### ########## ########################## ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ #################]
(dataSet.number:r,
dataSet.creditType,
dataSet.creditIssueType,
NVL(dataSet.demanddate, ""),
dataSet.type:w,
NVL(dataSet.sum, ""):r,
NVL(dataSet.column2, ""):r,
NVL(dataSet.column3, ""):r,
NVL(dataSet.column4, ""):r,
NVL(dataSet.column5, ""):r,
NVL(dataSet.column6, ""):r,
NVL(dataSet.column7, ""):r,
NVL(dataSet.column8, ""):r,
NVL(dataSet.column9, ""):r,
NVL(dataSet.column10, ""):r,
NVL(dataSet.column11, ""):r);
    end;

    /**
     * ¥ç âì ¯®¤¢ «  ¯à®â®ª®« .
     */
    private macro endTable(dataSet)
[ ˆ’ŽƒŽ                                                                                                          ################ ################ ################ ################ ################ ################ ################ ################ ################ #################]
(
NVL(dataSet.column2, ""):r,
NVL(dataSet.column3, ""):r,
NVL(dataSet.column4, ""):r,
NVL(dataSet.column5, ""):r,
NVL(dataSet.column6, ""):r,
NVL(dataSet.column7, ""):r,
NVL(dataSet.column8, ""):r,
NVL(dataSet.column9, ""):r,
NVL(dataSet.column10, ""):r,
NVL(dataSet.column11, ""):r);
    end;
end;

class (TDataSourceProtocol) T125LoansCreditDataSourceProtocol2926_2()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³      ®¬¥à ¤®£®¢®à      ³   ’¨¯   ³         ’¨¯       ³   „ â    ³      ‚¨¤ ®¡ê¥ªâ          ³    Cã¬¬       ³    Cã¬¬ ,     ³                                                          ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                        ³
 ³                         ³ ¤®£®¢®à ³       ¢ë¤ ç¨      ³ ¯®£ è¥­¨ï³                          ³  ¯® ®¡ê¥ªâã   ³   ¢®è¥¤è ï    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                         ³         ³                   ³          ³                          ³               ³   ¢ ®âç¥â     ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³   ¤® 30 ¤­¥©   ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤    ³
 ³                         ³         ³                   ³          ³                          ³               ³               ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                 ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
[ ######################### ######### ################### ########## ########################## ############### ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ #################]
(dataSet.number:r,
dataSet.creditType,
dataSet.creditIssueType,
NVL(dataSet.demanddate, ""),
dataSet.type:w,
NVL(dataSet.objectSum, ""):r,
NVL(dataSet.sum, ""):r,
NVL(dataSet.column2, ""):r,
NVL(dataSet.column3, ""):r,
NVL(dataSet.column4, ""):r,
NVL(dataSet.column5, ""):r,
NVL(dataSet.column6, ""):r,
NVL(dataSet.column7, ""):r,
NVL(dataSet.column8, ""):r,
NVL(dataSet.column9, ""):r,
NVL(dataSet.column10, ""):r,
NVL(dataSet.column11, ""):r);
    end;

    macro printProtocol(dataSet)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTable(dataSet);
            while (dataSet.moveNext())
                printString(dataSet);
            end;
        else
            printNullData();
        end;
    end;
end;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â  ¯® ¤ ­­ë¬ "„¥¯®§¨âë ä¨§. «¨æ".
 */
class (TDataSourceProtocol) T125RetailDepositDataSourceProtocol()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³      ®¬¥à ¤®£®¢®à      ³   „ â    ³    Žáâ â®ª     ³‘ã¬¬  ­ à é¥­­ëå³   „ â    ³ ‘ã¬¬  ­ ç¨á«¥­.³                                                          ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                       ³
 ³                         ³ ¯®£ è¥­¨ï³   ¢ àã¡«ïå     ³   ¯à®æ¥­â®¢    ³ ¯®£ è¥­¨ï³   ¯à®æ¥­â®¢    ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                         ³          ³                ³   ¢ àã¡«ïå     ³ ¯à®æ¥­â®¢³    ¢ àã¡«ïå    ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³   ¤® 30 ¤­¥©   ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
 ³                         ³          ³                ³                ³          ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];

    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
[ ######################### ########## ################ ################ ########## ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
(dataSet.number:r,
NVL(dataSet.maturityDate, ""),
dataSet.outrest,
dataSet.accruedinteresaccountvalue,
NVL(dataSet.interestmaturitydate, ""),
dataSet.interestaccountvalue,
NVL(dataSet.column2, ""):r,
NVL(dataSet.column3, ""):r,
NVL(dataSet.column4, ""):r,
NVL(dataSet.column5, ""):r,
NVL(dataSet.column6, ""):r,
NVL(dataSet.column7, ""):r,
NVL(dataSet.column8, ""):r,
NVL(dataSet.column9, ""):r,
NVL(dataSet.column10, ""):r,
NVL(dataSet.column11, ""):r);
    end;

    macro printProtocol(dataSet)

        dataSet.moveNext();

        if (not dataSet.EOF)
            beginTable(dataSet);
            while (dataSet.moveNext())
                printString(dataSet);
            end;
        else
            printNullData();
        end;
    end;
end;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â  ¯® ¤ ­­ë¬ "„®£®¢®à  „¥¯®§¨â®¢".
 */
class (TDataSourceProtocol) T125DepositsDataSourceProtocol()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³      ®¬¥à ¤®£®¢®à      ³        ‚¨¤        ³      ‚¨¤ à¥£¨áâà         ³   „ â    ³     Cã¬¬       ³                                                          ‘ã¬¬  ¯® áà®ª ¬, ®áâ ¢è¨¬áï ¤® ¯®£ è¥­¨ï                                                                       ³
 ³                         ³      ¤¥¯®§¨â      ³          /               ³ ¯®£ è¥­¨ï³                ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                         ³                   ³      ¤®¯. ¯à¨§­ ª        ³          ³                ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³   ¤® 30 ¤­¥©   ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
 ³                         ³                   ³                          ³          ³                ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
[ ######################### ################### ########################## ########## ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
(dataSet.number:r,
dataSet.depositIssueType:w,
dataSet.type:w,
NVL(dataSet.demanddate, ""),
NVL(dataSet.sum, ""):r,
NVL(dataSet.column2, ""):r,
NVL(dataSet.column3, ""):r,
NVL(dataSet.column4, ""):r,
NVL(dataSet.column5, ""):r,
NVL(dataSet.column6, ""):r,
NVL(dataSet.column7, ""):r,
NVL(dataSet.column8, ""):r,
NVL(dataSet.column9, ""):r,
NVL(dataSet.column10, ""):r,
NVL(dataSet.column11, ""):r);
    end;

    macro printProtocol(dataSet)
        var itogRecord;

        dataSet.moveNext();

        if (not dataSet.EOF)
            itogRecord = dataset.getRecord();
            beginTable(dataSet);
            while (dataSet.moveNext())
                printString(dataSet);
            end;
        else
            printNullData();
        end;
    end;
end;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â  ¯® ¯®«ì§®¢ â¥«ìáª¨¬ ¤ ­­ë¬.
 */
class (TDataSourceProtocol) TUserDataSourceProtocol()

    /**
     * ¥ç âì è ¯ª¨ ¯à®â®ª®« .
     */
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³„® ¢®áâà¥¡®¢ ­¨ï³   ¤® 5 ¤­¥©    ³   ¤® 10 ¤­¥©   ³   ¤® 20 ¤­¥©   ³   ¤® 30 ¤­¥©   ³   ¤® 90 ¤­¥©   ³   ¤® 180 ¤­¥©  ³   ¤® 270 ¤­¥©  ³    ¤® 1 £®¤    ³  á¢ëè¥ 1 £®¤   ³
 ³  ¨ ­  1 ¤¥­ì   ³                ³                ³                ³                ³                ³                ³                ³                ³                ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    /**
     * ¥ç âì áâà®ª¨ ¯à®â®ª®« .
     */
    private macro printString(dataSet)
[ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
(
NVL(dataSet.fieldValue("column2").exact, ""):r,
NVL(dataSet.fieldValue("column3").exact, ""):r,
NVL(dataSet.fieldValue("column4").exact, ""):r,
NVL(dataSet.fieldValue("column5").exact, ""):r,
NVL(dataSet.fieldValue("column6").exact, ""):r,
NVL(dataSet.fieldValue("column7").exact, ""):r,
NVL(dataSet.fieldValue("column8").exact, ""):r,
NVL(dataSet.fieldValue("column9").exact, ""):r,
NVL(dataSet.fieldValue("column10").exact, ""):r,
NVL(dataSet.fieldValue("column11").exact, ""):r);
    end;

    macro printProtocol(dataSet, total)
        if (dataSet.size > 0)
            var i = 0;

            beginTable();
            while (i < dataSet.size)
                printString(dataSet[i]);
                i = i + 1;
            end;
        else
            printNullData();
        end;
    end;
end;
