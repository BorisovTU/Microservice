/*
$Name:        f125interface.mac
$Module:      Регламентируемая отчетность
$Description: Доступ к операциям формы 125
*/
/**
 * Форма 125. Доступ к операциям формы.
 *
 * @since   20.05.2009
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
import ReptCBInter;
import RcbCoreInter;

import rcbimport;

import f125Attribute;
import f125Part;
import f125Report;

import f125Global;
import f125ObjectFactory;
import f125CalculationProtocolView;
import f125PartCalculateController;
import f125KlikoExportController;
import f125KlikoView;
import f125PtkPsdExportController;
import f125PtkPsdView;
import f125DataSourceFilters;
import f125DataSourceProtocols;
import f125DataSources;
import f125TuneTable;
import f125PrintProtocolView;
import f125ReportView;
import f125ReportCalculateController;
import f125ReportPrintController;
import ReportNormalizer;
import f125Normalizer;
import f125NormalizationProtocol;
import f125NormalizationController;
/**
 *  Запуск операции расчета отчета
 */
macro executeCalculationOperation()
     global.initializeRepDataPackage();
     objectFactoryInstance.createReportCalculateController().calculate();
     if (objectFactoryInstance.createNormalizationController())
        objectFactoryInstance.createNormalizationController().execute();
     end;
     RcbApplication().TransactionManager().commit();
end;

/**
 *  Запуск операции печати отчета
 */
macro executePrintOperation()
    objectFactoryInstance.createReportPrintController().execute();
end;

/**
 *  Запуск операции экспорта в kliko.exe
 */
macro executeKlikoExportOperation()
    objectFactoryInstance.createKlikoExportController().execute();
end;

/**
 *  Запуск операции экспорта в ПТК ПСД
 */
macro executePtkPsdExportOperation()
    objectFactoryInstance.createPtkPsdExportController().execute();
end;


установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
