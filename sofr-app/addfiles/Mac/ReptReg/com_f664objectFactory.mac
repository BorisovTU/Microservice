/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Форма 664. Классы фабрик объектов.

   CREATED : 13.01.10 Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────- */
/**
 *  Интеры и модели подсистемы
 */
import repException;

/**
 * Фабрика объектов.
 * Реализует порождающий паттерн "Одиночка" (см. Related Diagrams).
 */
class TObjectFactory()
    /**
     * Создать печатную форму
     */
    macro createPrintableForm() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintableForm"));
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1PrintableForm() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createIssue1PrintableForm"));
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2PrintableForm() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createIssue2PrintableForm"));
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3PrintableForm() : Object
        throw(TPureVirtualMethodCallException("TObjectFactory::createIssue3PrintableForm"));
    end;

    /**
     * Конструктор.
     */
    macro constructor()
    end;

    constructor();
end;

/**
 * Фабрика объектов для указаний до 1747-У.
 */
class (TObjectFactory) TObjectFactoryBefore1747()

    /**
     * Создать печатную форму
     */
    macro createPrintableForm() : Object
        return null;
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1PrintableForm() : Object
        return null;
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2PrintableForm() : Object
        return null;
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3PrintableForm() : Object
        return null;
    end;

    /**
     * Конструктор.
     */
    macro constructor()
        initTObjectFactory();
    end;
    
    constructor();
end;

/**
 * Фабрика объектов для 1747-У.
 */
class (TObjectFactory) TObjectFactory1747()

    /**
     * Создать печатную форму
     */
    macro createPrintableForm(rootAttributeName : String) : Object
        return genObject("TPrintableForm664_I1747", rootAttributeName);
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue1PrintableForm664_I1747", rootAttributeName);
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2PrintableForm(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue2PrintableForm664_I1747", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue3PrintableForm664_I1747", rootAttributeName);
    end;

    /**
     * Конструктор.
     */
    macro constructor()
        initTObjectFactory();
    end;
    
    constructor();
end;

/**
 * Фабрика объектов для 2332-У.
 */
class (TObjectFactory) TObjectFactory2332()

    /**
     * Создать печатную форму
     */
    macro createPrintableForm(rootAttributeName : String) : Object
        return genObject("TPrintableForm664_I2332", rootAttributeName);
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue1PrintableForm664_I2332", rootAttributeName);
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2PrintableForm(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue2PrintableForm664_I2332", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue3PrintableForm664_I2332", rootAttributeName);
    end;

    /**
     * Конструктор.
     */
    macro constructor()
        initTObjectFactory();
    end;
    
    constructor();
end;

/**
 * Фабрика объектов для 2470-У.
 */
class (TObjectFactory) TObjectFactory2470()

    /**
     * Создать печатную форму
     */
    macro createPrintableForm(rootAttributeName : String) : Object
        return genObject("TPrintableForm664_I2332", rootAttributeName);
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue1PrintableForm664_I2470", rootAttributeName);
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2PrintableForm(rootAttributeName : String) : Object
        return genObject("TIssue2PrintableForm664_I2470", rootAttributeName);
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3PrintableForm(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue3PrintableForm664_I2470", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Создать печатную форму 4 раздела
     */
    macro createIssue4PrintableForm(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue4PrintableForm664_I2470", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Конструктор.
     */
    macro constructor()
        initTObjectFactory();
    end;
    
    constructor();
end;

/**
 * Глобальная ссылка для хранения одиночки.
 */    
private var m_objectFactory = null;

/**
 * Точка доступа к одиночке.
 */
macro objectFactoryInstanceF664() : TObjectFactory
    if (m_objectFactory == null)
        if (rcbApplication().currentReport.context.period.endDate >= RCB_I2470_DATE3)
            m_objectFactory = TObjectFactory2470();
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
            m_objectFactory = TObjectFactory2332();
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I1747_DATE)
            m_objectFactory = TObjectFactory1747();
        else
            m_objectFactory = TObjectFactoryBefore1747();
        end;
    end;
    
    return m_objectFactory;
end;
