/* ------------------------------------------------------------------------ *
 * Модуль для ведения протоколов.	     Титаров Петр (TPS), 22.04.1998 *
 * ------------------------------------------------------------------------ */

/* ============================= Декларации =============================== */
                        
/* Тип сообщения */
const TPS_ERROR     = 0;	/* Сообщение об ошибке 			*/
const TPS_WARNING   = 1;        /* Предупреждение 			*/
const TPS_MESSAGE   = 2;        /* Информационное сообщение 		*/
const TPS_DETAILS   = 3;        /* Продолжение предыдущего сообщения 	*/
const TPS_TOPIC     = 4;	/* Начало раздела 			*/

array MsgTypeString;
MsgTypeString(0) = "!!!";
MsgTypeString(1) = "???";
MsgTypeString(2) = "   ";
MsgTypeString(3) = "      ";
MsgTypeString(4) = "***";

/* ======================= Запись протокола в файл ======================== */
macro OutputDebugString(l,msg,type)
    if(type!=TPS_DETAILS)
    	l.str = MsgTypeString(type) + " " + string(time()) + " " + msg;
    else
    	l.str = MsgTypeString(type) + " " + msg;
    end;
    Insert(l);
end;

macro OutputDebugStringLn(l,msg,type)
    OutputDebugString(l,msg,type);
    l.str = " ";
    Insert(l);
end;    

/* ================== Выдача протокола на стандартный вывод =============== */
macro PrintDebugString(msg,type)
    var str;
    if(type!=TPS_DETAILS)
    	str = MsgTypeString(type) + " " + string(time()) + " " + msg;
    else
    	str = MsgTypeString(type) + " " + msg;
    end;
    println(str);
end;

macro PrintDebugStringLn(msg,type)
    PrintDebugString(msg,type);
    println(" ");
end;    

