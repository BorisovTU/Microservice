/*
$Name:          print_f711Part3.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 711. Печатная форма раздела 3
*/

import com_f711;

/**
 *  Базовое печатное представление таблиц раздела 3
 */
class (TPartView) TSection3View()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Номер государст-    │       Код ISIN        │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                    Количество ценных бумаг, штук                                                     │       Примечание     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ венной регистрации  │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │               │                  │ эмитента      │                   │ ценной бумаги       │                       │ маги       │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права из   │ переданных в │ переданных в │   принятых   │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print(" в ед. валюты ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которых пере-│ залог по обя-│ залог по обя-│    в залог   │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("   номинала   ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│  157 │      158     │      159      │       160     │        161       │      162      │        163        │         164         │           165         │     166    │");printFillLeft(" ");print("      167     ");printFillRight(" ");println("│      168     │      169     │       170    │      171     │      172     │      173     │      174     │      175     │      176     │           177        │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;

    macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object

        var current = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("FaceValue").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("FaceValuePoint").exact));
        end;

        return arrCreate(current.fieldValue("counter").currentAsString,
                         current.fieldValue("IssuerName").currentAsString,
                         current.fieldValue("IssuerINN").currentAsString,
                         current.fieldValue("IssuerKPP").currentAsString,
                         current.fieldValue("IssuerOGRN").currentAsString,
                         current.fieldValue("IssuerCountryCode").currentAsString,
                         current.fieldValue("Code711").currentAsString,
                         current.fieldValue("LSIN").currentAsString,
                         current.fieldValue("ISIN").currentAsString,
                         current.fieldValue("FaceValueFICode").currentAsString,
                         faceValue,
                         current.fieldValue("SaleREPOAmount").currentAsString,
                         current.fieldValue("TransLoanAmount").currentAsString,
                         current.fieldValue("BuyREPOAmount").currentAsString,
                         current.fieldValue("AcceptLoanAmount").currentAsString,
                         current.fieldValue("TransDUAmount").currentAsString,
                         current.fieldValue("TransRightsDUAmount").currentAsString,
                         current.fieldValue("TransPledgeBOAmount").currentAsString,
                         current.fieldValue("TransPledgeAmount").currentAsString,
                         current.fieldValue("AcceptPledgeAmount").currentAsString,
                         current.fieldValue("note").currentAsString
                        );

    end;

    private macro constructorTSection3View()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел3", "FaceValue", "FaceValuePoint", 14, true);

        m_table.addColumn("157", 4,  AL_CENTER);
        m_table.addColumn("158", 12, AL_LEFT);
        m_table.addColumn("159", 13, AL_LEFT);
        m_table.addColumn("160", 13, AL_LEFT);
        m_table.addColumn("161", 16, AL_LEFT);
        m_table.addColumn("162", 13, AL_LEFT);
        m_table.addColumn("163", 17 , AL_LEFT);
        m_table.addColumn("164", 19, AL_LEFT);
        m_table.addColumn("165", 21, AL_LEFT);
        m_table.addColumn("166", 10, AL_LEFT);
        m_table.addColumn("167", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("168", 12, AL_RIGHT);
        m_table.addColumn("169", 12, AL_RIGHT);
        m_table.addColumn("170", 12, AL_RIGHT);
        m_table.addColumn("171", 12, AL_RIGHT);
        m_table.addColumn("172", 12, AL_RIGHT);
        m_table.addColumn("173", 12, AL_RIGHT);
        m_table.addColumn("174", 12, AL_RIGHT);
        m_table.addColumn("175", 12, AL_RIGHT);
        m_table.addColumn("176", 12, AL_RIGHT);
        m_table.addColumn("177", 20, AL_LEFT);
    end;

    constructorTSection3View();

end;


class (TSection3View) TSection3View_I4212()

    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Государственный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                                Количество ценных бумаг, штук                                                                                     │       Примечание     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │   регистрационный   │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │               │                  │ эмитента      │                   │    номер выпуска    │                       │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права из   │ переданных в │ переданных в │   принятых   │ учитываемых  │  ограничено  │    введен    │ под арестом  │                      │");
        print("│      │              │               │               │                  │               │                   │  ценных бумаг или   │                       │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которых пере-│ залог по обя-│ залог по обя-│    в залог   │ на торговых  │ распоряжение │  запрет на   │              │                      │");
        print("│      │              │               │               │                  │               │                   │  идентификационный  │                       │            │");printFillLeft(" ");print(" в ед. валюты ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │(клиринговых) │  в связи с   │осуществление │              │                      │");
        print("│      │              │               │               │                  │               │                   │    номер выпуска    │                       │            │");printFillLeft(" ");print("   номинала   ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │ счетах депо  │корпоративными│   операций   │              │                      │");
        print("│      │              │               │               │                  │               │                   │    ценных бумаг     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │              │  действиями  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│  191 │     192      │      193      │       194     │        195       │      196      │        197        │         198         │           199         │     200    │");printFillLeft(" ");print("      201     ");printFillRight(" ");println("│      202     │      203     │       204    │      205     │      206     │      207     │      208     │      209     │      210     │      211     │      212     │      213     │      214     │           215        │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;

    macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("FaceValue").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("FaceValuePoint").exact));
        end;

        return arrCreate(current.fieldValue("counter").currentAsString,
                         current.fieldValue("IssuerName").currentAsString,
                         current.fieldValue("IssuerINN").currentAsString,
                         current.fieldValue("IssuerKPP").currentAsString,
                         current.fieldValue("IssuerOGRN").currentAsString,
                         current.fieldValue("IssuerCountryCode").currentAsString,
                         current.fieldValue("Code711").currentAsString,
                         current.fieldValue("LSIN").currentAsString,
                         current.fieldValue("ISIN").currentAsString,
                         current.fieldValue("FaceValueFICode").currentAsString,
                         faceValue,
                         current.fieldValue("SaleREPOAmount").currentAsString,
                         current.fieldValue("TransLoanAmount").currentAsString,
                         current.fieldValue("BuyREPOAmount").currentAsString,
                         current.fieldValue("AcceptLoanAmount").currentAsString,
                         current.fieldValue("TransDUAmount").currentAsString,
                         current.fieldValue("TransRightsDUAmount").currentAsString,
                         current.fieldValue("TransPledgeBOAmount").currentAsString,
                         current.fieldValue("TransPledgeAmount").currentAsString,
                         current.fieldValue("AcceptPledgeAmount").currentAsString,
                         current.fieldValue("ТогрСчета").currentAsString,
                         current.fieldValue("ОгранКД").currentAsString,
                         current.fieldValue("ЗапретОпер").currentAsString,
                         current.fieldValue("Арест").currentAsString,
                         current.fieldValue("note").currentAsString
                        );
    end;

    private macro constructorTSection3View_I4212()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел3", "FaceValue", "FaceValuePoint", 14, true);

        m_table.addColumn("191",  4, AL_CENTER);
        m_table.addColumn("192", 12, AL_LEFT);
        m_table.addColumn("193", 13, AL_LEFT);
        m_table.addColumn("194", 13, AL_LEFT);
        m_table.addColumn("195", 16, AL_LEFT);
        m_table.addColumn("196", 13, AL_LEFT);
        m_table.addColumn("197", 17, AL_LEFT);
        m_table.addColumn("198", 19, AL_LEFT);
        m_table.addColumn("199", 21, AL_LEFT);
        m_table.addColumn("200", 10, AL_LEFT);
        m_table.addColumn("201", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("202", 12, AL_RIGHT);
        m_table.addColumn("203", 12, AL_RIGHT);
        m_table.addColumn("204", 12, AL_RIGHT);
        m_table.addColumn("205", 12, AL_RIGHT);
        m_table.addColumn("206", 12, AL_RIGHT);
        m_table.addColumn("207", 12, AL_RIGHT);
        m_table.addColumn("208", 12, AL_RIGHT);
        m_table.addColumn("209", 12, AL_RIGHT);
        m_table.addColumn("210", 12, AL_RIGHT);
        m_table.addColumn("211", 12, AL_RIGHT);
        m_table.addColumn("212", 12, AL_RIGHT);
        m_table.addColumn("213", 12, AL_RIGHT);
        m_table.addColumn("214", 12, AL_RIGHT);
        m_table.addColumn("215", 20, AL_LEFT);
    end;

    constructorTSection3View_I4212();
end;

class (TSection3View) TSection3View_I4637()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Государственный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                                Количество ценных бумаг, шт.                                                                                      │       Примечание     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │   регистрационный   │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │               │                  │ эмитента      │                   │    номер выпуска    │                       │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права из   │ переданных в │ переданных в │   принятых   │ учитываемых  │  ограничено  │    введен    │ под арестом  │                      │");
        print("│      │              │               │               │                  │               │                   │  ценных бумаг или   │                       │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которых пере-│ залог по обя-│ залог по обя-│    в залог   │ на торговых  │ распоряжение │  запрет на   │              │                      │");
        print("│      │              │               │               │                  │               │                   │  идентификационный  │                       │            │");printFillLeft(" ");print(" в ед. валюты ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │(клиринговых) │  в связи с   │осуществление │              │                      │");
        print("│      │              │               │               │                  │               │                   │    номер выпуска    │                       │            │");printFillLeft(" ");print("   номинала   ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │ счетах депо  │корпоративными│   операций   │              │                      │");
        print("│      │              │               │               │                  │               │                   │    ценных бумаг     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │              │  действиями  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│  210 │     211      │      212      │       213     │        214       │      215      │        216        │         217         │           218         │     219    │");printFillLeft(" ");print("      220     ");printFillRight(" ");println("│      221     │      222     │       223    │      224     │      225     │      226     │      227     │      228     │      229     │      230     │      231     │      232     │      233     │           234        │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;

    macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("FaceValue").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("FaceValuePoint").exact));
        end;

        return arrCreate(current.fieldValue("counter").currentAsString,
                         current.fieldValue("IssuerName").currentAsString,
                         current.fieldValue("IssuerINN").currentAsString,
                         current.fieldValue("IssuerKPP").currentAsString,
                         current.fieldValue("IssuerOGRN").currentAsString,
                         current.fieldValue("IssuerCountryCode").currentAsString,
                         current.fieldValue("Code711").currentAsString,
                         current.fieldValue("LSIN").currentAsString,
                         current.fieldValue("ISIN").currentAsString,
                         current.fieldValue("FaceValueFICode").currentAsString,
                         faceValue,
                         current.fieldValue("SaleREPOAmount").currentAsString,
                         current.fieldValue("TransLoanAmount").currentAsString,
                         current.fieldValue("BuyREPOAmount").currentAsString,
                         current.fieldValue("AcceptLoanAmount").currentAsString,
                         current.fieldValue("TransDUAmount").currentAsString,
                         current.fieldValue("TransRightsDUAmount").currentAsString,
                         current.fieldValue("TransPledgeBOAmount").currentAsString,
                         current.fieldValue("TransPledgeAmount").currentAsString,
                         current.fieldValue("AcceptPledgeAmount").currentAsString,
                         current.fieldValue("ТогрСчета").currentAsString,
                         current.fieldValue("ОгранКД").currentAsString,
                         current.fieldValue("ЗапретОпер").currentAsString,
                         current.fieldValue("Арест").currentAsString,
                         current.fieldValue("note").currentAsString
                        );
    end;

    private macro constructorTSection3View_I4637()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел3", "FaceValue", "FaceValuePoint", 14, true);

        m_table.addColumn("210",  4, AL_CENTER);
        m_table.addColumn("211", 12, AL_LEFT);
        m_table.addColumn("212", 13, AL_LEFT);
        m_table.addColumn("213", 13, AL_LEFT);
        m_table.addColumn("214", 16, AL_LEFT);
        m_table.addColumn("215", 13, AL_LEFT);
        m_table.addColumn("216", 17, AL_LEFT);
        m_table.addColumn("217", 19, AL_LEFT);
        m_table.addColumn("218", 21, AL_LEFT);
        m_table.addColumn("219", 10, AL_LEFT);
        m_table.addColumn("220", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("221", 12, AL_RIGHT);
        m_table.addColumn("222", 12, AL_RIGHT);
        m_table.addColumn("223", 12, AL_RIGHT);
        m_table.addColumn("224", 12, AL_RIGHT);
        m_table.addColumn("225", 12, AL_RIGHT);
        m_table.addColumn("226", 12, AL_RIGHT);
        m_table.addColumn("227", 12, AL_RIGHT);
        m_table.addColumn("228", 12, AL_RIGHT);
        m_table.addColumn("229", 12, AL_RIGHT);
        m_table.addColumn("230", 12, AL_RIGHT);
        m_table.addColumn("231", 12, AL_RIGHT);
        m_table.addColumn("232", 12, AL_RIGHT);
        m_table.addColumn("233", 12, AL_RIGHT);
        m_table.addColumn("234", 20, AL_LEFT);
    end;

    constructorTSection3View_I4637();
end;

class (TSection3View_I4637) TSection3View_I4927()
    initTSection3View_I4637();

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Государственный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                                Количество ценных бумаг, шт.                                                                                      │       Примечание     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │   регистрационный   │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │               │                  │ эмитента      │                   │    номер выпуска    │                       │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права из   │ переданных в │ переданных в │   принятых   │ учитываемых  │  ограничено  │    введен    │ под арестом  │                      │");
        print("│      │              │               │               │                  │               │                   │  ценных бумаг или   │                       │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которых пере-│ залог по обя-│ залог по обя-│    в залог   │ на торговых  │ распоряжение │  запрет на   │              │                      │");
        print("│      │              │               │               │                  │               │                   │  идентификационный  │                       │            │");printFillLeft(" ");print(" в ед. валюты ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │(клиринговых) │  в связи с   │осуществление │              │                      │");
        print("│      │              │               │               │                  │               │                   │    номер выпуска    │                       │            │");printFillLeft(" ");print("   номинала   ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │ счетах депо  │корпоративными│   операций   │              │                      │");
        print("│      │              │               │               │                  │               │                   │    ценных бумаг     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │              │  действиями  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│  214 │     215      │      216      │       217     │        218       │      219      │        220        │         221         │           222         │     223    │");printFillLeft(" ");print("      224     ");printFillRight(" ");println("│      225     │      226     │       227    │      228     │      229     │      230     │      231     │      232     │      233     │      234     │      235     │      236     │      237     │           238        │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;
end;

class (TSection3View_I4927) TSection3View_I5456()
    initTSection3View_I4927();

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Регистрационный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                                Количество ценных бумаг, шт.                                                                                      │       Примечание     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │    номер выпуска    │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │               │                  │ эмитента      │                   │    ценных бумаг     │                       │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права по   │ переданных в │ переданных в │   принятых   │ учитываемых  │ распоряжение │ по которым   │ под арестом  │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которым пере-│ залог по обя-│ залог по обя-│    в залог   │ на торговых  │   которыми   │    введен    │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print(" в ед. валюты ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │(клиринговых) │  ограничено  │  запрет на   │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("   номинала   ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │ счетах депо  │  в связи с   │осуществление │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │              │корпоративными│   операций   │              │                      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │              │              │              │              │              │  действиями  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│   1  │      2       │        3      │        4      │         5        │       6       │          7        │           8         │            9          │      10    │");printFillLeft(" ");print("       11     ");printFillRight(" ");println("│       12     │       13     │        14    │       15     │       16     │       17     │       18     │       19     │       20     │       21     │       22     │       23     │       24     │           25         │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;
end;

class (TSection3View_I5456) TSection3View_I5986()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │   Код страны  │ Тип ценной бумаги │Регистрационный номер│       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                                Количество ценных бумаг, шт.                                                                                      │       Примечание     │");
        print("│строки│ эмитента     │               │                  │    эмитента   │ (вид финансового  │ (идентификационный  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      │");
        print("│      │              │               │                  │    по ОКСМ    │    инструмента)   │   номер) выпуска    │                       │            │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │   права по   │ переданных в │ переданных в │   принятых   │ учитываемых  │ распоряжение │ по которым   │ под арестом  │                      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ доверительное│ которым пере-│ залог по обя-│ залог по обя-│    в залог   │ на торговых  │   которыми   │    введен    │              │                      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ управление   │ даны в дове- │ зательствам  │ зательствам  │              │(клиринговых) │  ограничено  │  запрет на   │              │                      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │     репо     │              │              │   рительное  │  кредитной   │ третьих лиц  │              │ счетах депо  │  в связи с   │осуществление │              │                      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │  управление  │ организации  │              │              │              │корпоративными│   операций   │              │                      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │              │              │              │              │              │  действиями  │              │              │                      │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
        print("│   1  │      2       │        3      │         4        │       5       │          6        │           7         │            8          │      9     │      10    │");printFillLeft(" ");print("       11     ");printFillRight(" ");println("│       12     │       13     │        14    │       15     │       16     │       17     │       18     │       19     │       20     │       21     │       22     │       23     │       24     │           25         │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┤");
    end;

    macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("FaceValue").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("FaceValuePoint").exact));
        end;

        return arrCreate(current.fieldValue("counter").currentAsString,
                         current.fieldValue("IssuerName").currentAsString,
                         current.fieldValue("IssuerINN").currentAsString,
                         current.fieldValue("IssuerOGRN").currentAsString,
                         current.fieldValue("IssuerCountryCode").currentAsString,
                         current.fieldValue("Code711").currentAsString,
                         current.fieldValue("LSIN").currentAsString,
                         current.fieldValue("ISIN").currentAsString,
                         current.fieldValue("КодCFI").currentAsString,
                         current.fieldValue("FaceValueFICode").currentAsString,
                         faceValue,
                         current.fieldValue("SaleREPOAmount").currentAsString,
                         current.fieldValue("TransLoanAmount").currentAsString,
                         current.fieldValue("BuyREPOAmount").currentAsString,
                         current.fieldValue("AcceptLoanAmount").currentAsString,
                         current.fieldValue("TransDUAmount").currentAsString,
                         current.fieldValue("TransRightsDUAmount").currentAsString,
                         current.fieldValue("TransPledgeBOAmount").currentAsString,
                         current.fieldValue("TransPledgeAmount").currentAsString,
                         current.fieldValue("AcceptPledgeAmount").currentAsString,
                         current.fieldValue("ТогрСчета").currentAsString,
                         current.fieldValue("ОгранКД").currentAsString,
                         current.fieldValue("ЗапретОпер").currentAsString,
                         current.fieldValue("Арест").currentAsString,
                         current.fieldValue("note").currentAsString
                        );
    end;

    private macro constructorTSection3View_I5986()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел3", "FaceValue", "FaceValuePoint", 14, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_LEFT);
        m_table.addColumn( "3", 13, AL_LEFT);
        m_table.addColumn( "4", 16, AL_LEFT);
        m_table.addColumn( "5", 13, AL_LEFT);
        m_table.addColumn( "6", 17, AL_LEFT);
        m_table.addColumn( "7", 19, AL_LEFT);
        m_table.addColumn( "8", 21, AL_LEFT);
        m_table.addColumn( "9", 10, AL_LEFT);
        m_table.addColumn("10", 10, AL_LEFT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
        m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 20, AL_LEFT);
    end;

    constructorTSection3View_I5986();
end;

class (TSection3View_I5986) TSection3View_I6406()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader();
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────┬──────────────────────────────────────────────────────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │   Код страны  │ Тип ценной бумаги │Регистрационный номер│       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                  Количество ценных бумаг, шт.                          │       Примечание     │ Код принадлежности контрагента к сектору экономики по сделкам займа ценных бумаг │");
        print("│строки│ эмитента     │               │                  │    эмитента   │ (вид финансового  │       выпуска       │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤                      ┼─────────────────────────────────────────┬────────────────────────────────────────┤");
        print("│      │              │               │                  │    по ОКСМ    │    инструмента)   │                     │                       │            │ маги       │");printFillLeft(" ");print("    одной     ");printFillRight(" ");println("│  переданных  │  переданных  │  полученных  │  полученных  │ переданных в │ переданных в │   принятых   │                      │                переданных               │               полученных               │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("ценной бумаги ");printFillRight(" ");println("│  по сделкам  │  по сделкам  │  по сделкам  │  по сделкам  │ залог по обя-│ залог по обя-│    в залог   │                      │                                         │                                        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│ прямого репо │     займа    │   обратного  │     займа    │ зательствам  │ зательствам  │              │                      │                                         │                                        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │     репо     │              │  кредитной   │ третьих лиц  │              │                      │                                         │                                        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │ организации  │              │              │                      │                                         │                                        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │              │              │              │              │              │              │                      │                                         │                                        │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┼─────────────────────────────────────────┼────────────────────────────────────────┤");
        print("│   1  │      2       │        3      │         4        │       5       │          6        │           7         │            8          │      9     │      10    │");printFillLeft(" ");print("       11     ");printFillRight(" ");println("│       12     │       13     │        14    │       15     │       16     │       17     │       18     │           19         │                    20                   │                    21                  │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────────┼─────────────────────────────────────────┼────────────────────────────────────────┤");
    end;

    macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("FaceValue").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("FaceValuePoint").exact));
        end;

        return arrCreate(current.fieldValue("counter").currentAsString,
                         current.fieldValue("IssuerName").currentAsString,
                         current.fieldValue("IssuerINN").currentAsString,
                         current.fieldValue("IssuerOGRN").currentAsString,
                         current.fieldValue("IssuerCountryCode").currentAsString,
                         current.fieldValue("Code711").currentAsString,
                         current.fieldValue("LSIN").currentAsString,
                         current.fieldValue("ISIN").currentAsString,
                         current.fieldValue("КодCFI").currentAsString,
                         current.fieldValue("FaceValueFICode").currentAsString,
                         faceValue,
                         string(current.fieldValue("SaleREPOAmount").current : * : *, 38, 20),
                         string(current.fieldValue("TransLoanAmount").current : * : *, 38, 20),
                         string(current.fieldValue("BuyREPOAmount").current : * : *, 38, 20),
                         string(current.fieldValue("AcceptLoanAmount").current : * : *, 38, 20),
                         string(current.fieldValue("TransPledgeBOAmount").current : * : *, 38, 20),
                         string(current.fieldValue("TransPledgeAmount").current : * : *, 38, 20),
                         string(current.fieldValue("AcceptPledgeAmount").current : * : *, 38, 20),
                         current.fieldValue("note").currentAsString,
                         current.fieldValue("TransLoanContr").currentAsString,
                         current.fieldValue("AcceptLoanContr").currentAsString
                        );
    end;

    private macro constructorTSection3View_I6406()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел3", "FaceValue", "FaceValuePoint", 14, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_LEFT);
        m_table.addColumn( "3", 13, AL_LEFT);
        m_table.addColumn( "4", 16, AL_LEFT);
        m_table.addColumn( "5", 13, AL_LEFT);
        m_table.addColumn( "6", 17, AL_LEFT);
        m_table.addColumn( "7", 19, AL_LEFT);
        m_table.addColumn( "8", 21, AL_LEFT);
        m_table.addColumn( "9", 10, AL_LEFT);
        m_table.addColumn("10", 10, AL_LEFT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
        m_table.addColumn("19", 20, AL_LEFT);
    end;

    constructorTSection3View_I6406();
end;

/**
 *  Печатное представление подразделов раздела 3
 */
private class (TPartView) TSection3PartView()

    private var m_part : TArray;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro printHeader()
    end;

    macro printFooter()
    end;

    macro getWidth()

        var i;

        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;

    end;

    private macro constructorTSection3PartView()
        initTPartView();

        m_part = arrCreate(TSubpartView("", "", arrCreate(objectFactoryInstance.createSubpart3TableView())));
    end;

    constructorTSection3PartView();

end;

/**
 *  Печатное представление раздела 3
 */
class (TPartView) TPart3View()

    private var m_part : TArray;

    macro printHeader()
        println();
        println("Раздел 3. Операции с ценными бумагами (кроме векселей), переданными кредитной организацией контрагентам на возвратной основе (репо, заем), в доверительное ");
        println("управление принятыми кредитной организацией на возвратной основе (репо, заем) и в залог." );
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()

        var i;

        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;

    end;

    private macro constructorTPart3View()

        initTPartView();

        m_part = arrCreate(TSection3PartView());

    end;

    constructorTPart3View();

end;

/**
 *  Печатное представление раздела 3
 */
class (TPart3View) TPart3View_4637()
    initTPart3View();

    macro printHeader()
        println();
        println("Раздел 3. Операции с ценными бумагами (кроме векселей), переданными кредитной организацией контрагентам на возвратной основе (репо, заем), в залог, ");
        println("принятыми кредитной организацией на возвратной основе (репо, заем), в залог." );
    end;

end;