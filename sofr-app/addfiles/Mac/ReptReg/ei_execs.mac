import ei_exec;

/* Добавить в список данные об отчете */
MACRO XMAddReport_System
(
  FormName,
  NumDprt,
  VarKind,
  DoubleDates,
  BegDate,
  EndDate,
  EIFName
)
  XMRepList(ASize(XMRepList)) = TXMReport( FormName,
                                           NumDprt,
                                           StrFor(VarKind),
                                           DoubleDates,
                                           BegDate,
                                           EndDate,
                                           EIFName );
END;   

/* Установить индекс отчета в массиве */
MACRO XMSetCurrentRepIndex_System
(
  FormName,
  NumDprt,
  VarKind,
  DoubleDates,
  BegDate,
  EndDate,
  EIFName
)
  Var Idx      = 0,
      Cont     = true,
      Size     = ASize(XMRepList),
      sVarKind = StrFor(VarKind);

  while( (Idx < Size) and Cont )
    if ( 
         ( XMRepList(Idx).mFormName    == FormName    ) and
         ( XMRepList(Idx).mNumDprt     == NumDprt     ) and
         ( XMRepList(Idx).mVarKind     == sVarKind    ) and
         ( XMRepList(Idx).mDoubleDates == DoubleDates ) and
         ( XMRepList(Idx).mBegDate     == BegDate     ) and
         ( XMRepList(Idx).mEndDate     == EndDate     ) and
         ( XMRepList(Idx).mEIFName     == EIFName     )
       )
      Cont = false;
    else
      Idx = Idx + 1;
    end;
  end;

  if ( Idx < Size )
    XMIdxCurrentRep = Idx;
  end;
END;   

/* Сбросить индекс */
Macro XMResetCurrentRepIndex_System()
  XMIdxCurrentRep = -1;
End;

/* eof */