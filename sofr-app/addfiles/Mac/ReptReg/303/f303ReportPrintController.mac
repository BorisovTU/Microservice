/*
$Name:          f303ReportPrintController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 303. Контроллер печати отчета
*/

/**
 * Форма 303. Контроллер печати отчета.
 *
 * @since   10.08.2015
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

import "or_rep_h.mac", "CbReport_h.mac";
import param;
import rcbWebCommon;

private Var FPrintHead     = true;
private Var FPrintBottom   = true;
private Var NumStr        = 1;

class (RcbReportPrintController) TF303EmptyReportPrintController()
    initRcbReportPrintController();

    m_reportWidth = 120;
end;

class (CB_CReportTemplate) TF303ReportPrintController()
    private var m_report : RcbReportBase;
    private var m_okatoCode;
    private var m_okpoCode;
    private var m_registrationNumber;
    private var m_organisationName;
    private var m_mailAddress;
    private var m_periodFormat;
    private var m_reportPeriod;

    private macro initializeVariables()
        m_report             = null;
        m_okatoCode          = null;
        m_okpoCode           = null;
        m_registrationNumber = null;
        m_organisationName   = null;
        m_mailAddress        = null;
        m_periodFormat       = DATE_IN_PERIOD_FORMAT;
        m_reportPeriod       = rcbApplication().currentReport.context.period;
    end;

    private macro getReport() : RcbReportBase
        if (m_report == null)
            m_report = objectFactoryInstance.createReport();
        end;

        return m_report;
    end;

    private macro getPartyByBranch()
        var party = TRecHandler("party.dbt", "bank.def");
        var reportContext = rcbApplication().currentReport.context;
        var dataSource;

        dataSource = TRsbDataSet(         " SELECT rsb_rep_pt.GetPartyIdByBranch( "
                                 + "\n" +                                           reportContext.departmentCode + ","
                                 + "\n" +                                           reportContext.organizationStructure
                                 + "\n" + "                                     ) partyId "
                                 + "\n" + " FROM dual");

        dataSource.setFieldType("partyId",  V_INTEGER);

        if (not dataSource.next())
            throw(TPartyIdNotFoundException("TZone::getPartyIdByBranch"));
        end;

        получитьСубъекта(dataSource.partyId, party);

        return party;
    end;

    /**
     *  Определение кода ОКАТО.
     */
    private macro initializeOkatoCode()
        var okatoCode;
        var party = getPartyByBranch();

        getMainObjAttr (null,
                        OBJTYPE_PARTY,
                        uniID(party, OBJTYPE_PARTY),
                        RCB_OBJGROUP_PT_OKATO,
                        null,
                        null,
                        okatoCode,
                        RcbApplication.currentReport.context.period.endDate);

        var dataSet;
        if (okatoCode == null)
            dataSet =  TRsbDataSet( "    SELECT CASE"
                             + "\n" + "              WHEN t_OKATO = CHR(1)"
                             + "\n" + "              THEN NULL"
                             + "\n" + "              ELSE t_OKATO"
                             + "\n" + "         END t_OKATO"
                             + "\n" + "    FROM dadress_dbt"
                             + "\n" + "   WHERE t_type = 1"
                             + "\n" + "     AND t_partyid = " + party.rec.partyId);

           dataSet.moveNext();
           okatoCode = dataSet.t_OKATO;
        end;

        okatoCode = substr(okatoCode, 1, 5);
        m_okatoCode = nvl(String(okatoCode) + MkStr("0", 5 - strlen(String(okatoCode))), "");
    end;

    /**
     * Определение кода ОКПО.
     */
    private macro initializeOkpoCode()
        m_okpoCode = nvl(getPartyByBranch().rec.okpo, "");
    end;

    /**
     * Определение регистрационного номера (/ порядкового номера).
     */
    private macro initializeRegistrationNumber()
        m_registrationNumber = repGetPartyCode(getPartyByBranch().rec.partyId, PTCK_BANKREGNUM, RcbApplication.currentReport.context.period.endDate);
    end;

    /**
     * Определение почтового адреса кредитной организации.
     */
    private macro initializeLendingAgencyPostalAdress()

        var adressParty;
        var adress = TRecHandler("adress.dbt");
        /*учитывается то, что происходит неполное вычисление выражения*/
        if (   найтиЮридическийАдресСубъекта(getPartyByBranch().rec.partyId, adress)
            or найтиПочтовыйАдресСубъекта(getPartyByBranch().rec.partyId, adress)
            or найтиАдресСубъекта(getPartyByBranch().rec.partyId, PTADDR_REAL, adress) /*фактический адрес*/
           )
           adressParty = adress.rec.adress;
        end;

        m_mailAddress = nvl(adressParty, "");
    end;

    /**
     * Определение наименования кредитной организации.
     */
    private macro initializeLendingAgencyName()
        m_organisationName  = nvl(getPartyByBranch().rec.name, "");
    end;

    /**
     * Получить период для печати.
     */
    macro  getPeriodName()
        var periodName;
        var month = 0;
        var year  = 0;

        if (m_periodFormat == DATE_OUT_PERIOD_FORMAT)
             periodName = "по состоянию на " + string((m_reportPeriod.endDate + 1) : m);
        elif (m_periodFormat == DATE_IN_PERIOD_FORMAT)
            periodName = "за ";

            dateSplit(m_reportPeriod.endDate, null, month, year);

            if (m_reportPeriod.kind == RCB_PK_DAY)
                periodName = periodName + string(m_reportPeriod.beginDate : m);
            elif (m_reportPeriod.kind == RCB_PK_MONTH)
                periodName = periodName + string(monName(month), " ", year, " г.");
            elif (m_reportPeriod.kind == RCB_PK_QUARTER)
                periodName = periodName + string((month-1)/3 + 1, " квартал ", year, " г.");
            elif (m_reportPeriod.kind == RCB_PK_HALFYEAR)
                periodName = periodName + string((month-1)/6 + 1, " полугодие ", year, " г.");
            elif (m_reportPeriod.kind == RCB_PK_YEAR)
                periodName = periodName + string(year, " г.");
            else
                periodName = periodName + string("период с ", m_reportPeriod.beginDate : m, " по ", m_reportPeriod.endDate : m);
            end;
        end;

        return strLwr(periodName);
    end;

    macro PrintMode():INTEGER
       return DL_OUTREPORT_EXCEL;
    end;

    private macro PrintHead()
    end;

    private macro BeginReport( /* NumCopy:INTEGER */ )
        SetActiveSheet("Page1");

        SetNumberPage("Страница ", NumStr);

        initializeOkatoCode();
        initializeOkpoCode();
        initializeRegistrationNumber();
        initializeLendingAgencyName();
        initializeLendingAgencyPostalAdress();

        PrintFormatString(null,
                          "periodicityName", ternary(rcbApplication().currentReport.context.period.kind == RCB_PK_MONTH, "Месячная", ""),
                          "reportName", "СВЕДЕНИЯ О ССУДАХ, ПРЕДОСТАВЛЕННЫХ ЮРИДИЧЕСКИМ ЛИЦАМ",
                          "reportDate", getPeriodName(),
                          "okatoCode", m_okatoCode,
                          "okpoCode", m_okpoCode,
                          "registrationNumber", m_registrationNumber,
                          "organisationName", m_organisationName,
                          "mailAddress", m_mailAddress
                          );

        PrintHead(FPrintHead);

        RegisterTable("N1_MainTable", null,
                      "debtor",
                      "ogrn",
                      "ogrnip",
                      "registrationDate",
                      "debtorINN",
                      "debtorOKPO",
                      "debtorOKSM",
                      "isMSP",
                      "relationsWitnBank",
                      "creditId",
                      "creditNumber",
                      "date",
                      "numberLoan",
                      "dateLoan",
                      "partyLoan",
                      "ogrnLoan",
                      "regnumberLoan",
                      "oksmLoan",
                      "numberRestructurings",
                      "dateClaim",
                      "dateEntry",
                      "sumClaim",
                      "sumCollection",
                      "fiCode",
                      "bankruptcyInfo",
                      "typeLoan",
                      "purposeCredit",
                      "sumOrigContract",
                      "sumChangesContract",
                      "fiCodeOrigContract",
                      "fiCodeChangesContract",
                      "dateOrigContract",
                      "dateChangesContract",
                      "typeRate",
                      "rateOrigContract",
                      "rateChangesContract",
                      "rateLoan",
                      "interestPeriod",
                      "typeFloatRate",
                      "conditionCode",
                      "creditIdCode",
                      "typeSecurity",
                      "sumFirstQuality",
                      "sumSecondQuality",
                      "sumSecuritiesReserve",
                      "typeInsurance",
                      "dateLoanPart5",
                      "trancheNumber",
                      "funds",
                      "fiCodePart5",
                      "okato",
                      "termDebtAccount",
                      "arrearsAccount",
                      "sumTermDebt",
                      "sumOverDebt",
                      "loanQuality",
                      "evaluation",
                      "calcReserve",
                      "sumCalcReserveSecurity",
                      "sumFormedReserve",
                      "information254P",
                      "sumClaimBalance",
                      "sumClaimBalanceOver",
                      "sumClaimNotBalance",
                      "sumClaimNotBalanceOver",
                      "sumFormedReservePart7",
                      "sumUnusedLimits",
                      "sumCalcReserveSecurityPart8",
                      "sumFormedReservePart8",
                      "periodicityRepayment",
                      "sumProvidedDebt",
                      "sumPaidDebt",
                      "periodicityInterest",
                      "sumProvidedInterest",
                      "sumPaidInterest",
                      "sumFines",
                      "dateRemovalDebt",
                      "maturityDateDebt",
                      "sourceRepayment",
                      "codeNewCredit",
                      "regNumber",
                      "methodRefinancing",
                      "sumRefinancingDebt",
                      "sumFunds",
                      "party",
                      "ogrnPart10",
                      "regNumberPart10",
                      "oksm");
    end;

    private macro EndReport()
        PrintFormatString(null,
                          "bossName", {FIO_Boss},
                          "bookName", {FIO_Book},
                          "executorName", Исполнитель,
                          "executorPhoneNumber", ТелефонИсполнителя,
                          "curdate", string({curdate} : f : m)
                          );
        EndTable();
        SetXLSXFormat();
    end;

    private macro PrintLine(debtor,
                            ogrn,
                            ogrnip,
                            registrationDate,
                            debtorINN,
                            debtorOKPO,
                            debtorOKSM,
                            isMSP,
                            relationsWitnBank,
                            creditId,
                            creditNumber,
                            date,
                            numberLoan,
                            dateLoan,
                            partyLoan,
                            ogrnLoan,
                            regnumberLoan,
                            oksmLoan,
                            numberRestructurings,
                            dateClaim,
                            dateEntry,
                            sumClaim,
                            sumCollection,
                            fiCode,
                            bankruptcyInfo,
                            typeLoan,
                            purposeCredit,
                            sumOrigContract,
                            sumChangesContract,
                            fiCodeOrigContract,
                            fiCodeChangesContract,
                            dateOrigContract,
                            dateChangesContract,
                            typeRate,
                            rateOrigContract,
                            rateChangesContract,
                            rateLoan,
                            interestPeriod,
                            typeFloatRate,
                            conditionCode,
                            creditIdCode,
                            typeSecurity,
                            sumFirstQuality,
                            sumSecondQuality,
                            sumSecuritiesReserve,
                            typeInsurance,
                            dateLoanPart5,
                            userTrancheNumber,
                            funds,
                            fiCodePart5,
                            okato,
                            termDebtAccount,
                            arrearsAccount,
                            sumTermDebt,
                            sumOverDebt,
                            loanQuality,
                            evaluation,
                            calcReserve,
                            sumCalcReserveSecurity,
                            sumFormedReserve,
                            information254P,
                            sumClaimBalance,
                            sumClaimBalanceOver,
                            sumClaimNotBalance,
                            sumClaimNotBalanceOver,
                            sumFormedReservePart7,
                            sumUnusedLimits,
                            sumCalcReserveSecurityPart8,
                            sumFormedReservePart8,
                            periodicityRepayment,
                            sumProvidedDebt,
                            sumPaidDebt,
                            periodicityInterest,
                            sumProvidedInterest,
                            sumPaidInterest,
                            sumFines,
                            dateRemovalDebt,
                            maturityDateDebt,
                            sourceRepayment,
                            codeNewCredit,
                            regNumber,
                            methodRefinancing,
                            sumRefinancingDebt,
                            sumFunds,
                            party,
                            ogrnPart10,
                            regNumberPart10,
                            oksm)

        PrintTableLine(
                      "debtor",                      debtor,                      null,
                      "ogrn",                        ogrn,                        null,
                      "ogrnip",                      ogrnip,                      null,
                      "registrationDate",            registrationDate,            null,
                      "debtorINN",                   debtorINN,                   null,
                      "debtorOKPO",                  debtorOKPO,                  null,
                      "debtorOKSM",                  debtorOKSM,                  null,
                      "isMSP",                       isMSP,                       null,
                      "relationsWitnBank",           relationsWitnBank,           null,
                      "creditId",                    creditId,                    null,
                      "creditNumber",                creditNumber,                null,
                      "date",                        date,                        null,
                      "numberLoan",                  numberLoan,                  null,
                      "dateLoan",                    dateLoan,                    null,
                      "partyLoan",                   partyLoan,                   null,
                      "ogrnLoan",                    ogrnLoan,                    null,
                      "regnumberLoan",               regnumberLoan,               null,
                      "oksmLoan",                    oksmLoan,                    null,
                      "numberRestructurings",        numberRestructurings,        null,
                      "dateClaim",                   dateClaim,                   null,
                      "dateEntry",                   dateEntry,                   null,
                      "sumClaim",                    sumClaim,                    null,
                      "sumCollection",               sumCollection,               null,
                      "fiCode",                      fiCode,                      null,
                      "bankruptcyInfo",              bankruptcyInfo,              null,
                      "typeLoan",                    String("\n", typeLoan),  null, /* SCR 229561 - вот такой нужен костыль, чтобы выводилась ТОЧКА вместо ЗАПЯТОЙ, никакие явные задания типа не помогают */
                      "purposeCredit",               purposeCredit,               null,
                      "sumOrigContract",             sumOrigContract,             null,
                      "sumChangesContract",          sumChangesContract,          null,
                      "fiCodeOrigContract",          fiCodeOrigContract,          null,
                      "fiCodeChangesContract",       fiCodeChangesContract,       null,
                      "dateOrigContract",            dateOrigContract,            null,
                      "dateChangesContract",         dateChangesContract,         null,
                      "typeRate",                    typeRate,                    null,
                      "rateOrigContract",            rateOrigContract,            3,
                      "rateChangesContract",         rateChangesContract,         3,
                      "rateLoan",                    rateLoan,                    3,
                      "interestPeriod",              interestPeriod,              null,
                      "typeFloatRate",               typeFloatRate,               null,
                      "conditionCode",               conditionCode,               null,
                      "creditIdCode",                creditIdCode,                null,
                      "typeSecurity",                typeSecurity,                null,
                      "sumFirstQuality",             sumFirstQuality,             null,
                      "sumSecondQuality",            sumSecondQuality,            null,
                      "sumSecuritiesReserve",        sumSecuritiesReserve,        null,
                      "typeInsurance",               typeInsurance,               null,
                      "dateLoanPart5",               dateLoanPart5,               null,
                      "userTrancheNumber",           userTrancheNumber,           null,
                      "funds",                       funds,                       null,
                      "fiCodePart5",                 fiCodePart5,                 null,
                      "okato",                       okato,                       null,
                      "termDebtAccount",             termDebtAccount,             null,
                      "arrearsAccount",              arrearsAccount,              null,
                      "sumTermDebt",                 sumTermDebt,                 null,
                      "sumOverDebt",                 sumOverDebt,                 null,
                      "loanQuality",                 loanQuality,                 null,
                      "evaluation",                  evaluation,                  null,
                      "calcReserve",                 calcReserve,                 3,
                      "sumCalcReserveSecurity",      sumCalcReserveSecurity,      null,
                      "sumFormedReserve",            sumFormedReserve,            null,
                      "information254P",             information254P,             null,
                      "sumClaimBalance",             sumClaimBalance,             null,
                      "sumClaimBalanceOver",         sumClaimBalanceOver,         null,
                      "sumClaimNotBalance",          sumClaimNotBalance,          null,
                      "sumClaimNotBalanceOver",      sumClaimNotBalanceOver,      null,
                      "sumFormedReservePart7",       sumFormedReservePart7,       null,
                      "sumUnusedLimits",             sumUnusedLimits,             null,
                      "sumCalcReserveSecurityPart8", sumCalcReserveSecurityPart8, null,
                      "sumFormedReservePart8",       sumFormedReservePart8,       null,
                      "periodicityRepayment",        periodicityRepayment,        null,
                      "sumProvidedDebt",             sumProvidedDebt,             null,
                      "sumPaidDebt",                 sumPaidDebt,                 null,
                      "periodicityInterest",         periodicityInterest,         null,
                      "sumProvidedInterest",         sumProvidedInterest,         null,
                      "sumPaidInterest",             sumPaidInterest,             null,
                      "sumFines",                    sumFines,                    null,
                      "dateRemovalDebt",             dateRemovalDebt,             null,
                      "maturityDateDebt",            maturityDateDebt,            null,
                      "sourceRepayment",             sourceRepayment,             null,
                      "codeNewCredit",               codeNewCredit,               null,
                      "regNumber",                   regNumber,                   null,
                      "methodRefinancing",           methodRefinancing,           null,
                      "sumRefinancingDebt",          sumRefinancingDebt,          null,
                      "sumFunds",                    sumFunds,                    null,
                      "party",                       party,                       null,
                      "ogrnPart10",                  ogrnPart10,                  null,
                      "regNumberPart10",             regNumberPart10,             null,
                      "oksm",                        oksm,                        null);
    end;

    /**
     * Проверка на наличие данных
     */
    macro CReport_DataExist()
        if (getReport().getPart("1").isEmpty()
        and getReport().getPart("2").isEmpty()
        and getReport().getPart("3").isEmpty()
        and getReport().getPart("4").isEmpty()
        and getReport().getPart("5").isEmpty()
        and getReport().getPart("6").isEmpty()
        and getReport().getPart("7").isEmpty()
        and getReport().getPart("8").isEmpty()
        and getReport().getPart("9").isEmpty()
        and getReport().getPart("10").isEmpty()
           )
            return false;
        else
            return true;
        end;

    end;

    /**
     * При отсутствии данных файл экселя формироваться не будет. Вместо него будет текстовый вариант пустого отчета.
     */
    macro CReport_NoDataMsg()
    end;

    /**
    * Сортировщик для итераторов
    */
    private class TSyncSorter()
        macro isLess(lhs : Object, rhs : Object)
            return lhs.fieldValue("creditId").current < rhs.fieldValue("creditId").current;
        end;
    end;

    /**
    * Сортировщик для итераторов дополнительных строк
    */
    private class TSyncSorterAddLines()
        macro isLess(lhs : Object, rhs : Object)
            return (lhs.fieldValue("trancheNumber").current < rhs.fieldValue("trancheNumber").current);
        end;
    end;

    /**
    * Сортировщик для итераторов дополнительных строк по дате
    */
    private class TSyncSorterAddLinesByDate()
        macro isLess(lhs : Object, rhs : Object)
            return (lhs.fieldValue("maturityDateDebt").current < rhs.fieldValue("maturityDateDebt").current);
        end;
    end;

    /**
    * Сортировщик для итераторов дополнительных строк Раздела 2
    */
    private class TSyncSorterAddLinesPart2()
        macro isLess(lhs : Object, rhs : Object)
            return ( (lhs.fieldValue("creditId").current < rhs.fieldValue("creditId").current) and
                     (lhs.fieldValue("trancheNumber").current < rhs.fieldValue("trancheNumber").current)
                   );
        end;
    end;

    /**
     * Фильтр отбора допонительных или основных строк
    */
    private class TIteratorTypeLineFilter(isAddLine)
        private var m_isAddLine = isAddLine;

        macro isSuitable(v)
            return (v.fieldValue("addLine").current == m_isAddLine);
        end;
    end;

    /**
     * Фильтр отбора допонительных строк по конкретному кредиту
    */
    private class TIteratorAddCreditFilter(creditId)
        private var m_creditId = creditId;

        macro isSuitable(v)
            return (v.fieldValue("creditId").current == m_creditId);
        end;
    end;


    /**
     * Фильтр отбора допонительных строк по конкретному кредиту
    */
    private class TIteratorAddCreditLineFilter(creditId, isAddLine)
        private var m_isAddLine = isAddLine;
        private var m_creditId = creditId;

        macro isSuitable(v)
            return ((v.fieldValue("creditId").current == m_creditId) and (v.fieldValue("addLine").current == m_isAddLine));
        end;
    end;

    /**
     * Фильтр отбора допонительных строк по конкретному кредиту,
    */
    private class TIteratorNonZeroAddCreditLineFilter(creditId, isAddLine)
        private var m_isAddLine = isAddLine;
        private var m_creditId = creditId;

        macro isSuitable(v)
            return ((v.fieldValue("creditId").current == m_creditId) and (v.fieldValue("addLine").current > 0));
        end;
    end;

    /**
     * Фильтр отбора допонительных строк по конкретному кредиту и траншу
    */
    private class TIteratorAddCreditAndTrancheLineFilter(creditId, tranche, isAddLine)
        private var m_isAddLine = isAddLine;
        private var m_creditId = creditId;
        private var m_tranche = tranche;

        macro isSuitable(v)
            return ((v.fieldValue("creditId").current == m_creditId) and (v.fieldValue("trancheNumber").current == m_tranche) and (v.fieldValue("addLine").current == m_isAddLine));
        end;
    end;

    macro getPrintValue(iterator :  RcbValueIterator, userIterator :  RcbValueIterator, fieldValue : String)
        if (iterator.currentItem == null)
            return "";
        end;

        if (not iterator.currentItem.fieldValue(fieldValue).isDefined() or (iterator.currentItem.fieldValue(fieldValue).exact == strFor(1)) or (iterator.currentItem.fieldValue(fieldValue).exact == ""))
            if (userIterator.currentItem != null)
                if (userIterator.currentItem.fieldValue(fieldValue) != null)
                    if (userIterator.currentItem.fieldValue(fieldValue).isDefined())
                        return userIterator.currentItem.fieldValue(fieldValue).exact;
                    end;
                end;
            end;
        end;

        return iterator.currentItem.fieldValue(fieldValue).exact;
    end;

    macro printAddLineForPart9(creditId, tranche, addLine)
         // печать дополнительных строк
        var iteratorAddTrancheLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddTrancheLinesPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId, tranche, addLine));
        iteratorAddTrancheLinesPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var iteratorTrancheAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorTrancheAddLinesUserPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId,  tranche, addLine));
        iteratorTrancheAddLinesUserPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var synchronizerTrancheAddLines = null;
        synchronizerTrancheAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLinesByDate(), iteratorAddTrancheLinesPart9);
        synchronizerTrancheAddLines.addIterator(iteratorTrancheAddLinesUserPart9);

        synchronizerTrancheAddLines.moveFirst();

        while (not synchronizerTrancheAddLines.isDone())
                PrintLine("",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          creditId,
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "dateRemovalDebt"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "maturityDateDebt"),
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          ""
                        );

           synchronizerTrancheAddLines.moveNext();
        end;
    end;

    /**
     * Печать дополнительных строк для конкретного кредита с идентификатором creditId
    */
    macro printAddLines(creditId)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        iteratorAddLinesPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        iteratorAddLinesUserPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        iteratorAddLinesPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        iteratorAddLinesUserPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        iteratorAddLinesPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        iteratorAddLinesUserPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        iteratorAddLinesPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        iteratorAddLinesUserPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        iteratorAddLinesPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        iteratorAddLinesUserPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());

        var synchronizerAddLines = null;

        var maxItem = max(iteratorAddLinesPart2.count(), max(iteratorAddLinesPart3.count(), max(iteratorAddLinesPart5.count(), max(iteratorAddLinesPart6.count(), max(iteratorAddLinesPart7.count(), iteratorAddLinesPart9.count())))));
        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorAddLinesPart2.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart3.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart5.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart6.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart7.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart9.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
        end;

        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart5);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart6);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart7);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        var part2ArrAddLines = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part9ArrAddLines = RcbArray();
        var isNeedPrint = false;

        while (not synchronizerAddLines.isDone())
            var value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart2) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart2))
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "date"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberRestructurings"));
            value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateClaim"));
            value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateEntry"));
            value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumClaim"));
            value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumCollection"));
            value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "bankruptcyInfo"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart3) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart3))
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditIdCode"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart5) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart5))
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "okato"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart6) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart6))
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "information254P"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart7) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart7))
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumFormedReserve"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart9))
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9ArrAddLines.push_back(value);
            value = RcbArray();

            if (isNeedPrint == true)
                part2ArrAddLines.moveFirst();
                part3ArrAddLines.moveFirst();
                part5ArrAddLines.moveFirst();
                part6ArrAddLines.moveFirst();
                part7ArrAddLines.moveFirst();
                part9ArrAddLines.moveFirst();

                if (part2ArrAddLines.moveNext() and part3ArrAddLines.moveNext() and part5ArrAddLines.moveNext() and part6ArrAddLines.moveNext() and part7ArrAddLines.moveNext() and part9ArrAddLines.moveNext())
                    PrintLine("",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              creditId,
                              part2ArrAddLines.getCurrentItem()(1),
                              part2ArrAddLines.getCurrentItem()(2),
                              part2ArrAddLines.getCurrentItem()(3),
                              part2ArrAddLines.getCurrentItem()(4),
                              part2ArrAddLines.getCurrentItem()(5),
                              part2ArrAddLines.getCurrentItem()(6),
                              part2ArrAddLines.getCurrentItem()(7),
                              part2ArrAddLines.getCurrentItem()(8),
                              part2ArrAddLines.getCurrentItem()(9),
                              part2ArrAddLines.getCurrentItem()(10),
                              part2ArrAddLines.getCurrentItem()(11),
                              part2ArrAddLines.getCurrentItem()(12),
                              part2ArrAddLines.getCurrentItem()(13),
                              part2ArrAddLines.getCurrentItem()(14),
                              part2ArrAddLines.getCurrentItem()(15),
                              part3ArrAddLines.getCurrentItem()(2),
                              part3ArrAddLines.getCurrentItem()(3),
                              part3ArrAddLines.getCurrentItem()(4),
                              part3ArrAddLines.getCurrentItem()(5),
                              part3ArrAddLines.getCurrentItem()(6),
                              part3ArrAddLines.getCurrentItem()(7),
                              part3ArrAddLines.getCurrentItem()(8),
                              part3ArrAddLines.getCurrentItem()(9),
                              part3ArrAddLines.getCurrentItem()(10),
                              part3ArrAddLines.getCurrentItem()(11),
                              part3ArrAddLines.getCurrentItem()(12),
                              part3ArrAddLines.getCurrentItem()(13),
                              part3ArrAddLines.getCurrentItem()(14),
                              part3ArrAddLines.getCurrentItem()(15),
                              part3ArrAddLines.getCurrentItem()(16),
                              part3ArrAddLines.getCurrentItem()(17),
                              0, // SCR 229026
                              "",
                              "",
                              "",
                              "",
                              part5ArrAddLines.getCurrentItem()(2),
                              part5ArrAddLines.getCurrentItem()(3),
                              part5ArrAddLines.getCurrentItem()(4),
                              part5ArrAddLines.getCurrentItem()(5),
                              part5ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(2),
                              part6ArrAddLines.getCurrentItem()(3),
                              part6ArrAddLines.getCurrentItem()(4),
                              part6ArrAddLines.getCurrentItem()(5),
                              part6ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(7),
                              part6ArrAddLines.getCurrentItem()(8),
                              part6ArrAddLines.getCurrentItem()(9),
                              part6ArrAddLines.getCurrentItem()(10),
                              part6ArrAddLines.getCurrentItem()(11),
                              part7ArrAddLines.getCurrentItem()(2),
                              part7ArrAddLines.getCurrentItem()(3),
                              part7ArrAddLines.getCurrentItem()(4),
                              part7ArrAddLines.getCurrentItem()(5),
                              part7ArrAddLines.getCurrentItem()(6),
                              "",
                              "",
                              "",
                              part9ArrAddLines.getCurrentItem()(2),
                              part9ArrAddLines.getCurrentItem()(3),
                              part9ArrAddLines.getCurrentItem()(4),
                              part9ArrAddLines.getCurrentItem()(5),
                              part9ArrAddLines.getCurrentItem()(6),
                              part9ArrAddLines.getCurrentItem()(7),
                              part9ArrAddLines.getCurrentItem()(8),
                              part9ArrAddLines.getCurrentItem()(9),
                              part9ArrAddLines.getCurrentItem()(10),
                              part9ArrAddLines.getCurrentItem()(11),
                              part9ArrAddLines.getCurrentItem()(12),
                              part9ArrAddLines.getCurrentItem()(13),
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              ""
                            );
                end;
            end;

            printAddLineForPart9(creditId, part9ArrAddLines.getCurrentItem()(1), 2);

            isNeedPrint = false;
            part2ArrAddLines = RcbArray();
            part3ArrAddLines = RcbArray();
            part5ArrAddLines = RcbArray();
            part6ArrAddLines = RcbArray();
            part7ArrAddLines = RcbArray();
            part9ArrAddLines = RcbArray();

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro create()
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6Arr = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7Arr = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part9ArrAddLines = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "isMSP"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "date"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateEntry"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumCollection"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4) or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumFirstQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecondQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        var currentCreditId = null;
        while (part1Arr.moveNext() and part2Arr.moveNext() and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext() and part10Arr.moveNext())
            PrintLine(part1Arr.getCurrentItem()(0),
                      part1Arr.getCurrentItem()(1),
                      part1Arr.getCurrentItem()(2),
                      part1Arr.getCurrentItem()(3),
                      part1Arr.getCurrentItem()(4),
                      part1Arr.getCurrentItem()(5),
                      part1Arr.getCurrentItem()(6),
                      part1Arr.getCurrentItem()(7),
                      part1Arr.getCurrentItem()(8),
                      part2Arr.getCurrentItem()(0),
                      part2Arr.getCurrentItem()(1),
                      part2Arr.getCurrentItem()(2),
                      part2Arr.getCurrentItem()(3),
                      part2Arr.getCurrentItem()(4),
                      part2Arr.getCurrentItem()(5),
                      part2Arr.getCurrentItem()(6),
                      part2Arr.getCurrentItem()(7),
                      part2Arr.getCurrentItem()(8),
                      part2Arr.getCurrentItem()(9),
                      part2Arr.getCurrentItem()(10),
                      part2Arr.getCurrentItem()(11),
                      part2Arr.getCurrentItem()(12),
                      part2Arr.getCurrentItem()(13),
                      part2Arr.getCurrentItem()(14),
                      part2Arr.getCurrentItem()(15),
                      part3Arr.getCurrentItem()(0),
                      part3Arr.getCurrentItem()(1),
                      part3Arr.getCurrentItem()(2),
                      part3Arr.getCurrentItem()(3),
                      part3Arr.getCurrentItem()(4),
                      part3Arr.getCurrentItem()(5),
                      part3Arr.getCurrentItem()(6),
                      part3Arr.getCurrentItem()(7),
                      part3Arr.getCurrentItem()(8),
                      part3Arr.getCurrentItem()(9),
                      part3Arr.getCurrentItem()(10),
                      part3Arr.getCurrentItem()(11),
                      part3Arr.getCurrentItem()(12),
                      part3Arr.getCurrentItem()(13),
                      part3Arr.getCurrentItem()(14),
                      part3Arr.getCurrentItem()(15),
                      part4Arr.getCurrentItem()(0),
                      part4Arr.getCurrentItem()(1),
                      part4Arr.getCurrentItem()(2),
                      part4Arr.getCurrentItem()(3),
                      part4Arr.getCurrentItem()(4),
                      part5Arr.getCurrentItem()(0),
                      part5Arr.getCurrentItem()(1),
                      part5Arr.getCurrentItem()(2),
                      part5Arr.getCurrentItem()(3),
                      part5Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(0),
                      part6Arr.getCurrentItem()(1),
                      part6Arr.getCurrentItem()(2),
                      part6Arr.getCurrentItem()(3),
                      part6Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(5),
                      part6Arr.getCurrentItem()(6),
                      part6Arr.getCurrentItem()(7),
                      part6Arr.getCurrentItem()(8),
                      part6Arr.getCurrentItem()(9),
                      part7Arr.getCurrentItem()(0),
                      part7Arr.getCurrentItem()(1),
                      part7Arr.getCurrentItem()(2),
                      part7Arr.getCurrentItem()(3),
                      part7Arr.getCurrentItem()(4),
                      part8Arr.getCurrentItem()(0),
                      part8Arr.getCurrentItem()(1),
                      part8Arr.getCurrentItem()(2),
                      part9Arr.getCurrentItem()(0),
                      part9Arr.getCurrentItem()(1),
                      part9Arr.getCurrentItem()(2),
                      part9Arr.getCurrentItem()(3),
                      part9Arr.getCurrentItem()(4),
                      part9Arr.getCurrentItem()(5),
                      part9Arr.getCurrentItem()(6),
                      part9Arr.getCurrentItem()(7),
                      part9Arr.getCurrentItem()(8),
                      part9Arr.getCurrentItem()(9),
                      part9Arr.getCurrentItem()(10),
                      part9Arr.getCurrentItem()(11),
                      part10Arr.getCurrentItem()(0),
                      part10Arr.getCurrentItem()(1),
                      part10Arr.getCurrentItem()(2),
                      part10Arr.getCurrentItem()(3),
                      part10Arr.getCurrentItem()(4),
                      part10Arr.getCurrentItem()(5),
                      part10Arr.getCurrentItem()(6)
                    );

            // printAddLineForMainRow(part2Arr.getCurrentItem()(0), 2);
            printAddLineForPart9(part2Arr.getCurrentItem()(0), part2Arr.getCurrentItem()(0), 2);

            if (currentCreditId != part2Arr.getCurrentItem()(0))
                printAddLines(part2Arr.getCurrentItem()(0));
            end;

            currentCreditId = part2Arr.getCurrentItem()(0);
        end;
    end;

    private macro printDataZone()
        if (getReport().isEmpty())
            objectFactoryInstance.createEmptyReportPrintController().print();
        else
            Run();
        end;
    end;

    macro print()
        printDataZone();
        /**
        * Список файлов печати (*.xls)
        */
        var reportFileNameList = GetFullReportFileNames();
        var i: Integer = 0;
        while (i < reportFileNameList.size)
            RepTxtFilesQueue().add(reportFileNameList[i]);
            i = i + 1;
        end;
    end;

    private macro constructorF303ReportPrintController()
        initializeVariables();
        // восстановим оригинальную функцию
        ReplaceMacro("isStandalone");
        initCB_CReportTemplate( null, "f303Template.xls", null, rcbWebCommon_isWebSystem());
    end;

    constructorF303ReportPrintController()
end;

class (TF303ReportPrintController) TF303ReportPrintController_4212()
    private macro BeginReport( /* NumCopy:INTEGER */ )
        SetActiveSheet("Page1");

        SetNumberPage("Страница ", NumStr);

        initializeOkatoCode();
        initializeOkpoCode();
        initializeRegistrationNumber();
        initializeLendingAgencyName();
        initializeLendingAgencyPostalAdress();

        PrintFormatString(null,
                          "periodicityName", ternary(rcbApplication().currentReport.context.period.kind == RCB_PK_MONTH, "Месячная", ""),
                          "reportName", "СВЕДЕНИЯ О ССУДАХ, ПРЕДОСТАВЛЕННЫХ ЮРИДИЧЕСКИМ ЛИЦАМ",
                          "reportDate", getPeriodName(),
                          "okatoCode", m_okatoCode,
                          "okpoCode", m_okpoCode,
                          "registrationNumber", m_registrationNumber,
                          "organisationName", m_organisationName,
                          "mailAddress", m_mailAddress
                          );

        PrintHead(FPrintHead);

        RegisterTable("N1_MainTable", null,
                      "debtor",
                      "ogrn",
                      "ogrnip",
                      "registrationDate",
                      "debtorINN",
                      "debtorOKPO",
                      "debtorOKSM",
                      "relationsWitnBank",
                      "creditId",
                      "creditNumber",
                      "date",
                      "numberLoan",
                      "dateLoan",
                      "partyLoan",
                      "ogrnLoan",
                      "regnumberLoan",
                      "oksmLoan",
                      "numberRestructurings",
                      "dateFilingSuit",
                      "lawCourt",
                      "dateClaim",
                      "dateEntry",
                      "sumClaim",
                      "sumCollection",
                      "fiCode",
                      "bankruptcyInfo",
                      "dateBankruptcy",
                      "typeLoan",
                      "purposeCredit",
                      "sumOrigContract",
                      "sumChangesContract",
                      "fiCodeOrigContract",
                      "fiCodeChangesContract",
                      "dateOrigContract",
                      "dateChangesContract",
                      "typeRate",
                      "rateOrigContract",
                      "rateChangesContract",
                      "rateLoan",
                      "interestPeriod",
                      "typeFloatRate",
                      "conditionCode",
                      "creditIdCode",
                      "typeSecurity",
                      "sumFirstQuality",
                      "sumSecondQuality",
                      "sumSecuritiesReserve",
                      "typeInsurance",
                      "dateLoanPart5",
                      "trancheNumber",
                      "funds",
                      "fiCodePart5",
                      "okato",
                      "termDebtAccount",
                      "arrearsAccount",
                      "sumTermDebt",
                      "sumOverDebt",
                      "loanQuality",
                      "evaluation",
                      "calcReserve",
                      "sumCalcReserveSecurity",
                      "sumFormedReserve",
                      "information254P",
                      "sumClaimBalance",
                      "sumClaimBalanceOver",
                      "sumClaimNotBalance",
                      "sumClaimNotBalanceOver",
                      "sumFormedReservePart7",
                      "sumUnusedLimits",
                      "sumCalcReserveSecurityPart8",
                      "sumFormedReservePart8",
                      "rvpPercentPart8",
                      "periodicityRepayment",
                      "sumProvidedDebt",
                      "sumPaidDebt",
                      "periodicityInterest",
                      "sumProvidedInterest",
                      "sumPaidInterest",
                      "sumFines",
                      "dateRemovalDebt",
                      "maturityDateDebt",
                      "sourceRepayment",
                      "codeNewCredit",
                      "regNumber",
                      "methodRefinancing",
                      "sumRefinancingDebt",
                      "sumFunds",
                      "party",
                      "ogrnPart10",
                      "regNumberPart10",
                      "oksm",
                      "sumDeal",
                      "fiCodePart10");
    end;

    private macro PrintLine(debtor,
                            ogrn,
                            ogrnip,
                            registrationDate,
                            debtorINN,
                            debtorOKPO,
                            debtorOKSM,
                            relationsWitnBank,
                            creditId,
                            creditNumber,
                            date,
                            numberLoan,
                            dateLoan,
                            partyLoan,
                            ogrnLoan,
                            regnumberLoan,
                            oksmLoan,
                            numberRestructurings,
                            dateFilingSuit,
                            lawCourt,
                            dateClaim,
                            dateEntry,
                            sumClaim,
                            sumCollection,
                            fiCode,
                            bankruptcyInfo,
                            dateBankruptcy,
                            typeLoan,
                            purposeCredit,
                            sumOrigContract,
                            sumChangesContract,
                            fiCodeOrigContract,
                            fiCodeChangesContract,
                            dateOrigContract,
                            dateChangesContract,
                            typeRate,
                            rateOrigContract,
                            rateChangesContract,
                            rateLoan,
                            interestPeriod,
                            typeFloatRate,
                            conditionCode,
                            creditIdCode,
                            typeSecurity,
                            sumFirstQuality,
                            sumSecondQuality,
                            sumSecuritiesReserve,
                            typeInsurance,
                            dateLoanPart5,
                            userTrancheNumber,
                            funds,
                            fiCodePart5,
                            okato,
                            termDebtAccount,
                            arrearsAccount,
                            sumTermDebt,
                            sumOverDebt,
                            loanQuality,
                            evaluation,
                            calcReserve,
                            sumCalcReserveSecurity,
                            sumFormedReserve,
                            information254P,
                            sumClaimBalance,
                            sumClaimBalanceOver,
                            sumClaimNotBalance,
                            sumClaimNotBalanceOver,
                            sumFormedReservePart7,
                            sumUnusedLimits,
                            sumCalcReserveSecurityPart8,
                            sumFormedReservePart8,
                            rvpPercentPart8,
                            periodicityRepayment,
                            sumProvidedDebt,
                            sumPaidDebt,
                            periodicityInterest,
                            sumProvidedInterest,
                            sumPaidInterest,
                            sumFines,
                            dateRemovalDebt,
                            maturityDateDebt,
                            sourceRepayment,
                            codeNewCredit,
                            regNumber,
                            methodRefinancing,
                            sumRefinancingDebt,
                            sumFunds,
                            party,
                            ogrnPart10,
                            regNumberPart10,
                            oksm,
                            sumDeal,
                            fiCodePart10)

        PrintTableLine(
                      "debtor",                      debtor,                      null,
                      "ogrn",                        ogrn,                        null,
                      "ogrnip",                      ogrnip,                      null,
                      "registrationDate",            registrationDate,            null,
                      "debtorINN",                   debtorINN,                   null,
                      "debtorOKPO",                  debtorOKPO,                  null,
                      "debtorOKSM",                  debtorOKSM,                  null,
                      "relationsWitnBank",           relationsWitnBank,           null,
                      "creditId",                    creditId,                    null,
                      "creditNumber",                creditNumber,                null,
                      "date",                        date,                        null,
                      "numberLoan",                  numberLoan,                  null,
                      "dateLoan",                    dateLoan,                    null,
                      "partyLoan",                   partyLoan,                   null,
                      "ogrnLoan",                    ogrnLoan,                    null,
                      "regnumberLoan",               regnumberLoan,               null,
                      "oksmLoan",                    oksmLoan,                    null,
                      "numberRestructurings",        numberRestructurings,        null,
                      "dateFilingSuit",              dateFilingSuit,              null,
                      "lawCourt",                    lawCourt,                    null,
                      "dateClaim",                   dateClaim,                   null,
                      "dateEntry",                   dateEntry,                   null,
                      "sumClaim",                    sumClaim,                    null,
                      "sumCollection",               sumCollection,               null,
                      "fiCode",                      fiCode,                      null,
                      "bankruptcyInfo",              bankruptcyInfo,              null,
                      "dateBankruptcy",              dateBankruptcy,              null,
                      "typeLoan",                    String("\n", typeLoan),  null, /* SCR 229561 - вот такой нужен костыль, чтобы выводилась ТОЧКА вместо ЗАПЯТОЙ, никакие явные задания типа не помогают */
                      "purposeCredit",               purposeCredit,               null,
                      "sumOrigContract",             sumOrigContract,             null,
                      "sumChangesContract",          sumChangesContract,          null,
                      "fiCodeOrigContract",          fiCodeOrigContract,          null,
                      "fiCodeChangesContract",       fiCodeChangesContract,       null,
                      "dateOrigContract",            dateOrigContract,            null,
                      "dateChangesContract",         dateChangesContract,         null,
                      "typeRate",                    typeRate,                    null,
                      "rateOrigContract",            rateOrigContract,            3,
                      "rateChangesContract",         rateChangesContract,         3,
                      "rateLoan",                    rateLoan,                    3,
                      "interestPeriod",              interestPeriod,              null,
                      "typeFloatRate",               typeFloatRate,               null,
                      "conditionCode",               conditionCode,               null,
                      "creditIdCode",                creditIdCode,                null,
                      "typeSecurity",                typeSecurity,                null,
                      "sumFirstQuality",             sumFirstQuality,             null,
                      "sumSecondQuality",            sumSecondQuality,            null,
                      "sumSecuritiesReserve",        sumSecuritiesReserve,        null,
                      "typeInsurance",               typeInsurance,               null,
                      "dateLoanPart5",               dateLoanPart5,               null,
                      "userTrancheNumber",           userTrancheNumber,           null,
                      "funds",                       funds,                       null,
                      "fiCodePart5",                 fiCodePart5,                 null,
                      "okato",                       okato,                       null,
                      "termDebtAccount",             termDebtAccount,             null,
                      "arrearsAccount",              arrearsAccount,              null,
                      "sumTermDebt",                 sumTermDebt,                 null,
                      "sumOverDebt",                 sumOverDebt,                 null,
                      "loanQuality",                 loanQuality,                 null,
                      "evaluation",                  evaluation,                  null,
                      "calcReserve",                 calcReserve,                 3,
                      "sumCalcReserveSecurity",      sumCalcReserveSecurity,      null,
                      "sumFormedReserve",            sumFormedReserve,            null,
                      "information254P",             information254P,             null,
                      "sumClaimBalance",             sumClaimBalance,             null,
                      "sumClaimBalanceOver",         sumClaimBalanceOver,         null,
                      "sumClaimNotBalance",          sumClaimNotBalance,          null,
                      "sumClaimNotBalanceOver",      sumClaimNotBalanceOver,      null,
                      "sumFormedReservePart7",       sumFormedReservePart7,       null,
                      "sumUnusedLimits",             sumUnusedLimits,             null,
                      "sumCalcReserveSecurityPart8", sumCalcReserveSecurityPart8, null,
                      "sumFormedReservePart8",       sumFormedReservePart8,       null,
                      "rvpPercentPart8",             rvpPercentPart8,             null,
                      "periodicityRepayment",        periodicityRepayment,        null,
                      "sumProvidedDebt",             sumProvidedDebt,             null,
                      "sumPaidDebt",                 sumPaidDebt,                 null,
                      "periodicityInterest",         periodicityInterest,         null,
                      "sumProvidedInterest",         sumProvidedInterest,         null,
                      "sumPaidInterest",             sumPaidInterest,             null,
                      "sumFines",                    sumFines,                    null,
                      "dateRemovalDebt",             dateRemovalDebt,             null,
                      "maturityDateDebt",            maturityDateDebt,            null,
                      "sourceRepayment",             sourceRepayment,             null,
                      "codeNewCredit",               codeNewCredit,               null,
                      "regNumber",                   regNumber,                   null,
                      "methodRefinancing",           methodRefinancing,           null,
                      "sumRefinancingDebt",          sumRefinancingDebt,          null,
                      "sumFunds",                    sumFunds,                    null,
                      "party",                       party,                       null,
                      "ogrnPart10",                  ogrnPart10,                  null,
                      "regNumberPart10",             regNumberPart10,             null,
                      "oksm",                        oksm,                        null,
                      "sumDeal",                     sumDeal,                     null,
                      "fiCodePart10",                fiCodePart10,                null);
    end;

    macro printAddLineForPart9(creditId, tranche, addLine)
         // печать дополнительных строк
        var iteratorAddTrancheLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddTrancheLinesPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId, tranche, addLine));
        iteratorAddTrancheLinesPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var iteratorTrancheAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorTrancheAddLinesUserPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId,  tranche, addLine));
        iteratorTrancheAddLinesUserPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var synchronizerTrancheAddLines = null;
        synchronizerTrancheAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLinesByDate(), iteratorAddTrancheLinesPart9);
        synchronizerTrancheAddLines.addIterator(iteratorTrancheAddLinesUserPart9);

        synchronizerTrancheAddLines.moveFirst();

        while (not synchronizerTrancheAddLines.isDone())
                PrintLine("",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          creditId,
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "dateRemovalDebt"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "maturityDateDebt"),
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          ""
                        );

           synchronizerTrancheAddLines.moveNext();
        end;
        end;

    /**
     * Печать дополнительных строк для конкретного кредита с идентификатором creditId
    */
    macro printAddLines(creditId)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        iteratorAddLinesPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        iteratorAddLinesUserPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        iteratorAddLinesPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        iteratorAddLinesUserPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        iteratorAddLinesPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        iteratorAddLinesUserPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        iteratorAddLinesPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        iteratorAddLinesUserPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        iteratorAddLinesPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        iteratorAddLinesUserPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());

        var synchronizerAddLines = null;

        var maxItem = max(iteratorAddLinesPart2.count(), max(iteratorAddLinesPart3.count(), max(iteratorAddLinesPart5.count(), max(iteratorAddLinesPart6.count(), max(iteratorAddLinesPart7.count(), iteratorAddLinesPart9.count())))));
        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorAddLinesPart2.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart3.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart5.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart6.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart7.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart9.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
        end;

        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart5);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart6);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart7);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        var part2ArrAddLines = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part9ArrAddLines = RcbArray();
        var isNeedPrint = false;

        while (not synchronizerAddLines.isDone())
            var value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart2) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart2))
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "date"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateFilingSuit"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "lawCourt"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateClaim"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateEntry"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumClaim"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumCollection"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateBankruptcy"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart3) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart3))
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditIdCode"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart5) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart5))
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "okato"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart6) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart6))
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "information254P"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart7) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart7))
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumFormedReserve"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart9))
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9ArrAddLines.push_back(value);
            value = RcbArray();

            if (isNeedPrint == true)
                part2ArrAddLines.moveFirst();
                part3ArrAddLines.moveFirst();
                part5ArrAddLines.moveFirst();
                part6ArrAddLines.moveFirst();
                part7ArrAddLines.moveFirst();
                part9ArrAddLines.moveFirst();

                if (part2ArrAddLines.moveNext() and part3ArrAddLines.moveNext() and part5ArrAddLines.moveNext() and part6ArrAddLines.moveNext() and part7ArrAddLines.moveNext() and part9ArrAddLines.moveNext())
                    PrintLine("",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              creditId,
                              part2ArrAddLines.getCurrentItem()(1),
                              part2ArrAddLines.getCurrentItem()(2),
                              part2ArrAddLines.getCurrentItem()(3),
                              part2ArrAddLines.getCurrentItem()(4),
                              part2ArrAddLines.getCurrentItem()(5),
                              part2ArrAddLines.getCurrentItem()(6),
                              part2ArrAddLines.getCurrentItem()(7),
                              part2ArrAddLines.getCurrentItem()(8),
                              part2ArrAddLines.getCurrentItem()(9),
                              part2ArrAddLines.getCurrentItem()(10),
                              part2ArrAddLines.getCurrentItem()(11),
                              part2ArrAddLines.getCurrentItem()(12),
                              part2ArrAddLines.getCurrentItem()(13),
                              part2ArrAddLines.getCurrentItem()(14),
                              part2ArrAddLines.getCurrentItem()(15),
                              part2ArrAddLines.getCurrentItem()(16),
                              part2ArrAddLines.getCurrentItem()(17),
                              part2ArrAddLines.getCurrentItem()(18),
                              part3ArrAddLines.getCurrentItem()(2),
                              part3ArrAddLines.getCurrentItem()(3),
                              part3ArrAddLines.getCurrentItem()(4),
                              part3ArrAddLines.getCurrentItem()(5),
                              part3ArrAddLines.getCurrentItem()(6),
                              part3ArrAddLines.getCurrentItem()(7),
                              part3ArrAddLines.getCurrentItem()(8),
                              part3ArrAddLines.getCurrentItem()(9),
                              part3ArrAddLines.getCurrentItem()(10),
                              part3ArrAddLines.getCurrentItem()(11),
                              part3ArrAddLines.getCurrentItem()(12),
                              part3ArrAddLines.getCurrentItem()(13),
                              part3ArrAddLines.getCurrentItem()(14),
                              part3ArrAddLines.getCurrentItem()(15),
                              part3ArrAddLines.getCurrentItem()(16),
                              part3ArrAddLines.getCurrentItem()(17),
                              0, // SCR 229026
                              "",
                              "",
                              "",
                              "",
                              part5ArrAddLines.getCurrentItem()(2),
                              part5ArrAddLines.getCurrentItem()(3),
                              part5ArrAddLines.getCurrentItem()(4),
                              part5ArrAddLines.getCurrentItem()(5),
                              part5ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(2),
                              part6ArrAddLines.getCurrentItem()(3),
                              part6ArrAddLines.getCurrentItem()(4),
                              part6ArrAddLines.getCurrentItem()(5),
                              part6ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(7),
                              part6ArrAddLines.getCurrentItem()(8),
                              part6ArrAddLines.getCurrentItem()(9),
                              part6ArrAddLines.getCurrentItem()(10),
                              part6ArrAddLines.getCurrentItem()(11),
                              part7ArrAddLines.getCurrentItem()(2),
                              part7ArrAddLines.getCurrentItem()(3),
                              part7ArrAddLines.getCurrentItem()(4),
                              part7ArrAddLines.getCurrentItem()(5),
                              part7ArrAddLines.getCurrentItem()(6),
                              "",
                              "",
                              "",
                              "",
                              part9ArrAddLines.getCurrentItem()(2),
                              part9ArrAddLines.getCurrentItem()(3),
                              part9ArrAddLines.getCurrentItem()(4),
                              part9ArrAddLines.getCurrentItem()(5),
                              part9ArrAddLines.getCurrentItem()(6),
                              part9ArrAddLines.getCurrentItem()(7),
                              part9ArrAddLines.getCurrentItem()(8),
                              part9ArrAddLines.getCurrentItem()(9),
                              part9ArrAddLines.getCurrentItem()(10),
                              part9ArrAddLines.getCurrentItem()(11),
                              part9ArrAddLines.getCurrentItem()(12),
                              part9ArrAddLines.getCurrentItem()(13),
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              ""
                              ""
                              ""
                            );
                end;
            end;

            printAddLineForPart9(creditId, part9ArrAddLines.getCurrentItem()(1), 2);

            isNeedPrint = false;
            part2ArrAddLines = RcbArray();
            part3ArrAddLines = RcbArray();
            part5ArrAddLines = RcbArray();
            part6ArrAddLines = RcbArray();
            part7ArrAddLines = RcbArray();
            part9ArrAddLines = RcbArray();

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro create()
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6Arr = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7Arr = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part9ArrAddLines = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "date"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateFilingSuit"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "lawCourt"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateEntry"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumCollection"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateBankruptcy"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4) or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumFirstQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecondQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "rvpPercent"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumDeal"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "fiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        var currentCreditId = null;
        while (part1Arr.moveNext() and part2Arr.moveNext() and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext() and part10Arr.moveNext())
            PrintLine(part1Arr.getCurrentItem()(0),
                      part1Arr.getCurrentItem()(1),
                      part1Arr.getCurrentItem()(2),
                      part1Arr.getCurrentItem()(3),
                      part1Arr.getCurrentItem()(4),
                      part1Arr.getCurrentItem()(5),
                      part1Arr.getCurrentItem()(6),
                      part1Arr.getCurrentItem()(7),
                      part2Arr.getCurrentItem()(0),
                      part2Arr.getCurrentItem()(1),
                      part2Arr.getCurrentItem()(2),
                      part2Arr.getCurrentItem()(3),
                      part2Arr.getCurrentItem()(4),
                      part2Arr.getCurrentItem()(5),
                      part2Arr.getCurrentItem()(6),
                      part2Arr.getCurrentItem()(7),
                      part2Arr.getCurrentItem()(8),
                      part2Arr.getCurrentItem()(9),
                      part2Arr.getCurrentItem()(10),
                      part2Arr.getCurrentItem()(11),
                      part2Arr.getCurrentItem()(12),
                      part2Arr.getCurrentItem()(13),
                      part2Arr.getCurrentItem()(14),
                      part2Arr.getCurrentItem()(15),
                      part2Arr.getCurrentItem()(16),
                      part2Arr.getCurrentItem()(17),
                      part2Arr.getCurrentItem()(18),
                      part3Arr.getCurrentItem()(0),
                      part3Arr.getCurrentItem()(1),
                      part3Arr.getCurrentItem()(2),
                      part3Arr.getCurrentItem()(3),
                      part3Arr.getCurrentItem()(4),
                      part3Arr.getCurrentItem()(5),
                      part3Arr.getCurrentItem()(6),
                      part3Arr.getCurrentItem()(7),
                      part3Arr.getCurrentItem()(8),
                      part3Arr.getCurrentItem()(9),
                      part3Arr.getCurrentItem()(10),
                      part3Arr.getCurrentItem()(11),
                      part3Arr.getCurrentItem()(12),
                      part3Arr.getCurrentItem()(13),
                      part3Arr.getCurrentItem()(14),
                      part3Arr.getCurrentItem()(15),
                      part4Arr.getCurrentItem()(0),
                      part4Arr.getCurrentItem()(1),
                      part4Arr.getCurrentItem()(2),
                      part4Arr.getCurrentItem()(3),
                      part4Arr.getCurrentItem()(4),
                      part5Arr.getCurrentItem()(0),
                      part5Arr.getCurrentItem()(1),
                      part5Arr.getCurrentItem()(2),
                      part5Arr.getCurrentItem()(3),
                      part5Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(0),
                      part6Arr.getCurrentItem()(1),
                      part6Arr.getCurrentItem()(2),
                      part6Arr.getCurrentItem()(3),
                      part6Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(5),
                      part6Arr.getCurrentItem()(6),
                      part6Arr.getCurrentItem()(7),
                      part6Arr.getCurrentItem()(8),
                      part6Arr.getCurrentItem()(9),
                      part7Arr.getCurrentItem()(0),
                      part7Arr.getCurrentItem()(1),
                      part7Arr.getCurrentItem()(2),
                      part7Arr.getCurrentItem()(3),
                      part7Arr.getCurrentItem()(4),
                      part8Arr.getCurrentItem()(0),
                      part8Arr.getCurrentItem()(1),
                      part8Arr.getCurrentItem()(2),
                      part8Arr.getCurrentItem()(3),
                      part9Arr.getCurrentItem()(0),
                      part9Arr.getCurrentItem()(1),
                      part9Arr.getCurrentItem()(2),
                      part9Arr.getCurrentItem()(3),
                      part9Arr.getCurrentItem()(4),
                      part9Arr.getCurrentItem()(5),
                      part9Arr.getCurrentItem()(6),
                      part9Arr.getCurrentItem()(7),
                      part9Arr.getCurrentItem()(8),
                      part9Arr.getCurrentItem()(9),
                      part9Arr.getCurrentItem()(10),
                      part9Arr.getCurrentItem()(11),
                      part10Arr.getCurrentItem()(0),
                      part10Arr.getCurrentItem()(1),
                      part10Arr.getCurrentItem()(2),
                      part10Arr.getCurrentItem()(3),
                      part10Arr.getCurrentItem()(4),
                      part10Arr.getCurrentItem()(5),
                      part10Arr.getCurrentItem()(6),
                      part10Arr.getCurrentItem()(7),
                      part10Arr.getCurrentItem()(8)
                    );

            // printAddLineForMainRow(part2Arr.getCurrentItem()(0), 2);
            printAddLineForPart9(part2Arr.getCurrentItem()(0), part2Arr.getCurrentItem()(0), 2);

            if (currentCreditId != part2Arr.getCurrentItem()(0))
                printAddLines(part2Arr.getCurrentItem()(0));
            end;

            currentCreditId = part2Arr.getCurrentItem()(0);
        end;
    end;

    private macro constructorF303ReportPrintController_4212()
        initializeVariables();
        // восстановим оригинальную функцию
        ReplaceMacro("isStandalone");
        initCB_CReportTemplate( null, "f303Template_4212.xls", null, rcbWebCommon_isWebSystem());
    end;

    constructorF303ReportPrintController_4212()
end;


class (TF303ReportPrintController) TF303ReportPrintController_4637()
    macro getCreditIdPrintValue(iterator :  RcbValueIterator)
        var contractId : String;

        if (iterator.currentItem == null)
            return "";
        end;

        if (TF303Parameters().getIsIdContract() == true)
            contractId = string(int(iterator.currentItem.fieldValue("creditId").exact));
        else
            contractId = iterator.currentItem.fieldValue("creditNumber").exact;
            if (contractId == "бн")
                contractId = string(int(iterator.currentItem.fieldValue("creditId").exact));
            end;
        end;

        return contractId;
    end;

    private macro BeginReport( /* NumCopy:INTEGER */ )
        SetActiveSheet("Page1");

        SetNumberPage("Страница ", NumStr);

        initializeOkatoCode();
        initializeOkpoCode();
        initializeRegistrationNumber();
        initializeLendingAgencyName();
        initializeLendingAgencyPostalAdress();

        PrintFormatString(null,
                          "periodicityName", ternary(rcbApplication().currentReport.context.period.kind == RCB_PK_MONTH, "Месячная", ""),
                          "reportName", "СВЕДЕНИЯ О ССУДАХ, ПРЕДОСТАВЛЕННЫХ ЮРИДИЧЕСКИМ ЛИЦАМ",
                          "reportDate", getPeriodName(),
                          "okatoCode", m_okatoCode,
                          "okpoCode", m_okpoCode,
                          "registrationNumber", m_registrationNumber,
                          "organisationName", m_organisationName,
                          "mailAddress", m_mailAddress
                          );

        PrintHead(FPrintHead);

        RegisterTable("N1_MainTable", null,
                      "debtor",
                      "ogrn",
                      "ogrnip",
                      "registrationDate",
                      "debtorINN",
                      "debtorOKPO",
                      "debtorOKSM",
                      "relationsWitnBank",
                      "okved",
                      "borrowersGroupNumber",
                      "borrowersGroupName",
                      "creditId",
                      "creditNumber",
                      "date",
                      "numberLoan",
                      "dateLoan",
                      "partyLoan",
                      "ogrnLoan",
                      "regnumberLoan",
                      "oksmLoan",
                      "numberRestructurings",
                      "dateFilingSuit",
                      "lawCourt",
                      "dateClaim",
                      "dateEntry",
                      "sumClaim",
                      "sumCollection",
                      "fiCode",
                      "bankruptcyInfo",
                      "dateBankruptcy",
                      "dateLastRestructuring",
                      "beneficiaryName",
                      "beneficiaryOgrn",
                      "beneficiaryRegNumber",
                      "beneficiaryOksm",
                      "obligationKind",
                      "obligationSum",
                      "maturityObligation",
                      "typeLoan",
                      "purposeCredit",
                      "sumOrigContract",
                      "sumChangesContract",
                      "fiCodeOrigContract",
                      "fiCodeChangesContract",
                      "dateOrigContract",
                      "dateChangesContract",
                      "typeRate",
                      "rateOrigContract",
                      "rateChangesContract",
                      "rateLoan",
                      "interestPeriod",
                      "typeFloatRate",
                      "conditionCode",
                      "creditIdCode",
                      "typeRateEndDate",
                      "typeFloatRateEndDate",
                      "typeSecurity",
                      "sumSecurities",
                      "repossessionDate",
                      "sumSecuritiesReserve",
                      "typeInsurance",
                      "securitiesRvpPercent",
                      "securitiesRvpObligations",
                      "dateLoanPart5",
                      "userTrancheNumber",
                      "funds",
                      "fiCodePart5",
                      "okato",
                      "termDebtAccount",
                      "arrearsAccount",
                      "sumTermDebt",
                      "sumOverDebt",
                      "loanQuality",
                      "evaluation",
                      "calcReserve",
                      "sumCalcReserveSecurity",
                      "sumFormedReserve",
                      "information254P",
                      "finPositionBorrower",
                      "qualityServiceDebt",
                      "highRiskFactor",
                      "sumClaimBalance",
                      "sumClaimBalanceOver",
                      "sumClaimNotBalance",
                      "sumClaimNotBalanceOver",
                      "sumFormedReservePart7",
                      "sumUnusedLimits",
                      "sumCalcReserveSecurityPart8",
                      "sumFormedReservePart8",
                      "rvpPercentPart8",
                      "periodicityRepayment",
                      "sumProvidedDebt",
                      "sumPaidDebt",
                      "periodicityInterest",
                      "sumProvidedInterest",
                      "sumPaidInterest",
                      "sumFines",
                      "dateRemovalDebt",
                      "maturityDateDebt",
                      "sourceRepayment",
                      "codeNewCredit",
                      "regNumber",
                      "principalPaymentFiCode",
                      "percentPaymentFiCode",
                      "methodRefinancing",
                      "sumRefinancingDebt",
                      "sumFunds",
                      "party",
                      "ogrnPart10",
                      "regNumberPart10",
                      "oksm",
                      "sumDeal",
                      "fiCodePart10");
    end;

    private macro PrintLine(debtor,
                            ogrn,
                            ogrnip,
                            registrationDate,
                            debtorINN,
                            debtorOKPO,
                            debtorOKSM,
                            relationsWitnBank,
                            okved,
                            borrowersGroupNumber,
                            borrowersGroupName,
                            creditId,
                            creditNumber,
                            date,
                            numberLoan,
                            dateLoan,
                            partyLoan,
                            ogrnLoan,
                            regnumberLoan,
                            oksmLoan,
                            numberRestructurings,
                            dateFilingSuit,
                            lawCourt,
                            dateClaim,
                            dateEntry,
                            sumClaim,
                            sumCollection,
                            fiCode,
                            bankruptcyInfo,
                            dateBankruptcy,
                            dateLastRestructuring,
                            beneficiaryName,
                            beneficiaryOgrn,
                            beneficiaryRegNumber,
                            beneficiaryOksm,
                            obligationKind,
                            obligationSum,
                            maturityObligation,
                            typeLoan,
                            purposeCredit,
                            sumOrigContract,
                            sumChangesContract,
                            fiCodeOrigContract,
                            fiCodeChangesContract,
                            dateOrigContract,
                            dateChangesContract,
                            typeRate,
                            rateOrigContract,
                            rateChangesContract,
                            rateLoan,
                            interestPeriod,
                            typeFloatRate,
                            conditionCode,
                            creditIdCode,
                            typeRateEndDate,
                            typeFloatRateEndDate,
                            typeSecurity,
                            sumSecurities,
                            repossessionDate,
                            sumSecuritiesReserve,
                            typeInsurance,
                            securitiesRvpPercent,
                            securitiesRvpObligations,
                            dateLoanPart5,
                            userTrancheNumber,
                            funds,
                            fiCodePart5,
                            okato,
                            termDebtAccount,
                            arrearsAccount,
                            sumTermDebt,
                            sumOverDebt,
                            loanQuality,
                            evaluation,
                            calcReserve,
                            sumCalcReserveSecurity,
                            sumFormedReserve,
                            information254P,
                            finPositionBorrower,
                            qualityServiceDebt,
                            highRiskFactor,
                            sumClaimBalance,
                            sumClaimBalanceOver,
                            sumClaimNotBalance,
                            sumClaimNotBalanceOver,
                            sumFormedReservePart7,
                            sumUnusedLimits,
                            sumCalcReserveSecurityPart8,
                            sumFormedReservePart8,
                            rvpPercentPart8,
                            periodicityRepayment,
                            sumProvidedDebt,
                            sumPaidDebt,
                            periodicityInterest,
                            sumProvidedInterest,
                            sumPaidInterest,
                            sumFines,
                            dateRemovalDebt,
                            maturityDateDebt,
                            sourceRepayment,
                            codeNewCredit,
                            regNumber,
                            principalPaymentFiCode,
                            percentPaymentFiCode,
                            methodRefinancing,
                            sumRefinancingDebt,
                            sumFunds,
                            party,
                            ogrnPart10,
                            regNumberPart10,
                            oksm,
                            sumDeal,
                            fiCodePart10)

        PrintTableLine(
                      "debtor",                      debtor,                      null,
                      "ogrn",                        ogrn,                        null,
                      "ogrnip",                      ogrnip,                      null,
                      "registrationDate",            registrationDate,            null,
                      "debtorINN",                   debtorINN,                   null,
                      "debtorOKPO",                  debtorOKPO,                  null,
                      "debtorOKSM",                  debtorOKSM,                  null,
                      "relationsWitnBank",           relationsWitnBank,           null,
                      "okved",                       okved,                       null,
                      "borrowersGroupNumber",        borrowersGroupNumber,        null,
                      "borrowersGroupName",          borrowersGroupName,          null,
                      "creditId",                    creditId,                    null,
                      "creditNumber",                creditNumber,                null,
                      "date",                        date,                        null,
                      "numberLoan",                  numberLoan,                  null,
                      "dateLoan",                    dateLoan,                    null,
                      "partyLoan",                   partyLoan,                   null,
                      "ogrnLoan",                    ogrnLoan,                    null,
                      "regnumberLoan",               regnumberLoan,               null,
                      "oksmLoan",                    oksmLoan,                    null,
                      "numberRestructurings",        numberRestructurings,        null,
                      "dateFilingSuit",              dateFilingSuit,              null,
                      "lawCourt",                    lawCourt,                    null,
                      "dateClaim",                   dateClaim,                   null,
                      "dateEntry",                   dateEntry,                   null,
                      "sumClaim",                    sumClaim,                    null,
                      "sumCollection",               sumCollection,               null,
                      "fiCode",                      fiCode,                      null,
                      "bankruptcyInfo",              bankruptcyInfo,              null,
                      "dateBankruptcy",              dateBankruptcy,              null,
                      "dateLastRestructuring",       dateLastRestructuring,       null,
                      "beneficiaryName",             beneficiaryName,             null,
                      "beneficiaryOgrn",             beneficiaryOgrn,             null,
                      "beneficiaryRegNumber",        beneficiaryRegNumber,        null,
                      "beneficiaryOksm",             beneficiaryOksm,             null,
                      "obligationKind",              obligationKind,              null,
                      "obligationSum",               obligationSum,               null,
                      "maturityObligation",          maturityObligation,          null,
                      "typeLoan",                    String("\n", typeLoan),      null, /* SCR 229561 -  "typeLoan",вот такой нужен костыль, чтобы выводилась ТОЧКА вместо ЗАПЯТОЙ, никакие явные задания типа не помогают */
                      "purposeCredit",               purposeCredit,               null,
                      "sumOrigContract",             sumOrigContract,             null,
                      "sumChangesContract",          sumChangesContract,          null,
                      "fiCodeOrigContract",          fiCodeOrigContract,          null,
                      "fiCodeChangesContract",       fiCodeChangesContract,       null,
                      "dateOrigContract",            dateOrigContract,            null,
                      "dateChangesContract",         dateChangesContract,         null,
                      "typeRate",                    typeRate,                    null,
                      "rateOrigContract",            rateOrigContract,            3,
                      "rateChangesContract",         rateChangesContract,         3,
                      "rateLoan",                    rateLoan,                    3,
                      "interestPeriod",              interestPeriod,              null,
                      "typeFloatRate",               typeFloatRate,               null,
                      "conditionCode",               conditionCode,               null,
                      "creditIdCode",                creditIdCode,                null,
                      "typeRateEndDate",             typeRateEndDate,             null,
                      "typeFloatRateEndDate",        typeFloatRateEndDate,        null,
                      "typeSecurity",                String("\n", typeSecurity),  null,
                      "sumSecurities",               sumSecurities,               null,
                      "repossessionDate",            repossessionDate,            null,
                      "sumSecuritiesReserve",        sumSecuritiesReserve,        null,
                      "typeInsurance",               typeInsurance,               null,
                      "securitiesRvpPercent",        securitiesRvpPercent,        null,
                      "securitiesRvpObligations",    securitiesRvpObligations,    null,
                      "dateLoanPart5",               dateLoanPart5,               null,
                      "userTrancheNumber",           userTrancheNumber,           null,
                      "funds",                       funds,                       null,
                      "fiCodePart5",                 fiCodePart5,                 null,
                      "okato",                       okato,                       null,
                      "termDebtAccount",             termDebtAccount,             null,
                      "arrearsAccount",              arrearsAccount,              null,
                      "sumTermDebt",                 sumTermDebt,                 null,
                      "sumOverDebt",                 sumOverDebt,                 null,
                      "loanQuality",                 loanQuality,                 null,
                      "evaluation",                  evaluation,                  null,
                      "calcReserve",                 calcReserve,                 3,
                      "sumCalcReserveSecurity",      sumCalcReserveSecurity,      null,
                      "sumFormedReserve",            sumFormedReserve,            null,
                      "information254P",             information254P,             null,
                      "finPositionBorrower",         finPositionBorrower,         null,
                      "qualityServiceDebt",          qualityServiceDebt,          null,
                      "highRiskFactor",              highRiskFactor,              null,
                      "sumClaimBalance",             sumClaimBalance,             null,
                      "sumClaimBalanceOver",         sumClaimBalanceOver,         null,
                      "sumClaimNotBalance",          sumClaimNotBalance,          null,
                      "sumClaimNotBalanceOver",      sumClaimNotBalanceOver,      null,
                      "sumFormedReservePart7",       sumFormedReservePart7,       null,
                      "sumUnusedLimits",             sumUnusedLimits,             null,
                      "sumCalcReserveSecurityPart8", sumCalcReserveSecurityPart8, null,
                      "sumFormedReservePart8",       sumFormedReservePart8,       null,
                      "rvpPercentPart8",             rvpPercentPart8,             null,
                      "periodicityRepayment",        periodicityRepayment,        null,
                      "sumProvidedDebt",             sumProvidedDebt,             null,
                      "sumPaidDebt",                 sumPaidDebt,                 null,
                      "periodicityInterest",         periodicityInterest,         null,
                      "sumProvidedInterest",         sumProvidedInterest,         null,
                      "sumPaidInterest",             sumPaidInterest,             null,
                      "sumFines",                    sumFines,                    null,
                      "dateRemovalDebt",             dateRemovalDebt,             null,
                      "maturityDateDebt",            maturityDateDebt,            null,
                      "sourceRepayment",             sourceRepayment,             null,
                      "codeNewCredit",               codeNewCredit,               null,
                      "regNumber",                   regNumber,                   null,
                      "principalPaymentFiCode",      principalPaymentFiCode,      null,
                      "percentPaymentFiCode",        percentPaymentFiCode,        null,
                      "methodRefinancing",           methodRefinancing,           null,
                      "sumRefinancingDebt",          sumRefinancingDebt,          null,
                      "sumFunds",                    sumFunds,                    null,
                      "party",                       party,                       null,
                      "ogrnPart10",                  ogrnPart10,                  null,
                      "regNumberPart10",             regNumberPart10,             null,
                      "oksm",                        oksm,                        null,
                      "sumDeal",                     sumDeal,                     null,
                      "fiCodePart10",                fiCodePart10,                null);
    end;

    macro printAddLineForPart4(creditId, creditIdForReport)
         // печать дополнительных строк
        var iteratorAddLinesPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        iteratorAddLinesPart4.setFilter(TIteratorNonZeroAddCreditLineFilter(creditId));

        var iteratorAddLinesUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        iteratorAddLinesUserPart4.setFilter(TIteratorNonZeroAddCreditLineFilter(creditId));

        var synchronizerAddLines = null;
        synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorAddLinesPart4);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart4);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
                PrintLine("",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          creditIdForReport,    //id
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "typeSecurity"),
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "sumSecurities"),
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "repossessionDate"),
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "sumSecuritiesReserve"),
                          "",
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "securitiesRvpPercent"),
                          getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "securitiesRvpObligations"),
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          ""
                        );

           synchronizerAddLines.moveNext();
        end;
    end;

    macro printAddLineForPart9(creditId, tranche, addLine, creditIdForReport)
         // печать дополнительных строк
        var iteratorAddTrancheLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddTrancheLinesPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId, tranche, addLine));
        iteratorAddTrancheLinesPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var iteratorTrancheAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorTrancheAddLinesUserPart9.setFilter(TIteratorAddCreditAndTrancheLineFilter(creditId,  tranche, addLine));
        iteratorTrancheAddLinesUserPart9.setSortOrder(TSyncSorterAddLinesByDate());

        var synchronizerTrancheAddLines = null;
        synchronizerTrancheAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLinesByDate(), iteratorAddTrancheLinesPart9);
        synchronizerTrancheAddLines.addIterator(iteratorTrancheAddLinesUserPart9);

        synchronizerTrancheAddLines.moveFirst();

        while (not synchronizerTrancheAddLines.isDone())
                PrintLine("",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          creditIdForReport,
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "sumPaidDebt"),
                          "",
                          "",
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "sumPaidInterest"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "sumFines"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "dateRemovalDebt"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "maturityDateDebt"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "sourceRepayment"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "codeNewCredit"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "regNumber"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "principalPaymentFiCode"),
                          getPrintValue(iteratorAddTrancheLinesPart9, iteratorTrancheAddLinesUserPart9, "percentPaymentFiCode"),
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          "",
                          ""
                        );

           synchronizerTrancheAddLines.moveNext();
        end;
    end;

    /**
     * Печать дополнительных строк для конкретного кредита с идентификатором creditId
    */
    macro printAddLines(creditId, creditIdForReport)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        iteratorAddLinesPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        iteratorAddLinesUserPart2.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLinesPart2());

        var iteratorAddLinesPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        iteratorAddLinesPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        iteratorAddLinesUserPart3.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart3.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        iteratorAddLinesPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        iteratorAddLinesUserPart5.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart5.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        iteratorAddLinesPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        iteratorAddLinesUserPart6.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart6.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        iteratorAddLinesPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        iteratorAddLinesUserPart7.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart7.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());

        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());

        var synchronizerAddLines = null;

        var maxItem = max(iteratorAddLinesPart2.count(), max(iteratorAddLinesPart3.count(), max(iteratorAddLinesPart5.count(), max(iteratorAddLinesPart6.count(), max(iteratorAddLinesPart7.count(), iteratorAddLinesPart9.count())))));
        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorAddLinesPart2.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart3.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart5.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart6.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart7.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart7);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart9);
        elif (iteratorAddLinesPart9.count() == maxItem)
            synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
            synchronizerAddLines.addIterator(iteratorAddLinesPart2);
            synchronizerAddLines.addIterator(iteratorAddLinesPart3);
            synchronizerAddLines.addIterator(iteratorAddLinesPart5);
            synchronizerAddLines.addIterator(iteratorAddLinesPart6);
            synchronizerAddLines.addIterator(iteratorAddLinesPart7);
        end;

        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart5);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart6);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart7);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        var part2ArrAddLines = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part9ArrAddLines = RcbArray();
        var isNeedPrint = false;

        while (not synchronizerAddLines.isDone())
            var value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart2) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart2))
                value.push_back(creditIdForReport);
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "date"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateFilingSuit"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "lawCourt"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateClaim"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateEntry"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumClaim"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumCollection"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateBankruptcy"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateLastRestructuring"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryName"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryOgrn"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryRegNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryOksm"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "obligationKind"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "obligationSum"));
                value.push_back(getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "maturityObligation"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart3) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart3))
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditIdCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeRateEndDate"));
                value.push_back(getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "typeFloatRateEndDate"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart5) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart5))
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart5, iteratorAddLinesUserPart5, "okato"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart6) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart6))
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "information254P"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "finPositionBorrower"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "qualityServiceDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "highRiskFactor"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart7) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart7))
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorAddLinesPart7, iteratorAddLinesUserPart7, "sumFormedReserve"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7ArrAddLines.push_back(value);
            value = RcbArray();

            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) or not synchronizerAddLines.isNull(iteratorAddLinesUserPart9))
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "creditId"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "trancheNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "principalPaymentFiCode"));
                value.push_back(getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "percentPaymentFiCode"));
                isNeedPrint = true;
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9ArrAddLines.push_back(value);
            value = RcbArray();

            if (isNeedPrint == true)
                part2ArrAddLines.moveFirst();
                part3ArrAddLines.moveFirst();
                part5ArrAddLines.moveFirst();
                part6ArrAddLines.moveFirst();
                part7ArrAddLines.moveFirst();
                part9ArrAddLines.moveFirst();

                if (part2ArrAddLines.moveNext() and part3ArrAddLines.moveNext() and part5ArrAddLines.moveNext() and part6ArrAddLines.moveNext() and part7ArrAddLines.moveNext() and part9ArrAddLines.moveNext())
                    PrintLine("",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              creditIdForReport,
                              part2ArrAddLines.getCurrentItem()(1),
                              part2ArrAddLines.getCurrentItem()(2),
                              part2ArrAddLines.getCurrentItem()(3),
                              part2ArrAddLines.getCurrentItem()(4),
                              part2ArrAddLines.getCurrentItem()(5),
                              part2ArrAddLines.getCurrentItem()(6),
                              part2ArrAddLines.getCurrentItem()(7),
                              part2ArrAddLines.getCurrentItem()(8),
                              part2ArrAddLines.getCurrentItem()(9),
                              part2ArrAddLines.getCurrentItem()(10),
                              part2ArrAddLines.getCurrentItem()(11),
                              part2ArrAddLines.getCurrentItem()(12),
                              part2ArrAddLines.getCurrentItem()(13),
                              part2ArrAddLines.getCurrentItem()(14),
                              part2ArrAddLines.getCurrentItem()(15),
                              part2ArrAddLines.getCurrentItem()(16),
                              part2ArrAddLines.getCurrentItem()(17),
                              part2ArrAddLines.getCurrentItem()(18),
                              part2ArrAddLines.getCurrentItem()(19),
                              part2ArrAddLines.getCurrentItem()(20),
                              part2ArrAddLines.getCurrentItem()(21),
                              part2ArrAddLines.getCurrentItem()(22),
                              part2ArrAddLines.getCurrentItem()(23),
                              part2ArrAddLines.getCurrentItem()(24),
                              part2ArrAddLines.getCurrentItem()(25),
                              part2ArrAddLines.getCurrentItem()(26),
                              part3ArrAddLines.getCurrentItem()(2),
                              part3ArrAddLines.getCurrentItem()(3),
                              part3ArrAddLines.getCurrentItem()(4),
                              part3ArrAddLines.getCurrentItem()(5),
                              part3ArrAddLines.getCurrentItem()(6),
                              part3ArrAddLines.getCurrentItem()(7),
                              part3ArrAddLines.getCurrentItem()(8),
                              part3ArrAddLines.getCurrentItem()(9),
                              part3ArrAddLines.getCurrentItem()(10),
                              part3ArrAddLines.getCurrentItem()(11),
                              part3ArrAddLines.getCurrentItem()(12),
                              part3ArrAddLines.getCurrentItem()(13),
                              part3ArrAddLines.getCurrentItem()(14),
                              part3ArrAddLines.getCurrentItem()(15),
                              part3ArrAddLines.getCurrentItem()(16),
                              part3ArrAddLines.getCurrentItem()(17),
                              part3ArrAddLines.getCurrentItem()(18),
                              part3ArrAddLines.getCurrentItem()(19),
                              0, // SCR 229026
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              part5ArrAddLines.getCurrentItem()(2),
                              part5ArrAddLines.getCurrentItem()(3),
                              part5ArrAddLines.getCurrentItem()(4),
                              part5ArrAddLines.getCurrentItem()(5),
                              part5ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(2),
                              part6ArrAddLines.getCurrentItem()(3),
                              part6ArrAddLines.getCurrentItem()(4),
                              part6ArrAddLines.getCurrentItem()(5),
                              part6ArrAddLines.getCurrentItem()(6),
                              part6ArrAddLines.getCurrentItem()(7),
                              part6ArrAddLines.getCurrentItem()(8),
                              part6ArrAddLines.getCurrentItem()(9),
                              part6ArrAddLines.getCurrentItem()(10),
                              part6ArrAddLines.getCurrentItem()(11),
                              part6ArrAddLines.getCurrentItem()(12),
                              part6ArrAddLines.getCurrentItem()(13),
                              part6ArrAddLines.getCurrentItem()(14),
                              part7ArrAddLines.getCurrentItem()(2),
                              part7ArrAddLines.getCurrentItem()(3),
                              part7ArrAddLines.getCurrentItem()(4),
                              part7ArrAddLines.getCurrentItem()(5),
                              part7ArrAddLines.getCurrentItem()(6),
                              "",
                              "",
                              "",
                              "",
                              part9ArrAddLines.getCurrentItem()(2),
                              part9ArrAddLines.getCurrentItem()(3),
                              part9ArrAddLines.getCurrentItem()(4),
                              part9ArrAddLines.getCurrentItem()(5),
                              part9ArrAddLines.getCurrentItem()(6),
                              part9ArrAddLines.getCurrentItem()(7),
                              part9ArrAddLines.getCurrentItem()(8),
                              part9ArrAddLines.getCurrentItem()(9),
                              part9ArrAddLines.getCurrentItem()(10),
                              part9ArrAddLines.getCurrentItem()(11),
                              part9ArrAddLines.getCurrentItem()(12),
                              part9ArrAddLines.getCurrentItem()(13),
                              part9ArrAddLines.getCurrentItem()(14),
                              part9ArrAddLines.getCurrentItem()(15),
                              "",
                              "",
                              "",
                              "",
                              "",
                              "",
                              ""
                              ""
                              ""
                            );
                end;
            end;

            printAddLineForPart9(creditId, part9ArrAddLines.getCurrentItem()(1), 2, creditIdForReport);

            isNeedPrint = false;
            part2ArrAddLines = RcbArray();
            part3ArrAddLines = RcbArray();
            part5ArrAddLines = RcbArray();
            part6ArrAddLines = RcbArray();
            part7ArrAddLines = RcbArray();
            part9ArrAddLines = RcbArray();

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro create()
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorPart2.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorPart4.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        /*
        ** Джойнимся с разделом, у которого больше всего основных строк по одному договору
        */
        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part3ArrAddLines = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part5ArrAddLines = RcbArray();
        var part6Arr = RcbArray();
        var part6ArrAddLines = RcbArray();
        var part7Arr = RcbArray();
        var part7ArrAddLines = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part9ArrAddLines = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "okved"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "borrowersGroupNumber"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "borrowersGroupName"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "date"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateFilingSuit"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "lawCourt"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateEntry"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumClaim"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "sumCollection"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "fiCode"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateBankruptcy"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLastRestructuring"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "beneficiaryName"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "beneficiaryOgrn"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "beneficiaryRegNumber"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "beneficiaryOksm"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "obligationKind"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "obligationSum"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "maturityObligation"));
                value.push_back(getCreditIdPrintValue(iteratorPart2));   //id договора для печати
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back(""); //id договора для печати
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRateEndDate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRateEndDate"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4) or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecurities"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "repossessionDate"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "securitiesRvpPercent"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "securitiesRvpObligations"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "finPositionBorrower"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "qualityServiceDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "highRiskFactor"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "rvpPercent"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "principalPaymentFiCode"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "percentPaymentFiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumDeal"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "fiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        var currentCreditId = null;
        while (part1Arr.moveNext() and part2Arr.moveNext() and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext() and part10Arr.moveNext())

           var creditId = part2Arr.getCurrentItem()(0);
           var creditIdForReport = part2Arr.getCurrentItem()(27);

            PrintLine(part1Arr.getCurrentItem()(0),
                      part1Arr.getCurrentItem()(1),
                      part1Arr.getCurrentItem()(2),
                      part1Arr.getCurrentItem()(3),
                      part1Arr.getCurrentItem()(4),
                      part1Arr.getCurrentItem()(5),
                      part1Arr.getCurrentItem()(6),
                      part1Arr.getCurrentItem()(7),
                      part1Arr.getCurrentItem()(8),
                      part1Arr.getCurrentItem()(9),
                      part1Arr.getCurrentItem()(10),
                      creditIdForReport,
                      part2Arr.getCurrentItem()(1),
                      part2Arr.getCurrentItem()(2),
                      part2Arr.getCurrentItem()(3),
                      part2Arr.getCurrentItem()(4),
                      part2Arr.getCurrentItem()(5),
                      part2Arr.getCurrentItem()(6),
                      part2Arr.getCurrentItem()(7),
                      part2Arr.getCurrentItem()(8),
                      part2Arr.getCurrentItem()(9),
                      part2Arr.getCurrentItem()(10),
                      part2Arr.getCurrentItem()(11),
                      part2Arr.getCurrentItem()(12),
                      part2Arr.getCurrentItem()(13),
                      part2Arr.getCurrentItem()(14),
                      part2Arr.getCurrentItem()(15),
                      part2Arr.getCurrentItem()(16),
                      part2Arr.getCurrentItem()(17),
                      part2Arr.getCurrentItem()(18),
                      part2Arr.getCurrentItem()(19),
                      part2Arr.getCurrentItem()(20),
                      part2Arr.getCurrentItem()(21),
                      part2Arr.getCurrentItem()(22),
                      part2Arr.getCurrentItem()(23),
                      part2Arr.getCurrentItem()(24),
                      part2Arr.getCurrentItem()(25),
                      part2Arr.getCurrentItem()(26),
                      part3Arr.getCurrentItem()(0),
                      part3Arr.getCurrentItem()(1),
                      part3Arr.getCurrentItem()(2),
                      part3Arr.getCurrentItem()(3),
                      part3Arr.getCurrentItem()(4),
                      part3Arr.getCurrentItem()(5),
                      part3Arr.getCurrentItem()(6),
                      part3Arr.getCurrentItem()(7),
                      part3Arr.getCurrentItem()(8),
                      part3Arr.getCurrentItem()(9),
                      part3Arr.getCurrentItem()(10),
                      part3Arr.getCurrentItem()(11),
                      part3Arr.getCurrentItem()(12),
                      part3Arr.getCurrentItem()(13),
                      part3Arr.getCurrentItem()(14),
                      part3Arr.getCurrentItem()(15),
                      part3Arr.getCurrentItem()(16),
                      part3Arr.getCurrentItem()(17),
                      part4Arr.getCurrentItem()(0),
                      part4Arr.getCurrentItem()(1),
                      part4Arr.getCurrentItem()(2),
                      part4Arr.getCurrentItem()(3),
                      part4Arr.getCurrentItem()(4),
                      part4Arr.getCurrentItem()(5),
                      part4Arr.getCurrentItem()(6),
                      part5Arr.getCurrentItem()(0),
                      part5Arr.getCurrentItem()(1),
                      part5Arr.getCurrentItem()(2),
                      part5Arr.getCurrentItem()(3),
                      part5Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(0),
                      part6Arr.getCurrentItem()(1),
                      part6Arr.getCurrentItem()(2),
                      part6Arr.getCurrentItem()(3),
                      part6Arr.getCurrentItem()(4),
                      part6Arr.getCurrentItem()(5),
                      part6Arr.getCurrentItem()(6),
                      part6Arr.getCurrentItem()(7),
                      part6Arr.getCurrentItem()(8),
                      part6Arr.getCurrentItem()(9),
                      part6Arr.getCurrentItem()(10),
                      part6Arr.getCurrentItem()(11),
                      part6Arr.getCurrentItem()(12),
                      part7Arr.getCurrentItem()(0),
                      part7Arr.getCurrentItem()(1),
                      part7Arr.getCurrentItem()(2),
                      part7Arr.getCurrentItem()(3),
                      part7Arr.getCurrentItem()(4),
                      part8Arr.getCurrentItem()(0),
                      part8Arr.getCurrentItem()(1),
                      part8Arr.getCurrentItem()(2),
                      part8Arr.getCurrentItem()(3),
                      part9Arr.getCurrentItem()(0),
                      part9Arr.getCurrentItem()(1),
                      part9Arr.getCurrentItem()(2),
                      part9Arr.getCurrentItem()(3),
                      part9Arr.getCurrentItem()(4),
                      part9Arr.getCurrentItem()(5),
                      part9Arr.getCurrentItem()(6),
                      part9Arr.getCurrentItem()(7),
                      part9Arr.getCurrentItem()(8),
                      part9Arr.getCurrentItem()(9),
                      part9Arr.getCurrentItem()(10),
                      part9Arr.getCurrentItem()(11),
                      part9Arr.getCurrentItem()(12),
                      part9Arr.getCurrentItem()(13),
                      part10Arr.getCurrentItem()(0),
                      part10Arr.getCurrentItem()(1),
                      part10Arr.getCurrentItem()(2),
                      part10Arr.getCurrentItem()(3),
                      part10Arr.getCurrentItem()(4),
                      part10Arr.getCurrentItem()(5),
                      part10Arr.getCurrentItem()(6),
                      part10Arr.getCurrentItem()(7),
                      part10Arr.getCurrentItem()(8)
                    );

            printAddLineForPart4(creditId, creditIdForReport);
            printAddLineForPart9(creditId, creditId, 2, creditIdForReport);

            if (currentCreditId != creditId)
                printAddLines(creditId, creditIdForReport);
            end;

            currentCreditId = creditId;
        end;
    end;

    private macro constructorF303ReportPrintController_4637()
        initializeVariables();
        // восстановим оригинальную функцию
        ReplaceMacro("isStandalone");
        initCB_CReportTemplate( null, "f303Template_4637.xls", null, rcbWebCommon_isWebSystem());
    end;

    constructorF303ReportPrintController_4637()
end;
