/*
$Name:          f303Report.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 303. Отчет
*/

/**
 * Форма 303. Отчет.
 *
 * @since   10.08.2015
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbReportBase) TF303Report(report, isLazy)

    /**
     * Добавить раздел отчета.
     * 
     * @param     partId	название раздела
     * @param     attributeValue	ссылка на составное значение раздела
     */
    macro addPart(partId : String, attributeValue)
    end;

    private macro getPartCompositeValue(partId : String)
        if (partId == "1")
            return m_rcbReport.attributeValue("Раздел1");
        elif (partId == "2")
            return m_rcbReport.attributeValue("Раздел2");
        elif (partId == "3")
            return m_rcbReport.attributeValue("Раздел3");
        elif (partId == "4")
            return m_rcbReport.attributeValue("Раздел4");
        elif (partId == "5")
            return m_rcbReport.attributeValue("Раздел5");
        elif (partId == "6")
            return m_rcbReport.attributeValue("Раздел6");
        elif (partId == "7")
            return m_rcbReport.attributeValue("Раздел7");
        elif (partId == "8")
            return m_rcbReport.attributeValue("Раздел8");
        elif (partId == "9")
            return m_rcbReport.attributeValue("Раздел9");
        elif (partId == "10")
            return m_rcbReport.attributeValue("Раздел10");
        end;
    end;

    private macro getUserPartCompositeValue(partId : String)
        if (partId == "1User")
            return m_rcbReport.attributeValue("Раздел1_Ввод");
        elif (partId == "2User")
            return m_rcbReport.attributeValue("Раздел2_Ввод");
        elif (partId == "3User")
            return m_rcbReport.attributeValue("Раздел3_Ввод");
        elif (partId == "4User")
            return m_rcbReport.attributeValue("Раздел4_Ввод");
        elif (partId == "5User")
            return m_rcbReport.attributeValue("Раздел5_Ввод");
        elif (partId == "6User")
            return m_rcbReport.attributeValue("Раздел6_Ввод");
        elif (partId == "7User")
            return m_rcbReport.attributeValue("Раздел7_Ввод");
        elif (partId == "8User")
            return m_rcbReport.attributeValue("Раздел8_Ввод");
        elif (partId == "9User")
            return m_rcbReport.attributeValue("Раздел9_Ввод");
        elif (partId == "10User")
            return m_rcbReport.attributeValue("Раздел10_Ввод");
        end;
    end;

    macro getPart(partId : String) : RcbPartBase

        m_parts.moveFirst();
        while (m_parts.moveNext())
            if (m_parts.getCurrentItem().getId() == partId)
                return m_parts.getCurrentItem();
            end;
        end;

        if (partId == "1")
            return m_parts.push_back(objectFactoryInstance.createPart1(partId, this, getPartCompositeValue(partId)));
        elif (partId == "2")
            return m_parts.push_back(objectFactoryInstance.createPart2(partId, this, getPartCompositeValue(partId)));
        elif (partId == "3")
            return m_parts.push_back(objectFactoryInstance.createPart3(partId, this, getPartCompositeValue(partId)));
        elif (partId == "4")
            return m_parts.push_back(objectFactoryInstance.createPart4(partId, this, getPartCompositeValue(partId)));
        elif (partId == "5")
            return m_parts.push_back(objectFactoryInstance.createPart5(partId, this, getPartCompositeValue(partId)));
        elif (partId == "6")
            return m_parts.push_back(objectFactoryInstance.createPart6(partId, this, getPartCompositeValue(partId)));
        elif (partId == "7")
            return m_parts.push_back(objectFactoryInstance.createPart7(partId, this, getPartCompositeValue(partId)));
        elif (partId == "8")
            return m_parts.push_back(objectFactoryInstance.createPart8(partId, this, getPartCompositeValue(partId)));
        elif (partId == "9")
            return m_parts.push_back(objectFactoryInstance.createPart9(partId, this, getPartCompositeValue(partId)));
        elif (partId == "10")
            return m_parts.push_back(objectFactoryInstance.createPart10(partId, this, getPartCompositeValue(partId)));
        elif (partId == "1User")
            return m_parts.push_back(objectFactoryInstance.createUserPart1(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "2User")
            return m_parts.push_back(objectFactoryInstance.createUserPart2(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "3User")
            return m_parts.push_back(objectFactoryInstance.createUserPart3(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "4User")
            return m_parts.push_back(objectFactoryInstance.createUserPart4(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "5User")
            return m_parts.push_back(objectFactoryInstance.createUserPart5(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "6User")
            return m_parts.push_back(objectFactoryInstance.createUserPart6(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "7User")
            return m_parts.push_back(objectFactoryInstance.createUserPart7(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "8User")
            return m_parts.push_back(objectFactoryInstance.createUserPart8(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "9User")
            return m_parts.push_back(objectFactoryInstance.createUserPart9(partId, this, getUserPartCompositeValue(partId)));
        elif (partId == "10User")
            return m_parts.push_back(objectFactoryInstance.createUserPart10(partId, this, getUserPartCompositeValue(partId)));
        end;
    end;

    /**
     * Инициализация структуры отчета.
     */
    macro initialize()
        m_parts.push_back(objectFactoryInstance().createPart1("1", this, m_rcbReport.attributeValue("Раздел1")));
        m_parts.push_back(objectFactoryInstance().createPart2("2", this, m_rcbReport.attributeValue("Раздел2")));
        m_parts.push_back(objectFactoryInstance().createPart3("3", this, m_rcbReport.attributeValue("Раздел3")));
        m_parts.push_back(objectFactoryInstance().createPart4("4", this, m_rcbReport.attributeValue("Раздел4")));
        m_parts.push_back(objectFactoryInstance().createPart5("5", this, m_rcbReport.attributeValue("Раздел5")));
        m_parts.push_back(objectFactoryInstance().createPart6("6", this, m_rcbReport.attributeValue("Раздел6")));
        m_parts.push_back(objectFactoryInstance().createPart7("7", this, m_rcbReport.attributeValue("Раздел7")));
        m_parts.push_back(objectFactoryInstance().createPart8("8", this, m_rcbReport.attributeValue("Раздел8")));
        m_parts.push_back(objectFactoryInstance().createPart9("9", this, m_rcbReport.attributeValue("Раздел9")));
        m_parts.push_back(objectFactoryInstance().createPart10("10", this, m_rcbReport.attributeValue("Раздел10")));

        m_parts.push_back(objectFactoryInstance().createUserPart1("1User", this, m_rcbReport.attributeValue("Раздел1_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart2("2User", this, m_rcbReport.attributeValue("Раздел2_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart3("3User", this, m_rcbReport.attributeValue("Раздел3_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart4("4User", this, m_rcbReport.attributeValue("Раздел4_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart5("5User", this, m_rcbReport.attributeValue("Раздел5_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart6("6User", this, m_rcbReport.attributeValue("Раздел6_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart7("7User", this, m_rcbReport.attributeValue("Раздел7_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart9("9User", this, m_rcbReport.attributeValue("Раздел9_Ввод")));
        m_parts.push_back(objectFactoryInstance().createUserPart10("10User", this, m_rcbReport.attributeValue("Раздел10_Ввод")));
    end;

    /**
     * Отчет пуст.
     */
    macro isEmpty() : Bool
        m_parts.moveFirst();

        while (m_parts.moveNext())
            if (not m_parts.getCurrentItem().isEmpty())
                return false;
            end;
        end;

        return true;
    end;

    /**
     * Конструктор
     */
    private macro constructorF303Report(report, isLazy)
        initRcbReportBase(report, isLazy);
    end;

    constructorF303Report(report, isLazy);
end;
