/*
$Name:          f303PartCalculateController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 303. Контроллеры расчета разделов
*/

/**
 * Форма 303. Контроллеры расчета разделов.
 *
 * @since   10.08.2015
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbPartCalculateController) TF303BasePartCalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "0");

    private macro cacheData()
        var dataSource = m_dataSources.getDataSource("0");

        dataSource.cacheData();
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(cacheData());
    end;
end;

class (RcbPartCalculateController) TF303PartCalculateController(reportCalculateController : Object, partId : String)
    initRcbPartCalculateController(reportCalculateController, partId);

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource(getPartId());

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId);
            attribute.setValue(dataSet);
        end;

    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPartCalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part1CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "1");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("1");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.addLine);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart1CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getAddLine());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part2CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "2");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("2");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.dateEntry, dataSet.trancheNumber);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart2CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getDateEntry(), attributes.getCurrentItem().getTrancheNumber());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part3CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "3");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("3");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.account, dataSet.trancheNumber, dataSet.dateOrigContract, dataSet.dateChangesContract);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart3CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getAccount(),
                                                 attributes.getCurrentItem().getTrancheNumber(), attributes.getCurrentItem().getDateOrigContract(), attributes.getCurrentItem().getDateChangesContract());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part4CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "4");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("4");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.typeSecurity, dataSet.addLine);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart4CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getTypeSecurity(), attributes.getCurrentItem().getAddLine());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;


class (RcbPartCalculateController) TF303Part5CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "5");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("5");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.trancheNumber);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart5CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getTrancheNumber());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part6CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "6");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("6");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.loansTermAccount, dataSet.loansArrearsAccount, dataSet.trancheNumber, dataSet.addLine);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart6CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getLoansTermAccount(), attributes.getCurrentItem().getLoansArrearsAccount(),
                                                 attributes.getCurrentItem().getTrancheNumber(), attributes.getCurrentItem().getAddLine());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part7CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "7");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("7");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.trancheNumber);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart7CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getTrancheNumber());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part9CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "9");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("9");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.trancheNumber, dataSet.dateRemovalDebt, dataSet.maturityDateDebt, dataSet.addLine);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part9CalculateController_4637(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "9");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("9");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId, dataSet.trancheNumber, dataSet.dateRemovalDebt, dataSet.maturityDateDebt, dataSet.sourceRepayment, dataSet.codeNewCredit, dataSet.addLine);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart9CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getTrancheNumber(),
                                                 attributes.getCurrentItem().getDateRemovalDebt(), attributes.getCurrentItem().getMaturityDateDebt(), attributes.getCurrentItem().getAddLine());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart9CalculateController_4637(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId(), attributes.getCurrentItem().getTrancheNumber(),
                                                 attributes.getCurrentItem().getDateRemovalDebt(), attributes.getCurrentItem().getMaturityDateDebt(),
                                                 attributes.getCurrentItem().getSourceRepayment(), attributes.getCurrentItem().getCodeNewCredit(),
                                                 attributes.getCurrentItem().getAddLine());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303Part10CalculateController(reportCalculateController : Object)
    initRcbPartCalculateController(reportCalculateController, "10");

    private macro getCalculatePart()
        var dataSource = m_dataSources.getDataSource("10");

        dataSource.cacheData();

        var dataSet = dataSource.getData();

        while(dataSet.moveNext)
            var attribute  = m_part.getAttribute(dataSet.creditId);
            attribute.setValue(dataSet);
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;

class (RcbPartCalculateController) TF303UserPart10CalculateController(reportCalculateController : Object, userPartId : String, partId : String)
    initRcbPartCalculateController(reportCalculateController, userPartId);
    private var m_notUserPartId = partId;

    private macro getCalculatePart()
        var part = m_report.getPart(m_notUserPartId);
        var attributes = part.getAttributes();

        attributes.moveFirst();
        while(attributes.moveNext)
            var attribute  = m_part.getAttribute(attributes.getCurrentItem().getCreditId());

            attribute.setValue(attributes.getCurrentItem());
        end;
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculatePart());
    end;
end;