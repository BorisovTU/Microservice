/*
$Name:          f303PtkPsdExportController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 303. Контроллер экспорта в АС ПСД
*/

/**
 * Форма 303. Контроллер экспорта АС ПСД.
 *
 * @since   10.08.2015
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (TPtkPsdView) TF303PtkPsdView(fileExtension : String, reportDate : Date, encoding : String)
    initTPtkPsdView(fileExtension, reportDate, encoding);

    EOL = "";

    private var m_numberPart = 0;

    m_numberPart = MkStr("0", 3 - strlen(String(m_numberPart))) + String(m_numberPart);
    m_name = strSubSt(m_name, "PtkPsd", "PtkPsd" + m_numberPart);

    macro setNewOutputFile()
        var newNumberPart = Int(m_numberPart) + 1;
        newNumberPart = MkStr("0", 3 - strlen(String(newNumberPart))) + String(newNumberPart);

        m_name = strSubSt(m_name, "PtkPsd" + m_numberPart, "PtkPsd" + newNumberPart);
        m_numberPart = newNumberPart;

        setOutputFile()
    end;

    macro getFileSize()
        Close (m_outFile);

        var size = 0;
        getFileInfo(m_name, null, null, @size, null);

        Open(m_outFile, m_name, m_encoding);
        return size;
    end;

    macro setZeroRowsCount()
        m_rowsCount = 0;
    end;

    macro clone()
        var view = genObject(genClassName(this));
        var i = 0;

        while (true)
            view[i] = this[i];
            i = i + 1;
        end;

        OnError(er);
            return view;
    end;

    macro setEOL(endOfFile)
        EOL = endOfFile;
    end;

    macro getNumberPart()
        return m_numberPart;
    end;
end;

class (TF303PtkPsdView) TF303PtkPsdView_4637(fileExtension : String, reportDate : Date, encoding : String)
    initTF303PtkPsdView(fileExtension, reportDate, encoding);
    m_name = получитьКаталогЭкспорта() + "\\" + strSubst(m_stringReportDate, ".", "")
                                            + "AsPsd"
                                            + String(m_numberPart)
                                            + "." + m_fileExtension;

    macro setNewOutputFile()
        var newNumberPart = Int(m_numberPart) + 1;
        newNumberPart = MkStr("0", 3 - strlen(String(newNumberPart))) + String(newNumberPart);

        m_name = получитьКаталогЭкспорта() + "\\" + strSubst(m_stringReportDate, ".", "")
                                                + "AsPsd"
                                                + newNumberPart
                                                + "." + m_fileExtension;

        m_numberPart = newNumberPart;

        setOutputFile()
    end;
end;

class (RcbPtkPsdExportController) TF303PtkPsdExportController()
    initRcbPtkPsdExportController("303", objectFactoryInstance.createReport(RcbApplication.currentReport), "Форма 303");
    m_view = TF303PtkPsdView("303", m_report.getPeriod().endDate + 1, "rsansi");
    CONST MAX_FILE_SIZE = 40 * 1024 * 1024;

    private var m_viewArr = TArray(true);
    private var m_totalRowsCount = 0;

    /**
    * Сортировщик для итераторов
    */
    private class TSyncSorter()
        macro isLess(lhs : Object, rhs : Object)
            return lhs.fieldValue("creditId").current < rhs.fieldValue("creditId").current;
        end;
    end;

    private class TIteratorTypeLineFilter(isAddLine)
        private var m_isAddLine = isAddLine;

        macro isSuitable(v)
            return (v.fieldValue("addLine").current == m_isAddLine);
        end;
    end;

    /**
    * Сортировщик для итераторов дополнительных строк
    */
    private class TSyncSorterAddLines()
        macro isLess(lhs : Object, rhs : Object)
            return (lhs.fieldValue("trancheNumber").current < rhs.fieldValue("trancheNumber").current);
        end;
    end;

    private class TSyncSorterByAddLines()
        macro isLess(lhs : Object, rhs : Object)
            return (lhs.fieldValue("addLine").current < rhs.fieldValue("addLine").current);
        end;
    end;

    private class TIteratorAnyAddLineFilter(creditId)
        private var m_creditId = creditId;

        macro isSuitable(v)
            return ((v.fieldValue("creditId").current == m_creditId) and (v.fieldValue("addLine").current > 0));
        end;
    end;

    private class TIteratorAddCreditLineFilter(creditId, isAddLine)
        private var m_isAddLine = isAddLine;
        private var m_creditId = creditId;

        macro isSuitable(v)
            return ((v.fieldValue("creditId").current == m_creditId) and (v.fieldValue("addLine").current == m_isAddLine));
        end;
    end;

    private class TIteratorCreditLineFilter(creditId)
        private var m_creditId = creditId;

        macro isSuitable(v)
            return (v.fieldValue("creditId").current == m_creditId);
        end;
    end;

    private macro getDescriptorInfo()
        return "fr2_2_303.zip от 26.02.2016";
    end;

    private macro beginNewPart()
        m_viewArr[m_viewArr.size] = m_view.clone();
        m_view.resetOutputFile();
        m_view.setNewOutputFile();
    end;

    macro getPrintValue(iterator :  RcbValueIterator, userIterator :  RcbValueIterator, fieldValue : String)
        if (not iterator.currentItem.fieldValue(fieldValue).isDefined() or (iterator.currentItem.fieldValue(fieldValue).exact == strFor(1)) or (iterator.currentItem.fieldValue(fieldValue).exact == ""))
            if (userIterator.currentItem != null)
                if (userIterator.currentItem.fieldValue(fieldValue).isDefined())
                    return userIterator.currentItem.fieldValue(fieldValue).exact;
                end;
            end;
        end;

        return iterator.currentItem.fieldValue(fieldValue).exact;
    end;

    private macro printString(appCode, rowCode, columnCode, value)
        if ((value != "") and (valType(value) != V_UNDEF) and (rowCode != "") and (valType(rowCode) != V_UNDEF))
            m_view.printRow(appCode, rowCode, columnCode, value)
        end;
    end;

    private macro printPart_URL_2(part1Arr, part2Arr, part8Arr)
        printString("URL_2", part2Arr.getCurrentItem()(0), "uid", part2Arr.getCurrentItem()(0));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ndog", part2Arr.getCurrentItem()(1));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ddog", part2Arr.getCurrentItem()(2));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ndogp", part2Arr.getCurrentItem()(3));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ddop", part2Arr.getCurrentItem()(4));
        printString("URL_2", part2Arr.getCurrentItem()(0), "norg", part2Arr.getCurrentItem()(5));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ogrn", part2Arr.getCurrentItem()(6));
        printString("URL_2", part2Arr.getCurrentItem()(0), "regnom", part2Arr.getCurrentItem()(7));
        printString("URL_2", part2Arr.getCurrentItem()(0), "oksm", part2Arr.getCurrentItem()(8));
        printString("URL_2", part2Arr.getCurrentItem()(0), "kolr", part2Arr.getCurrentItem()(9));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ipb", part2Arr.getCurrentItem()(10));

        printString("URL_2", part2Arr.getCurrentItem()(0), "namez", part1Arr.getCurrentItem()(0));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ogrnz", part1Arr.getCurrentItem()(1));
        printString("URL_2", part2Arr.getCurrentItem()(0), "ogrnipz", part1Arr.getCurrentItem()(2));
        printString("URL_2", part2Arr.getCurrentItem()(0), "dgosz", part1Arr.getCurrentItem()(3));
        printString("URL_2", part2Arr.getCurrentItem()(0), "innz", part1Arr.getCurrentItem()(4));
        printString("URL_2", part2Arr.getCurrentItem()(0), "okpoz", part1Arr.getCurrentItem()(5));
        printString("URL_2", part2Arr.getCurrentItem()(0), "oksmz", part1Arr.getCurrentItem()(6));
        printString("URL_2", part2Arr.getCurrentItem()(0), "smspz", part1Arr.getCurrentItem()(7));
        printString("URL_2", part2Arr.getCurrentItem()(0), "hoz", part1Arr.getCurrentItem()(8));

        printString("URL_2", part2Arr.getCurrentItem()(0), "snl", part8Arr.getCurrentItem()(0));
        printString("URL_2", part2Arr.getCurrentItem()(0), "rvp", part8Arr.getCurrentItem()(1));
        printString("URL_2", part2Arr.getCurrentItem()(0), "rvfs", part8Arr.getCurrentItem()(2));
    end;

    private macro printPart_URL_2S(creditId)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + "_" + _npp;

        iteratorAddLinesPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart2.setSortOrder(TSyncSorter());
        iteratorAddLinesPart2.moveFirst();

        while (not iteratorAddLinesPart2.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + "_" + _npp;

            printString("URL_2S", rowCode, "uid", creditId);
            printString("URL_2S", rowCode, "npp", npp);
            printString("URL_2S", rowCode, "dopiz", iteratorAddLinesPart2.currentItem.fieldValue("dateClaim").exact);
            printString("URL_2S", rowCode, "dvs",   iteratorAddLinesPart2.currentItem.fieldValue("dateEntry").exact);
            printString("URL_2S", rowCode, "siko",  iteratorAddLinesPart2.currentItem.fieldValue("sumClaim").exact);
            printString("URL_2S", rowCode, "svrs",  iteratorAddLinesPart2.currentItem.fieldValue("sumCollection").exact);
            printString("URL_2S", rowCode, "kvi",   iteratorAddLinesPart2.currentItem.fieldValue("fiCode").exact);

            iteratorAddLinesPart2.moveNext();
        end;
    end;

    private macro printPart_URL_39(creditId, part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr)
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + String(creditId) + MkStr("_", 100 - strlen(String(part5Arr.getCurrentItem()(1)))) + String(part5Arr.getCurrentItem()(1));

        printString("URL_39", rowCode, "uid", creditId);
        printString("URL_39", rowCode, "ntr", part5Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "vs", part3Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "ck", part3Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sd", part3Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "sdi", part3Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kvd", part3Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "kvdi", part3Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "dd", part3Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "ddi", part3Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "prv", part3Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "pr", part3Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "pri", part3Arr.getCurrentItem()(10));
        printString("URL_39", rowCode, "prpr", part3Arr.getCurrentItem()(11));
        printString("URL_39", rowCode, "prpp", part3Arr.getCurrentItem()(12));
        printString("URL_39", rowCode, "prvk", part3Arr.getCurrentItem()(13));
        printString("URL_39", rowCode, "usd", part3Arr.getCurrentItem()(14));
        printString("URL_39", rowCode, "uidk", part3Arr.getCurrentItem()(15));

        printString("URL_39", rowCode, "ov", part4Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "os1", part4Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "os2", part4Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "osr", part4Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "vstr", part4Arr.getCurrentItem()(4));

        printString("URL_39", rowCode, "dps", part5Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sps", part5Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "vps", part5Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "ktps", part5Arr.getCurrentItem()(4));

        printString("URL_39", rowCode, "lszs", part6Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "lszp", part6Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "szs", part6Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "szp", part6Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kks", part6Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "ocs", part6Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "rzrp", part6Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "rzo", part6Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "rzf", part6Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "dops", part6Arr.getCurrentItem()(9));

        printString("URL_39", rowCode, "spdbn", part7Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "spdbp", part7Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "spdvn", part7Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "spdvp", part7Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "spdr", part7Arr.getCurrentItem()(4));

        printString("URL_39", rowCode, "ppod", part9Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sodp", part9Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sodf", part9Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "pupr", part9Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "sprp", part9Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "sprf", part9Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "skk", part9Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "daz", part9Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "dzap", part9Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "ist", part9Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "idnd", part9Arr.getCurrentItem()(10));
        printString("URL_39", rowCode, "rko", part9Arr.getCurrentItem()(11));
    end;

    private macro printPart_URL_9F(creditId, userTrancheNumber)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;
        var prevTrancheId = null;
        var currentTrancheId = null;

        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 2));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 2));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;

            printString("URL_9F", rowCode, "uid", creditId);
            printString("URL_9F", rowCode, "ntr", userTrancheNumber);
            printString("URL_9F", rowCode, "npp", npp);
            printString("URL_9F", rowCode, "daz", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "dateRemovalDebt"));
            printString("URL_9F", rowCode, "dzap", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "maturityDateDebt"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_9R(creditId, userTrancheNumber)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var npp = 0;
        var _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;
        var prevTrancheId = null;
        var currentTrancheId = null;

        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;

            printString("URL_9R", rowCode, "uid", creditId);
            printString("URL_9R", rowCode, "ntr", userTrancheNumber);
            printString("URL_9R", rowCode, "npp", npp);
            printString("URL_9R", rowCode, "sodf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
            printString("URL_9R", rowCode, "sprf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
            printString("URL_9R", rowCode, "skk", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
            printString("URL_9R", rowCode, "ist", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
            printString("URL_9R", rowCode, "idnd", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
            printString("URL_9R", rowCode, "rko", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_10()
        /* пока не реализовано*/
    end;

    private macro printData()
        var i = 0;
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part6Arr = RcbArray();
        var part7Arr = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "isMSP"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(Int(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId")));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "date"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4)or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumFirstQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecondQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        m_view.setOutputFile();

        m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

        var currentCreditId = null;
        var prevCreditId = null;

        while (part1Arr.moveNext() and part2Arr.moveNext()  and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext()  and part10Arr.moveNext())

            currentCreditId = part2Arr.getCurrentItem()(0);

            if ((m_view.getFileSize() > MAX_FILE_SIZE) and (currentCreditId != prevCreditId))
                beginNewPart();
                m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
                m_view.setZeroRowsCount();
                m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

                part1Arr.movePrev();
                part2Arr.movePrev();
                part3Arr.movePrev();
                part4Arr.movePrev();
                part5Arr.movePrev();
                part6Arr.movePrev();
                part7Arr.movePrev();
                part8Arr.movePrev();
                part9Arr.movePrev();
                part10Arr.movePrev();

                continue;
            end;

            printPart_URL_2(part1Arr, part2Arr, part8Arr);
            printPart_URL_2S(part2Arr.getCurrentItem()(0));
            printPart_URL_39(part2Arr.getCurrentItem()(0), part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr);
            printPart_URL_9F(part2Arr.getCurrentItem()(0), part5Arr.getCurrentItem()(1));
            printPart_URL_9R(part2Arr.getCurrentItem()(0), part5Arr.getCurrentItem()(1));
            printPart_URL_10(/* */);

            prevCreditId = currentCreditId;
        end;


        m_view.resetOutputFile();
        m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
        m_viewArr[m_viewArr.size] = m_view.clone();
    end;

    private macro printDataZone()
        printData();
    end;

    macro execute()

        printDataZone();

        var protocolView = TProtocolView("ПРОТОКОЛ ЭКСПОРТА В АС ПСД", m_reportName);

        protocolView.setProtocolOutput();
        protocolView.printHead();

        var i = 0;
        while (i < m_viewArr.size)
            protocolView.printLine("Альбом форм АС ПСД: " + getDescriptorInfo());
            protocolView.printLine("Файл экспорта: " + m_viewArr[i].getFileName());
            protocolView.printLine(" ");

            protocolView.printLine("Выгружено строк: " + String(m_viewArr[i].getRowsCount()) + ".");

            i = i + 1;
        end;

        protocolView.printLine("Выгружено всего строк: " + String(m_totalRowsCount) + ".");

        protocolView.resetProtocolOutput();

        protocolView.show();
    end;
end;

class (TF303PtkPsdExportController) TF303PtkPsdExportController_4212()
    initTF303PtkPsdExportController();
    private var getKio : TF303KlikoExportController_4212;

    macro getCreditIdPrintValue(iterator :  RcbValueIterator)
        var contractId : String;

        if (iterator.currentItem == null)
            return "";
        end;

        if (TF303Parameters().getIsIdContract() == true)
            contractId = string(int(iterator.currentItem.fieldValue("creditId").exact));
        else
            contractId = iterator.currentItem.fieldValue("creditNumber").exact;
            if (contractId == "бн")
                contractId = string(int(iterator.currentItem.fieldValue("creditId").exact));
            end;
        end;

        return contractId;
    end;

    private macro printPart_URL_2(creditIdForReport, part1Arr, part2Arr, part8Arr)
        printString("URL_2", creditIdForReport, "uid", creditIdForReport);
        printString("URL_2", creditIdForReport, "ndog", part2Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "ddog", part2Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "ndogp", part2Arr.getCurrentItem()(3));
        printString("URL_2", creditIdForReport, "ddop", part2Arr.getCurrentItem()(4));
        printString("URL_2", creditIdForReport, "norg", part2Arr.getCurrentItem()(5));
        printString("URL_2", creditIdForReport, "ogrn", part2Arr.getCurrentItem()(6));
        printString("URL_2", creditIdForReport, "regnom", part2Arr.getCurrentItem()(7));
        printString("URL_2", creditIdForReport, "oksm", part2Arr.getCurrentItem()(8));
        printString("URL_2", creditIdForReport, "kolr", part2Arr.getCurrentItem()(9));
        printString("URL_2", creditIdForReport, "ipb", part2Arr.getCurrentItem()(10));
        printString("URL_2", creditIdForReport, "dpzpbd", part2Arr.getCurrentItem()(11));
        printString("URL_2", creditIdForReport, "namez", part1Arr.getCurrentItem()(0));
        printString("URL_2", creditIdForReport, "ogrnz", part1Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "ogrnipz", part1Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "dgosz", part1Arr.getCurrentItem()(3));
        printString("URL_2", creditIdForReport, "innz", part1Arr.getCurrentItem()(4));
        printString("URL_2", creditIdForReport, "kio", getKio.getCodeKliko(part1Arr.getCurrentItem()(4)));
        printString("URL_2", creditIdForReport, "okpoz", part1Arr.getCurrentItem()(5));
        printString("URL_2", creditIdForReport, "oksmz", part1Arr.getCurrentItem()(6));
        printString("URL_2", creditIdForReport, "hoz", part1Arr.getCurrentItem()(7));
        printString("URL_2", creditIdForReport, "snl", part8Arr.getCurrentItem()(0));
        printString("URL_2", creditIdForReport, "rvp", part8Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "rvfs", part8Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "rvrp", part8Arr.getCurrentItem()(3));
    end;

    private macro printPart_URL_2S(creditId, creditIdForReport)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

        iteratorAddLinesPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart2.setSortOrder(TSyncSorter());
        iteratorAddLinesPart2.moveFirst();

        iteratorAddLinesUserPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart2.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

            printString("URL_2S", rowCode, "uid", creditIdForReport);
            printString("URL_2S", rowCode, "npp", npp);
            printString("URL_2S", rowCode, "dpikos", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateFilingSuit"));
            printString("URL_2S", rowCode, "psud",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "lawCourt"));
            printString("URL_2S", rowCode, "dopiz",  getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateClaim"));
            printString("URL_2S", rowCode, "dvs",    getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateEntry"));
            printString("URL_2S", rowCode, "siko",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumClaim"));
            printString("URL_2S", rowCode, "svrs",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumCollection"));
            printString("URL_2S", rowCode, "kvi",    getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "fiCode"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_39(creditId, part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr)
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + String(creditId) + MkStr("_", 100 - strlen(String(part5Arr.getCurrentItem()(1)))) + String(part5Arr.getCurrentItem()(1));

        printString("URL_39", rowCode, "uid", creditId);
        printString("URL_39", rowCode, "ntr", part5Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "vs", part3Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "ck", part3Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sd", part3Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "sdi", part3Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kvd", part3Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "kvdi", part3Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "dd", part3Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "ddi", part3Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "prv", part3Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "pr", part3Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "pri", part3Arr.getCurrentItem()(10));
        printString("URL_39", rowCode, "prpr", part3Arr.getCurrentItem()(11));
        printString("URL_39", rowCode, "prpp", part3Arr.getCurrentItem()(12));
        printString("URL_39", rowCode, "prvk", part3Arr.getCurrentItem()(13));
        printString("URL_39", rowCode, "usd", part3Arr.getCurrentItem()(14));
        printString("URL_39", rowCode, "uidk", part3Arr.getCurrentItem()(15));
        printString("URL_39", rowCode, "ov", part4Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "os1", part4Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "os2", part4Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "osr", part4Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "vstr", part4Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "dps", part5Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sps", part5Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "vps", part5Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "ktps", part5Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "lszs", part6Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "lszp", part6Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "szs", part6Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "szp", part6Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kks", part6Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "ocs", part6Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "rzrp", part6Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "rzo", part6Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "rzf", part6Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "dops", part6Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "spdbn", part7Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "spdbp", part7Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "spdvn", part7Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "spdvp", part7Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "spdr", part7Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "ppod", part9Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sodp", part9Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sodf", part9Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "pupr", part9Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "sprp", part9Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "sprf", part9Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "skk", part9Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "daz", part9Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "dzap", part9Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "ist", part9Arr.getCurrentItem()(9));
    end;

    private macro printPart_URL_9R(creditId, creditIdForReport)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = "";
        var prevTrancheId = null;
        var currentTrancheId = null;
        var userTrancheNumber = null;

        iteratorAddLinesPart9.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        iteratorAddLinesPart5.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart5.moveFirst();


        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesPart5);
        synchronizerAddLines.moveFirst();



        while (not synchronizerAddLines.isDone())
            var addLine = iteratorAddLinesPart9.currentItem.fieldValue("addLine").exact;

            if (addLine != 2)
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

                if (not iteratorAddLinesPart5.isDone())
                    userTrancheNumber = NVL(iteratorAddLinesPart5.currentItem.fieldValue("userTrancheNumber").currentAsString, "");
                else
                    userTrancheNumber = "";
                end;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;

            printString("URL_9R", rowCode, "uid", creditIdForReport);
            printString("URL_9R", rowCode, "ntr", userTrancheNumber);
            printString("URL_9R", rowCode, "npp", npp);
            printString("URL_9R", rowCode, "sodf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
            printString("URL_9R", rowCode, "sprf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
            printString("URL_9R", rowCode, "skk", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
            printString("URL_9R", rowCode, "ist", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
            end;

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_10(creditId, part10Arr)
        var rowCode;
        var npp = 1;

        var _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
        rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + "_" + _npp;

        printString("URL_10", rowCode, "uid",     creditId);
        printString("URL_10", rowCode, "npp",     _npp);
        printString("URL_10", rowCode, "vidp",    part10Arr.getCurrentItem()(0));
        printString("URL_10", rowCode, "ouds",    part10Arr.getCurrentItem()(1));
        printString("URL_10", rowCode, "opds",    part10Arr.getCurrentItem()(2));
        printString("URL_10", rowCode, "namep",   part10Arr.getCurrentItem()(3));
        printString("URL_10", rowCode, "ogrnp",   part10Arr.getCurrentItem()(4));
        printString("URL_10", rowCode, "regnomp", part10Arr.getCurrentItem()(5));
        printString("URL_10", rowCode, "oksmp",   part10Arr.getCurrentItem()(6));
        printString("URL_10", rowCode, "uss",     part10Arr.getCurrentItem()(7));
        printString("URL_10", rowCode, "uskv",    part10Arr.getCurrentItem()(8));

    end;

    private macro printPart_URL_6(creditId, creditIdForReport, part3Arr)
        var iteratorAddLinesPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorAddLinesUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var _ntr = "";
        var rowCode = "";
        var _trn = "";

        iteratorAddLinesPart6.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart6.setSortOrder(TSyncSorter());
        iteratorAddLinesPart6.moveFirst();

        iteratorAddLinesUserPart6.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart6.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart6.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart6);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart6);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp  = npp + 1;
            _trn = Int(iteratorAddLinesPart6.currentItem.fieldValue("trancheNumber").exact);
            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(_trn))) + String(_trn);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_6", rowCode, "uid",    creditIdForReport);
            printString("URL_6", rowCode, "ntr",    iteratorAddLinesPart6.currentItem.fieldValue("trancheNumber").exact);
            printString("URL_6", rowCode, "npp",    npp);
            printString("URL_6", rowCode, "usd",    part3Arr.getCurrentItem()(14));
            printString("URL_6", rowCode, "lszs",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "termDebtAccount"));
            printString("URL_6", rowCode, "lszp",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "arrearsAccount"));
            printString("URL_6", rowCode, "szs",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumTermDebt"));
            printString("URL_6", rowCode, "szp",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumOverDebt"));
            printString("URL_6", rowCode, "kks",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "loanQuality"));
            printString("URL_6", rowCode, "ocs",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "evaluation"));
            printString("URL_6", rowCode, "rzrp",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "calcReserve"));
            printString("URL_6", rowCode, "rzo",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumCalcReserveSecurity"));
            printString("URL_6", rowCode, "rzf",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumFormedReserve"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_11(creditId, userTrancheNumber, creditIdForReport)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var npp     = 0;
        var _npp    = "";
        var rowCode = "";
        var _ntr    = "";
        var prevTrancheId    = null;
        var currentTrancheId = null;

        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;
            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(Int(userTrancheNumber)))) + String(Int(userTrancheNumber));
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_11", rowCode, "uid",   creditIdForReport);
            printString("URL_11", rowCode, "ntr",   userTrancheNumber);
            printString("URL_11", rowCode, "npp",   npp);
            printString("URL_11", rowCode, "ist",   getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
            printString("URL_11", rowCode, "idnd",  getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
            printString("URL_11", rowCode, "rko",   getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_16(creditId, creditIdForReport)
        var iteratorAddLinesPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorAddLinesUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var npp     = 0;
        var _npp    = "";
        var rowCode = "";
        var _ntr    = "";
        var prevTrancheId    = null;
        var currentTrancheId = null;
        var userTrancheNumber = null;

        iteratorAddLinesPart3.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart3.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart3.moveFirst();

        iteratorAddLinesUserPart3.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart3.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart3.moveFirst();

        iteratorAddLinesPart5.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart5.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesPart5);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

            if (not iteratorAddLinesPart5.isDone())
                userTrancheNumber = NVL(iteratorAddLinesPart5.currentItem.fieldValue("userTrancheNumber").currentAsString, "");
            else
                userTrancheNumber = "";
            end;

            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(Int(userTrancheNumber)))) + String(Int(userTrancheNumber));
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_16", rowCode, "uid",  creditIdForReport);
            printString("URL_16", rowCode, "ntr",  userTrancheNumber);
            printString("URL_16", rowCode, "npp",  npp);
            printString("URL_16", rowCode, "usd",  getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "conditionCode"));
            printString("URL_16", rowCode, "uidk", getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditIdCode"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart3) and (iteratorAddLinesPart3.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart3.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printData()
        var i = 0;
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part6Arr = RcbArray();
        var part7Arr = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(Int(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId")));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "date"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateBankruptcy"));
                value.push_back(getCreditIdPrintValue(iteratorPart2));  // id отчета для печати
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4)or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumFirstQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecondQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "rvpPercent"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumDeal"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "fiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        m_view.setOutputFile();

        m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

        var currentCreditId = null;
        var prevCreditId = null;
        var creditIdForReport = null;

        while (part1Arr.moveNext() and part2Arr.moveNext()  and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext()  and part10Arr.moveNext())

            currentCreditId = part2Arr.getCurrentItem()(0);
            creditIdForReport = part2Arr.getCurrentItem()(12);

            if ((m_view.getFileSize() > MAX_FILE_SIZE) and (currentCreditId != prevCreditId))
                beginNewPart();
                m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
                m_view.setZeroRowsCount();
                m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

                part1Arr.movePrev();
                part2Arr.movePrev();
                part3Arr.movePrev();
                part4Arr.movePrev();
                part5Arr.movePrev();
                part6Arr.movePrev();
                part7Arr.movePrev();
                part8Arr.movePrev();
                part9Arr.movePrev();
                part10Arr.movePrev();

                continue;
            end;

            printPart_URL_2(creditIdForReport, part1Arr, part2Arr, part8Arr);
            printPart_URL_2S(currentCreditId, creditIdForReport);
            printPart_URL_39(creditIdForReport, part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr);
            printPart_URL_9F(currentCreditId, part5Arr.getCurrentItem()(1), creditIdForReport);
            printPart_URL_9R(currentCreditId, creditIdForReport);
            printPart_URL_10(creditIdForReport, part10Arr);
            printPart_URL_6(currentCreditId, creditIdForReport, part3Arr);
            printPart_URL_11(currentCreditId, part5Arr.getCurrentItem()(1), creditIdForReport);
            printPart_URL_16(currentCreditId, creditIdForReport);

            prevCreditId = currentCreditId;
        end;


        m_view.resetOutputFile();
        m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
        m_viewArr[m_viewArr.size] = m_view.clone();
    end;

     private macro getDescriptorInfo()
        return "ОСБР_0409303.doc от 09.02.2017";
    end;

    macro execute()

        printDataZone();

        var protocolView = TProtocolView("ПРОТОКОЛ ЭКСПОРТА В АС ПСД", m_reportName);

        protocolView.setProtocolOutput();
        protocolView.printHead();

        var i = 0;
        while (i < m_viewArr.size)
            protocolView.printLine("Альбом форм АС ПСД: " + getDescriptorInfo());
            protocolView.printLine("Файл экспорта: " + m_viewArr[i].getFileName());
            protocolView.printLine(" ");
            protocolView.printLine("Выгружено строк: " + String(m_viewArr[i].getRowsCount()) + ".");
            i = i + 1;
        end;

        protocolView.printLine("Выгружено всего строк: " + String(m_totalRowsCount) + ".");
        protocolView.resetProtocolOutput();
        protocolView.show();
    end;

end;

class (TF303PtkPsdExportController_4212) TF303PtkPsdExportController_4637()
    initTF303PtkPsdExportController_4212();
    m_view = TF303PtkPsdView_4637("303", m_report.getPeriod().endDate + 1, "rsansi");

    private macro printPart_URL_2(creditIdForReport, part1Arr, part2Arr, part8Arr, part4Arr)
        printString("URL_2", creditIdForReport, "uid", creditIdForReport);
        printString("URL_2", creditIdForReport, "ndog", part2Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "ddog", part2Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "ndogp", part2Arr.getCurrentItem()(3));
        printString("URL_2", creditIdForReport, "ddop", part2Arr.getCurrentItem()(4));
        printString("URL_2", creditIdForReport, "norg", part2Arr.getCurrentItem()(5));
        printString("URL_2", creditIdForReport, "ogrn", part2Arr.getCurrentItem()(6));
        printString("URL_2", creditIdForReport, "regnom", part2Arr.getCurrentItem()(7));
        printString("URL_2", creditIdForReport, "oksm", part2Arr.getCurrentItem()(8));
        printString("URL_2", creditIdForReport, "ipb", part2Arr.getCurrentItem()(10));
        printString("URL_2", creditIdForReport, "dpzpbd", part2Arr.getCurrentItem()(11));
        printString("URL_2", creditIdForReport, "dpr", part2Arr.getCurrentItem()(13));
        printString("URL_2", creditIdForReport, "namez", part1Arr.getCurrentItem()(0));
        printString("URL_2", creditIdForReport, "ogrnz", part1Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "ogrnipz", part1Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "dgosz", part1Arr.getCurrentItem()(3));
        printString("URL_2", creditIdForReport, "innz", getKio.getCodeInn(part1Arr.getCurrentItem()(4)));
        printString("URL_2", creditIdForReport, "kio", getKio.getCodeKliko(part1Arr.getCurrentItem()(4)));
        printString("URL_2", creditIdForReport, "okpoz", part1Arr.getCurrentItem()(5));
        printString("URL_2", creditIdForReport, "oksmz", part1Arr.getCurrentItem()(6));
        printString("URL_2", creditIdForReport, "hoz", part1Arr.getCurrentItem()(7));
        printString("URL_2", creditIdForReport, "kved", part1Arr.getCurrentItem()(8));
        printString("URL_2", creditIdForReport, "vstr", part4Arr.getCurrentItem()(4));
        printString("URL_2", creditIdForReport, "snl", part8Arr.getCurrentItem()(0));
        printString("URL_2", creditIdForReport, "rvp", part8Arr.getCurrentItem()(1));
        printString("URL_2", creditIdForReport, "rvfs", part8Arr.getCurrentItem()(2));
        printString("URL_2", creditIdForReport, "rvrp", part8Arr.getCurrentItem()(3));
    end;

    private macro printPart_URL_2_11(creditId, creditIdForReport)
        var iteratorAddLinesPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorAddLinesUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

        iteratorAddLinesPart1.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart1.setSortOrder(TSyncSorterByAddLines());
        iteratorAddLinesPart1.moveFirst();

        iteratorAddLinesUserPart1.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart1.setSortOrder(TSyncSorterByAddLines());
        iteratorAddLinesUserPart1.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterByAddLines(), iteratorAddLinesPart1);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart1);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

            printString("URL_2_11", rowCode, "uid",    creditIdForReport);
            printString("URL_2_11", rowCode, "npp",    npp);
            printString("URL_2_11", rowCode, "ngr",    getPrintValue(iteratorAddLinesPart1, iteratorAddLinesUserPart1, "borrowersGroupNumber"));
            printString("URL_2_11", rowCode, "namegr", getPrintValue(iteratorAddLinesPart1, iteratorAddLinesUserPart1, "borrowersGroupName"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_2_12(creditId, creditIdForReport)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

        iteratorAddLinesPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart2.setSortOrder(TSyncSorter());
        iteratorAddLinesPart2.moveFirst();

        iteratorAddLinesUserPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart2.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

            printString("URL_2_12", rowCode, "uid",  creditIdForReport);
            printString("URL_2_12", rowCode, "npp",  npp);
            printString("URL_2_12", rowCode, "name", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryName"));
            printString("URL_2_12", rowCode, "ogrn", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryOgrn"));
            printString("URL_2_12", rowCode, "regn", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryRegNumber"));
            printString("URL_2_12", rowCode, "kods", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "beneficiaryOksm"));
            printString("URL_2_12", rowCode, "vid",  getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "obligationKind"));
            printString("URL_2_12", rowCode, "sum",  getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "obligationSum"));
            printString("URL_2_12", rowCode, "srok", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "maturityObligation"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_2S(creditId, creditIdForReport)
        var iteratorAddLinesPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorAddLinesUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

        iteratorAddLinesPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart2.setSortOrder(TSyncSorter());
        iteratorAddLinesPart2.moveFirst();

        iteratorAddLinesUserPart2.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart2.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart2.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart2);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart2);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + "_" + _npp;

            printString("URL_2S", rowCode, "uid", creditIdForReport);
            printString("URL_2S", rowCode, "npp", npp);
            printString("URL_2S", rowCode, "dpikos", getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateFilingSuit"));
            printString("URL_2S", rowCode, "psud",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "lawCourt"));
            printString("URL_2S", rowCode, "dopiz",  getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateClaim"));
            printString("URL_2S", rowCode, "dvs",    getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "dateEntry"));
            printString("URL_2S", rowCode, "siko",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumClaim"));
            printString("URL_2S", rowCode, "svrs",   getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "sumCollection"));
            printString("URL_2S", rowCode, "kvi",    getPrintValue(iteratorAddLinesPart2, iteratorAddLinesUserPart2, "fiCode"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_39(creditId, part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr, part2Arr)
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + String(creditId) + MkStr("_", 100 - strlen(String(part5Arr.getCurrentItem()(1)))) + String(part5Arr.getCurrentItem()(1));

        printString("URL_39", rowCode, "uid", creditId);
        printString("URL_39", rowCode, "ntr", part5Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "kolr", part2Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "vs", part3Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "ck", part3Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sd", part3Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "sdi", part3Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kvd", part3Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "kvdi", part3Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "dd", part3Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "ddi", part3Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "prv", part3Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "pr", part3Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "pri", part3Arr.getCurrentItem()(10));
        printString("URL_39", rowCode, "prpr", part3Arr.getCurrentItem()(11));
        printString("URL_39", rowCode, "prpp", part3Arr.getCurrentItem()(12));
        printString("URL_39", rowCode, "prvk", part3Arr.getCurrentItem()(13));
        printString("URL_39", rowCode, "vprs", part3Arr.getCurrentItem()(16));
        printString("URL_39", rowCode, "vkos", part3Arr.getCurrentItem()(17));
        printString("URL_39", rowCode, "dps", part5Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sps", part5Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "vps", part5Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "ktps", part5Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "lszs", part6Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "lszp", part6Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "szs", part6Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "szp", part6Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "kks", part6Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "ocs", part6Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "rzrp", part6Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "rzo", part6Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "rzf", part6Arr.getCurrentItem()(8));
        printString("URL_39", rowCode, "dops", part6Arr.getCurrentItem()(9));
        printString("URL_39", rowCode, "fpz", part6Arr.getCurrentItem()(10));
        printString("URL_39", rowCode, "kobd", part6Arr.getCurrentItem()(11));
        printString("URL_39", rowCode, "kvspkr", part6Arr.getCurrentItem()(12));
        printString("URL_39", rowCode, "spdbn", part7Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "spdbp", part7Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "spdvn", part7Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "spdvp", part7Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "spdr", part7Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "ppod", part9Arr.getCurrentItem()(0));
        printString("URL_39", rowCode, "sodp", part9Arr.getCurrentItem()(1));
        printString("URL_39", rowCode, "sodf", part9Arr.getCurrentItem()(2));
        printString("URL_39", rowCode, "pupr", part9Arr.getCurrentItem()(3));
        printString("URL_39", rowCode, "sprp", part9Arr.getCurrentItem()(4));
        printString("URL_39", rowCode, "sprf", part9Arr.getCurrentItem()(5));
        printString("URL_39", rowCode, "skk", part9Arr.getCurrentItem()(6));
        printString("URL_39", rowCode, "daz", part9Arr.getCurrentItem()(7));
        printString("URL_39", rowCode, "kvod", part9Arr.getCurrentItem()(12));
        printString("URL_39", rowCode, "kvp", part9Arr.getCurrentItem()(13));
    end;

    private macro printPart_URL_9F(creditId, userTrancheNumber)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;
        var prevTrancheId = null;
        var currentTrancheId = null;

        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 2));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 2));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

            _npp = MkStr("0", 6 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;

            printString("URL_9F", rowCode, "uid", creditId);
            printString("URL_9F", rowCode, "ntr", userTrancheNumber);
            printString("URL_9F", rowCode, "npp", npp);
            printString("URL_9F", rowCode, "daz", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "dateRemovalDebt"));
            printString("URL_9F", rowCode, "dzap", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "maturityDateDebt"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_9R(creditId, creditIdForReport)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode = "";
        var prevTrancheId = null;
        var currentTrancheId = null;
        var userTrancheNumber = null;

        iteratorAddLinesPart9.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        iteratorAddLinesPart5.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart5.moveFirst();


        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesPart5);
        synchronizerAddLines.moveFirst();



        while (not synchronizerAddLines.isDone())
            var addLine = iteratorAddLinesPart9.currentItem.fieldValue("addLine").exact;

            if (addLine != 2)
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

                if (not iteratorAddLinesPart5.isDone())
                    userTrancheNumber = NVL(iteratorAddLinesPart5.currentItem.fieldValue("userTrancheNumber").currentAsString, "");
                else
                    userTrancheNumber = "";
                end;

            _npp = MkStr("0", 6 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + MkStr("_", 100 - strlen(String(userTrancheNumber))) + userTrancheNumber + "_" + _npp;

            printString("URL_9R", rowCode, "uid", creditIdForReport);
            printString("URL_9R", rowCode, "ntr", userTrancheNumber);
            printString("URL_9R", rowCode, "npp", npp);
            printString("URL_9R", rowCode, "sodf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidDebt"));
            printString("URL_9R", rowCode, "sprf", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumPaidInterest"));
            printString("URL_9R", rowCode, "skk", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sumFines"));
            printString("URL_9R", rowCode, "ist", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
            printString("URL_9R", rowCode, "kvod", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "principalPaymentFiCode"));
            printString("URL_9R", rowCode, "kvp", getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "percentPaymentFiCode"));
            end;

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_41(creditId, creditIdForReport)
        var iteratorAddLinesPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorAddLinesUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var rowCode;

        iteratorAddLinesPart4.setFilter(TIteratorAnyAddLineFilter(creditId));
        iteratorAddLinesPart4.setSortOrder(TSyncSorterByAddLines());
        iteratorAddLinesPart4.moveFirst();

        iteratorAddLinesUserPart4.setFilter(TIteratorAnyAddLineFilter(creditId));
        iteratorAddLinesUserPart4.setSortOrder(TSyncSorterByAddLines());
        iteratorAddLinesUserPart4.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterByAddLines(), iteratorAddLinesPart4);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart4);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp = npp + 1;

            _npp = MkStr("0", 6 - strlen(String(npp))) + String(npp);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + creditIdForReport + MkStr("_", 100) + _npp;

            printString("URL_41", rowCode, "uid", creditIdForReport);
            printString("URL_41", rowCode, "ntr", "");
            printString("URL_41", rowCode, "npp", npp);
            printString("URL_41", rowCode, "ov",    getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "typeSecurity"));
            printString("URL_41", rowCode, "sor",   getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "sumSecurities"));
            printString("URL_41", rowCode, "dvov",  getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "repossessionDate"));
            printString("URL_41", rowCode, "sovps", getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "sumSecuritiesReserve"));
            printString("URL_41", rowCode, "sovpt", getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "securitiesRvpPercent"));
            printString("URL_41", rowCode, "sovpu", getPrintValue(iteratorAddLinesPart4, iteratorAddLinesUserPart4, "securitiesRvpObligations"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_10(creditId, part10Arr)
        var rowCode;
        var npp = 1;

        var _npp = MkStr("0", 3 - strlen(String(npp))) + String(npp);
        rowCode = MkStr("_", 100 - strlen(String(creditId))) + creditId + "_" + _npp;

        printString("URL_10", rowCode, "uid",     creditId);
        printString("URL_10", rowCode, "npp",     _npp);
        printString("URL_10", rowCode, "vidp",    part10Arr.getCurrentItem()(0));
        printString("URL_10", rowCode, "ouds",    part10Arr.getCurrentItem()(1));
        printString("URL_10", rowCode, "opds",    part10Arr.getCurrentItem()(2));
        printString("URL_10", rowCode, "namep",   part10Arr.getCurrentItem()(3));
        printString("URL_10", rowCode, "ogrnp",   part10Arr.getCurrentItem()(4));
        printString("URL_10", rowCode, "regnomp", part10Arr.getCurrentItem()(5));
        printString("URL_10", rowCode, "oksmp",   part10Arr.getCurrentItem()(6));
        printString("URL_10", rowCode, "uss",     part10Arr.getCurrentItem()(7));
        printString("URL_10", rowCode, "uskv",    part10Arr.getCurrentItem()(8));

    end;

    private macro printPart_URL_6(creditId, creditIdForReport, part3Arr)
        var iteratorAddLinesPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorAddLinesUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var npp = 0;
        var _npp = "";
        var _ntr = "";
        var rowCode = "";
        var _trn = "";

        iteratorAddLinesPart6.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart6.setSortOrder(TSyncSorter());
        iteratorAddLinesPart6.moveFirst();

        iteratorAddLinesUserPart6.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart6.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart6.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart6);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart6);
        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            npp  = npp + 1;
            _trn = Int(iteratorAddLinesPart6.currentItem.fieldValue("trancheNumber").exact);
            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(_trn))) + String(_trn);
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_6", rowCode, "uid",    creditIdForReport);
            printString("URL_6", rowCode, "ntr",    iteratorAddLinesPart6.currentItem.fieldValue("trancheNumber").exact);
            printString("URL_6", rowCode, "npp",    npp);
            printString("URL_6", rowCode, "usd",    part3Arr.getCurrentItem()(14));
            printString("URL_6", rowCode, "lszs",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "termDebtAccount"));
            printString("URL_6", rowCode, "lszp",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "arrearsAccount"));
            printString("URL_6", rowCode, "szs",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumTermDebt"));
            printString("URL_6", rowCode, "szp",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumOverDebt"));
            printString("URL_6", rowCode, "kks",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "loanQuality"));
            printString("URL_6", rowCode, "rzrp",   getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "calcReserve"));
            printString("URL_6", rowCode, "rzo",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumCalcReserveSecurity"));
            printString("URL_6", rowCode, "rzf",    getPrintValue(iteratorAddLinesPart6, iteratorAddLinesUserPart6, "sumFormedReserve"));

            synchronizerAddLines.moveNext();
        end;
    end;

    private macro printPart_URL_11(creditId, userTrancheNumber, creditIdForReport)
        var iteratorAddLinesPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorAddLinesUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var npp     = 0;
        var _npp    = "";
        var rowCode = "";
        var _ntr    = "";
        var prevTrancheId    = null;
        var currentTrancheId = null;

        iteratorAddLinesPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart9.moveFirst();

        iteratorAddLinesUserPart9.setFilter(TIteratorAddCreditLineFilter(creditId, 1));
        iteratorAddLinesUserPart9.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart9.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart9);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart9);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;
            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(Int(userTrancheNumber)))) + String(Int(userTrancheNumber));
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_11", rowCode, "uid",   creditIdForReport);
            printString("URL_11", rowCode, "ntr",   userTrancheNumber);
            printString("URL_11", rowCode, "npp",   npp);
            printString("URL_11", rowCode, "ist",   getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "sourceRepayment"));
            printString("URL_11", rowCode, "idnd",  getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "codeNewCredit"));
            printString("URL_11", rowCode, "rko",   getPrintValue(iteratorAddLinesPart9, iteratorAddLinesUserPart9, "regNumber"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart9) and (iteratorAddLinesPart9.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart9.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printPart_URL_16(creditId, creditIdForReport)
        var iteratorAddLinesPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorAddLinesUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorAddLinesPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var npp     = 0;
        var _npp    = "";
        var rowCode = "";
        var _ntr    = "";
        var prevTrancheId    = null;
        var currentTrancheId = null;
        var userTrancheNumber = null;

        iteratorAddLinesPart3.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart3.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart3.moveFirst();

        iteratorAddLinesUserPart3.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesUserPart3.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesUserPart3.moveFirst();

        iteratorAddLinesPart5.setFilter(TIteratorCreditLineFilter(creditId));
        iteratorAddLinesPart5.setSortOrder(TSyncSorterAddLines());
        iteratorAddLinesPart5.moveFirst();

        var synchronizerAddLines = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorterAddLines(), iteratorAddLinesPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesUserPart3);
        synchronizerAddLines.addIterator(iteratorAddLinesPart5);

        synchronizerAddLines.moveFirst();

        while (not synchronizerAddLines.isDone())
            if (currentTrancheId != prevTrancheId)
                npp = 1;
            else
                npp = npp + 1;
            end;

            if (not iteratorAddLinesPart5.isDone())
                userTrancheNumber = NVL(iteratorAddLinesPart5.currentItem.fieldValue("userTrancheNumber").currentAsString, "");
            else
                userTrancheNumber = "";
            end;

            _npp = "_" + MkStr("0", 6 - strlen(String(npp))) + String(npp);
            _ntr = MkStr("0", 3 - strlen(String(Int(userTrancheNumber)))) + String(Int(userTrancheNumber));
            rowCode = MkStr("_", 100 - strlen(String(creditIdForReport))) + String(creditIdForReport)
                                                                 + MkStr("_", 100)
                                                                 + _ntr + _npp;
            printString("URL_16", rowCode, "uid",  creditIdForReport);
            printString("URL_16", rowCode, "ntr",  userTrancheNumber);
            printString("URL_16", rowCode, "npp",  npp);
            printString("URL_16", rowCode, "usd",  getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "conditionCode"));
            printString("URL_16", rowCode, "uidk", getPrintValue(iteratorAddLinesPart3, iteratorAddLinesUserPart3, "creditIdCode"));

            synchronizerAddLines.moveNext();
            if (not synchronizerAddLines.isNull(iteratorAddLinesPart3) and (iteratorAddLinesPart3.currentItem != null))
                prevTrancheId = currentTrancheId;
                currentTrancheId = iteratorAddLinesPart3.currentItem.fieldValue("trancheNumber").exact;
            end;
        end;
    end;

    private macro printData()
        var i = 0;
        var iteratorPart1 = RcbApplication().currentReport.attributeValue("Раздел1").createValueIterator();
        var iteratorUserPart1 = RcbApplication().currentReport.attributeValue("Раздел1_Ввод").createValueIterator();
        var iteratorPart2 = RcbApplication().currentReport.attributeValue("Раздел2").createValueIterator();
        var iteratorUserPart2 = RcbApplication().currentReport.attributeValue("Раздел2_Ввод").createValueIterator();
        var iteratorPart3 = RcbApplication().currentReport.attributeValue("Раздел3").createValueIterator();
        var iteratorUserPart3 = RcbApplication().currentReport.attributeValue("Раздел3_Ввод").createValueIterator();
        var iteratorPart4 = RcbApplication().currentReport.attributeValue("Раздел4").createValueIterator();
        var iteratorUserPart4 = RcbApplication().currentReport.attributeValue("Раздел4_Ввод").createValueIterator();
        var iteratorPart5 = RcbApplication().currentReport.attributeValue("Раздел5").createValueIterator();
        var iteratorUserPart5 = RcbApplication().currentReport.attributeValue("Раздел5_Ввод").createValueIterator();
        var iteratorPart6 = RcbApplication().currentReport.attributeValue("Раздел6").createValueIterator();
        var iteratorUserPart6 = RcbApplication().currentReport.attributeValue("Раздел6_Ввод").createValueIterator();
        var iteratorPart7 = RcbApplication().currentReport.attributeValue("Раздел7").createValueIterator();
        var iteratorUserPart7 = RcbApplication().currentReport.attributeValue("Раздел7_Ввод").createValueIterator();
        var iteratorPart8 = RcbApplication().currentReport.attributeValue("Раздел8").createValueIterator();
        var iteratorUserPart8 = RcbApplication().currentReport.attributeValue("Раздел8_Ввод").createValueIterator();
        var iteratorPart9 = RcbApplication().currentReport.attributeValue("Раздел9").createValueIterator();
        var iteratorUserPart9 = RcbApplication().currentReport.attributeValue("Раздел9_Ввод").createValueIterator();
        var iteratorPart10 = RcbApplication().currentReport.attributeValue("Раздел10").createValueIterator();
        var iteratorUserPart10 = RcbApplication().currentReport.attributeValue("Раздел10_Ввод").createValueIterator();

        iteratorPart1.setSortOrder(TSyncSorter());
        iteratorPart1.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart1.setSortOrder(TSyncSorter());
        iteratorUserPart1.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart2.setSortOrder(TSyncSorter());
        iteratorUserPart2.setSortOrder(TSyncSorter());
        iteratorPart3.setSortOrder(TSyncSorter());
        iteratorPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart3.setSortOrder(TSyncSorter());
        iteratorUserPart3.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart4.setSortOrder(TSyncSorter());
        iteratorPart4.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart4.setSortOrder(TSyncSorter());
        iteratorUserPart4.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart5.setSortOrder(TSyncSorter());
        iteratorPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart5.setSortOrder(TSyncSorter());
        iteratorUserPart5.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart6.setSortOrder(TSyncSorter());
        iteratorPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart6.setSortOrder(TSyncSorter());
        iteratorUserPart6.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart7.setSortOrder(TSyncSorter());
        iteratorPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart7.setSortOrder(TSyncSorter());
        iteratorUserPart7.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart8.setSortOrder(TSyncSorter());
        iteratorUserPart8.setSortOrder(TSyncSorter());
        iteratorPart9.setSortOrder(TSyncSorter());
        iteratorPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorUserPart9.setSortOrder(TSyncSorter());
        iteratorUserPart9.setFilter(TIteratorTypeLineFilter(0));
        iteratorPart10.setSortOrder(TSyncSorter());
        iteratorUserPart10.setSortOrder(TSyncSorter());

        var synchronizer = null;
        var maxItem = max(iteratorPart1.count(), max(iteratorPart3.count(), max(iteratorPart5.count(), max(iteratorPart6.count(), max(iteratorPart7.count(), iteratorPart9.count())))));

        if (iteratorPart1.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart3.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart3);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart5.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart5);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart6.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart6);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart7.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart7);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart9);
            synchronizer.addIterator(iteratorPart10);
        elif (iteratorPart9.count() == maxItem)
            synchronizer = RcbValueIteratorSynchronizer(RCB_ISK_OUTER_JOIN, TSyncSorter(), iteratorPart9);
            synchronizer.addIterator(iteratorPart1);
            synchronizer.addIterator(iteratorPart2);
            synchronizer.addIterator(iteratorPart3);
            synchronizer.addIterator(iteratorPart4);
            synchronizer.addIterator(iteratorPart5);
            synchronizer.addIterator(iteratorPart6);
            synchronizer.addIterator(iteratorPart7);
            synchronizer.addIterator(iteratorPart8);
            synchronizer.addIterator(iteratorPart10);
        end;
        synchronizer.addIterator(iteratorUserPart1);
        synchronizer.addIterator(iteratorUserPart2);
        synchronizer.addIterator(iteratorUserPart3);
        synchronizer.addIterator(iteratorUserPart4);
        synchronizer.addIterator(iteratorUserPart5);
        synchronizer.addIterator(iteratorUserPart6);
        synchronizer.addIterator(iteratorUserPart7);
        synchronizer.addIterator(iteratorUserPart8);
        synchronizer.addIterator(iteratorUserPart9);
        synchronizer.addIterator(iteratorUserPart10);

        synchronizer.moveFirst();

        var part1Arr = RcbArray();
        var part2Arr = RcbArray();
        var part3Arr = RcbArray();
        var part4Arr = RcbArray();
        var part5Arr = RcbArray();
        var part6Arr = RcbArray();
        var part7Arr = RcbArray();
        var part8Arr = RcbArray();
        var part9Arr = RcbArray();
        var part10Arr = RcbArray();
        var value = RcbArray();

        while (not synchronizer.isDone())
            if (not synchronizer.isNull(iteratorPart1) or not synchronizer.isNull(iteratorUserPart1))
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtor"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrn"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "ogrnip"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "registrationDate"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorINN"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKPO"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "debtorOKSM"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "relationsWitnBank"));
                value.push_back(getPrintValue(iteratorPart1, iteratorUserPart1, "okved"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part1Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart2) or not synchronizer.isNull(iteratorUserPart2))
                value.push_back(Int(getPrintValue(iteratorPart2, iteratorUserPart2, "creditId")));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "creditNumber"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "date"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberLoan"));
                value.push_back(NVL(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLoan"), " "));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "partyLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "ogrnLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "regnumberLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "oksmLoan"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "numberRestructurings"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "bankruptcyInfo"));
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateBankruptcy"));
                value.push_back(getCreditIdPrintValue(iteratorPart2));  // id отчета для печати
                value.push_back(getPrintValue(iteratorPart2, iteratorUserPart2, "dateLastRestructuring"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part2Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart3) or not synchronizer.isNull(iteratorUserPart3))
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "purposeCredit"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "sumChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "fiCodeChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "dateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateOrigContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateChangesContract"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "rateLoan"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "interestPeriod"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "conditionCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "creditIdCode"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeRateEndDate"));
                value.push_back(getPrintValue(iteratorPart3, iteratorUserPart3, "typeFloatRateEndDate"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part3Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart4)or not synchronizer.isNull(iteratorUserPart4))
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeSecurity"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumFirstQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecondQuality"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "sumSecuritiesReserve"));
                value.push_back(getPrintValue(iteratorPart4, iteratorUserPart4, "typeInsurance"));
            else
                value.push_back(0); // SCR 229026
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part4Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart5) or not synchronizer.isNull(iteratorUserPart5))
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "dateLoan"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "userTrancheNumber"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "funds"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "fiCode"));
                value.push_back(getPrintValue(iteratorPart5, iteratorUserPart5, "okato"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part5Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart6) or not synchronizer.isNull(iteratorUserPart6))
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "termDebtAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "arrearsAccount"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumTermDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumOverDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "loanQuality"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "evaluation"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "calcReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "information254P"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "finPositionBorrower"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "qualityServiceDebt"));
                value.push_back(getPrintValue(iteratorPart6, iteratorUserPart6, "highRiskFactor"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part6Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart7) or not synchronizer.isNull(iteratorUserPart7))
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalance"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumClaimNotBalanceOver"));
                value.push_back(getPrintValue(iteratorPart7, iteratorUserPart7, "sumFormedReserve"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part7Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart8) or not synchronizer.isNull(iteratorUserPart8))
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumUnusedLimits"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumCalcReserveSecurity"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "sumFormedReserve"));
                value.push_back(getPrintValue(iteratorPart8, iteratorUserPart8, "rvpPercent"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part8Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart9) or not synchronizer.isNull(iteratorUserPart9))
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "periodicityInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumProvidedInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumPaidInterest"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sumFines"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "dateRemovalDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "maturityDateDebt"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "sourceRepayment"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "codeNewCredit"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "regNumber"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "principalPaymentFiCode"));
                value.push_back(getPrintValue(iteratorPart9, iteratorUserPart9, "percentPaymentFiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part9Arr.push_back(value);
            value = RcbArray();

            if (not synchronizer.isNull(iteratorPart10) or not synchronizer.isNull(iteratorUserPart10))
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "methodRefinancing"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumRefinancingDebt"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumFunds"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "party"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "ogrn"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "regNumber"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "oksm"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "sumDeal"));
                value.push_back(getPrintValue(iteratorPart10, iteratorUserPart10, "fiCode"));
            else
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
                value.push_back("");
            end;
            part10Arr.push_back(value);
            value = RcbArray();

            synchronizer.moveNext();
        end;

        part1Arr.moveFirst();
        part2Arr.moveFirst();
        part3Arr.moveFirst();
        part4Arr.moveFirst();
        part5Arr.moveFirst();
        part6Arr.moveFirst();
        part7Arr.moveFirst();
        part8Arr.moveFirst();
        part9Arr.moveFirst();
        part10Arr.moveFirst();

        m_view.setOutputFile();

        m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

        var currentCreditId = null;
        var prevCreditId = null;
        var creditIdForReport = null;

        while (part1Arr.moveNext() and part2Arr.moveNext()  and part3Arr.moveNext() and part4Arr.moveNext() and part5Arr.moveNext()
           and part6Arr.moveNext() and part7Arr.moveNext() and part8Arr.moveNext() and part9Arr.moveNext()  and part10Arr.moveNext())

            currentCreditId = part2Arr.getCurrentItem()(0);
            creditIdForReport = part2Arr.getCurrentItem()(12);

            if ((m_view.getFileSize() > MAX_FILE_SIZE) and (currentCreditId != prevCreditId))
                beginNewPart();
                m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
                m_view.setZeroRowsCount();
                m_view.setEOL(MkStr("0", 3 - strlen(String(m_view.getNumberPart()))) + String(m_view.getNumberPart()));

                part1Arr.movePrev();
                part2Arr.movePrev();
                part3Arr.movePrev();
                part4Arr.movePrev();
                part5Arr.movePrev();
                part6Arr.movePrev();
                part7Arr.movePrev();
                part8Arr.movePrev();
                part9Arr.movePrev();
                part10Arr.movePrev();

                continue;
            end;

            printPart_URL_2(creditIdForReport, part1Arr, part2Arr, part8Arr, part4Arr);

            if (global.getRcbReport().context.period.EndDate >= RCB_I4637_DATE_F303)
                printPart_URL_2_11(currentCreditId, creditIdForReport);
                printPart_URL_2_12(currentCreditId, creditIdForReport);
            end;

            printPart_URL_2S(currentCreditId, creditIdForReport);
            printPart_URL_39(creditIdForReport, part3Arr, part4Arr, part5Arr, part6Arr, part7Arr, part9Arr, part2Arr);

            printPart_URL_41(currentCreditId, creditIdForReport);
            printPart_URL_9F(currentCreditId, part5Arr.getCurrentItem()(1), creditIdForReport);
            printPart_URL_9R(currentCreditId, creditIdForReport);
            printPart_URL_10(creditIdForReport, part10Arr);
            printPart_URL_6(currentCreditId, creditIdForReport, part3Arr);
            printPart_URL_11(currentCreditId, part5Arr.getCurrentItem()(1), creditIdForReport);
            printPart_URL_16(currentCreditId, creditIdForReport);

            prevCreditId = currentCreditId;
        end;


        m_view.resetOutputFile();
        m_totalRowsCount = m_totalRowsCount + m_view.getRowsCount();
        m_viewArr[m_viewArr.size] = m_view.clone();
    end;

    private macro getDescriptorInfo()
        return "";
    end;

end;