/*
$Name:          f155ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 155. Фабрика объектов отчетной формы
*/

/**
* Форма 155. фабрика объектов отчетной формы.
*
* @since   01.09.2008
* @author  Ivkina Olga
* @version 6.00.020.29
*/
import repException;

class (RcbObjectFactoryBase)TObjectFactory()
    macro createCalculationController() /*: TCalculationController*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createCalculationController"));
    end;

    macro createReport() /*: TReport*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createReport"));
    end;

    macro createPart() /*: TPart*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPart"));
    end;

    macro createAttribute() /*: TAttribute*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createAttribute"));
    end;

    macro createDataSource() /*: TDataSource*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSource"));
    end;

    macro createDataSourceFilters() /*: TDataSourceFilters*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSourceFilters"));
    end;

    macro createPrintController() /*: PrintController*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintController"));
    end;

    macro createTuneTable() /*: TTuneTable*/
    end;

    macro createPrintCalculationProtocolOperation() /*TPrintOperation*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintCalculationProtocolOperation"));
    end;

    macro createNormalizationController()
        throw(TPureVirtualMethodCallException("TObjectFactory::createNormalizationController"));
    end;

    macro createXmlExportController()
        return genObject("TObjectFactory::TExportXmlController");
    end;
end;


class (TObjectFactory) TObjectFactory2055()
    initTObjectFactory();

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2055");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2055");
    end;

    macro createPart(number : Integer, name : String) /*: TPart*/
        return genObject("TPart", number, name);
    end;

    macro createAttribute(attributeValue /*: RcbAttributeValue*/, attributeLineNumber : String, structureAttribute) /*: TAttribute*/
        return genObject("TAttribute",attributeValue /*: RcbAttributeValue*/, attributeLineNumber, structureAttribute);
    end;

    macro createUserAttribute(attributeValue /*: RcbAttributeValue*/, attributeLineNumber : String, attributeColumnNumber : String, attributeColumn : String)
        return genObject("TUserAttribute2055",attributeValue /*: RcbAttributeValue*/, attributeLineNumber, attributeColumnNumber, attributeColumn);
    end;

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource");

        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2055");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2055");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2055");
    end;

    macro createKlikoView() /*: TKlikoView*/
        return genObject("TKlikoView2055");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2055");
    end;
    /**
    * Создать операцию печати протокола расчета отчета.
    */
    macro createPrintCalculationProtocolOperation() /*: TPrintOperation*/
        return genObject("TProtocolView2055");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2055");
    end;
end;

class (TObjectFactory2055) TObjectFactory2332()
    initTObjectFactory2055();

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2332");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2332");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2332");
    end;
end;

class (TObjectFactory2332) TObjectFactory2742()
    initTObjectFactory2332();

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2742");
    end;

    macro createUserAttribute(attributeValue /*: RcbAttributeValue*/, attributeLineNumber : String, attributeColumnNumber : String, attributeColumn : String)
        return genObject("TUserAttribute2742",attributeValue /*: RcbAttributeValue*/, attributeLineNumber, attributeColumnNumber, attributeColumn);
    end;

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource2742");

        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2742");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2742");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2742");
    end;

    /**
     * Создать операцию экспорта в ПТК ПСД
     */
    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController2742");
    end;
end;

class (TObjectFactory2742) TObjectFactory2835()
    initTObjectFactory2742();

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2835");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2835");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2835");
    end;

    macro createAttributeForPart4(attributeValue, attributeNumber: Integer, attributeName: String, attributeInn: String, attributeILicense: String, attributeNSecurities: Integer,
                                 attributeValueOfSecurities: Money, attributePresentValue: Money, attributeMadeReserve: Money, attributeIsNotResident: Integer)
        return genObject("TAttribute2835ForPart4", attributeValue, attributeNumber, attributeName, attributeInn, attributeILicense, attributeNSecurities,
                                                  attributeValueOfSecurities, attributePresentValue, attributeMadeReserve, attributeIsNotResident);
    end;

    macro createPart4Item2(number, name)
        return genObject("TPart2835Part4Item2", number, name);
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2835");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2835");
    end;

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource2742");
        elif ((backOffice == BOCb) AND (dataSourceType == 3))
            return genObject("TCbAccountsDataSource2835");
        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    /**
     * Создать операцию экспорта в ПТК ПСД
     */
    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController2835");
    end;
end;

class (TObjectFactory2835) TObjectFactory3006()
    initTObjectFactory2835();

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController3006");
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController3006");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController3006");
    end;

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource2742");
        elif ((backOffice == BOCb) AND (dataSourceType == 3))
            return genObject("TCbAccountsDataSource2835");
        elif ((backOffice == BOCb) AND (dataSourceType == 4))
            return genObject("TCbAccountsDataSourcePart4_3006");
        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController3006");
    end;

end;

class (TObjectFactory3006) TObjectFactory3129()
    initTObjectFactory3006();

    /**
     * Метод используется при создании RcbReportView
     * Данный класс генериться именно таким образом, т.к. требует инкапсуляции представления
     * шапок(подвалов) печатных форм отчета в RcbReportView
     */
    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        if (rcbApplication().currentReport.context.period.endDate >= RCB_I3129_DATE)
            return genObject("TPrintableView_3129", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2851_DATE)
            return genObject("TPrintableView_2851", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2742_DATE)
            return genObject("TPrintableView_2742", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
            return genObject("TPrintableView_2332", formName, formOkudCode, formPeriodicity, periodFormat);
        else
            return genObject("TPrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
        end;
    end;

    macro createAttributeForPart4(attributeValue, attributeNumber: Integer, attributeName: String, attributeInn: String, attributeILicense: String, attributeNSecurities: Integer,
                                 attributeValueOfSecurities: Money, attributePresentValue: Money, attributeMadeReserve: Money, attributeIsNotResident: Integer)
        return genObject("TAttribute3129ForPart4", attributeValue, attributeNumber, attributeName, attributeInn, attributeILicense, attributeNSecurities,
                                                  attributeValueOfSecurities, attributePresentValue, attributeMadeReserve, attributeIsNotResident);
    end;

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource3129");
        elif ((backOffice == BOCb) AND (dataSourceType == 3))
            return genObject("TCbAccountsDataSource2835");
        elif ((backOffice == BOCb) AND (dataSourceType == 4))
            return genObject("TCbAccountsDataSourcePart3_3129");
        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport3129");
    end;

    macro createPart4Item1(number, name)
        return genObject("TPart3129Part4Item1", number, name);
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController3129");
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController3129");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController3129");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController3129");
    end;

    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController3129");
    end;
end;

class (TObjectFactory3129) TObjectFactory3468()
    initTObjectFactory3129();

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource3129");
        elif ((backOffice == BOCb) AND (dataSourceType == 3))
            return genObject("TCbAccountsDataSource3468");
        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport3468");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController3468");
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController3468");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController3468");
    end;

    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController3468");
    end;
end;

class (TObjectFactory3468) TObjectFactory4033()
    initTObjectFactory3468();

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController4033");
    end;
end;

class (TObjectFactory4033) TObjectFactory_41_1_3_8_728()
    initTObjectFactory4033();

    macro createDataSource(backOffice : Integer, dataSourceType : Integer)
        if ((backOffice == BOCb) AND (dataSourceType == 1))
            return genObject("TCbAccountsDataSource");
        elif ((backOffice == BOCb) AND (dataSourceType == 2))
            return genObject("TCbCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 1))
            return genObject("TLoansCreditDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 2))
            return genObject("TLoansCaseDataSource");
        elif ((backOffice == BOLoans) AND (dataSourceType == 3))
            return genObject("TLoansCaseDataSource_41_1_3_8_728");
        elif (backOffice == BOUser)
            return genObject("TUserDataSource3129");
        elif ((backOffice == BOCb) AND (dataSourceType == 3))
            return genObject("TCbAccountsDataSource3468");
        else
            msgbox("Error type \"dataSource\".");
        end;
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController_41_1_3_8_728");
    end;
end;

class (TObjectFactory_41_1_3_8_728) TObjectFactory_Т1_77_01_01_575()
    initTObjectFactory_41_1_3_8_728();

    macro createXmlExportController(periodicity: integer)
        return genObject("TExportXmlController_Т1_77_01_01_575", periodicity);
    end;
end;

/**
* Точка доступа к объекту-одиночке TObjectFactory()
*/
if (objectFactoryInstance == null)
    /*Создание конкретной фабрики в зависимости от даты указания*/
    if   (rcbApplication().currentReport.context.period.endDate >= RCB_Т1_77_01_01_575_DATE)
        objectFactoryInstance = TObjectFactory_Т1_77_01_01_575(); 
    elif   (rcbApplication().currentReport.context.period.endDate >= RCB_41_1_3_8_728_DATE)
        objectFactoryInstance = TObjectFactory_41_1_3_8_728();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I4033_DATE)
        objectFactoryInstance = TObjectFactory4033();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3468_DATE)
        objectFactoryInstance = TObjectFactory3468();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3129_DATE)
        objectFactoryInstance = TObjectFactory3129();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3006_DATE)
        objectFactoryInstance = TObjectFactory3006();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2835_DATE)
        objectFactoryInstance = TObjectFactory2835();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2742_DATE)
        objectFactoryInstance = TObjectFactory2742();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
        objectFactoryInstance = TObjectFactory2332();
    else
        objectFactoryInstance = TObjectFactory2055();
    end;
end;
