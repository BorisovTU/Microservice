/*
$Name:          f155DataSourceProtocols.mac
$Module:        ¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì
$Description:   ”®à¬  155. à®â®ª®« ¨áâ®ç­¨ª  ¤ ­­ëå
*/

/**
 * ”®à¬  155. à®â®ª®« ¨áâ®ç­¨ª  ¤ ­­ëå.
 *
 * @since   23.09.2008
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
import rsbDataSet;

/**
 * ¥ç âì ¯à®â®ª®«  à áç¥â .
 */
class TDataSourceProtocol(view : String)

    /**
     * ¡ê¥ªâ ¤«ï ¯¥ç â¨ ¯® è ¡«®­ã.
     */
    private var m_view;

    /**
     * Š®­áâàãªâ®à.
     */
    private macro constructor(view : String)
        m_view = view;
    end;

    /**
     * ¥ç âì á®®¡é¥­¨ï ®¡ ®âáãâáâ¢¨¥ ¤ ­­ëå.
     */
    private macro printNullData()
        println("   ¥â ¤ ­­ëå.");
    end;

    private macro beginTable()
    end;

    private macro printString(dataSet)
    end;

    private macro endTable(dataSet)
    end;

    /**
     * ¥ç âì ¯à®â®ª®« .
     */
    macro printProtocol(dataSet /*: TRsbDataSet*/, hasData)
        var itogRecord;

        if (hasData)
            itogRecord = dataset.getRecord();
            /*m_view.*/beginTable(dataSet);
            while (dataSet.moveNext())
                /*m_view.*/printString(dataSet);
            end;
            /*m_view.*/endTable(itogRecord);
        else
            /*m_view.*/printNullData();
        end;
    end;

    constructor(view);
end;

class (TDataSourceProtocol) TCbAccountDataSourceProtocol()
    private macro beginTable()
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³ ®¬¥à «¨æ¥¢®£® áç¥â     ³Š â¥£®-³ áâ â®ª áç¥â   ³   „ â    ³à®æ¥­â³       ‘ç¥â à¥§¥à¢       ³    áç¥â­ë©    ³  áç¥â­ë© à¥§¥à¢ ³  ” ªâ¨ç¥áª¨©   ³
 ³                         ³  à¨ï  ³                ³          ³       ³                         ³                ³     á ãç¥â®¬     ³                ³
 ³                         ³ª ç¥áâ-³    ¢ àã¡«ïå    ³ ¯®£ è¥­¨ï³à¥§¥à¢ ³                         ³    à¥§¥à¢      ³    ®¡¥á¯¥ç¥­¨ï   ³    à¥§¥à¢      ³
 ³                         ³  ¢    ³                ³          ³       ³                         ³                ³                  ³                ³
 ³                         ³       ³                ³          ³       ³                         ³                ³                  ³                ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro printString(dataSet)
[ #########################       # ################ ##########    ###  ######################### ################  ################  ################]

(dataSet.account:r,
NVL(dataSet.qualityCategory, ""),
dataSet.column_3:0:2,
NVL(dataSet.maturityDate, ""),
NVL(dataSet.accountreservepercent, ""),
dataSet.reserveAccount:r,
dataSet.column_9:0:2,
dataSet.column_10:0:2,
dataSet.column_11:0:2);
    end;

    private macro endTable(dataSet)
[ ˆ’ƒ                             ################                                              ################  ################  ################]
(
dataSet.column_3:0:2,
dataSet.column_9:0:2,
dataSet.column_10:0:2,
dataSet.column_11:0:2);
    end;
end;

class (TDataSourceProtocol) TCbCaseDataSourceProtocol()
    private macro beginTable(dataSet)
    [ÚÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     ³ ®¬¥à  ³      §¢ ­¨¥    ³   ®¬¥à   ³Š â¥£®-³     áâ â®ª      ³                                      ‘ã¬¬  âà¥¡®¢ ­¨ï                                        ³          ‘ç¥â à¥§¥à¢        ³                 ¥§¥à¢ ­  ¢®§¬®¦­ë¥ ¯®â¥à¨                                                                                         ³
     ³¯®àâä¥«ï³                 ³           ³ £®à¨ï ³                  ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                             ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³        ³     ¯®àâä¥«ï    ³áã¡¯®àâä¥«ï³ª ç¥á¢ ³    ¢  àã¡«ïå     ³                  ³                  ³                  ³                  ³                  ³                             ³   à áç¥â­ë©      ³ à áç¥â­ë© á ãç¥- ³    ä ªâ¨ç¥áª¨©   ³                        ¯® ª â¥£®à¨ï¬ ª ç¥áâ¢                              ³
     ³        ³                 ³           ³       ³                  ³         1        ³         2        ³          3       ³         4        ³          5       ³                             ³                  ³ â®¬ ®¡¥á¯¥ç¥­¨ï  ³      à¥§¥à¢      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
     ³        ³                 ³           ³       ³                  ³                  ³                  ³                  ³                  ³                  ³                             ³                  ³                  ³                  ³         2        ³        3         ³         4        ³         5        ³
     ÀÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro printString(dataSet)

        dataSet.setFieldType("column_3", V_MONEY);
        dataSet.setFieldType("column_4", V_MONEY);
        dataSet.setFieldType("column_5", V_MONEY);
        dataSet.setFieldType("column_6", V_MONEY);
        dataSet.setFieldType("column_7", V_MONEY);
        dataSet.setFieldType("column_8", V_MONEY);
        dataSet.setFieldType("column_9", V_MONEY);
        dataSet.setFieldType("column_10", V_MONEY);
        dataSet.setFieldType("column_11", V_MONEY);
        dataSet.setFieldType("column_12", V_MONEY);
        dataSet.setFieldType("column_13", V_MONEY);
        dataSet.setFieldType("column_14", V_MONEY);
        dataSet.setFieldType("column_15", V_MONEY);

        var m_tableReport = CTableReport( 0, TRUE, TRUE );
            m_tableReport.addColumn( "", 6  , AL_RIGHT );
            m_tableReport.addColumn( "", 15 , AL_LEFT );
            m_tableReport.addColumn( "", 9, AL_RIGHT );
            m_tableReport.addColumn( "", 5, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 27, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );
            m_tableReport.addColumn( "", 16, AL_RIGHT );

            m_tableReport.PrintStringTransferByWord(dataSet.id, dataSet.name, dataSet.subNumber, NVL(dataSet.qualityCategory, ""), dataSet.column_3, dataSet.column_4,
                                                    dataSet.column_5, dataSet.column_6, dataSet.column_7, dataSet.column_8, dataSet.reserveAccount, dataSet.column_9,
                                                    dataSet.column_10, dataSet.column_11, dataSet.column_12, dataSet.column_13, dataSet.column_14, dataSet.column_15);

    end;

    private macro printCaseString(dataSet)
[ ˆâ®£® ¯® ¯®àâä¥«î                               ################   ################   ################   ################   ################   ################     #########################   ################   ################   ################   ################   ################   ################   ################]
(dataSet.column_3:0:2,
 dataSet.column_4:0:2,
 dataSet.column_5:0:2,
 dataSet.column_6:0:2,
 dataSet.column_7:0:2,
 dataSet.column_8:0:2,
 dataSet.reserveAccount:r,
 dataSet.column_9:0:2,
 dataSet.column_10:0:2,
 dataSet.column_11:0:2,
 dataSet.column_12:0:2,
 dataSet.column_13:0:2,
 dataSet.column_14:0:2,
 dataSet.column_15:0:2);
    end;


    private macro endTable(dataSet)
[ ˆ’ƒ                                           ################   ################   ################   ################   ################   ################                                 ################   ################   ################   ################   ################   ################   ################]
(dataSet.column_3:0:2,
 dataSet.column_4:0:2,
 dataSet.column_5:0:2,
 dataSet.column_6:0:2,
 dataSet.column_7:0:2,
 dataSet.column_8:0:2,
 dataSet.column_9:0:2,
 dataSet.column_10:0:2,
 dataSet.column_11:0:2,
 dataSet.column_12:0:2,
 dataSet.column_13:0:2,
 dataSet.column_14:0:2,
 dataSet.column_15:0:2);
    end;

    macro printProtocol(dataSet /*: TRsbDataSet*/, hasData)
        var itogRecord;
        if (hasData)
            itogRecord = dataset.getRecord();
            /*m_view.*/
            beginTable(dataSet);
            while (dataSet.moveNext())
                if (dataSet.subNumber != null)
                /*m_view.*/printString(dataSet);
                else
                /*m_view.*/printCaseString(dataSet);
                end;
            end;
            /*m_view.*/endTable(itogRecord);
        else
            /*m_view.*/printNullData();
        end;
    end;



    macro printOtherCaseProtocol(dataSet /*: TRsbDataSet*/, hasData)
        var itogRecord;
        if (hasData)
/*            itogRecord = dataset.getRecord();*/
            /*m_view.*/
            beginTable(dataSet);
            printString(dataSet);
            while ((dataSet.moveNext()) AND (dataSet.subNumber != null))
                /*m_view.*/printString(dataSet);
            end;
//            /*m_view.*/endTable(itogRecord);
            /*m_view.*/endTable(dataSet);
        else
            /*m_view.*/printNullData();
        end;
    end;
end;

class (TDataSourceProtocol) TLoansCreditDataSourceProtocol()
    private macro beginTable(dataSet)
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³          ®¬¥à ¤®£®¢®à            ³  ’¨¯   ³Š â¥£®-³      ‚¨¤       ³áâ â®ª à¥£¨áâà ³   „ â    ³à®æ¥­â³    áç¥â­ë©    ³ áç¥â­ë© à¥§¥à¢³  ” ªâ¨ç¥áª¨©   ³
 ³                                   ³¤®£®¢®à ³  à¨ï  ³    à¥£¨áâà     ³       /        ³®ª®­ç ­¨ï ³à¥§¥à¢ ³     à¥§¥à¢     ³   á ãç¥â®¬     ³    à¥§¥à¢      ³
 ³                                   ³        ³ª ç¥á¢ ³                ³ ‘ã¬¬  ¤®£®¢®à  ³          ³       ³                ³  ®¡¥á¯¥ç¥­¨ï   ³                ³
 ³                                   ³        ³       ³                ³                ³          ³       ³                ³                ³                ³
 ³                                   ³        ³       ³                ³                ³          ³       ³                ³                ³                ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro printStringCredit(dataSet)
[ˆâ®£® ¯® ¤®£®¢®àã              #                                       ################ ##########     ### ################ ################ ################]
(
NVL(dataSet.riskgroup, ""),
 dataSet.column_3:0:2,
dataSet.finishDate:f,
NVL(dataSet.t_rvpreservepercent, ""),
dataSet.column_9:0:2,
dataSet.column_10:0:2,
dataSet.column_11:0:2
);
    end;


    private macro printString(dataSet)
[  ################################## ########         ################ ################]
(dataSet.creditNumber,
 dataSet.creditType,
 dataSet.registerKind:w,
 dataSet.column_3:0:2,
 dataSet.column_4:0:2);
    end;

    private macro endTable(dataSet)
[ˆ’ƒ                                                                  ################                    ################ ################ ################]
(
dataSet.column_3:0:2,
dataSet.column_9:0:2,
dataSet.column_10:0:2,
dataSet.column_11:0:2
);
    end;
    /**
     * ¥ç âì ¯à®â®ª®« .
     */
    macro printProtocol(dataSet /*: TRsbDataSet*/, hasData : Bool)
        var itogRecord;

        if (hasData)
            itogRecord = dataset.getRecord();
            beginTable(dataSet);
            while (dataSet.moveNext())
                if (dataSet.registerType == null)
                    printStringCredit(dataSet);
                    println();
                else
                    printString(dataSet);
                end;
            end;
            endTable(itogRecord);
        else
            printNullData();
        end;
    end;

end;


class (TDataSourceProtocol) TLoansCaseDataSourceProtocol()
    private macro beginTable(dataSet)
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³ ®¬¥à ¯®àâä¥«ï ³Š â¥£®-³    áâ â®ª     ³                                      ‘ã¬¬  âà¥¡®¢ ­¨ï                              ³                 ¥§¥à¢ ­  ¢®§¬®¦­ë¥ ¯®â¥à¨                                                                           ³
 ³                ³ £®à¨ï ³                ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                ³ª ç¥á¢ ³   ¢  àã¡«ïå    ³                ³                ³                ³                ³                ³   à áç¥â­ë©    ³à áç¥â­ë© á ãç¥-³  ä ªâ¨ç¥áª¨©   ³         ¯® ª â¥£®à¨ï¬ ª ç¥áâ¢                                     ³
 ³                ³       ³                ³       1        ³       2        ³        3       ³       4        ³        5       ³                ³â®¬ ®¡¥á¯¥ç¥­¨ï ³    à¥§¥à¢      ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
 ³                ³       ³                ³                ³                ³                ³                ³                ³                ³                ³                ³        2       ³       3        ³        4       ³       5        ³
 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
    end;

    private macro printString(dataSet)
[ ################       # ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
(dataSet.caseNumber,
 NVL(dataSet.riskgroup, ""),
 dataSet.column_3,
 dataSet.column_4,
 dataSet.column_5,
 dataSet.column_6,
 dataSet.column_7,
 dataSet.column_8,
 dataSet.column_9,
 dataSet.column_10,
 dataSet.column_11,
 dataSet.column_12,
 dataSet.column_13,
 dataSet.column_14,
 dataSet.column_15);
    end;

    private macro endTable(dataSet)
[ ˆ’ƒ                    ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################ ################]
(dataSet.column_3,
 dataSet.column_4,
 dataSet.column_5,
 dataSet.column_6,
 dataSet.column_7,
 dataSet.column_8,
 dataSet.column_9,
 dataSet.column_10,
 dataSet.column_11,
 dataSet.column_12,
 dataSet.column_13,
 dataSet.column_14,
 dataSet.column_15);
    end;
end;


class (TDataSourceProtocol)TUserDataSourceProtocol()
    macro printProtocol(dataSet)
        //println("Š®¯¨à®¢ ­¨¥ §­ ç¥­¨© ¯®«ì§®¢ â¥«ìáª®£® ¢¢®¤ .");
    end;
end;

class (TDataSourceProtocol) TPart4Item2DataSourceProtocol()
    initTDataSourceProtocol;

    private macro beginTable(dataSet)
        println;
        [ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ];
        [ã­ªâ 1.];
        [„ ­­ë¥ ƒŠ.];

[ÚÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³ ®¬¥à   ³        ¨¬¥­®¢ ­¨¥       ³       ®¬¥à «/á        ³  Š®«¨ç¥áâ¢®   ³    « ­á®¢ ï    ³ ’¥ªãé ï á¯à ¢¥¤«¨¢ ï ³ ‘ä®à¬¨à®¢ ­­ë© à¥§¥à¢ ¯® ³
 ³ áâà®ª¨  ³        ¤¥¯®§¨â à¨ï       ³                        ³      æ/¡      ³    áâ®¨¬®áâì    ³      áâ®¨¬®áâì       ³          2732-“          ³
 ÀÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];

    end;

    private macro printFullString(number, dataSet)
[ ######     ######################    ########################       #########  ################       ################           ################]
        (number, dataSet.name, dataSet.account, dataSet.nSecurities:0:0, dataSet.valueOfSecurities:0:0, dataSet.presentValue:0:0, dataSet.madeReserve:0:0);
    end;

    private macro printString(dataSet)
[                                      ########################       #########  ################       ################           ################]
        (dataSet.account, dataSet.nSecurities:0:0, dataSet.valueOfSecurities:0:0, dataSet.presentValue:0:0, dataSet.madeReserve:0:0);
    end;

    private macro endTable(number, dataSet)
[ ˆâ®£® ¯® áâà®ª¥ ###, ƒŠ                                             #########  ################       ################           ################]
        (number, dataSet.nSecurities:0:0, dataSet.valueOfSecurities:0:0, dataSet.presentValue:0:0, dataSet.madeReserve:0:0);
        println;
    end;

    macro printProtocol(dataSet)
        beginTable(dataSet);
        var i = 1;
        var j = 0;
        while (dataSet.moveNext())
                if (dataSet.total != 1)
                    if (j == 0)
                        printFullString(i, dataSet);
                        j = 1;
                    else
                        printString(dataSet);
                    end;
                else
                    endTable(i, dataSet);
                    i = i + 1;
                    j = 0;
                end;
        end;
        if (i == 1)
            printNullData();
        end;
    end;
end;

class (TPart4Item2DataSourceProtocol) TPart4Item2DataSourceProtocol_3468()
    initTPart4Item2DataSourceProtocol();

    private macro beginTable(dataSet)
        println;
        [ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ];
        [ã­ªâ 1.];
        [„ ­­ë¥ ƒŠ.];

[ÚÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
 ³ ®¬¥à   ³        ¨¬¥­®¢ ­¨¥       ³       ®¬¥à «/á        ³  Š®«¨ç¥áâ¢®   ³    « ­á®¢ ï    ³ ’¥ªãé ï á¯à ¢¥¤«¨¢ ï ³ ‘ä®à¬¨à®¢ ­­ë© à¥§¥à¢ ¯® ³
 ³ áâà®ª¨  ³        ¤¥¯®§¨â à¨ï       ³                        ³      æ/¡      ³    áâ®¨¬®áâì    ³      áâ®¨¬®áâì       ³          2732-“          ³
 ÀÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];

    end;
end;