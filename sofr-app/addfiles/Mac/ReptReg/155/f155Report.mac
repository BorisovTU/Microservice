/*
$Name:          f155Report.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 155. Отчет
*/


/**
 * Форма 155. Отчет.
 *
 * @since   23.09.2008
 * @author  Ivkina Olga
 * @version 6.00.020.29
 */
import f155Part;
import f155ObjectFactory;
/**
 * Отчет.
 */
class (RcbReportBase) TReport()
    /**
     * Разделы отчета.
     */
    //private var m_parts : TArray;

    /**
     * Добавить раздел к отчету.
     *
     * @param     number    номер
     * @param     name  название
     */
    macro addPart(number : Integer, name : String) : TPart
        return (m_parts(m_parts.size) = objectFactoryInstance().createPart(number, name));
    end;

    /**
     * Получить разделы.
     *
     * @param     number    номер раздела
     */
    macro getParts()
        return m_parts;
    end;

    /**
     * Получить раздел.
     *
     * @param     number    номер раздела
     */
    macro getPart(number : Integer) : TPart
        var i : Integer = 0;

        while (i < m_parts.size)
            if (m_parts[i].getNumber() == number)
                return m_parts[i];
            end;

            i = i + 1;
        end;

        return null;
    end;

    /**
     *
     */
    private macro constructor()
        initRcbReportBase(RcbApplication().currentReport, true);
       // m_parts = TArray();
    end;

    constructor();
end;

/**
 * Отчет от 2055-У.
 */
class (TReport) TReport2055()
    /**
     * Конструктор.
     */
    private macro constructor()

        initTReport();

        addPart(1, "Раздел1");
        addPart(2, "Раздел2");
        addPart(3, "Раздел3");
        addPart(4, "РазделСправочно");

        RcbApplication().TransactionManager().commit();
    end;

    constructor();
end;

/**
 * Отчет от 2835-У.
 */
class (TReport) TReport2835()
    /**
     * Добавить раздел 4 пункт 2 к отчету.
     *
     * @param     number    номер
     * @param     name  название
     */
    macro addPart4Item2(number : Integer, name : String) : TPart
        return (m_parts(m_parts.size) = objectFactoryInstance().createPart4Item2(number, name));
    end;

    /**
     * Конструктор.
     */
    private macro constructor()

        initTReport();

        addPart(1, "Раздел1");
        addPart(2, "Раздел2");
        addPart(3, "Раздел3");
        addPart(4, "РазделСправочно");
        addPart4Item2(5, "РазделСправочноПункт2");

        RcbApplication().TransactionManager().commit();
    end;

    constructor();
end;

class (TReport) TReport3129()
    /**
     * Добавить раздел 4 пункт 1 к отчету.
     *
     * @param     number    номер
     * @param     name  название
     */
    macro addPart4Item1(number : Integer, name : String) : TPart
        return (m_parts(m_parts.size) = objectFactoryInstance().createPart4Item1(number, name));
    end;

    /**
     * Конструктор.
     */
    private macro constructor()
        initTReport();

        addPart(1, "Раздел1");
        addPart(2, "Раздел2");
        addPart(3, "РазделСправочно");
        addPart4Item1(4, "РазделСправочноПункт1");

        RcbApplication().TransactionManager().commit();

    end;

    constructor();
end;

class (TReport) TReport3468()
    /**
     * Добавить раздел 4 пункт 1 к отчету.
     *
     * @param     number    номер
     * @param     name  название
     */
    macro addPart4Item1(number : Integer, name : String) : TPart
        return (m_parts(m_parts.size) = objectFactoryInstance().createPart4Item1(number, name));
    end;

    /**
     * Конструктор.
     */
    private macro constructor()
        initTReport();

        addPart(1, "Раздел1");
        addPart(2, "Раздел2");
        addPart4Item1(3, "РазделСправочноПункт1");

        RcbApplication().TransactionManager().commit();

    end;

    constructor();
end;