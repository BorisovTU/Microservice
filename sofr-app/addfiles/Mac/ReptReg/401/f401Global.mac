/*
$Name:          f401Global.mac
$Module:        Отчеты ЦБ
$Description:   Форма 401. Класс глобализмов.
*/

/**
 * Форма 401. Класс глобализмов.
 *
 * @since 06.09.2018
 * @author ABP
 * @version 6.20.031.054
 */

private class (TGlobalBase) TF401GlobalImpl()
    private var m_rcbReport : RcbReport;
    private var m_usdFiId : Integer;
    private var m_tune : Object;

    macro getRcbReport() : RcbReport
        return m_rcbReport;
    end;

    macro getPart1Id() : String
        return "1";
    end;

    macro getPart2Id() : String
        return "2";
    end;

    macro getPart31Id() : String
        return "3.1";
    end;

    macro getPart32Id() : String
        return "3.2";
    end;

    macro getUsdFiId() : Integer
        return m_usdFiId;
    end;

    macro getTune()
        return m_tune;
    end;

    private macro constructorTF401GlobalImpl()
        initTGlobalBase();
        m_rcbReport = RcbApplication().currentReport;
        initializeRepDataPackage(m_rcbReport);

        var ds = TRsbDataset("SELECT t_id FROM drepfininstrument_vw WHERE t_code = '840'");
        ds.next();
        m_usdFiId = ds.id;
        m_tune = objectFactoryInstance.createTuneTable();
    end;

    constructorTF401GlobalImpl();
end;

macro TF401Global() : TF401GlobalImpl
    if (v_global == null)
        v_global = TF401GlobalImpl();
    end;

    return v_global;
end;
