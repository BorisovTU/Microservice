/*
$Name:          f401ObjectFactory.mac
$Module:        Отчеты ЦБ
$Description:   Форма 401. Фабрика объектов.
*/

/**
 * Форма 401. Фабрика объектов.
 *
 * @since 06.09.2018
 * @author ABP
 * @version 6.20.031.054
 */
private class (RcbObjectFactoryBase) TF401ObjectFactoryImpl_4212()
    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        defaultParm(isLazy, false);
        return genObject("TF401Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if (partId == TF401Global().getPart1Id())
            return genObject("TF401Part1", partId, compositeValue);
        elif (partId == TF401Global().getPart2Id())
            return genObject("TF401Part2", partId, compositeValue);
        else
            return null;
        end;
    end;

    macro createAttribute(id : String, part : RcbPartBase, value : Object, properties : Object) : RcbAttributeBase
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributePart1", id, part, value, properties);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributePart2", id, part, value, properties);
        else
            return null;
        end;
    end;

    macro createAttributeValue(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributeValuePart1", storage);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributeValuePart2", storage);
        else
            return null;
        end;
    end;

    macro createStandaloneAttributeValue(part : RcbPartBase, nrCode : String, currencyCode : String, rowCode : String, incomeRest : Variant, turns : Variant, revaluationTurns : Variant, otherTurns : Variant, outgoingRest : Variant, interests : Variant) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401StandaloneAttributeValuePart1", nrCode, currencyCode, rowCode, incomeRest, turns, revaluationTurns, otherTurns, outgoingRest, interests);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401StandaloneAttributeValuePart2", nrCode, currencyCode, rowCode, incomeRest, turns, revaluationTurns, otherTurns, outgoingRest, interests);
        else
            return null;
        end;
    end;

    macro createAttributeProperties(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributePropertiesPart1", storage);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributePropertiesPart2", storage);
        else
            return null;
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF401DataSources_4212", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF401DataSourceFilters_4212");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF401CalculateProtocolView", protocolName);
    end;

    macro createPartCalculateController(part : RcbPartBase, reportCalculateController : RcbReportCalculateController) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401Part1CalculateController", reportCalculateController);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401Part2CalculateController", reportCalculateController);
        else
            return null;
        end;
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF401ReportCalculateController");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF401TuneTable", RCB_I4212_DATE);
    end;

    macro createPartView(id : String, reportView : RcbReportView) : RcbReportView
        if (id == TF401Global().getPart1Id())
            return genObject("TF401Part1View_4212", reportView);
        elif (id == TF401Global().getPart2Id())
            return genObject("TF401Part2View_4212", reportView);
        elif (id == TF401Global().getPart3Id())
            return genObject("TF401Part3View_4212", reportView);
        else
            return null;
        end;
    end;

    macro createReportView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF401ReportView", protocolView);
    end;

    macro createPrintProtocolView(protocolName)
        return genObject("TF401PrintProtocolView", protocolName);
    end;

    macro createReportPrintController(format : Integer) : RcbReportPrintController
        return genObject("TF401ReportPrintController_4212", format);
    end;

    macro createExportKlikoController() : RcbKlikoExportController
        return genObject("TF401ExportKlikoController");
    end;

    macro createSettingsContainer(attributeName : String)
        return genObject("TRcbSettingsContainer", attributeName);
    end;

    macro createReportRecalculateController()
        return genObject("TF401ReportRecalculateController");
    end;

    macro createNormalizationController()
        return genObject("TF401NormalizationController");
    end;

    macro createNormalizationProtocolView() : Object
        return genObject("TF401NormalizationProtocolView");
    end;

    macro createPartNormalizer(id : String, protocolView : Object, initialSheetIndex : Integer) : Object
        return genObject("TF401PartNormalizer", id, protocolView, initialSheetIndex);
    end;

    /**
     * Метод используется при создании RcbReportView
     * Данный класс генериться именно таким образом, т.к. требует инкапсуляции представления
     * шапок(подвалов) печатных форм отчета в RcbReportView
     */
    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF401PrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createNamesZone(formName : String, formOkudCode : String, formPeriodicity : String, periodFormat : Integer) : TNamesZone
        return genObject("TF401NamesZone_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPartRowsData(id : String) : Object
        if (id == TF401Global().getPart1Id())
            return genObject("TF401Part1RowsData_4212");
        elif (id == TF401Global().getPart2Id())
            return genObject("TF401Part2RowsData_4212");
        elif (id == TF401Global().getPart3Id())
            return genObject("TF401Part3RowsData_4212");
        else
            return null;
        end;
    end;

    macro createExportBiskvitController(exportMode : String, partCalculateControllersPool : Object)
        return genObject("TF401BiskvitExportController", exportMode, partCalculateControllersPool);
    end;

    private macro constructorTF401ObjectFactoryImpl_4212()
        initRcbObjectFactoryBase();
    end;

    constructorTF401ObjectFactoryImpl_4212();
end;

private class (RcbObjectFactoryBase) TF401ObjectFactoryImpl_4927()
    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        defaultParm(isLazy, false);
        return genObject("TF401Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if (partId == TF401Global().getPart1Id())
            return genObject("TF401Part1", partId, compositeValue);
        elif (partId == TF401Global().getPart2Id())
            return genObject("TF401Part2", partId, compositeValue);
        elif (partId == TF401Global().getPart31Id())
            return genObject("TF401Part3", partId, compositeValue);
        elif (partId == TF401Global().getPart32Id())
            return genObject("TF401Part3", partId, compositeValue);
        else
            return null;
        end;
    end;

    macro createAttribute(id : String, part : RcbPartBase, value : Object, properties : Object) : RcbAttributeBase
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributePart1", id, part, value, properties);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributePart2", id, part, value, properties);
        elif (part.getId() == TF401Global().getPart31Id())
            return genObject("TF401AttributePart3", id, part, value, properties);
        elif (part.getId() == TF401Global().getPart32Id())
            return genObject("TF401AttributePart3", id, part, value, properties);
        else
            return null;
        end;
    end;

    macro createAttributeValue(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributeValuePart1", storage);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributeValuePart2", storage);
        elif (part.getId() == TF401Global().getPart31Id())
            return genObject("TF401AttributeValuePart31", storage);
        elif (part.getId() == TF401Global().getPart32Id())
            return genObject("TF401AttributeValuePart32", storage);
        else
            return null;
        end;
    end;

    macro createStandaloneAttributeValue(part : RcbPartBase, nrCode : String, currencyCode : String, rowCode : String, incomeRest : Variant, turns : Variant, revaluationTurns : Variant, otherTurns : Variant, outgoingRest : Variant, interests : Variant) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401StandaloneAttributeValuePart1", nrCode, currencyCode, rowCode, incomeRest, turns, revaluationTurns, otherTurns, outgoingRest, interests);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401StandaloneAttributeValuePart2", nrCode, currencyCode, rowCode, incomeRest, turns, revaluationTurns, otherTurns, outgoingRest, interests);
        else
            return null;
        end;
    end;

    macro createAttributeProperties(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401AttributePropertiesPart1", storage);
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401AttributePropertiesPart2", storage);
        elif (part.getId() == TF401Global().getPart31Id())
            return genObject("TF401AttributePropertiesPart3", storage);
        elif (part.getId() == TF401Global().getPart32Id())
            return genObject("TF401AttributePropertiesPart3", storage);
        else
            return null;
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF401DataSources_4212", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF401DataSourceFilters_4212");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF401CalculateProtocolView", protocolName);
    end;

    macro createPartCalculateController(part : RcbPartBase, reportCalculateController : RcbReportCalculateController) : Object
        if (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401Part1CalculateController", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401Part2CalculateController", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart31Id())
            return genObject("TF401Part31CalculateController", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart32Id())
            return genObject("TF401Part32CalculateController", reportCalculateController, part.getId());
        else
            return null;
        end;
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF401ReportCalculateController");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF401TuneTable", RCB_I4212_DATE);
    end;

    macro createPartView(id : String, reportView : RcbReportView) : RcbReportView
        if (id == TF401Global().getPart1Id())
            return genObject("TF401Part1View_4927", reportView);
        elif (id == TF401Global().getPart2Id())
            return genObject("TF401Part2View_4927", reportView);
        elif (id == TF401Global().getPart31Id())
            return genObject("TF401Part31View_4927", reportView);
        elif (id == TF401Global().getPart32Id())
            return genObject("TF401Part32View_4927", reportView);
        else
            return null;
        end;
    end;

    macro createReportView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF401ReportView", protocolView);
    end;

    macro createReportExcelView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF401ExcelView", protocolView);
    end;

    macro createPrintProtocolView(protocolName)
        return genObject("TF401PrintProtocolView", protocolName);
    end;

    macro createReportPrintController(format : Integer) : RcbReportPrintController
        return genObject("TF401ReportPrintController_4927", format);
    end;

    macro createExportKlikoController() : RcbKlikoExportController
        return genObject("TF401ExportKlikoController_4927");
    end;

    macro createSettingsContainer(attributeName : String)
        return genObject("TRcbSettingsContainer", attributeName);
    end;

    macro createReportRecalculateController()
        return genObject("TF401ReportRecalculateController");
    end;

    macro createNormalizationController()
        return genObject("TF401NormalizationController");
    end;

    macro createNormalizationProtocolView() : Object
        return genObject("TF401NormalizationProtocolView");
    end;

    macro createPartNormalizer(id : String, protocolView : Object, initialSheetIndex : Integer) : Object
        if (id == TF401Global().getPart1Id())
            return genObject("TF401Part12Normalizer", id, protocolView, initialSheetIndex);
        elif (id == TF401Global().getPart2Id())
            return genObject("TF401Part12Normalizer", id, protocolView, initialSheetIndex);
        elif (id == TF401Global().getPart31Id())
            return genObject("TF401Part3Normalizer", id, protocolView, initialSheetIndex);
        elif (id == TF401Global().getPart32Id())
            return genObject("TF401Part3Normalizer", id, protocolView, initialSheetIndex);
        else
            return null;
        end;
    end;

    /**
     * Метод используется при создании RcbReportView
     * Данный класс генериться именно таким образом, т.к. требует инкапсуляции представления
     * шапок(подвалов) печатных форм отчета в RcbReportView
     */
    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF401PrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createNamesZone(formName : String, formOkudCode : String, formPeriodicity : Variant, periodFormat : Integer) : TNamesZone
        return genObject("TF401NamesZone_4927", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPartRowsData(id : String) : Object
        if (id == TF401Global().getPart1Id())
            return genObject("TF401Part1RowsData_4927");
        elif (id == TF401Global().getPart2Id())
            return genObject("TF401Part2RowsData_4927");
        elif (id == TF401Global().getPart31Id())
            return genObject("TF401Part31RowsData_4927");
        elif (id == TF401Global().getPart32Id())
            return genObject("TF401Part32RowsData_4927");
        else
            return null;
        end;
    end;

    macro createExportBiskvitExactController(partCalculateControllersPool : Object)
        return genObject("TF401BiskvitExactExportController", partCalculateControllersPool);
    end;

    macro createExportBiskvitScaledController(partCalculateControllersPool : Object)
        return genObject("TF401BiskvitScaledExportController", partCalculateControllersPool);
    end;

    private macro constructorTF401ObjectFactoryImpl_4927()
        initRcbObjectFactoryBase();
    end;

    constructorTF401ObjectFactoryImpl_4927();
end;

private class (TF401ObjectFactoryImpl_4927) TF401ObjectFactoryImpl_16_MP()
    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF401DataSources_16_MP", protocolView);
    end;

    macro createPartCalculateController(part : RcbPartBase, reportCalculateController : RcbReportCalculateController) : Object
        if   (part.getId() == TF401Global().getPart1Id())
            return genObject("TF401Part1CalculateController_16_MP", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart2Id())
            return genObject("TF401Part2CalculateController_16_MP", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart31Id())
            return genObject("TF401Part31CalculateController", reportCalculateController, part.getId());
        elif (part.getId() == TF401Global().getPart32Id())
            return genObject("TF401Part32CalculateController", reportCalculateController, part.getId());
        else
            return null;
        end;
    end;

    private macro constructorTF401ObjectFactoryImpl_16_MP()
        initTF401ObjectFactoryImpl_4927();
    end;

    constructorTF401ObjectFactoryImpl_16_MP();
end;

if (objectFactoryInstance == null)
    if   (RcbApplication().currentReport.context.period.endDate >= RCB_I16_MP_DATE)
        objectFactoryInstance = TF401ObjectFactoryImpl_16_MP();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4927_DATE)
        objectFactoryInstance = TF401ObjectFactoryImpl_4927();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TF401ObjectFactoryImpl_4212();
    else
        objectFactoryInstance = null;
    end;
end;
