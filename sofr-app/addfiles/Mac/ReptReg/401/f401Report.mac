/*
$Name:          f401Report.mac
$Module:        Отчеты ЦБ
$Description:   Форма 401. Класс отчета.
*/

/**
 * Форма 401. Отчет.
 *
 * @since 12.10.2018
 * @author ABP
 * @version 6.20.031.054
 */
class (RcbReportBase) TF401Report(report : RcbReport, isLazy : Bool)
    private macro initialize()
        addPart(TF401Global().getPart1Id(), getRcbReport().attributeValue("Раздел_1_по_4212У")).initialize();
        addPart(TF401Global().getPart2Id(), getRcbReport().attributeValue("Раздел_2_по_4212У")).initialize();
        addPart(TF401Global().getPart31Id(), getRcbReport().attributeValue("Подраздел_3.1_по_4927У")).initialize();
        addPart(TF401Global().getPart32Id(), getRcbReport().attributeValue("Подраздел_3.2_по_4927У")).initialize();
    end;

    macro isEmpty()
        m_parts.moveFirst();
        while (m_parts.moveNext())
            if (not m_parts.getCurrentItem().isEmpty())
                return false;
            end;
        end;

        return true;
    end;

    private macro constructorTF401Report(report : RcbReport, isLazy : Bool)
        initRcbReportBase(report, isLazy);
    end;

    constructorTF401Report(report, isLazy);
end;
