/*
$Name:          appl8PrintController.mac
$Module:        Регламентируемая отчетность
$Description:   Класс контроллера печати отчетной формы для приложения 8.
*/

/**
 * Контроллер печати приложения 8
 *
 * @since   05.08.2013
 * @author  Konofeev R.R.
 * @version 6.020.31
 *
 */

import balanceObjectFactory;
import appl8ReportView;
import prnfrm;


class TApplication8PrintController(chapter: Integer)

    private var m_chapter;
    private var m_view;

    macro execute()
        m_view.setOutputFile();

        var i = 1;

        if (m_chapter == 0)
            // Печать по всем главам
            m_view.printTemplate(1, TRUE,  TRUE,  FALSE);  /* note: глава А */
            m_view.printTemplate(2, FALSE, FALSE, FALSE);  /* note: глава Б */
            m_view.printTemplate(3, FALSE, FALSE, FALSE);  /* note: глава В */
            m_view.printTemplate(4, FALSE, FALSE, FALSE);  /* note: глава Г */
            m_view.printTemplate(5, FALSE, FALSE, TRUE);  /* note: глава Д */
        else
            m_view.printTemplate(m_chapter, TRUE, FALSE, TRUE);
        end;

        m_view.show();
        m_view.resetOutputFile();
    end;

    macro constructorTApplicaion8PrintController(chapter)
        m_chapter = chapter;
        m_view    = objectFactoryInstance.createApplication8ReportView(chapter);
    end;

    constructorTApplicaion8PrintController(chapter);
end;

class TApplication6PrintController(chapter: Integer)

    private var m_chapter;
    private var m_view;

    macro execute()
        m_view.setOutputFile();

        var i = 1;

        if (m_chapter == 0)
            // Печать по всем главам
            m_view.printTemplate(1, TRUE,  TRUE,  FALSE);  /* note: глава А */
            m_view.printTemplate(2, FALSE, FALSE, FALSE);  /* note: глава Б */
            m_view.printTemplate(3, FALSE, FALSE, FALSE);  /* note: глава В */
            m_view.printTemplate(4, FALSE, FALSE, TRUE);  /* note: глава Г */
        else
            m_view.printTemplate(m_chapter, TRUE, FALSE, TRUE);
        end;

        m_view.show();
        m_view.resetOutputFile();
    end;

    macro constructorTApplicaion6PrintController(chapter)
        m_chapter = chapter;
        m_view    = objectFactoryInstance.createApplication6ReportView(chapter);
    end;

    constructorTApplicaion6PrintController(chapter);
end;

OnError(err);
if (err.Code == 17)
    runError("Печать отчета прервана пользователем.");
else
    RunError();
end;

Exit(1);
