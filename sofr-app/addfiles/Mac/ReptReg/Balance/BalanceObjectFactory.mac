/*
$Name:        balanceObjectFactory.mac
$Module:      Регламентируемая отчетность
$Description: Форма Балансовые счета. Фабрика объектов отчетной формы
*/

import rcbconst;
import RcbObjectFactoryBase;
import BalanceGlobal;

/**
 * Форма Балансовый отчет. фабрика объектов отчетной формы.
 *
 * @since
 * @author  gww
 * @version 6.00.020.31
 */
class (RcbObjectFactoryBase) TBalanceObjectFactory()
    initRcbObjectFactoryBase();

    macro createBalanceDataSource(chapter)
        return genObject("TBalanceDataSource", chapter);
    end;

    macro createCalculateProtocolView(reportName, protocolName) /*: RcbCalculateProtocolView*/
        return genObject("TBalanceCalculateProtocolView", reportName, protocolName);
    end;

    macro createReportCalculateController(chapter) /*: RcbReportCalculateController*/
        return genObject("TBalanceReportCalculateController", chapter);
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TBalancePrintProtocolView", protocolName);
    end;

    macro createReportPrintController(chapter, report) /*: RcbReportPrintController*/
        return genObject("TBalancePrintController", chapter, report);
    end;

    macro createApplication7ReportView(withSpod, chapter, needCheck)
        return genObject("TApplication7ReportView", withSpod, chapter, needCheck);
    end;

    macro createApplication8PrintController(chapter: Integer)
        return genObject("TApplication8PrintController", chapter);
    end;

    macro createApplication8ReportView(chapter)
        return genObject("TApplication8ReportView", chapter);
    end;

    macro createApplication13ReportView()
        return genObject("TApplication13ReportView");
    end;

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController", isOnlyAppl8);
    end;

    macro createAppl13CalculationController(isOnlyAppl13)
        return genObject("TApplication13CalculateController", isOnlyAppl13);
    end;

    macro createF101ReportView()
        return genObject("TF101ReportView");
    end;

    macro createF101ReportViewExcel()
        return genObject("TF101ReportViewExcel");
    end;

    /**
     * Экспорт в программу kliko.
     *
     * @param isDaily Признак "Ежедневно". Иначе, если FALSE, то ежемесячно.
     * @param chapter Номер главы.
     */
    macro createKlikoExportController(isDaily: Bool, chapter: String) /*: TKlikoExportController*/
        return genObject("TBalanceKlikoExportController", isDaily, chapter);
    end;

    macro createPtkPsdExportController(dayly, chapter) /*: TKlikoExportController*/
        return genObject("TBalancePtkPsdExportController"/*, dayly, chapter*/);
    end;

    macro createPtkPsdImportController()
        return genObject("TBalancePtkPsdImportController");
    end;

    /**
     * Импорт из файла обмена kliko.
     *
     * @param isDaily Признак "Ежедневно". Иначе, если FALSE, то ежемесячно.
     * @param chapter Номер главы.
     */
    macro createKlikoImportController(isDaily: Bool, chapter: String)
        return genObject("TBalanceKlikoImportController", isDaily, chapter);
    end;

    macro createXmlExportController(chapter : Integer, periodicity : Integer)
        return genObject("TBalanceXmlExportControllerBase", chapter, periodicity);
    end;

    macro createReCalculationController() /*: Пересчет после свода*/
        return genObject("TReCalculationController");
    end;

    macro createNormalizerParametersReader()
        return genObject("TNormalizerParametersReader");
    end;

    macro createPrintControllerApplication(chapter, report)
        return genObject("TPrintControllerApplication", chapter, report);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_3134()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_3134", isOnlyAppl8);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_3659_D1()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_3659_D1", isOnlyAppl8);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_3659_D2()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_3659_D2", isOnlyAppl8);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_3846()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_3846", isOnlyAppl8);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_4065_5()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_4065", isOnlyAppl8);
    end;
end;

class (TBalanceObjectFactory) TBalanceObjectFactory_4065()
    initTBalanceObjectFactory();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication8CalculateController_4065", isOnlyAppl8);
    end;

    macro createApplication13ReportView(isOnlyAppl8)
        return genObject("TApplication13ReportView_4065");
    end;

    macro createApplication8ReportView(chapter)
        return genObject("TApplication8ReportView_4065", chapter);
    end;
end;

class (TBalanceObjectFactory_4065) TBalanceObjectFactory_4212()
    initTBalanceObjectFactory_4065();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF101PrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPrintControllerApplication(chapter, report)
        return genObject("TPrintControllerApplication_4212", chapter, report);
    end;

    macro createF101ReportViewExcel()
        return genObject("TF101ReportViewExcel_4212");
    end;

    macro createF101ReportView()
        return genObject("TF101ReportView_4212");
    end;
end;

class (TBalanceObjectFactory_4212) TBalanceObjectFactory_Т1_30_1_01_36162()
    initTBalanceObjectFactory_4212();

    macro createXmlExportController(chapter : Integer, periodicity : Integer)
        return genObject("TBalanceKlikoExportController_Т1_30_1_01_36162", chapter, periodicity);
    end;
end;

class (TBalanceObjectFactory_Т1_30_1_01_36162) TBalanceObjectFactory_579()
    initTBalanceObjectFactory_Т1_30_1_01_36162();

    macro createAppl8CalculationController(isOnlyAppl8)
        return genObject("TApplication6CalculateController_579", isOnlyAppl8);
    end;

    macro createAppl13CalculationController(isOnlyAppl13)
        return genObject("TApplication11CalculateController_579", isOnlyAppl13);
    end;

    macro createAppl6CalculationController(isOnlyAppl6)
        return genObject("TApplication6CalculateController_579", isOnlyAppl6);
    end;

    macro createAppl11CalculationController(isOnlyAppl11)
        return genObject("TApplication11CalculateController_579", isOnlyAppl11);
    end;

    macro createApplication6PrintController(chapter: Integer)
        return genObject("TApplication6PrintController", chapter);
    end;

    macro createApplication6ReportView(chapter)
        return genObject("TApplication6ReportView_579", chapter);
    end;

    macro createApplication11ReportView(isOnlyAppl8)
        return genObject("TApplication11ReportView_579");
    end;

    macro createApplication5ReportView(withSpod, chapter, needCheck)
        return genObject("TApplication5ReportView_579", withSpod, chapter, needCheck);
    end;
end;

class (TBalanceObjectFactory_579) TBalanceObjectFactory_4637()
    initTBalanceObjectFactory_579();

    macro createPrintControllerApplication(chapter, report)
        return genObject("TPrintControllerApplication_4637", chapter, report);
    end;

    macro createF101ReportView()
        return genObject("TF101ReportView_4637");
    end;

    macro createF101ReportViewExcel()
        return genObject("TF101ReportViewExcel_4637");
    end;
end;

class (TBalanceObjectFactory_4637) TBalanceObjectFactory_Т1_77_01_02_9039()
    initTBalanceObjectFactory_4637();

    macro createKlikoExportController(isDaily: Bool, chapter: String) /*: TKlikoExportController*/
        return genObject("TBalanceKlikoExportController_Т1_77_01_02_9039", isDaily, chapter);
    end;
end;
/**
 * Точка доступа к объекту-одиночке TObjectFactory()
 */
if (objectFactoryInstance == null)
    if   (RcbApplication().currentReport.context.period.endDate >= RCB_Т1_77_01_02_9039_DATE)
        objectFactoryInstance = TBalanceObjectFactory_Т1_77_01_02_9039();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE)
        objectFactoryInstance = TBalanceObjectFactory_4637();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I579_DATE)
        objectFactoryInstance = TBalanceObjectFactory_579();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_Т1_30_1_01_36162_DATE)
        objectFactoryInstance = TBalanceObjectFactory_Т1_30_1_01_36162();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TBalanceObjectFactory_4212();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4065_DATE)
        objectFactoryInstance = TBalanceObjectFactory_4065();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4065_DATE5)
        objectFactoryInstance = TBalanceObjectFactory_4065_5();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3846_DATE)
        objectFactoryInstance = TBalanceObjectFactory_3846();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3659_DATE2)
        objectFactoryInstance = TBalanceObjectFactory_3659_D2();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3659_DATE1)
        objectFactoryInstance = TBalanceObjectFactory_3659_D1();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3134_DATE)
        objectFactoryInstance = TBalanceObjectFactory_3134();
    else
        objectFactoryInstance = TBalanceObjectFactory();
    end;
end;
