/*
$Name:          appl13ReportView.mac
$Module:        Регламентируемая отчетность
$Description:   Класс представления отчетной формы для приложения 13.
*/

import rcbimport;
import balanceAttribute;
import balanceReportParameters;

/**
 * Класс представления отчетной формы.
 */
class (RcbReportView) TApplication13ReportView()
    private var m_tableReport;
    private var reportWidth;
    private var m_planNumber;

    private macro constructorTApplication13ReportView()
        initRcbReportView("",
                          "a13",
                          RCB_PK_PERIOD,
                          DATE_IN_PERIOD_FORMAT
                         );


        m_tableReport = CTableReport(1, false, false);

        m_tableReport.addColumn( "", 20, AL_LEFT );    /* Номер счета первого порядка */
        m_tableReport.addColumn( "", 5,  AL_RIGHT  );    /* Номер счета второго порядка */
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Входящие остатки на 1 января нового года в рублях*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Входящие остатки на 1 января нового года в валюте*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Входящие остатки на 1 января нового года Итого*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по дебету в рублях*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по дебету в валюте*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по дебету Итого*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по кредиту в рублях*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по кредиту в валюте*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Обороты по отражению событий после отчетной даты (СПОД) по кредиту Итого*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Исходящие остатки с учетом событий после отчетной даты (СПОД) в рублях*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Исходящие остатки с учетом событий после отчетной даты (СПОД) в валюте*/
        m_tableReport.addColumn( "", 16, AL_RIGHT );    /* Исходящие остатки с учетом событий после отчетной даты (СПОД) Итого*/


        reportWidth = m_tableReport.getSumLen();
        setReportWidth(reportWidth);

        m_planNumber = balanceParameters().getPlanNumber();

    end;

    macro printTableBottom()
        m_tableReport.printBottom();
        println();
    end;

    macro printFreeString(str)
        m_tableReport.printFreeString(str);
    end;

    macro printNamesZone()
    end;

    macro printLendingAgencyCodeZone()
        /*_____________________________________________________________________________________*/
        var bankName = TArray();
        var i;
        /*_____________________________________________________________________________________*/

        [#]( strAlign( "                           Приложение 13   ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " к Правилам ведения бухгалтерского учета   ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " в кредитных организациях, расположенных   ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " на территории Российской Федерации        ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( "                                           ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " (Приложение к Положению Банка России      ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " от 16 июля 2012 года N 385-П              ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( "\"О правилах ведения бухгалтерского учета  ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " в кредитных организациях, расположенных   ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( "на территории Российской Федерации\")      ", ReportWidth, STR_ALIGN_RIGHT ));
        [ ];

        /*________________________________________________________________________________________*/
        PrintBankHeaderBuf(НомерПодразделения,
                     RcbOrganizationStructure,
                                 ReportWidth,
                                     bankName,
                                            0);

        i = 0;
        while(i < bankName.Size())
          [#](trim(bankName[i]));
          i = i+1;
        end;

        [#]("(полное или сокращенное фирменное наименование кредитной организации)");

        [ ];
        /*________________________________________________________________________________________*/
        var periodName = RcbReportView("", "", RcbArray().initialize(RCB_PK_DAY, RCB_PK_MONTH, RCB_PK_QUARTER, RCB_PK_HALFYEAR, RCB_PK_PERIOD), DATE_IN_PERIOD_FORMAT).getNamesZone().getPeriodName();

        [#]( strAlign( "Сводная ведомость оборотов по отражению", ReportWidth, STR_ALIGN_CENTER ) );
        [#]( strAlign( "событий после отчетной даты", ReportWidth, STR_ALIGN_CENTER ) );
        [#]( strAlign( periodName, ReportWidth, STR_ALIGN_CENTER ) );
    end;

    macro printSignatureZone()
        m_tableReport.printFreeString("");
        m_tableReport.printFreeString({Name_Boss} + " _____________________ " + {FIO_Boss} + "\t" +
                                      {Name_Book} + " _____________________ " + {FIO_Book} );
    end;

    macro printTableHeader()
    end;

    macro printChapterHeader(chapterName : String)
        var currentBeginPos = 1;
        var currentEndPos;
        var limit = StrLen(chapterName);
        var correction = 1;

        while (currentBeginPos <= limit)
            currentEndPos = StrBrk(substr(chapterName, currentBeginPos), "\n");
            if (currentEndPos == 0)
                currentEndPos = StrLen(substr(chapterName, currentBeginPos));
                correction = 0;
            end;
            PrintLn(strAlign(substr(chapterName, currentBeginPos, currentEndPos - correction), ReportWidth, STR_ALIGN_CENTER));
            currentBeginPos = currentBeginPos + currentEndPos;
        end;

        [ ┌──────────────────────────────┬────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┐];
        [ │                              │                                                        │                             Обороты по отражению событий после отчетной даты (СПОД)                             │           Исходящие остатки с учетом событий           │];
        [ │         Номер счета          │        Входящие остатки на 1 января нового года        ├────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┤               после отчетной даты (СПОД)               │];
        [ │                              │                                                        │                       по дебету                        │                        по кредиту                      │                                                        │];
        [ ├──────────────────────┬───────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┤];
        [ │   первого порядка    │второго│     в рублях     │   иностранная    │       итого      │     в рублях     │   иностранная    │       итого      │     в рублях     │   иностранная    │      итого       │     в рублях     │   иностранная    │      итого       │];
        [ │                      │порядка│                  │      валюта      │                  │                  │      валюта      │                  │                  │      валюта      │                  │                  │      валюта      │                  │];
        [ │                      │       │                  │    в рублевом    │                  │                  │    в рублевом    │                  │                  │    в рублевом    │                  │                  │    в рублевом    │                  │];
        [ │                      │       │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │];
        [ ├──────────────────────┼───────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
        [ │         1            │   2   │         3        │         4        │         5        │         6        │         7        │         8        │         9        │        10        │        11        │         12       │         13       │         14       │];
        [ ├──────────────────────┼───────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
    end;

    macro printSeparator()

    end;

    macro printTableString(balanceOrder, balance, _inR, _inV, _inItog, _dtRub, _dtCur, _dtItog, _ktRub, _ktCur, _ktItog, _outR, _outV, _outItog)
        var balance1, balance2;

        if (balanceOrder == 1)
            m_tableReport.PrintStringTransferByWord("ИТОГО по счету первого порядка:");
            balance1 = balance;
            balance2 = "";
        else
            m_tableReport.PrintStringTransferByWord("ИТОГО по счету второго порядка:");
            balance1 = "";
            balance2 = balance;
        end;

        m_tableReport.PrintStringTransferByWord(balance1, balance2, _inR, _inV, _inItog, _dtRub, _dtCur, _dtItog, _ktRub, _ktCur, _ktItog, _outR, _outV, _outItog);
        printSeparator();
    end;

    macro printItog(nameItog, _inR, _inV, _inItog, _dtRub, _dtCur, _dtItog, _ktRub, _ktCur, _ktItog, _outR, _outV, _outItog)
        m_tableReport.PrintStringTransferByWord(nameItog);
        m_tableReport.PrintStringTransferByWord("", "", _inR, _inV, _inItog, _dtRub, _dtCur, _dtItog, _ktRub, _ktCur, _ktItog, _outR, _outV, _outItog);
        printSeparator();
    end;

    macro printKindHeader(kind)
        m_tableReport.PrintStringTransferByWord(kind);
        m_tableReport.PrintStringTransferByWord("");
    end;

    macro getValue(value)
        if (value == NULL)
            return 0;
        end;

        return value.exact;
    end;

    macro printChapter(chapter : Integer, chapterName : String)
        var av = TApplication13Attribute("ПРИЛОЖЕНИЕ13");
        var currentPart : Integer;
        var sIn, sInR, sInV, sD, sDr, sDv, sK, sKr, sKv, sOut, sOutR, sOutV;
        var sPartIn, sPartInR, sPartInV, sPartD, sPartDr, sPartDv, sPartK, sPartKr, sPartKv, sPartOut, sPartOutR, sPartOutV;
        var sKindIn, sKindInR, sKindInV, sKindD, sKindDr, sKindDv, sKindK, sKindKr, sKindKv, sKindOut, sKindOutR, sKindOutV;
        var curIn, curInR, curInV, curD, curDr, curDv, curK, curKr, curKv, curOut, curOutR, curOutV;
        var balanceOrder;
        var onlyBwp = false;
        var onlyNonZero = false;
        var currentFirstBalance;
        var balance;

        printChapterHeader(chapterName);

        if (balanceParameters().getPrintFormBalance() == 1)
            onlyBwp = true;
        elif(balanceParameters().getPrintFormBalance() == 2)
            onlyNonZero = true;
        end;

        av.createBalanceIterator(chapter, KIND_ACTIVE, false, onlyNonZero, onlyBwp);
        av.sortIteratorByBalance();

        sIn = 0; sInR = 0; sInV = 0; sD = 0; sDr = 0; sDv = 0; sK = 0; sKr = 0; sKv = 0; sOut = 0; sOutR = 0; sOutV = 0;
        sKindIn = 0; sKindInR = 0; sKindInV = 0; sKindD = 0; sKindDr = 0; sKindDv = 0; sKindK = 0; sKindKr = 0; sKindKv = 0; sKindOut = 0; sKindOutR = 0;sKindOutV = 0;
        sPartIn = 0; sPartInR = 0; sPartInV = 0; sPartD = 0; sPartDr = 0; sPartDv = 0; sPartK = 0; sPartKr = 0; sPartKv = 0; sPartOut = 0; sPartOutR = 0; sPartOutV = 0;
        currentPart = 0;
        currentFirstBalance = "";

        printKindHeader("Актив");
        while (av.next())
            curInR  = getValue(av.getRestInNatCur());
            curInV  = getValue(av.getRestInCur());
            curIn   = getValue(av.getRestIn());
            curDr   = getValue(av.getDebetNatCur());
            curDv   = getValue(av.getDebetCur());
            curD    = getValue(av.getDebet());
            curKr   = getValue(av.getCreditNatCur());
            curKv   = getValue(av.getCreditCur());
            curK    = getValue(av.getCredit());
            curOutR = getValue(av.getRestOutNatCur());
            curOutV = getValue(av.getRestOutCur());
            curOut  = getValue(av.getRestOut());
            balance = av.getBalance();

            if (SubStr(balance, 1, 3) != currentFirstBalance)
                if (currentFirstBalance != "")
                    printTableString(1, currentFirstBalance, sInR, sInV, sIn, sDr, sDv, sD, sKr, sKv, sK, sOutR, sOutV, sOut);
                    sIn = 0; sInR = 0; sInV = 0; sD = 0; sDr = 0; sDv = 0; sK = 0; sKr = 0; sKv = 0; sOut = 0; sOutR = 0; sOutV = 0;
                end;

                currentFirstBalance = SubStr(balance, 1, 3);
            end;

            if (av.getPart().exact != currentPart)
                if (currentPart > 0)
                    printItog("ИТОГО по разделу " + currentPart, sPartInR, sPartInV, sPartIn, sPartDr, sPartDv,  sPartD, sPartKr, sPartKv, sPartK, sPartOutR, sPartOutV, sPartOut);
                end;

                currentPart = av.getPart().exact;
                printSeparator();
                sPartInR = 0; sPartInV = 0; sPartIn = 0; sPartD = 0; sPartDr = 0; sPartDv = 0; sPartK = 0; sPartKr = 0; sPartKv = 0; sPartOutR = 0; sPartOutV = 0; sPartOut = 0;
            end;

            printTableString(2, balance, curInR, curInV, curIn, curDr, curDv, curD, curKr, curKv, curK, curOutR, curOutV, curOut);

            sInR  = sInR  + curInR;
            sInV  = sInV  + curInV;
            sIn  = sIn  + curIn;
            sDr  = sDr  + curDr;
            sDv  = sDv  + curDv;
            sD   = sD   + curD;
            sKr  = sKr  + curKr;
            sKv  = sKv  + curKv;
            sK   = sK   + curK;
            sOutR = sOutR + curOutR;
            sOutV = sOutV + curOutV;
            sOut = sOut + curOut;

            sKindInR  = sKindInR  + curInR;
            sKindInV  = sKindInV  + curInV;
            sKindIn  = sKindIn  + curIn;
            sKindDr  = sKindDr  + curDr;
            sKindDv  = sKindDv  + curDv;
            sKindD   = sKindD   + curD;
            sKindKr  = sKindKr  + curKr;
            sKindKv  = sKindKv  + curKv;
            sKindK   = sKindK   + curK;
            sKindOutR = sKindOutR + curOutR;
            sKindOutV = sKindOutV + curOutV;
            sKindOut = sKindOut + curOut;

            sPartInR  = sPartInR  + curInR;
            sPartInV  = sPartInV  + curInV;
            sPartIn  = sPartIn  + curIn;
            sPartDr  = sPartDr  + curDr;
            sPartDv  = sPartDv  + curDv;
            sPartD   = sPartD   + curD;
            sPartKr  = sPartKr  + curKr;
            sPartKv  = sPartKv  + curKv;
            sPartK   = sPartK   + curK;
            sPartOutR = sPartOutR + curOutR;
            sPartOutV = sPartOutV + curOutV;
            sPartOut = sPartOut + curOut;
        end;

        if (currentFirstBalance != "")
            printTableString(1, currentFirstBalance, sInR, sInV, sIn, sDr, sDv, sD, sKr, sKv, sK, sOutR, sOutV, sOut);
        end;

        if (currentPart > 0)
            printItog("ИТОГО по разделу " + currentPart, sPartInR, sPartInV, sPartIn, sPartDr, sPartDv,  sPartD, sPartKr, sPartKv, sPartK, sPartOutR, sPartOutV, sPartOut);
        end;

        printItog("ИТОГО по активу: ", sKindInR, sKindInV, sKindIn, sKindDr, sKindDv,  sKindD, sKindKr, sKindKv, sKindK, sKindOutR, sKindOutV, sKindOut);

        av.createBalanceIterator(chapter, KIND_PASSIVE, false, onlyNonZero, onlyBwp);
        av.sortIteratorByBalance();

        sIn = 0; sInR = 0; sInV = 0; sD = 0; sDr = 0; sDv = 0; sK = 0; sKr = 0; sKv = 0; sOut = 0; sOutR = 0; sOutV = 0;
        sKindIn = 0; sKindInR = 0; sKindInV = 0; sKindD = 0; sKindDr = 0; sKindDv = 0; sKindK = 0; sKindKr = 0; sKindKv = 0; sKindOut = 0; sKindOutR = 0;sKindOutV = 0;
        sPartIn = 0; sPartInR = 0; sPartInV = 0; sPartD = 0; sPartDr = 0; sPartDv = 0; sPartK = 0; sPartKr = 0; sPartKv = 0; sPartOut = 0; sPartOutR = 0; sPartOutV = 0;
        currentPart = 0;
        currentFirstBalance = "";

        printKindHeader("Пассив");
        while (av.next())
            curInR  = getValue(av.getRestInNatCur());
            curInV  = getValue(av.getRestInCur());
            curIn   = getValue(av.getRestIn());
            curDr   = getValue(av.getDebetNatCur());
            curDv   = getValue(av.getDebetCur());
            curD    = getValue(av.getDebet());
            curKr   = getValue(av.getCreditNatCur());
            curKv   = getValue(av.getCreditCur());
            curK    = getValue(av.getCredit());
            curOutR = getValue(av.getRestOutNatCur());
            curOutV = getValue(av.getRestOutCur());
            curOut  = getValue(av.getRestOut());
            balance = av.getBalance();

            if (SubStr(balance, 1, 3) != currentFirstBalance)
                if (currentFirstBalance != "")
                    printTableString(1, currentFirstBalance, sInR, sInV, sIn, sDr, sDv, sD, sKr, sKv, sK, sOutR, sOutV, sOut);
                    sIn = 0; sInR = 0; sInV = 0; sD = 0; sDr = 0; sDv = 0; sK = 0; sKr = 0; sKv = 0; sOut = 0; sOutR = 0; sOutV = 0;
                end;

                currentFirstBalance = SubStr(balance, 1, 3);
            end;

            if (av.getPart().exact != currentPart)
                if (currentPart > 0)
                    printItog("ИТОГО по разделу " + currentPart, sPartInR, sPartInV, sPartIn, sPartDr, sPartDv,  sPartD, sPartKr, sPartKv, sPartK, sPartOutR, sPartOutV, sPartOut);
                end;

                currentPart = av.getPart().exact;
                printSeparator();
                sPartInR = 0; sPartInV = 0; sPartIn = 0; sPartD = 0; sPartDr = 0; sPartDv = 0; sPartK = 0; sPartKr = 0; sPartKv = 0; sPartOutR = 0; sPartOutV = 0; sPartOut = 0;
            end;

            printTableString(2, balance, curInR, curInV, curIn, curDr, curDv, curD, curKr, curKv, curK, curOutR, curOutV, curOut);

            sInR  = sInR  + curInR;
            sInV  = sInV  + curInV;
            sIn  = sIn  + curIn;
            sDr  = sDr  + curDr;
            sDv  = sDv  + curDv;
            sD   = sD   + curD;
            sKr  = sKr  + curKr;
            sKv  = sKv  + curKv;
            sK   = sK   + curK;
            sOutR = sOutR + curOutR;
            sOutV = sOutV + curOutV;
            sOut = sOut + curOut;

            sKindInR  = sKindInR  + curInR;
            sKindInV  = sKindInV  + curInV;
            sKindIn  = sKindIn  + curIn;
            sKindDr  = sKindDr  + curDr;
            sKindDv  = sKindDv  + curDv;
            sKindD   = sKindD   + curD;
            sKindKr  = sKindKr  + curKr;
            sKindKv  = sKindKv  + curKv;
            sKindK   = sKindK   + curK;
            sKindOutR = sKindOutR + curOutR;
            sKindOutV = sKindOutV + curOutV;
            sKindOut = sKindOut + curOut;

            sPartInR  = sPartInR  + curInR;
            sPartInV  = sPartInV  + curInV;
            sPartIn  = sPartIn  + curIn;
            sPartDr  = sPartDr  + curDr;
            sPartDv  = sPartDv  + curDv;
            sPartD   = sPartD   + curD;
            sPartKr  = sPartKr  + curKr;
            sPartKv  = sPartKv  + curKv;
            sPartK   = sPartK   + curK;
            sPartOutR = sPartOutR + curOutR;
            sPartOutV = sPartOutV + curOutV;
            sPartOut = sPartOut + curOut;

        end;

        if (currentFirstBalance != "")
            printTableString(1, currentFirstBalance, sInR, sInV, sIn, sDr, sDv, sD, sKr, sKv, sK, sOutR, sOutV, sOut);
        end;

        if (currentPart > 0)
            printItog("ИТОГО по разделу " + currentPart, sPartInR, sPartInV, sPartIn, sPartDr, sPartDv,  sPartD, sPartKr, sPartKv, sPartK, sPartOutR, sPartOutV, sPartOut);
        end;

        printItog("ИТОГО по пассиву: ", sKindInR, sKindInV, sKindIn, sKindDr, sKindDv,  sKindD, sKindKr, sKindKv, sKindK, sKindOutR, sKindOutV, sKindOut);

        if (chapter != 5)
            m_tableReport.PrintBottom();
        end;
    end;

    constructorTApplication13ReportView();
end;

class (TApplication13ReportView) TApplication13ReportView_4065()
    InitTApplication13ReportView();

    macro printChapterHeader(chapterName : String)
        var currentBeginPos = 1;
        var currentEndPos;
        var limit = StrLen(chapterName);
        var correction = 1;

        while (currentBeginPos <= limit)
            currentEndPos = StrBrk(substr(chapterName, currentBeginPos), "\n");
            if (currentEndPos == 0)
                currentEndPos = StrLen(substr(chapterName, currentBeginPos));
                correction = 0;
            end;
            PrintLn(strAlign(substr(chapterName, currentBeginPos, currentEndPos - correction), ReportWidth, STR_ALIGN_CENTER));
            currentBeginPos = currentBeginPos + currentEndPos;
        end;

        [ ┌──────────────────────────────┬────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┐];
        [ │                              │            Исходящие остатки за 31 декабря             │                             Обороты по отражению событий после отчетной даты (СПОД)                             │            Исходящие остатки за 31 декабря             │];
        [ │         Номер счета          │      без учета событий после отчетной даты (СПОД)      ├────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┤      с учетом событий после отчетной даты (СПОД)       │];
        [ │                              │                                                        │                       по дебету                        │                       по кредиту                       │                                                        │];
        [ ├──────────────────────┬───────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┼──────────────────┬──────────────────┬──────────────────┤];
        [ │   первого порядка    │второго│     в рублях     │   иностранная    │       итого      │     в рублях     │   иностранная    │       итого      │     в рублях     │   иностранная    │       итого      │     в рублях     │   иностранная    │       итого      │];
        [ │                      │порядка│                  │      валюта      │                  │                  │      валюта      │                  │                  │      валюта      │                  │                  │      валюта      │                  │];
        [ │                      │       │                  │    в рублевом    │                  │                  │    в рублевом    │                  │                  │    в рублевом    │                  │                  │    в рублевом    │                  │];
        [ │                      │       │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │                  │   эквиваленте    │                  │];
        [ ├──────────────────────┼───────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
        [ │         1            │   2   │         3        │         4        │         5        │         6        │         7        │         8        │         9        │        10        │        11        │         12       │         13       │         14       │];
        [ ├──────────────────────┼───────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┤];
    end;
end;

class (TApplication13ReportView_4065) TApplication11ReportView_579()
    InitTApplication13ReportView_4065();

    macro printLendingAgencyCodeZone()
        /*_____________________________________________________________________________________*/
        var bankName = TArray();
        var i;
        /*_____________________________________________________________________________________*/

        [#]( strAlign( "                           Приложение 11   ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " к Приложению к Положению Банка России     ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " от 27 февраля 2017 года N 579-П           ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( "\"О плане счетов бухгалтерского учета      ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " в кредитных организациях и порядке его    ", ReportWidth, STR_ALIGN_RIGHT ));
        [#]( strAlign( " применения\"                              ", ReportWidth, STR_ALIGN_RIGHT ));
        [ ];

        /*________________________________________________________________________________________*/
        PrintBankHeaderBuf(НомерПодразделения,
                     RcbOrganizationStructure,
                                 ReportWidth,
                                     bankName,
                                            0);

        i = 0;
        while(i < bankName.Size())
          [#](trim(bankName[i]));
          i = i+1;
        end;

        [#]("(полное или сокращенное фирменное наименование кредитной организации)");

        [ ];
        /*________________________________________________________________________________________*/
        var periodName = RcbReportView("", "", RcbArray().initialize(RCB_PK_DAY, RCB_PK_MONTH, RCB_PK_QUARTER, RCB_PK_HALFYEAR, RCB_PK_PERIOD), DATE_IN_PERIOD_FORMAT).getNamesZone().getPeriodName();

        [#]( strAlign( "Группировка счетов бухгалтерского учета", ReportWidth, STR_ALIGN_CENTER ) );
        [#]( strAlign( "для составления сводной ведомости оборотов по отражению", ReportWidth, STR_ALIGN_CENTER ) );
        [#]( strAlign( "событий после отчетной даты", ReportWidth, STR_ALIGN_CENTER ) );
        [#]( strAlign( periodName, ReportWidth, STR_ALIGN_CENTER ) );
    end;

end;