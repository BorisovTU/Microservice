/*
$Name:          f129interface.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 129. Доступ к операциям формы
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Форма 129. Доступ к операциям формы.

  Создан: 2.12.2010 - Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────────────────────────────*/
import f129import;
import testLib;

/**
 *  Запуск операции расчета отчета
 */
macro executeCalculationOperation()
/*
    var profiler = TSQLProfiler(getTxtFileName("!F129CalculateProfile"));
    profiler.clear();
    profiler.on();
*/
    objectFactoryInstance.createReportCalculateController().calculate();

    objectFactoryInstance.createNormalizationController().execute();
end;

macro executePrintOperation()
    objectFactoryInstance.createReportPrintController().print();
end;

macro executeKlikoExportOperation()
    if (not rcbApplication().currentReport.isCalculated)
        TProtocolView("ПРОТОКОЛ ЭКСПОРТА В Kliko.exe").checkCalculateReport("kliko.exe");
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    objectFactoryInstance.createKlikoExportController().execute();
end;

macro executePtkPsdExportOperation()
    if (not rcbApplication().currentReport.isCalculated)
        TProtocolView("ПРОТОКОЛ ЭКСПОРТА В АС ПСД").checkCalculateReport("АС ПСД");
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    objectFactoryInstance.createPtkPsdExportController().execute();
end;

macro executeRecalculateOperation()
    objectFactoryInstance.createReportCalculateController().recalculate();
end;

установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
