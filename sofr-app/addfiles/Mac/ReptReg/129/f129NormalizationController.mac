/*
$Name:          f129NormalizationController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 129. Контролллер нормализации
*/

class T129NormalizationController()
    private var m_protocolView;

    macro constructorT129NormalizationController()
        m_protocolView = objectFactoryInstance.createNormalizationProtocolView();
    end;

    macro execute()

        m_protocolView.beginProtocol();

        initProgress(null, "Выполнение нормализации данных", "Выполнение нормализации данных");
        objectFactoryInstance.createReportNormalizer(m_protocolView).execute();
        remProgress();

        RcbApplication.TransactionManager.commit();

        m_protocolView.endProtocolWithoutLine();
        m_protocolView.show();

    end;

    constructorT129NormalizationController();
end;