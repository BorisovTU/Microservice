/*
 $Name: f129ReportView.mac
 $Module: Регламентируемая отчетность
 $Description:  Форма 129. Печатное представление отчетной формы.
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6.20.030                                                                 R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Форма 129. Печатное представление отчетной формы.

  Создан: 17.02.2011 - Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────────────────────────────*/
import RcbReportView;

private class (RcbPartView) T129PartView(part : string, name : string)

    var m_partName;

    macro printReferenceStrings(dataPool : RcbArray)
        throw(TPureVirtualMethodCallException("T129PartView::printReferenceStrings"));
    end;

    macro printName()
        println(strAlign(m_partName, m_table.getSumLen(), STR_ALIGN_CENTER));
    end;

    macro printDimension()
    end;

    macro printTableHeader()
        throw(TPureVirtualMethodCallException("T129PartView::printTableHeader"));
    end;

    macro printHead()
        println();
        printName();
        printDimension();
        printTableHeader();
    end;

    macro formatPoolValues(valuePool : rcbArray, line : string)
        valuePool.moveFirst();
        valuePool.moveNext();
        while (valuePool.moveNext())
            if (mod(valuePool.getCurrentIndex(), 2) == 0)
                valuePool.setCurrentItem(string(valuePool.getCurrentItem():0:0));
            else
                if (line == "Итого")
                    valuePool.setCurrentItem(strAlign("X", 21, STR_ALIGN_CENTER));
                else
                    if (valuePool.getCurrentItem() == 0)
                        valuePool.setCurrentItem("0");
                    else
                        valuePool.setCurrentItem(string(valuePool.getCurrentItem():0:3));
                    end;
                end;
            end;
        end;
        return valuePool;
    end;

    macro printString(valuePool : rcbArray, line : string)
        printString(formatPoolValues(valuePool, line));
    end;

    macro printNullData()
        printName();
        println();
        println("Данные отсутствуют.");
        println();
    end;

    macro getWidth()
        return m_table.getSumLen();
    end;

    private macro constructorT129PartView(part : string, name : string)
        initRcbPartView(part);
        m_partName = name;
    end;

    constructorT129PartView(part, name);
end;

/**************************************************************************************************
 * Классы реализации по указанию 2332
 **************************************************************************************************/

private class (T129PartView) T129Part1View2332()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
        m_table.addColumn("6",  24, AL_RIGHT);
        m_table.addColumn("7",  25, AL_RIGHT);
        m_table.addColumn("8",  25, AL_RIGHT);
        m_table.addColumn("9",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│                                    │                                                                          Средства, привлеченные кредитной организацией                                                                             │];
        [│         Сроки, на которые          ├─────────────────────────────────────────────┬─────────────────────────────────────────────┬──────────────────────────────────────────────────────┬─────────────────────────────────────────────────┤];
        [│        привлечены средства         │       Вклады и депозиты физических лиц      │   Вклады и депозиты нефинансовых оранизаций │ Привлеченные кредиты и депозиты кредитных организаций│               Размещенные векселя               │];
        [│                                    ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┼──────────────────────────┬───────────────────────────┼───────────────────────────┬─────────────────────┤];
        [│                                    │ставка, процент годовых│     общая сумма     │ставка, процент годовых│     общая сумма     │ ставка, процент годовых  │        общая сумма        │доходность, процент годовых│     общая сумма     │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┼───────────────────────────┼─────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │             6            │              7            │             8             │          9          │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┼───────────────────────────┼─────────────────────┤];
    end;

    macro printReferenceStrings(valuePool : rcbArray)
        [├────────────────────────────────────┴───────────────────────┴─────────────────────┴───────────────────────┴─────────────────────┴──────────────────────────┴───────────────────────────┴───────────────────────────┴─────────────────────┤];
        [│ Справочно:                                                                                                                                                                                                                              │];
        [│ 7.1. Средняя ставка по остаткам средств на счетах нефинансовых организаций = ##################################                                                                                                                         │](formatPoolValues(rcbArray().initialize("", valuePool[0]))[1]);
        [├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤];
        [│ 7.2. Средняя ставка по остаткам средств на корреспондентских счетах кредитной организации = ##################################                                                                                                          │](formatPoolValues(rcbArray().initialize("", valuePool[1]))[1]);
        [└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘];
    end;

    macro printBottom()
    end;

    private macro constructorT129Part1View2332()
        initT129PartView("1", "РАЗДЕЛ 1. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией средствам в рублях");
    end;

    constructorT129Part1View2332();
end;

private class (T129PartView) T129Part2View2332()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
        m_table.addColumn("6",  24, AL_RIGHT);
        m_table.addColumn("7",  25, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│                                    │                                                                          Средства, привлеченные кредитной организацией                           │];
        [│         Сроки, на которые          ├─────────────────────────────────────────────┬─────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│         привлечены вклады,         │       Вклады и депозиты физических лиц      │   Вклады и депозиты нефинансовых оранизаций │ Привлеченные кредиты и депозиты кредитных организаций│];
        [│         депозиты и кредиты         ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┼──────────────────────────┬───────────────────────────┤];
        [│                                    │ставка, процент годовых│     общая сумма     │ставка, процент годовых│     общая сумма     │ ставка, процент годовых  │        общая сумма        │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │             6            │              7            │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┤];
    end;

    private macro constructorT129Part2View2332()
        initT129PartView("2", "РАЗДЕЛ 2. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам и кредитам в долларах США");
    end;

    constructorT129Part2View2332();
end;

private class (T129PartView) T129Part3View2332()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
        m_table.addColumn("6",  24, AL_RIGHT);
        m_table.addColumn("7",  25, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│                                    │                                                                          Средства, привлеченные кредитной организацией                           │];
        [│         Сроки, на которые          ├─────────────────────────────────────────────┬─────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│         привлечены вклады,         │       Вклады и депозиты физических лиц      │   Вклады и депозиты нефинансовых оранизаций │ Привлеченные кредиты и депозиты кредитных организаций│];
        [│         депозиты и кредиты         ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┼──────────────────────────┬───────────────────────────┤];
        [│                                    │ставка, процент годовых│     общая сумма     │ставка, процент годовых│     общая сумма     │ ставка, процент годовых  │        общая сумма        │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │             6            │              7            │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┼──────────────────────────┼───────────────────────────┤];
    end;

    private macro constructorT129Part3View2332()
        initT129PartView("3", "РАЗДЕЛ 3. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам и кредитам в евро");
    end;

    constructorT129Part3View2332();
end;

class (RcbReportView) T129ReportView2332()

    private macro initialize()
        m_partViewPool.push_back(T129Part1View2332());
        m_partViewPool.push_back(T129Part2View2332());
        m_partViewPool.push_back(T129Part3View2332());
    end;

    macro getWidth()
        var maxPartWidth = 0;
        var curPartWidth;

        m_partViewPool.moveFirst();
        while (m_partViewPool.moveNext())
            curPartWidth = m_partViewPool.getCurrentItem().getWidth();
            if (maxPartWidth < curPartWidth)
                maxPartWidth = curPartWidth;
            end;
        end;

        return maxPartWidth;
    end;

    private macro constructorT129ReportView2332()
        initRcbReportView("""Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией средствам""",
                          "0409129", RCB_PK_MONTH, DATE_IN_PERIOD_FORMAT);
    end;

    constructorT129ReportView2332();
end;

/**************************************************************************************************
 * Классы реализации по указанию 2539
 **************************************************************************************************/

private class (T129Part1View2332) T129Part1View2539()

    macro printDimension()
        println(strAlign("тыс. руб.", getWidth(), STR_ALIGN_RIGHT));
    end;

    private macro constructorT129Part1View2539()
        initT129Part1View2332();
    end;

    constructorT129Part1View2539();
end;

private class (T129Part2View2332) T129Part2View2539()

    macro printDimension()
        println(strAlign("тыс. долларов США", getWidth(), STR_ALIGN_RIGHT));
    end;

    private macro constructorT129Part2View2539()
        initT129Part2View2332();
    end;

    constructorT129Part2View2539();
end;

private class (T129Part3View2332) T129Part3View2539()

    macro printDimension()
        println(strAlign("тыс. евро", getWidth(), STR_ALIGN_RIGHT));
    end;

    private macro constructorT129Part3View2539()
        initT129Part3View2332();
    end;

    constructorT129Part3View2539();
end;

class (T129ReportView2332) T129ReportView2539()

    private macro initialize()
        m_partViewPool.push_back(T129Part1View2539());
        m_partViewPool.push_back(T129Part2View2539());
        m_partViewPool.push_back(T129Part3View2539());
    end;

    private macro constructorT129ReportView2539()
        initT129ReportView2332();
        getNamesZone().excludeAttribute(AC_FORM_UNIT);
    end;

    constructorT129ReportView2539();
end;

/**************************************************************************************************
 * Классы реализации по указанию 4212
 **************************************************************************************************/

class (TNamesZone_4212) TNamesZone129_4212(formName, formOkudCode, formPeriodicity, periodFormat)
    initTNamesZone_4212(formName, formOkudCode, formPeriodicity, periodFormat);

    macro print(reportWidth, bankNameDescription)

        var i = 0;

        println();

        var formName : TArray;

        formName = strTransferByWord(m_formName, reportWidth, STR_ALIGN_CENTER);
        while (i < formName.size)
            println(strAlign(formName[i], reportWidth, STR_ALIGN_CENTER));
            i = i + 1;
        end;

        println();
        println(strAlign(getPeriodName(), reportWidth, STR_ALIGN_CENTER));
        println();

        printLendingAgencyName(reportWidth, bankNameDescription);

        var postAddressDescription = "Адрес (место нахождения) кредитной организации (ее филиала) ";
        var postAddress : TArray;
        postAddress = strTransferByWord(ternary((m_lendingAgencyPostalAdress == ""), " ", m_lendingAgencyPostalAdress), reportWidth - strLen(postAddressDescription), STR_ALIGN_LEFT);
        i = 1;
        println(strAlign(postAddressDescription + postAddress[0], reportWidth, STR_ALIGN_LEFT));
        while (i < postAddress.size)
            println(strAlign(mkStr(" ", strLen(postAddressDescription)) + postAddress[i], reportWidth, STR_ALIGN_LEFT));
            i = i + 1;
        end;

        println();

        if (not isAttributeExcluded(AC_FORM_OKUD_CODE))
            println(getOkudString(reportWidth));
        end;

        if (not isAttributeExcluded(AC_FORM_PERIODICITY))
            println(strAlign(m_formPeriodicity, reportWidth, STR_ALIGN_RIGHT));
        end;

        printUnitName(reportWidth);

        println();
    end;
end;

/*заготовка под запрос 246698*/
class (TSignatureZone_4212) TSignatureZone129_4212()
    initTSignatureZone();

    macro print(reportWidth)
        var datePrintableReport = string(m_reportIssueDate : f : m);

        var lenFPA = strLen(m_firstPersonAppointment);
        var lenSPA = strLen(m_secondPersonAppointment);
        var lenEx  = strLen("Исполнитель");
        var lenPh  = strLen("телефон:");
        var lenDPR = strLen(datePrintableReport);

        var maxLen = max(
                         max(lenFPA,lenSPA),
                         max(lenEx,
                             max(lenPh,lenDPR)
                            )
                        ) + 4;

        println();

        if (not isAttributeExcluded(AC_FIRST_PERSON))
            println(strAlign(m_firstPersonAppointment  + mkstr(" ", maxLen - lenFPA) + m_firstPersonName,  reportWidth, STR_ALIGN_LEFT));
        end;

        if (not isAttributeExcluded(AC_SECOND_PERSON))
            println(strAlign(m_secondPersonAppointment + mkstr(" ", maxLen - lenSPA) + m_secondPersonName, reportWidth, STR_ALIGN_LEFT));
        end;

        if (not isAttributeExcluded(AC_EXECUTOR))
            println(strAlign("Исполнитель"             + mkstr(" ", maxLen - lenEx)  + m_executorName  ,   reportWidth, STR_ALIGN_LEFT));
        end;

        if (not isAttributeExcluded(AC_EXECUTOR_PHONE_NUMBER))
            println(strAlign("Телефон:"                + mkstr(" ", maxLen - lenPh)  + m_executorPhoneNumber, reportWidth, STR_ALIGN_LEFT));
        end;

        println(strAlign(datePrintableReport, reportWidth, STR_ALIGN_LEFT));
    end;
end;

class (TPrintableView) TPrintableView129_4212(formName, formOkudCode, formPeriodicity, periodFormat)
    /**
     *  Виртуальный конструктор для TPrintableView.
     */
    private macro constructorTPrintableReport(formName, formOkudCode, formPeriodicity, periodFormat)

        defineFileName(formOkudCode);

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone_2851();
        m_namesZone             = TNamesZone129_4212(formName, formOkudCode, formPeriodicity, periodFormat);
        m_signatureZone         = TSignatureZone129_4212();

        m_standardZoneWidth = 0;
    end;

    initTPrintableView(formName, formOkudCode, formPeriodicity, periodFormat);
end;

private class (T129Part1View2539) T129Part1View4212()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│                                    │      Вклады (депозиты) физических лиц       │      Депозиты нефинансовых оранизаций       │];
        [│         Сроки, на которые          ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│        привлечены средства         │        ставка,        │    общая сумма,     │        ставка,        │    общая сумма,     │];
        [│                                    │    процент годовых    │       тыс.руб.      │    процент годовых    │       тыс.руб.      │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;

    macro printReferenceStrings(valuePool : rcbArray)
        [├────────────────────────────────────┴───────────────────────┴─────────────────────┴───────────────────────┴─────────────────────┤];
        [│ Справочно:                                                                                                                     │];
        [│ 7.1. Средняя ставка по остаткам средств на счетах нефинансовых организаций = ##################################                │](formatPoolValues(rcbArray().initialize("", valuePool[0]))[1]);
        [└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘];
    end;

    macro printDimension()
    end;

    private macro constructorT129Part1View4212()
        initT129PartView("1", "РАЗДЕЛ 1. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам в рублях");
    end;

    constructorT129Part1View4212();
end;

private class (T129Part2View2539) T129Part2View4212()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│                                    │      Вклады (депозиты) физических лиц       │      Депозиты нефинансовых оранизаций       │];
        [│         Сроки, на которые          ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│        привлечены средства         │        ставка,        │     общая сумма,    │        ставка,        │     общая сумма,    │];
        [│                                    │    процент годовых    │  тыс. долларов США  │    процент годовых    │  тыс. долларов США  │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;

    macro printDimension()
    end;

    private macro constructorT129Part2View4212()
        initT129Part2View2539();
    end;

    constructorT129Part2View4212();
end;

private class (T129Part3View2539) T129Part3View4212()

    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  21, AL_RIGHT);
        m_table.addColumn("3",  19, AL_RIGHT);
        m_table.addColumn("4",  21, AL_RIGHT);
        m_table.addColumn("5",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│                                    │       Вклады (депозиты) физических лиц      │      Депозиты нефинансовых оранизаций       │];
        [│         Сроки, на которые          ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│        привлечены средства         │        ставка,        │     общая сумма,    │        ставка,        │     общая сумма,    │];
        [│                                    │    процент годовых    │      тыс. евро      │    процент годовых    │      тыс. евро      │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │           2           │          3          │           4           │          5          │];
        [├────────────────────────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;
    macro printDimension()
    end;

    private macro constructorT129Part3View4212()
        initT129Part3View2539();
    end;

    constructorT129Part3View4212();
end;

class (T129ReportView2539) T129ReportView4212()

    private macro initialize()
        m_partViewPool.push_back(T129Part1View4212());
        m_partViewPool.push_back(T129Part2View4212());
        m_partViewPool.push_back(T129Part3View4212());
    end;

    private macro constructorT129ReportView4212()
        initRcbReportView("ДАННЫЕ О СРЕДНЕВЗВЕШЕННЫХ ПРОЦЕНТНЫХ СТАВКАХ ПО ПРИВЛЕЧЕННЫМ КРЕДИТНОЙ ОРГАНИЗАЦИЕЙ СРЕДСТВАМ",
                          "0409129", RCB_PK_MONTH, DATE_IN_PERIOD_FORMAT);

        getNamesZone().excludeAttribute(AC_FORM_UNIT);
    end;

    constructorT129ReportView4212();
end;

private class (T129PartView) T129PartView4637(part : string, name : string)
    macro printDimension()
    end;

    macro formatPoolValues(valuePool : rcbArray, line : string)
        valuePool.moveFirst();
        valuePool.moveNext();
        while (valuePool.moveNext())
            if (in(valuePool.getCurrentIndex(), 3, 5))
                valuePool.setCurrentItem(string(valuePool.getCurrentItem():0:0));
            else
                if (valuePool.getCurrentItem() == 0)
                    valuePool.setCurrentItem("0");
                else
                    valuePool.setCurrentItem(string(valuePool.getCurrentItem():0:3));
                end;
            end;

            if (    (line == "Итого")
                and in(valuePool.getCurrentIndex(), 2, 4)
               )
                valuePool.setCurrentItem(strAlign("X", 21, STR_ALIGN_CENTER));
            end;

            if (    (line == "1")
                and in(valuePool.getCurrentIndex(), 1, 2, 4)
               )
                valuePool.setCurrentItem(strAlign("X", 21, STR_ALIGN_CENTER));
            end;
        end;
        return valuePool;
    end;

    private macro constructorT129PartView4637(part : string, name : string)
        initT129PartView(part, name);
    end;

    constructorT129PartView4637(part, name);
end;

private class (T129PartView4637) T129Part1View4637()
    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  17, AL_RIGHT);
        m_table.addColumn("3",  21, AL_RIGHT);
        m_table.addColumn("4",  19, AL_RIGHT);
        m_table.addColumn("5",  21, AL_RIGHT);
        m_table.addColumn("6",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬───────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│              Сроки,                │  Код территории   │      Вклады (депозиты) физических лиц       │      Депозиты нефинансовых оранизаций       │];
        [│       на которые привлечены        │ места привлечения ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│          депозиты, вклады          │ средств по ОКАТО  │        ставка,        │    общая сумма,     │        ставка,        │    общая сумма,     │];
        [│                                    │                   │    процент годовых    │       тыс.руб.      │    процент годовых    │       тыс.руб.      │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │         2         │           3           │          4          │           5           │          6          │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;

    macro printReferenceStrings(valuePool : rcbArray)
        [├────────────────────────────────────┴───────────────────┴───────────────────────┴─────────────────────┴───────────────────────┴─────────────────────┤];
        [│ 8. Справочно:                                                                                                                                      │];
        [│ 8.1. Средняя ставка по остаткам средств на счетах нефинансовых организаций = ##################################                                    │](formatPoolValues(rcbArray().initialize("", valuePool[0]))[1]);
        [└────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘];
    end;

    macro printBottom()
    end;

    initT129PartView4637("1", "РАЗДЕЛ 1. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам в рублях");
end;

private class (T129PartView4637) T129Part2View4637()
    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  17, AL_RIGHT);
        m_table.addColumn("3",  21, AL_RIGHT);
        m_table.addColumn("4",  19, AL_RIGHT);
        m_table.addColumn("5",  21, AL_RIGHT);
        m_table.addColumn("6",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬───────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│              Сроки,                │  Код территории   │      Вклады (депозиты) физических лиц       │      Депозиты нефинансовых оранизаций       │];
        [│       на которые привлечены        │ места привлечения ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│          депозиты, вклады          │ средств по ОКАТО  │        ставка,        │     общая сумма,    │        ставка,        │     общая сумма,    │];
        [│                                    │                   │    процент годовых    │  тыс. долларов США  │    процент годовых    │  тыс. долларов США  │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │         2         │           3           │          4          │           5           │          6          │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;

    private macro constructorT129Part2View4637()
        initT129PartView4637("2", "РАЗДЕЛ 2. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам в долларах США");
    end;

    constructorT129Part2View4637();
end;

private class (T129PartView4637) T129Part3View4637()
    private macro initialize()
        m_table.addColumn("1",  34, AL_LEFT);
        m_table.addColumn("2",  17, AL_RIGHT);
        m_table.addColumn("3",  21, AL_RIGHT);
        m_table.addColumn("4",  19, AL_RIGHT);
        m_table.addColumn("5",  21, AL_RIGHT);
        m_table.addColumn("6",  19, AL_RIGHT);
    end;

    macro printTableHeader()
        [┌────────────────────────────────────┬───────────────────┬─────────────────────────────────────────────┬─────────────────────────────────────────────┐];
        [│              Сроки,                │  Код территории   │       Вклады (депозиты) физических лиц      │      Депозиты нефинансовых оранизаций       │];
        [│       на которые привлечены        │ места привлечения ├───────────────────────┬─────────────────────┼───────────────────────┬─────────────────────┤];
        [│          депозиты, вклады          │ средств по ОКАТО  │        ставка,        │     общая сумма,    │        ставка,        │     общая сумма,    │];
        [│                                    │                   │    процент годовых    │      тыс. евро      │    процент годовых    │      тыс. евро      │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
        [│                 1                  │         2         │           3           │          4          │           5           │          6          │];
        [├────────────────────────────────────┼───────────────────┼───────────────────────┼─────────────────────┼───────────────────────┼─────────────────────┤];
    end;

    private macro constructorT129Part3View4637()
        initT129PartView4637("3", "РАЗДЕЛ 3. Данные о средневзвешенных процентных ставках по привлеченным кредитной организацией депозитам, вкладам в евро");
    end;

    constructorT129Part3View4637();
end;

class (T129ReportView4212) T129ReportView4637()
    private macro initialize()
        m_partViewPool.push_back(T129Part1View4637());
        m_partViewPool.push_back(T129Part2View4637());
        m_partViewPool.push_back(T129Part3View4637());
    end;

    private macro constructorT129ReportView4637()
        initRcbReportView("ДАННЫЕ О СРЕДНЕВЗВЕШЕННЫХ ПРОЦЕНТНЫХ СТАВКАХ ПО ПРИВЛЕЧЕННЫМ КРЕДИТНОЙ ОРГАНИЗАЦИЕЙ ДЕПОЗИТАМ, ВКЛАДАМ",
                          "0409129", RCB_PK_MONTH, DATE_IN_PERIOD_FORMAT);

        getNamesZone().excludeAttribute(AC_FORM_UNIT);
    end;

    constructorT129ReportView4637();
end;
