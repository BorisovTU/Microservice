/*
$Name:          f129Report.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 129. Отчет
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Форма 129. Отчет.

  Создан: 2.12.2010 - Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────────────────────────────*/

/**
 * Отчет.
 */
class (RcbReportBase) T129Report(report, isLazy)

    /**
     * Добавить раздел отчета.
     *
     * @param     partId    название раздела
     * @param     attributeValue    ссылка на составное значение раздела
     */
    macro addPart(partId : String, attributeValue)
        return m_parts.push_back(objectFactoryInstance().createPart(partId, this, attributeValue));
    end;

    /**
     * Конструктор
     */
    private macro constructorT129Report(report, isLazy)
        initRcbReportBase(report, isLazy);
    end;

    constructorT129Report(report, isLazy);
end;

class (T129Report) T129Report2332(report, isLazy)

    /**
     * Инициализация структуры отчета.
     */
    macro initialize()
         addPart("1",  m_rcbReport.attributeValue("Раздел1"));
         addPart("1s", m_rcbReport.attributeValue("Раздел1Справочно"));
         addPart("2",  m_rcbReport.attributeValue("Раздел2"));
         addPart("3",  m_rcbReport.attributeValue("Раздел3"));
    end;

    /**
     * Отчет пуст.
     */
    macro isEmpty() : Bool
        m_parts.moveFirst();

        while (m_parts.moveNext())
            if (not m_parts.getCurrentItem().isEmpty())
                return false;
            end;
        end;

        return true;
    end;

    /**
     * Конструктор
     */
    private macro constructorT129Report2332(report, isLazy)
        initT129Report(report, isLazy);
    end;

    constructorT129Report2332(report, isLazy);
end;

class (T129Report2332) T129Report4637(report, isLazy)
    macro initialize()
         addPart("1",  m_rcbReport.attributeValue("Раздел1"));
         addPart("2",  m_rcbReport.attributeValue("Раздел2"));
         addPart("3",  m_rcbReport.attributeValue("Раздел3"));
    end;

    private macro constructorT129Report4637(report, isLazy)
        initT129Report2332(report, isLazy);
    end;

    constructorT129Report4637(report, isLazy);
end;
