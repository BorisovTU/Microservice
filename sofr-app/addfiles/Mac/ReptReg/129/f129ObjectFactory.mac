/*
$Name:          f129ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 129. Фабрика объектов формы
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Форма 129. Фабрика объектов формы.

  Создан: 2.12.2010 - Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────────────────────────────*/

class (RcbObjectFactoryBase) T129ObjectFactory2332()
    /**
     * Создать отчет.
     *
     * @param     report
     * @param     isLazy
     */
    macro createReport(report, isLazy)
        return genObject("T129Report2332", report, isLazy);
    end;

    /**
     * Создать раздел.
     *
     * @param     partId
     * @param     report
     * @param     compositeValue
     */
    macro createPart(partId, report, compositeValue)
        return genObject("T129Part", partId, report, compositeValue);
    end;

    /**
     * Создать атрибут.
     *
     * @param     line
     * @param     column
     * @param     part
     * @param     compositeValue
     */
    macro createAttribute(line, column, part, compositeValue)
        return genObject("T129Attribute", line, column, part, compositeValue);
    end;

    /**
     * Создать процентный атрибут.
     *
     * @param     line
     * @param     column
     * @param     part
     * @param     compositeValue
     */
    macro createPercentAttribute(line, column, part, compositeValue)
        return genObject("T129PercentAttribute", line, column, part, compositeValue);
    end;

    /**
     * Создать источники данных.
     *
     * @param     protocolView
     */
    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources2332", protocolView);
    end;

    macro createDataSourceFilters()
        return genObject("T129DataSourceFilters2332");
    end;

    macro createT129UserPartDataSourceProtocol()
        return genObject("T129UserPartDataSourceProtocol");
    end;

    /**
     * Создать контроллер расчета отчета.
     */
    macro createReportCalculateController()
        return genObject("T129ReportCalculateController2332");
    end;

    /**
     * Создать протокол расчета отчета.
     */
    macro createCalculateProtocolView()
        return genObject("F129CalculateProtocolView2332");
    end;

    /**
     * Создать представление экспорта отчета.
     */
    macro createKlikoView(fileExtensionPostfix : string)
        return genObject("T129KlikoView2332", fileExtensionPostfix);
    end;

    /**
     * Создать контроллер экспорта отчета.
     */
    macro createKlikoExportController()
        return genObject("T129KlikoExportController2332");
    end;

    /**
     * Создать печатное представление отчета.
     */
    macro createReportView()
        return genObject("T129ReportView2332");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("T129PrintProtocolView", protocolName);
    end;

    /**
     * Создать контроллер печати отчета.
     */
    macro createReportPrintController()
        return genObject("T129ReportPrintController2332");
    end;

    /**
     * Создать объект для работы с настроечной таблицей.
     */
    macro createTuneTable()
        return genObject("T129TuneTable2332");
    end;

    macro constructorT129ObjectFactory2332()
        initRcbObjectFactoryBase();
    end;

    macro createPtkPsdView() /*: TPtkPsdView*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPtkPsdView"));
    end;

    macro createPtkPsdExportController() /*: TPtkPsdExportController*/
        msgBox("Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2539-У " , "|" , " (окончание отчетного периода - не ранее 01.01.2011г.)");
        RepErrorsQueue().add(0, String("Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2539-У " , "\n" , " (окончание отчетного периода - не ранее 01.01.2011г.)"));
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    macro createParameters()
        return genObject("T129Parameters");
    end;

    constructorT129ObjectFactory2332();
end;

class (T129ObjectFactory2332) T129ObjectFactory2539()

    /**
     * Создать источники данных.
     *
     * @param     protocolView
     */
    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources2539", protocolView);
    end;

    macro createT129UserPartDataSourceProtocol()
        return genObject("T129UserPartDataSourceProtocol2539");
    end;

    /**
     * Создать печатное представление отчета.
     */
    macro createReportView()
        return genObject("T129ReportView2539");
    end;

    macro constructorT129ObjectFactory2539()
        initT129ObjectFactory2332();
    end;

    /**
     * Создать представление экспорта отчета.
     */
    macro createPtkPsdView()
        return genObject("T129PtkPsdView2539");
    end;

    /**
     * Создать контроллер экспорта отчета.
     */
    macro createPtkPsdExportController()
        return genObject("T129PtkPsdExportController2539");
    end;

    macro createPtkPsdExportPartController(view, part, head)
        return genObject("TPtkPsdExportPartController", view, part, head);
    end;

    constructorT129ObjectFactory2539();
end;

class (T129ObjectFactory2539) T129ObjectFactory2835()
    /**
     * Создать источники данных.
     *
     * @param     protocolView
     */
    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources2835", protocolView);
    end;
end;

class (T129ObjectFactory2835) T129ObjectFactory2926()
    /**
     * Создать источники данных.
     *
     * @param     protocolView
     */
    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources2926", protocolView);
    end;

    macro createNormalizationProtocolView()
        return genObject("T129NormalizationProtocolView");
    end;

    macro createNormalizationController()
        return genObject("T129NormalizationController");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("T129Normalizer", protocolView);
    end;
end;

class (T129ObjectFactory2926) T129ObjectFactory4212()
    initT129ObjectFactory2926();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TPrintableView129_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createReportView()
        return genObject("T129ReportView4212");
    end;

    macro createReportPrintController()
        return genObject("T129ReportPrintController4212");
    end;

    macro createReportCalculateController()
        return genObject("T129ReportCalculateController4212");
    end;

    macro createTuneTable()
        return genObject("T129TuneTable4212");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("T129Normalizer_4212", protocolView);
    end;

    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources4212", protocolView);
    end;

    macro createKlikoExportController()
        return genObject("T129KlikoExportController4212");
    end;

    macro createPtkPsdExportPartController(view, part, head)
        return genObject("TPtkPsdExportPartController4212", view, part, head);
    end;

    macro createPtkPsdExportController()
        return genObject("T129PtkPsdExportController4212");
    end;
end;

class (T129ObjectFactory4212) T129ObjectFactory_Т1_30_1_01_73275()
    initT129ObjectFactory4212();

    macro createKlikoExportController()
        return genObject("T129KlikoExportController_Т1_30_1_01_73275");
    end;
end;

class (T129ObjectFactory_Т1_30_1_01_73275) T129ObjectFactory_0MW5K()
    initT129ObjectFactory_Т1_30_1_01_73275();

    macro createPtkPsdExportController()
        return genObject("T129PtkPsdExportController_0MW5K");
    end;

    macro createPtkPsdExportPartController(view, part, head, report)
        return genObject("TPtkPsdExportPartController_0MW5K", view, part, head, report);
    end;

    macro createPtkPsdView()
        return genObject("T129PtkPsdView_0MW5K");
    end;
end;

class (T129ObjectFactory_0MW5K) T129ObjectFactory_4637()
    initT129ObjectFactory_0MW5K();

    macro createReport(report, isLazy)
        return genObject("T129Report4637", report, isLazy);
    end;

    macro createKlikoExportController()
        return genObject("T129KlikoExportController_4637");
    end;

    macro createReportView()
        return genObject("T129ReportView4637");
    end;

    macro createReportPrintController()
        return genObject("T129ReportPrintController4637");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TPrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createDataSources(protocolView /*: RcbCalculateProtocolView*/) /*: RcbDataSources*/
        return genObject("T129DataSources4637", protocolView);
    end;

    macro createReportCalculateController()
        return genObject("T129ReportCalculateController4637");
    end;

    macro createPart(partId, report, compositeValue)
        return genObject("T129Part4637", partId, report, compositeValue);
    end;

    macro createAttribute(line, column, part, compositeValue, okato)
        return genObject("T129Attribute4637", line, column, part, compositeValue, okato);
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("T129Normalizer_4637", protocolView);
    end;

    macro createT129UserPartDataSourceProtocol()
        return genObject("T129UserInfDataSourceProtocol_4637");
    end;

    macro createPtkPsdExportPartController(view, part, head, report)
        return genObject("TPtkPsdExportPartController4637", view, part, head, report);
    end;

    macro createPtkPsdExportController()
        return genObject("T129PtkPsdExportController4637");
    end;

    macro createPtkPsdView()
        return genObject("T129PtkPsdView_0MX4H");
    end;
end;

/**
 * Точка доступа к объекту-одиночке TObjectFactory()
 */
if (objectFactoryInstance == null)
    if   (rcbApplication.currentReport.context.period.endDate >= RCB_I4637_DATE_F129)
        objectFactoryInstance = T129ObjectFactory_4637();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_0MW5K_DATE)
        objectFactoryInstance = T129ObjectFactory_0MW5K();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_Т1_30_1_01_73275_DATE)
        objectFactoryInstance = T129ObjectFactory_Т1_30_1_01_73275();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = T129ObjectFactory4212();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2926_DATE)
        objectFactoryInstance = T129ObjectFactory2926();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2835_DATE4)
        objectFactoryInstance = T129ObjectFactory2835();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2539_DATE)
        objectFactoryInstance = T129ObjectFactory2539();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I2332_DATE)
        objectFactoryInstance = T129ObjectFactory2332();
    else
        objectFactoryInstance = RcbObjectFactoryBase();
    end;
end;
