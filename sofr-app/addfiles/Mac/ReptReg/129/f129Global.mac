/*
$Name:          f129Global.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 129. Доступ к глобальным данным
*/

/*─────────────────────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                                        R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Форма 129. Доступ к глобальным данным.

  Создан: 2.12.2010 - Shestakov Dmitry
└─────────────────────────────────────────────────────────────────────────────────────────────────*/
import testlib;
/*
    var profiler = TSQLProfiler(getTxtFileName("!F129CalculateProfile"));
    profiler.clear();
    profiler.on();
*/
class TReportInfo(percentValue_2, sumValue_2, percentValue_2_1, sumValue_2_1, percentValue_3, sumValue_3, percentValue_4, sumValue_4, percentValue_5, sumValue_5, percentValue_6, sumValue_6, percentValue_7, sumValue_7,
                  okato,
                  isTotal)
    var m_percentValue_2    = percentValue_2;
    var m_sumValue_2        = sumValue_2;
    var m_percentValue_2_1  = percentValue_2_1;
    var m_sumValue_2_1      = sumValue_2_1;
    var m_percentValue_3    = percentValue_3;
    var m_sumValue_3        = sumValue_3;
    var m_percentValue_4    = percentValue_4;
    var m_sumValue_4        = sumValue_4;
    var m_percentValue_5    = percentValue_5;
    var m_sumValue_5        = sumValue_5;
    var m_percentValue_6    = percentValue_6;
    var m_sumValue_6        = sumValue_6;
    var m_percentValue_7    = percentValue_7;
    var m_sumValue_7        = sumValue_7;
    var m_okato             = okato;
    var m_isTotal           = isTotal;
end;

class (TGlobalBase) T129Global()
    /**
     * Текущий отчет.
     */
    private var m_rcbReport : Object;
    private var m_parameters = NULL;

    /**
     * Получить текущий отчет.
     */
    macro getRcbReport() : RcbReport
        return m_rcbReport;
    end;

    /**
     * Получить ссылку на хранение параметров.
     */
    macro getParameters()
        return m_parameters;
    end;

    private macro constructorT129Global()
        initTGlobalBase();
        initializeRepDataPackage(m_rcbReport);
        m_rcbReport = rcbApplication.currentReport;
        m_parameters = objectFactoryInstance.createParameters();
    end;

    constructorT129Global();
end;

macro global()
    if (v_global == null)
        v_global = T129Global();
    end;
    return v_global;
end;

global();