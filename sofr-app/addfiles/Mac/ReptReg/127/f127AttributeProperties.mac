/*
$Name: f127AttributeProperties.mac
$Module: Регламентируемая отчетность
$Description: Форма 127. Класс свойств атрибута.
*/

/**
 * Форма 127. Класс свойств атрибута.
 * Отвечает как за хранимые в БД (переменной) свойства, так и за свойства, существующие только при отработке какой-то операции
 */
class TF127AttributeProperties(storage : RcbCompositeValue)

    private var m_storage: RcbCompositeValue;
    private var m_partId:  String;

    /**
     * Получить идентификатор отчета
     */
    macro getPartId()

        return m_partId;

    end;

    macro setPartId(partId)

        m_partId = partId;
        return this;

    end;

    private macro constructorTF127AttributeProperties(storage : RcbCompositeValue)

        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF127AttributeProperties::constructorTF127AttributeProperties"));
        end;

        if (storage == null)
            throw(TUnspecifiedValueException("TF127AttributeProperties::constructorTF127AttributeProperties", "storage"));
        end;

        if (    (valType(storage) != V_GENOBJ)
            and (isEqClass("RcbCompositeValue", storage))
           )
            throw(TIncorrectParameterTypeException("TF127AttributeProperties::constructorTF127AttributeProperties", "storage"));
        end;

        m_storage = storage;
        m_partId  = 0;

    end;

    constructorTF127AttributeProperties(storage);

end;
