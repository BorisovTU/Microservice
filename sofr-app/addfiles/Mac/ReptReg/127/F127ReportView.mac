/*
$Name:          F127ReportView.mac
$Module:        ê•£´†¨•≠‚®‡„•¨†Ô Æ‚Á•‚≠Æ·‚Ï
$Description:   îÆ‡¨† 127. è•Á†‚≠†Ô ‰Æ‡¨† Æ‚Á•‚†
*/

private class (RcbPartView) TF127Part1View()

    private macro initialize()
        m_table.addColumn("1",   9, AL_CENTER);
        m_table.addColumn("2",  29, AL_LEFT);
        m_table.addColumn("3",  14, AL_RIGHT);
        m_table.addColumn("4",  14, AL_RIGHT);
        m_table.addColumn("5",  14, AL_RIGHT);
        m_table.addColumn("6",  14, AL_RIGHT);
        m_table.addColumn("7",  14, AL_RIGHT);
        m_table.addColumn("8",  14, AL_RIGHT);
        m_table.addColumn("9",  14, AL_RIGHT);
        m_table.addColumn("10", 14, AL_RIGHT);
        m_table.addColumn("11", 14, AL_RIGHT);
        m_table.addColumn("12", 14, AL_RIGHT);
        m_table.addColumn("13", 14, AL_RIGHT);
        m_table.addColumn("14", 14, AL_RIGHT);
        m_table.addColumn("15", 14, AL_RIGHT);
        m_table.addColumn("16", 16, AL_RIGHT);

        m_table.setUseColumnNumbering(true);
    end;

    macro getWidth()
        return m_table.GetSumLen();
    end;

    macro printNote(note : Object)
        var i = 1;

        printLn();
        printLn("è‡®¨•Á†≠®•: " + nvl(note[0], ""));

        while (i < note.size)
            printLn(note[i]);
            i = i + 1;
         end;
    end;

    macro printCurrency(codeCurrency : string)
        printLn(codeCurrency);
    end;

    macro printHead()
        [⁄ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø];
        [≥   çÆ¨•‡   ≥    ç†®¨•≠Æ¢†≠®• ØÆ™†ß†‚•´Ô    ≥                                                                                                    Ç‡•¨•≠≠Î• ®≠‚•‡¢†´Î                                                                                                     ≥ ç•Á„¢·‚¢®‚•´Ï≠Î• ≥];
        [≥           ≥                               √ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥   ™ ®ß¨•≠•≠®Ó    ≥];
        [≥           ≥                               ≥   ÑÆ 30 §≠•©   ≥    é‚ 31 §Æ    ≥    é‚ 91 §Æ    ≥   é‚ 181 §≠Ô   ≥   é‚ 1 £Æ§†    ≥     é‚ 2 §Æ    ≥    é‚ 3 §Æ     ≥    é‚ 4 §Æ     ≥     é‚ 5 §Æ    ≥     é‚ 7 §Æ    ≥    é‚ 10 §Æ    ≥    é‚ 15 §Æ    ≥     ë¢ÎË•      ≥    Ø‡ÆÊ•≠‚≠Æ©    ≥];
        [≥           ≥                               ≥                ≥    90 §≠•©     ≥    180 §≠•©    ≥   §Æ 1 £Æ§†    ≥   §Æ 2 ´•‚     ≥      3 ´•‚     ≥     4 ´•‚      ≥     5 ´•‚      ≥      7 ´•‚     ≥     10 ´•‚     ≥     15 ´•‚     ≥     20 ´•‚     ≥     20 ´•‚     ≥      ·‚†¢™®      ≥];
        [≥           ≥                               ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                ≥                  ≥];
        [√ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥];
        [≥     1     ≥               2               ≥       3        ≥       4        ≥       5        ≥       6        ≥       7        ≥       8        ≥       9        ≥       10       ≥       11       ≥       12       ≥       13       ≥       14       ≥       15       ≥        16        ≥];
    end;

    macro printCommonString(rowNumber : string, description : string)
        [√ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥];
        [≥###########≥###############################################################################################################################################################################################################################################################################≥]
        (rowNumber:c, description);
        [√ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥];
    end;

    private macro constructorTF127Part1View()
        initRcbPartView("1");
    end;

    constructorTF127Part1View();
end;

class (RcbReportView) TF127ReportView(modeReport)

    private macro initialize()
        m_partViewPool.push_back(TF127Part1View());
    end;

    private macro constructorTF127ReportView()
        initRcbReportView("ëÇÖÑÖçàü é êàëäÖ èêéñÖçíçéâ ëíÄÇäà",
                          "0409127", RCB_PK_QUARTER, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTF127ReportView();
end;

/**
 * CMakeReport · Ø•‡•£‡„¶•≠≠Î¨® ¨•‚Æ§¨®
 *     GetRegim_LoadNewApplication - §´Ô Ø•‡•™‡Î‚®Ô ≠†·‚‡Æ©™® BANK_INI\WINDOWS REPORT\LOADNEWAPPLICATION
 */
private class (CMakeReport) TMakeReport(_HeaderStr:string, _SepStr:string, _CountStrOnPage:integer, _CurStr:integer)
    initCMakeReport(_HeaderStr, _SepStr, _CountStrOnPage, _CurStr);

    private macro GetRegim_LoadNewApplication()
        return false;
    end;
end;

/**
 * è•Á†‚≠Æ• Ø‡•§·‚†¢´•≠®• Excel
 */
class TF127ExcelView(txtReportFileName : String, coefficent : Double)
    private var m_printEngine : TMakeReport;
    private var m_txtReportFileName : String;

    macro print()
        var outstream = TStreamDoc(m_txtReportFileName, "R");
        var str = "";
        var length = 0;
        while (outstream.readLine(str))
            var tmp = strlen(str);
            if (tmp > length)
                length = tmp;
            end;
        end;

        var i = 0;
        str = "";
        outstream = TStreamDoc(m_txtReportFileName, "R");
        while (outstream.readLine())
            i = i + 1;
            var line = outstream.str;

            if (line == "")
                line = mkstr(" ", length);
            end;

            str = str + "\n" + line;
        end;
        str = substr(str, 2);

        m_printEngine.autoscan("["+str+"]");

        m_printEngine.printWinRep();
    end;

    macro show()
        m_printEngine.showWinRep();
    end;

    /**
     *  äÆ≠·‚‡„™‚Æ‡.
     */
    private macro constructorTF127ExcelView(txtReportFileName : String, coefficent : Double)
        m_printEngine = TMakeReport("", SEP_DEFAULT, 100000);
        m_printEngine.setWinRepOutput(WINREP_OUTPUT_EXCEL, WINREP_FORMAT_XLSX);
        m_printEngine.setFlagShowIndicator(false);
        m_printEngine.setFlagShowGrid(false);
        m_printEngine.setFont("Courier New", 10, coefficent);

        var ext : String;
        splitFile(txtReportFileName, m_txtReportFileName, ext);
        m_printEngine.setFileNameWin(m_txtReportFileName);
        m_txtReportFileName = m_txtReportFileName + ext;
    end;

    constructorTF127ExcelView(txtReportFileName, coefficent);
end;

class (TF127ReportView) TF127ReportExcelView(protocolView : RcbPrintProtocolView)
    private var m_excelView : TF127ExcelView;

    macro createExcel()
        m_excelView.print();
    end;

    macro showExcel()
        m_excelView.show();
    end;

    private macro constructorTF127ReportExcelView(protocolView : RcbPrintProtocolView)
        initTF127ReportView(protocolView);
        m_excelView = TF127ExcelView(getFileName(), 0.96);
    end;

    constructorTF127ReportExcelView(protocolView);
end;
