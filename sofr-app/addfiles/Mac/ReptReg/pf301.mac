/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank v 5.1                                     R-Style Software Lab Ltd
  Файл подсистемы "Отчеты ЦБ"

  Дополнительный отчет формы 301. Сведения об объеме средств, привлеченных
  кредитной организацией

CREATED : 11.09.01 Зорина.
Note :          В отчет выводятся только те строки, для которых процент
                изменения показателя в текущем отч. периоде по сравнению
                с предыдущим превышает по модулю 10% и разница значений
                в текущем и предыдущем отчетном периоде по модулю составляет
                не менее (>=) 500 млн. руб.
    22.07.2005  BugZ    SCR 69375   Фильтрация по ТС/РС.
└───────────────────────────────────────────────────────────────────────────*/
import BankInter,ReptCBInter,ReptCBCommon,PTInter,Param,Календарь,cy_find,rcb_date,chk_regd;
import DepartmentFilter;

FILE Переменные( cy_varsd, "cy_files.def" ) KEY 1; /* KEY=iFormId+iVarId */
FILE Спис      ( cy_algv,  "cy_files.def" ) KEY 0; /*KEY=iFormId+iVarId+iSort+iInVarId */
FILE accR ( account );
FILE clnt ( party   );
FILE pers( person );
private var accountFilter = RcbAccountFilter();

var Vars = TArray, VarsNew = TArray;
Vars(0) = "Атр301_13";   VarsNew(0) = "Об_ДВ____Гр3_";
Vars(1) = "Атр301_14";   VarsNew(1) = "Об_ДВ____Гр4_";
Vars(2) = "Атр301_15";   VarsNew(2) = "Об_ДВ____Гр5_";
Vars(3) = "Атр301_16";   VarsNew(3) = "Об_ДВ____Гр6_";
Vars(4) = "Атр301_18";   VarsNew(4) = "Об_Срочн_Гр3_";
Vars(5) = "Атр301_19";   VarsNew(5) = "Об_Срочн_Гр4_";
Vars(6) = "Атр301_20";   VarsNew(6) = "Об_Срочн_Гр5_";
Vars(7) = "Атр301_21";   VarsNew(7) = "Об_Срочн_Гр6_";
Vars(8) = "Атр301_23";   VarsNew(8) = "Об_ИТОГО_Гр3_";
Vars(9) = "Атр301_24";   VarsNew(9) = "Об_ИТОГО_Гр4_";
Vars(10) = "Атр301_25";   VarsNew(10) = "Об_ИТОГО_Гр5_";
Vars(11) = "Атр301_26";   VarsNew(11) = "Об_ИТОГО_Гр6_";
Vars(12) = "Атр301_27";   VarsNew(12) = "Об_ИТОГО_Гр7_";
Vars(13) = "Атр301_28";   VarsNew(13) = "Тр_До____Гр10";
Vars(14) = "Атр301_29";   VarsNew(14) = "Тр_До____Гр11";
Vars(15) = "Атр301_30";   VarsNew(15) = "Тр_До____Гр12";
Vars(16) = "Атр301_31";   VarsNew(16) = "Тр_До____Гр13";
Vars(17) = "Атр301_32";   VarsNew(17) = "Тр_До____Гр14";
Vars(18) = "Атр301_33";   VarsNew(18) = "Тр_До____Гр15";
Vars(19) = "Атр301_34";   VarsNew(19) = "Тр_До____Гр16";
Vars(20) = "Атр301_35";   VarsNew(20) = "Тр_До____Гр17";
Vars(21) = "Атр301_36";   VarsNew(21) = "ИА_До____Гр18";
Vars(22) = "Атр301_37";   VarsNew(22) = "ИП_До____Гр19";
Vars(23) = "Атр301_39";   VarsNew(23) = "Тр_Свыше_Гр10";
Vars(24) = "Атр301_40";   VarsNew(24) = "Тр_Свыше_Гр11";
Vars(25) = "Атр301_41";   VarsNew(25) = "Тр_Свыше_Гр12";
Vars(26) = "Атр301_42";   VarsNew(26) = "Тр_Свыше_Гр13";//
Vars(27) = "Атр301_43";   VarsNew(27) = "Тр_Свыше_Гр14";
Vars(28) = "Атр301_44";   VarsNew(28) = "Тр_Свыше_Гр15";
Vars(29) = "Атр301_45";   VarsNew(29) = "Тр_Свыше_Гр16";
Vars(30) = "Атр301_46";   VarsNew(30) = "Тр_Свыше_Гр17";//
Vars(31) = "Атр301_47";   VarsNew(31) = "ИА_Свыше_Гр18";
Vars(32) = "Атр301_48";   VarsNew(32) = "ИП_Свыше_Гр19";
Vars(33) = "Атр301_50";   VarsNew(33) = "Тр_ИТОГО_Гр10";
Vars(34) = "Атр301_51";   VarsNew(34) = "Тр_ИТОГО_Гр11";
Vars(35) = "Атр301_52";   VarsNew(35) = "Тр_ИТОГО_Гр12";
Vars(36) = "Атр301_53";   VarsNew(36) = "Тр_ИТОГО_Гр13";
Vars(37) = "Атр301_54";   VarsNew(37) = "Тр_ИТОГО_Гр14";
Vars(38) = "Атр301_55";   VarsNew(38) = "Тр_ИТОГО_Гр15";
Vars(39) = "Атр301_56";   VarsNew(39) = "Тр_ИТОГО_Гр16";
Vars(40) = "Атр301_57";   VarsNew(40) = "Тр_ИТОГО_Гр17";
Vars(41) = "Атр301_58";   VarsNew(41) = "ИА_ИТОГО_Гр18";
Vars(42) = "Атр301_59";   VarsNew(42) = "ИП_ИТОГО_Гр19";
Vars(43) = "Атр301_60";   VarsNew(43) = "СС_ИТОГО_Гр20";//

VAR MinConst;

 if(ЕдиницыИзмерения == ЕИ_НацВалТочн )          
   MinConst = 1000000000.00;
 elif( ЕдиницыИзмерения == ЕИ_НацВал )
     MinConst = 1000000000;
 elif( ЕдиницыИзмерения == ЕИ_Тысячи )
     MinConst = 1000000;
 else
   MinConst = 1000;
 end;

VAR ЕстьДанные = FALSE,
    ДАТА1_1660У;

GetRegistryValue( "REPTREG\\REP_GROUPS\\COMMON\\ДАТА1_1660У", V_STRING, ДАТА1_1660У, NULL );

CheckRegDate(Дата1_1660У, Дата1_1660У);

if( (Дата1_1660У == date(0, 0, 0)) or (Дата1_1660У == NULL) )
  Дата1_1660У = date( 1, 4, 2006 );
end;

VAR Изменения = FALSE;
VAR
 ИдентификаторОтчета = НайтиИдентификаторОтчетаПоНазванию ("Форма 301"),

 ОКО = "ОБЯЗАТЕЛЬСТВА КРЕДИТНЫХ ОРГАНИЗАЦИЙ",
 ТКО = "ТРЕБОВАНИЯ КРЕДИТНЫХ ОРГАНИЗАЦИЙ",
 ИА  = "ИНОСТРАННЫЕ АКТИВЫ",
 ИП  = "ИНОСТРАННЫЕ ПАССИВЫ",
 СС  = "СОБСТВЕННЫЕ СРЕДСТВА",

 ПредпрРуб     = "В рублях, перед нефинансовыми организациями",
 ПредпрВал     = "В ин. валюте, перед нефинансовыми организациями",
 ФизРуб        = "В рублях, перед физическими лицами",
 ФизВал        = "В ин. валюте, перед физическими лицами",
 ПредпрФизРуб  = "В рублях, нефинансовым орг. и физ. лицам",
 ПредпрФизВал  = "В ин. валюте, нефинансовым орг. и физ. лицам",
 ОргВластиРуб  = "В рублях, к органам гос. управления, органам гос. власти",
 ОргВластиВал  = "В ин. валюте, к органам гос. управления, органам гос. власти",
 МестВластиРуб = "В рублях, к органам гос. управления, местным органам власти",
 МестВластиВал = "В ин. валюте, к органам гос. управления, местным органам власти",
 ВнебФондыРуб  = "В рублях, к органам гос. управления, внебюджетным фондам",
 ВнебФондыВал  = "В ин. валюте, к органам гос. управления, внебюджетным фондам",
 ИнАктивы      = "Иностранные активы",
 ИнПассивы     = "Иностранные пассивы",
 СобСредства   = "Собственные средства кредитной организации за вычетом вложений в акции других кредитных организаций",

 l_coeff = 1,
 DateBegin,
 DateEnd,
 
 Пред301_13, Атр301_13,
 Пред301_14, Атр301_14,
 Пред301_15, Атр301_15,
 Пред301_16, Атр301_16,
 Пред301_18, Атр301_18,
 Пред301_19, Атр301_19,
 Пред301_20, Атр301_20,
 Пред301_21, Атр301_21,
 Пред301_28, Атр301_28,
 Пред301_29, Атр301_29,
 Пред301_30, Атр301_30,
 Пред301_31, Атр301_31,
 Пред301_32, Атр301_32,
 Пред301_33, Атр301_33,
 Пред301_34, Атр301_34,
 Пред301_35, Атр301_35,
 Пред301_36, Атр301_36,
 Пред301_37, Атр301_37,
 Пред301_39, Атр301_39,
 Пред301_40, Атр301_40,
 Пред301_41, Атр301_41,
 Пред301_42, Атр301_42,
 Пред301_43, Атр301_43,
 Пред301_44, Атр301_44,
 Пред301_45, Атр301_45,
 Пред301_46, Атр301_46,
 Пред301_47, Атр301_47,
 Пред301_48, Атр301_48,
 Пред301_60, Атр301_60;
 
MACRO Ind(arr, name )
var i=0;
 while(i < arr.size)
  if(arr(i) == name)
   return i;
  end;
  i = i + 1;
 end;       
 return FALSE;
END;

MACRO getNameOper
 pers.Oper = {oper};
 if( not getEQ( pers ) )
  return "";
 end;
 return trim( pers.Name );
END;

/* ......................................................................... */

MACRO GenError( ИмяФайла, Текст)
VAR
   MSG,
   stat = Status( MSG);

  MsgBox( string( Текст, "|", MSG, "|\"" + ИмяФайла + "\"|", "статус ", stat));
  Exit( 1);
END;

MACRO around( val )
 return floor( val + 0.5 );
END;
  
MACRO НайтиОписаниеПеременной()
  Переменные.iFormId = Спис.iInFormId;
  Переменные.iVarId  = Спис.iInVarId;

  if ( not GetEQ( Переменные) )
    GenError( "", string( "Не найдено описание переменной отчета \"",
              НайтиНазваниеОтчетаПоИдентификатору (Спис.iInFormId), "\"",
              " с идентификатором ",Спис.iInVarId));
  end;
END;

MACRO AbsVal( v )
  if ( v < 0 )
     v = - v;
  end;
  return v;
END;

/* ........................................................................ */

VAR
 rp_balance = "30601"; /* балансовый счет для расчета */

/* Рассчитать переменную по файлу лицевых счетов
   p_num - № в ТЗ */
MACRO processFile( p_num )
 MACRO ОбрабПерем( name )
  var FormName = "Балансовые счета",
      val1,
      val2,
      bal;

  ПрочитатьПеременную( val1, ДатаОтчета, ПредДатаОтчета, FormName, name );
  ПрочитатьПеременную( val2, DateEnd, DateBegin, FormName, name );
  if( val1 != val2 )
   val1 = val1 /l_coeff;
   val2 = val2 /l_coeff;
   bal = substr( name, 3, 5 );
[├────────┼───────┼──────────────────────┼───────┼─────────────┼───────┼──────────────┼────────────────────────┤];
[│        │       │                      │ ##### │#############│ ##### │##############│ ###################### │]
  ( bal:c, val1:0:3, bal:c, val2:0:3, val1 - val2:0:3 );
  end;
 END;

 var val1 = $0,
     val2 = $0,
     l_rouble,
     l_person,
     l_next;

 if  ( p_num == "Атр301_13" )
  l_rouble = TRUE;
  l_person = FALSE;

 elif( p_num == "Атр301_14" )
  l_rouble = TRUE;
  l_person = TRUE;

 elif( p_num == "Атр301_15" )
  l_rouble = FALSE;
  l_person = FALSE;

 elif( p_num == "Атр301_16" )
  l_rouble = FALSE;
  l_person = TRUE;
 elif( p_num == "Атр301_28" ) 
  ПрочитатьПеременную( val1, ДатаОтчета, ПредДатаОтчета, "Форма 301", "Атр301_0" );
  ПрочитатьПеременную( val2, DateEnd, DateBegin, "Форма 301", "Атр301_0" );
  if(val1 == NULL)val1 = $0;end;
  if(val2 == NULL)val2 = $0;end;
  val1 = val1 /l_coeff;
  val2 = val2 /l_coeff;
  if( abs( around( val1 - val2 ) ) == 0 )
   return;
  end;
  ОбрабПерем( "Бн40306РуП" );
  ОбрабПерем( "Бн40308РуА" );
  ОбрабПерем( "Бн40310РуА" );
  return;
 elif( p_num == "Атр301_32" )
  ПрочитатьПеременную( val1, ДатаОтчета, ПредДатаОтчета, "Форма 301", "Атр301_00" );
  ПрочитатьПеременную( val2, DateEnd, DateBegin, "Форма 301", "Атр301_00" );
  if(val1 == NULL)val1 = $0;end;
  if(val2 == NULL)val2 = $0;end;
  val1 = val1 /l_coeff;
  val2 = val2 /l_coeff;
  if( abs( around( val1 - val2 ) ) == 0 )
   return;
  end;
  ОбрабПерем( "Бн40306ПоП" );
  ОбрабПерем( "Бн40308ПоА" );
  ОбрабПерем( "Бн40310ПоА" );
  return;
 else
  return;

 end;

 clearrecord( accR );
 accR.Chapter = 1;

 l_next = getGE( accR );
 while ( l_next and (accR.Chapter == 1) )

  clnt.PartyID = accR.Client;

  if( ( trim( accR.Balance ) == rp_balance                   ) and
      ( getEQ( clnt )                                        ) and
      ( ( index( accR.Type_Account, "П" ) == 0 ) == l_rouble ) and
      ( ( clnt.LegalForm == 2 )                  == l_person ) and
      ( accountFilter.IsSuitable( accR )                     ) and 
      ( ( not l_person and not ВидСубъекта( clnt.PartyID, PTK_BANK ) ) or
        ( l_person                                                 ) ) )
   val1 = val1 + restA( accR.Account, ДатаОтчета, NULL, accR.Chapter );
   val2 = val2 + restA( accR.Account, DateEnd, NULL, accR.Chapter );

  end;

  l_next = next( accR );
 end;
 val1 = val1 /l_coeff;
 val2 = val2 /l_coeff;

 if( val1 != val2 )
[├────────┼───────┼──────────────────────┼───────┼─────────────┼───────┼──────────────┼────────────────────────┤];
[│        │       │                      │ ##### │#############│ ##### │##############│ ###################### │]
  ( rp_balance:c, val1:0:3, rp_balance, val2:0:3, val1 - val2:0:3 );
 end;
END;

MACRO СписокСост( Name )
var isFirst = true,
    VarId,
    InFormName,
    InVarName,
    val1,
    val2,
    str1;

  MACRO Составляющие()
    if ( isFirst )
      isFirst = False;
      Спис.iFormId   = ИдентификаторОтчета;
      Спис.iVarId    = VarId;
      Спис.iInFormId = 0;
      Спис.iSort = -1;

      return (     GetGE( Спис)
               and (Спис.iFormId == ИдентификаторОтчета)
               and (Спис.iVarId  == VarId));
    else
      return (     next( Спис)
               and (Спис.iFormId == ИдентификаторОтчета)
               and (Спис.iVarId  == VarId));
    end;
  END;

  Name = Trim( Name);
  if( ПредДатаОтчета > ДАТА1_1660У)
   Name = VarsNew(Ind(Vars, name))
  end;

  VarId = НайтиИдентификаторПеременнойПоНазванию (Name,ИдентификаторОтчета);
  Переменные.iFormID = ИдентификаторОтчета;
  Переменные.iVarID = VarId;

  getEQ( Переменные );

  while ( (not cy_find_error) and Составляющие() )
    InFormName = НайтиНазваниеОтчетаПоИдентификатору (Спис.iInFormId);
    InVarName  = НайтиНазваниеПеременнойПоИдентификатору(Спис.iInVarId,Спис.iInFormId);

   if( InFormName == "Балансовые счета" )

    if( ( not ПрочитатьПеременную( val1, ДатаОтчета, ПредДатаОтчета,
                                   InFormName, InVarName       ) ) or
        ( valtype( val1 ) == V_UNDEF                            ) )

      MsgBox( "Не определено значение переменной|\"", InFormName,
              ".", InVarName, "\"  за период с ", ПредДатаОтчета, " по ", ДатаОтчета );
      Exit( 1);
    end;
    if( ( not ПрочитатьПеременную( val2, DateEnd, DateBegin,
                                   InFormName, InVarName       ) ) or
        ( valtype( val2 ) == V_UNDEF                            ) )

      MsgBox( "Не определено значение переменной|\"", InFormName,
              ".", InVarName, "\"  за период с ", DateBegin, " по ", DateEnd );
      Exit( 1);
    end;
    val1 = val1/l_coeff;
    val2 = val2/l_coeff;
     
    if( val1 != val2 )
     НайтиОписаниеПеременной();
     if( strlen( InVarName ) < 10  )
       str1 = substr( InVarName, 3, 3 );
     else
       str1 = substr( InVarName, 3, 5 );
     end;
[├────────┼───────┼──────────────────────┼───────┼─────────────┼───────┼──────────────┼────────────────────────┤];
[│        │       │                      │ ##### │#############│ ##### │##############│ ###################### │]
  ( str1:c, val1:0:3, str1, val2:0:3, val1 - val2:0:3 );

    end;
   end;
  end;

  if( ПредДатаОтчета > ДАТА1_1660У)
   Name = Vars(Ind(VarsNew, name))
  end;
  processfile( Name );
END;

MACRO ПрочитатьПеремПредПериода()

 MACRO Прочитать(val, Date1, Date2, Name)
   if( not ПрочитатьПеременную( val, Date2, Date1, "Форма 301", Name ) 
       or (ValType( val ) == V_UNDEF) )
     MsgBox( "Не определено значение переменной|\"", Name,"\"  за период с ", Date1, " по ", Date2 );
     Exit( 1);
   end;
   SetParm(0, val);
 END;

 MACRO ЗначПерем( name, val1, val2 )
  if( ДатаОтчета < ДАТА1_1660У)
     Прочитать(val1, DateBegin, DateEnd, name);
     Прочитать(val2, ПредДатаОтчета, ДатаОтчета, name);
  elif((ДатаОтчета >= ДАТА1_1660У) and (DateEnd < ДАТА1_1660У))
     Прочитать(val1, DateBegin, DateEnd, name);
     Прочитать(val2, ПредДатаОтчета, ДатаОтчета, VarsNew(Ind(Vars, name)));
  else
     Прочитать(val1, DateBegin, DateEnd, VarsNew(Ind(Vars, name)));
     Прочитать(val2, ПредДатаОтчета, ДатаОтчета, VarsNew(Ind(Vars, name)));
  end;
  val1 = around( val1/l_coeff );
  val2 = around( val2/l_coeff );

  setparm( 1, val1 );
  setparm( 2, val2 );

 END;

 ЗначПерем( "Атр301_13", Пред301_13, Атр301_13 );
 ЗначПерем( "Атр301_14", Пред301_14, Атр301_14 );
 ЗначПерем( "Атр301_15", Пред301_15, Атр301_15 );
 ЗначПерем( "Атр301_16", Пред301_16, Атр301_16 );

 ЗначПерем( "Атр301_18", Пред301_18, Атр301_18 );
 ЗначПерем( "Атр301_19", Пред301_19, Атр301_19 );
 ЗначПерем( "Атр301_20", Пред301_20, Атр301_20 );
 ЗначПерем( "Атр301_21", Пред301_21, Атр301_21 );

 ЗначПерем( "Атр301_28", Пред301_28, Атр301_28 );
 ЗначПерем( "Атр301_29", Пред301_29, Атр301_29 );
 ЗначПерем( "Атр301_30", Пред301_30, Атр301_30 );
 ЗначПерем( "Атр301_31", Пред301_31, Атр301_31 );
 ЗначПерем( "Атр301_32", Пред301_32, Атр301_32 );
 ЗначПерем( "Атр301_33", Пред301_33, Атр301_33 );
 ЗначПерем( "Атр301_34", Пред301_34, Атр301_34 );
 ЗначПерем( "Атр301_35", Пред301_35, Атр301_35 );
 ЗначПерем( "Атр301_36", Пред301_36, Атр301_36 );
 ЗначПерем( "Атр301_37", Пред301_37, Атр301_37 );

 ЗначПерем( "Атр301_39", Пред301_39, Атр301_39 );
 ЗначПерем( "Атр301_40", Пред301_40, Атр301_40 );
 ЗначПерем( "Атр301_41", Пред301_41, Атр301_41 );
 ЗначПерем( "Атр301_42", Пред301_42, Атр301_42 );
 ЗначПерем( "Атр301_43", Пред301_43, Атр301_43 );
 ЗначПерем( "Атр301_44", Пред301_44, Атр301_44 );
 ЗначПерем( "Атр301_45", Пред301_45, Атр301_45 );
 ЗначПерем( "Атр301_46", Пред301_46, Атр301_46 );
 ЗначПерем( "Атр301_47", Пред301_47, Атр301_47 );
 ЗначПерем( "Атр301_48", Пред301_48, Атр301_48 );

 ЗначПерем( "Атр301_60", Пред301_60, Атр301_60 );

END;

MACRO PrintHead()
[                                                                                                               ];
[┌────────┬───────┬──────────────────────┬─────────────────────┬──────────────────────┬────────────────────────┐];
[│ Строка │ Графа │     Наименование     │  Значение текущего  │ Значение предыдущего │  Изменение показателя  │];
[│        │       │      показателя      │  периода млн. руб   │  периода  млн. руб   │       млн.руб          │];
[├────────┼───────┼──────────────────────┼─────────────────────┼──────────────────────┼────────────────────────┤];
[│   1    │   2   │           3          │          4          │           5          │             6          │];
[├────────┴───────┴──────────────────────┴─────────────────────┴──────────────────────┴────────────────────────┤];
END;

MACRO ПечатьСост(Name)
var i = 0;
[├────────┼───────┼──────────────────────┼───────┬─────────────┼───────┬──────────────┼────────────────────────┤];
[│        │       │ В состав показателя  │ Номер │  Остаток    │ Номер │   Остаток    │ Абсолютное изменение   │];
[│        │       │ вошли балансовые     │  бал. │ за текущий  │  бал. │ за предыдущ. │ остатка текущего       │];
[│        │       │ счета, изменившие    │ счета │   период,   │ счета │    период,   │ периода по сравнению с │];
[│        │       │ свой остаток:        │       │  млн. руб   │       │   млн. руб   │ предыдущим, млн. руб   │];
 СписокСост(name) ;
[├────────┴───────┴──────────────────────┴───────┴─────────────┴───────┴──────────────┴────────────────────────┤];
END;

MACRO ПечатьИзменений(Name, str, val1, val2, gr, col, chap)

var sub = val1 - val2;

if(absval (sub) > MinConst)
  if(not Изменения)
   Изменения = TRUE;
   PrintHead;
  end;
  if(not ЕстьДанные)
   [│ ############################################################################################################│](chap:l:w);
   ЕстьДанные = TRUE;
  end;
 [├────────┬───────┬──────────────────────┬─────────────────────┬──────────────────────┬────────────────────────┤];
 [│ ###### │   #   │   ################   │ ################### │ #################### │ ###################### │]
 (gr:c:w, col:c:w, str:c:w, val1:c:w, val2:c:w, sub:c);
 ПечатьСост(Name);
end;
END;

/*точка входа*/ 
var sub;
if ( not ПроверитьЕдиницыИзмерения() )
  exit(1);
end;

l_coeff = 1;

ПолучитьДатыПредыдущегоПериода( DateBegin, DateEnd );

ПрочитатьПеремПредПериода;
                                  
[                                                                                                               ];
[                                      ИЗМЕНЕНИЕ ЗНАЧЕНИЙ ПО ФОРМЕ № 301                                        ];
[                  (ОТДЕЛЬНЫЕ ПОКАЗАТЕЛИ, ХАРАКТЕРИЗУЮЩИЕ ДЕЯТЕЛЬНОСТЬ КРЕДИТНОЙ ОРГАНИЗАЦИИ)                   ];
[                                                                                                               ];
[Период выпуска отчета: с ########## по ##########                                                              ](ПредДатаОтчета, ДатаОтчета);
[Предыдущий период выпуска отчета: с ########## по ##########                                                   ](DateBegin, DateEnd);
[                                                                                                               ];
ЕстьДанные = FALSE;
ПечатьИзменений( "Атр301_13", ПредпрРуб,  Атр301_13,  Пред301_13, "д/в", 3, ОКО ); 
ПечатьИзменений( "Атр301_14", ФизРуб,     Атр301_14,  Пред301_14, "д/в", 4, ОКО ); 
ПечатьИзменений( "Атр301_15", ПредпрВал,  Атр301_15,  Пред301_15, "д/в", 5, ОКО ); 
ПечатьИзменений( "Атр301_16", ФизВал,     Атр301_16,  Пред301_16, "д/в", 6, ОКО ); 
ПечатьИзменений( "Атр301_18", ПредпрРуб, Атр301_18, Пред301_18, "Срочн.", 3, ОКО ); 
ПечатьИзменений( "Атр301_19", ФизРуб,    Атр301_19, Пред301_19, "Срочн.", 4, ОКО ); 
ПечатьИзменений( "Атр301_20", ПредпрВал, Атр301_20, Пред301_20, "Срочн.", 5, ОКО ); 
ПечатьИзменений( "Атр301_21", ФизВал,    Атр301_21, Пред301_21, "Срочн.", 6, ОКО ); 

ЕстьДанные = FALSE;
ПечатьИзменений( "Атр301_28", ОргВластиРуб,  Атр301_28, Пред301_28, "До 1 года", 10, ТКО ); 
ПечатьИзменений( "Атр301_29", МестВластиРуб, Атр301_29, Пред301_29, "До 1 года", 11, ТКО ); 
ПечатьИзменений( "Атр301_30", ВнебФондыРуб,  Атр301_30, Пред301_30, "До 1 года", 12, ТКО ); 
ПечатьИзменений( "Атр301_31", ПредпрФизРуб,  Атр301_31, Пред301_31, "До 1 года", 13, ТКО );
ПечатьИзменений( "Атр301_32", ОргВластиВал,  Атр301_32, Пред301_32, "До 1 года", 14, ТКО ); 
ПечатьИзменений( "Атр301_33", МестВластиВал, Атр301_33, Пред301_33, "До 1 года", 15, ТКО ); 
ПечатьИзменений( "Атр301_34", ВнебФондыВал,  Атр301_34, Пред301_34, "До 1 года", 16, ТКО ); 
ПечатьИзменений( "Атр301_35", ПредпрФизВал,  Атр301_35, Пред301_35, "До 1 года", 17, ТКО ); 
ПечатьИзменений( "Атр301_39", ОргВластиРуб,  Атр301_39, Пред301_39, "Свыше 1 года", 10, ТКО ); 
ПечатьИзменений( "Атр301_40", МестВластиРуб, Атр301_40, Пред301_40, "Свыше 1 года", 11, ТКО ); 
ПечатьИзменений( "Атр301_41", ВнебФондыРуб,  Атр301_41, Пред301_41, "Свыше 1 года", 12, ТКО ); 
ПечатьИзменений( "Атр301_42", ПредпрФизРуб,  Атр301_42, Пред301_42, "Свыше 1 года", 13, ТКО ); 
ПечатьИзменений( "Атр301_43", ОргВластиВал,  Атр301_43, Пред301_43, "Свыше 1 года", 14, ТКО ); 
ПечатьИзменений( "Атр301_44", МестВластиВал, Атр301_44, Пред301_44, "Свыше 1 года", 15, ТКО ); 
ПечатьИзменений( "Атр301_45", ВнебФондыВал,  Атр301_45, Пред301_45, "Свыше 1 года", 16, ТКО ); 
ПечатьИзменений( "Атр301_46", ПредпрФизВал,  Атр301_46, Пред301_46, "Свыше 1 года", 17, ТКО ); 

ЕстьДанные = FALSE;
ПечатьИзменений( "Атр301_36", ИнАктивы,      Атр301_36, Пред301_36, "До 1 года",    18, ИА ); 
ПечатьИзменений( "Атр301_47", ИнАктивы,      Атр301_47, Пред301_47, "Свыше 1 года", 18, ИА ); 

ЕстьДанные = FALSE;
ПечатьИзменений( "Атр301_37", ИнПассивы,     Атр301_37, Пред301_37, "До 1 года",    19, ИП ); 
ПечатьИзменений( "Атр301_48", ИнПассивы,     Атр301_48, Пред301_48, "Свыше 1 года", 19, ИП ); 

ЕстьДанные = FALSE;
ПечатьИзменений( "Атр301_60", СобСредства,   Атр301_60, Пред301_60, "ИТОГО", 20, СС ); 
if( Изменения ) 
[└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘];
else
println("Отсутствуют показатели, изменившие по сравнению с прошлым периодом свое значение более чем на 1 млрд. рублей.");
end;
/* eof */