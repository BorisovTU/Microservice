/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                  R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Печать приложения 14. Глава 3.
└───────────────────────────────────────────────────────────────────────────*/
import pr_PRL14;

CLASS (RRG_PRL14_Report) RRG_PRL14_Report3()

    private var I99998 : RRG_PRL14_Itog;
    private var I99999 : RRG_PRL14_Itog;


    Macro ProcessBalance( Balance : RRG_PRL14_Balance, Parm : RRG_PRL14_Parm, level2Itog : RRG_PRL14_Itog, level1Itog : RRG_PRL14_Itog, partitionItog : RRG_PRL14_Itog )

        if   ( Balance.Balance() == "99998" )
            I99998.AddB(Balance);
        elif ( Balance.Balance() == "99999" )
            I99999.AddB(Balance);
        else
            ProcessBalance( Balance, Parm, level2Itog, level1Itog, partitionItog );
        end;

    End;

    Macro PrintItogActive( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
//        var Spod = Parm.Spod.getActivePassive();
        Itog.SubI( I99998 );

//        [#]( MakeString( " Итого по активу:" ) );
//        m_tableReport.PrintStringTransferByWord
//        ( "ИТОГО по активу", "", 
//            Pr( Itog.Sums()[RRG_IR], Parm ),
//            Pr( Itog.Sums()[RRG_IV], Parm ),
//            Pr( Itog.Sums()[RRG_IS], Parm ),
//            Pr( Spod[RRG_DR], Parm ),
//            Pr( Spod[RRG_DV], Parm ),
//            Pr( Spod[RRG_DS], Parm ),
//            Pr( Spod[RRG_CR], Parm ),
//            Pr( Spod[RRG_CV], Parm ),
//            Pr( Spod[RRG_CS], Parm ),
//            Pr( Itog.Sums()[RRG_OR], Parm ),
//            Pr( Itog.Sums()[RRG_OV], Parm ),
//            Pr( Itog.Sums()[RRG_OS], Parm )
//        );
//
//        Parm.Spod.clearActivePassive();
//        PrintSeparator();        
          PrintItogActive(parm, itog);
    End;

    Macro PrintItogPassive( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
//        var Spod = Parm.Spod.getActivePassive();
        Itog.SubI( I99999 );

//        [#]( MakeString( " Итого по пассиву:" ) );
//        m_tableReport.PrintStringTransferByWord
//        ( "ИТОГО по пассиву", "", 
//            Pr( Itog.Sums()[RRG_IR], Parm ),
//            Pr( Itog.Sums()[RRG_IV], Parm ),
//            Pr( Itog.Sums()[RRG_IS], Parm ),
//            Pr( Itog.Sums()[RRG_IS], Parm ),
//            Pr( Spod[RRG_DR], Parm ),
//            Pr( Spod[RRG_DV], Parm ),
//            Pr( Spod[RRG_DS], Parm ),
//            Pr( Spod[RRG_CR], Parm ),
//            Pr( Spod[RRG_CV], Parm ),
//            Pr( Spod[RRG_CS], Parm ),
//            Pr( Itog.Sums()[RRG_OR], Parm ),
//            Pr( Itog.Sums()[RRG_OV], Parm ),
//            Pr( Itog.Sums()[RRG_OS], Parm )
//        );
//
//        Parm.Spod.clearActivePassive();
//        if(Parm.isLastChapter)
//            PrintFooter();
//        else
//            PrintSeparator();
//        end;
        PrintItogPassive(parm, itog);
    End;

    private 
    Macro Constructor()
        InitRRG_PRL14_Report();

        I99998 = RRG_PRL14_Itog();
        I99999 = RRG_PRL14_Itog();
    End;

    Constructor();
END;
