/*
$Name:          rcb_lib.mac
$Module:        Регламентируемая отчетность
$Description:   для общих функций.
*/

/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                                 R-Style Softlab
  Библиотечный файл подсистемы "Регламентируемая отчетность"
  для общих функций.
└───────────────────────────────────────────────────────────────────────────*/
import ReptCbInter;
import rsbObjFactory;

/*Создание RS-Vox объекта с инициализацией параметров дат отчета*/
macro rcbGetObject(objectName : String)
    var obj = rsbObjectFactory.getObject(objectName);
    obj.SetParmValue( "BeginDate", String(ПредДатаОтчета:f));
    obj.SetParmValue( "EndDate",   String(ДатаОтчета:f));

    return obj;
end;


/**
 * Получить значение булевой переменной в виде значения
 * символьной переменной: UNSET_CHAR или SET_CHAR.
 *
 * @param isTrue Значение булевой переменной.
 *
 * @return Значение булевой переменной в виде символа
 *         (SET_CHAR или UNSET_CHAR).
 */
macro RcbCharBool( isTrue : Bool )
    if (isTrue)
        return "X";
    else
        return "";
    end;
end;

/**
 * Получить значение булевой переменной в виде строки
 * для подстановки в SQL-запрос: CHR(0) или 'X'.
 *
 * @param isTrue Значение булевой переменной.
 *
 * @return Значение булевой переменной в виде строки
 *         (CHR(0) или 'X').
 */
macro RcbSqlBool( isTrue : Bool )
    if (isTrue)
        return "'X'";
    else
        return "CHR(0)";
    end;
end;
