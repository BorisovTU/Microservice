/*
$Name:          f119ObjectFactory.mac
$Module:        Отчеты ЦБ
$Description:   Форма 119. Фабрика объектов.
*/

/**
 * Форма 119. Фабрика объектов.
 *
 * @since 29.03.2016
 * @author ABP
 * @version 6.20.031.035
 */
private class (RcbObjectFactoryBase) TF119ObjectFactoryImpl()
    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        defaultParm(isLazy, false);
        return genObject("TF119Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("TF119Part", partId, compositeValue);
    end;

    macro createAttribute(id : String, part : RcbPartBase, value : Object, properties : Object) : RcbAttributeBase
        if (in(part.getId(), TF119Global().getPart1Id(), TF119Global().getPart2Id(), TF119Global().getPart3Id()))
            return genObject("TF119Attribute", id, part, value, properties);
        else
            return null;
        end;
    end;

    macro createAttributeValue(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (in(part.getId(), TF119Global().getPart1Id(), TF119Global().getPart2Id(), TF119Global().getPart3Id()))
            return genObject("TF119AttributeValue", storage);
        else
            return null;
        end;
    end;

    macro createStandaloneAttributeValue(line : Integer, maxInterestRate : Money) : Object
        return genObject("TF119StandaloneAttributeValue", line, maxInterestRate);
    end;

    macro createAttributeProperties(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (in(part.getId(), TF119Global().getPart1Id(), TF119Global().getPart2Id(), TF119Global().getPart3Id()))
            return genObject("TF119AttributeProperties", storage);
        else
            return null;
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF119DataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF119DataSourceFilters");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF119CalculateProtocolView", protocolName);
    end;

    macro createPart1CalculateController(reportCalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part1CalculateController", reportCalculateController);
    end;

    macro createPart2CalculateController(reportCalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part2CalculateController", reportCalculateController);
    end;

    macro createPart3CalculateController(reportCalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part3CalculateController", reportCalculateController);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF119ReportCalculateController");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF119TuneTable", RCB_I3606_DATE);
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TF119PrintProtocolView", protocolName);
    end;

    macro createPartView(id : String, reportView : RcbReportView) : RcbReportView
        if (id == TF119Global().getPart1Id())
            return genObject("TF119Part1View", reportView);
        elif (id == TF119Global().getPart2Id())
            return genObject("TF119Part2View", reportView);
        elif (id == TF119Global().getPart3Id())
            return genObject("TF119Part3View", reportView);
        else
            return null;
        end;
    end;

    macro createReportView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF119ReportView", protocolView);
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF119ReportPrintController");
    end;
    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF119ExportKlikoController");
    end;
    macro createPtkPsdExportController()
        return genObject("TF119ExportPtkPsdController");
    end;

    macro createParametersReader(path : String, name : String)
        return genObject("TF119ParametersReader", path, name);
    end;

    macro createPart1RecalculateController(reportRecalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part1RecalculateController", reportRecalculateController);
    end;

    macro createPart2RecalculateController(reportRecalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part2RecalculateController", reportRecalculateController);
    end;

    macro createPart3RecalculateController(reportRecalculateController : RcbReportCalculateController) : Object
        return genObject("TF119Part3RecalculateController", reportRecalculateController);
    end;

    macro createReportRecalculateController()
        return genObject("TF119ReportRecalculateController");
    end;

    macro createResource()
        return genObject("TF119Resource");
    end;

    private macro constructorTF119ObjectFactoryImpl()
        initRcbObjectFactoryBase();
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF119PrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    constructorTF119ObjectFactoryImpl();
end;

private class (TF119ObjectFactoryImpl) TF119ObjectFactoryImpl_4212()
    initTF119ObjectFactoryImpl();

    macro createResource()
        return genObject("TF119Resource_4212");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF119PrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF119ReportPrintController_4212");
    end;
end;

if (objectFactoryInstance == null)
    if (RcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TF119ObjectFactoryImpl_4212();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3606_DATE)
        objectFactoryInstance = TF119ObjectFactoryImpl();
    else
        objectFactoryInstance = null;
    end;
end;
