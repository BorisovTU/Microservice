/*
$Name:          f119AttributeProperties.mac
$Module:        Отчеты ЦБ
$Description:   Форма 119. Класс свойств атрибута.
*/

/**
 * Форма 119. Класс свойств атрибута.
 * Отвечает как за хранимые в БД (переменной) свойства, так и за свойства, существующие только при отработке какой-то операции
 *
 * @since 29.03.2016
 * @author ABP
 * @version 6.20.031.035
 */
class TF119AttributeProperties(storage : RcbCompositeValue)
    private const RETAIL_ACCOUNT_MASK_INDEX = 0;
    private const CB_ACCOUNT_MASK_INDEX = 1;
    private const DEPOSITS_ACCOUNT_MASK_INDEX = 2;

    private var m_storage : RcbCompositeValue;

    private var m_accountMask : Object;
    private var m_partId : String;

    macro getAccountMask(backOffice)
        var mask = "";

        if (backOffice == BOCB)
            mask = m_accountMask[CB_ACCOUNT_MASK_INDEX];
        elif (backOffice == BORetail)
            mask = m_accountMask[RETAIL_ACCOUNT_MASK_INDEX];
        elif (backOffice == BODeposits)
            mask = m_accountMask[DEPOSITS_ACCOUNT_MASK_INDEX];
        else
            mask = "";
        end;

        return mask;
    end;

    macro setAccountMask(backOffice, mask : String)
        mask = nvl(mask, "");

        if (backOffice == BOCB)
            m_accountMask[CB_ACCOUNT_MASK_INDEX] = mask;
        elif (backOffice == BORetail)
            m_accountMask[RETAIL_ACCOUNT_MASK_INDEX] = mask;
        elif (backOffice == BODeposits)
            m_accountMask[DEPOSITS_ACCOUNT_MASK_INDEX] = mask;
        end;

        return this;
    end;

    macro getPartId()
        return m_partId;
    end;

    macro setPartId(partId)
        m_partId = partId;
        return this;
    end;

    private macro constructorTF119AttributeProperties(storage : RcbCompositeValue)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF119AttributeProperties::constructorTF119AttributeProperties"));
        end;

        if (storage == null)
            throw(TUnspecifiedValueException("TF119AttributeProperties::constructorTF119AttributeProperties", "storage"));
        end;

        if (    (valType(storage) != V_GENOBJ)
            and (isEqClass("RcbCompositeValue", storage))
           )
            throw(TIncorrectParameterTypeException("TF119AttributeProperties::constructorTF119AttributeProperties", "storage"));
        end;

        m_storage = storage;
        m_accountMask = RcbArray();
        m_partId = 0;
    end;

    constructorTF119AttributeProperties(storage);
end;
