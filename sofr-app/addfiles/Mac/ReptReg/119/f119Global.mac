/*
$Name:          f119Global.mac
$Module:        Отчеты ЦБ
$Description:   Форма 119. Класс глобализмов.
*/

/**
 * Форма 119. Класс глобализмов.
 *
 * @since 29.03.2016
 * @author ABP
 * @version 6.20.031.035
 */
private class (TGlobalBase) TF119GlobalImpl()
    private var m_rcbReport : RcbReport;

    macro getRcbReport() : RcbReport
        return m_rcbReport;
    end;

    macro getPart1Id() : String
        return "PART1";
    end;

    macro getPart2Id() : String
        return "PART2";
    end;

    macro getPart3Id() : String
        return "PART3";
    end;

    macro getPartId(number : Integer) : String
        if (number == 1)
            return getPart1Id();
        elif (number == 2)
            return getPart2Id();
        elif (number == 3)
            return getPart3Id();
        end;

        return null;
    end;

    private macro constructorTF119Global()
        initTGlobalBase();
        m_rcbReport = RcbApplication().currentReport;
        initializeRepDataPackage(m_rcbReport);

        /* Инициализация объекта "Полная стоимость вклада" */
        FillCostDepEmp(getRcbReport().context.period.beginDate, getRcbReport().context.period.endDate, 0 /* Расчет ПСВ по всем договорам за период */);
    end;

    constructorTF119Global();
end;

macro TF119Global() : TF119GlobalImpl
    if (v_global == null)
        v_global = TF119GlobalImpl();
    end;

    return v_global;
end;