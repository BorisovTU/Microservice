/*
$Name:          ex_xml711.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 711. Контроллер экспорта в XML-формате в ПК Дельта
*/

import rcbimport;
import com_f711;

private class (RcbReportBase) T711RcbReportBase(report : RcbReport, isLazy : Bool)
    initRcbReportBase(report, isLazy);

    macro initialize()
    end;
end;

private class (RcbObjectFactoryBase) T711ObjectFactory(/*instructionDate : Date*/)
    macro createReport(report : RcbReport) /*: RcbReportBase*/
        return genObject("T711RcbReportBase", report);
    end;

    macro createReportView(report : RcbReportBase, formOkudCode : String, formPeriodicity, periodFormat, protocolView : RcbPrintProtocolView)
        return genObject("RcbReportView", "ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", formOkudCode, formPeriodicity, periodFormat, protocolView);
    end;

    macro createXmlExportProtocolView(protocolName : String, reportName : String) : TXmlProtocolView
        return genObject("TXmlProtocolView", "", reportName, "0409711");
    end;
end;

objectFactoryInstance = T711ObjectFactory();

/**
 * Форма 711. Контроллер.
 *
 * @autor   const1995
 * @since   24.06.2022
 * @version 6.20.031.78
 */

class (TRcbXmlExportController) TF711ExportXmlControllerBase()
    const TYPE_DATE   = 1;
    const TYPE_STRING = 2;
    const TYPE_NUMBER = 3;

    private var m_part                    : Object = null;
    private var m_row;

    private class TSyncSorterPart()
        macro isLess(lhs : Object, rhs : Object)
            return nvl(lhs.fieldValue("counter").exact, -1) < nvl(rhs.fieldValue("counter").exact, -1);
        end;
    end;
    /*
    private macro printNotNullRow(rowCode, value)
        if((value != "") AND (value != null) AND (value != 0) AND (value != "0"))
           m_view.printRow(rowCode, value);
        end;
    end;
    */
    /**
     * Поле типа "Дата"
     * @param value - форматируемая дата
     */
    private macro formatDate(value : String) : String
        var day, month, year;
        var val = trim(value);

        if ((val == null) or (val == "") or (date(val) == date(0,0,0)))
            return "";
        end;

        dateSplit(date(val), day, month, year);

        return string(year:4:o) + "-" + string(month:2:o) + "-" + string(day:2:o);
    end;

    private macro formatString(value : Variant, width : Integer, precision : Integer) : String
        defaultParm(precision, 0);
        defaultParm(width, 0);

        var result;

        if (value == null)
            result = "";
        elif (value == 0)
            if (precision != null)
                result = trim(string(value : * : *, 30, precision));
            else
                result = "0";
            end;
        else
            if (precision == 0)
                if ((width != 0) and (strlen(value) > width))
                    result = substr(value, 1, width);
                else
                    result = value;
                end;
            else
                result = trim(string(value : * : *, width, precision));
            end;
        end;

        return result;
    end;

    /**
     * Поле типа "Ч(n.m)"
     * @param value - форматируемое число
     * @param width - ширина поля вывода
     * @param precision - точность
     */
    private macro formatNumber(value : Variant, width : Integer, precision : Integer) : String
        var result;

        if   ((value == null) or (value == ""))
            result = trim(string(0 : * : *, width, precision));
        elif ((value != null) )
            result = trim(string(value : * : *, width, precision));
        else
            result = "0";
        end;

        return result;
    end;

    /**
     * Форматирование строки для экспорта
     * @param value - форматируемая значение
     * @param type - тип формата
     * @param parm1 - количество знаков всего/длина строки для экспорта
     * @param parm2 - количество знаков после запятой (если 0 - выводится как целое)
     */
    private macro format(value : Variant, type : Integer, parm1 : Integer, parm2 : Integer) : String
        var result;

        if   (type == TYPE_DATE)
            result = formatDate(value);
        elif (type == TYPE_STRING)
            result = formatString(value, parm1, parm2);
        elif (type == TYPE_NUMBER)
            result = formatNumber(value, parm1, parm2);
        else
            //            throw(TIllegalFieldTypeException(type));
        end;

        return result;
    end;

    macro getValue(value, name)
        var result;

        if (value != null)
            result = value.fieldValue(name);
        end;

        if (result != null)
            result = result.exact;
        else
            msgbox("Не найдено значение поля \"" + name + "\"");
        end;

        return result;
    end;

    private macro getInnValue(value, innField, tinField, nameField)
        if ((nameField != null) and (getValue(value, nameField) == ""))
            return "";
        end;

        var innValue = getValue(value, innField);
        return ternary(in(getValue(value, tinField), "1", "2", "3", "4"), innValue, "");
    end;
    /*
    private macro getTINPZValue(value, field)
        var rvalue = getValue(value, field);
        return ternary(rvalue == "", "NN", rvalue);
    end;
    */
    private macro getTinValue(value, innField, tinField, nameField)
        if ((nameField != null) and (getValue(value, nameField) == ""))
            return "";
        end;

        var tinValue = getValue(value, tinField);
        return ternary(in(getValue(value, innField), "2", "4"), tinValue, "");
    end;

    private macro getOkved(value : string)
        var ind = index(value, ".");
        if(ind == 0)
            ind = 3;
        end;

        return subStr(value, 1, ind-1);
    end;
    /*
    private macro getFaceValue(it, faceValName, codeName) : Money
        var value = getValue(it, faceValName);

        return value;
    end;
    */
    private macro addNotEmpty(attributeName, value, fmt, width : Integer, precision : Integer)
        if ((value != " ") AND (value != "") AND (value != null) AND (value != "0000-00-00"))
            m_row.add(attributeName , format(value, fmt, width, precision));
        end;
    end;

    private macro printPart11()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",               format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеДК",        getValue(value, "КорреспНаим"), TYPE_STRING, 255);
                addNotEmpty("ПризнакДК_ЮЛ",          getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаНерез",      getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3);
                if (getValue(value, "КорреспИНН_Признак") == "1")
                    addNotEmpty("ИНН_ДК",            getValue(value, "КорреспИНН"), TYPE_STRING, 12);
                end;
                if (getValue(value, "КорреспИНН_Признак") == "2")
                    addNotEmpty("TIN_ДК",            getValue(value, "КорреспИНН"), TYPE_STRING);
                end;
                addNotEmpty("КПП_ДК",                getValue(value, "КорреспКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_ДК",               getValue(value, "КорреспОГРН"), TYPE_STRING);
                addNotEmpty("КодСтр_ДК",             getValue(value, "КорреспОКСМ"), TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_ДК",    getValue(value, "КорреспНомерЛицензии"), TYPE_STRING);
                addNotEmpty("ПризнакДК",             getValue(value, "КорреспПризнак"), TYPE_STRING, 1);
                addNotEmpty("НомСчета",              getValue(value, "КорреспНомерСчета"), TYPE_STRING, 40);
                addNotEmpty("НаименованиеЭм",        getValue(value, "ЭмитентНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",             getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",    getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",            getValue(value, "ЭмитентИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",            getValue(value, "ЭмитентИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Эм",                getValue(value, "ЭмитентКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Эм",               getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",              getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",             getValue(value, "ЦБКодТипа"), TYPE_STRING);
                addNotEmpty("НомРегЦБ",              getValue(value, "ЦБНомерГосРег"), TYPE_STRING);
                addNotEmpty("ISIN",                  getValue(value, "ЦБISIN"), TYPE_STRING, 12);
                addNotEmpty("КодВал",                getValue(value, "ЦБВалюта"), TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",            getValue(value, "ЦБНоминал"), TYPE_STRING, 30, 8);
                addNotEmpty("КолЦБ",                 getValue(value, "КоличествоПоСчету"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрВсего",      getValue(value, "ВсегоОбрем"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗалог",      getValue(value, "Залог"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрСчДепо",     getValue(value, "ТогрСчета"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрКорпДейств", getValue(value, "ОгранКД"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗапрОп",     getValue(value, "ЗапретОпер"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрАрест",      getValue(value, "Арест"), TYPE_STRING, 0, 6);
                addNotEmpty("НаимОрг",               getValue(value, "МХНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",            getValue(value, "МХПризнак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",          getValue(value, "МХИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",   getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",           getValue(value, "МХИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",           getValue(value, "МХИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Орг",               getValue(value, "МХКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Орг",              getValue(value, "МХОГРН"), TYPE_STRING);
                addNotEmpty("КодСтр_Орг",            getValue(value, "МХОКСМ"), TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",   getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14);
                addNotEmpty("НомСчДепо",             getValue(value, "МХНомерСчёта"), TYPE_STRING, 40);
                m_view.printRow("ЦБнаСчДепоНД", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart12()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",       getValue(value, "ЭмитентНаименование"), TYPE_STRING, 255)                    ;
                addNotEmpty("ПризнакЭм",            getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1)                       ;
                addNotEmpty("ПризнакКодаЭмНерез",   getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3)                   ;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",   getValue(value, "ЭмитентИНН"), TYPE_STRING, 12)                                      ;
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",   getValue(value, "ЭмитентИНН"), TYPE_STRING, 30)                                  ;
                end;
                addNotEmpty("КПП_Эм",               getValue(value, "ЭмитентКПП"), TYPE_STRING, 9)                               ;
                addNotEmpty("ОГРН_Эм",              getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15)                                 ;
                addNotEmpty("КодСтрЭм",             getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3)                              ;
                addNotEmpty("КодТипаЦБ",            getValue(value, "ЦБКодТипа"), TYPE_STRING)                                   ;
                addNotEmpty("НомРегЦБ",             getValue(value, "ЦБНомерГосРег"), TYPE_STRING)                               ;
                addNotEmpty("ISIN",                 getValue(value, "ЦБISIN"), TYPE_STRING)                                      ;
                addNotEmpty("КодВалК",              getValue(value, "ЦБВалюта"), TYPE_STRING, 3)                                 ;
                addNotEmpty("ВидСчета",             getValue(value, "ВидСчётаДепо"), TYPE_STRING)           ;
                addNotEmpty("НомСтоимЦБ",           getValue(value, "ЦБНоминал"), TYPE_STRING, 30, 8)           ;
                addNotEmpty("КолЦБ",                getValue(value, "КоличествоПоСчету"), TYPE_STRING, 0, 6)                     ;
                addNotEmpty("КЦБОбремВсего",        getValue(value, "ВсегоОбрем"), TYPE_STRING, 0, 6)                            ;
                addNotEmpty("КЦБОбремВЗалоге",      getValue(value, "Залог"), TYPE_STRING, 0, 6)                                 ;
                addNotEmpty("КЦБОбремСчДепо",       getValue(value, "ТогрСчета"), TYPE_STRING, 0, 6)                             ;
                addNotEmpty("КЦБОбремКорпДейст",    getValue(value, "ОгранКД"), TYPE_STRING, 0, 6)                               ;
                addNotEmpty("КЦБОбремЗапретОп",     getValue(value, "ЗапретОпер"), TYPE_STRING, 0, 6)                            ;
                addNotEmpty("КЦБОбремАрест",        getValue(value, "Арест"), TYPE_STRING, 0, 6)                                 ;
                addNotEmpty("КодСекторЭк",          getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING)                    ;
                addNotEmpty("КодСтрВладельца",      getValue(value, "СВ_ОКМС"), TYPE_STRING, 3)                                  ;
                addNotEmpty("НаимОрг",              getValue(value, "МХНаименование"), TYPE_STRING, 255)                         ;
                addNotEmpty("ПризнакОрг",           getValue(value, "МХПризнак"), TYPE_STRING, 1)                            ;
                addNotEmpty("ПризнакОргЮЛ",         getValue(value, "МХИНН_Признак"), TYPE_STRING, 1)                                ;
                addNotEmpty("ПризнакКодаОргНерез",  getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3)                   ;
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",            getValue(value, "МХИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",            getValue(value, "МХИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Орг",              getValue(value, "МХКПП"), TYPE_NUMBER);
                addNotEmpty("ОГРН_Орг",             getValue(value, "МХОГРН"), TYPE_STRING)                                      ;
                addNotEmpty("КодСтр_Орг",           getValue(value, "МХОКСМ"), TYPE_STRING, 3)                                   ;
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",  getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14)                         ;
                addNotEmpty("ДатаВыдЛиц" ,          getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE)                        ;
                addNotEmpty("ЛиценОрган",           getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254)                  ;
                m_view.printRow("ЦБнаСчДепо", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart121()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм", getValue(value, "ЭмитентНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",      getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез", getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",     getValue(value, "ЭмитентИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",       getValue(value, "ЭмитентИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Эм",         getValue(value, "ЭмитентКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Эм",        getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",       getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",      getValue(value, "ЦБКодТипа"), TYPE_STRING, 5);
                addNotEmpty("НомРегЦБ",       getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21);
                addNotEmpty("ISIN",           getValue(value, "ЦБISIN"), TYPE_STRING, 12);
                addNotEmpty("КодВал",         getValue(value, "ЦБВалюта"), TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",     getValue(value, "ЦБНоминал"), TYPE_STRING, 29, 8);
                addNotEmpty("ОбПриемЦБ",      getValue(value, "ПриемЦБ"), TYPE_STRING, 29, 6);
                addNotEmpty("ОбСнятиеЦБ",     getValue(value, "СнятиеЦБ"), TYPE_STRING, 29, 6);
                addNotEmpty("ОбПереводЦб",    getValue(value, "ПереводЦБ"), TYPE_NUMBER, 16, 4);
                m_view.printRow("ДепОперЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart13()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        var appCode = "F711_0103";
        var rowCode;

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                   format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Эм",                   getValue(value, "ЭмитентКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"), TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"), TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"), TYPE_STRING);
                addNotEmpty("КодВалК",                  getValue(value, "ЦБВалюта"), TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"), TYPE_STRING, 30, 8);
                addNotEmpty("КЦБСобствВсего",           getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСобствНаБС",            getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦББезПризСделкиРепо",     getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПоСделкЗайма",          getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбязОтсут",             getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБВложБезнадеж",          getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОшибЗачисл",            getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБДрПричины",             getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСчДовУпр",              getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБКазнСчЭм",              getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЭмисСчет",              getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрВсего",         getValue(value, "ВсегоОбрем"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗалог",         getValue(value, "Залог"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрСчДепо",        getValue(value, "ТогрСчета"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрКорпДейств",    getValue(value, "ОгранКД"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗапрОп",        getValue(value, "ЗапретОпер"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрАрест",         getValue(value, "Арест"), TYPE_STRING, 0, 6);
                addNotEmpty("НаимОргВедУчет",           getValue(value, "МХНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризОргВедУчет",           getValue(value, "МХПризнак"), TYPE_STRING, 3);
                addNotEmpty("ПризнакОргВедУчет",        getValue(value, "МХИНН_Признак"), TYPE_STRING, 3);
                addNotEmpty("ПризнакКодаОргВедНерез",   getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_ОргВедУчет",       getValue(value, "МХИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_ОргВедУчет",       getValue(value, "МХИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_ОргВедУчет",           getValue(value, "МХКПП"), TYPE_STRING, 12);
                addNotEmpty("ОГРН_ОргВедУчет",          getValue(value, "МХОГРН"), TYPE_STRING, 15);
                addNotEmpty("КодСтрОргВедУчет",         getValue(value, "МХОКСМ"), TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",      getValue(value, "МХНомерЛицензии"), TYPE_STRING, 18);
                addNotEmpty("ДатаВыдЛиц",               getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE);
                addNotEmpty("ЛиценОрган",               getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254);
                m_view.printRow("ЦБнаПравеСобств", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart14()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                     format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"), TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 4);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Эм",                   getValue(value, "ЭмитентКПП"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3);
                addNotEmpty("КодВД",                    getOkved(getValue(value, "ЭмитентОКВЭД")), TYPE_STRING);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"), TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"), TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"), TYPE_STRING, 12);
                addNotEmpty("КодВал",                   getValue(value, "ЦБВалюта"), TYPE_STRING);
                addNotEmpty("КолЦБ",                    getValue(value, "КоличествоЦБ"), TYPE_STRING);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"), TYPE_STRING, 30, 8);
                addNotEmpty("БалансСтоим",              getValue(value, "ОбъемВложений")/1000.0, TYPE_STRING, 0, 4);
                addNotEmpty("НомерБалСч",               getValue(value, "БалансСчет"), TYPE_STRING);
                addNotEmpty("НакопКупДоход",            getValue(value, "НКД"), TYPE_STRING);
                addNotEmpty("ПереоцЦБ",                 getValue(value, "ОтрицПоложПереоценка")/1000.0, TYPE_STRING, 0, 4);
                addNotEmpty("КорректСтоимДолгЦБ",       getValue(value, "Корр_СС_ПП")/1000.0, TYPE_STRING, 0, 4);
                addNotEmpty("УровеньДанных",            getValue(value, "УровеньИДвиерархииСС"), TYPE_STRING);
                addNotEmpty("КатКач",                   getValue(value, "КатКачества"), TYPE_NUMBER, 0, 0);
                addNotEmpty("РасчетРезервВозмПотери",   StrSubst(getValue(value, "РезервПроцент"),"%",""), TYPE_NUMBER, 3, 2);
                addNotEmpty("РезервВозмПотери",         getValue(value, "Резерв")/1000.0, TYPE_STRING, 0, 4);
                addNotEmpty("КорректРезервВозмПотери",  getValue(value, "Корр_резерва_ВП")/1000.0, TYPE_STRING, 0, 4);
                m_view.printRow("БалСтоимВлож", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart21()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                         format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("Векселедатель",                getValue(value, "issuerName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакВекселедат",            getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаВекселедатНерез",   getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 12);
                if (in(getValue(value, "IssuerINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Векселедатель",        getValue(value, "issuerInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "IssuerINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Векселедатель",        getValue(value, "issuerInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Векселедатель",           getValue(value, "issuerOgrn"), TYPE_STRING);
                addNotEmpty("КодСтрВекселедатель",          getValue(value, "issuerOksm"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                    getValue(value, "code711"), TYPE_STRING);
                addNotEmpty("СерияВекселя",                 getValue(value, "series"), TYPE_STRING);
                addNotEmpty("НомерВекселя",                 getValue(value, "number"), TYPE_STRING);
                addNotEmpty("НомерБланка",                  getValue(value, "formNumber"), TYPE_STRING);
                addNotEmpty("ИдКодВекселя",                 getValue(value, "identifiercode"), TYPE_STRING, 100);
                addNotEmpty("ДатаСост",                     getValue(value, "issueDate"), TYPE_DATE);
                addNotEmpty("СрокУсловия",                  getValue(value, "paymentTerm"), TYPE_STRING);
                addNotEmpty("ВДата1",                       getValue(value, "TermDate1"), TYPE_DATE);
                addNotEmpty("ВДата2",                       getValue(value, "TermDate2"), TYPE_DATE);
                addNotEmpty("ПроцентСтавка",                getValue(value, "PercentRate"), TYPE_STRING, 0, 3);
                addNotEmpty("ВексСумма",                    getValue(value, "faceValue"), TYPE_STRING, 0, 4);
                addNotEmpty("КодВалВекс",                   getValue(value, "faceValueFiCode"), TYPE_STRING, 3);
                addNotEmpty("БалСтомВексУчет",              getValue(value, "BuyCost"), TYPE_STRING, 0, 4);
                addNotEmpty("БалансСтоимВекс",              getValue(value, "BalanceCost"), TYPE_STRING, 0, 4);
                addNotEmpty("Дисконт",                      getValue(value, "interest"), TYPE_STRING, 0, 4);
                addNotEmpty("ПереоцВекс",                   getValue(value, "OvervalueBill"), TYPE_STRING, 0, 4);
                addNotEmpty("КорректСтоимВекс",             getValue(value, "AdjustCost"), TYPE_STRING, 0, 4);
                addNotEmpty("КатКач",                       getValue(value, "QualityCateg"), TYPE_NUMBER, 0, 0);
                addNotEmpty("СформРезерв",                  getValue(value, "ReserveSum"), TYPE_STRING, 0, 4);
                addNotEmpty("КорректРезерв",                getValue(value, "AdjustReserv"), TYPE_STRING, 0, 4);
                addNotEmpty("ДатаПринятия",                 getValue(value, "dealDate"), TYPE_DATE);
                addNotEmpty("ОснованиеПриобр",              getValue(value, "dealGround"), TYPE_STRING, 255);
                addNotEmpty("Контрагент",                   getValue(value, "dealAgentName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакКА",                    getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаКАНерез",           getValue(value, "dealAgentInn_CodeKind"), TYPE_STRING, 3);
                if (in(getValue(value, "DealAgentINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_КА",                   getValue(value, "dealAgentInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "DealAgentINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_КА",                   getValue(value, "dealAgentInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_КА",                      getValue(value, "dealAgentOGRN"), TYPE_STRING);
                addNotEmpty("КодСтрКА",                     getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 3);
                addNotEmpty("НомерБалСч",                   getValue(value, "balanceAccount"), TYPE_STRING);
                addNotEmpty("МестонахождениеВекс",          getValue(value, "storagePlaceName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакВдж",                   getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 12);
                addNotEmpty("ПризнакКодаВджНерез",          getValue(value, "storagePlaceInn_CodeKind"), TYPE_STRING, 1);
                if (in(getValue(value, "StoragePlaceINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Вдж",                  getValue(value, "storagePlaceInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "StoragePlaceINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Вдж",                  getValue(value, "storagePlaceInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Вдж",                     getValue(value, "storagePlaceOGRN"), TYPE_STRING);
                addNotEmpty("КодСтрВдж",                    getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 3);
                addNotEmpty("ОснованиеНахождения",          getValue(value, "storageGround"), TYPE_STRING, 255);
                addNotEmpty("СтоимРеализ",                  getValue(value, "SaleCost"), TYPE_STRING, 0, 4);
                addNotEmpty("ДатаСписания",                 getValue(value, "SaleDate"), TYPE_DATE);
                addNotEmpty("ОснованиеВыб",                 getValue(value, "SaleGround"), TYPE_STRING);
                addNotEmpty("КАПоСделке",                   getValue(value, "SaleAgentName"), TYPE_STRING);
                addNotEmpty("ПризнакКАПоСделке",            getValue(value, "SaleAgentINN_Mark"), TYPE_STRING);
                addNotEmpty("ПризнакКодаКАПоСделкеНерез",   getValue(value, "SaleAgentINN_CodeKind"), TYPE_STRING, 3);
                if (in(getValue(value, "SaleAgentINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_КАПоСделке",           getValue(value, "SaleAgentINN"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "SaleAgentINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_КАПоСделке",           getValue(value, "SaleAgentINN"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_КАПоСделке",              getValue(value, "SaleAgentOGRN"), TYPE_STRING);
                addNotEmpty("КодСтрКАПоСделке",             getValue(value, "SaleAgentCountryCode"), TYPE_STRING, 3);
                addNotEmpty("Примечание",                   getValue(value, "note"), TYPE_STRING);
                m_view.printRow("УчтенныеВекселя", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart22()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                         format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("СерияВекселя",                 getValue(value, "series"), TYPE_STRING);
                addNotEmpty("НомерВекселя",                 getValue(value, "number"), TYPE_STRING);
                addNotEmpty("НомерБланка",                  getValue(value, "formNumber"), TYPE_STRING);
                addNotEmpty("ИдКодВекселя",                 getValue(value, "identifiercode"), TYPE_STRING, 100);
                addNotEmpty("ДатаСост",                     getValue(value, "issueDate"), TYPE_DATE);
                addNotEmpty("СрокУсловия",                  getValue(value, "paymentTerm"), TYPE_STRING);
                addNotEmpty("ВДата1",                       getValue(value, "TermDate1"), TYPE_DATE);
                addNotEmpty("ВДата2",                       getValue(value, "TermDate2"), TYPE_DATE);
                addNotEmpty("ПроцентСтавка",                getValue(value, "PercentRate"), TYPE_STRING, 0, 3);
                addNotEmpty("ВексСумма",                    getValue(value, "faceValue"), TYPE_STRING, 0, 4);
                addNotEmpty("КодВалВекс",                   getValue(value, "faceValueFiCode"), TYPE_STRING, 3);
                addNotEmpty("СтоимРеализ",                  getValue(value, "SaleCost"), TYPE_STRING, 0, 4);
                addNotEmpty("ПервыйВдж",                    getValue(value, "firstHolderName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакПервыйВдж",             getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаПервыйВджНерез",    getValue(value, "firstHolderInn_CodeKind"), TYPE_STRING, 3);
                if (in(getValue(value, "FirstHolderINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_ПервыйВдж",            getValue(value, "firstHolderInn"), TYPE_STRING, 30);
                end;
                if (in(getValue(value, "FirstHolderINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_ПервыйВдж",            getValue(value, "firstHolderInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_ПервыйВдж",               getValue(value, "firstHolderOGRN"), TYPE_STRING);
                addNotEmpty("КодСтрПервыйВдж",              getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3);
                addNotEmpty("НомерБалСч",                   getValue(value, "balanceAccount"), TYPE_STRING);
                addNotEmpty("СостояниеВекс",                getValue(value, "state"), TYPE_STRING, 2);
                addNotEmpty("ДатаФактПогаш",                getValue(value, "repaymentDate"), TYPE_DATE);
                addNotEmpty("ВджНаим",                      getValue(value, "holderName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакВджт",                  getValue(value, "HolderINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаВджтНерез",         getValue(value, "holderInn_CodeKind"), TYPE_STRING, 3);
                if (in(getValue(value, "HolderINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Вджт",                 getValue(value, "holderInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "HolderINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Вджт",                 getValue(value, "holderInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Вджт",                    getValue(value, "holderOgrn"), TYPE_STRING);
                addNotEmpty("КодСтрВдж",                    getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 3);
                addNotEmpty("Примечание",                   getValue(value, "note"), TYPE_STRING);
                m_view.printRow("ВыпущенВекселя", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart23()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                         getValue(value, "counter"), TYPE_STRING, 5);
                addNotEmpty("Векселедатель",                getValue(value, "issuerName"), TYPE_STRING, 255);
                addNotEmpty("ПризнакВекселедат",            getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаВекселедатНерез",   getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 12);
                if (in(getValue(value, "IssuerINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Векселедатель",        getValue(value, "issuerInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "IssuerINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Векселедатель",        getValue(value, "issuerInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Векселедатель",           getValue(value, "issuerOgrn"), TYPE_STRING);
                addNotEmpty("КодСтрВекселедатель",          getValue(value, "issuerOksm"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                    getValue(value, "code711"), TYPE_STRING);
                addNotEmpty("СерияВекселя",                 getValue(value, "series"), TYPE_STRING);
                addNotEmpty("НомерВекселя",                 getValue(value, "number"), TYPE_STRING);
                addNotEmpty("НомерБланка",                  getValue(value, "formNumber"), TYPE_STRING);
                addNotEmpty("ИдКодВекселя",                 getValue(value, "identifiercode"), TYPE_STRING, 100);
                addNotEmpty("ДатаСост",                     getValue(value, "issueDate"), TYPE_DATE);
                addNotEmpty("СрокУсловия",                  getValue(value, "paymentTerm"), TYPE_STRING, 2);
                addNotEmpty("ВДата1",                       getValue(value, "TermDate1"), TYPE_DATE);
                addNotEmpty("ВДата2",                       getValue(value, "TermDate2"), TYPE_DATE);
                addNotEmpty("ПроцентСтавка",                getValue(value, "PercentRate"), TYPE_STRING);
                addNotEmpty("ВексСумма",                    getValue(value, "faceValue"), TYPE_STRING, 0, 4);
                addNotEmpty("КодВалВекс",                   getValue(value, "faceValueFiCode"), TYPE_STRING, 3);
                addNotEmpty("ДатаПоступления",              getValue(value, "dealDate"), TYPE_DATE);
                addNotEmpty("Основания",                    getValue(value, "dealGround"), TYPE_STRING, 255);
                addNotEmpty("Векселедержатель",             getValue(value, "holderName"), TYPE_STRING);
                addNotEmpty("СтатусВекселедерж",            getValue(value, "HolderState"), TYPE_STRING);
                addNotEmpty("ПризнакВекселедерж",           getValue(value, "HolderINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаВекселедержНерез",  getValue(value, "holderInn_CodeKind"), TYPE_STRING, 3);
                if (in(getValue(value, "HolderINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Векселедерж",          getValue(value, "holderInn"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "HolderINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Векселедерж",          getValue(value, "holderInn"), TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Векселедерж",             getValue(value, "HolderOgrn"), TYPE_STRING);
                addNotEmpty("КодСтрВекселедерж",            getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3);
                addNotEmpty("СостояниеВекселя",             getValue(value, "state"), TYPE_STRING);
                addNotEmpty("СубъектАвАкВек",               getValue(value, "avalacept"), TYPE_STRING, 2);
                addNotEmpty("Примечание",                   getValue(value, "note"), TYPE_STRING);
                m_view.printRow("ВексПринадлТрЛицам", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart3()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",                         getValue(value, "counter"), TYPE_STRING, 5);
                addNotEmpty("НаименованиеЭм",               getValue(value, "IssuerName"), TYPE_STRING);
                addNotEmpty("ПризнакЭм",                    getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",           getValue(value, "IssuerINN_CodeKind"), TYPE_STRING, 12);
                if (in(getValue(value, "IssuerINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Эм",                   getValue(value, "IssuerINN"), TYPE_STRING, 12);
                end;
                if (in(getValue(value, "IssuerINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Эм",                   getValue(value, "IssuerINN"), TYPE_STRING, 30);
                end;
                addNotEmpty("КПП_Эм",                       getValue(value, "IssuerKPP"), TYPE_STRING, 9);
                addNotEmpty("ОГРН_Эм",                      getValue(value, "IssuerOGRN"), TYPE_STRING);
                addNotEmpty("КодСтрЭм",                     getValue(value, "IssuerCountryCode"), TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                    getValue(value, "Code711"), TYPE_STRING);
                addNotEmpty("НомРегЦБ",                     getValue(value, "LSIN"), TYPE_STRING);
                addNotEmpty("ISIN",                         getValue(value, "ISIN"), TYPE_STRING, 12);
                addNotEmpty("КодВал",                       getValue(value, "FaceValueFICode"), TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",                   getValue(value, "FaceValue"), TYPE_STRING, 0, 8);
                addNotEmpty("КЦБПрямРепо",                  getValue(value, "SaleREPOAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСделЗайм",                  getValue(value, "TransLoanAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбратРепо",                 getValue(value, "BuyREPOAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПолучСделЗайм",             getValue(value, "AcceptLoanAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБДовУпр",                    getValue(value, "TransDUAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПраваДовУпр",               getValue(value, "TransRightsDUAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЗалогОбязКО",               getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЗалогОбязТрЛиц",            getValue(value, "TransPledgeAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПринятЗалог",               getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБУчитТоргСчДепо",            getValue(value, "ТогрСчета"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБРаспрОграничКорпДейств",    getValue(value, "ОгранКД"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБВведЗапрОсущОп",            getValue(value, "ЗапретОпер"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПодАрест",                  getValue(value, "Арест"), TYPE_STRING, 0, 6);
                addNotEmpty("Примечание",                   getValue(value, "note"), TYPE_STRING);
                m_view.printRow("ОперацииСЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

    macro isExistsDataInPart(partId : String)
        var it = m_report.getRcbReport().attributeValue(partId).createValueIterator();

        if (it.count != 0)
            return true;
        else
            return false;
        end;
    end;

    private macro printData(currency : String)
        m_view.beginPart("ВалютаДанные", "КодВалюты", currency,
                                         "Примечание", m_part.getNote(currency));
        m_view.finishPart();
    end;

    private macro printInfoZone()
        var organizationProfile : Object = objectFactoryInstance.createReportView(m_report, getOkud(), RCB_PK_QUARTER, DATE_OUT_PERIOD_FORMAT, RcbPrintProtocolView());
        var codeOrganization    : Object = organizationProfile.getLendingAgencyCodeZone();
        var nameOrganization    : Object = organizationProfile.getNamesZone();

        var executor   : Object = TRcbXmlSigner("Исполнитель", Исполнитель, ТелефонИсполнителя);
        var bookkeeper : Object = TRcbXmlSigner("ГлавБух", {NAME_BOOK}, {FIO_BOOK});
        var leader     : Object = TRcbXmlSigner("Руководитель", {NAME_BOSS}, {FIO_BOSS});
        var profile    : Object = TRcbXmlOrganizationProfile(codeOrganization.getRegistrationNumber(),
                                                             codeOrganization.getBic(),
                                                             codeOrganization.getOkato(),
                                                             codeOrganization.getOkpo(),
                                                             codeOrganization.getOgrn(),
                                                             nameOrganization.getLendingAgencyName(),
                                                             nameOrganization.getLendingAgencyPostalAdress());
        m_view.printInfo(profile, leader, bookkeeper, executor);
    end;

    private macro printDataZone()
        printInfoZone();

        m_view.beginPart("Данные711",
                         "Ид", "1",
                         "НомПрофУч", GetLicenseNumber({OurBank}));

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_1"))
            m_view.beginPart("Подраздел1.1");
            printPart11();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2"))
            m_view.beginPart("Подраздел1.2");
            printPart12();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2_1"))
            m_view.beginPart("Подраздел1.2.1");
            printPart121();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_3"))
            m_view.beginPart("Подраздел1.3");
            printPart13();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_4"))
            m_view.beginPart("Подраздел1.4");
            printPart14();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел1"))
            m_view.beginPart("Подраздел2.1");
            printPart21();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел2"))
            m_view.beginPart("Подраздел2.2");
            printPart22();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел3"))
            m_view.beginPart("Подраздел2.3");
            printPart23();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел3"))
            m_view.beginPart("Раздел3");
            printPart3();
            m_view.finishPart();
        end;

        m_view.finishPart();
    end;

    private macro getOkud()
        return "0409711";
    end;

    local macro constructor()
        m_report =  objectFactoryInstance.createReport(RcbApplication.currentReport);
        initTRcbXmlExportController("xml", m_report, "Форма " + getOkud(), RCB_XML_PK_QUARTERLY);
    end;

    constructor();
end;

class (TF711ExportXmlControllerBase) TF711XmlExportController_56_PAK()
    initTF711ExportXmlControllerBase();

    private macro getDescriptorInfo()
        return "F711_56.PAK от 01.06.2021";
    end;

    private macro getExportVersion()
        return "4.0.4.5";
    end;

    private macro getReportKind()
        return "КО";
    end;
end;

class (TF711XmlExportController_56_PAK) TF711XmlExportController_5986()
    initTF711XmlExportController_56_PAK();

    private macro getDescriptorInfo()
        return "rep0409711:v";
    end;

    private macro getExportVersion()
        return "5.0.4.5";
    end;

    private macro printPart11()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",               format(getValue(value, "counter"),            TYPE_STRING, 5));
                addNotEmpty("НаименованиеДК",        getValue(value, "КорреспНаим"),            TYPE_STRING, 255);
                addNotEmpty("ПризнакДК_ЮЛ",          getValue(value, "КорреспИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаНерез",      getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3);
                if (getValue(value, "КорреспИНН_Признак") == "1")
                    addNotEmpty("ИНН_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING, 12);
                end;
                if (getValue(value, "КорреспИНН_Признак") == "2")
                    addNotEmpty("TIN_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING);
                end;
                addNotEmpty("ОГРН_ДК",               getValue(value, "КорреспОГРН"),            TYPE_STRING);
                addNotEmpty("КодСтр_ДК",             getValue(value, "КорреспОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_ДК",    getValue(value, "КорреспНомерЛицензии"),   TYPE_STRING);
                addNotEmpty("ПризнакДК",             getValue(value, "КорреспПризнак"),         TYPE_STRING, 1);
                addNotEmpty("НомСчета",              getValue(value, "КорреспНомерСчета"),      TYPE_STRING, 40);
                addNotEmpty("НаименованиеЭм",        getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",             getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",    getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",               getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",              getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",             getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",              getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                  getValue(value, "ЦБISIN"),                 TYPE_STRING, 12);
                addNotEmpty("CFI",                   getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВал",                getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",            getValue(value, "ЦБНоминал"),              TYPE_STRING, 30, 8);
                addNotEmpty("КолЦБ",                 getValue(value, "КоличествоПоСчету"),      TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрВсего",      getValue(value, "ВсегоОбрем"),             TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗалог",      getValue(value, "Залог"),                  TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрСчДепо",     getValue(value, "ТогрСчета"),              TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрКорпДейств", getValue(value, "ОгранКД"),                TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗапрОп",     getValue(value, "ЗапретОпер"),             TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрАрест",      getValue(value, "Арест"),                  TYPE_STRING, 0, 6);
                addNotEmpty("НаимОрг",               getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",            getValue(value, "МХПризнак"),              TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",          getValue(value, "МХИНН_Признак"),          TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",              getValue(value, "МХОГРН"),                 TYPE_STRING);
                addNotEmpty("КодСтр_Орг",            getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",   getValue(value, "МХНомерЛицензии"),        TYPE_STRING, 14);
                addNotEmpty("НомСчДепо",             getValue(value, "МХНомерСчёта"),           TYPE_STRING, 40);
                m_view.printRow("ЦБнаСчДепоНД", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart12()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",       getValue(value, "ЭмитентНаименование"),      TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",            getValue(value, "ЭмитентИНН_Признак"),       TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",   getValue(value, "ЭмитентИНН_ПризнакКода"),   TYPE_STRING, 3);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",              getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",             getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",            getValue(value, "ЦБКодТипа"),                TYPE_STRING);
                addNotEmpty("НомРегЦБ",             getValue(value, "ЦБНомерГосРег"),            TYPE_STRING);
                addNotEmpty("ISIN",                 getValue(value, "ЦБISIN"),                   TYPE_STRING);
                addNotEmpty("CFI",                  getValue(value, "КодCFI"),                   TYPE_STRING, 6);
                addNotEmpty("КодВалК",              getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",           getValue(value, "ЦБНоминал"),                TYPE_STRING, 30, 8);
                addNotEmpty("ВидСчета",             getValue(value, "ВидСчётаДепо"),             TYPE_STRING);
                addNotEmpty("КолЦБ",                getValue(value, "КоличествоПоСчету"),        TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремВсего",        getValue(value, "ВсегоОбрем"),               TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремВЗалоге",      getValue(value, "Залог"),                    TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремСчДепо",       getValue(value, "ТогрСчета"),                TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремКорпДейст",    getValue(value, "ОгранКД"),                  TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремЗапретОп",     getValue(value, "ЗапретОпер"),               TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбремАрест",        getValue(value, "Арест"),                    TYPE_STRING, 0, 6);
                addNotEmpty("КодСекторЭк",          getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING);
                addNotEmpty("КодСтрВладельца",      getValue(value, "СВ_ОКМС"),                  TYPE_STRING, 3);
                addNotEmpty("НаимОрг",              getValue(value, "МХНаименование"),           TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",           getValue(value, "МХПризнак"),                TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",         getValue(value, "МХИНН_Признак"),            TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",  getValue(value, "МХИНН_ПризнакКода"),        TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",             getValue(value, "МХОГРН"),                   TYPE_STRING);
                addNotEmpty("КодСтр_Орг",           getValue(value, "МХОКСМ"),                   TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",  getValue(value, "МХНомерЛицензии"),          TYPE_STRING, 14);
                addNotEmpty("ДатаВыдЛиц" ,          getValue(value, "НРезДатаВыдачиЛицензии"),   TYPE_DATE);
                addNotEmpty("ЛиценОрган",           getValue(value, "НРезКемВыданаЛицензия"),    TYPE_STRING, 254);
                m_view.printRow("ЦБнаСчДепо", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart121()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",     getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",          getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез", getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",         getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",         getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",            getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",           getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",          getValue(value, "ЦБКодТипа"),              TYPE_STRING, 5);
                addNotEmpty("НомРегЦБ",           getValue(value, "ЦБНомерГосРег"),          TYPE_STRING, 21);
                addNotEmpty("ISIN",               getValue(value, "ЦБISIN"),                 TYPE_STRING, 12);
                addNotEmpty("CFI",                getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВал",             getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",         getValue(value, "ЦБНоминал"),              TYPE_STRING, 29, 8);
                addNotEmpty("КолПриемЦБ",         getValue(value, "ПриемЦБКоличество"),      TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбПриемЦБ",          getValue(value, "ПриемЦБ"),                TYPE_STRING, 29, 6);
                addNotEmpty("КолСнятиеЦБ",        getValue(value, "СнятиеЦБКоличество"),     TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбСнятиеЦБ",         getValue(value, "СнятиеЦБ"),               TYPE_STRING, 29, 6);
                addNotEmpty("КолПереводЦБ",       getValue(value, "ПереводЦБКоличество"),    TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбПереводЦб",        getValue(value, "ПереводЦБ"),              TYPE_NUMBER, 16, 4);
                m_view.printRow("ДепОперЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart13()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        var appCode = "F711_0103";
        var rowCode;

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"),                 TYPE_STRING);
                addNotEmpty("CFI",                      getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВалК",                  getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"),              TYPE_STRING, 30, 8);
                addNotEmpty("КЦБСобствВсего",           getValue(value, "СвоиЦБ_Всего"),           TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСобствНаБС",            getValue(value, "СвоиЦБ_ОснБаланс"),       TYPE_STRING, 0, 6);
                addNotEmpty("КЦББезПризСделкиРепо",     getValue(value, "СвоиЦБ_РЕПО_БПП"),        TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПоСделкЗайма",          getValue(value, "СвоиЦБ_Займ"),            TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбязОтсут",             getValue(value, "СвоиЦБ_ОбязОтсутств"),    TYPE_STRING, 0, 6);
                addNotEmpty("КЦБВложБезнадеж",          getValue(value, "СвоиЦБ_Безнадежн"),       TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОшибЗачисл",            getValue(value, "СвоиЦБ_ЗачислОшибочно"),  TYPE_STRING, 0, 6);
                addNotEmpty("КЦБДрПричины",             getValue(value, "СвоиЦБ_ИныеПричины"),     TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСчДовУпр",              getValue(value, "СвоиЦБ_ДУ"),              TYPE_STRING, 0, 6);
                addNotEmpty("КЦБКазнСчЭм",              getValue(value, "СвоиЦБ_КазнСчета"),       TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЭмисСчет",              getValue(value, "СвоиЦБ_Эмисс"),           TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрВсего",         getValue(value, "ВсегоОбрем"),             TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗалог",         getValue(value, "Залог"),                  TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрСчДепо",        getValue(value, "ТогрСчета"),              TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрКорпДейств",    getValue(value, "ОгранКД"),                TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрЗапрОп",        getValue(value, "ЗапретОпер"),             TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОгрРаспрАрест",         getValue(value, "Арест"),                  TYPE_STRING, 0, 6);
                addNotEmpty("НаимОргВедУчет",           getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризОргВедУчет",           getValue(value, "МХПризнак"),              TYPE_STRING, 3);
                addNotEmpty("ПризнакОргВедУчет",        getValue(value, "МХИНН_Признак"),          TYPE_STRING, 3);
                addNotEmpty("ПризнакКодаОргВедНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_ОргВедУчет",          getValue(value, "МХОГРН"),                 TYPE_STRING, 15);
                addNotEmpty("КодСтрОргВедУчет",         getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",      getValue(value, "МХНомерЛицензии"),        TYPE_STRING, 18);
                addNotEmpty("ДатаВыдЛиц",               getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE);
                addNotEmpty("ЛиценОрган",               getValue(value, "НРезКемВыданаЛицензия"),  TYPE_STRING, 254);
                m_view.printRow("ЦБнаПравеСобств", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart14()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"),            TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"),             TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"),         TYPE_STRING, 4);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"),                     TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"),                     TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"),                    TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"),                    TYPE_STRING, 3);
                addNotEmpty("КодВД",                    getOkved(getValue(value, "ЭмитентОКВЭД")),         TYPE_STRING);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"),                      TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"),                  TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"),                         TYPE_STRING, 12);
                addNotEmpty("CFI",                      getValue(value, "КодCFI"),                         TYPE_STRING, 6);
                addNotEmpty("КодВал",                   getValue(value, "ЦБВалюта"),                       TYPE_STRING);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"),                      TYPE_STRING, 30, 8);
                addNotEmpty("КолЦБ",                    getValue(value, "КоличествоЦБ"),                   TYPE_STRING);
                addNotEmpty("БалансСтоим",              getValue(value, "ОбъемВложений")/1000.0,           TYPE_STRING, 0, 4);
                addNotEmpty("НомерБалСч",               getValue(value, "БалансСчет"),                     TYPE_STRING);
                addNotEmpty("НакопКупДоход",            getValue(value, "НКД"),                            TYPE_STRING);
                addNotEmpty("ПереоцЦБ",                 getValue(value, "ОтрицПоложПереоценка")/1000.0,    TYPE_STRING, 0, 4);
                addNotEmpty("КорректСтоимДолгЦБ",       getValue(value, "Корр_СС_ПП")/1000.0,              TYPE_STRING, 0, 4);
                addNotEmpty("УровеньДанных",            getValue(value, "УровеньИДвиерархииСС"),           TYPE_STRING);
                addNotEmpty("КатКач",                   getValue(value, "КатКачества"),                    TYPE_NUMBER, 0, 0);
                addNotEmpty("РасчетРезервВозмПотери",   StrSubst(getValue(value, "РезервПроцент"),"%",""), TYPE_NUMBER, 3, 2);
                addNotEmpty("РезервВозмПотери",         getValue(value, "Резерв")/1000.0,                  TYPE_STRING, 0, 4);
                addNotEmpty("КорректРезервВозмПотери",  getValue(value, "Корр_резерва_ВП")/1000.0,         TYPE_STRING, 0, 4);
                m_view.printRow("БалСтоимВлож", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart3()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",               getValue(value, "IssuerName"),          TYPE_STRING);
                addNotEmpty("ПризнакЭм",                    getValue(value, "IssuerINN_Mark"),      TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",           getValue(value, "IssuerINN_CodeKind"),  TYPE_STRING, 12);
                if (in(getValue(value, "IssuerINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Эм",                   getValue(value, "IssuerINN"),           TYPE_STRING, 12);
                end;
                if (in(getValue(value, "IssuerINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Эм",                   getValue(value, "IssuerINN"),           TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                      getValue(value, "IssuerOGRN"),          TYPE_STRING);
                addNotEmpty("КодСтрЭм",                     getValue(value, "IssuerCountryCode"),   TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                    getValue(value, "Code711"),             TYPE_STRING);
                addNotEmpty("НомРегЦБ",                     getValue(value, "LSIN"),                TYPE_STRING);
                addNotEmpty("ISIN",                         getValue(value, "ISIN"),                TYPE_STRING, 12);
                addNotEmpty("CFI",                          getValue(value, "КодCFI"),              TYPE_STRING, 6);
                addNotEmpty("КодВал",                       getValue(value, "FaceValueFICode"),     TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",                   getValue(value, "FaceValue"),           TYPE_STRING, 0, 8);
                addNotEmpty("КЦБПрямРепо",                  getValue(value, "SaleREPOAmount"),      TYPE_STRING, 0, 6);
                addNotEmpty("КЦБСделЗайм",                  getValue(value, "TransLoanAmount"),     TYPE_STRING, 0, 6);
                addNotEmpty("КЦБОбратРепо",                 getValue(value, "BuyREPOAmount"),       TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПолучСделЗайм",             getValue(value, "AcceptLoanAmount"),    TYPE_STRING, 0, 6);
                addNotEmpty("КЦБДовУпр",                    getValue(value, "TransDUAmount"),       TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПраваДовУпр",               getValue(value, "TransRightsDUAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЗалогОбязКО",               getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 0, 6);
                addNotEmpty("КЦБЗалогОбязТрЛиц",            getValue(value, "TransPledgeAmount"),   TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПринятЗалог",               getValue(value, "AcceptPledgeAmount"),  TYPE_STRING, 0, 6);
                addNotEmpty("КЦБУчитТоргСчДепо",            getValue(value, "ТогрСчета"),           TYPE_STRING, 0, 6);
                addNotEmpty("КЦБРаспрОграничКорпДейств",    getValue(value, "ОгранКД"),             TYPE_STRING, 0, 6);
                addNotEmpty("КЦБВведЗапрОсущОп",            getValue(value, "ЗапретОпер"),          TYPE_STRING, 0, 6);
                addNotEmpty("КЦБПодАрест",                  getValue(value, "Арест"),               TYPE_STRING, 0, 6);
                addNotEmpty("Примечание",                   getValue(value, "note"),                TYPE_STRING);
                m_view.printRow("ОперацииСЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart41()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел4_Подраздел_4_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_NUMBER, 7, 0));
                addNotEmpty("НаимЛица",         getValue(value, "Эмитент_ЦА"),              TYPE_STRING, 255);
                addNotEmpty("ИННлица",          getValue(value, "ИНН_Эмитента_ЦА"),         TYPE_STRING, 12);
                addNotEmpty("ОГРНлица",         getValue(value, "ОГРН_Эмитента_ЦА"),        TYPE_STRING, 15);
                addNotEmpty("КодСтрЛица",       getValue(value, "КодСтраны_Эмитента_ЦА"),   TYPE_STRING, 3);
                addNotEmpty("НаименованиеОпер", getValue(value, "Наименование_Оператора"),  TYPE_STRING, 255);
                addNotEmpty("ИННопер",          getValue(value, "ИНН_Оператора"),           TYPE_STRING, 12);
                addNotEmpty("НаимПлатформ",     getValue(value, "Наименование_платформы"),  TYPE_STRING, 255);
                addNotEmpty("КодТипаЦБ",        getValue(value, "Тип_ЦБ"),                  TYPE_STRING, 20);
                addNotEmpty("ВидАктив",         getValue(value, "Вид_требования"),          TYPE_STRING, 12);
                addNotEmpty("ИДЦифрПрав",       getValue(value, "ИД_ЦА"),                   TYPE_STRING, 255);
                addNotEmpty("УслОбЦифрСвид",    getValue(value, "Обозначение_ЦС"),          TYPE_STRING, 255);
                addNotEmpty("КодВалЦифрСвид",   getValue(value, "КодВалюты_ЦС"),            TYPE_STRING, 3);
                addNotEmpty("КолЦифрПрав",      getValue(value, "Количество_УЦП_в_ЦС"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрСвид",      getValue(value, "Кол_ЦС_Вып_депозитарием"), TYPE_NUMBER, 30, 6);
                m_view.printRow("ЦифровыеСвид", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart42()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел4_Подраздел_4_2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_NUMBER, 7, 0));
                addNotEmpty("НаимЛицаЦифрАкт",      getValue(value, "Эмитент_ЦА"),               TYPE_STRING, 255);
                addNotEmpty("ИННлицаЦифрАкт",       getValue(value, "ИНН_Эмитента_ЦА"),          TYPE_STRING, 12);
                addNotEmpty("ОГРНлицаЦифрАкт",      getValue(value, "ОГРН_Эмитента_ЦА"),         TYPE_STRING, 15);
                addNotEmpty("КодСтрЛицаЦифрАкт",    getValue(value, "КодСтраны_Эмитента_ЦА"),    TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",            getValue(value, "Тип_ЦБ"),                   TYPE_STRING, 20);
                addNotEmpty("НаимЦифрАкт",          getValue(value, "Наименование_ЦА"),          TYPE_STRING, 255);
                addNotEmpty("ИДЦифрАкт",            getValue(value, "ИД_ЦА"),                    TYPE_STRING, 255);
                addNotEmpty("ВидЦифрПрав",          getValue(value, "Вид_ИныхЦФА"),              TYPE_STRING, 255);
                addNotEmpty("ВидАктив",             getValue(value, "Вид_требования"),           TYPE_STRING, 12);
                addNotEmpty("ТипЦБЭмис",            getValue(value, "Вид_ФИ"),                   TYPE_STRING, 20);
                addNotEmpty("НаименованиеЭм",       getValue(value, "Эмитент"),                  TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",            getValue(value, "Эмитента_ПризЭмитента"),    TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",   getValue(value, "Эмитента_ПризКодаЭмНерез"), TYPE_STRING, 3);
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "1", "3"))
                    addNotEmpty("ИНН_Эм",           getValue(value, "ЭмитентИНН"),               TYPE_STRING, 12);
                end;
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "2", "4"))
                    addNotEmpty("TIN_Эм",           getValue(value, "ЭмитентИНН"),               TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",              getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",             getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("НомРегЦБ",             getValue(value, "ЦБНомерГосРег"),            TYPE_STRING, 64);
                addNotEmpty("ISIN",                 getValue(value, "ЦБISIN"),                   TYPE_STRING, 20);
                addNotEmpty("КодВал",               getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ_Р4",        getValue(value, "ЦБНоминал"),                TYPE_NUMBER, 30, 8);
                addNotEmpty("НаимРегистр",          getValue(value, "НаименованиеРегистратора"), TYPE_STRING, 255);
                addNotEmpty("ИННРегистр",           getValue(value, "ИНН_Регистратора"),         TYPE_STRING, 12);
                addNotEmpty("НаимОперИС",           getValue(value, "Наименование_Оператора"),   TYPE_STRING, 255);
                addNotEmpty("ИННОперИС",            getValue(value, "ИНН_Оператора"),            TYPE_STRING, 12);
                addNotEmpty("НаимИС",               getValue(value, "Наименование_платформы"),   TYPE_STRING, 255);
                addNotEmpty("КолЦифрАктив",         getValue(value, "КолвоЦА_на_счетеДепо"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравВсего",     getValue(value, "КолЦАВсегоОгр"),            TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравЗалог",     getValue(value, "КолвоЦА_Взалоге"),          TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравОгр",       getValue(value, "КолЦА_огр_эмитентом"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравЗапрет",    getValue(value, "КолвоЦА_запрет_операций"),  TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравАрест",     getValue(value, "КолвоЦА_под_арестом"),      TYPE_NUMBER, 30, 8);
                addNotEmpty("ВидСчета",             getValue(value, "Вид_счетаДепо"),            TYPE_STRING, 20);
                addNotEmpty("КодСекторЭк",          getValue(value, "Инф_Владельце_счетаДепо"),  TYPE_STRING, 10);
                addNotEmpty("КодСтрВладельца",      getValue(value, "КодСтраныВладельцаДепо"),   TYPE_STRING, 3);
                m_view.printRow("ЦифрПрава", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart421()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел4_Подраздел_4_2_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_NUMBER, 7, 0));
                addNotEmpty("НаимЛицаЦифрАкт",    getValue(value, "Эмитент_ЦА"),               TYPE_STRING, 255);
                addNotEmpty("ИННлицаЦифрАкт",     getValue(value, "ИНН_Эмитента_ЦА"),          TYPE_STRING, 12);
                addNotEmpty("ОГРНлицаЦифрАкт",    getValue(value, "ОГРН_Эмитента_ЦА"),         TYPE_STRING, 15);
                addNotEmpty("КодСтрЛицаЦифрАкт",  getValue(value, "КодСтраны_Эмитента_ЦА"),    TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",          getValue(value, "Тип_ЦБ"),                   TYPE_STRING, 20);
                addNotEmpty("НаимЦифрАкт",        getValue(value, "Наименование_ЦА"),          TYPE_STRING, 255);
                addNotEmpty("ИДЦифрАкт",          getValue(value, "ИД_ЦА"),                    TYPE_STRING, 255);
                addNotEmpty("ВидЦифрПрав",        getValue(value, "Вид_ИныхЦФА"),              TYPE_STRING, 255);
                addNotEmpty("ВидАктив",           getValue(value, "Вид_требования"),           TYPE_STRING, 12);
                addNotEmpty("ТипЦБЭмис",          getValue(value, "Вид_ФИ"),                   TYPE_STRING, 20);
                addNotEmpty("НаименованиеЭм",     getValue(value, "Эмитент"),                  TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",          getValue(value, "Эмитента_ПризЭмитента"),    TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез", getValue(value, "Эмитента_ПризКодаЭмНерез"), TYPE_STRING, 3);
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "1", "3"))
                    addNotEmpty("ИНН_Эм",         getValue(value, "ЭмитентИНН"),               TYPE_STRING, 12);
                end;
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "2", "4"))
                    addNotEmpty("TIN_Эм",         getValue(value, "ЭмитентИНН"),               TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",            getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",           getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("КолОперПрием",       getValue(value, "КолвОперЦА_зачисление"),    TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбъемОперПрием",     getValue(value, "ОбъемОперЦАзачисление"),    TYPE_NUMBER, 30, 6);
                addNotEmpty("КолОперСнятие",      getValue(value, "КолвОперЦА_списание"),      TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбъемОперСнятие",    getValue(value, "ОбъемОперЦА_списание"),     TYPE_NUMBER, 30, 6);
                m_view.printRow("ОбъемДепОпер", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart43()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел4_Подраздел_4_3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_NUMBER, 7, 0));
                addNotEmpty("НаимЛицаЦифрАкт",     getValue(value, "Эмитент_ЦА"),               TYPE_STRING, 255);
                addNotEmpty("ИННлицаЦифрАкт",      getValue(value, "ИНН_Эмитента_ЦА"),          TYPE_STRING, 12);
                addNotEmpty("ОГРНлицаЦифрАкт",     getValue(value, "ОГРН_Эмитента_ЦА"),         TYPE_STRING, 15);
                addNotEmpty("КодСтрЛицаЦифрАкт",   getValue(value, "КодСтраны_Эмитента_ЦА"),    TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",           getValue(value, "Тип_ЦБ"),                   TYPE_STRING, 20);
                addNotEmpty("НаимЦифрАкт",         getValue(value, "Наименование_ЦА"),          TYPE_STRING, 255);
                addNotEmpty("ИДЦифрАкт",           getValue(value, "ИД_ЦА"),                    TYPE_STRING, 255);
                addNotEmpty("ВидЦифрПрав",         getValue(value, "Вид_ИныхЦФА"),              TYPE_STRING, 255);
                addNotEmpty("ВидАктив",            getValue(value, "Вид_требования"),           TYPE_STRING, 12);
                addNotEmpty("ТипЦБЭмис",           getValue(value, "Вид_ФИ"),                   TYPE_STRING, 20);
                addNotEmpty("НаименованиеЭм",      getValue(value, "Эмитент"),                  TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",           getValue(value, "Эмитента_ПризЭмитента"),    TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",  getValue(value, "Эмитента_ПризКодаЭмНерез"), TYPE_STRING, 3);
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "1", "3"))
                    addNotEmpty("ИНН_Эм",          getValue(value, "ЭмитентИНН"),               TYPE_STRING, 12);
                end;
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "2", "4"))
                    addNotEmpty("TIN_Эм",          getValue(value, "ЭмитентИНН"),               TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",             getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",            getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("НомРегЦБ",            getValue(value, "ЦБНомерГосРег"),            TYPE_STRING, 64);
                addNotEmpty("ISIN",                getValue(value, "ЦБISIN"),                   TYPE_STRING, 12);
                addNotEmpty("КодВал",              getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ_Р4",       getValue(value, "ЦБНоминал"),                TYPE_NUMBER, 30, 8);
                addNotEmpty("НаимРегистр",         getValue(value, "НаименованиеРегистратора"), TYPE_STRING, 255);
                addNotEmpty("ИННРегистр",          getValue(value, "ИНН_Регистратора"),         TYPE_STRING, 12);
                addNotEmpty("НаимОперИС",          getValue(value, "Наименование_Оператора"),   TYPE_STRING, 255);
                addNotEmpty("ИННОперИС",           getValue(value, "ИНН_Оператора"),            TYPE_STRING, 12);
                addNotEmpty("НаимИС",              getValue(value, "Наименование_платформы"),   TYPE_STRING, 255);
                addNotEmpty("БалСтоимЦифрАкт",     getValue(value, "Балансовая_стоимость_ЦФА"), TYPE_NUMBER, 16, 4);
                addNotEmpty("КолЦП_КОВсего",       getValue(value, "КолЦАВсего"),               TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_БС",            getValue(value, "КолЦФА_ВсегоКО_баланс"),    TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_БезРепо",       getValue(value, "КолвЦФАВнеБалансРЕПО"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_Займ",          getValue(value, "КолЦФАВнеБалансЗайм"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_ОбязОтсут",     getValue(value, "КолЦФАВнеБалансПогашОбяз"), TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_БезнадежДолг",  getValue(value, "КолЦФАВнеБалансБезнДолг"),  TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_ОшибЗачисл",    getValue(value, "КолЦФАВнеБалансОшибочно"),  TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦП_ДрПричины",     getValue(value, "КолЦФАВнеБалансИное"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравВсего",    getValue(value, "КолЦАВсегоОгр"),            TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравЗалог",    getValue(value, "КолвоЦА_Взалоге"),          TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравОгр",      getValue(value, "КолЦА_огр_эмитентом"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравЗапрет",   getValue(value, "КолвоЦА_запрет_операций"),  TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦифрПравАрест",    getValue(value, "КолвоЦА_под_арестом"),      TYPE_NUMBER, 30, 8);
                addNotEmpty("НаимОргУчетПрав",     getValue(value, "НаимОргВедущейУчет"),       TYPE_STRING, 255);
                addNotEmpty("ПризОргУчетПрав",     getValue(value, "ПризнакОргВедущейУчет"),    TYPE_STRING, 1);
                addNotEmpty("ИННОргУчетПрав",      getValue(value, "ИНН_оргВедущейУчет"),       TYPE_STRING, 12);
                addNotEmpty("ОГРНОргУчетПрав",     getValue(value, "ОРГН_оргВедущейУчет"),      TYPE_STRING, 15);
                addNotEmpty("КодСтрОргУчетПрав",   getValue(value, "КодСтраныОргВедущейУчет"),  TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг", getValue(value, "НомЛицензииОргВедУчет"),    TYPE_STRING, 18);
                m_view.printRow("УтилЦифрПрава", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart44()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел4_Подраздел_4_4").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_NUMBER, 7, 0));
                addNotEmpty("НаимЛицаЦифрАкт",    getValue(value, "Эмитент_ЦА"),               TYPE_STRING, 255);
                addNotEmpty("ИННлицаЦифрАкт",     getValue(value, "ИНН_Эмитента_ЦА"),          TYPE_STRING, 12);
                addNotEmpty("ОГРНлицаЦифрАкт",    getValue(value, "ОГРН_Эмитента_ЦА"),         TYPE_STRING, 15);
                addNotEmpty("КодСтрЛицаЦифрАкт",  getValue(value, "КодСтраны_Эмитента_ЦА"),    TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",          getValue(value, "Тип_ЦБ"),                   TYPE_STRING, 20);
                addNotEmpty("НаимЦифрАкт",        getValue(value, "Наименование_ЦА"),          TYPE_STRING, 255);
                addNotEmpty("ИДЦифрАкт",          getValue(value, "ИД_ЦА"),                    TYPE_STRING, 255);
                addNotEmpty("ВидЦифрПрав",        getValue(value, "Вид_ИныхЦФА"),              TYPE_STRING, 255);
                addNotEmpty("ВидАктив",           getValue(value, "Вид_требования"),           TYPE_STRING, 12);
                addNotEmpty("ТипЦБЭмис",          getValue(value, "Вид_ФИ"),                   TYPE_STRING, 20);
                addNotEmpty("НаименованиеЭм",     getValue(value, "Эмитент"),                  TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",          getValue(value, "Эмитента_ПризЭмитента"),    TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез", getValue(value, "Эмитента_ПризКодаЭмНерез"), TYPE_STRING, 3);
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "1", "3"))
                    addNotEmpty("ИНН_Эм",         getValue(value, "ЭмитентИНН"),               TYPE_STRING, 12);
                end;
                if (in(getValue(value, "Эмитента_ПризЭмитента"), "2", "4"))
                    addNotEmpty("TIN_Эм",         getValue(value, "ЭмитентИНН"),               TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",            getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",           getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("НомРегЦБ",           getValue(value, "ЦБНомерГосРег"),            TYPE_STRING, 64);
                addNotEmpty("ISIN",               getValue(value, "ЦБISIN"),                   TYPE_STRING, 12);
                addNotEmpty("КодВал",             getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ_Р4",      getValue(value, "ЦБНоминал"),                TYPE_NUMBER, 30, 8);
                addNotEmpty("ИННОперИС",          getValue(value, "ИНН_Оператора"),            TYPE_STRING, 12);
                addNotEmpty("НаимИС",             getValue(value, "Наименование_платформы"),   TYPE_STRING, 255);
                addNotEmpty("КолЦА_ПрямРепо",     getValue(value, "КолЦФАпереданных_пРЕПО"),   TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ПередЗайм",    getValue(value, "КолЦФАпереданныхЗайм"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ОбрРепо",      getValue(value, "КолЦФАпереданных_оРЕПО"),   TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ПолучЗайм",    getValue(value, "КолЦФАполученныхЗайм"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ЗалогОбКО",    getValue(value, "КолЦФАзалогОбязКО"),        TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ЗалогТрЛиц",   getValue(value, "КолЦФАзалогОбяз3лиц"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_ПринятЗалог",  getValue(value, "КолЦФАпринятых_залог"),     TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_Огранич",      getValue(value, "КолЦА_огр_эмитентом"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_Запрет",       getValue(value, "КолвоЦА_запрет_операций"),  TYPE_NUMBER, 30, 6);
                addNotEmpty("КолЦА_Арест",        getValue(value, "КолвоЦА_под_арестом"),      TYPE_NUMBER, 30, 6);
                addNotEmpty("Примечание",         getValue(value, "ПримОтсутствИнформации"),   TYPE_NUMBER);
                m_view.printRow("ОперЦифрПрава", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printDataZone()
        printInfoZone();

        m_view.beginPart("Данные711",
                         "Ид", "1");

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_1"))
            m_view.beginPart("Подраздел1.1");
            printPart11();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2"))
            m_view.beginPart("Подраздел1.2");
            printPart12();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2_1"))
            m_view.beginPart("Подраздел1.2.1");
            printPart121();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_3"))
            m_view.beginPart("Подраздел1.3");
            printPart13();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_4"))
            m_view.beginPart("Подраздел1.4");
            printPart14();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел1"))
            m_view.beginPart("Подраздел2.1");
            printPart21();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел2"))
            m_view.beginPart("Подраздел2.2");
            printPart22();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел3"))
            m_view.beginPart("Подраздел2.3");
            printPart23();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел3"))
            m_view.beginPart("Раздел3");
            printPart3();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_1"))
            m_view.beginPart("Подраздел4.1");
            printPart41();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_2"))
            m_view.beginPart("Подраздел4.2");
            printPart42();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_2_1"))
            m_view.beginPart("Подраздел4.2.1");
            printPart421();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_3"))
            m_view.beginPart("Подраздел4.3");
            printPart43();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_4"))
            m_view.beginPart("Подраздел4.4");
            printPart44();
            m_view.finishPart();
        end;

        m_view.finishPart();
    end;
end;

class (TF711XmlExportController_5986) TF711XmlExportController_6406()
    initTF711XmlExportController_5986();
	
    private macro printInfoZone()
        var organizationProfile : Object = objectFactoryInstance.createReportView(m_report, getOkud(), RCB_PK_QUARTER, DATE_OUT_PERIOD_FORMAT, RcbPrintProtocolView());
        var codeOrganization    : Object = organizationProfile.getLendingAgencyCodeZone();
        var nameOrganization    : Object = organizationProfile.getNamesZone();

        var executor   : Object = TRcbXmlSigner("Исполнитель", Исполнитель, ТелефонИсполнителя);
        var leader     : Object = TRcbXmlSigner("Руководитель", {NAME_BOSS}, {FIO_BOSS});
        var profile    : Object = TRcbXmlOrganizationProfile(codeOrganization.getRegistrationNumber(),
                                                             codeOrganization.getBic(),
                                                             codeOrganization.getOkato(),
                                                             codeOrganization.getOkpo(),
                                                             codeOrganization.getOgrn(),
                                                             nameOrganization.getLendingAgencyName(),
                                                             nameOrganization.getLendingAgencyPostalAdress());
        m_view.printInfo(profile, leader, NULL, executor);
    end;
	
    private macro printDataZone()
        var query, ds, lastcurdate = {curdate};
        printInfoZone();

        query = "SELECT MAX(T_CURDATE) as LastOpenCurDate" +
              " FROM DCURDATE_DBT " +
              " WHERE T_ISCLOSED != 'X' AND T_BRANCH = 1 AND T_ISMAIN = 'X'";

        ds = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        if (ds.MoveNext())
           lastcurdate = date(ds.LastOpenCurDate);
         end;


        m_view.beginPart("Данные711",
                         "Ид", "1",
                         "ДатаОперДня", formatDate(lastcurdate));

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_1"))
            m_view.beginPart("Подраздел1.1");
            printPart11();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2"))
            m_view.beginPart("Подраздел1.2");
            printPart12();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_2_1"))
            m_view.beginPart("Подраздел1.2.1");
            printPart121();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_3"))
            m_view.beginPart("Подраздел1.3");
            printPart13();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел1_Подраздел_1_4"))
            m_view.beginPart("Подраздел1.4");
            printPart14();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел1"))
            m_view.beginPart("Подраздел2.1");
            printPart21();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел2"))
            m_view.beginPart("Подраздел2.2");
            printPart22();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел2_Подраздел3"))
            m_view.beginPart("Подраздел2.3");
            printPart23();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел3"))
            m_view.beginPart("Раздел3");
            printPart3();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_1"))
            m_view.beginPart("Подраздел4.1");
            printPart41();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_2"))
            m_view.beginPart("Подраздел4.2");
            printPart42();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_2_1"))
            m_view.beginPart("Подраздел4.2.1");
            printPart421();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_3"))
            m_view.beginPart("Подраздел4.3");
            printPart43();
            m_view.finishPart();
        end;

        if (isExistsDataInPart("Ф711_Раздел4_Подраздел_4_4"))
            m_view.beginPart("Подраздел4.4");
            printPart44();
            m_view.finishPart();
        end;

        m_view.finishPart();
    end;

    private macro getDescriptorInfo()
        return "rep0409711:v";
    end;

    private macro getExportVersion()
        return "7.0.4.5";//"6.0.4.5";
    end;

    private macro printPart11()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",               format(getValue(value, "counter"),            TYPE_STRING, 5));
                addNotEmpty("НаименованиеДК",        getValue(value, "КорреспНаим"),            TYPE_STRING, 255);
                addNotEmpty("ПризнакДК_ЮЛ",          getValue(value, "КорреспИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаНерез",      getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3);
                if (getValue(value, "КорреспИНН_Признак") == "1")
                    addNotEmpty("ИНН_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING, 12);
                end;
                if (getValue(value, "КорреспИНН_Признак") == "2")
                    addNotEmpty("TIN_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING);
                end;
                addNotEmpty("ОГРН_ДК",               getValue(value, "КорреспОГРН"),            TYPE_STRING);
                addNotEmpty("КодСтр_ДК",             getValue(value, "КорреспОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("ПризнакДК",             getValue(value, "КорреспПризнак"),         TYPE_STRING, 1);
                addNotEmpty("НомСчета",              getValue(value, "КорреспНомерСчета"),      TYPE_STRING, 40);
                addNotEmpty("НаименованиеЭм",        getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",             getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",    getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",               getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",              getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",             getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",              getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                  getValue(value, "ЦБISIN"),                 TYPE_STRING, 12);
                addNotEmpty("CFI",                   getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВал",                getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",            getValue(value, "ЦБНоминал"),              TYPE_STRING, 38, 20);
                addNotEmpty("КолЦБ",                 getValue(value, "КоличествоПоСчету"),      TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрВсего",      getValue(value, "ВсегоОбрем"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗалог",      getValue(value, "Залог"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрСчДепо",     getValue(value, "ТогрСчета"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрКорпДейств", getValue(value, "ОгранКД"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗапрОп",     getValue(value, "ЗапретОпер"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",       getValue(value, "ЦБЭскроуАгента"),         TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрАрест",      getValue(value, "Арест"),                  TYPE_STRING, 38, 20);
                addNotEmpty("НаимОрг",               getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",            getValue(value, "МХПризнак"),              TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",          getValue(value, "МХИНН_Признак"),          TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",              getValue(value, "МХОГРН"),                 TYPE_STRING);
                addNotEmpty("КодСтр_Орг",            getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",   getValue(value, "МХНомерЛицензии"),        TYPE_STRING, 14);
                addNotEmpty("НомСчДепо",             getValue(value, "МХНомерСчёта"),           TYPE_STRING, 40);
                m_view.printRow("ЦБнаСчДепоНД", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart12()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",       getValue(value, "ЭмитентНаименование"),      TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",            getValue(value, "ЭмитентИНН_Признак"),       TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",   getValue(value, "ЭмитентИНН_ПризнакКода"),   TYPE_STRING, 3);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",              getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",             getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",            getValue(value, "ЦБКодТипа"),                TYPE_STRING);
                addNotEmpty("НомРегЦБ",             getValue(value, "ЦБНомерГосРег"),            TYPE_STRING);
                addNotEmpty("ISIN",                 getValue(value, "ЦБISIN"),                   TYPE_STRING);
                addNotEmpty("CFI",                  getValue(value, "КодCFI"),                   TYPE_STRING, 6);
                addNotEmpty("КодВалК",              getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",           getValue(value, "ЦБНоминал"),                TYPE_STRING, 30, 8);
                addNotEmpty("ВидСчета",             getValue(value, "ВидСчётаДепо"),             TYPE_STRING);
                addNotEmpty("КолЦБ",                getValue(value, "КоличествоПоСчету"),        TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремВсего",        getValue(value, "ВсегоОбрем"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремВЗалоге",      getValue(value, "Залог"),                    TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремСчДепо",       getValue(value, "ТогрСчета"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремКорпДейст",    getValue(value, "ОгранКД"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремЗапретОп",     getValue(value, "ЗапретОпер"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",      getValue(value, "ЦБЭскроуАгента"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремАрест",        getValue(value, "Арест"),                    TYPE_STRING, 38, 20);
                addNotEmpty("КодСекторЭк",          getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING);
                addNotEmpty("КодСтрВладельца",      getValue(value, "СВ_ОКМС"),                  TYPE_STRING, 3);
                addNotEmpty("НаимОрг",              getValue(value, "МХНаименование"),           TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",           getValue(value, "МХПризнак"),                TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",         getValue(value, "МХИНН_Признак"),            TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",  getValue(value, "МХИНН_ПризнакКода"),        TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",             getValue(value, "МХОГРН"),                   TYPE_STRING);
                addNotEmpty("КодСтр_Орг",           getValue(value, "МХОКСМ"),                   TYPE_STRING, 3);
                m_view.printRow("ЦБнаСчДепо", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart13()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        var appCode = "F711_0103";
        var rowCode;

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"),                 TYPE_STRING);
                addNotEmpty("CFI",                      getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВалК",                  getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСобствВсего",           getValue(value, "СвоиЦБ_Всего"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСобствНаБС",            getValue(value, "СвоиЦБ_ОснБаланс"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦББезПризСделкиРепо",     getValue(value, "СвоиЦБ_РЕПО_БПП"),        TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПоСделкЗайма",          getValue(value, "СвоиЦБ_Займ"),            TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбязОтсут",             getValue(value, "СвоиЦБ_ОбязОтсутств"),    TYPE_STRING, 38, 20);
                addNotEmpty("КЦБВложБезнадеж",          getValue(value, "СвоиЦБ_Безнадежн"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОшибЗачисл",            getValue(value, "СвоиЦБ_ЗачислОшибочно"),  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБДрПричины",             getValue(value, "СвоиЦБ_ИныеПричины"),     TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчДовУпр",              getValue(value, "СвоиЦБ_ДУ"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБКазнСчЭм",              getValue(value, "СвоиЦБ_КазнСчета"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦБЭмисСчет",              getValue(value, "СвоиЦБ_Эмисс"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрВсего",         getValue(value, "ВсегоОбрем"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗалог",         getValue(value, "Залог"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрСчДепо",        getValue(value, "ТогрСчета"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрКорпДейств",    getValue(value, "ОгранКД"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗапрОп",        getValue(value, "ЗапретОпер"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",          getValue(value, "ЦБЭскроуАгента"),         TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрАрест",         getValue(value, "Арест"),                  TYPE_STRING, 38, 20);
                addNotEmpty("НаимОргВедУчет",           getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризОргВедУчет",           getValue(value, "МХПризнак"),              TYPE_STRING, 3);
                addNotEmpty("ПризнакОргВедУчет",        getValue(value, "МХИНН_Признак"),          TYPE_STRING, 3);
                addNotEmpty("ПризнакКодаОргВедНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_ОргВедУчет",          getValue(value, "МХОГРН"),                 TYPE_STRING, 15);
                addNotEmpty("КодСтрОргВедУчет",         getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                m_view.printRow("ЦБнаПравеСобств", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart3()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",               getValue(value, "IssuerName"),          TYPE_STRING);
                addNotEmpty("ПризнакЭм",                    getValue(value, "IssuerINN_Mark"),      TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",           getValue(value, "IssuerINN_CodeKind"),  TYPE_STRING, 12);
                if (in(getValue(value, "IssuerINN_Mark"), "1", "3"))
                    addNotEmpty("ИНН_Эм",                   getValue(value, "IssuerINN"),           TYPE_STRING, 12);
                end;
                if (in(getValue(value, "IssuerINN_Mark"), "2", "4"))
                    addNotEmpty("TIN_Эм",                   getValue(value, "IssuerINN"),           TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                      getValue(value, "IssuerOGRN"),          TYPE_STRING);
                addNotEmpty("КодСтрЭм",                     getValue(value, "IssuerCountryCode"),   TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                    getValue(value, "Code711"),             TYPE_STRING);
                addNotEmpty("НомРегЦБ",                     getValue(value, "LSIN"),                TYPE_STRING);
                addNotEmpty("ISIN",                         getValue(value, "ISIN"),                TYPE_STRING, 12);
                addNotEmpty("CFI",                          getValue(value, "КодCFI"),              TYPE_STRING, 6);
                addNotEmpty("КодВал",                       getValue(value, "FaceValueFICode"),     TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",                   getValue(value, "FaceValue"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПрямРепо",                  getValue(value, "SaleREPOAmount"),      TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСделЗайм",                  getValue(value, "TransLoanAmount"),     TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбратРепо",                 getValue(value, "BuyREPOAmount"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПолучСделЗайм",             getValue(value, "AcceptLoanAmount"),    TYPE_STRING, 38, 20);
                addNotEmpty("КЦБЗалогОбязКО",               getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 38, 20);
                addNotEmpty("КЦБЗалогОбязТрЛиц",            getValue(value, "TransPledgeAmount"),   TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПринятЗалог",               getValue(value, "AcceptPledgeAmount"),  TYPE_STRING, 38, 20);
                addNotEmpty("Примечание",                   getValue(value, "note"),                TYPE_STRING);
                m_view.printRow("ОперацииСЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

end;

class (TF711XmlExportController_6406) TF711XmlExportController_6800()
    initTF711XmlExportController_6406();

    private macro getDescriptorInfo()
        return "rep0409711:v7.0.4.5";
    end;

    private macro getExportVersion()
        return "7.0.4.5";
    end;

    private macro printPart11()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр",               format(getValue(value, "counter"),            TYPE_STRING, 5));
                addNotEmpty("НаименованиеДК",        getValue(value, "КорреспНаим"),            TYPE_STRING, 255);
                addNotEmpty("ПризнакДК_ЮЛ",          getValue(value, "КорреспИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаНерез",      getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3);
                if (getValue(value, "КорреспИНН_Признак") == "1")
                    addNotEmpty("ИНН_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING, 12);
                end;
                if (getValue(value, "КорреспИНН_Признак") == "2")
                    addNotEmpty("TIN_ДК",            getValue(value, "КорреспИНН"),             TYPE_STRING);
                end;
                addNotEmpty("ОГРН_ДК",               getValue(value, "КорреспОГРН"),            TYPE_STRING);
                addNotEmpty("КодСтр_ДК",             getValue(value, "КорреспОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("ПризнакДК",             getValue(value, "КорреспПризнак"),         TYPE_STRING, 1);
                addNotEmpty("НомСчета",              getValue(value, "КорреспНомерСчета"),      TYPE_STRING, 40);
                addNotEmpty("НаименованиеЭм",        getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",             getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",    getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",            getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",               getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",              getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",             getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",              getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                  getValue(value, "ЦБISIN"),                 TYPE_STRING, 12);
                addNotEmpty("CFI",                   getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВал",                getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",            getValue(value, "ЦБНоминал"),              TYPE_STRING, 38, 20);
                addNotEmpty("КолЦБ",                 getValue(value, "КоличествоПоСчету"),      TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрВсего",      getValue(value, "ВсегоОбрем"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗалог",      getValue(value, "Залог"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрСчДепо",     getValue(value, "ТогрСчета"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрКорпДейств", getValue(value, "ОгранКД"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗапрОп",     getValue(value, "ЗапретОпер"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",       getValue(value, "ЦБЭскроуАгента"),         TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОсновФЗ_НПА",        getValue(value, "ОбособФЗ"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПредписЦБ",          getValue(value, "ОбособТреб"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрАрест",      getValue(value, "Арест"),                  TYPE_STRING, 38, 20);
                addNotEmpty("НаимОрг",               getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",            getValue(value, "МХПризнак"),              TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",          getValue(value, "МХИНН_Признак"),          TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",           getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",              getValue(value, "МХОГРН"),                 TYPE_STRING);
                addNotEmpty("КодСтр_Орг",            getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                addNotEmpty("НомЛицПрофУчРЦБ_Орг",   getValue(value, "МХНомерЛицензии"),        TYPE_STRING, 14);
                addNotEmpty("НомСчДепо",             getValue(value, "МХНомерСчёта"),           TYPE_STRING, 40);
                addNotEmpty("Примечание",            getValue(value, "Примечание"),             TYPE_STRING, 512);
                m_view.printRow("ЦБнаСчДепоНД", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart12()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",       getValue(value, "ЭмитентНаименование"),      TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",            getValue(value, "ЭмитентИНН_Признак"),       TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",   getValue(value, "ЭмитентИНН_ПризнакКода"),   TYPE_STRING, 3);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",   getValue(value, "ЭмитентИНН"),                       TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",              getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",             getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",            getValue(value, "ЦБКодТипа"),                TYPE_STRING);
                addNotEmpty("НомРегЦБ",             getValue(value, "ЦБНомерГосРег"),            TYPE_STRING);
                addNotEmpty("ISIN",                 getValue(value, "ЦБISIN"),                   TYPE_STRING);
                addNotEmpty("CFI",                  getValue(value, "КодCFI"),                   TYPE_STRING, 6);
                addNotEmpty("КодВалК",              getValue(value, "ЦБВалюта"),                 TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",           getValue(value, "ЦБНоминал"),                TYPE_STRING, 30, 8);
                addNotEmpty("ВидСчета",             getValue(value, "ВидСчётаДепо"),             TYPE_STRING);
                addNotEmpty("КолЦБ",                getValue(value, "КоличествоПоСчету"),        TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремВсего",        getValue(value, "ВсегоОбрем"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремВЗалоге",      getValue(value, "Залог"),                    TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремСчДепо",       getValue(value, "ТогрСчета"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремКорпДейст",    getValue(value, "ОгранКД"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремЗапретОп",     getValue(value, "ЗапретОпер"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",      getValue(value, "ЦБЭскроуАгента"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОсновФЗ_НПА",       getValue(value, "ОбособФЗ"),                 TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПредписЦБ",         getValue(value, "ОбособТреб"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбремАрест",        getValue(value, "Арест"),                    TYPE_STRING, 38, 20);
                addNotEmpty("КодСекторЭк",          getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING);
                addNotEmpty("КодСтрВладельца",      getValue(value, "СВ_ОКМС"),                  TYPE_STRING, 3);
                addNotEmpty("НаимОрг",              getValue(value, "МХНаименование"),           TYPE_STRING, 255);
                addNotEmpty("ПризнакОрг",           getValue(value, "МХПризнак"),                TYPE_STRING, 1);
                addNotEmpty("ПризнакОргЮЛ",         getValue(value, "МХИНН_Признак"),            TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаОргНерез",  getValue(value, "МХИНН_ПризнакКода"),        TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_Орг",            getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Орг",             getValue(value, "МХОГРН"),                   TYPE_STRING);
                addNotEmpty("КодСтр_Орг",           getValue(value, "МХОКСМ"),                   TYPE_STRING, 3);
                addNotEmpty("Примечание",           getValue(value, "Примечание"),               TYPE_STRING, 512);
                m_view.printRow("ЦБнаСчДепо", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart121()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",     getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",          getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез", getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",         getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",         getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",            getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",           getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",          getValue(value, "ЦБКодТипа"),              TYPE_STRING, 5);
                addNotEmpty("НомРегЦБ",           getValue(value, "ЦБНомерГосРег"),          TYPE_STRING, 21);
                addNotEmpty("ISIN",               getValue(value, "ЦБISIN"),                 TYPE_STRING, 12);
                addNotEmpty("CFI",                getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВал",             getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",         getValue(value, "ЦБНоминал"),              TYPE_STRING, 29, 8);
                addNotEmpty("КолПриемЦБ",         getValue(value, "ПриемЦБКоличество"),      TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбПриемЦБ",          getValue(value, "ПриемЦБ"),                TYPE_STRING, 29, 6);
                addNotEmpty("КолСнятиеЦБ",        getValue(value, "СнятиеЦБКоличество"),     TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбСнятиеЦБ",         getValue(value, "СнятиеЦБ"),               TYPE_STRING, 29, 6);
                addNotEmpty("КолПереводЦБ",       getValue(value, "ПереводЦБКоличество"),    TYPE_NUMBER, 30, 0);
                addNotEmpty("ОбПереводЦб",        getValue(value, "ПереводЦБ"),              TYPE_NUMBER, 16, 4);
                addNotEmpty("Примечание",         getValue(value, "Примечание"),             TYPE_STRING, 512);
                m_view.printRow("ДепОперЦБ", m_row);

                it.moveNext();
            end;
        end;
    end;

    private macro printPart13()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        var appCode = "F711_0103";
        var rowCode;

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"),    TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"),     TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 12);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"),             TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"),            TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"),            TYPE_STRING, 3);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"),              TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"),          TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"),                 TYPE_STRING);
                addNotEmpty("CFI",                      getValue(value, "КодCFI"),                 TYPE_STRING, 6);
                addNotEmpty("КодВалК",                  getValue(value, "ЦБВалюта"),               TYPE_STRING, 3);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСобствВсего",           getValue(value, "СвоиЦБ_Всего"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСобствНаБС",            getValue(value, "СвоиЦБ_ОснБаланс"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦББезПризСделкиРепо",     getValue(value, "СвоиЦБ_РЕПО_БПП"),        TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПоСделкЗайма",          getValue(value, "СвоиЦБ_Займ"),            TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОбязОтсут",             getValue(value, "СвоиЦБ_ОбязОтсутств"),    TYPE_STRING, 38, 20);
                addNotEmpty("КЦБВложБезнадеж",          getValue(value, "СвоиЦБ_Безнадежн"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОшибЗачисл",            getValue(value, "СвоиЦБ_ЗачислОшибочно"),  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБДрПричины",             getValue(value, "СвоиЦБ_ИныеПричины"),     TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчДовУпр",              getValue(value, "СвоиЦБ_ДУ"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБКазнСчЭм",              getValue(value, "СвоиЦБ_КазнСчета"),       TYPE_STRING, 38, 20);
                addNotEmpty("КЦБЭмисСчет",              getValue(value, "СвоиЦБ_Эмисс"),           TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрВсего",         getValue(value, "ВсегоОбрем"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗалог",         getValue(value, "Залог"),                  TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрСчДепо",        getValue(value, "ТогрСчета"),              TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрКорпДейств",    getValue(value, "ОгранКД"),                TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрЗапрОп",        getValue(value, "ЗапретОпер"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБСчетЭскроуАг",          getValue(value, "ЦБЭскроуАгента"),         TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОсновФЗ_НПА",           getValue(value, "ОбособФЗ"),               TYPE_STRING, 38, 20);
                addNotEmpty("КЦБПредписЦБ",             getValue(value, "ОбособТреб"),             TYPE_STRING, 38, 20);
                addNotEmpty("КЦБОгрРаспрАрест",         getValue(value, "Арест"),                  TYPE_STRING, 38, 20);
                addNotEmpty("НаимОргВедУчет",           getValue(value, "МХНаименование"),         TYPE_STRING, 255);
                addNotEmpty("ПризОргВедУчет",           getValue(value, "МХПризнак"),              TYPE_STRING, 3);
                addNotEmpty("ПризнакОргВедУчет",        getValue(value, "МХИНН_Признак"),          TYPE_STRING, 3);
                addNotEmpty("ПризнакКодаОргВедНерез",   getValue(value, "МХИНН_ПризнакКода"),      TYPE_STRING, 3);
                if (in(getValue(value, "МХИНН_Признак"), "1"))
                    addNotEmpty("ИНН_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 12);
                end;
                if (in(getValue(value, "МХИНН_Признак"), "2"))
                    addNotEmpty("TIN_ОргВедУчет",       getValue(value, "МХИНН"),                  TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_ОргВедУчет",          getValue(value, "МХОГРН"),                 TYPE_STRING, 15);
                addNotEmpty("КодСтрОргВедУчет",         getValue(value, "МХОКСМ"),                 TYPE_STRING, 3);
                addNotEmpty("Примечание",               getValue(value, "Примечание"),             TYPE_STRING, 512);
                m_view.printRow("ЦБнаПравеСобств", m_row);

                it.moveNext();
            end;
        end;
    end;    
 
    private macro printPart14()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.setSortOrder(TSyncSorterPart());

        if (it.count() > 0)
            it.moveFirst();

            while (not it.isDone())
                var value = it.currentItem;

                m_row = TRcbXmlAttributesList();
                m_row.add("НомСтр", format(getValue(value, "counter"), TYPE_STRING, 5));
                addNotEmpty("НаименованиеЭм",           getValue(value, "ЭмитентНаименование"),            TYPE_STRING, 255);
                addNotEmpty("ПризнакЭм",                getValue(value, "ЭмитентИНН_Признак"),             TYPE_STRING, 1);
                addNotEmpty("ПризнакКодаЭмНерез",       getValue(value, "ЭмитентИНН_ПризнакКода"),         TYPE_STRING, 4);
                if (in(getValue(value, "ЭмитентИНН_Признак"), "1", "3"))
                    addNotEmpty("ИНН_Эм",               getValue(value, "ЭмитентИНН"),                     TYPE_STRING, 12);
                end;
                if (in(getValue(value, "ЭмитентИНН_Признак"), "2", "4"))
                    addNotEmpty("TIN_Эм",               getValue(value, "ЭмитентИНН"),                     TYPE_STRING, 30);
                end;
                addNotEmpty("ОГРН_Эм",                  getValue(value, "ЭмитентОГРН"),                    TYPE_STRING, 15);
                addNotEmpty("КодСтрЭм",                 getValue(value, "ЭмитентОКСМ"),                    TYPE_STRING, 3);
                addNotEmpty("КодВД",                    getOkved(getValue(value, "ЭмитентОКВЭД")),         TYPE_STRING);
                addNotEmpty("КодТипаЦБ",                getValue(value, "ЦБКодТипа"),                      TYPE_STRING);
                addNotEmpty("НомРегЦБ",                 getValue(value, "ЦБНомерГосРег"),                  TYPE_STRING);
                addNotEmpty("ISIN",                     getValue(value, "ЦБISIN"),                         TYPE_STRING, 12);
                addNotEmpty("CFI",                      getValue(value, "КодCFI"),                         TYPE_STRING, 6);
                addNotEmpty("КодВал",                   getValue(value, "ЦБВалюта"),                       TYPE_STRING);
                addNotEmpty("НомСтоимЦБ",               getValue(value, "ЦБНоминал"),                      TYPE_STRING, 30, 8);
                addNotEmpty("КолЦБ",                    getValue(value, "КоличествоЦБ"),                   TYPE_STRING);
                addNotEmpty("БалансСтоим",              getValue(value, "ОбъемВложений")/1000.0,           TYPE_STRING, 0, 4);
                addNotEmpty("НомерБалСч",               getValue(value, "БалансСчет"),                     TYPE_STRING);
                addNotEmpty("НакопКупДоход",            getValue(value, "НКД"),                            TYPE_STRING);
                addNotEmpty("ПереоцЦБ",                 getValue(value, "ОтрицПоложПереоценка")/1000.0,    TYPE_STRING, 0, 4);
                addNotEmpty("КорректСтоимДолгЦБ",       getValue(value, "Корр_СС_ПП")/1000.0,              TYPE_STRING, 0, 4);
                addNotEmpty("УровеньДанных",            getValue(value, "УровеньИДвиерархииСС"),           TYPE_STRING);
                addNotEmpty("КатКач",                   getValue(value, "КатКачества"),                    TYPE_NUMBER, 0, 0);
                addNotEmpty("РасчетРезервВозмПотери",   StrSubst(getValue(value, "РезервПроцент"),"%",""), TYPE_NUMBER, 3, 2);
                addNotEmpty("РезервВозмПотери",         getValue(value, "Резерв")/1000.0,                  TYPE_STRING, 0, 4);
                addNotEmpty("КорректРезервВозмПотери",  getValue(value, "Корр_резерва_ВП")/1000.0,         TYPE_STRING, 0, 4);
                addNotEmpty("Примечание",               getValue(value, "Примечание"),                     TYPE_STRING, 512);
                m_view.printRow("БалСтоимВлож", m_row);

                it.moveNext();
            end;
        end;
    end;

end;

private class TExportController()
    private var m_exportController   : Object;
    private var m_protocolContorller : Object;

    macro export()
        if (m_exportController != null)
          m_exportController.execute();
          var file_name;
            SplitFile(m_exportController.protocolFileName, file_name, null);
            var termFilePath = "$txtfile\\"+file_name+".log";
            if(not CopyFile(m_exportController.protocolFileName,termFilePath , true, "Копируется файл на терминал"))
                RsbThrow("Ошибка при передаче файла на терминал");
        end;
    end;
    end;

    macro showProtocol()
        objectFactoryInstance.createXmlExportProtocolView("ПРОТОКОЛ ЭКСПОРТА В XML-ФОРМАТЕ", null).show();
    end;

    private macro constructorTExportController()
        if   (rcbApplication().currentReport.context.period.endDate >= RCB_I6800_DATE)
            m_exportController   = TF711XmlExportController_6800();
        elif   (rcbApplication().currentReport.context.period.endDate >= RCB_I6406_DATE)
            m_exportController   = TF711XmlExportController_6406();
        elif   (rcbApplication().currentReport.context.period.endDate >= RCB_I5986_DATE_F711)
            m_exportController   = TF711XmlExportController_5986();
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_F711_56_PAK_DATE)
            m_exportController   = TF711XmlExportController_56_PAK();
        else
            MsgBox("Экспорт в ПК Дельта для отчета|с 'Датой окончания' менее '" + RCB_F711_56_PAK_DATE + "' не предусмотрен!");
        end;
    end;

    constructorTExportController();
end;

macro showXmlExportProtocol(commandLineArguments : String)
    TExportController().showProtocol();
end;

macro executeXmlExportOperation()
    var controller = TExportController();
    controller.export();
end;

УстановитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
