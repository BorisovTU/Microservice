/*
$Name:          ReportNode.mac
$Module:        Регламентируемая отчетность
$Description:   Класс узла нормализации
*/

import ReportNormalizationAlgorithm;

class DummyGroup()
    macro setIsSeparateOnSubgroups()
    end;

    macro setIsOptimalDecision()
    end;

    macro setMaxNumberOfDecision()
    end;

    macro setIsAdditionalCheck()
    end;
end;

class ReportNode(node : Object)
    private var m_node = node;

    macro get()
        return m_node;
    end;

    macro getCode()
        return m_node.getId();
    end;

    macro code()
        return getCode();
    end;

    macro addNode(id)
        return ReportNode(m_node.addNode(id));
    end;

    macro getExact()
        return m_node.getExact();
    end;

    macro exact()
        return m_node.getExact();
    end;

    macro setExact(v)
        m_node.setExact(v)
    end;

    macro recalculateScaled()
        m_node.recalculateScaled();
    end;

    macro scaled()
        return m_node.getScaled()
    end;

    macro getScaled()
        return m_node.getScaled()
    end;

    macro getScaledInDoubleFormat()
        return m_node.getScaled()
    end;

    macro setScaled(v)
        m_node.setScaled(v)
    end;

    macro getDef()
        return m_node.getDef();
    end;

    macro setDef(def)
        m_node.setDef(def);
    end;

    macro getLevel()
        return m_node.getLevel();
    end;

    macro setLevel(level)
        return m_node.setLevel(level);
    end;

    macro setGroup(group)
        m_node.setGroup(group);
    end;

    macro getGroup()
        return m_node.getGroup();
    end;

    macro setUserPriority(up)
        return m_node.setUserPriority(up);
    end;

    macro isExcluded()
        return m_node.isExcluded();
    end;

    macro exclude()
        return m_node.exclude();
    end;
end;

class JSMReportNode(node : Object)
    private var m_node = node;

    macro get()
        return m_node;
    end;

    macro getCode()
        return m_node.getId();
    end;

    macro code()
        return getCode();
    end;

    macro addNode(id)
        return JSMReportNode(m_node.addNode(id));
    end;

    macro getExact()
        return m_node.getValue().getExact();
    end;

    macro exact()
        return m_node.getValue().getExact();
    end;

    macro setExact(v)
        m_node.getValue().setExact(Money(v));
    end;

    macro recalculateScaled()
        m_node.getValue().recalculateScaled();
    end;

    macro scaled()
        if (m_node.getNormalizer().isNormalized())
            return m_node.getValue().getNormalized();
        else
            return m_node.getValue().getScaled();
        end;
    end;

    macro getScaled()
        if (m_node.getNormalizer().isNormalized())
            return m_node.getValue().getNormalized();
        else
            return m_node.getValue().getScaled();
        end;
    end;

    macro getScaledInDoubleFormat()
        if (m_node.getNormalizer().isNormalized())
            return m_node.getValue().getNormalized();
        else
            return m_node.getValue().getScaled();
        end;
    end;

    macro setScaled(v)
        m_node.getValue().setScaled(Double(v));
        m_node.getValue().setNormalized(Double(v));
    end;

    macro getDef()
        return m_node.getDef();
    end;

    macro setDef(def)
        m_node.setDef(def);
    end;

    macro getLevel()
        return 0;
    end;

    macro setLevel(level)
        return this;
    end;

    macro setGroup(group)
        return this;
    end;

    macro getGroup()
        return DummyGroup();
    end;

    macro setUserPriority(up)
        m_node.setWeightCoefficient(100-up+1);
        return this;
    end;

    macro isExcluded()
        return m_node.isExcluded();
    end;

    macro exclude()
        return m_node.exclude();
    end;
end;