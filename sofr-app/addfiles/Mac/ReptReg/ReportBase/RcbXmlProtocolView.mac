/*
$Name: RcbXmlProtocolView.mac
$Module: Регламентируемая отчетность
$Description: Представление протоколов эспорта в XML.
*/

/**
 * Класс представления протокола экспорта в XML.
 * Поскольку аналитики "Отчетность v.5.5" на конец ноября 2018 года не в курсе требований к протоколам "RS-Reporting V.6",
 * пришлось делать этот костыль
 * @autor const1995
 */
class (TProtocolView) TXmlProtocolView(description : String, reportName : String)
    private macro constructorTXmlProtocolView(description, reportName)
        initTProtocolView(description, reportName);
    end;

    macro printHead()
        printServiceLine(m_reportName + ". " + m_description);
        printServiceLine("");
        printServiceLine("Период отчета с " + RcbApplication().currentReport.context.period.beginDate + " по " + RcbApplication().currentReport.context.period.endDate);
        printServiceLine("Дата и время выполнения процедуры " + date() + " " + strSubst(String(Time()), " ", "0"));
        printServiceLine("Исполнитель " + {oper} + " " + исполнитель);
        printServiceLine("");
    end;

    constructorTXmlProtocolView(description, reportName);
end;
