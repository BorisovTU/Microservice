/*
$Name:          RcbPartCalculateController.mac
$Module:        Регламентируемая отчетность
$Description:   ReportBase. Класс контроллера расчета раздела
*/

class RcbPartCalculateController(reportCalculateController : Object /*RcbReportCalculateController*/, partId : String)
    private var m_reportCalculateController : Object;
    private var m_partId           : String;
    private var m_report           : RcbReportBase;
    private var m_part             : RcbPartBase;
    private var m_dataSources      : RcbDataSources;
    private var m_dataSouceFilters : RcbDataSourceFilters;

    macro getPartId()
        return m_partId;
    end;

    macro execute()
        throw(TPureVirtualMethodCallException("RcbPartCalculateController::execute"));
    end;

    private macro constructorRcbPartCalculateController(reportCalculateController : Object, partId : String)
        if (reportCalculateController != null)
            m_reportCalculateController = weakRef(reportCalculateController);
        else
            m_reportCalculateController = null;
        end;
        m_partId = partId;
        m_report = m_reportCalculateController.getReport();
        m_part = m_reportCalculateController.getReport().getPart(m_partId);
        m_dataSources = m_reportCalculateController.getDataSources();
        m_dataSouceFilters = m_dataSources.getDataSourceFilters();
    end;

    constructorRcbPartCalculateController(reportCalculateController, partId);
end;
