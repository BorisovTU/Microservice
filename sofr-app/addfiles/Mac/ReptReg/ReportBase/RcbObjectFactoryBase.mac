/*
$Name:          RcbObjectFactoryBase.mac
$Module:        Регламентируемая отчетность
$Description:   Базовый класс фабрики объектов
*/

class RcbObjectFactoryBase(instructionDate : Date)
    private var m_instructionDate : Date = instructionDate;

    macro setInstructionDate(instructionDate : Date)
        m_instructionDate = instructionDate;
    end;

    macro getInstructionDate()
        return m_instructionDate;
    end;
    /**
     * Метод используется при создании RcbReportView
     * Данный класс генериться именно таким образом, т.к. требует инкапсуляции представления
     * шапок(подвалов) печатных форм отчета в RcbReportView
     */
    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        if   (rcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
            return genObject("TPrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2851_DATE)
            return genObject("TPrintableView_2851", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2742_DATE)
            return genObject("TPrintableView_2742", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
            return genObject("TPrintableView_2332", formName, formOkudCode, formPeriodicity, periodFormat);
        else
            return genObject("TPrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
        end;
    end;

    macro createReport(report : RcbReport) /*: RcbReportBase*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createReport"));
    end;

    macro createPart() /*: RcbPartBase*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createPart"));
    end;

    macro createAttribute() /*: RcbAttributeBase*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createAttribute"));
    end;

    macro createDataSources() /*: RcbDataSources*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createDataSources"));
    end;

    macro createDataSourceFilters() /*: RcbDataSourceFilter*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createDataSourceFilters"));
    end;

    macro createCalculateProtocolView() /*: RcbCalculateProtocolView*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createCalculateProtocolView"));
    end;

    macro createReportCalculateController() /*: RcbReportCalculateController*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createReportCalculateController"));
    end;

    macro createReportView() /*: RcbReportView*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createReportView"));
    end;

    macro createPrintProtocolView() /*: RcbCalculateProtocolView*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createPrintProtocolView"));
    end;

    macro createReportPrintController() /*: RcbReportPrintController*/
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createPrintProtocolView"));
    end;

    macro createCheckProtocolView(protocolName : String)
        throw(TPureVirtualMethodCallException("RcbObjectFactory::createCheckProtocolView"));
    end;

    macro createArOkatoCodesTuneTable()
        if (RcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE)
            return genObject("RcbArTuneTable_4637", RCB_I4637_DATE);
        else
            return genObject("RcbArTuneTable");
        end;
    end;
end;

var objectFactoryInstance : RcbObjectFactoryBase = null;
