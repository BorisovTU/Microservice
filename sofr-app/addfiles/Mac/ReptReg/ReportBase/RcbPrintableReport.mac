/**
 * Печать отчета.
 * 
 * @since   07.08.2007
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */

import rcbPrintableView;

/**
 * Базовый класс печати отчета.
 */
class (TPrintableView) TPrintableReport(formName, formOkudCode, formPeriodicity, periodFormat)

    /**
     *  Пуст ли отчет?
     */
    macro isEmpty()
        throw(TPureVirtualMethodCallException("TPrintableReport::isEmpty"));
    end;
 
    /**
     * Напечатать содержательную часть(зону) отчета.
     */
    private macro printDataZone()
        throw(TPureVirtualMethodCallException("TPrintableReport::printDataZone"));
    end;

 
    /**
     * Выполнить печать отчета в поток m_printFileName.
     */
    macro print()
        
        var oldOutput;

        oldOutput = setOutput(m_printFileName);

        setReportWidth();
        printLendingAgencyCodeZone();
        printNamesZone();  

        if(isEmpty)
            printNullDataZone();
        else
            printDataZone();
        end;

        printSignatureZone();

        setOutput(oldOutput, true);
    end;

    /**
     *  Конструктор.
     */
    private macro constructorTPrintableReport(formName, formOkudCode, formPeriodicity, periodFormat)
        initTPrintableView(formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    constructorTPrintableReport(formName, formOkudCode, formPeriodicity, periodFormat); 
end;