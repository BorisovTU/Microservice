/* --------------------------------------------------------------------------┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Форма 345. Раздел отчета.

   CREATED : 21.09.12 Gor.
L-------------------------------------------------------------------------- */
class (RcbPartBase) F345Part(id : String, compositeValue)
    initRcbPartBase(id, compositeValue);

    private var m_isEmpty = true;

    private macro getAttributeCompositeValue(attributeId : String)
        var keyValue = m_compositeValue.createKeyValue();

        keyValue.fieldValue("part") = getId();

        keyValue.fieldValue("columnId") = attributeId;

        var compositeValue = m_compositeValue.findValue(keyValue);

        if (compositeValue != null)
            return compositeValue;
        end;

        compositeValue = m_compositeValue.addValue();
    
        compositeValue.reset();

        compositeValue.fieldValue("part").exact = getId();

        compositeValue.fieldValue("columnId").exact = attributeId;

        return compositeValue;
    end;                              

    macro getAttribute(attributeId : String) : RcbAttributeBase
        m_attributes.moveFirst();
        while (m_attributes.moveNext())
            if (m_attributes.getCurrentItem().getId() == attributeId)
                return m_attributes.getCurrentItem();
            end;
        end;

        return m_attributes.push_back(objectFactoryInstance.createAttribute(attributeId, this, getAttributeCompositeValue(attributeId)));
    end;

end;