/*
$Name:        com_f251.mac
$Module:      Регламентируемая отчетность
$Description: Форма 251. Общие функции и переменные для расчета и печати
*/

import rcb_bo, chk_regd, ReptCBInter, log_lib, rcbCoreInter;;
var t=time;
var Дата2_1660У = date( 1, 7, 2006 );

var Lines = TArray;
/*ГК 3,4*/
Lines(0) = "1.1";
Lines(1) = "1.1.1";/*3,4,5,6*/
Lines(2) = "1.1.1.1";
Lines(3) = "1.1.1.1.1";
Lines(4) = "1.3";
/*3,4,5,6*/
Lines(5) = "2.1.1";
Lines(6) = "2.1.1.1.1";
Lines(7) = "2.1.2";
Lines(8) = "2.1.3";
Lines(9) = "2.1.4";
Lines(10) = "2.1.5";
Lines(11) = "2.2.1";
Lines(12) = "2.2.1.1.1";
Lines(13) = "2.2.2";
Lines(14) = "2.2.3";
Lines(15) = "2.2.4";
Lines(16) = "2.2.5";
Lines(17) = "2.3.1";
Lines(18) = "2.3.2";
Lines(19) = "2.3.3";
Lines(20) = "2.3.4";
Lines(21) = "2.3.5";
Lines(22) = "2.5";
Lines(23) = "3.1";
Lines(24) = "3.1.1";
Lines(25) = "3.1.2";
Lines(26) = "3.2";
Lines(27) = "3.2.1";
Lines(28) = "3.2.2";
Lines(29) = "3.3";
Lines(30) = "3.3.1";
/*Retail 3,4*/
Lines(31) = "1.2";
Lines(32) = "1.2.1";
Lines(33) = "1.2.2";/*5,6*/
Lines(34) = "2.4";  /*5,6*/
Lines(35) = "1.2.2.1.1";
/*Переменные ручного ввода*/
Lines(36) = "1.2.2.1";
Lines(37) = "1.2.2.1.2";
Lines(38) = "2.1.1.1";
Lines(39) = "2.2.1.1";
Lines(40) = "2.2.1.1.2";

var Lines_2332 = TArray;
/*ГК 3,4*/
Lines_2332(0) = "1.1";/*3,4,5,6*/
Lines_2332(1) = "1.1.1";/*3,4,5,6*/
Lines_2332(2) = "1.1.1.1";
Lines_2332(3) = "1.1.1.1.1";
Lines_2332(4) = "1.3";/*3,4,5,6*/
/*3,4,5,6*/
Lines_2332(5) = "2.1.1";
Lines_2332(6) = "2.1.1.1.1";
Lines_2332(7) = "2.1.2";
Lines_2332(8) = "2.1.3";
Lines_2332(9) = "2.1.4";
Lines_2332(10) = "2.1.5";
Lines_2332(11) = "2.2.1";
Lines_2332(12) = "2.2.1.1.1";
Lines_2332(13) = "2.2.2";
Lines_2332(14) = "2.2.3";
Lines_2332(15) = "2.2.4";
Lines_2332(16) = "2.2.5";
Lines_2332(17) = "2.3.1";
Lines_2332(18) = "2.3.2";
Lines_2332(19) = "2.3.3";
Lines_2332(20) = "2.3.4";
Lines_2332(21) = "2.3.5";
Lines_2332(22) = "2.5";
Lines_2332(23) = "3.1";
Lines_2332(24) = "3.1.1";
Lines_2332(25) = "3.2";
Lines_2332(26) = "3.2.1";
Lines_2332(27) = "3.3";
Lines_2332(28) = "3.3.1";
Lines_2332(29) = "3.4";
Lines_2332(30) = "3.4.1";
Lines_2332(31) = "4.1";
Lines_2332(32) = "4.1.1";
Lines_2332(33) = "4.1.2";

/*Retail 3,4*/
Lines_2332(34) = "1.2";/*3,4,5,6*/
Lines_2332(35) = "1.2.1";
Lines_2332(36) = "1.2.2";/*5,6*/
Lines_2332(37) = "2.4";  /*5,6*/
Lines_2332(38) = "1.2.2.1.1";
/*Переменные ручного ввода*/
Lines_2332(39) = "1.2.2.1";
Lines_2332(40) = "1.2.2.1.2";
Lines_2332(41) = "2.1.1.1";
Lines_2332(42) = "2.2.1.1";
Lines_2332(43) = "2.2.1.1.2";
Lines_2332(44) = "2.4.1";
Lines_2332(45) = "2.4.1.1";
Lines_2332(46) = "2.4.1.2";
Lines_2332(47) = "2.4.1.2.1";
Lines_2332(48) = "2.4.2";
Lines_2332(49) = "2.4.2.1";
Lines_2332(50) = "2.4.2.2";
Lines_2332(51) = "2.4.2.2.1";

var LinesSave = TArray;
/*ГК 3,4*/
LinesSave(0) = "1_1";
LinesSave(1) = "1_1_1";/*3,4,5,6*/
LinesSave(2) = "1_1_1_1";
LinesSave(3) = "1_1_1_1_1";
LinesSave(4) = "1_3";
/*3,4,5,6*/
LinesSave(5) = "2_1_1";
LinesSave(6) = "2_1_1_1_1";
LinesSave(7) = "2_1_2";
LinesSave(8) = "2_1_3";
LinesSave(9) = "2_1_4";
LinesSave(10) = "2_1_5";
LinesSave(11) = "2_2_1";
LinesSave(12) = "2_2_1_1_1";
LinesSave(13) = "2_2_2";
LinesSave(14) = "2_2_3";
LinesSave(15) = "2_2_4";
LinesSave(16) = "2_2_5";
LinesSave(17) = "2_3_1";
LinesSave(18) = "2_3_2";
LinesSave(19) = "2_3_3";
LinesSave(20) = "2_3_4";
LinesSave(21) = "2_3_5";
LinesSave(22) = "2_5";
LinesSave(23) = "3_1";
LinesSave(24) = "3_1_1";
LinesSave(25) = "3_1_2";
LinesSave(26) = "3_2";
LinesSave(27) = "3_2_1";
LinesSave(28) = "3_2_2";
LinesSave(29) = "3_3";
LinesSave(30) = "3_3_1";
/*Retail 3,4*/
LinesSave(31) = "1_2";
LinesSave(32) = "1_2_1";
LinesSave(33) = "1_2_2";/*5,6*/
LinesSave(34) = "2_4";  /*5,6*/
LinesSave(35) = "1_2_2_1_1";
/*Переменные ручного ввода*/
LinesSave(36) = "1_2_2_1";
LinesSave(37) = "1_2_2_1_2";
LinesSave(38) = "2_1_1_1";
LinesSave(39) = "2_2_1_1";
LinesSave(40) = "2_2_1_1_2";

var LinesSave_2332 = TArray;
/*ГК 3,4*/
LinesSave_2332(0) = "1_1";
LinesSave_2332(1) = "1_1_1";/*3,4,5,6*/
LinesSave_2332(2) = "1_1_1_1";
LinesSave_2332(3) = "1_1_1_1_1";
LinesSave_2332(4) = "1_3";/*3,4,5,6*/
/*3,4,5,6*/
LinesSave_2332(5) = "2_1_1";
LinesSave_2332(6) = "2_1_1_1_1";
LinesSave_2332(7) = "2_1_2";
LinesSave_2332(8) = "2_1_3";
LinesSave_2332(9) = "2_1_4";
LinesSave_2332(10) = "2_1_5";
LinesSave_2332(11) = "2_2_1";
LinesSave_2332(12) = "2_2_1_1_1";
LinesSave_2332(13) = "2_2_2";
LinesSave_2332(14) = "2_2_3";
LinesSave_2332(15) = "2_2_4";
LinesSave_2332(16) = "2_2_5";
LinesSave_2332(17) = "2_3_1";
LinesSave_2332(18) = "2_3_2";
LinesSave_2332(19) = "2_3_3";
LinesSave_2332(20) = "2_3_4";
LinesSave_2332(21) = "2_3_5";
LinesSave_2332(22) = "2_5";
LinesSave_2332(23) = "3_1";
LinesSave_2332(24) = "3_1_1";
LinesSave_2332(25) = "3_2";
LinesSave_2332(26) = "3_2_1";
LinesSave_2332(27) = "3_3";
LinesSave_2332(28) = "3_3_1";
LinesSave_2332(29) = "3_4";
LinesSave_2332(30) = "3_4_1";
LinesSave_2332(31) = "4_1";
LinesSave_2332(32) = "4_1_1";
LinesSave_2332(33) = "4_1_2";

/*Retail 3,4*/
LinesSave_2332(34) = "1_2";/*3,4,5,6*/
LinesSave_2332(35) = "1_2_1";
LinesSave_2332(36) = "1_2_2";/*5,6*/
LinesSave_2332(37) = "2_4";  /*5,6*/
LinesSave_2332(38) = "1_2_2_1_1";
/*Переменные ручного ввода*/
LinesSave_2332(39) = "1_2_2_1";
LinesSave_2332(40) = "1_2_2_1_2";
LinesSave_2332(41) = "2_1_1_1";
LinesSave_2332(42) = "2_2_1_1";
LinesSave_2332(43) = "2_2_1_1_2";
LinesSave_2332(44) = "2_4_1";
LinesSave_2332(45) = "2_4_1_1";
LinesSave_2332(46) = "2_4_1_2";
LinesSave_2332(47) = "2_4_1_2_1";
LinesSave_2332(48) = "2_4_2";
LinesSave_2332(49) = "2_4_2_1";
LinesSave_2332(50) = "2_4_2_2";
LinesSave_2332(51) = "2_4_2_2_1";

var ShifrDoc = TArray;
ShifrDoc(0) = "01";
ShifrDoc(1) = "01";
ShifrDoc(2) = "08";
ShifrDoc(3) = "02";
ShifrDoc(4) = "06";
ShifrDoc(5) = "07";
ShifrDoc(6) = "01";
ShifrDoc(7) = "01";
ShifrDoc(8) = "08";
ShifrDoc(9) = "021";
ShifrDoc(10) = "06";
ShifrDoc(11) = "07";
ShifrDoc(12) = "01";
ShifrDoc(13) = "08";
ShifrDoc(14) = "02";
ShifrDoc(15) = "06";
ShifrDoc(16) = "07";
ShifrDoc(17) = "09";

macro GetVarValue( _row, _column )  // _row - индекс строки в массиве Lines
    var temp1, temp2, varName = "Ф251__" + LinesSave[_row] + "__" + _column;
    if( not ПрочитатьПеременную2( temp1, temp2, ДатаОтчета, ПредДатаОтчета, {Название отчета}, varName ) )
        return "";
    end;
    if( _column < 5 )
        return temp1;
    else
        return temp2;
    end;
end;

macro GetVarValue_2332( _row, _column )  // _row - индекс строки в массиве Lines
    var temp1, temp2, varName = "Ф251__" + LinesSave_2332[_row] + "__" + _column;
    if( not ПрочитатьПеременную2( temp1, temp2, ДатаОтчета, ПредДатаОтчета, {Название отчета}, varName ) )
        return "";
    end;
    if( _column < 5 )
        return temp1;
    else
        return temp2;
    end;
end;

// Для будущих применений, если понадобится
macro isEmptyReport()
    return false;
end;
