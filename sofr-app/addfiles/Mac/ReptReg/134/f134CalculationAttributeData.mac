/**
 * RS-Bank 6.0                                            R-Style Software Lab
 *
 * File Name   : f134CalculationAttributeData.mac
 * Description : Набор данных для расчета одного атрибута(переменной)
 * Comment     : 
 * @since      : 27.10.2010
 * @version    : 6.00.020.29
 */

import RcbProcessingAttributeData;
import f134DependencesData;

/**
 * Виды пересчета
 */
const RK_UNDEFINED                       = 0;      //Нет пересчета
const RK_AFTER_SUMMARIZE                 = 1;      //Пересчет после СВОДа.

class T134CalculationAttributeData(attribute : String, calculationData : RcbCalculationData, dependencesData : T134DependencesData, recalculateKind : integer)
    /**
     * Атрибут(переменная).
     */
    private var m_attribute : String;
    
    /**
     * Данные для вызова метода расчета переменной.
     */
    private var m_calculationData : RcbCalculationData;
    
    /**
     * Признак, что атрибут расчитан.
     */
    private var m_isCalculated : bool;
    
    /**
     * Список зависимостей атрибута(переменной).
     */
    private var m_dependencesData : T134DependencesData;

    /**
     * Вид пересчета атрибута
     */
    var m_recalculateKind : integer = RK_UNDEFINED;

    macro isCalculated() : bool
        return m_isCalculated;
    end;
    
    macro setCalculated()
        m_isCalculated = true;
    end;
    
    macro setNotCalculated()
        m_isCalculated = false;
    end;
    
    macro setAfterSummarizeRecalculate()
        m_recalculateKind = RK_AFTER_SUMMARIZE;
    end;
    
    macro getAttribute() : String
        return m_attribute;
    end;
    
    macro getCalculationData() : RcbCalculationData
        return m_calculationData;
    end;
    
    macro getDependencesData() : T134DependencesData
        return m_dependencesData.getDependenceAttributePool();;
    end;

    /**
     * Признак пересчета после СВОДа.
     */
    macro isAfterSummarizeRecalculate() : bool
        return (m_recalculateKind == RK_AFTER_SUMMARIZE);
    end;
    
    /**
     * @param     attribute	
     * @param     calculationData	
     * @param     dependencesData
     * @param     recalculateKind
     */
    private macro constructorT134CalculationAttributeData(attribute : String, calculationData : RcbCalculationData, dependencesData : T134DependencesData, recalculateKind : integer)

        m_attribute = attribute;

        m_calculationData = calculationData;

        m_dependencesData = nvl(dependencesData, T134DependencesData());

        if (valType(recalculateKind) != V_UNDEF)
            m_recalculateKind = recalculateKind;
        end;
    end;

    constructorT134CalculationAttributeData(attribute, calculationData, dependencesData, recalculateKind);
end;