/*
$Name:          p_f711.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 711. Печать формы
*/

/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Печать формы 711

   CREATED : 09.09.05   Лузгин

   MODIFICATIONS:
   NOTES:

└─────────────────────────────────────────────────────────────────────────- */
import RcbCoreInter;
IMPORT RsbDataSet, param, com_f711;
import com_f711;
import RcbPrintableView;

import com_f711objectFactory;
import print_f711bill;
import print_f711Part3;
import print_f711Part4;

/**
 *  Печатное представление формы в соответствии с 1376-У
 *  @author Лузгин
 *  @since 6.00.020.xx
 */
private class TReportView_I1376()

    VAR EmptyReport = true;     // Флаг отчета без данных
    VAR NoData = TArray;        // Массив индикаторов отсутствия данных
                                //  в отдельных таблицах отчетной формы
    VAR Report;
    var VarArray = TArray;
    var values_2_1 = TArray;
    var values_2_2 = TArray;
    var values_3_1 = TArray;
    var values_3_2 = TArray;
    var count_2_1, count_2_2, count_3_1, count_3_2; // Кол-во структурных значений в разделах 2 и 3

    const COLUMN_1   = 15;      // Количество выводимых столбцов в разделе 1
    const COLUMN_1_1 = 9;       //                               в разделе 1.1
    const COLUMN_2   = 5;       //                               в разделе 2
    const COLUMN_3_1 = 18;      //                               в разделе 3.1
    const COLUMN_3_2 = 12;      //                               в разделе 3.2
    /* ========================= Вспомогательные функции ====================== */

    // Загрузить все переменные формы из базы данных
    MACRO LoadAllVars()

        var i = 0;
        while( i < 6 )
            NoData[i] = true;
            i = i + 1;
        end;

        message( "Чтение переменных первого раздела..." );
        var name, temp;
        i = 0;
        while( i < MaxColumn_1_1 )
            i = i + 1;
            VarArray[i] = 0;
            name = GetVarName( 1, i );

            VarArray[i] = RcbApplication().currentReport().attributeValue(name).current;

    //        if( not ПрочитатьПеременную2( temp, VarArray[i] , ДатаОтчета, ПредДатаОтчета, {Название отчета}, name ) )
    //            msgbox( "Ошибка чтения переменной ", name );
            /*el*/if( (NoData[0]) and ( VarArray[i] > 0 ) )
                NoData[0] = false;
                EmptyReport = false;
            end;
        end;
        while( i < MaxColumn_1 )
            i = i + 1;
            VarArray[i] = 0;
            name = GetVarName( 1, i );

            VarArray[i] = RcbApplication().currentReport().attributeValue(name).current;

    //        if( not ПрочитатьПеременную2( temp, VarArray[i] , ДатаОтчета, ПредДатаОтчета, {Название отчета}, name ) )
    //            msgbox( "Ошибка чтения переменной ", name );
            /*el*/if( (NoData[1]) and ( VarArray[i] > 0 ) )
                NoData[1] = false;
                EmptyReport = false;
            end;
        end;

        message( "Чтение переменных второго раздела..." );

        // Чтение переменных раздела 2.1
        var iterator = rcbApplication.currentReport().attributeValue("Ф711_2_1").createValueIterator();
        iterator.moveFirst();

        i = 0;
        count_2_1 = iterator.count();

        while (not iterator.isDone())
            values_2_1[i] = iterator.CurrentItem.fieldValue("Наименование депозитария").currentAsString;
            i = i + 1;
            values_2_1[i] = iterator.CurrentItem.fieldValue("Лицензия участника ОРЦБ").currentAsString;
            i = i + 1;
            values_2_1[i] = iterator.CurrentItem.fieldValue("Признак депозитария").currentAsString;
            i = i + 1;
            values_2_1[i] = iterator.CurrentItem.fieldValue("Междепозитарный счет").currentAsString;
            i = i + 1;
            values_2_1[i] = iterator.CurrentItem.fieldValue("Количество ц/б на счете").currentAsString;
            i = i + 1;

            iterator.moveNext();
        end;

        if (values_2_1.size > 0)
            NoData[2] = false;
            EmptyReport = false;
        end;

        // Чтение переменных раздела 2.2
        iterator = rcbApplication.currentReport().attributeValue("Ф711_2_2").createValueIterator();
        iterator.moveFirst();

        i = 0;
        count_2_2 = iterator.count();

        while (not iterator.isDone())
            values_2_2[i] = iterator.CurrentItem.fieldValue("Наименование депозитария").currentAsString;
            i = i + 1;
            values_2_2[i] = iterator.CurrentItem.fieldValue("Лицензия участника ОРЦБ").currentAsString;
            i = i + 1;
            values_2_2[i] = iterator.CurrentItem.fieldValue("Признак депозитария").currentAsString;
            i = i + 1;
            values_2_2[i] = iterator.CurrentItem.fieldValue("Междепозитарный счет").currentAsString;
            i = i + 1;
            values_2_2[i] = iterator.CurrentItem.fieldValue("Количество ц/б на счете").currentAsString;
            i = i + 1;

            iterator.moveNext();
        end;

        if (values_2_2.size > 0)
            NoData[3] = false;
            EmptyReport = false;
        end;

        message( "Чтение переменных третьего раздела..." );

        // Чтение переменных раздела 3.1
        iterator = rcbApplication.currentReport().attributeValue("Ф711_3_1").createValueIterator();
        iterator.moveFirst();

        i = 0;
        count_3_1 = 0;

        while (not iterator.isDone())
            // проверка по 123567
            if (not ((iterator.CurrentItem.fieldValue("Графа 32").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 33").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 34").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 35").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 36").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 37").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 38").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 39").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 40").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 41").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 42").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 43").current == 0)))

                values_3_1[i] = iterator.CurrentItem.fieldValue("Эмитент").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("ИНН эмитента").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Код типа ц/б").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Идентификатор ц/б").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Валюта ц/б").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Номинал ц/б").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 32").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 33").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 34").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 35").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 36").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 37").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 38").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 39").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 40").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 41").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 42").currentAsString;
                i = i + 1;
                values_3_1[i] = iterator.CurrentItem.fieldValue("Графа 43").currentAsString;
                i = i + 1;
                count_3_1 = count_3_1 + 1;
            end;

            iterator.moveNext();
        end;

        if (values_3_1.size > 0)
            NoData[4] = false;
            EmptyReport = false;
        end;

        // Чтение переменных раздела 3.2
        iterator = rcbApplication.currentReport().attributeValue("Ф711_3_2").createValueIterator();
        iterator.moveFirst();

        i = 0;
        count_3_2 = 0;

        while (not iterator.isDone())
            // проверка по 123567
            if (not ((iterator.CurrentItem.fieldValue("Графа 50").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 51").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 52").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 53").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 54").current == 0)
                and  (iterator.CurrentItem.fieldValue("Графа 55").current == 0)))

                values_3_2[i] = iterator.CurrentItem.fieldValue("Эмитент").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("ИНН эмитента").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Код типа ц/б").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Идентификатор ц/б").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Валюта ц/б").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Номинал ц/б").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 50").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 51").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 52").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 53").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 54").currentAsString;
                i = i + 1;
                values_3_2[i] = iterator.CurrentItem.fieldValue("Графа 55").currentAsString;
                i = i + 1;
                count_3_2 = count_3_2 + 1;
            end;

            iterator.moveNext();
        end;

        if (values_3_2.size > 0)
            NoData[5] = false;
            EmptyReport = false;
        end;
    END;

    // Инициализировать таблицу вывода структурных значений по метаинформации
    MACRO InitReport( meta, depart )
        Report = CTableReport( 1, false, false );
        var maxi, i = 0;
        maxi = meta.FieldSizes.size();
        if( depart == 3 )       // не учитываем вспомогательные свойства для экспорта
            maxi = maxi = maxi - 2;
        end;
        while( i < maxi )
            Report.AddColumn( "", meta.FieldSizes[i] );
            i = i + 1;
        end;
    END;


    /* ====================== Печать элементов отчета ========================= */

    MACRO PrintHeader()

    [
                                                                                                         Банковская отчетность
                         ┌────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────┐
                         │ Код территории │                               Код кредитной организации                                          │
                         │   по ОКАТО     ├──────────┬───────────────┬──────────────────────┬─────────────┬──────────────────────────────────┤
                         │                │ по ОКПО  │    Основной   │Регистрационный номер │     БИК     │ Номер лицензии профессионального │
                         │                │          │государственный│  (/порядковый номер) │             │   участника рынка ценных бумаг   │
                         │                │          │регистрационный│                      │             │                                  │
                         │                │          │     номер     │                      │             │                                  │
                         ├────────────────┼──────────┼───────────────┼──────────────────────┼─────────────┼──────────────────────────────────┤
                         │################│##########│###############│######################│#############│ ################################ │
                         └────────────────┴──────────┴───────────────┴──────────────────────┴─────────────┴──────────────────────────────────┘


                                                   ДЕПОЗИТАРНЫЙ ОТЧЕТ
                                               по состоянию на ##########

    Наименование кредитной организации (ее филиала): #
    Почтовый адрес кредитной организации:            #

                                                                                                                            Код формы 0409711
                                                                                                                                  Квартальная


    ]( Код_СОАТО:c, Код_ОКПО:c, ОГРН:c, РегНомерБанка:c, {MFO_Bank}:c, GetLicenseNumber(OurBank):c,
       ДатаОтчета:l, {Name_Bank}:l, {Post_Addr}:l );

    END;

    MACRO PrintDepart_1()

    [
        Раздел 1. Счета депо

       1.1. Счета депо клиентов, штук];

        if (NoData[0])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌─────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐
      │Счета для учета ценных бумаг,│  Междепозитарные счета депо │              │              │              │              │              │
      │   принадлежащих клиентам    │  "ЛОРО", открытые сторонним │    Счета     │    Счета     │ Эмиссионные  │    Счета     │    Счета,    │
      │    депозитария на правах    │        депозитариям         │   залого-    │ доверительных│    счета     │  эмитентов   │  владельцы   │
      │       собственности         │                             │  держателей  │ управляющих  │              │              │  которых не  │
      ├──────────────┬──────────────┼──────────────┬──────────────┤              │              │              │              │  установлены │
      │  резидентам  │ нерезидентам │  резидентам  │ нерезидентам │              │              │              │              │              │
      ├──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │      1       │      2       │      3       │      4       │      5       │      6       │      7       │      8       │      9       │
      ├──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │ ############ │ ############ │ ############ │ ############ │ ############ │ ############ │ ############ │ ############ │ ############ │
      └──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┘

    ] ( VarArray[1]:0:0:r,
        VarArray[2]:0:0:r,
        VarArray[3]:0:0:r,
        VarArray[4]:0:0:r,
        VarArray[5]:0:0:r,
        VarArray[6]:0:0:r,
        VarArray[7]:0:0:r,
        VarArray[8]:0:0:r,
        VarArray[9]:0:0:r);

        end;

    [   1.2. Счета депо кредитной организации, штук];

        if (NoData[1])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐
      │Счета для учета ценных бумаг,│    Счета     │     Счета    │              │              │              │
      │   принадлежащих кредитной   │   залого-    │    довери-   │ Эмиссионные  │    Счета     │    Иные      │
      │    организации на правах    │  держателя   │   тельного   │    счета     │  эмитента    │    счета     │
      │       собственности         │              │ управляющего │              │              │              │
      ├─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │              10             │      11      │      12      │      13      │      14      │      15      │
      ├─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │ ########################### │ ############ │ ############ │ ############ │ ############ │ ############ │
      └─────────────────────────────┴──────────────┴──────────────┴──────────────┴──────────────┴──────────────┘
    ] ( VarArray[10]:0:0:r,
        VarArray[11]:0:0:r,
        VarArray[12]:0:0:r,
        VarArray[13]:0:0:r,
        VarArray[14]:0:0:r,
        VarArray[15]:0:0:r  );

        end;

    END;

    MACRO PrintDepart_2()

        macro FormatValues( values );
            var i = 0;
            while( i < values.size )
                if( (values[i] == NULL) or (values[i] == "") or (values[i] == "Undefined"))
                    values[i] = " ";
                end;
                i = i + 1;
            end;
        end;

        Report = CTableReport(1, false, false);

        Report.addColumn("", 20);
        Report.addColumn("", 17);
        Report.addColumn("", 12);
        Report.addColumn("", 25);
        Report.addColumn("", 15);

        var i;

    [
        Раздел 2. Междепозитарные счета

       2.1. Данные об остатках на междепозитарных счетах "ЛОРО"];

        if (NoData[2])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐
      │     Сокращенное      │   Номер лицензии  │   Признак    │  Номер междепозитарного   │ Общее количество│
      │     наименование     │ профессионального │ депозитария- │  счета "ЛОРО", открытого  │ ценных бумаг на │
      │     депозитария-     │  участника рынка  │корреспондента│       депозитарию-        │ междепозитарном │
      │    корреспондента    │   ценных бумаг -  │              │      корреспонденту       │  счете "ЛОРО"   │
      │                      │   корреспондента  │              │                           │ корреспондента, │
      │                      │                   │              │                           │       штук      │
      ├──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤
      │          16          │        17         │      18      │            19             │        20       │
      ├──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];

            i = 0;
            FormatValues(values_2_1);

            while( i < count_2_1 )
                if (i)
                    Report.PrintSeparator();
                end;
                Report.PrintStringTransferByWord( values_2_1[i*COLUMN_2], values_2_1[i*COLUMN_2+1], values_2_1[i*COLUMN_2+2], values_2_1[i*COLUMN_2+3], values_2_1[i*COLUMN_2+4] );
                i = i + 1;
            end;
            Report.PrintBottom( );
        end;
    [
       2.2. Данные об остатках на междепозитарных счетах и счетах номинального держателя, открытых кредитной
          организации в других организациях];

        if (NoData[3])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐
      │     Сокращенное      │   Номер лицензии  │   Признак    │  Номер счета, открытого у │ Общее количество│
      │     наименование     │ профессионального │ депозитария- │       депозитария-        │ ценных бумаг на │
      │     организации-     │  участника рынка  │корреспондента│      корреспондента       │ междепозитарном │
      │    корреспондента    │   ценных бумаг -  │              │                           │  счете (счете   │
      │                      │   корреспондента  │              │                           │  номинального   │
      │                      │                   │              │                           │ держателя), штук│
      ├──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤
      │         21           │        22         │      23      │             24            │        25       │
      ├──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
            i = 0;
            FormatValues(values_2_2);

            while( i < count_2_2 )
                if (i)
                    Report.PrintSeparator();
                end;
                Report.PrintStringTransferByWord( values_2_2[i*COLUMN_2], values_2_2[i*COLUMN_2+1], values_2_2[i*COLUMN_2+2], values_2_2[i*COLUMN_2+3], values_2_2[i*COLUMN_2+4] );
                i = i + 1;
            end;
            Report.PrintBottom( );
        end;

    END;

    MACRO PrintDepart_3()

        macro FormatValues( values );
            var i = 0;
            while( i < values.size )
                if( (values[i] == NULL) or (values[i] == "") or (values[i] == "Undefined"))
                    values[i] = " ";
                end;
                i = i + 1;
            end;
        end;

        var i;
    [
        Раздел 3. Список ценных бумаг, учитываемых в депозитарии на счетах депо

      3.1. Ценные бумаги, учитываемые на счетах депо клиентов депозитария];

        if (NoData[4])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬──────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
      │   Название эмитента  │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │ Номинальная  │   Количество ценных бумаг, штук                                                                                                                                                   │
      │                      │   эмитента   │  ценной  │   номер ценной    │ валюты │  стоимость   ├────────────────────────────────────────────┬────────────────────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┤
      │                      │              │  бумаги  │      бумаги       │ ценной │ценной бумаги,│на счетах владельцев                        │на счетах "ЛОРО"                            │на счетах залогодержателей   │  на счетах   │      на      │  на счетах   │  на счетах,  │
      │                      │              │          │                   │ бумаги │  ед.валюты   ├─────────────────────────────┬──────────────┼─────────────────────────────┬──────────────┼──────────────┬──────────────┤доверительных │  эмиссионных │  эмитентов   │  владельцы   │
      │                      │              │          │                   │        │обязательства │ резидентов                  │ нерезидентов │ резидентов                  │ нерезидентов │ резидентов   │ нерезидентов │ управляющих  │    счетах    │              │   которых    │
      │                      │              │          │                   │        │              ├──────────────┬──────────────┤              ├──────────────┬──────────────┤              │              │              │              │              │              │не установлены│
      │                      │              │          │                   │        │              │ всего        │   из них:    │              │ всего        │   из них:    │              │              │              │              │              │              │              │
      │                      │              │          │                   │        │              │              │  кредитные   │              │              │  кредитные   │              │              │              │              │              │              │              │
      │                      │              │          │                   │        │              │              │ организации  │              │              │ организации  │              │              │              │              │              │              │              │
      ├──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │           26         │      27      │    28    │         29        │   30   │      31      │      32      │      33      │      34      │      35      │      36      │      37      │      38      │      39      │      40      │      41      │      42      │      43      │
      ├──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];

            Report = CTableReport(1, false, false);

            Report.addColumn("", 20);
            Report.addColumn("", 12);
            Report.addColumn("",  8);
            Report.addColumn("", 17);
            Report.addColumn("",  6);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);

            i = 0;
            FormatValues( values_3_1 );

            while( i < count_3_1 )
                if (i)
                    Report.PrintSeparator();
                end;
                Report.PrintStringTransferByWord( values_3_1[i*COLUMN_3_1], values_3_1[i*COLUMN_3_1+1], values_3_1[i*COLUMN_3_1+2], values_3_1[i*COLUMN_3_1+3], values_3_1[i*COLUMN_3_1+4],
                                                  values_3_1[i*COLUMN_3_1+5], values_3_1[i*COLUMN_3_1+6], values_3_1[i*COLUMN_3_1+7], values_3_1[i*COLUMN_3_1+8], values_3_1[i*COLUMN_3_1+9],
                                                  values_3_1[i*COLUMN_3_1+10], values_3_1[i*COLUMN_3_1+11], values_3_1[i*COLUMN_3_1+12], values_3_1[i*COLUMN_3_1+13], values_3_1[i*COLUMN_3_1+14],
                                                  values_3_1[i*COLUMN_3_1+15], values_3_1[i*COLUMN_3_1+16], values_3_1[i*18+17] );
                i = i + 1;
            end;
            Report.PrintBottom();
        end;
    [
      3.2. Ценные бумаги, учитываемые на счетах депо кредитной организации];

        if (NoData[5])
            println();
            println( " Данные отсутствуют" );
            println();
        else
    [ ┌──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬──────────────┬─────────────────────────────────────────────────────────────────────────────────────────┐
      │   Название эмитента  │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │ Номинальная  │   Количество ценных бумаг, штук                                                         │
      │                      │   эмитента   │  ценной  │   номер ценной    │ валюты │  стоимость   ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤
      │                      │              │  бумаги  │      бумаги       │ ценной │ценной бумаги,│на счетах,    │на счетах     │  на счетах   │      на      │  на счетах   │    на иных   │
      │                      │              │          │                   │ бумаги │  ед.валюты   │предназначен- │залогодержа-  │доверительного│  эмиссионных │  эмитента    │    счетах    │
      │                      │              │          │                   │        │обязательства │ных для учета │теля          │ управляющего │    счетах    │              │              │
      │                      │              │          │                   │        │              │ценных бумаг, │              │              │              │              │              │
      │                      │              │          │                   │        │              │принадлежащих │              │              │              │              │              │
      │                      │              │          │                   │        │              │кредитной     │              │              │              │              │              │
      │                      │              │          │                   │        │              │организации   │              │              │              │              │              │
      │                      │              │          │                   │        │              │на праве      │              │              │              │              │              │
      │                      │              │          │                   │        │              │собственности │              │              │              │              │              │
      ├──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤
      │          44          │      45      │    46    │         47        │   48   │      49      │      50      │      51      │      52      │      53      │      54      │      55      │
      ├──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];

            Report = CTableReport(1, false, false);

            Report.addColumn("", 20);
            Report.addColumn("", 12);
            Report.addColumn("",  8);
            Report.addColumn("", 17);
            Report.addColumn("",  6);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);
            Report.addColumn("", 12);

            i = 0;
            FormatValues( values_3_2 );

            while( i < count_3_2 )
                if (i)
                    Report.PrintSeparator();
                end;
                Report.PrintStringTransferByWord( values_3_2[i*COLUMN_3_2], values_3_2[i*COLUMN_3_2+1], values_3_2[i*COLUMN_3_2+2], values_3_2[i*COLUMN_3_2+3], values_3_2[i*COLUMN_3_2+4],
                                                  values_3_2[i*COLUMN_3_2+5], values_3_2[i*COLUMN_3_2+6], values_3_2[i*COLUMN_3_2+7], values_3_2[i*COLUMN_3_2+8], values_3_2[i*COLUMN_3_2+9],
                                                  values_3_2[i*COLUMN_3_2+10], values_3_2[i*COLUMN_3_2+11] );
                i = i + 1;
            end;
            Report.PrintBottom()
        end;
    END;

    macro printPart4()
        macro printRow(compositeValue : Object)
            [ │################################################│###########│     ##########      │]
            (compositeValue.fieldValue("regionName").currentAsString:l,
             compositeValue.fieldValue("okatoCode").currentAsString:c,
             compositeValue.fieldValue("nDepartment").currentAsString:c);
        end;

        macro printNullRow()
            [ │                                                │           │                     │];
        end;

        [                                                                                     ];
        [  Раздел 4. Филиалы, осуществляющие депозитарные операции с клиентами                ];
        [ ┌────────────────────────────────────────────────┬───────────┬─────────────────────┐];
        [ │ Наименование регионов, в которых есть филиалы, │Код региона│Количество филиалов, │];
        [ │осуществляющие депозитарные операции с клиентами│ по ОКАТО  │   осуществляющих    │];
        [ │                                                │           │депозитарные операции│];
        [ │                                                │           │с клиентами в регионе│];
        [ ├────────────────────────────────────────────────┼───────────┼─────────────────────┤];
        [ │                     56                         │    57     │         58          │];
        [ ├────────────────────────────────────────────────┼───────────┼─────────────────────┤];

        var iterator = RcbApplication.currentReport.attributeValue("Ф711_4").createValueIterator();

        iterator.moveFirst();

        if (iterator.isDone())
            printNullRow();
        end;

        while (not iterator.isDone())
            printRow(iterator.currentItem);
            iterator.moveNext();
        end;

       [ └────────────────────────────────────────────────┴───────────┴─────────────────────┘];
    end;

    MACRO PrintFooter( )
    [ ];
    [   Руководитель кредитной организации ____________ ###################################  ]( {FIO_Boss}:l );
    [   Руководитель депозитария           ____________ ###################################  ]( {FIO_Boss}:l );
    [   Исполнитель                        ____________ ###################################  ]( Исполнитель:l );
    [   Телефон:    ###################################                                      ]( Номер_телефона:l );
    [   #]( trim( string( {curdate}:m ) ) );
    END;

end;

/**
 *  Контроллер печати формы в соответствии с 1376-У
 *  @author ABP
 *  @since 6.00.020.29
 */
class TPrintController_I1376()
    macro print()
        var output = getNameLog("711", "txt");
        var oldOutput = setOutput(output, false);

        var view = TReportView_I1376();

        view.PrintHeader();
        view.LoadAllVars();
        if (view.EmptyReport)
            println( "Данные отсутствуют" );
        else
            view.PrintDepart_1();
            view.PrintDepart_2();
            view.PrintDepart_3();
            view.printPart4();
        end;
        view.PrintFooter();

        setOutput(null, true);
        viewFileLog(output);
    end;

    private macro constructorTPrintController_I1376()
    end;

    constructorTPrintController_I1376();
end;

/* ====================== Печать протокола =========================== */
/**
 *  Контроллер печати протокола
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TProtocolPrintController()
    macro print()
        ViewFileLog(ИмяФайлаПротокола);
    end;

    private macro constructorTProtocolPrintController()
    end;

    constructorTProtocolPrintController();
end;

/* ====================== Печать отчетной формы =========================== */
/**
 *  Параметризованный фильтр простых переменных формы
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TSimpleAttributeFilter(mask : String)
    private var m_mask = mask;

    macro isSuitable(val)
        return not compareStrWithMasks(m_mask, val.attribute.name);
    end;
end;

/**
 *  Значение атрибута
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TValue(_name, _current)
    var name = _name;
    var current = _current;
end;

/**
 *  Источник данных подраздела 1.1
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TDataSourceSubpart1(mask)
    private var m_mask;
    private var m_isDone;
    private var m_container;

    private macro create()
        var iterator = RcbApplication().currentReport.createAttributeValueIterator();

        iterator.setFilter(TSimpleAttributeFilter(m_mask));
        iterator.first();
        while (not iterator.isDone())
            m_container[m_container.size] = TValue(iterator.currentItem.attribute.name, iterator.currentItem.current);
            iterator.next();
        end;
    end;

    macro fieldValue(name : String)
        var value = null;
        var i;

        i = 0;
        while (i < m_container.size)
            if (m_container[i].name == name)
                value = m_container[i];
                break;
            end;
            i = i + 1;
        end;

        return value;
    end;

    macro currentItem();
        return this;
    end;

    macro first()
        m_isDone = false;
    end;

    macro next()
        m_isDone = true;
    end;

    macro isDone()
        return m_isDone;
    end;

    macro isEmpty()
        var i;
        var isEmpty = true;

        i = 0;
        while (i < m_container.size)
            if (m_container[i].current != 0)
                isEmpty = false;
            end;
            i = i + 1;
        end;

        return isEmpty;
    end;

    macro setFilter()
        throw(TPureVirtualMethodCallException("TDataSourceSubpart1::setFilter"));
    end;

    macro setSortOrder()
        throw(TPureVirtualMethodCallException("TDataSourceSubpart1::setSortOrder"));
    end;

    private macro constructorTDataSourceSubpart1(mask)
        m_mask = mask;
        m_isDone = null;
        m_container = TArray();

        create();

    end;

    constructorTDataSourceSubpart1(mask);
end;

/**
 *  Источник данных подразделов 1.2 - 1.4, 2.1 - 2.3
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TDataSourceSubpart2_4(iterator)
    private var m_iterator;

    macro fieldValue(name : String)
        return m_iterator.currentItem.fieldValue(name);
    end;

    macro currentItem();
        return m_iterator.currentItem;
    end;

    macro first()
        m_iterator.first();
    end;

    macro next()
        m_iterator.next();
    end;

    macro isDone()
        return m_iterator.isDone();
    end;

    macro isEmpty()
        return ternary(m_iterator.count > 0, false, true);
    end;

    macro setFilter(filter)
        m_iterator.setFilter(filter);
    end;

    macro setSortOrder(sorter : Object)
        m_iterator.setSortOrder(sorter);
    end;

    private macro constructorTDataSourceSubpart2_4(iterator)
        m_iterator = iterator;
    end;

    constructorTDataSourceSubpart2_4(iterator);
end;

/**
 *  Базовое печатное представление формы 711
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPrintableView) TReportView(name, okudCode, periodicity, periodFormat, parts)
    private var m_part : TArray;

    macro getPart(partNumber) : Object
        return m_part[partNumber - 1];
    end;

    macro getFileName() : String
        return m_printFileName;
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;

    end;

    private macro constructorTReportView(name, okudCode, periodicity, periodFormat, parts)
        initTPrintableView(name, okudCode, periodicity, periodFormat);

        m_part = parts;
    end;

    constructorTReportView(name, okudCode, periodicity, periodFormat, parts);
end;

/**
 *  Печатное представление таблицы подраздела 1.1.1
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart111TableView_I2055()
    macro printHeader()
        [┌─────┬─────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐];
        [│Номер│Счета для учета ценных бумаг,│  Междепозитарные счета депо │              │              │              │              │              │];
        [│ п/п │   принадлежащих клиентам    │  "ЛОРО", открытые сторонним │    Счета     │    Счета     │ Эмиссионные  │    Счета     │    Счета,    │];
        [│     │    депозитария на правах    │        депозитариям         │   залого-    │ доверительных│    счета     │  эмитентов   │  владельцы   │];
        [│     │       собственности         │                             │  держателей  │ управляющих  │              │              │  которых не  │];
        [│     ├──────────────┬──────────────┼──────────────┬──────────────┤              │              │              │              │  установлены │];
        [│     │  резидентам  │ нерезидентам │  резидентам  │ нерезидентам │              │              │              │              │              │];
        [├─────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│  1  │      2       │      3       │      4       │      5       │      6       │      7       │      8       │      9       │      10      │];
        [├─────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
    end;

    private macro convertZero(value)
        return value;
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(1,
                         current.fieldValue("Ф711_Гр1").current,
                         current.fieldValue("Ф711_Гр2").current,
                         current.fieldValue("Ф711_Гр3").current,
                         current.fieldValue("Ф711_Гр4").current,
                         current.fieldValue("Ф711_Гр5").current,
                         current.fieldValue("Ф711_Гр6").current,
                         current.fieldValue("Ф711_Гр7").current,
                         current.fieldValue("Ф711_Гр8").current,
                         current.fieldValue("Ф711_Гр9").current
                        );
    end;

    private macro constructorTSubpart111TableView_I2055()
        initTPartView();

        m_table.addColumn("1",  3,  AL_CENTER);
        m_table.addColumn("2",  12, AL_RIGHT);
        m_table.addColumn("3",  12, AL_RIGHT);
        m_table.addColumn("4",  12, AL_RIGHT);
        m_table.addColumn("5",  12, AL_RIGHT);
        m_table.addColumn("6",  12, AL_RIGHT);
        m_table.addColumn("7",  12, AL_RIGHT);
        m_table.addColumn("8",  12, AL_RIGHT);
        m_table.addColumn("9",  12, AL_RIGHT);
        m_table.addColumn("10", 12, AL_RIGHT);
    end;

    constructorTSubpart111TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.1.2
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart112TableView_I2055()
    macro printHeader()
        [┌─────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐];
        [│Номер│Счета для учета ценных бумаг,│    Счета     │    Счета     │              │              │              │];
        [│ п/п │   принадлежащих кредитной   │   залого-    │   довери-    │ Эмиссионные  │    Счета     │    Иные      │];
        [│     │    организации на правах    │  держателя   │   тельного   │    счета     │   эмитента   │    счета     │];
        [│     │       собственности         │              │ управляющего │              │              │              │];
        [├─────┼─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│ 11  │              12             │      13      │      14      │      15      │      16      │      17      │];
        [├─────┼─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
    end;

    private macro convertZero(value)
        return value;
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(1,
                         current.fieldValue("Ф711_Гр10").current,
                         current.fieldValue("Ф711_Гр11").current,
                         current.fieldValue("Ф711_Гр12").current,
                         current.fieldValue("Ф711_Гр13").current,
                         current.fieldValue("Ф711_Гр14").current,
                         current.fieldValue("Ф711_Гр15").current
                        );

    end;

    private macro constructorTSubpart112TableView_I2055()
        initTPartView();

        m_table.addColumn("11", 3,  AL_CENTER);
        m_table.addColumn("12", 27, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
    end;

    constructorTSubpart112TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.2.1
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart121TableView_I2055()
    macro printHeader()
        [┌─────┬──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐];
        [│Номер│     Сокращенное      │   Номер лицензии  │   Признак    │  Номер междепозитарного   │ Общее количество│];
        [│ п/п │     наименование     │ профессионального │ депозитария- │  счета "ЛОРО", открытого  │ ценных бумаг на │];
        [│     │     депозитария-     │  участника рынка  │корреспондента│       депозитарию-        │ междепозитарном │];
        [│     │    корреспондента    │   ценных бумаг -  │              │      корреспонденту       │  счете "ЛОРО"   │];
        [│     │                      │   корреспондента  │              │                           │ корреспондента, │];
        [│     │                      │                   │              │                           │       штук      │];
        [├─────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
        [│ 18  │          19          │        20         │      21      │            22             │        23       │];
        [├─────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];

    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition21ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(current.fieldValue("Номер п/п").current,
                         current.fieldValue("Наименование депозитария").current,
                         current.fieldValue("Лицензия участника ОРЦБ").current,
                         current.fieldValue("Признак депозитария").current,
                         current.fieldValue("Междепозитарный счет").current,
                         current.fieldValue("Количество ц/б на счете").current
                        );
    end;

    private macro constructorTSubpart121TableView_I2055()
        initTPartView();

        m_table.addColumn("18", 3,  AL_CENTER);
        m_table.addColumn("19", 20, AL_LEFT);
        m_table.addColumn("20", 17, AL_LEFT);
        m_table.addColumn("21", 12, AL_CENTER);
        m_table.addColumn("22", 25, AL_LEFT);
        m_table.addColumn("23", 15, AL_RIGHT);
    end;

    constructorTSubpart121TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.2.2
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart122TableView_I2055()
    macro printHeader();
        [┌─────┬──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐];
        [│Номер│     Сокращенное      │   Номер лицензии  │   Признак    │  Номер счета, открытого у │ Общее количество│];
        [│ п/п │     наименование     │ профессионального │ депозитария- │       депозитария-        │ ценных бумаг на │];
        [│     │     организации-     │  участника рынка  │корреспондента│      корреспондента       │ междепозитарном │];
        [│     │    корреспондента    │   ценных бумаг -  │              │                           │  счете (счете   │];
        [│     │                      │   корреспондента  │              │                           │  номинального   │];
        [│     │                      │                   │              │                           │ держателя), штук│];
        [├─────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
        [│ 24  │         25           │        26         │      27      │             28            │        29       │];
        [├─────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition22ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(current.fieldValue("Номер п/п").current,
                         current.fieldValue("Наименование депозитария").current,
                         current.fieldValue("Лицензия участника ОРЦБ").current,
                         current.fieldValue("Признак депозитария").current,
                         current.fieldValue("Междепозитарный счет").current,
                         current.fieldValue("Количество ц/б на счете").current
                        );
    end;

    private macro constructorTSubpart122TableView_I2055()
        initTPartView();

        m_table.addColumn("24", 3,  AL_CENTER);
        m_table.addColumn("25", 20, AL_LEFT);
        m_table.addColumn("26", 17, AL_LEFT);
        m_table.addColumn("27", 12, AL_CENTER);
        m_table.addColumn("28", 25, AL_LEFT);
        m_table.addColumn("29", 15, AL_RIGHT);
    end;

    constructorTSubpart122TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.3.1
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart131TableView_I2055()
    macro printHeader();

        [┌─────┬──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬──────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер│     Наименование     │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │ Номинальная  │                                                                          Количество ценных бумаг, штук                                                                            │];
        [│ п/п │       эмитента       │   эмитента   │  ценной  │   номер ценной    │ валюты │  стоимость   ├────────────────────────────────────────────┬────────────────────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┤];
        [│     │                      │              │  бумаги  │      бумаги       │ ценной │ценной бумаги,│           на счетах владельцев             │              на счетах "ЛОРО"              │ на счетах залогодержателей  │  на счетах   │      на      │  на счетах   │  на счетах,  │];
        [│     │                      │              │          │                   │ бумаги │  ед.валюты   ├─────────────────────────────┬──────────────┼─────────────────────────────┬──────────────┼──────────────┬──────────────┤доверительных │  эмиссионных │  эмитентов   │  владельцы   │];
        [│     │                      │              │          │                   │        │обязательства │          резидентов         │ нерезидентов │          резидентов         │ нерезидентов │ резидентов   │ нерезидентов │ управляющих  │    счетах    │              │   которых    │];
        [│     │                      │              │          │                   │        │              ├──────────────┬──────────────┤              ├──────────────┬──────────────┤              │              │              │              │              │              │не установлены│];
        [│     │                      │              │          │                   │        │              │     всего    │   из них:    │              │     всего    │   из них:    │              │              │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │              │  кредитные   │              │              │  кредитные   │              │              │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │              │ организации  │              │              │ организации  │              │              │              │              │              │              │              │];
        [├─────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│ 30  │           31         │      32      │    33    │         34        │   35   │      36      │      37      │      38      │      39      │      40      │      41      │      42      │      43      │      44      │      45      │      46      │      47      │      48      │];
        [├─────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition31ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValueCode;
        var faceValue = current.fieldValue("Номинал ц/б").current;
        var point = current.fieldValue("Точность номинала ц/б").current;
        var faceValueCommand = "string(faceValue:0:" + point + ")";

        faceValue = truncZero(faceValue);
        faceValue = convertZero(faceValue);

        if (valType(faceValue) != V_STRING)
            faceValue = execExp(faceValueCommand);
        end;

        faceValueCode = convertZero(current.fieldValue("Валюта ц/б").current);

        return arrCreate(current.fieldValue("Номер п/п").current,
                         current.fieldValue("Эмитент").current,
                         current.fieldValue("ИНН эмитента").current,
                         current.fieldValue("Код типа ц/б").current,
                         current.fieldValue("Идентификатор ц/б").current,
                         faceValueCode,
                         faceValue,
                         current.fieldValue("Графа 32").current,
                         current.fieldValue("Графа 33").current,
                         current.fieldValue("Графа 34").current,
                         current.fieldValue("Графа 35").current,
                         current.fieldValue("Графа 36").current,
                         current.fieldValue("Графа 37").current,
                         current.fieldValue("Графа 38").current,
                         current.fieldValue("Графа 39").current,
                         current.fieldValue("Графа 40").current,
                         current.fieldValue("Графа 41").current,
                         current.fieldValue("Графа 42").current,
                         current.fieldValue("Графа 43").current
                        );
    end;

    private macro constructorTSubpart131TableView_I2055()
        initTPartView();

        m_table.addColumn("30", 3,  AL_CENTER);
        m_table.addColumn("31", 20, AL_LEFT);
        m_table.addColumn("32", 12, AL_CENTER);
        m_table.addColumn("33", 8,  AL_CENTER);
        m_table.addColumn("34", 17, AL_CENTER);
        m_table.addColumn("35", 6,  AL_CENTER);
        m_table.addColumn("36", 12, AL_RIGHT);
        m_table.addColumn("37", 12, AL_RIGHT);
        m_table.addColumn("38", 12, AL_RIGHT);
        m_table.addColumn("39", 12, AL_RIGHT);
        m_table.addColumn("40", 12, AL_RIGHT);
        m_table.addColumn("41", 12, AL_RIGHT);
        m_table.addColumn("42", 12, AL_RIGHT);
        m_table.addColumn("43", 12, AL_RIGHT);
        m_table.addColumn("44", 12, AL_RIGHT);
        m_table.addColumn("45", 12, AL_RIGHT);
        m_table.addColumn("46", 12, AL_RIGHT);
        m_table.addColumn("47", 12, AL_RIGHT);
        m_table.addColumn("48", 12, AL_RIGHT);
    end;

    constructorTSubpart131TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.3.2
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart132TableView_I2055()
    macro printHeader();

        [┌─────┬──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬──────────────┬─────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер│   Название эмитента  │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │ Номинальная  │   Количество ценных бумаг, штук                                                         │];
        [│ п/п │                      │   эмитента   │  ценной  │   номер ценной    │ валюты │  стоимость   ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤];
        [│     │                      │              │  бумаги  │      бумаги       │ ценной │ценной бумаги,│на счетах,    │на счетах     │  на счетах   │      на      │  на счетах   │    на иных   │];
        [│     │                      │              │          │                   │ бумаги │  ед.валюты   │предназначен- │залогодержа-  │доверительного│  эмиссионных │  эмитента    │    счетах    │];
        [│     │                      │              │          │                   │        │обязательства │ных для учета │теля          │ управляющего │    счетах    │              │              │];
        [│     │                      │              │          │                   │        │              │ценных бумаг, │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │принадлежащих │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │кредитной     │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │организации   │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │на праве      │              │              │              │              │              │];
        [│     │                      │              │          │                   │        │              │собственности │              │              │              │              │              │];
        [├─────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│ 49  │          50          │      51      │    52    │         53        │   54   │      55      │      56      │      57      │      58      │      59      │      60      │      61      │];
        [├─────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];

    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition32ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValueCode;
        var faceValue = current.fieldValue("Номинал ц/б").current;
        var point = current.fieldValue("Точность номинала ц/б").current;
        var faceValueCommand = "string(faceValue:0:" + point + ")";

        faceValue = truncZero(faceValue);
        faceValue = convertZero(faceValue);

        if (valType(faceValue) != V_STRING)
            faceValue = execExp(faceValueCommand);
        end;

        faceValueCode = convertZero(current.fieldValue("Валюта ц/б").current);

        return arrCreate(current.fieldValue("Номер п/п").current,
                         current.fieldValue("Эмитент").current,
                         current.fieldValue("ИНН эмитента").current,
                         current.fieldValue("Код типа ц/б").current,
                         current.fieldValue("Идентификатор ц/б").current,
                         faceValueCode,
                         faceValue,
                         current.fieldValue("Графа 50").current,
                         current.fieldValue("Графа 51").current,
                         current.fieldValue("Графа 52").current,
                         current.fieldValue("Графа 53").current,
                         current.fieldValue("Графа 54").current,
                         current.fieldValue("Графа 55").current
                        );
    end;

    private macro constructorTSubpart132TableView_I2055()
        initTPartView();

        m_table.addColumn("49", 3,  AL_CENTER);
        m_table.addColumn("50", 20, AL_LEFT);
        m_table.addColumn("51", 12, AL_CENTER);
        m_table.addColumn("52", 8,  AL_CENTER);
        m_table.addColumn("53", 17, AL_CENTER);
        m_table.addColumn("54", 6,  AL_CENTER);
        m_table.addColumn("55", 12, AL_RIGHT);
        m_table.addColumn("56", 12, AL_RIGHT);
        m_table.addColumn("57", 12, AL_RIGHT);
        m_table.addColumn("58", 12, AL_RIGHT);
        m_table.addColumn("59", 12, AL_RIGHT);
        m_table.addColumn("60", 12, AL_RIGHT);
        m_table.addColumn("61", 12, AL_RIGHT);
    end;

    constructorTSubpart132TableView_I2055();
end;

/**
 *  Печатное представление таблицы подраздела 1.3.2
 *  @author SER
 *  @since 6.00.020.30
 */
class (TPartView) TSubpart132TableView_I2627()
    macro printHeader();
        print("┌──────┬──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐");
        print("│Номер │     Наименование     │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│   Количество ценных бумаг, штук                                                                                                                         │");
        print("│строки│       эмитента       │   эмитента   │  ценной  │   номер ценной    │ валюты │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────────┬──────────────┤");
        print("│      │                      │              │  бумаги  │      бумаги       │ ценной │");printFillLeft(" ");print("ценной бумаги,");printFillRight(" ");println("│на счетах,    │на счетах     │  на счетах   │      на      │  на счетах   │    на иных   │ Наименование │      ИНН     │  Номер лицензии  │    Признак   │");
        print("│      │                      │              │          │                   │ бумаги │");printFillLeft(" ");print("  ед.валюты   ");printFillRight(" ");println("│предназначен- │залогодержа-  │доверительного│  эмиссионных │  эмитента    │    счетах    │ организации, │ организации, │ профессионального│ организации, │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("обязательства ");printFillRight(" ");println("│ных для учета │теля          │ управляющего │    счетах    │              │              │ ведущей учет │ ведущей учет │ участника рынка  │ ведущей учет │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│ценных бумаг, │              │              │              │              │              │     прав     │     прав     │  ценных бумаг    │     прав     │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│принадлежащих │              │              │              │              │              │  кредитной   │  кредитной   │   депозитария    │  кредитной   │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│кредитной     │              │              │              │              │              │ организации  │ организации  │       /          │ организации  │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│организации   │              │              │              │              │              │  на ценные   │  на ценные   │ реестродержателя │  на ценные   │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│на праве      │              │              │              │              │              │    бумаги    │    бумаги    │                  │    бумаги    │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│собственности │              │              │              │              │              │              │              │                  │              │");
        print("├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────┤");
        print("│  49  │          50          │      51      │    52    │         53        │   54   │");printFillLeft(" ");print("      55      ");printFillRight(" ");println("│      56      │      57      │      58      │      59      │      60      │      61      │      62      │      63      │        64        │      65      │");
        print("├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼──────────────┤");
    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition32ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
        var faceValueCode;
        var faceValue = current.fieldValue("Номинал ц/б").current;
        var point = current.fieldValue("Точность номинала ц/б").current;
        var faceValueCommand = "string(faceValue:0:" + point + ")";

        faceValue = truncZero(faceValue);
        faceValue = convertZero(faceValue);

        if (valType(faceValue) != V_STRING)
            faceValue = execExp(faceValueCommand);
        end;

        faceValueCode = convertZero(current.fieldValue("Валюта ц/б").current);

        return arrCreate(current.fieldValue("Номер п/п").current,
                         current.fieldValue("Эмитент").current,
                         current.fieldValue("ИНН эмитента").current,
                         current.fieldValue("Код типа ц/б").current,
                         current.fieldValue("Идентификатор ц/б").current,
                         faceValueCode,
                         faceValue,
                         current.fieldValue("Графа 50").current,
                         current.fieldValue("Графа 51").current,
                         current.fieldValue("Графа 52").current,
                         current.fieldValue("Графа 53").current,
                         current.fieldValue("Графа 54").current,
                         current.fieldValue("Графа 55").current,
                         current.fieldValue("Графа 62").current,
                         current.fieldValue("Графа 63").current,
                         current.fieldValue("Графа 64").current,
                         current.fieldValue("Графа 65").current
                        );
    end;

    private macro constructorTSubpart132TableView_I2627()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_3_2");

        m_table.addColumn("49", 4,  AL_CENTER);
        m_table.addColumn("50", 20, AL_LEFT);
        m_table.addColumn("51", 12, AL_CENTER);
        m_table.addColumn("52", 8,  AL_CENTER);
        m_table.addColumn("53", 17, AL_CENTER);
        m_table.addColumn("54", 6,  AL_CENTER);
        m_table.addColumn("55", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("56", 12, AL_RIGHT);
        m_table.addColumn("57", 12, AL_RIGHT);
        m_table.addColumn("58", 12, AL_RIGHT);
        m_table.addColumn("59", 12, AL_RIGHT);
        m_table.addColumn("60", 12, AL_RIGHT);
        m_table.addColumn("61", 12, AL_RIGHT);
        m_table.addColumn("62", 12, AL_RIGHT);
        m_table.addColumn("63", 12, AL_RIGHT);
        m_table.addColumn("64", 16, AL_RIGHT);
        m_table.addColumn("65", 12, AL_RIGHT);
    end;

    constructorTSubpart132TableView_I2627();
end;

/**
 *  Печатное представление таблицы подраздела 1.4
 *  @author ABP
 *  @since 6.00.020.29
 */
class (TPartView) TSubpart141TableView_I2055()
    macro printHeader()
        [┌─────┬────────────────────────────────────────────────┬───────────┬─────────────────────┐];
        [│Номер│ Наименование регионов, в которых есть филиалы, │Код региона│Количество филиалов, │];
        [│ п/п │осуществляющие депозитарные операции с клиентами│ по ОКАТО  │   осуществляющих    │];
        [│     │                                                │           │депозитарные операции│];
        [│     │                                                │           │с клиентами в регионе│];
        [├─────┼────────────────────────────────────────────────┼───────────┼─────────────────────┤];
        [│ 62  │                     63                         │    64     │         65          │];
        [├─────┼────────────────────────────────────────────────┼───────────┼─────────────────────┤];
    end;

    private macro configureDataSource(dataSource : Object) : Object
        dataSource.setSortOrder(TSubpartition4ValuesSorter());
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("regionName").current,
                         current.fieldValue("okatoCode").current,
                         current.fieldValue("nDepartment").current
                        );
    end;

    private macro constructorTSubpart141TableView_I2055()
        initTPartView();

        m_table.addColumn("24",  3, AL_CENTER);
        m_table.addColumn("25", 46, AL_LEFT);
        m_table.addColumn("26",  9, AL_CENTER);
        m_table.addColumn("27", 19, AL_CENTER);
    end;

    constructorTSubpart141TableView_I2055();
end;

/**
 *  Печатное представление подраздела 1.1
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPartView) TSubpart11View_I2055()
    private var m_part : TArray;

    macro printHeader()
        println("Подраздел 1.1. Счета депо");
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTSubpart11View_I2055()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "1.1.1. Счета депо клиентов, штук"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart111TableView())
                                         );

        var subpart2 = TSubpartView_I2055(  "\n"
                                          + "1.1.2. Счета депо кредитной организации, штук"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart112TableView())
                                         );

        m_part = arrCreate(subpart1, subpart2);

    end;

    constructorTSubpart11View_I2055();
end;

private class (TPartView) TSubpart1View_I3129()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart1View_I3129()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\""
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart11TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart1View_I3129();
end;

private class (TPartView) TSubpart1View_I4212()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart1View_I4212()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.1. Ценные бумаги, учитываемые на счетах депо номинального держателя, счетах депо иностранного номинального держателя"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart11TableView())
                                         );
        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart1View_I4212();
end;

private class (TPartView) TSubpart1View_I5986()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart1View_I5986()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.1. Ценные бумаги, учитываемые на счетах депо номинального держателя"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart11TableView())
                                         );
        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart1View_I5986();
end;

private class (TPartView) TSubpart2View_I3129()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart2View_I3129()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.2. Ценные бумаги, учитываемые на счетах депо и иных счетах клиентов депозитария"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart12TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart2View_I3129();
end;

private class (TPartView) TSubpart21View_I5456()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
    end;

    private macro constructorTSubpart21View_I5456()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.2. Ценные бумаги, учитываемые на счетах депо и иных счетах клиентов депозитария"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart12TableView())
                                         );

        var subpart2 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.2.1. Объем проведенных депозитарных операций с учитываемыми ценными бумагами"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart121TableView())
                                         );

        m_part = arrCreate(subpart1, subpart2);
    end;

    constructorTSubpart21View_I5456();
end;

private class (TPartView) TSubpart3View_I3129()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart3View_I3129()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.3. Ценные бумаги, учитываемые на счетах депо и иных счетах кредитной организации"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart13TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart3View_I3129();
end;

private class (TSubpart3View_I3129) TSubpart3View_I4637()
    private macro constructorTSubpart3View_I4637()
        initTSubpart3View_I3129();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.3. Ценные бумаги, принадлежащие кредитной организации на праве собственности или ином вещном праве"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart13TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart3View_I4637();
end;

private class (TSubpart3View_I3129) TSubpart3View_I5456()
    private macro constructorTSubpart3View_I5456()
        initTSubpart3View_I3129();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.3. Ценные бумаги, принадлежащие кредитной организации на праве собственности или иных правах"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart13TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart3View_I5456();
end;

private class (TPartView) TSubpart4View_I3129()
    private var m_part : TArray;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    macro printHeader()
        // println("1.1. Ценные бумаги, учитываемые на междепозитарных счетах \"ЛОРО\"");
    end;

    private macro constructorTSubpart3View_I3129()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.4. Балансовая стоимость вложений в эмиссионные ценные бумаги и инвестиционные паи паевых инвестиционных фондов, принадлежащие кредитной ор-"
                                          + "\n"
                                          + "ганизации на праве собственности (за исключением переданных кредитной организацией на возвратной основе без прекращения признания, в доверительное"
                                          + "\n"
                                          + "управление)."
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart14TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart3View_I3129();

end;

private class (TSubpart4View_I3129) TSubpart4View_I4637()
    private macro constructorTSubpart4View_I4637()
        initTSubpart4View_I3129();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "Подраздел 1.4. Сведения об оценке стоимости вложений в эмиссионные ценные бумаги и инвестиционные паи паевых инвестиционных фондов (включая переданные"
                                          + "\n"
                                          + "кредитной организацией на возвратнной основе без прекращения признания, в доверительное управление)."
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart14TableView())
                                         );

        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart4View_I4637();
end;

/**
 *  Печатное представление подраздела 1.2
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPartView) TSubpart12View_I2055()
    private var m_part : TArray;

    macro printHeader()
        println();
        println("Подраздел 1.2. Междепозитарные счета");
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTSubpart12View_I2055()

        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "1.2.1. Данные об остатках на междепозитарных счетах \"ЛОРО\""
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart121TableView())
                                         );

        var subpart2 = TSubpartView_I2055(  "\n"
                                          + "1.2.2. Данные об остатках на междепозитарных счетах и счетах номинального держателя,"
                                          + "открытых кредитной организации в других организациях"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart122TableView())
                                         );

        m_part = arrCreate(subpart1, subpart2);
    end;

    constructorTSubpart12View_I2055();
end;

/**
 *  Печатное представление подраздела 1.3
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPartView) TSubpart13View_I2055()
    private var m_part : TArray;

    macro printHeader()
        println();
        println("Подраздел 1.3. Список ценных бумаг, учитываемых в депозитарии на счетах депо");
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTSubpart13View_I2055()
        initTPartView();

        var subpart1 = TSubpartView_I2055(  "\n"
                                          + "1.3.1. Ценные бумаги, учитываемые на счетах депо клиентов депозитария"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart131TableView())
                                         );

        var subpart2 = TSubpartView_I2055(  "\n"
                                          + "1.3.2. Ценные бумаги, учитываемые на счетах депо кредитной организации"
                                          + "\n",
                                            "",
                                            arrCreate(objectFactoryInstance.createSubpart132TableView())
                                         );

        m_part = arrCreate(subpart1, subpart2);
    end;

    constructorTSubpart13View_I2055();
end;

/**
 *  Печатное представление подраздела 1.4
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPartView) TSubpart14View_I2055()
    private var m_part : TArray;

    macro printHeader()
        println();
        println("Подраздел 1.4. Филиалы, осуществляющие депозитарные операции с клиентами");
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTSubpart14View_I2055()
        initTPartView();

        var subpart1 = TSubpartView_I2055("",
                                          "",
                                          arrCreate(objectFactoryInstance.createSubpart141TableView())
                                         );
        m_part = arrCreate(subpart1);
    end;

    constructorTSubpart14View_I2055();
end;

/**
 *  Печатное представление раздела 1
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TPartView) TPart1View_I2055()
    private var m_part : TArray;

    macro printHeader()
        println("Раздел 1. Депозитарные операции");
        println();
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTPart1View_I2055()
        initTPartView();

        m_part = arrCreate(TSubpart11View_I2055(), TSubpart12View_I2055(), TSubpart13View_I2055(), TSubpart14View_I2055());
    end;

    constructorTPart1View_I2055();
end;

private class (TPartView) TPart1View_I3129()
    private var m_part : TArray;

    macro printHeader()
        println("Раздел 1. Депозитарные операции");
        println();
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTPart1View_I3129()
        initTPartView();

        m_part = arrCreate(TSubpart1View_I3129(), TSubpart2View_I3129(), TSubpart3View_I3129(), TSubpart4View_I3129());
    end;

    constructorTPart1View_I3129();
end;

private class (TPartView) TPart1View_I4212()
    private var m_part : TArray;

    macro printHeader()
        println("Раздел 1. Операции с ценными бумагами");
        println();
    end;

    macro printFooter()
    end;

    macro getPart(partNumber)
        return m_part[partNumber - 1];
    end;

    macro getWidth()
        var i;
        var width = 0;

        i = 0;
        while (i < m_part.size)
            width = max(width, m_part[i].getWidth());
            i = i + 1;
        end;

        return width;
    end;

    private macro constructorTPart1View_I4212()
        initTPartView();

        m_part = arrCreate(TSubpart1View_I4212(), TSubpart2View_I3129(), TSubpart3View_I3129(), TSubpart4View_I3129());
    end;

    constructorTPart1View_I4212();
end;

private class (TPart1View_I4212) TPart1View_I4637()
    private macro constructorTPart1View_I4637()
        initTPart1View_I4212();

        m_part = arrCreate(TSubpart1View_I4212(), TSubpart2View_I3129(), TSubpart3View_I4637(), TSubpart4View_I4637());
    end;

    constructorTPart1View_I4637();
end;

private class (TPart1View_I4637) TPart1View_I5456()
    private macro constructorTPart1View_I5456()
        initTPart1View_I4637();

        m_part = arrCreate(TSubpart1View_I4212(), TSubpart21View_I5456(), /*TSubpart2View_I5456(), */TSubpart3View_I5456(), TSubpart4View_I4637());
    end;

    constructorTPart1View_I5456();
end;

private class (TPart1View_I5456) TPart1View_I5986()
    private macro constructorTPart1View_I5986()
        initTPart1View_I5456();

        m_part = arrCreate(TSubpart1View_I5986(), TSubpart21View_I5456(), /*TSubpart2View_I5456(), */TSubpart3View_I5456(), TSubpart4View_I4637());
    end;

    constructorTPart1View_I5986();
end;

/**
 *  Печатное представление формы в соответствии с 2055-У
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TReportView) TReportView_I2055()
    private macro constructorTReportView_I2055()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        "Ежемесячная",
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I2055(), TPart2View())
                       );
    end;

    constructorTReportView_I2055();
end;

/**
 *  Контроллер печати формы по 2055-У
 *  @author ABP
 *  @since 6.00.020.29
 */
class TPrintController_I5456
    private var m_view;
    private var m_report;
    private var m_dataSourcePool;

    private macro getDataSource(name)
        var i;
        var dataSource = null;

        name = strUpr(name);

        i = 0;
        while (i < m_dataSourcePool.size)
            if (strUpr(m_dataSourcePool[i].name) == name)
                dataSource = m_dataSourcePool[i].object;
                break;
            end;

            i = i + 1;
        end;

        return dataSource;
    end;

    private macro isEmpty()
        var i;
        var isEmpty = true;

        i = 0;
        while (i < m_dataSourcePool.size)
            if (not m_dataSourcePool[i].object.isEmpty())
                isEmpty = false;
                break;
            end;
            i = i + 1;
        end;

        return isEmpty;
    end;
end;

class (TPrintController_I5456) TPrintController_I2055()
    private macro printSubpart(view, dataSource)
        var tableView = view.getPart(1);

        view.printHeader();

        if (not dataSource.isEmpty())
            tableView.printHeader();
            tableView.printData(dataSource);
            tableView.printFooter();
        else
            tableView.printEmptyData();
        end;
        view.printFooter();
    end;

    private macro printSubpart1(parent)
        var view = parent.getPart(1);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.1.1"));
        printSubpart(view.getPart(2), getDataSource("подраздел 1.1.2"));
        view.printFooter();
    end;

    private macro printSubpart2(parent)
        var view = parent.getPart(2);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.2.1"));
        printSubpart(view.getPart(2), getDataSource("подраздел 1.2.2"));
        view.printFooter();
    end;

    private macro printSubpart3(parent)
        var view = parent.getPart(3);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.3.1"));
        printSubpart(view.getPart(2), getDataSource("подраздел 1.3.2"));
        view.printFooter();
    end;

    private macro printSubpart4(parent)
        var view = parent.getPart(4);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.4"));
        view.printFooter();
    end;

    private macro printPart1()
        var view = m_view.getPart(1);

        view.printHeader();
        printSubpart1(view);
        printSubpart2(view);
        printSubpart3(view);
        printSubpart4(view);
        view.printFooter();
    end;

    private macro printPart2()
        var view = m_view.getPart(2);

        view.printHeader();

        view.getPart(1).printHeader();
        printSubpart(view.getPart(1).getPart(1), getDataSource("подраздел 2.1"));
        view.getPart(1).printFooter();

        view.getPart(2).printHeader();
        printSubpart(view.getPart(2).getPart(1), getDataSource("подраздел 2.2"));
        view.getPart(2).printFooter();

        view.getPart(3).printHeader();
        printSubpart(view.getPart(3).getPart(1), getDataSource("подраздел 2.3"));
        view.getPart(3).printFooter();

        view.printFooter();
    end;

    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();

        if (not isEmpty())
            printPart1();
            printPart2();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    private macro constructorTPrintController_I2055()
        initTPrintController_I5456();

        m_view = TReportView_I2055();
        m_report = RcbApplication().currentReport;
        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1.1", TDataSourceSubpart1("Ф711_Гр?")),
                                     TObjectDescriptor("подраздел 1.1.2", TDataSourceSubpart1("Ф711_Гр10, Ф711_Гр11, Ф711_Гр12, Ф711_Гр13, Ф711_Гр14, Ф711_Гр15")),
                                     TObjectDescriptor("подраздел 1.2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_2_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_2_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_3_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_3_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.4", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_4").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator()))
                                    );
    end;

    constructorTPrintController_I2055();
end;

/************************************************************************************************************
 * Классы, отвечающие за печать формы в соответствии с 2332-У
 ************************************************************************************************************/
/**
 *  Печатное представление таблицы подраздела 1.1.1
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart111TableView_I2055) TSubpart111TableView_I2332()
    macro printHeader()
        [┌──────┬─────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐];
        [│Номер │Счета для учета ценных бумаг,│  Междепозитарные счета депо │              │              │              │              │              │];
        [│строки│   принадлежащих клиентам    │  "ЛОРО", открытые сторонним │    Счета     │    Счета     │ Эмиссионные  │    Счета     │    Счета,    │];
        [│      │    депозитария на правах    │        депозитариям         │   залого-    │ доверительных│    счета     │  эмитентов   │  владельцы   │];
        [│      │       собственности         │                             │  держателей  │ управляющих  │              │              │  которых не  │];
        [│      ├──────────────┬──────────────┼──────────────┬──────────────┤              │              │              │              │  установлены │];
        [│      │  резидентам  │ нерезидентам │  резидентам  │ нерезидентам │              │              │              │              │              │];
        [├──────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│  1   │      2       │      3       │      4       │      5       │      6       │      7       │      8       │      9       │      10      │];
        [├──────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
    end;

    private macro constructorTSubpart111TableView_I2332()
        initTPartView();

        m_table.addColumn("1",  4,  AL_CENTER);
        m_table.addColumn("2",  12, AL_RIGHT);
        m_table.addColumn("3",  12, AL_RIGHT);
        m_table.addColumn("4",  12, AL_RIGHT);
        m_table.addColumn("5",  12, AL_RIGHT);
        m_table.addColumn("6",  12, AL_RIGHT);
        m_table.addColumn("7",  12, AL_RIGHT);
        m_table.addColumn("8",  12, AL_RIGHT);
        m_table.addColumn("9",  12, AL_RIGHT);
        m_table.addColumn("10", 12, AL_RIGHT);
    end;

    constructorTSubpart111TableView_I2332();
end;

class (TSubpart111TableView_I2055) TSubpart11TableView_I3129()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬───────────────┬─────────────┬──────────────┬──────────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────────────┬───────────────────────┐");
        print("│Номер │ Наименование де- │ ИНН депозита- │ КПП депозита- │ ОГРН депозитария │ Код ОКСМ      │ Номер лицензии    │ Признак депозитария │ Номер междепозитарно- │ Наимено- │ ИНН           │ КПП           │ ОГРН          │ Код ОКСМ    │ Код типа     │ Номер госу-  │ Код ISIN │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │ Наименование     │ Признак организа- │ ИНН организации  │ КПП организации  │ ОГРН организации │ Код ОКСМ страны  │ Номер лицензии професси- │ Номер междепозитар-   │");
        print("│строки│ позитария        │ рия (спецде-  │ рия (спецде-  │ (спецдепозитария)│ страны депо-  │ профессионального │ (спецдепозитария) - │ го счета \"ЛОРО\", от-│ вание    │ эмитента      │ эмитента      │ эмитента      │ страны эми- │ ценной бума- │ дарственной  │ ценной   │ ты ценной │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ штук                      │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ онального участника рын- │ ного счета \"НОСТРО\"   │");
        print("│      │ (спецдепозитария)│ позитария) -  │ позитария) -  │ - корреспондента │ зитария       │ участника рынка   │ корреспондента      │ крытого депозитарию   │ эмитента │               │               │               │ тента       │ ги           │ регистрации  │ бумаги   │ бумаги    │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│                           │ шестоящего депо- │ депозитария,      │ депозитария,     │ депозитария,     │ депозитария,     │ шестоящего депо- │ ка ценных бумаг органи-  │ (счета номинального   │");
        print("│      │ -корреспондента  │ корреспонден- │ корреспонден- │                  │ (спецдепози-  │ ценных бумаг ор-  │                     │ (спецдепозитарию) -   │          │               │               │               │             │              │ ценной бума- │          │           │");printFillLeft(" ");print("ги, ед. ва- ");printFillRight(" ");println("│                           │ зитария, спецде- │ спецдепозитария,  │ спецдепозитария, │ спецдепозитария, │ спецдепозитария, │ зитария, спецде- │ зации (вышестоящего де-  │ держателя), открыто-  │");
        print("│      │                  │ та            │ та            │                  │ тария) - кор- │ ганизации - кор-  │                     │ корреспонденту        │          │               │               │               │             │              │ ги           │          │           │");printFillLeft(" ");print("люты обяза- ");printFillRight(" ");println("│                           │ позитария, реги  │ регистратора)     │ регистратора)    │ регистратора)    │ регистратора)    │ позитария, реги- │ позитария, спецдепозита  │ го в вышестоящем де-  │");
        print("│      │                  │               │               │                  │ респондента   │ респондента       │                     │                       │          │               │               │               │             │              │              │          │           │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│                           │ стратора)        │                   │                  │                  │                  │ стратора)        │ рия, регистратора)       │ позитарии, спецдепо-  │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │              │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │                  │                   │                  │                  │                  │                  │                          │ зитарии, регистраторе │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼──────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │       4       │         5        │       6       │         7         │          8          │           9           │    10    │      11       │      12       │      13       │      14     │      15      │      16      │    17    │    18     │");printFillLeft(" ");print("     19     ");printFillRight(" ");println("│             20            │        21        │        22         │        23        │        24        │        25        │        26        │             27           │             28        │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼──────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

//        var faceValue = convertZero(truncZero(current.fieldValue("ЦБНоминал").exact));
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("КорреспНаим").current,
                         current.fieldValue("КорреспИНН").current,
                         current.fieldValue("КорреспКПП").current,
                         current.fieldValue("КорреспОГРН").current,
                         current.fieldValue("КорреспОКСМ").current,
                         current.fieldValue("КорреспНомерЛицензии").current,
                         current.fieldValue("КорреспПризнак").current,
                         current.fieldValue("КорреспНомерСчета").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("МХНомерСчёта").current
                        );
    end;

    private macro constructorTSubpart11TableView_I3129()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_1", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("1",  4,  AL_CENTER);
        m_table.addColumn("2",  16, AL_RIGHT);
        m_table.addColumn("3",  13, AL_RIGHT);
        m_table.addColumn("4",  13, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  13, AL_RIGHT);
        m_table.addColumn("7",  17, AL_RIGHT);
        m_table.addColumn("8",  19, AL_RIGHT);
        m_table.addColumn("9",  21, AL_RIGHT);
        m_table.addColumn("10", 8, AL_RIGHT);
        m_table.addColumn("11", 13, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 13, AL_RIGHT);
        m_table.addColumn("14", 11, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 8, AL_RIGHT);
        m_table.addColumn("18", 9, AL_RIGHT);
        m_table.addColumn("19", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("20", 25, AL_RIGHT);
        m_table.addColumn("21", 16, AL_RIGHT);
        m_table.addColumn("22", 17, AL_RIGHT);
        m_table.addColumn("23", 16, AL_RIGHT);
        m_table.addColumn("24", 16, AL_RIGHT);
        m_table.addColumn("25", 16, AL_RIGHT);
        m_table.addColumn("26", 16, AL_RIGHT);
        m_table.addColumn("27", 24, AL_RIGHT);
        m_table.addColumn("28", 21, AL_RIGHT);
    end;

    constructorTSubpart11TableView_I3129();

end;

class (TSubpart11TableView_I3129) TSubpart11TableView_I4212()

    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │      КПП      │       ОГРН       │   Код ОКСМ    │  Номер лицензии   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     КПП       │     ОГРН      │ Код ОКСМ    │ Код типа     │  Государственный  │ Код ISIN │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование     │ Признак организа- │ ИНН организации  │ КПП организации  │ ОГРН организации │ Код ОКСМ страны  │ Номер лицензии професси- │ Номер счета депо      │");
        print("│строки│   номинального   │ номинального  │ номинального  │   номинального   │    страны     │ профессионального │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │   эмитента    │ страны эми- │ ценной бума- │  регистрационный  │ ценной   │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                        │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ онального участника рын- │ (лицевого счета)      │");
        print("│      │    держателя     │   держателя   │   держателя   │    держателя     │ номинального  │  участника рынка  │      держателя      │     (иностранного     │ эмитента │               │               │               │ тента       │ ги           │   номер выпуска   │ бумаги   │ бумаги    │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│                           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария,      │ депозитария,     │ депозитария,     │ депозитария,     │ шестоящего депо- │ ка ценных бумаг органи-  │ номинального держате- │");
        print("│      │                  │               │               │                  │   держателя   │   ценных бумаг    │                     │номинального держателя)│          │               │               │               │             │              │ ценных бумаг или  │          │           │");printFillLeft(" ");print("  бумаги,   ");printFillRight(" ");println("│                           │     всего    │                                 из них                                   │ зитария, спецде- │ спецдепозитария,  │ спецдепозитария, │ спецдепозитария, │ спецдепозитария, │ зитария, спецде- │ зации (вышестоящего де-  │ ля, открытого в вы-   │");
        print("│      │                  │               │               │                  │               │   номинального    │                     │                       │          │               │               │               │             │              │ идентификационный │          │           │");printFillLeft(" ");print(" ед. валюты ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ позитария, реги  │ регистратора)     │ регистратора)    │ регистратора)    │ регистратора)    │ позитария, реги- │ позитария, спецдепозита  │ шестоящем депозитарии │");
        print("│      │                  │               │               │                  │               │     держателя     │                     │                       │          │               │               │               │             │              │   номер выпуска   │          │           │");printFillLeft(" ");print("обязательст-");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │  ограничено  │введен запрет │ под арестом  │ стратора)        │                   │                  │                  │                  │ стратора)        │ рия, регистратора)       │ (спецдепозитарии,     │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │    ценных бумаг   │          │           │");printFillLeft(" ");print("     ва     ");printFillRight(" ");println("│                           │              │              │ на торговых  │ распоряжение │      на      │              │                  │                   │                  │                  │                  │                  │                          │ регистраторе)         │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  в связи с   │осуществление │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │корпоративными│   операций   │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │       4       │         5        │       6       │         7         │          8          │           9           │    10    │      11       │      12       │      13       │      14     │      15      │         16        │    17    │    18     │");printFillLeft(" ");print("     19     ");printFillRight(" ");println("│             20            │      21      │      22      │      23      │      24      │      25      │      26      │        27        │        28         │        29        │        30        │        31        │        32        │             33           │             34        │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("КорреспНаим").current,
                         current.fieldValue("КорреспИНН").current,
                         current.fieldValue("КорреспКПП").current,
                         current.fieldValue("КорреспОГРН").current,
                         current.fieldValue("КорреспОКСМ").current,
                         current.fieldValue("КорреспНомерЛицензии").current,
                         current.fieldValue("КорреспПризнак").current,
                         current.fieldValue("КорреспНомерСчета").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("МХНомерСчёта").current
                        );
    end;

    private macro constructorTSubpart11TableView_I4212()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_1", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  16, AL_RIGHT);
        m_table.addColumn("3",  13, AL_RIGHT);
        m_table.addColumn("4",  13, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  13, AL_RIGHT);
        m_table.addColumn("7",  17, AL_RIGHT);
        m_table.addColumn("8",  19, AL_RIGHT);
        m_table.addColumn("9",  21, AL_RIGHT);
        m_table.addColumn("10",  8, AL_RIGHT);
        m_table.addColumn("11", 13, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 13, AL_RIGHT);
        m_table.addColumn("14", 11, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 17, AL_RIGHT);
        m_table.addColumn("17",  8, AL_RIGHT);
        m_table.addColumn("18",  9, AL_RIGHT);
        m_table.addColumn("19", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("20", 25, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 12, AL_RIGHT);
        m_table.addColumn("27", 16, AL_RIGHT);
        m_table.addColumn("28", 17, AL_RIGHT);
        m_table.addColumn("29", 16, AL_RIGHT);
        m_table.addColumn("30", 16, AL_RIGHT);
        m_table.addColumn("31", 16, AL_RIGHT);
        m_table.addColumn("32", 16, AL_RIGHT);
        m_table.addColumn("33", 24, AL_RIGHT);
        m_table.addColumn("34", 21, AL_RIGHT);
    end;

    constructorTSubpart11TableView_I4212();
end;

class (TSubpart11TableView_I4212) TSubpart11TableView_I4927()
    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │      КПП      │       ОГРН       │   Код ОКСМ    │  Номер лицензии   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     КПП       │     ОГРН      │ Код ОКСМ    │ Код типа     │  Государственный  │ Код ISIN │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование     │ Признак организа- │ ИНН организации  │ КПП организации  │ ОГРН организации │ Код ОКСМ страны  │ Номер лицензии професси- │ Номер счета депо      │");
        print("│строки│   номинального   │ номинального  │ номинального  │   номинального   │    страны     │ профессионального │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │   эмитента    │ страны эми- │ ценной бума- │  регистрационный  │ ценной   │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                        │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ онального участника рын- │ (лицевого счета)      │");
        print("│      │    держателя     │   держателя   │   держателя   │    держателя     │ номинального  │  участника рынка  │      держателя      │   (номер счета депо   │ эмитента │               │               │               │ тента       │ ги           │   номер выпуска   │ бумаги   │ бумаги    │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│                           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария,      │ депозитария,     │ депозитария,     │ депозитария,     │ шестоящего депо- │ ка ценных бумаг органи-  │ номинального держате- │");
        print("│      │                  │               │               │                  │   держателя   │   ценных бумаг    │                     │      иностранного     │          │               │               │               │             │              │ ценных бумаг или  │          │           │");printFillLeft(" ");print("  бумаги,   ");printFillRight(" ");println("│                           │     всего    │                                 из них                                   │ зитария, спецде- │ спецдепозитария,  │ спецдепозитария, │ спецдепозитария, │ спецдепозитария, │ зитария, спецде- │ зации (вышестоящего де-  │ ля, открытого в вы-   │");
        print("│      │                  │               │               │                  │               │   номинального    │                     │номинального держателя)│          │               │               │               │             │              │ идентификационный │          │           │");printFillLeft(" ");print(" ед. валюты ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ позитария, реги  │ регистратора)     │ регистратора)    │ регистратора)    │ регистратора)    │ позитария, реги- │ позитария, спецдепозита  │ шестоящем депозитарии │");
        print("│      │                  │               │               │                  │               │     держателя     │                     │                       │          │               │               │               │             │              │   номер выпуска   │          │           │");printFillLeft(" ");print("обязательст-");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │  ограничено  │введен запрет │ под арестом  │ стратора)        │                   │                  │                  │                  │ стратора)        │ рия, регистратора)       │ (спецдепозитарии,     │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │    ценных бумаг   │          │           │");printFillLeft(" ");print("     ва     ");printFillRight(" ");println("│                           │              │              │ на торговых  │ распоряжение │      на      │              │                  │                   │                  │                  │                  │                  │                          │ регистраторе)         │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  в связи с   │осуществление │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │корпоративными│   операций   │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │       4       │         5        │       6       │         7         │          8          │           9           │    10    │      11       │      12       │      13       │      14     │      15      │         16        │    17    │    18     │");printFillLeft(" ");print("     19     ");printFillRight(" ");println("│             20            │      21      │      22      │      23      │      24      │      25      │      26      │        27        │        28         │        29        │        30        │        31        │        32        │             33           │             34        │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
    end;

    initTSubpart11TableView_I4212();
end;

class (TSubpart11TableView_I4927) TSubpart11TableView_I5456()
    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │      КПП      │       ОГРН       │   Код ОКСМ    │  Номер лицензии   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     КПП       │     ОГРН      │ Код ОКСМ    │ Код типа     │   Регистрационный │ Код ISIN │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование     │ Признак организа- │ ИНН организации  │ КПП организации  │ ОГРН организации │ Код ОКСМ страны  │      Номер лицензии      │ Номер счета депо      │");
        print("│строки│   номинального   │ номинального  │ номинального  │   номинального   │    страны     │   номинального    │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │   эмитента    │ страны эми- │ ценной бума- │    номер выпуска  │ ценной   │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                        │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ организации (вышестоящего│ (лицевого счета)      │");
        print("│      │    держателя     │   держателя   │   держателя   │    держателя     │ номинального  │     держателя     │      держателя      │                       │ эмитента │               │               │               │ тента       │ ги           │     ценных бумаг  │ бумаги   │ бумаги    │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│                           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария, спе- │ депозитария, спе-│ депозитария, спе-│ депозитария, спе-│ шестоящего депо- │ депозитария, специализи- │ номинального держате- │");
        print("│      │                  │               │               │                  │   держателя   │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("  бумаги,   ");printFillRight(" ");println("│                           │     всего    │                                 из них                                   │ зитария, специа- │ циализированного  │ циализированного │ циализированного │ циализированного │ зитария, специ-  │  рованного депозитария,  │ ля, открытого в вы-   │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print(" ед. валюты ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤   лизированного  │    депозитария,   │    депозитария,  │    депозитария,  │    депозитария,  │  ализированного  │       регистратора)      │ шестоящем депозитарии │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("  номинала  ");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ под арестом  │    депозитария,  │    регистратора)  │    регистратора) │    регистратора) │    регистратора) │   депозитария,   │                          │ (специализированном   │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ на торговых  │   которыми   │введен запрет │              │   регистратора)  │                   │                  │                  │                  │   регистратора)  │                          │     депозитарии,      │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  ограничено  │      на      │              │                  │                   │                  │                  │                  │                  │                          │     регистраторе)     │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │  в связи с   │осуществление │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │корпоративными│   операций   │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("│      │                  │               │               │                  │               │                   │                     │                       │          │               │               │               │             │              │                   │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │                  │                   │                  │                  │                  │                  │                          │                       │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │       4       │         5        │       6       │         7         │          8          │           9           │    10    │      11       │      12       │      13       │      14     │      15      │         16        │    17    │    18     │");printFillLeft(" ");print("     19     ");printFillRight(" ");println("│             20            │      21      │      22      │      23      │      24      │      25      │      26      │        27        │        28         │        29        │        30        │        31        │        32        │             33           │             34        │");
        print("├──────┼──────────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
    end;

    initTSubpart11TableView_I4927();
end;

class (TSubpart11TableView_I5456) TSubpart11TableView_I5986()
    var ErrArr = TArray();

    macro CheckError(err_ogrn)
      var errstr = "";

      for(errstr, ErrArr)
        if (errstr == err_ogrn)
          return true;
        end;
      end;
      return false;
    end;
    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬──────────────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │       ОГРН       │  Код страны   │  Номер лицензии   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     ОГРН      │ Код страны  │ Тип ценной   │ Регистрационный   │ Код ISIN │   Код    │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование     │ Признак организа- │ ИНН организации  │ ОГРН организации │   Код страны     │      Номер лицензии      │ Номер счета депо      │");
        print("│строки│   номинального   │ номинального  │   номинального   │ номинального  │   номинального    │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │  эмитента   │ бумаги (вид  │  номер (идентифи- │ ценной   │   CFI    │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                        │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ организации (вышестоящего│ (лицевого счета)      │");
        print("│      │    держателя     │   держателя   │    держателя     │  держателя    │     держателя     │      держателя      │                       │ эмитента │               │               │  по ОКСМ    │ финансового  │ кационный номер)  │ бумаги   │          │ бумаги    │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│                           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария, спе- │ депозитария, спе-│ депозитария, спе-│ шестоящего депо- │ депозитария, специализи- │ номинального держате- │");
        print("│      │                  │               │                  │   по ОКСМ     │                   │                     │                       │          │               │               │             │ инструмента) │      выпуска      │          │          │           │");printFillLeft(" ");print("     ги     ");printFillRight(" ");println("│                           │     всего    │                                 из них                                   │ зитария, специа- │ циализированного  │ циализированного │ циализированного │ зитария, специ-  │  рованного депозитария,  │ ля, открытого в вы-   │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤   лизированного  │    депозитария,   │    депозитария,  │    депозитария,  │  ализированного  │       регистратора)      │ шестоящем депозитарии │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ под арестом  │    депозитария,  │    регистратора)  │    регистратора) │    регистратора) │   депозитария,   │                          │ (специализированном   │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ на торговых  │   которыми   │введен запрет │              │   регистратора)  │                   │                  │                  │   регистратора)  │                          │     депозитарии,      │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  ограничено  │      на      │              │                  │                   │                  │                  │     по ОКСМ      │                          │     регистраторе)     │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │  в связи с   │осуществление │              │                  │                   │                  │                  │                  │                          │                       │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │корпоративными│   операций   │              │                  │                   │                  │                  │                  │                          │                       │");
        print("│      │                  │               │                  │               │                   │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │                  │                   │                  │                  │                  │                          │                       │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │         4        │       5       │         6         │          7          │           8           │    9     │      10       │      11       │      12     │      13      │         14        │    15    │    16    │    17     │");printFillLeft(" ");print("     18     ");printFillRight(" ");println("│             19            │      20      │      21      │      22      │      23      │      24      │      25      │        26        │        27         │        28        │        29        │        30        │             31           │             32        │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼──────────────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("КорреспНаим").current,
                         current.fieldValue("КорреспИНН").current,
                         current.fieldValue("КорреспОГРН").current,
                         current.fieldValue("КорреспОКСМ").current,
                         current.fieldValue("КорреспНомерЛицензии").current,
                         current.fieldValue("КорреспПризнак").current,
                         current.fieldValue("КорреспНомерСчета").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("МХНомерСчёта").current
                        );
    end;

    private macro constructorTSubpart11TableView_I5986()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_1", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  16, AL_RIGHT);
        m_table.addColumn("3",  13, AL_RIGHT);
        m_table.addColumn("4",  16, AL_RIGHT);
        m_table.addColumn("5",  13, AL_RIGHT);
        m_table.addColumn("6",  17, AL_RIGHT);
        m_table.addColumn("7",  19, AL_RIGHT);
        m_table.addColumn("8",  21, AL_RIGHT);
        m_table.addColumn("9",   8, AL_RIGHT);
        m_table.addColumn("10", 13, AL_RIGHT);
        m_table.addColumn("11", 13, AL_RIGHT);
        m_table.addColumn("12", 11, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 17, AL_RIGHT);
        m_table.addColumn("15",  8, AL_RIGHT);
        m_table.addColumn("16",  8, AL_RIGHT);
        m_table.addColumn("17",  9, AL_RIGHT);
        m_table.addColumn("18", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("19", 25, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 16, AL_RIGHT);
        m_table.addColumn("27", 17, AL_RIGHT);
        m_table.addColumn("28", 16, AL_RIGHT);
        m_table.addColumn("29", 16, AL_RIGHT);
        m_table.addColumn("30", 16, AL_RIGHT);
        m_table.addColumn("31", 24, AL_RIGHT);
        m_table.addColumn("32", 21, AL_RIGHT);
    end;

    constructorTSubpart11TableView_I5986();
end;

class (TSubpart11TableView_I5986) TSubpart11TableView_I6406()
    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬──────────────────┬───────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │       ОГРН       │  Код страны   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     ОГРН      │ Код страны  │ Тип ценной   │ Регистрационный   │ Код ISIN │   Код    │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение                         │ Наименование     │ Признак организа- │ ИНН организации  │ ОГРН организации │   Код страны     │ Номер счета депо      │");
        print("│строки│   номинального   │ номинального  │   номинального   │ номинального  │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │  эмитента   │ бумаги (вид  │  номер (идентифи- │ ценной   │   CFI    │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                                       │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ (лицевого счета)      │");
        print("│      │    держателя     │   держателя   │    держателя     │  держателя    │      держателя      │                       │ эмитента │               │               │  по ОКСМ    │ финансового  │ кационный номер)  │ бумаги   │          │ бумаги    │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│                           ├──────────────┬─────────────────────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария, спе- │ депозитария, спе-│ депозитария, спе-│ шестоящего депо- │ номинального держате- │");
        print("│      │                  │               │                  │   по ОКСМ     │                     │                       │          │               │               │             │ инструмента) │      выпуска      │          │          │           │");printFillLeft(" ");print("     ги     ");printFillRight(" ");println("│                           │     всего    │                                 из них                                                  │ зитария, специа- │ циализированного  │ циализированного │ циализированного │ зитария, специ-  │ ля, открытого в вы-   │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤   лизированного  │    депозитария,   │    депозитария,  │    депозитария,  │  ализированного  │ шестоящем депозитарии │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ учитываемых  │ под арестом  │    депозитария,  │    регистратора)  │    регистратора) │    регистратора) │   депозитария,   │ (специализированном   │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ на торговых  │   которыми   │введен запрет │на счетах депо│              │   регистратора)  │                   │                  │                  │   регистратора)  │     депозитарии,      │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  ограничено  │      на      │эскроу-агента │              │                  │                   │                  │                  │     по ОКСМ      │     регистраторе)     │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │  в связи с   │осуществление │              │              │                  │                   │                  │                  │                  │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │корпоративными│   операций   │              │              │                  │                   │                  │                  │                  │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │              │                  │                   │                  │                  │                  │                       │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │         4        │       5       │          6          │           7           │    8     │      9        │      10       │      11     │      12      │         13        │    14    │    15    │    16     │");printFillLeft(" ");print("     17     ");printFillRight(" ");println("│             18            │      19      │      20      │      21      │      22      │      23      │      24      │      25      │        26        │        27         │        28        │        29        │        30        │             31        │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("КорреспНаим").current,
                         current.fieldValue("КорреспИНН").current,
                         current.fieldValue("КорреспОГРН").current,
                         current.fieldValue("КорреспОКСМ").current,
                         current.fieldValue("КорреспПризнак").current,
                         current.fieldValue("КорреспНомерСчета").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         string(current.fieldValue("КоличествоПоСчету").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерСчёта").current
                        );
    end;

    private macro constructorTSubpart11TableView_I6406()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_1", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  16, AL_RIGHT);
        m_table.addColumn("3",  13, AL_RIGHT);
        m_table.addColumn("4",  16, AL_RIGHT);
        m_table.addColumn("5",  13, AL_RIGHT);
        m_table.addColumn("6",  19, AL_RIGHT);
        m_table.addColumn("7",  21, AL_RIGHT);
        m_table.addColumn("8",   8, AL_RIGHT);
        m_table.addColumn("9", 13, AL_RIGHT);
        m_table.addColumn("10", 13, AL_RIGHT);
        m_table.addColumn("11", 11, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 17, AL_RIGHT);
        m_table.addColumn("14",  8, AL_RIGHT);
        m_table.addColumn("15",  8, AL_RIGHT);
        m_table.addColumn("16",  9, AL_RIGHT);
        m_table.addColumn("17", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 16, AL_RIGHT);
        m_table.addColumn("27", 17, AL_RIGHT);
        m_table.addColumn("28", 16, AL_RIGHT);
        m_table.addColumn("29", 16, AL_RIGHT);
        m_table.addColumn("30", 16, AL_RIGHT);
        m_table.addColumn("31", 21, AL_RIGHT);
    end;

    constructorTSubpart11TableView_I6406();
end;

class (TSubpart11TableView_I6406) TSubpart11TableView_I6800()
    macro printHeader()
        print("┌──────┬──────────────────┬───────────────┬──────────────────┬───────────────┬─────────────────────┬───────────────────────┬──────────┬───────────────┬───────────────┬─────────────┬──────────────┬───────────────────┬──────────┬──────────┬───────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────┬───────────────────┬──────────────────┬──────────────────┬──────────────────┬───────────────────────┬───────────────────────┐");
        print("│Номер │   Наименование   │      ИНН      │       ОГРН       │  Код страны   │       Признак       │   Номер счета депо    │ Наимено- │     ИНН       │     ОГРН      │ Код страны  │ Тип ценной   │ Регистрационный   │ Код ISIN │   Код    │ Код валю- │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг,  │         Количество ценных бумаг, в отношении которых зафиксировано обременение                                                       │ Наименование     │ Признак организа- │ ИНН организации  │ ОГРН организации │   Код страны     │ Номер счета депо      │      Примечание       │");
        print("│строки│   номинального   │ номинального  │   номинального   │ номинального  │    номинального     │номинального держателя │  вание   │   эмитента    │   эмитента    │  эмитента   │ бумаги (вид  │  номер (идентифи- │ ценной   │   CFI    │ ты ценной │");printFillLeft(" ");print(" стоимость  ");printFillRight(" ");println("│             шт.           │                            и (или) ограничение распоряжения, шт.                                                                     │ организации (вы- │ ции (вышестоящего │ (вышестоящего    │ (вышестоящего    │ организации (вы- │ (лицевого счета)      │                       │");
        print("│      │    держателя     │   держателя   │    держателя     │  держателя    │      держателя      │                       │ эмитента │               │               │  по ОКСМ    │ финансового  │ кационный номер)  │ бумаги   │          │ бумаги    │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│                           ├──────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ шестоящего депо- │ депозитария, спе- │ депозитария, спе-│ депозитария, спе-│ шестоящего депо- │ номинального держате- │                       │");
        print("│      │                  │               │                  │   по ОКСМ     │                     │                       │          │               │               │             │ инструмента) │      выпуска      │          │          │           │");printFillLeft(" ");print("     ги     ");printFillRight(" ");println("│                           │     всего    │                                 из них                                                                                │ зитария, специа- │ циализированного  │ циализированного │ циализированного │ зитария, специ-  │ ля, открытого в вы-   │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤   лизированного  │    депозитария,   │    депозитария,  │    депозитария,  │  ализированного  │ шестоящем депозитарии │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ учитываемых  │ учет которых │ учет которых │  под арестом │    депозитария,  │    регистратора)  │    регистратора) │    регистратора) │   депозитария,   │ (специализированном   │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ на торговых  │   которыми   │введен запрет │на счетах депо│ обособлен на │ обособлен на │              │   регистратора)  │                   │                  │                  │   регистратора)  │     депозитарии,      │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │(клиринговых) │  ограничено  │      на      │эскроу-агента │  основании   │  основании   │              │                  │                   │                  │                  │     по ОКСМ      │     регистраторе)     │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │ счетах депо  │  в связи с   │осуществление │              │ федеральных  │ предписаний  │              │                  │                   │                  │                  │                  │                       │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │корпоративными│   операций   │              │законов и нор-│ (требований) │              │                  │                   │                  │                  │                  │                       │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │  действиями  │              │              │мативных актах│ Банка России │              │                  │                   │                  │                  │                  │                       │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │              │              │              │ Российской   │              │              │                  │                   │                  │                  │                  │                       │                       │");
        print("│      │                  │               │                  │               │                     │                       │          │               │               │             │              │                   │          │          │           │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                           │              │              │              │              │              │              │  федерации   │              │              │                  │                   │                  │                  │                  │                       │                       │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────────┼───────────────────────┤");
        print("│  1   │        2         │       3       │         4        │       5       │          6          │           7           │    8     │      9        │      10       │      11     │      12      │         13        │    14    │    15    │    16     │");printFillLeft(" ");print("     17     ");printFillRight(" ");println("│             18            │      19      │      20      │      21      │      22      │      23      │      24      │      25      │      26      │      27      │        28        │        29         │        30        │        31        │        32        │           33          │           34          │");
        print("├──────┼──────────────────┼───────────────┼──────────────────┼───────────────┼─────────────────────┼───────────────────────┼──────────┼───────────────┼───────────────┼─────────────┼──────────────┼───────────────────┼──────────┼──────────┼───────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────────┼───────────────────┼──────────────────┼──────────────────┼──────────────────┼───────────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;
        
        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("КорреспНаим").current,
                         current.fieldValue("КорреспИНН").current,
                         current.fieldValue("КорреспОГРН").current,
                         current.fieldValue("КорреспОКСМ").current,
                         current.fieldValue("КорреспПризнак").current,
                         current.fieldValue("КорреспНомерСчета").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         string(current.fieldValue("КоличествоПоСчету").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособФЗ").current != $0.0, string(current.fieldValue("ОбособФЗ").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособТреб").current != $0.0, string(current.fieldValue("ОбособТреб").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерСчёта").current,
                         current.fieldValue("Примечание").current
                        );
    end;

    private macro constructorTSubpart11TableView_I6800()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_1", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  16, AL_RIGHT);
        m_table.addColumn("3",  13, AL_RIGHT);
        m_table.addColumn("4",  16, AL_RIGHT);
        m_table.addColumn("5",  13, AL_RIGHT);
        m_table.addColumn("6",  19, AL_RIGHT);
        m_table.addColumn("7",  21, AL_RIGHT);
        m_table.addColumn("8",   8, AL_RIGHT);
        m_table.addColumn("9", 13, AL_RIGHT);
        m_table.addColumn("10", 13, AL_RIGHT);
        m_table.addColumn("11", 11, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 17, AL_RIGHT);
        m_table.addColumn("14",  8, AL_RIGHT);
        m_table.addColumn("15",  8, AL_RIGHT);
        m_table.addColumn("16",  9, AL_RIGHT);
        m_table.addColumn("17", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 12, AL_RIGHT);
        m_table.addColumn("27", 12, AL_RIGHT);
        m_table.addColumn("28", 16, AL_RIGHT);
        m_table.addColumn("29", 17, AL_RIGHT);
        m_table.addColumn("30", 16, AL_RIGHT);
        m_table.addColumn("31", 16, AL_RIGHT);
        m_table.addColumn("32", 16, AL_RIGHT);
        m_table.addColumn("33", 21, AL_RIGHT);
        m_table.addColumn("34", 21, AL_RIGHT);
    end;

    constructorTSubpart11TableView_I6800();
end;

/**
 *  Печатное представление таблицы подраздела 1.1.2
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart112TableView_I2055) TSubpart112TableView_I2332()

    macro printHeader()

        [┌──────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┐];
        [│Номер │Счета для учета ценных бумаг,│    Счета     │    Счета     │              │              │              │];
        [│строки│   принадлежащих кредитной   │   залого-    │   довери-    │ Эмиссионные  │    Счета     │    Иные      │];
        [│      │    организации на правах    │  держателя   │   тельного   │    счета     │   эмитента   │    счета     │];
        [│      │       собственности         │              │ управляющего │              │              │              │];
        [├──────┼─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│  11  │              12             │      13      │      14      │      15      │      16      │      17      │];
        [├──────┼─────────────────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];

    end;

    private macro constructorTSubpart112TableView_I2332()

        initTPartView();

        m_table.addColumn("11", 4,  AL_CENTER);
        m_table.addColumn("12", 27, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);

    end;

    constructorTSubpart112TableView_I2332();

end;

class (TSubpart112TableView_I2055) TSubpart12TableView_I3129()

    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Номер государст-    │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │ Информация о  │ Наименование  │ Признак орга- │ ИНН организа- │ КПП организа- │ ОГРН органи-  │ Код ОКСМ      │ Номер лицензии     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ венной регистрации  │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │ владельце     │ организации   │ низации (вы-  │ ции (вышесто- │ ции (вышесто- │ зации (выше-  │ страны орга-  │ профессионального  │");
        print("│      │              │               │               │                  │ эмитента      │                   │ ценной бумаги       │                       │ маги       │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│ открытого в   │ ценных           │ счета депо,   │ (вышестоящего │ шестоящего    │ ящего депози- │ ящего депози- │ стоящего де-  │ низации (вы-  │ участника рынка    │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ги, ед. ва- ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │ (код принад-  │ депозитария,  │ депозитария,  │ тария,        │ тария,        │ позитария,    │ шестоящего    │ ценных бумаг орга- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("люты обяза- ");printFillRight(" ");println("│ спецдепози-   │ штук             │ лежности к    │ спецдепозита- │ спецдепозита- │ спецдепозита- │ спецдепозита- │ спецдепозита- │ депозитария,  │ низации (вышестоя- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│ тарии         │                  │ сектору эко-  │ рия, реги-    │ рия, реги-    │ рия, реги-    │ рия, реги-    │ рия, реги-    │ спецдепозита- │ щего депозитария,  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │ номики)       │ стратора      │ стратора)     │ стратора)     │ стратора)     │ стратора)     │ рия, реги-    │ спецдепозитария,   │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │               │               │               │               │               │               │ стратора)     │ регистратора)      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┤");
        print("│  29  │      30      │       31      │       32      │        33        │      34       │        35         │         36          │           37          │     38     │");printFillLeft(" ");print("     39     ");printFillRight(" ");println("│      40       │        41        │      42       │      43       │      44       │      45       │      46       │      47       │      48       │        49          │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┤");
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;
//        var faceValue = convertZero(truncZero(current.fieldValue("ЦБНоминал").exact));
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
           // faceValue = string(faceValue : 0 : *, current.fieldValue("ЦБНоминалТочность").exact);
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current
                        );
    end;

    private macro constructorTSubpart12TableView_I3129()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn("29", 4,  AL_CENTER);
        m_table.addColumn("30", 12, AL_RIGHT);
        m_table.addColumn("31", 13, AL_RIGHT);
        m_table.addColumn("32", 13, AL_RIGHT);
        m_table.addColumn("33", 16, AL_RIGHT);
        m_table.addColumn("34", 13, AL_RIGHT);
        m_table.addColumn("35", 17, AL_RIGHT);
        m_table.addColumn("36", 19, AL_RIGHT);
        m_table.addColumn("37", 21, AL_RIGHT);
        m_table.addColumn("38", 10, AL_RIGHT);
        m_table.addColumn("39", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("40", 13, AL_RIGHT);
        m_table.addColumn("41", 16, AL_RIGHT);
        m_table.addColumn("42", 13, AL_RIGHT);
        m_table.addColumn("43", 13, AL_RIGHT);
        m_table.addColumn("44", 13, AL_RIGHT);
        m_table.addColumn("45", 13, AL_RIGHT);
        m_table.addColumn("46", 13, AL_RIGHT);
        m_table.addColumn("47", 13, AL_RIGHT);
        m_table.addColumn("48", 13, AL_RIGHT);
        m_table.addColumn("49", 18, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I3129();
end;

class (TSubpart12TableView_I3129) TSubpart12TableView_I4212()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Номер государст-    │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Информация о  │  Код   │ Наименование  │ Признак орга- │ ИНН организа- │ КПП организа- │ ОГРН органи-  │ Код ОКСМ      │ Номер лицензии     │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ венной регистрации  │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │                            и (или) ограничение распоряжения, шт.                        │ владельце     │  ОКСМ  │ организации   │ низации (вы-  │ ции (вышесто- │ ции (вышесто- │ зации (выше-  │ страны орга-  │ профессионального  │");
        print("│      │              │               │               │                  │ эмитента      │                   │ ценной бумаги       │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│ открытого в   │ ценных           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ счета депо,   │ страны │ (вышестоящего │ шестоящего    │ ящего депози- │ ящего депози- │ стоящего де-  │ низации (вы-  │ участника рынка    │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │     всего    │                                 из них                                   │ (код принад-  │  вла-  │ депозитария,  │ депозитария,  │ тария,        │ тария,        │ позитария,    │ шестоящего    │ ценных бумаг орга- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│ спецдепози-   │ шт.              │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ лежности к    │ дельца │ спецдепозита- │ спецдепозита- │ спецдепозита- │ спецдепозита- │ спецдепозита- │ депозитария,  │ низации (вышестоя- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("обяза-      ");printFillRight(" ");println("│ тарии         │                  │              │   в залоге   │ учитываемых  │  ограничено  │введен запрет │ под арестом  │ сектору эко-  │ счета  │ рия, реги-    │ рия, реги-    │ рия, реги-    │ рия, реги-    │ рия, реги-    │ спецдепозита- │ щего депозитария,  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│               │                  │              │              │ на торговых  │ распоряжение │      на      │              │ номики)       │  депо  │ стратора      │ стратора)     │ стратора)     │ стратора)     │ стратора)     │ рия, реги-    │ спецдепозитария,   │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │(клиринговых) │  в связи с   │осуществление │              │               │        │               │               │               │               │               │ стратора)     │ регистратора)      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │ счетах депо  │корпоративными│   операций   │              │               │        │               │               │               │               │               │               │                    │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │  действиями  │              │              │               │        │               │               │               │               │               │               │                    │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┤");
        print("│  35  │      36      │       37      │       38      │        39        │      40       │        41         │         42          │           43          │     44     │");printFillLeft(" ");print("     45     ");printFillRight(" ");println("│      46       │        47        │      48      │      49      │      50      │      51      │      52      │      53      │      54       │   55   │      56       │      57       │      58       │      59       │      60       │      61       │        62          │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("СВ_ОКМС").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current
                        );
    end;

    private macro constructorTSubpart12TableView_I4212()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn("35",  4, AL_CENTER);
        m_table.addColumn("36", 12, AL_RIGHT);
        m_table.addColumn("37", 13, AL_RIGHT);
        m_table.addColumn("38", 13, AL_RIGHT);
        m_table.addColumn("39", 16, AL_RIGHT);
        m_table.addColumn("40", 13, AL_RIGHT);
        m_table.addColumn("41", 17, AL_RIGHT);
        m_table.addColumn("42", 19, AL_RIGHT);
        m_table.addColumn("43", 21, AL_RIGHT);
        m_table.addColumn("44", 10, AL_RIGHT);
        m_table.addColumn("45", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("46", 13, AL_RIGHT);
        m_table.addColumn("47", 16, AL_RIGHT);
        m_table.addColumn("48", 12, AL_RIGHT);
        m_table.addColumn("49", 12, AL_RIGHT);
        m_table.addColumn("50", 12, AL_RIGHT);
        m_table.addColumn("51", 12, AL_RIGHT);
        m_table.addColumn("52", 12, AL_RIGHT);
        m_table.addColumn("53", 12, AL_RIGHT);
        m_table.addColumn("54", 13, AL_RIGHT);
        m_table.addColumn("55",  6, AL_RIGHT);
        m_table.addColumn("56", 13, AL_RIGHT);
        m_table.addColumn("57", 13, AL_RIGHT);
        m_table.addColumn("58", 13, AL_RIGHT);
        m_table.addColumn("59", 13, AL_RIGHT);
        m_table.addColumn("60", 13, AL_RIGHT);
        m_table.addColumn("61", 13, AL_RIGHT);
        m_table.addColumn("62", 18, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I4212();
end;

class (TSubpart12TableView_I4212) TSubpart12TableView_I5456()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬────────────────────┬────────────────────┬─────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Регистрационный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Информация о  │  Код   │ Наименование  │ Признак орга- │ ИНН организа- │ КПП организа- │ ОГРН органи-  │ Код ОКСМ      │ Номер лицензии     │ Дата выдачи лицен- │ Лицензирующий орган, выдавший   │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │    номер выпуска    │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │                            и (или) ограничение распоряжения, шт.                        │владельце счета│ страны │ организации   │ низации (вы-  │ ции (вышесто- │ ции (вышесто- │ зации (выше-  │ страны орга-  │ организации (выше- │ зии на право осу-  │ лицензию на право осуществления │");
        print("│      │              │               │               │                  │ эмитента      │                   │    ценных бумаг     │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│ открытого в   │ ценных           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ (счета депо), │  вла-  │ (вышестоящего │ шестоящего    │ ящего депози- │ ящего депози- │ стоящего де-  │ низации (вы-  │ стоящего депозита- │ ществления учета   │ учета и перехода прав на ценные │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │     всего    │                                 из них                                   │ (код принад-  │ дельца │ депозитария,  │ депозитария,  │ тария,        │ тария,        │ позитария,    │ шестоящего    │ рия, спезиализиро- │ и перехода прав на │ бумаги (для организации-        │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│ специализиро- │ шт.              │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ лежности к    │ счета  │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ депозитария,  │ ванного депозита-  │ ценные бумаги (для │ нерезидента)                    │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("номинала    ");printFillRight(" ");println("│ ванном        │                  │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ под арестом  │ сектору эко-  │  депо  │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ специализиро- │ рия, регистратора) │ организации-       │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ депозитарии   │                  │              │              │ на торговых  │   которыми   │введен запрет │              │ номики)       │  депо  │ зитария,      │ зитария,      │ зитария,      │ зитария,      │ зитария,      │ ванного депо- │                    │ нерезидента)       │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │(клиринговых) │  ограничено  │      на      │              │               │ по ОКСМ│ регистратора) │ регистратора) │ регистратора) │ регистратора) │ регистратора) │ зитария,      │                    │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │ счетах депо  │   в связи с  │осуществление │              │               │        │               │               │               │               │               │ регистратора) │                    │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │корпоративными│   операций   │              │               │        │               │               │               │               │               │               │                    │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │  действиями  │              │              │               │        │               │               │               │               │               │               │                    │                    │                                 │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┼─────────────────────────────────┤");
        print("│  1   │      2       │       3       │       4       │        5         │       6       │         7         │          8          │           9           │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12       │        13        │      14      │      15      │      16      │      17      │      18      │      19      │      20       │   21   │      22       │      23       │      24       │      25       │      26       │      27       │         28         │         29         │                30               │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┼─────────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("СВ_ОКМС").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("НРезДатаВыдачиЛицензии").current,
                         current.fieldValue("НРезКемВыданаЛицензия").current
                        );
    end;

    private macro constructorTSubpart12TableView_I5456()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 16, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 17, AL_RIGHT);
        m_table.addColumn( "8", 19, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 16, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
        m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 13, AL_RIGHT);
        m_table.addColumn("21",  6, AL_RIGHT);
        m_table.addColumn("22", 13, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 13, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 13, AL_RIGHT);
        m_table.addColumn("27", 13, AL_RIGHT);
        m_table.addColumn("28", 18, AL_RIGHT);
        m_table.addColumn("29", 18, AL_RIGHT);
        m_table.addColumn("30", 31, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I5456();
end;

class (TSubpart12TableView_I5456) TSubpart12TableView_I5986()
    var ErrArr = TArray();

    macro CheckError(err_ogrn)
      var errstr = "";

      for(errstr, ErrArr)
        if (errstr == err_ogrn)
          return true;
        end;
      end;
      return false;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬────────────────────┬────────────────────┬─────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │  Код страны   │    Тип ценной     │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Информация о  │  Код   │ Наименование  │ Признак орга- │ ИНН организа- │ ОГРН органи-  │  Код страны   │ Номер лицензии     │ Дата выдачи лицен- │ Лицензирующий орган, выдавший   │");
        print("│строки│ эмитента     │               │                  │   эмитента    │ бумаги (вид финан-│   номер (идентифи-  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │                            и (или) ограничение распоряжения, шт.                        │владельце счета│ страны │ организации   │ низации (вы-  │ ции (вышесто- │ зации (выше-  │  организации  │ организации (выше- │ зии на право осу-  │ лицензию на право осуществления │");
        print("│      │              │               │                  │   по ОКСМ     │ сового инструмен- │   кационный номер)  │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("│ открытого в   │ ценных           ├──────────────┬──────────────────────────────────────────────────────────────────────────┤ (счета депо), │  вла-  │ (вышестоящего │ шестоящего    │ ящего депози- │ стоящего де-  │ (вышестоящего │ стоящего депозита- │ ществления учета   │ учета и перехода прав на ценные │");
        print("│      │              │               │                  │               │  та)              │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │     всего    │                                 из них                                   │ (код принад-  │ дельца │ депозитария,  │ депозитария,  │ тария,        │ позитария,    │ депозитария,  │ рия, спезиализиро- │ и перехода прав на │ бумаги (для организации-        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ специализиро- │ шт.              │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ лежности к    │ счета  │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ ванного депозита-  │ ценные бумаги (для │ нерезидента)                    │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ ванном        │                  │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ под арестом  │ сектору эко-  │  депо  │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ рия, регистратора) │ организации-       │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ депозитарии   │                  │              │              │ на торговых  │   которыми   │введен запрет │              │ номики)       │по ОКСМ │ зитария,      │ зитария,      │ зитария,      │ зитария,      │ зитария,      │                    │ нерезидента)       │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │(клиринговых) │  ограничено  │      на      │              │               │        │ регистратора) │ регистратора) │ регистратора) │ регистратора) │ регистратора) │                    │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │ счетах депо  │   в связи с  │осуществление │              │               │        │               │               │               │               │   по ОКСМ     │                    │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │корпоративными│   операций   │              │               │        │               │               │               │               │               │                    │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │  действиями  │              │              │               │        │               │               │               │               │               │                    │                    │                                 │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┼─────────────────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │          7          │           8           │     9      │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12       │        13        │      14      │      15      │      16      │      17      │      18      │      19      │      20       │   21   │      22       │      23       │      24       │      25       │      26       │         27         │         28         │                29               │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼────────────────────┼────────────────────┼─────────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         current.fieldValue("КоличествоПоСчету").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("СВ_ОКМС").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("НРезДатаВыдачиЛицензии").current,
                         current.fieldValue("НРезКемВыданаЛицензия").current
                        );
    end;

    private macro constructorTSubpart12TableView_I5986()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 16, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
        m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 13, AL_RIGHT);
        m_table.addColumn("21",  6, AL_RIGHT);
        m_table.addColumn("22", 13, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 13, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 13, AL_RIGHT);
        m_table.addColumn("27", 18, AL_RIGHT);
        m_table.addColumn("28", 18, AL_RIGHT);
        m_table.addColumn("29", 31, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I5986();
end;

class (TSubpart12TableView_I5986) TSubpart12TableView_I6406()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │  Код страны   │    Тип ценной     │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │         Количество ценных бумаг, в отношении которых зафиксировано обременение                         │ Информация о  │  Код   │ Наименование  │ Признак орга- │ ИНН организа- │ ОГРН органи-  │  Код страны   │");
        print("│строки│ эмитента     │               │                  │   эмитента    │ бумаги (вид финан-│   номер (идентифи-  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │                            и (или) ограничение распоряжения, шт.                                       │владельце счета│ страны │ организации   │ низации (вы-  │ ции (вышесто- │ зации (выше-  │  организации  │");
        print("│      │              │               │                  │   по ОКСМ     │ сового инструмен- │   кационный номер)  │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("│ открытого в   │ ценных           ├──────────────┬─────────────────────────────────────────────────────────────────────────────────────────┤ (счета депо), │  вла-  │ (вышестоящего │ шестоящего    │ ящего депози- │ стоящего де-  │ (вышестоящего │");
        print("│      │              │               │                  │               │  та)              │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │     всего    │                                 из них                                                  │ (код принад-  │ дельца │ депозитария,  │ депозитария,  │ тария,        │ позитария,    │ депозитария,  │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ специализиро- │ шт.              │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ лежности к    │ счета  │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ специализиро- │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ ванном        │                  │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ учитываемых  │ под арестом  │ сектору эко-  │  депо  │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ депозитарии   │                  │              │              │ на торговых  │   которыми   │введен запрет │на счетах депо│              │ номики)       │по ОКСМ │ зитария,      │ зитария,      │ зитария,      │ зитария,      │ зитария,      │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │(клиринговых) │  ограничено  │      на      │эскроу-агента │              │               │        │ регистратора) │ регистратора) │ регистратора) │ регистратора) │ регистратора) │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │ счетах депо  │   в связи с  │осуществление │              │              │               │        │               │               │               │               │   по ОКСМ     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │корпоративными│   операций   │              │              │               │        │               │               │               │               │               │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │  действиями  │              │              │              │               │        │               │               │               │               │               │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │          7          │           8           │     9      │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12       │        13        │      14      │      15      │      16      │      17      │      18      │      19      │      20      │      21       │   22   │      23       │      24       │      25       │      26       │      27       │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         string(current.fieldValue("КоличествоПоСчету").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("СВ_ОКМС").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current
                        );
    end;

    private macro constructorTSubpart12TableView_I6406()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 16, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
		m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 13, AL_RIGHT);
        m_table.addColumn("22",  6, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 13, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 13, AL_RIGHT);
        m_table.addColumn("27", 13, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I6406();
end;

class (TSubpart12TableView_I6406) TSubpart12TableView_I6800()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────┬──────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │  Код страны   │    Тип ценной     │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Вид счета     │ Количе-          │         Количество ценных бумаг, в отношении которых зафиксировано обременение                                                       │ Информация о  │  Код   │ Наименование  │ Признак орга- │ ИНН организа- │ ОГРН органи-  │  Код страны   │      Примечание       │");
        print("│строки│ эмитента     │               │                  │   эмитента    │ бумаги (вид финан-│   номер (идентифи-  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ (счета депо)  │ ство             │                            и (или) ограничение распоряжения, шт.                                                                     │владельце счета│ страны │ организации   │ низации (вы-  │ ции (вышесто- │ зации (выше-  │  организации  │                       │");
        print("│      │              │               │                  │   по ОКСМ     │ сового инструмен- │   кационный номер)  │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("│ открытого в   │ ценных           ├──────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ (счета депо), │  вла-  │ (вышестоящего │ шестоящего    │ ящего депози- │ стоящего де-  │ (вышестоящего │                       │");
        print("│      │              │               │                  │               │  та)              │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ депозитарии,  │ бумаг,           │     всего    │                                 из них                                                                                │ (код принад-  │ дельца │ депозитария,  │ депозитария,  │ тария,        │ позитария,    │ депозитария,  │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ специализиро- │ шт.              │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ лежности к    │ счета  │ специализиро- │ специализиро- │ специализиро- │ специализиро- │ специализиро- │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ ванном        │                  │              │   в залоге   │ учитываемых  │ распоряжение │  по которым  │ учитываемых  │ учет которых │ учет которых │ под арестом  │ сектору эко-  │  депо  │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │ ванного депо- │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ депозитарии   │                  │              │              │ на торговых  │   которыми   │введен запрет │на счетах депо│ обособлен на │ обособлен на │              │ номики)       │по ОКСМ │ зитария,      │ зитария,      │ зитария,      │ зитария,      │ зитария,      │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │(клиринговых) │  ограничено  │      на      │эскроу-агента │  основании   │  основании   │              │               │        │ регистратора) │ регистратора) │ регистратора) │ регистратора) │ регистратора) │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │ счетах депо  │   в связи с  │осуществление │              │ федеральных  │ предписаний  │              │               │        │               │               │               │               │   по ОКСМ     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │корпоративными│   операций   │              │законов и нор-│ (требований) │              │               │        │               │               │               │               │               │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │  действиями  │              │              │мативных актах│ Банка России │              │               │        │               │               │               │               │               │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │              │              │              │  Российской  │              │              │               │        │               │               │               │               │               │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│               │                  │              │              │              │              │              │              │   федерации  │              │              │               │        │               │               │               │               │               │                       │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │          7          │           8           │     9      │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12       │        13        │      14      │      15      │      16      │      17      │      18      │      19      │      20      │      21      │      22      │      23       │   24   │      25       │      26       │      27       │      28       │      29       │           30          │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼───────────────┼──────────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ВидСчётаДепо").current,
                         string(current.fieldValue("КоличествоПоСчету").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособФЗ").current != $0.0, string(current.fieldValue("ОбособФЗ").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособТреб").current != $0.0, string(current.fieldValue("ОбособТреб").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("Владелец_СекторЭкономики").current,
                         current.fieldValue("СВ_ОКМС").current,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("Примечание").current
                        );
    end;

    private macro constructorTSubpart12TableView_I6800()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 13, AL_RIGHT);
        m_table.addColumn("13", 16, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 12, AL_RIGHT);
        m_table.addColumn("16", 12, AL_RIGHT);
        m_table.addColumn("17", 12, AL_RIGHT);
        m_table.addColumn("18", 12, AL_RIGHT);
		m_table.addColumn("19", 12, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24",  6, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 13, AL_RIGHT);
        m_table.addColumn("27", 13, AL_RIGHT);
        m_table.addColumn("28", 13, AL_RIGHT);
        m_table.addColumn("29", 13, AL_RIGHT);
        m_table.addColumn("30", 21, AL_RIGHT);
    end;

    constructorTSubpart12TableView_I6800();
end;

/**
 * раздел 1.2.1
 */
class (TSubpart12TableView_I5456) TSubpart121TableView_I5456()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Регистрационный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Объем (количество) проведенных операций с  │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │    номер выпуска    │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│ учитываемыми ценными бумагами, штук        │");
        print("│      │              │               │               │                  │ эмитента      │                   │     ценных бумаг    │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("┼──────────────┬──────────────┬──────────────┤");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│ прием ценных │ снятие       │ перевод      │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│ бумаг на     │ ценных бумаг │ между        │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("номинала    ");printFillRight(" ");println("│ хранение и   │ с хранения и │ счетами депо │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│ учет         │ учета        │ в депозитари │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┤");
        print("│  1   │      2       │       3       │       4       │        5         │       6       │         7         │          8          │           9           │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12      │      13      │      14      │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;
                                  
        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ПриемЦБ").current,
                         current.fieldValue("СнятиеЦБ").current,
                         current.fieldValue("ПереводЦБ").current
                        );
    end;

    private macro constructorTSubpart121TableView_I5456()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2_1", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 16, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 17, AL_RIGHT);
        m_table.addColumn( "8", 19, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
    end;

    constructorTSubpart121TableView_I5456();
end;

/**
 * раздел 1.2.1
 */
class (TSubpart12TableView_I5986) TSubpart121TableView_I5986()

    macro CheckError(err_ogrn)
      var errstr = "";

      for(errstr, ErrArr)
        if (errstr == err_ogrn)
          return true;
        end;
      end;
      return false;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │ Код страны    │ Тип ценной бумаги │   Регистрационный   │       Код ISIN        │     Код    │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Объем (количество) проведенных операций с учитываемыми │");
        print("│строки│ эмитента     │               │                  │ эмитента по   │ (вид финансового  │  номер (идентифи-   │     ценной бумаги     │     CFI    │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│              ценными бумагами, шт.                     │");
        print("│      │              │               │                  │    ОКСМ       │    инструмента)   │  кационный номер)   │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("┼──────────────────┬──────────────────┬──────────────────┤");
        print("│      │              │               │                  │               │                   │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│   прием ценных   │   снятие         │   перевод        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   бумаг на       │   ценных бумаг   │   между          │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   хранение и     │   с хранения и   │   счетами депо   │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   учет           │   учета          │   в депозитари   │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("┼─────────┬────────┼─────────┬────────┼─────────┬────────┤");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("| Количе- │  Объ-  │ Количе- │  Объ-  │ Количе- │  Объ-  │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("|ство опе-│   ем   │ство опе-│   ем   │ство опе-│   ем   │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("|  раций  │        │  раций  │        │  раций  │        │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼─────────┼────────┼─────────┼────────┼─────────┼────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │          7          │           8           │      9     │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│    12   │   13   │    14   │   15   │    16   │   17   │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼─────────┼────────┼─────────┼────────┼─────────┼────────┤");
    end;


    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;
                                  
        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ПриемЦБКоличество").current,
                         current.fieldValue("ПриемЦБОбъем").current,
                         current.fieldValue("СнятиеЦБКоличество").current,
                         current.fieldValue("СнятиеЦБОбъем").current,
                         current.fieldValue("ПереводЦБКоличество").current,
                         current.fieldValue("ПереводЦБОбъем").current
                        );
    end;

    private macro constructorTSubpart121TableView_I5986()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2_1", "ЦБНоминал", 4, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 7, AL_RIGHT);
        m_table.addColumn("13", 7, AL_RIGHT);
        m_table.addColumn("14", 7, AL_RIGHT);
        m_table.addColumn("15", 7, AL_RIGHT);
        m_table.addColumn("16", 7, AL_RIGHT);
        m_table.addColumn("17", 7, AL_RIGHT);
    end;

    constructorTSubpart121TableView_I5986();
end;


class (TSubpart121TableView_I5986) TSubpart121TableView_I6800()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬───────────────────────────────────────────────────────────┬───────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │ Код страны    │ Тип ценной бумаги │   Регистрационный   │       Код ISIN        │     Код    │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Объем (количество) проведенных операций с учитываемыми    │       Примечание      │");
        print("│строки│ эмитента     │               │                  │ эмитента по   │ (вид финансового  │  номер выпуска      │     ценной бумаги     │     CFI    │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│              ценными бумагами, шт.                        │                       │");
        print("│      │              │               │                  │    ОКСМ       │    инструмента)   │                     │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("┼───────────────────┬───────────────────┬───────────────────┤                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│   прием ценных    │   снятие          │   перевод         │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   бумаг на        │   ценных бумаг    │   между           │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   хранение и      │   с хранения и    │   счетами депо    │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│   учет            │   учета           │   в депозитари    │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("┼─────────┬─────────┼─────────┬─────────┼─────────┬─────────┤                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("| Количе- │   Объ-  │ Количе- │  Объ-   │ Количе- │  Объ-   │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("|ство опе-│    ем   │ство опе-│   ем    │ство опе-│   ем    │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("|  раций  │         │  раций  │         │  раций  │         │                       │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │          7          │           8           │      9     │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│    12   │    13   │    14   │   15    │    16   │    17   │           18          │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current   = dataSource.currentItem;
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);

        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;
                                  
        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("ПриемЦБКоличество").current,
                         current.fieldValue("ПриемЦБОбъем").current,
                         current.fieldValue("СнятиеЦБКоличество").current,
                         current.fieldValue("СнятиеЦБОбъем").current,
                         current.fieldValue("ПереводЦБКоличество").current,
                         current.fieldValue("ПереводЦБОбъем").current,
                         current.fieldValue("Примечание").current
                        );
    end;

    private macro constructor()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_2_1", "ЦБНоминал", "ЦБНоминалТочность", 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12",  7, AL_RIGHT);
        m_table.addColumn("13",  7, AL_RIGHT);
        m_table.addColumn("14",  7, AL_RIGHT);
        m_table.addColumn("15",  7, AL_RIGHT);
        m_table.addColumn("16",  7, AL_RIGHT);
        m_table.addColumn("17",  7, AL_RIGHT);
        m_table.addColumn("18", 21, AL_RIGHT);
    end;

    constructor();
end;

class (TSubpart112TableView_I2055) TSubpart13TableView_I3129()

    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬──────────────┬──────────────┬────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Номер государст-    │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Ценные бумаги, принадлежащие кредитной организации на праве собственности                                                                           │ Количество ценных бумаг на иных счетах кредитной    │ Наименование  │ Признак    │ ИНН органи-  │ КПП органи-  │ ОГРН органи- │ Код ОКСМ     │ Номер лицензии │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ венной регистрации  │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ организации (штук), в том числе                     │ организации,  │ организа-  │ зации, веду- │ зации, веду- │ зации, веду- │ страны орга- │ профессиональ- │");
        print("│      │              │               │               │                  │ эмитента      │                   │ ценной бумаги       │                       │ маги       │");printFillLeft(" ");print("ценной бума-");printFillRight(" ");println("│ Количество   │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют по счетам основного баланса, штук                   │                                                     │ ведущей учет  │ ции, веду- │ щей учет     │ щей учет     │  щей учет    │ низации,     │ ного участника │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ги, ед. ва- ");printFillRight(" ");println("│ ценных бу-   │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬──────────────┬────────────┤ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │ прав кредит- │ ведущей учет │ рынка ценных   │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("люты обяза- ");printFillRight(" ");println("│ маг , всего, │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения, которые  │ ошибочно зачисленные на   │ по другим │ на счетах  │ на казна-  │ на счетах    │ на эмисси- │ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │ ной органи-  │ прав кредит- │ бумаг - депо-  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│ штук         │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ депо дове- │ чейских    │ залогодержа- │ онных сче- │ зации на      │ дитной ор- │ зации на     │ зации на     │ зации на     │ ной органи-  │ зитария,       │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ жены на счетах  │ воначального │               │                        │ ными долгами       │ ции                       │           │ рительного │ счетах де- │ теля         │ тах        │ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │ ценные бума- │ зации на     │ спецдепозита-  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основного ба-   │ признания по │               │                        │                    │                           │           │ управляю-  │ по эмитен- │              │            │ ги            │ на ценные  │ ги           │ ги           │ ги           │ ценные бума- │ рия, регистра- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ланса (за ис-   │ сделке РЕПО  │               │                        │                    │                           │           │ щего       │ та         │              │            │               │ бумаги     │              │              │              │ ги           │ тора           │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ключением пере- │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ данных кредит-  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной организаци- │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ей на возврат-  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной основе без  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление, в   │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ заклад)         │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
        print("│  50  │      51      │       52      │       53      │        54        │      55       │        56         │         57          │           58          │     59     │");printFillLeft(" ");print("     60     ");printFillRight(" ");println("│      61      │       62        │      63      │      64       │          65            │         66         │            67             │    68     │     69     │     70     │     71       │     72     │      73       │     74     │      75      │      76      │      77      │      78      │       79       │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

//        var faceValue = convertZero(truncZero(current.fieldValue("ЦБНоминал").exact));
        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("СвоиЦБ_Всего").currentAsString,
                         current.fieldValue("СвоиЦБ_ОснБаланс").currentAsString,
                         current.fieldValue("СвоиЦБ_РЕПО_БПП").currentAsString,
                         current.fieldValue("СвоиЦБ_Займ").currentAsString,
                         current.fieldValue("СвоиЦБ_ОбязОтсутств").currentAsString,
                         current.fieldValue("СвоиЦБ_Безнадежн").currentAsString,
                         current.fieldValue("СвоиЦБ_ЗачислОшибочно").currentAsString,
                         current.fieldValue("СвоиЦБ_ИныеПричины").currentAsString,
                         current.fieldValue("СвоиЦБ_ДУ").currentAsString,
                         current.fieldValue("СвоиЦБ_КазнСчета").currentAsString,
                         current.fieldValue("СвоиЦБ_Залог").currentAsString,
                         current.fieldValue("СвоиЦБ_Эмисс").currentAsString,
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current
                        );
    end;

    private macro constructorTSubpart13TableView_I3129()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("50", 4,  AL_CENTER);
        m_table.addColumn("51", 12,  AL_RIGHT);
        m_table.addColumn("52", 13, AL_RIGHT);
        m_table.addColumn("53", 13, AL_RIGHT);
        m_table.addColumn("54", 16, AL_RIGHT);
        m_table.addColumn("55", 13, AL_RIGHT);
        m_table.addColumn("56", 17, AL_RIGHT);
        m_table.addColumn("57", 19, AL_RIGHT);
        m_table.addColumn("58", 21, AL_RIGHT);
        m_table.addColumn("59", 10, AL_RIGHT);
        m_table.addColumn("60", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("61", 12, AL_RIGHT);
        m_table.addColumn("62", 15, AL_RIGHT);
        m_table.addColumn("63", 12, AL_RIGHT);
        m_table.addColumn("64", 13, AL_RIGHT);
        m_table.addColumn("65", 22, AL_RIGHT);
        m_table.addColumn("66", 18, AL_RIGHT);
        m_table.addColumn("67", 25, AL_RIGHT);
        m_table.addColumn("68", 9,  AL_RIGHT);
        m_table.addColumn("69", 10, AL_RIGHT);
        m_table.addColumn("70", 10, AL_RIGHT);
        m_table.addColumn("71", 12, AL_RIGHT);
        m_table.addColumn("72", 10, AL_RIGHT);
        m_table.addColumn("73", 13, AL_RIGHT);
        m_table.addColumn("74", 10, AL_RIGHT);
        m_table.addColumn("75", 12, AL_RIGHT);
        m_table.addColumn("76", 12, AL_RIGHT);
        m_table.addColumn("77", 12, AL_RIGHT);
        m_table.addColumn("78", 12, AL_RIGHT);
        m_table.addColumn("79", 14, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I3129();
end;

class (TSubpart13TableView_I3129) TSubpart13TableView_I4212()

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬──────────────┬──────────────┬────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Государственный     │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Ценные бумаги, принадлежащие кредитной организации на праве собственности                                                                           │ Количество ценных бумаг на иных счетах кредитной    │ Наименование  │ Признак    │ ИНН органи-  │ КПП органи-  │ ОГРН органи- │ Код ОКСМ     │ Номер лицензии │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ регистрационный     │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ организации (шт.), в том числе                      │ организации,  │ организа-  │ зации, веду- │ зации, веду- │ зации, веду- │ страны орга- │ профессиональ- │");
        print("│      │              │               │               │                  │ эмитента      │                   │ номер выпуска       │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│ Количество   │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют по счетам основного баланса, штук                   │                                                     │ ведущей учет  │ ции, веду- │ щей учет     │ щей учет     │  щей учет    │ низации,     │ ного участника │");
        print("│      │              │               │               │                  │               │                   │ ценных бумаг или    │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│ ценных бу-   │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬──────────────┬────────────┤ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │ прав кредит- │ ведущей учет │ рынка ценных   │");
        print("│      │              │               │               │                  │               │                   │ идентификационный   │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│ маг, всего,  │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения, которые  │ ошибочно зачисленные на   │ по другим │ на счетах  │ на казна-  │ полученных   │ на эмисси- │ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │ ной органи-  │ прав кредит- │ бумаг - депо-  │");
        print("│      │              │               │               │                  │               │                   │ номер выпуска       │                       │            │");printFillLeft(" ");print("обяза-      ");printFillRight(" ");println("│ шт.          │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ депо дове- │ чейских    │ в заклад     │ онных сче- │ зации на      │ дитной ор- │ зации на     │ зации на     │ зации на     │ ной органи-  │ зитария,       │");
        print("│      │              │               │               │                  │               │                   │ ценных бумаг        │                       │            │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│              │ жены на счетах  │ воначального │               │                        │ ными долгами       │ ции                       │           │ рительного │ счетах де- │              │ тах        │ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │ ценные бума- │ зации на     │ спецдепозита-  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основного ба-   │ признания по │               │                        │                    │                           │           │ управляю-  │ по эмитен- │              │            │ ги            │ на ценные  │ ги           │ ги           │ ги           │ ценные бума- │ рия, регистра- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ланса (за ис-   │ сделке РЕПО  │               │                        │                    │                           │           │ щего       │ та         │              │            │               │ бумаги     │              │              │              │ ги           │ тора           │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ключением пере- │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ данных кредит-  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной организаци- │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ей на возврат-  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной основе без  │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление, в   │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ заклад)         │              │               │                        │                    │                           │           │            │            │              │            │               │            │              │              │              │              │                │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
        print("│  63  │      64      │       65      │       66      │        67        │      68       │        69         │         70          │           71          │     72     │");printFillLeft(" ");print("     73     ");printFillRight(" ");println("│      74      │       75        │      76      │      77       │          78            │         79         │            80             │    81     │     82     │     83     │     84       │     85     │      86       │     87     │      88      │      89      │      90      │      91      │       92       │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
    end;

    private macro constructorTSubpart13TableView_I4212()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("63", 4,  AL_CENTER);
        m_table.addColumn("64", 12, AL_RIGHT);
        m_table.addColumn("65", 13, AL_RIGHT);
        m_table.addColumn("66", 13, AL_RIGHT);
        m_table.addColumn("67", 16, AL_RIGHT);
        m_table.addColumn("68", 13, AL_RIGHT);
        m_table.addColumn("69", 17, AL_RIGHT);
        m_table.addColumn("70", 19, AL_RIGHT);
        m_table.addColumn("71", 21, AL_RIGHT);
        m_table.addColumn("72", 10, AL_RIGHT);
        m_table.addColumn("73", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("74", 12, AL_RIGHT);
        m_table.addColumn("75", 15, AL_RIGHT);
        m_table.addColumn("76", 12, AL_RIGHT);
        m_table.addColumn("77", 13, AL_RIGHT);
        m_table.addColumn("78", 22, AL_RIGHT);
        m_table.addColumn("79", 18, AL_RIGHT);
        m_table.addColumn("80", 25, AL_RIGHT);
        m_table.addColumn("81", 9,  AL_RIGHT);
        m_table.addColumn("82", 10, AL_RIGHT);
        m_table.addColumn("83", 10, AL_RIGHT);
        m_table.addColumn("84", 12, AL_RIGHT);
        m_table.addColumn("85", 10, AL_RIGHT);
        m_table.addColumn("86", 13, AL_RIGHT);
        m_table.addColumn("87", 10, AL_RIGHT);
        m_table.addColumn("88", 12, AL_RIGHT);
        m_table.addColumn("89", 12, AL_RIGHT);
        m_table.addColumn("90", 12, AL_RIGHT);
        m_table.addColumn("91", 12, AL_RIGHT);
        m_table.addColumn("92", 14, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I4212();
end;

class (TSubpart13TableView_I4212) TSubpart13TableView_I4637()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬──────────────┬──────────────┬────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │ Государственный     │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Ценные бумаги, принадлежащие кредитной организации на праве собственности                                                                           │ Количество ценных бумаг на счетах кредитной         │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование  │ Признак    │ ИНН органи-  │ КПП органи-  │ ОГРН органи- │ Код ОКСМ     │ Номер лицензии │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ регистрационный     │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ организации (шт.), в том числе                      │                            и (или) ограничение распоряжения, шт.                        │ организации,  │ организа-  │ зации, веду- │ зации, веду- │ зации, веду- │ страны орга- │ профессиональ- │");
        print("│      │              │               │               │                  │ эмитента      │                   │ номер выпуска       │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│ Количество   │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют по счетам основного баланса                         │                                                     │                                                                                         │ ведущей учет  │ ции, веду- │ щей учет     │ щей учет     │  щей учет    │ низации,     │ ного участника │");
        print("│      │              │               │               │                  │               │                   │ ценных бумаг или    │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│ ценных бу-   │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬──────────────┬────────────├──────────────┬──────────────────────────────────────────────────────────────────────────┤ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │ прав кредит- │ ведущей учет │ рынка ценных   │");
        print("│      │              │               │               │                  │               │                   │ идентификационный   │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│ маг, всего,  │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения, которые  │ ошибочно зачисленные на   │ по другим │ на счетах  │ на казна-  │ полученных   │ на эмисси- │     всего    │                                 из них                                   │ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │ ной органи-  │ прав кредит- │ бумаг - депо-  │");
        print("│      │              │               │               │                  │               │                   │ номер выпуска       │                       │            │");printFillLeft(" ");print("обяза-      ");printFillRight(" ");println("│ шт.          │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ депо дове- │ чейских    │ в заклад     │ онных сче- │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────│ зации на      │ дитной ор- │ зации на     │ зации на     │ зации на     │ ной органи-  │ зитария,       │");
        print("│      │              │               │               │                  │               │                   │ ценных бумаг        │                       │            │");printFillLeft(" ");print("тельства    ");printFillRight(" ");println("│              │ жены на счетах  │ воначального │               │                        │ ными долгами       │ ции                       │           │ рительного │ счетах эми-│              │ тах        │              │   в залоге   │ учитываемых  │  ограничено  │введен запрет │ под арестом  │ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │ ценные бума- │ зации на     │ спецдепозита-  │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основного ба-   │ признания по │               │                        │                    │                           │           │ управляю-  │ тента      │              │            │              │              │ на торговых  │ распоряжение │      на      │              │ ги            │ на ценные  │ ги           │ ги           │ ги           │ ценные бума- │ рия, регистра- │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ланса (за ис-   │ сделке РЕПО  │               │                        │                    │                           │           │ щего       │            │              │            │              │              │(клиринговых) │  в связи с   │осуществление │              │               │ бумаги     │              │              │              │ ги           │ тора           │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ключением пере- │              │               │                        │                    │                           │           │            │            │              │            │              │              │ счетах депо  │корпоративными│   операций   │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ данных кредит-  │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │  действиями  │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной организаци- │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ей на возврат-  │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ной основе без  │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление, в   │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ заклад)         │              │               │                        │                    │                           │           │            │            │              │            │              │              │              │              │              │              │               │            │              │              │              │              │                │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
        print("│  63  │      64      │       65      │       66      │        67        │      68       │        69         │         70          │           71          │     72     │");printFillLeft(" ");print("     73     ");printFillRight(" ");println("│      74      │       75        │      76      │      77       │          78            │         79         │            80             │    81     │     82     │     83     │     84       │     85     │      86      │      87      │      88      │      89      │      90      │      91      │      92       │     93     │      94      │      95      │      96      │      97      │       98       │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼──────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("СвоиЦБ_Всего").currentAsString,
                         current.fieldValue("СвоиЦБ_ОснБаланс").currentAsString,
                         current.fieldValue("СвоиЦБ_РЕПО_БПП").currentAsString,
                         current.fieldValue("СвоиЦБ_Займ").currentAsString,
                         current.fieldValue("СвоиЦБ_ОбязОтсутств").currentAsString,
                         current.fieldValue("СвоиЦБ_Безнадежн").currentAsString,
                         current.fieldValue("СвоиЦБ_ЗачислОшибочно").currentAsString,
                         current.fieldValue("СвоиЦБ_ИныеПричины").currentAsString,
                         current.fieldValue("СвоиЦБ_ДУ").currentAsString,
                         current.fieldValue("СвоиЦБ_КазнСчета").currentAsString,
                         current.fieldValue("СвоиЦБ_Залог").currentAsString,
                         current.fieldValue("СвоиЦБ_Эмисс").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current
                        );
    end;

    private macro constructorTSubpart13TableView_I4637()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("63", 4,  AL_CENTER);
        m_table.addColumn("64", 12, AL_RIGHT);
        m_table.addColumn("65", 13, AL_RIGHT);
        m_table.addColumn("66", 13, AL_RIGHT);
        m_table.addColumn("67", 16, AL_RIGHT);
        m_table.addColumn("68", 13, AL_RIGHT);
        m_table.addColumn("69", 17, AL_RIGHT);
        m_table.addColumn("70", 19, AL_RIGHT);
        m_table.addColumn("71", 21, AL_RIGHT);
        m_table.addColumn("72", 10, AL_RIGHT);
        m_table.addColumn("73", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("74", 12, AL_RIGHT);
        m_table.addColumn("75", 15, AL_RIGHT);
        m_table.addColumn("76", 12, AL_RIGHT);
        m_table.addColumn("77", 13, AL_RIGHT);
        m_table.addColumn("78", 22, AL_RIGHT);
        m_table.addColumn("79", 18, AL_RIGHT);
        m_table.addColumn("80", 25, AL_RIGHT);
        m_table.addColumn("81", 9,  AL_RIGHT);
        m_table.addColumn("82", 10, AL_RIGHT);
        m_table.addColumn("83", 10, AL_RIGHT);
        m_table.addColumn("84", 12, AL_RIGHT);
        m_table.addColumn("85", 10, AL_RIGHT);
        m_table.addColumn("86", 12, AL_RIGHT);
        m_table.addColumn("87", 12, AL_RIGHT);
        m_table.addColumn("88", 12, AL_RIGHT);
        m_table.addColumn("89", 12, AL_RIGHT);
        m_table.addColumn("90", 12, AL_RIGHT);
        m_table.addColumn("91", 12, AL_RIGHT);
        m_table.addColumn("92", 13, AL_RIGHT);
        m_table.addColumn("93", 10, AL_RIGHT);
        m_table.addColumn("94", 12, AL_RIGHT);
        m_table.addColumn("95", 12, AL_RIGHT);
        m_table.addColumn("96", 12, AL_RIGHT);
        m_table.addColumn("97", 12, AL_RIGHT);
        m_table.addColumn("98", 14, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I4637();
end;

class (TSubpart13TableView_I4637) TSubpart13TableView_I5456()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬──────────────┬─────────────────────┬────────────────┬────────────────────┬─────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ КПП эмитента  │  ОГРН эмитента   │ Код ОКСМ      │     Код типа      │   Регистрационный   │       Код ISIN        │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг, принадлежащих кредитной организации на праве собственности (за исключением переданных в доверительное управление)          │ Количество ценных бумаг на счетах    │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование  │ Признак    │ ИНН органи-  │ КПП органи-  │ ОГРН органи- │ Код страны организа-│ Номер лицензии │ Дата выдачи лицен- │ Лицензирующий орган, выдавший   │");
        print("│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │    номер выпуска    │     ценной бумаги     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ кредитной организации (шт.),         │                            и (или) ограничение распоряжения, шт.                        │ организации,  │ организа-  │ зации, веду- │ зации, веду- │ зации, веду- │  ции, ведущей учет  │ депозитария,   │ зии на право осу-  │ лицензию на право осуществления │");
        print("│      │              │               │               │                  │ эмитента      │                   │    ценных бумаг     │                       │ маги       │");printFillLeft(" ");print("одной ценной");printFillRight(" ");println("│ всего, шт.   │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют на балансовых счетах                                │ в том числе                          │                                                                                         │ ведущей учет  │ ции, веду- │ щей учет     │ щей учет     │  щей учет    │ прав кредитной орга-│ специализиро-  │ ществления учета   │ учета и перехода прав на ценные │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("бумаги,     ");printFillRight(" ");println("│              │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬────────────├──────────────┬──────────────────────────────────────────────────────────────────────────┤ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │ прав кредит- │  низации на ценные  │ ванного депо-  │ и перехода прав на │ бумаги (для организации-        │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("ед. валюты  ");printFillRight(" ");println("│              │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения в которые │ ошибочно зачисленных на   │ по другим │ на счетах  │ на казна-  │ на эмисси- │     всего    │                                 из них                                   │ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │ ной органи-  │    бумаги по ОКСМ   │ зитария,       │ ценные бумаги (для │ нерезидента)                    │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("номинала    ");printFillRight(" ");println("│              │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ доверитель-│ чейских    │ онных сче- │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────│ зации на      │ дитной ор- │ зации на     │ зации на     │ зации на     │                     │ регистратора   │ организации-       │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ жены на балансо-│ воначального │               │                        │ ными долгами       │ ции                       │           │ ного управ-│ счетах эми-│ тах        │              │   в залоге   │ учитываемых  │ распоряжение │ по которым   │ под арестом  │ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │ ценные бума- │                     │                │ нерезидента)       │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ вых счетах (за  │ признания по │               │                        │                    │                           │           │ ляющего    │ тента      │            │              │              │ на торговых  │   которыми   │введен запрет │              │ ги            │ на ценные  │ ги           │ ги           │ ги           │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ исключением     │ сделке репо  │               │                        │                    │                           │           │            │            │            │              │              │(клиринговых) │  ограничено  │      на      │              │               │ бумаги     │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ переданных      │              │               │                        │                    │                           │           │            │            │            │              │              │ счетах депо  │  в связи с   │осуществление │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной       │              │               │                        │                    │                           │           │            │            │            │              │              │              │корпоративными│   операций   │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ организацией на │              │               │                        │                    │                           │           │            │            │            │              │              │              │  действиями  │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ возвратной      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основе без      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление) а   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ также закладные,│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ принадлежащие   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной орга- │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ низации на праве│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("│      │              │               │               │                  │               │                   │                     │                       │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ собственности   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │              │                     │                │                    │                                 │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼─────────────────────┼────────────────┼────────────────────┼─────────────────────────────────┤");
        print("│  1   │      2       │       3       │       4       │        5         │       6       │         7         │         8           │           9           │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12      │       13        │      14      │      15       │          16            │         17         │            18             │    19     │     20     │     21     │     22     │      23      │      24      │      25      │      26      │      27      │      28      │      29       │     30     │      31      │      32      │      33      │          34         │       35       │         36         │                37               │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼──────────────┼─────────────────────┼────────────────┼────────────────────┼─────────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("СвоиЦБ_Всего").currentAsString,
                         current.fieldValue("СвоиЦБ_ОснБаланс").currentAsString,
                         current.fieldValue("СвоиЦБ_РЕПО_БПП").currentAsString,
                         current.fieldValue("СвоиЦБ_Займ").currentAsString,
                         current.fieldValue("СвоиЦБ_ОбязОтсутств").currentAsString,
                         current.fieldValue("СвоиЦБ_Безнадежн").currentAsString,
                         current.fieldValue("СвоиЦБ_ЗачислОшибочно").currentAsString,
                         current.fieldValue("СвоиЦБ_ИныеПричины").currentAsString,
                         current.fieldValue("СвоиЦБ_ДУ").currentAsString,
                         current.fieldValue("СвоиЦБ_КазнСчета").currentAsString,
                         current.fieldValue("СвоиЦБ_Эмисс").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХКПП").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("НРезДатаВыдачиЛицензии").current,
                         current.fieldValue("НРезКемВыданаЛицензия").current
                        );
    end;

    private macro constructorTSubpart13TableView_I5456()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 16, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 17, AL_RIGHT);
        m_table.addColumn( "8", 19, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 15, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 13, AL_RIGHT);
        m_table.addColumn("16", 22, AL_RIGHT);
        m_table.addColumn("17", 18, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19",  9, AL_RIGHT);
        m_table.addColumn("20", 10, AL_RIGHT);
        m_table.addColumn("21", 10, AL_RIGHT);
        m_table.addColumn("22", 10, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 12, AL_RIGHT);
        m_table.addColumn("27", 12, AL_RIGHT);
        m_table.addColumn("28", 12, AL_RIGHT);
        m_table.addColumn("29", 13, AL_RIGHT);
        m_table.addColumn("30", 10, AL_RIGHT);
        m_table.addColumn("31", 12, AL_RIGHT);
        m_table.addColumn("32", 12, AL_RIGHT);
        m_table.addColumn("33", 12, AL_RIGHT);
        m_table.addColumn("34", 12, AL_RIGHT);
        m_table.addColumn("35", 14, AL_RIGHT);
        m_table.addColumn("36", 18, AL_RIGHT);
        m_table.addColumn("37", 31, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I5456();
end;


class (TSubpart13TableView_I5456) TSubpart13TableView_I5986()
    var ErrArr = TArray();

    macro CheckError(err_ogrn)
      var errstr = "";

      for(errstr, ErrArr)
        if (errstr == err_ogrn)
          return true;
        end;
      end;
      return false;
    end;
	
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬─────────────────────┬────────────────┬────────────────────┬─────────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │ Код страны    │ Тип ценной бумаги │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг, принадлежащих кредитной организации на праве собственности (за исключением переданных кредитной организацией на возвратной │ Количество ценных бумаг на счетах    │         Количество ценных бумаг, в отношении которых зафиксировано обременение          │ Наименование  │ Признак    │ ИНН органи-  │ ОГРН органи- │ Код страны организа-│ Номер лицензии │ Дата выдачи лицен- │ Лицензирующий орган, выдавший   │");
        print("│строки│ эмитента     │               │                  │ эмитента      │ (вид финансового  │ номер (идентифика-  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│                                     основе без прекращения признания, в доверительное управление)                                                   │ кредитной организации (шт.),         │                            и (или) ограничение распоряжения, шт.                        │ организации,  │ организа-  │ зации, веду- │ зации, веду- │   ции, ведущей учет │ депозитария,   │ зии на право осу-  │ лицензию на право осуществления │");
        print("│      │              │               │                  │ по ОКСМ       │    инструмента)   │   ционный номер)    │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ в том числе                          │                                                                                         │ ведущей учет  │ ции, веду- │ щей учет     │  щей учет    │ прав кредитной орга-│ специализиро-  │ ществления учета   │ учета и перехода прав на ценные │");
        print("│      │              │               │                  │               │                   │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ всего, шт.   │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют на балансовых счетах                                │                                      │                                                                                         │ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │  низации на ценные  │ ванного депо-  │ и перехода прав на │ бумаги (для организации-        │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬────────────├──────────────┬──────────────────────────────────────────────────────────────────────────┤ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │    бумаги по ОКСМ   │ зитария,       │ ценные бумаги (для │ нерезидента)                    │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения в которые │ ошибочно зачисленных на   │ по другим │ на счетах  │ на казна-  │ на эмисси- │     всего    │                                 из них                                   │ зации на      │ дитной ор- │ зации на     │ зации на     │                     │ регистратора   │ организации-       │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ доверитель-│ чейских    │ онных сче- │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────│ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │                     │                │ нерезидента)       │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ жены на балансо-│ воначального │               │                        │ ными долгами       │ ции                       │           │ ного управ-│ счетах эми-│ тах        │              │   в залоге   │ учитываемых  │ распоряжение │ по которым   │ под арестом  │ ги            │ на ценные  │ ги           │ ги           │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ вых счетах (за  │ признания по │               │                        │                    │                           │           │ ляющего    │ тента      │            │              │              │ на торговых  │   которыми   │введен запрет │              │               │ бумаги     │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ исключением     │ сделке репо  │               │                        │                    │                           │           │            │            │            │              │              │(клиринговых) │  ограничено  │      на      │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ переданных      │              │               │                        │                    │                           │           │            │            │            │              │              │ счетах депо  │  в связи с   │осуществление │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной       │              │               │                        │                    │                           │           │            │            │            │              │              │              │корпоративными│   операций   │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ организацией на │              │               │                        │                    │                           │           │            │            │            │              │              │              │  действиями  │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ возвратной      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основе без      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление) а   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ также закладные,│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ принадлежащие   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной орга- │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ низации на праве│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ собственности   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │               │            │              │              │                     │                │                    │                                 │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┼────────────────┼────────────────────┼─────────────────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │         7           │           8           │      9     │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12      │       13        │      14      │      15       │          16            │         17         │            18             │    19     │     20     │     21     │     22     │      23      │      24      │      25      │      26      │      27      │      28      │      29       │     30     │      31      │      32      │          33         │       34       │         35         │                36               │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┼────────────────┼────────────────────┼─────────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         current.fieldValue("СвоиЦБ_Всего").currentAsString,
                         current.fieldValue("СвоиЦБ_ОснБаланс").currentAsString,
                         current.fieldValue("СвоиЦБ_РЕПО_БПП").currentAsString,
                         current.fieldValue("СвоиЦБ_Займ").currentAsString,
                         current.fieldValue("СвоиЦБ_ОбязОтсутств").currentAsString,
                         current.fieldValue("СвоиЦБ_Безнадежн").currentAsString,
                         current.fieldValue("СвоиЦБ_ЗачислОшибочно").currentAsString,
                         current.fieldValue("СвоиЦБ_ИныеПричины").currentAsString,
                         current.fieldValue("СвоиЦБ_ДУ").currentAsString,
                         current.fieldValue("СвоиЦБ_КазнСчета").currentAsString,
                         current.fieldValue("СвоиЦБ_Эмисс").currentAsString,
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, current.fieldValue("ВсегоОбрем").currentAsString, ""),
                         ternary(current.fieldValue("Залог").current != $0.0, current.fieldValue("Залог").currentAsString, ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, current.fieldValue("ТогрСчета").currentAsString, ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, current.fieldValue("ОгранКД").currentAsString, ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, current.fieldValue("ЗапретОпер").currentAsString, ""),
                         ternary(current.fieldValue("Арест").current != $0.0, current.fieldValue("Арест").currentAsString, ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("МХНомерЛицензии").current,
                         current.fieldValue("НРезДатаВыдачиЛицензии").current,
                         current.fieldValue("НРезКемВыданаЛицензия").current
                        );
    end;

    private macro constructorTSubpart13TableView_I5986()
        initTPartView();
		

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 15, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 13, AL_RIGHT);
        m_table.addColumn("16", 22, AL_RIGHT);
        m_table.addColumn("17", 18, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19",  9, AL_RIGHT);
        m_table.addColumn("20", 10, AL_RIGHT);
        m_table.addColumn("21", 10, AL_RIGHT);
        m_table.addColumn("22", 10, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 12, AL_RIGHT);
        m_table.addColumn("27", 12, AL_RIGHT);
        m_table.addColumn("28", 12, AL_RIGHT);
        m_table.addColumn("29", 13, AL_RIGHT);
        m_table.addColumn("30", 10, AL_RIGHT);
        m_table.addColumn("31", 12, AL_RIGHT);
        m_table.addColumn("32", 12, AL_RIGHT);
        m_table.addColumn("33", 12, AL_RIGHT);
        m_table.addColumn("34", 14, AL_RIGHT);
        m_table.addColumn("35", 18, AL_RIGHT);
        m_table.addColumn("36", 31, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I5986();
end;

class (TSubpart13TableView_I5986) TSubpart13TableView_I6406()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬─────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │ Код страны    │ Тип ценной бумаги │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│   Количество ценных бумаг, принадлежащих кредитной организации на праве собственности (за исключением переданных кредитной организацией на возвратной      │ Количество ценных бумаг на счетах          │                      Количество ценных бумаг, в отношении которых зафиксировано обременение                          │ Наименование  │ Признак    │ ИНН органи-  │ ОГРН органи- │ Код страны организа-│");
        print("│строки│ эмитента     │               │                  │ эмитента      │ (вид финансового  │ номер (идентифика-  │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│                                       основе без прекращения признания, в доверительное управление)                                                        │ кредитной организации (шт.),               │                                     и (или) ограничение распоряжения, штук                                           │ организации,  │ организа-  │ зации, веду- │ зации, веду- │   ции, ведущей учет │");
        print("│      │              │               │                  │ по ОКСМ       │    инструмента)   │   ционный номер)    │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("├────────────────┬─────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ в том числе                                │                                                                                                                      │ ведущей учет  │ ции, веду- │ щей учет     │  щей учет    │ прав кредитной орга-│");
        print("│      │              │               │                  │               │                   │      выпуска        │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ всего, штук    │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют на балансовых счетах                                     │                                            │                                                                                                                      │ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │  низации на ценные  │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬────────────────┼──────────────┬──────────────┬──────────────├────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────┤ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │    бумаги по ОКСМ   │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения в которые │ ошибочно зачисленных на   │   по другим    │  на счетах   │  на казна-   │  на эмисси-  │      всего     │                                              из них                                                 │ зации на      │ дитной ор- │ зации на     │ зации на     │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │   причинам     │  доверитель- │  чейских     │  онных сче-  │                ├────────────────┬────────────────┬────────────────┬────────────────┬────────────────┬────────────────│ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ жены на балансо-│ воначального │               │                        │ ными долгами       │ ции                       │                │  ного управ- │  счетах      │  тах         │                │    в залоге    │  учитываемых   │  распоряжение  │  по которым    │  учитываемых   │  под арестом   │ ги            │ на ценные  │ ги           │ ги           │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ вых счетах (за  │ признания по │               │                        │                    │                           │                │  ляющего     │              │              │                │                │  на торговых   │    которыми    │ введен запрет  │   на лицевых   │                │               │ бумаги     │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ исключением     │ сделке репо  │               │                        │                    │                           │                │              │              │              │                │                │ (клиринговых)  │   ограничено   │       на       │    счетах      │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ переданных      │              │               │                        │                    │                           │                │              │              │              │                │                │  счетах депо   │   в связи с    │ осуществление  │ (счетах депо)  │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ кредитной       │              │               │                        │                    │                           │                │              │              │              │                │                │                │ корпоративными │    операций    │ эскроу-агента  │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ организацией на │              │               │                        │                    │                           │                │              │              │              │                │                │                │   действиями   │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ возвратной      │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ основе без      │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ прекращения     │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ признания, в    │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ доверительное   │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ управление) а   │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ также закладные,│              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ принадлежащие   │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ кредитной орга- │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ низации на праве│              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                │ собственности   │              │               │                        │                    │                           │                │              │              │              │                │                │                │                │                │                │                │               │            │              │              │                     │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼────────────────┼──────────────┼──────────────┼──────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │         7           │           8           │      9     │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12        │       13        │      14      │      15       │          16            │         17         │            18             │       19       │      20      │      21      │      22      │       23       │       24       │       25       │       26       │       27       │       28       │       29       │      30       │     31     │      32      │      33      │          34         │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼────────────────┼──────────────┼──────────────┼──────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼────────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;
		
        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         string(current.fieldValue("СвоиЦБ_Всего").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ОснБаланс").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_РЕПО_БПП").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Займ").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ОбязОтсутств").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Безнадежн").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ЗачислОшибочно").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ИныеПричины").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ДУ").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_КазнСчета").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Эмисс").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current
                        );
    end;

    private macro constructorTSubpart13TableView_I6406()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 14, AL_RIGHT);
        m_table.addColumn("13", 15, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 13, AL_RIGHT);
        m_table.addColumn("16", 22, AL_RIGHT);
        m_table.addColumn("17", 18, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19", 14, AL_RIGHT);
        m_table.addColumn("20", 12, AL_RIGHT);
        m_table.addColumn("21", 12, AL_RIGHT);
        m_table.addColumn("22", 12, AL_RIGHT);
        m_table.addColumn("23", 14, AL_RIGHT);
        m_table.addColumn("24", 14, AL_RIGHT);
        m_table.addColumn("25", 14, AL_RIGHT);
        m_table.addColumn("26", 14, AL_RIGHT);
        m_table.addColumn("27", 14, AL_RIGHT);
        m_table.addColumn("28", 14, AL_RIGHT);
		m_table.addColumn("29", 14, AL_RIGHT);
        m_table.addColumn("30", 13, AL_RIGHT);
        m_table.addColumn("31", 10, AL_RIGHT);
        m_table.addColumn("32", 12, AL_RIGHT);
        m_table.addColumn("33", 12, AL_RIGHT);
        m_table.addColumn("34", 19, AL_RIGHT);
    end;

    constructorTSubpart13TableView_I6406();
end;

class (TSubpart13TableView_I6406) TSubpart13TableView_I6800()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────┬────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬────────────┬──────────────┬──────────────┬─────────────────────┬───────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │  ОГРН эмитента   │ Код страны    │ Тип ценной бумаги │   Регистрационный   │       Код ISIN        │    Код     │ Код валюты │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");println("│ Количество ценных бумаг, принадлежащих кредитной организации на праве собственности (за исключением переданных кредитной организацией на возвратной │ Количество ценных бумаг на счетах    │         Количество ценных бумаг, в отношении которых зафиксировано обременение                                                       │ Наименование  │ Признак    │ ИНН органи-  │ ОГРН органи- │ Код страны организа-│       Примечание      │");
        print("│строки│ эмитента     │               │                  │ эмитента      │ (вид финансового  │ номер выпуска       │     ценной бумаги     │    CFI     │ ценной бу- │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");println("│                                     основе без прекращения признания, в доверительное управление)                                                   │ кредитной организации (штук),        │                            и (или) ограничение распоряжения, штук                                                                    │ организации,  │ организа-  │ зации, веду- │ зации, веду- │   ции, ведущей учет │                       │");
        print("│      │              │               │                  │ по ОКСМ       │    инструмента)   │                     │                       │            │ маги       │");printFillLeft(" ");print("ценной      ");printFillRight(" ");println("├──────────────┬─────────────────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ в том числе                          │                                                                                                                                      │ ведущей учет  │ ции, веду- │ щей учет     │  щей учет    │ прав кредитной орга-│                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");println("│ всего, штук  │ из них количе-  │ из них количество ценных бумаг, вложения в которые отсутствуют на балансовых счетах                                │                                      │                                                                                                                                      │ прав кредит-  │ щей учет   │ прав кредит- │ прав кредит- │  низации на ценные  │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ ство ценных     ├──────────────┬───────────────┬────────────────────────┬────────────────────┬───────────────────────────┬───────────┼────────────┬────────────┬────────────├──────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤ ной органи-   │ прав кре-  │ ной органи-  │ ной органи-  │    бумаги по ОКСМ   │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ бумаг, вложения │ приобретен-  │ полученных по │ обязательства по кото- │ вложения в которые │ ошибочно зачисленных на   │ по другим │ на счетах  │ на казна-  │ на эмисси- │     всего    │                                 из них                                                                                │ зации на      │ дитной ор- │ зации на     │ зации на     │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ в которые отра- │ ных без пер- │ сделкам займа │ рым отсутствуют        │ признаны безнадеж- │ счета кредитной организа- │ причинам  │ доверитель-│ чейских    │ онных сче- │              ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤ ценные бума-  │ ганизации  │ ценные бума- │ ценные бума- │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ жены на балансо-│ воначального │               │                        │ ными долгами       │ ции                       │           │ ного управ-│ счетах эми-│ тах        │              │   в залоге   │ учитываемых  │ распоряжение │ по которым   │ учитываемых  │ учет которых │ учет которых │ под арестом  │ ги            │ на ценные  │ ги           │ ги           │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ вых счетах (за  │ признания по │               │                        │                    │                           │           │ ляющего    │ тента      │            │              │              │ на торговых  │   которыми   │введен запрет │ на лицевых   │ обособлен на │ обособлен на │              │               │ бумаги     │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ исключением     │ сделке репо  │               │                        │                    │                           │           │            │            │            │              │              │(клиринговых) │  ограничено  │      на      │ счетах(счетах│ основании фе-│ основании    │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ переданных      │              │               │                        │                    │                           │           │            │            │            │              │              │ счетах депо  │  в связи с   │осуществление │ депо) эскроу-│ деральных за-│ предписаний  │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной       │              │               │                        │                    │                           │           │            │            │            │              │              │              │корпоративными│   операций   │    агента    │ конов и нор- │ (требований) │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ организацией на │              │               │                        │                    │                           │           │            │            │            │              │              │              │  действиями  │              │              │ мативных пра-│ Банка России │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ возвратной      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │ вовых актов  │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ основе без      │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │ Российской   │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ прекращения     │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │ Федерации    │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ признания, в    │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ доверительное   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ управление) а   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ также закладные,│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ принадлежащие   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ кредитной орга- │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ низации на праве│              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("│      │              │               │                  │               │                   │                     │                       │            │            │");printFillLeft(" ");print("            ");printFillRight(" ");println("│              │ собственности   │              │               │                        │                    │                           │           │            │            │            │              │              │              │              │              │              │              │              │              │               │            │              │              │                     │                       │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┼───────────────────────┤");
        print("│  1   │      2       │       3       │        4         │       5       │         6         │         7           │           8           │      9     │     10     │");printFillLeft(" ");print("     11     ");printFillRight(" ");println("│      12      │       13        │      14      │      15       │          16            │         17         │            18             │    19     │     20     │     21     │     22     │      23      │      24      │      25      │      26      │      27      │      28      │      29      │      30      │      31      │      32       │     33     │      34      │      35      │          36         │           37          │");
        print("├──────┼──────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────┼────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼──────────────┼─────────────────┼──────────────┼───────────────┼────────────────────────┼────────────────────┼───────────────────────────┼───────────┼────────────┼────────────┼────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼───────────────┼────────────┼──────────────┼──────────────┼─────────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;
      
        var err_ogrn = current.fieldValue("ОшибкаНетОГРН").currentAsString;
        if ((err_ogrn != NULL) and (err_ogrn != "") and (err_ogrn != "\n"))
          if(valType(ErrArr) == V_UNDEF)
            ErrArr = TArray();
          end;
          if(not CheckError(err_ogrn))
            var oldOutput = setoutput( ИмяФайлаПротокола, true);
            println(err_ogrn);
            setOutput(oldOutput, true);
            ErrArr[ErrArr.size] = err_ogrn;
          end;
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         faceValue,
                         string(current.fieldValue("СвоиЦБ_Всего").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ОснБаланс").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_РЕПО_БПП").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Займ").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ОбязОтсутств").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Безнадежн").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ЗачислОшибочно").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ИныеПричины").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_ДУ").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_КазнСчета").current : * : *, 38, 20),
                         string(current.fieldValue("СвоиЦБ_Эмисс").current : * : *, 38, 20),
                         ternary(current.fieldValue("ВсегоОбрем").current != $0.0, string(current.fieldValue("ВсегоОбрем").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Залог").current != $0.0, string(current.fieldValue("Залог").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ТогрСчета").current != $0.0, string(current.fieldValue("ТогрСчета").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОгранКД").current != $0.0, string(current.fieldValue("ОгранКД").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ЗапретОпер").current != $0.0, string(current.fieldValue("ЗапретОпер").current : * : *, 38, 20), ""),
						 ternary(current.fieldValue("ЦБЭскроуАгента").current != $0.0, string(current.fieldValue("ЦБЭскроуАгента").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособФЗ").current != $0.0, string(current.fieldValue("ОбособФЗ").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("ОбособТреб").current != $0.0, string(current.fieldValue("ОбособТреб").current : * : *, 38, 20), ""),
                         ternary(current.fieldValue("Арест").current != $0.0, string(current.fieldValue("Арест").current : * : *, 38, 20), ""),
                         current.fieldValue("МХНаименование").current,
                         current.fieldValue("МХПризнак").current,
                         current.fieldValue("МХИНН").current,
                         current.fieldValue("МХОГРН").current,
                         current.fieldValue("МХОКСМ").current,
                         current.fieldValue("Примечание").current
                        );
    end;

    private macro constructor()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_3", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 16, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 17, AL_RIGHT);
        m_table.addColumn( "7", 19, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 10, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("12", 12, AL_RIGHT);
        m_table.addColumn("13", 15, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15", 13, AL_RIGHT);
        m_table.addColumn("16", 22, AL_RIGHT);
        m_table.addColumn("17", 18, AL_RIGHT);
        m_table.addColumn("18", 25, AL_RIGHT);
        m_table.addColumn("19",  9, AL_RIGHT);
        m_table.addColumn("20", 10, AL_RIGHT);
        m_table.addColumn("21", 10, AL_RIGHT);
        m_table.addColumn("22", 10, AL_RIGHT);
        m_table.addColumn("23", 12, AL_RIGHT);
        m_table.addColumn("24", 12, AL_RIGHT);
        m_table.addColumn("25", 12, AL_RIGHT);
        m_table.addColumn("26", 12, AL_RIGHT);
        m_table.addColumn("27", 12, AL_RIGHT);
        m_table.addColumn("28", 12, AL_RIGHT);
        m_table.addColumn("29", 12, AL_RIGHT);
        m_table.addColumn("30", 12, AL_RIGHT);
        m_table.addColumn("31", 12, AL_RIGHT);
        m_table.addColumn("32", 13, AL_RIGHT);
        m_table.addColumn("33", 10, AL_RIGHT);
        m_table.addColumn("34", 12, AL_RIGHT);
        m_table.addColumn("35", 12, AL_RIGHT);
        m_table.addColumn("36", 19, AL_RIGHT);
        m_table.addColumn("37", 21, AL_RIGHT);
    end;

    constructor();
end;


class (TSubpart112TableView_I2055) TSubpart14TableView_I3129()

    macro printHeader()
        [┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬─────────────────────┬───────────────────────┬────────────────────────────┐];
        [│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │  КПП эмитента    │ Код ОКСМ      │     Код типа      │ Номер государст-    │       Код ISIN        │ Объем вложений в ценные    │];
        [│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ венной регистрации  │     ценной бумаги     │ бумаги в валюте Российской │];
        [│      │              │               │               │                  │ эмитента      │                   │ ценной бумаги       │                       │ Федерации,                 │];
        [│      │              │               │               │                  │               │                   │                     │                       │ тыс. руб.                  │];
        [├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────────────────────┤];
        [│  80  │      81      │      82       │      83       │        84        │      85       │        86         │         87          │          88           │            89              │];
        [├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼─────────────────────┼───────────────────────┼────────────────────────────┤];
    end;

    private macro configureDataSource(dataSource : Object) : Object
        return dataSource;
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и ПТК ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4));
    end;

    private macro constructorTSubpart14TableView_I3129()
        initTPartView();

        m_table.addColumn("80", 4,  AL_CENTER);
        m_table.addColumn("81", 12, AL_RIGHT);
        m_table.addColumn("82", 13, AL_RIGHT);
        m_table.addColumn("83", 13, AL_RIGHT);
        m_table.addColumn("84", 16, AL_RIGHT);
        m_table.addColumn("85", 13, AL_RIGHT);
        m_table.addColumn("86", 17, AL_RIGHT);
        m_table.addColumn("87", 19, AL_RIGHT);
        m_table.addColumn("88", 21, AL_RIGHT);
        m_table.addColumn("89", 26, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I3129();
end;

class (TSubpart14TableView_I3129) TSubpart14TableView_I4212()

    macro printHeader()
        [┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────────────────────┬─────────────┐];
        [│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │  КПП эмитента    │ Код ОКСМ      │     Код типа      │    Государственный    │       Код ISIN        │ Объем вложений в ценные    │    Номер    │];
        [│строки│ эмитента     │               │               │                  │ страны        │  ценной бумаги    │ регистрационный номер │     ценной бумаги     │ бумаги в валюте Российской │ балансового │];
        [│      │              │               │               │                  │ эмитента      │                   │ выпуска ценных бумаг  │                       │ Федерации,                 │    счета    │];
        [│      │              │               │               │                  │               │                   │ или идентификационный │                       │ тыс. руб.                  │   второго   │];
        [│      │              │               │               │                  │               │                   │     номер выпуска     │                       │                            │   порядка   │];
        [│      │              │               │               │                  │               │                   │     ценных бумаг      │                       │                            │             │];
        [├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────────────────────┼─────────────┤];
        [│  93  │      94      │      95       │      96       │        97        │      98       │        99         │          100          │          101          │            102             │     103     │];
        [├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────────────────────┼─────────────┤];
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и ПТК ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current);
    end;

    private macro constructorTSubpart14TableView_I4212()
        initTPartView();

        m_table.addColumn( "93",  4, AL_CENTER);
        m_table.addColumn( "94", 12, AL_RIGHT);
        m_table.addColumn( "95", 13, AL_RIGHT);
        m_table.addColumn( "96", 13, AL_RIGHT);
        m_table.addColumn( "97", 16, AL_RIGHT);
        m_table.addColumn( "98", 13, AL_RIGHT);
        m_table.addColumn( "99", 17, AL_RIGHT);
        m_table.addColumn("100", 21, AL_RIGHT);
        m_table.addColumn("101", 21, AL_RIGHT);
        m_table.addColumn("102", 26, AL_RIGHT);
        m_table.addColumn("103", 11, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I4212();
end;

class (TSubpart14TableView_I4212) TSubpart14TableView_I4637()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────┬──────────────────┬");printFillLeft("─");print("────────────");printFillRight("─");print("┬────────────────────────────┬─────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │  КПП эмитента    │ Код ОКСМ      │ Код вида      │     Код типа      │    Государственный    │       Код ISIN        │ Код валюты │ Количе-          │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");print("│ Балансовая стоимость       │    Номер    │");printFillLeft(" ");print("Накопленный ");printFillRight(" ");println("│ Переоценка ценных бумаг -  │ Переоценка ценных бумаг -  │ Уровень исходных данных    │ Категория качества         │ Сформированный резерв      │");
        print("│строки│ эмитента     │               │               │                  │ страны        │ деятельности  │  ценной бумаги    │ регистрационный номер │     ценной бумаги     │ ценной бу- │ ство             │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");print("│ ценных бумаг, тыс. руб.    │ балансового │");printFillLeft(" ");print("купонный    ");printFillRight(" ");println("│ отрицательная разница,     │ положительная разница,     │ в иерархии                 │                            │ на возможные потери        │");
        print("│      │              │               │               │                  │ эмитента      │ эмитента      │                   │ выпуска ценных бумаг  │                       │ маги       │ ценных           │");printFillLeft(" ");print("одной ценной");printFillRight(" ");print("│                            │    счета    │");printFillLeft(" ");print("доход, ед.  ");printFillRight(" ");println("│ тыс. руб.                  │ тыс. руб.                  │ справедливой стоимости     │                            │ тыс. руб.                  │");
        print("│      │              │               │               │                  │               │               │                   │ или идентификационный │                       │            │ бумаг,           │");printFillLeft(" ");print("бумаги, ед. ");printFillRight(" ");print("│                            │   второго   │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");println("│                            │                            │                            │                            │                            │");
        print("│      │              │               │               │                  │               │               │                   │     номер выпуска     │                       │            │ шт.              │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");print("│                            │   порядка   │");printFillLeft(" ");print("зательства  ");printFillRight(" ");println("│                            │                            │                            │                            │                            │");
        print("│      │              │               │               │                  │               │               │                   │     ценных бумаг      │                       │            │                  │");printFillLeft(" ");print("зательства  ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │                            │                            │                            │                            │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
        print("│  99  │      100     │      101      │      102      │        103       │      104      │      105      │        106        │          107          │          108          │     109    │       110        │");printFillLeft(" ");print("    111     ");printFillRight(" ");print("│            112             │     113     │");printFillLeft(" ");print("    114     ");printFillRight(" ");println("│            115             │            116             │            117             │            118             │            119             │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var aciValue = convertZero(current.fieldValue("НКД").exact);
        if (valType(aciValue) != V_STRING)
            aciValue = string(aciValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЭмитентОКВЭД").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         current.fieldValue("КоличествоЦБ").currentAsString,
                         faceValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current,
                         aciValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ОтрицПереоценка").current / 1000 : 0 : *, 4),
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ПоложПереоценка").current / 1000 : 0 : *, 4),
                         current.fieldValue("УровеньИДвиерархииСС").current,
                         current.fieldValue("КатКачества").current,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Резерв").current / 1000 : 0 : *, 4)
                        );
    end;

    private macro constructorTSubpart14TableView_I4637()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_4", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("99",  4, AL_CENTER);
        m_table.addColumn("100", 12, AL_RIGHT);
        m_table.addColumn("101", 13, AL_RIGHT);
        m_table.addColumn("102", 13, AL_RIGHT);
        m_table.addColumn("103", 16, AL_RIGHT);
        m_table.addColumn("104", 13, AL_RIGHT);
        m_table.addColumn("105", 13, AL_RIGHT);
        m_table.addColumn("106", 17, AL_RIGHT);
        m_table.addColumn("107", 21, AL_RIGHT);
        m_table.addColumn("108", 21, AL_RIGHT);
        m_table.addColumn("109", 10, AL_RIGHT);
        m_table.addColumn("110", 16, AL_RIGHT);
        m_table.addColumn("111", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("112", 26, AL_RIGHT);
        m_table.addColumn("113", 11, AL_RIGHT);
        m_table.addColumn("114", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("115", 26, AL_RIGHT);
        m_table.addColumn("116", 26, AL_RIGHT);
        m_table.addColumn("117", 26, AL_RIGHT);
        m_table.addColumn("118", 26, AL_RIGHT);
        m_table.addColumn("119", 26, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I4637();
end;

class (TSubpart14TableView_I4637) TSubpart14TableView_I4927()
    private macro convertZero(value)
        if (valType(value) == V_STRING)
            return ternary(value == "0", "", value);
        else
            return ternary(value == 0, "", value);
        end;
    end;

    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────┬──────────────────┬");printFillLeft("─");print("────────────");printFillRight("─");print("┬────────────────────────────┬─────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │  КПП эмитента    │ Код ОКСМ      │ Код вида      │     Код типа      │    Государственный    │       Код ISIN        │ Код валюты │ Количе-          │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");print("│  Стоимость ценных бумаг,   │    Номер    │");printFillLeft(" ");print("Накопленный ");printFillRight(" ");println("│  Переоценка ценных бумаг - │ Корректировка, увеличиваю- │ Уровень исходных данных    │ Категория качества         │ Сформированный резерв      │  Корректировка резерва на  │");
        print("│строки│ эмитента     │               │               │                  │ страны        │ деятельности  │  ценной бумаги    │ регистрационный номер │     ценной бумаги     │ ценной бу- │ ство             │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");print("│          тыс. руб.         │ балансового │");printFillLeft(" ");print("купонный    ");printFillRight(" ");println("│ отрицательная (положитель- │ щая(уменьщающая) стоимость │ в иерархии                 │                            │ на возможные потери        │     возможные потери до    │");
        print("│      │              │               │               │                  │ эмитента      │ эмитента      │                   │ выпуска ценных бумаг  │                       │ маги       │ ценных           │");printFillLeft(" ");print("одной ценной");printFillRight(" ");print("│                            │    счета    │");printFillLeft(" ");print("доход, ед.  ");printFillRight(" ");println("│   ная) разница, тыс. руб.  │ долговых ценных бумаг или  │ справедливой стоимости     │                            │ тыс. руб.                  │   оценочного резерва под   │");
        print("│      │              │               │               │                  │               │               │                   │ или идентификационный │                       │            │ бумаг,           │");printFillLeft(" ");print("бумаги, ед. ");printFillRight(" ");print("│                            │   второго   │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");println("│                            │ изменения справедливой сто-│                            │                            │                            │     ожидаемые кредитные    │");
        print("│      │              │               │               │                  │               │               │                   │     номер выпуска     │                       │            │ шт.              │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");print("│                            │   порядка   │");printFillLeft(" ");print("зательства  ");printFillRight(" ");println("│                            │ имости при первоначальном  │                            │                            │                            │       убытки, тыс. руб.    │");
        print("│      │              │               │               │                  │               │               │                   │     ценных бумаг      │                       │            │                  │");printFillLeft(" ");print("зательства  ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ признании долевых ценных   │                            │                            │                            │                            │");
        print("│      │              │               │               │                  │               │               │                   │                       │                       │            │                  │");printFillLeft(" ");print("            ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ бумаг,  тыс. руб.          │                            │                            │                            │                            │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
        print("│  99  │      100     │      101      │      102      │        103       │      104      │      105      │        106        │          107          │          108          │     109    │       110        │");printFillLeft(" ");print("    111     ");printFillRight(" ");print("│            112             │     113     │");printFillLeft(" ");print("    114     ");printFillRight(" ");println("│            115             │            116             │            117             │            118             │            119             │            120             │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var aciValue = convertZero(current.fieldValue("НКД").exact);
        if (valType(aciValue) != V_STRING)
            aciValue = string(aciValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЭмитентОКВЭД").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         current.fieldValue("КоличествоЦБ").currentAsString,
                         faceValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current,
                         aciValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ОтрицПоложПереоценка").current / 1000 : 0 : *, 4),
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Корр_СС_ПП").current / 1000 : 0 : *, 4),
                         current.fieldValue("УровеньИДвиерархииСС").current,
                         current.fieldValue("КатКачества").current,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Резерв").current / 1000 : 0 : *, 4),
                         string(current.fieldValue("Корр_резерва_ВП").current / 1000 : 0 : *, 4)
                        );
    end;

    private macro constructorTSubpart14TableView_I4927()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_4", "ЦБНоминал", 6, 12, true);

        m_table.addColumn("99",  4, AL_CENTER);
        m_table.addColumn("100", 12, AL_RIGHT);
        m_table.addColumn("101", 13, AL_RIGHT);
        m_table.addColumn("102", 13, AL_RIGHT);
        m_table.addColumn("103", 16, AL_RIGHT);
        m_table.addColumn("104", 13, AL_RIGHT);
        m_table.addColumn("105", 13, AL_RIGHT);
        m_table.addColumn("106", 17, AL_RIGHT);
        m_table.addColumn("107", 21, AL_RIGHT);
        m_table.addColumn("108", 21, AL_RIGHT);
        m_table.addColumn("109", 10, AL_RIGHT);
        m_table.addColumn("110", 16, AL_RIGHT);
        m_table.addColumn("111", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("112", 26, AL_RIGHT);
        m_table.addColumn("113", 11, AL_RIGHT);
        m_table.addColumn("114", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("115", 26, AL_RIGHT);
        m_table.addColumn("116", 26, AL_RIGHT);
        m_table.addColumn("117", 26, AL_RIGHT);
        m_table.addColumn("118", 26, AL_RIGHT);
        m_table.addColumn("119", 26, AL_RIGHT);
        m_table.addColumn("120", 26, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I4927();
end;

class (TSubpart14TableView_I4927) TSubpart14TableView_I5456()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬──────────────────┬───────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────┬──────────────────┬");printFillLeft("─");print("────────────");printFillRight("─");print("┬────────────────────────────┬─────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │  КПП эмитента    │ Код ОКСМ      │ Код вида      │     Код типа      │    Регистрационный    │       Код ISIN        │ Код валюты │ Количе-          │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");print("│  Стоимость ценных бумаг,   │    Номер    │");printFillLeft(" ");print("Накопленный ");printFillRight(" ");println("│  Переоценка ценных бумаг - │ Корректировка, увеличиваю- │ Уровень исходных данных    │ Категория качества         │ Расчетный резерв           │ Сформированный резерв      │  Корректировка резерва на  │");
        print("│строки│ эмитента     │               │               │                  │ страны        │ деятельности  │  ценной бумаги    │     номер выпуска     │     ценной бумаги     │ ценной бу- │ ство             │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");print("│          тыс. руб.         │ балансового │");printFillLeft(" ");print("купонный    ");printFillRight(" ");println("│ отрицательная (положитель- │ щая(уменьщающая) стоимость │ в иерархии                 │                            │ на возможные потери,       │ на возможные потери        │     возможные потери до    │");
        print("│      │              │               │               │                  │ эмитента      │ эмитента      │                   │      ценных бумаг     │                       │ маги       │ ценных           │");printFillLeft(" ");print("одной ценной");printFillRight(" ");print("│                            │    счета    │");printFillLeft(" ");print("доход, ед.  ");printFillRight(" ");println("│   ная) разница, тыс. руб.  │ долговых ценных бумаг или  │ справедливой стоимости     │                            │ процент                    │ тыс. руб.                  │   оценочного резерва под   │");
        print("│      │              │               │               │                  │               │               │                   │                       │                       │            │ бумаг,           │");printFillLeft(" ");print("бумаги, ед. ");printFillRight(" ");print("│                            │   второго   │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");println("│                            │ изменения справедливой сто-│                            │                            │                            │                            │     ожидаемые кредитные    │");
        print("│      │              │               │               │                  │               │               │                   │                       │                       │            │ шт.              │");printFillLeft(" ");print("валюты обя- ");printFillRight(" ");print("│                            │   порядка   │");printFillLeft(" ");print("зательства  ");printFillRight(" ");println("│                            │ имости при первоначальном  │                            │                            │                            │                            │       убытки, тыс. руб.    │");
        print("│      │              │               │               │                  │               │               │                   │                       │                       │            │                  │");printFillLeft(" ");print("зательства  ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ признании долевых ценных   │                            │                            │                            │                            │                            │");
        print("│      │              │               │               │                  │               │               │                   │                       │                       │            │                  │");printFillLeft(" ");print("            ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ бумаг,  тыс. руб.          │                            │                            │                            │                            │                            │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
        print("│  1   │       2      │       3       │       4       │         5        │       6       │       7       │         8         │           9           │          10           │     11     │       12         │");printFillLeft(" ");print("    13      ");printFillRight(" ");print("│             14             │     15      │");printFillLeft(" ");print("     16     ");printFillRight(" ");println("│             17             │             18             │             19             │             20             │             21             │             22             │             23             │");
        print("├──────┼──────────────┼───────────────┼───────────────┼──────────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var aciValue = convertZero(current.fieldValue("НКД").exact);
        if (valType(aciValue) != V_STRING)
            aciValue = string(aciValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентКПП").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЭмитентОКВЭД").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("ЦБВалюта").current,
                         current.fieldValue("КоличествоЦБ").currentAsString,
                         faceValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current,
                         aciValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ОтрицПоложПереоценка").current / 1000 : 0 : *, 4),
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Корр_СС_ПП").current / 1000 : 0 : *, 4),
                         current.fieldValue("УровеньИДвиерархииСС").current,
                         current.fieldValue("КатКачества").current,
                         current.fieldValue("РезервПроцент").currentAsString,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Резерв").current / 1000 : 0 : *, 4),
                         string(current.fieldValue("Корр_резерва_ВП").current / 1000 : 0 : *, 4)
                        );
    end;

    private macro constructorTSubpart14TableView_I5456()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_4", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 16, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 13, AL_RIGHT);
        m_table.addColumn( "8", 17, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 21, AL_RIGHT);
        m_table.addColumn("11", 10, AL_RIGHT);
        m_table.addColumn("12", 16, AL_RIGHT);
        m_table.addColumn("13", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("14", 26, AL_RIGHT);
        m_table.addColumn("15", 11, AL_RIGHT);
        m_table.addColumn("16", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("17", 26, AL_RIGHT);
        m_table.addColumn("18", 26, AL_RIGHT);
        m_table.addColumn("19", 26, AL_RIGHT);
        m_table.addColumn("20", 26, AL_RIGHT);
        m_table.addColumn("21", 26, AL_RIGHT);
        m_table.addColumn("22", 26, AL_RIGHT);
        m_table.addColumn("23", 26, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I5456();
end;

class (TSubpart14TableView_I5456) TSubpart14TableView_I5986()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────┬────────────┬──────────────────┬");printFillLeft("─");print("────────────");printFillRight("─");print("┬────────────────────────────┬─────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │ Код страны    │ Код вида      │ Тип ценной бумаги │   Регистрационный     │       Код ISIN        │    Код     │ Код валюты │ Количе-          │");printFillLeft(" ");print("Номинальная ");printFillRight(" ");print("│  Стоимость ценных бумаг,   │    Номер    │");printFillLeft(" ");print("Накопленный ");printFillRight(" ");println("│  Переоценка ценных бумаг - │ Корректировка, увеличиваю- │ Уровень исходных данных    │ Категория качества         │ Расчетный резерв           │ Сформированный резерв      │  Корректировка резерва на  │");
        print("│строки│ эмитента     │               │               │ эмитента      │ деятельности  │ (вид финансового  │    номер выпуска      │     ценной бумаги     │    CFI     │ ценной бу- │ ство             │");printFillLeft(" ");print("стоимость   ");printFillRight(" ");print("│          тыс. руб.         │ балансового │");printFillLeft(" ");print("купонный    ");printFillRight(" ");println("│ отрицательная (положитель- │ щая(уменьщающая) стоимость │ в иерархии                 │                            │ на возможные потери,       │ на возможные потери        │     возможные потери до    │");
        print("│      │              │               │               │ по ОКСМ       │ эмитента      │   инструмента)    │                       │                       │            │ маги       │ ценных           │");printFillLeft(" ");print("одной ценной");printFillRight(" ");print("│                            │    счета    │");printFillLeft(" ");print("доход, ед-  ");printFillRight(" ");println("│   ная) разница, тыс. руб.  │ долговых ценных бумаг, или │ справедливой стоимости     │                            │ в процентах                │ тыс. руб.                  │   оценочного резерва под   │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │ бумаг,           │");printFillLeft(" ");print("бумаги      ");printFillRight(" ");print("│                            │   второго   │");printFillLeft(" ");print("иниц валюты ");printFillRight(" ");println("│                            │ изменения справедливой сто-│                            │                            │                            │                            │     ожидаемые кредитные    │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │ штук             │");printFillLeft(" ");print("            ");printFillRight(" ");print("│                            │   порядка   │");printFillLeft(" ");print("номинала    ");printFillRight(" ");println("│                            │ имости при первоначальном  │                            │                            │                            │                            │       убытки, тыс. руб.    │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │                  │");printFillLeft(" ");print("            ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ признании долевых ценных   │                            │                            │                            │                            │                            │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │                  │");printFillLeft(" ");print("            ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ бумаг,  тыс. руб.          │                            │                            │                            │                            │                            │");
        print("├──────┼──────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
        print("│  1   │       2      │       3       │       4       │       5       │       6       │         7         │           8           │           9           │     10     │     11     │       12         │");printFillLeft(" ");print("     13     ");printFillRight(" ");print("│             14             │     15      │");printFillLeft(" ");print("     16     ");printFillRight(" ");println("│             17             │             18             │             19             │             20             │             21             │             22             │             23             │");
        print("├──────┼──────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼────────────┼──────────────────┼");printFillLeft("─");print("────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var aciValue = convertZero(current.fieldValue("НКД").exact);
        if (valType(aciValue) != V_STRING)
            aciValue = string(aciValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЭмитентОКВЭД").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         current.fieldValue("КоличествоЦБ").currentAsString,
                         faceValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current,
                         aciValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ОтрицПоложПереоценка").current / 1000 : 0 : *, 4),
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Корр_СС_ПП").current / 1000 : 0 : *, 4),
                         current.fieldValue("УровеньИДвиерархииСС").current,
                         current.fieldValue("КатКачества").current,
                         current.fieldValue("РезервПроцент").currentAsString,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Резерв").current / 1000 : 0 : *, 4),
                         string(current.fieldValue("Корр_резерва_ВП").current / 1000 : 0 : *, 4)
                        );
    end;

    private macro constructorTSubpart14TableView_I5986()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_4", "ЦБНоминал", 6, 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 17, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", 10, AL_RIGHT);
        m_table.addColumn("12", 16, AL_RIGHT);
        m_table.addColumn("13", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("14", 26, AL_RIGHT);
        m_table.addColumn("15", 11, AL_RIGHT);
        m_table.addColumn("16", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("17", 26, AL_RIGHT);
        m_table.addColumn("18", 26, AL_RIGHT);
        m_table.addColumn("19", 26, AL_RIGHT);
        m_table.addColumn("20", 26, AL_RIGHT);
        m_table.addColumn("21", 26, AL_RIGHT);
        m_table.addColumn("22", 26, AL_RIGHT);
        m_table.addColumn("23", 26, AL_RIGHT);
    end;

    constructorTSubpart14TableView_I5986();
end;

class (TSubpart14TableView_I5986) TSubpart14TableView_I6800()
    macro printHeader()
        print("┌──────┬──────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────────┬───────────────────────┬───────────────────────┬────────────┬────────────┬──────────────────┬");printFillLeft("─");print("─────────────");printFillRight("─");print("┬────────────────────────────┬─────────────┬");printFillLeft("─");print("────────────");printFillRight("─");println("┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬────────────────────────────┬───────────────────────┐");
        print("│Номер │ Наименование │ ИНН эмитента  │ ОГРН эмитента │ Код страны    │ Код вида      │ Тип ценной бумаги │    Регистрационный    │       Код ISIN        │    Код     │ Код валюты │ Количе-          │");printFillLeft(" ");print("Номинальная  ");printFillRight(" ");print("│  Стоимость ценных бумаг,   │    Номер    │");printFillLeft(" ");print("Накопленный ");printFillRight(" ");println("│  Переоценка ценных бумаг - │ Корректировка, увеличиваю- │ Уровень исходных данных    │ Категория качества         │ Расчетный резерв           │ Сформированный резерв      │  Корректировка резерва на  │       Примечание      │");
        print("│строки│ эмитента     │               │               │ эмитента      │ деятельности  │ (вид фининсового  │ номер (идентификаци-  │     ценной бумаги     │    CFI     │ ценной бу- │ ство             │");printFillLeft(" ");print("стоимость    ");printFillRight(" ");print("│          тыс. руб.         │ балансового │");printFillLeft(" ");print("купонный    ");printFillRight(" ");println("│ отрицательная (положитель- │ щая(уменьщающая) стоимость │ в иерархии                 │                            │ на возможные потери,       │ на возможные потери        │     возможные потери до    │                       │");
        print("│      │              │               │               │ по ОКСМ       │ эмитента      │   инструмента)    │  онный номер) выпуска │                       │            │ маги       │ ценных           │");printFillLeft(" ");print("ценной бумаги");printFillRight(" ");print("│                            │    счета    │");printFillLeft(" ");print("доход, ед-  ");printFillRight(" ");println("│   ная) разница, тыс. руб.  │ долговых ценных бумаг, или │ справедливой стоимости     │                            │ в процентах                │ тыс. руб.                  │   оценочного резерва под   │                       │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │ бумаг,           │");printFillLeft(" ");print("             ");printFillRight(" ");print("│                            │   второго   │");printFillLeft(" ");print("иниц валюты ");printFillRight(" ");println("│                            │ изменения справедливой сто-│                            │                            │                            │                            │     ожидаемые кредитные    │                       │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │ шт.              │");printFillLeft(" ");print("             ");printFillRight(" ");print("│                            │   порядка   │");printFillLeft(" ");print("номинала    ");printFillRight(" ");println("│                            │ имости при первоначальном  │                            │                            │                            │                            │       убытки, тыс. руб.    │                       │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │                  │");printFillLeft(" ");print("             ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ признании долевых ценных   │                            │                            │                            │                            │                            │                       │");
        print("│      │              │               │               │               │               │                   │                       │                       │            │            │                  │");printFillLeft(" ");print("             ");printFillRight(" ");print("│                            │             │");printFillLeft(" ");print("            ");printFillRight(" ");println("│                            │ бумаг,  тыс. руб.          │                            │                            │                            │                            │                            │                       │");
        print("├──────┼──────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼────────────┼──────────────────┼");printFillLeft("─");print("─────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼───────────────────────┤");
        print("│  1   │       2      │       3       │       4       │       5       │       6       │         7         │           8           │           9           │     10     │     11     │       12         │");printFillLeft(" ");print("     13      ");printFillRight(" ");print("│             14             │     15      │");printFillLeft(" ");print("     16     ");printFillRight(" ");println("│             17             │             18             │             19             │             20             │             21             │             22             │             23             │           24          │");
        print("├──────┼──────────────┼───────────────┼───────────────┼───────────────┼───────────────┼───────────────────┼───────────────────────┼───────────────────────┼────────────┼────────────┼──────────────────┼");printFillLeft("─");print("─────────────");printFillRight("─");print("┼────────────────────────────┼─────────────┼");printFillLeft("─");print("────────────");printFillRight("─");println("┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼────────────────────────────┼───────────────────────┤");
    end;

    private macro makeData(dataSource : Object) : Object
        var current = dataSource.currentItem;

        var faceValue = convertZero(current.fieldValue("ЦБНоминал").exact);
        if (valType(faceValue) != V_STRING)
            faceValue = string(faceValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        var aciValue = convertZero(current.fieldValue("НКД").exact);
        if (valType(aciValue) != V_STRING)
            aciValue = string(aciValue : 0 : *, int(current.fieldValue("ЦБНоминалТочность").exact));
        end;

        return arrCreate(current.fieldValue("counter").current,
                         current.fieldValue("ЭмитентНаименование").current,
                         current.fieldValue("ЭмитентИНН").current,
                         current.fieldValue("ЭмитентОГРН").current,
                         current.fieldValue("ЭмитентОКСМ").current,
                         current.fieldValue("ЭмитентОКВЭД").current,
                         current.fieldValue("ЦБКодТипа").current,
                         current.fieldValue("ЦБНомерГосРег").current,
                         current.fieldValue("ЦБISIN").current,
                         current.fieldValue("КодCFI").current,
                         current.fieldValue("ЦБВалюта").current,
                         current.fieldValue("КоличествоЦБ").currentAsString,
                         faceValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         // current.fieldValue("ОбъемВложений").current / 1000);
                         string(current.fieldValue("ОбъемВложений").current / 1000 : 0 : *, 4),
                         current.fieldValue("БалансСчет").current,
                         aciValue,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("ОтрицПоложПереоценка").current / 1000 : 0 : *, 4),
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Корр_СС_ПП").current / 1000 : 0 : *, 4),
                         current.fieldValue("УровеньИДвиерархииСС").current,
                         current.fieldValue("КатКачества").current,
                         current.fieldValue("РезервПроцент").currentAsString,
                         // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                         //                о соответствующих изменений в процедуре экспорта в kliko и АС ПСД
                         string(current.fieldValue("Резерв").current / 1000 : 0 : *, 4),
                         string(current.fieldValue("Корр_резерва_ВП").current / 1000 : 0 : *, 4),
                         current.fieldValue("Примечание").current
                        );
    end;

    private macro constructor()
        initTPartView();

        calcWidthColumnNominalSum("Ф711_Раздел1_Подраздел_1_4", "ЦБНоминал", "ЦБНоминалТочность", 12, true);

        m_table.addColumn( "1",  4, AL_CENTER);
        m_table.addColumn( "2", 12, AL_RIGHT);
        m_table.addColumn( "3", 13, AL_RIGHT);
        m_table.addColumn( "4", 13, AL_RIGHT);
        m_table.addColumn( "5", 13, AL_RIGHT);
        m_table.addColumn( "6", 13, AL_RIGHT);
        m_table.addColumn( "7", 17, AL_RIGHT);
        m_table.addColumn( "8", 21, AL_RIGHT);
        m_table.addColumn( "9", 21, AL_RIGHT);
        m_table.addColumn("10", 10, AL_RIGHT);
        m_table.addColumn("11", 10, AL_RIGHT);
        m_table.addColumn("12", 16, AL_RIGHT);
        m_table.addColumn("13", m_widthColumnNominalSum+1, AL_RIGHT);
        m_table.addColumn("14", 26, AL_RIGHT);
        m_table.addColumn("15", 11, AL_RIGHT);
        m_table.addColumn("16", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("17", 26, AL_RIGHT);
        m_table.addColumn("18", 26, AL_RIGHT);
        m_table.addColumn("19", 26, AL_RIGHT);
        m_table.addColumn("20", 26, AL_RIGHT);
        m_table.addColumn("21", 26, AL_RIGHT);
        m_table.addColumn("22", 26, AL_RIGHT);
        m_table.addColumn("23", 26, AL_RIGHT);
        m_table.addColumn("24", 21, AL_RIGHT);
    end;

    constructor();
end;

/**
 *  Печатное представление таблицы подраздела 1.2.1
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart121TableView_I2055) TSubpart121TableView_I2332()

    macro printHeader()

        [┌──────┬──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐];
        [│Номер │     Сокращенное      │   Номер лицензии  │   Признак    │  Номер междепозитарного   │ Общее количество│];
        [│строки│     наименование     │ профессионального │ депозитария- │  счета "ЛОРО", открытого  │ ценных бумаг на │];
        [│      │     депозитария-     │  участника рынка  │корреспондента│       депозитарию-        │ междепозитарном │];
        [│      │    корреспондента    │   ценных бумаг -  │              │      корреспонденту       │  счете "ЛОРО"   │];
        [│      │                      │   корреспондента  │              │                           │ корреспондента, │];
        [│      │                      │                   │              │                           │       штук      │];
        [├──────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
        [│  18  │          19          │        20         │      21      │            22             │        23       │];
        [├──────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];

    end;

    private macro constructorTSubpart121TableView_I2332()

        initTPartView();

        m_table.addColumn("18", 4,  AL_CENTER);
        m_table.addColumn("19", 20, AL_LEFT);
        m_table.addColumn("20", 17, AL_LEFT);
        m_table.addColumn("21", 12, AL_CENTER);
        m_table.addColumn("22", 25, AL_LEFT);
        m_table.addColumn("23", 15, AL_RIGHT);

    end;

    constructorTSubpart121TableView_I2332();

end;

/**
 *  Печатное представление таблицы подраздела 1.2.2
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart122TableView_I2055) TSubpart122TableView_I2332()

    macro printHeader();

        [┌──────┬──────────────────────┬───────────────────┬──────────────┬───────────────────────────┬─────────────────┐];
        [│Номер │     Сокращенное      │   Номер лицензии  │   Признак    │  Номер счета, открытого у │ Общее количество│];
        [│строки│     наименование     │ профессионального │ депозитария- │       депозитария-        │ ценных бумаг на │];
        [│      │     организации-     │  участника рынка  │корреспондента│      корреспондента       │ междепозитарном │];
        [│      │    корреспондента    │   ценных бумаг -  │              │                           │  счете (счете   │];
        [│      │                      │   корреспондента  │              │                           │  номинального   │];
        [│      │                      │                   │              │                           │ держателя), штук│];
        [├──────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];
        [│  24  │         25           │        26         │      27      │             28            │        29       │];
        [├──────┼──────────────────────┼───────────────────┼──────────────┼───────────────────────────┼─────────────────┤];

    end;

    private macro constructorTSubpart122TableView_I2332()

        initTPartView();

        m_table.addColumn("24", 4,  AL_CENTER);
        m_table.addColumn("25", 20, AL_LEFT);
        m_table.addColumn("26", 17, AL_LEFT);
        m_table.addColumn("27", 12, AL_CENTER);
        m_table.addColumn("28", 25, AL_LEFT);
        m_table.addColumn("29", 15, AL_RIGHT);

    end;

    constructorTSubpart122TableView_I2332();

end;

/**
 *  Печатное представление таблицы подраздела 1.3.1
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart131TableView_I2055) TSubpart131TableView_I2332()

    macro printHeader()

        print("┌──────┬──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬");printFillLeft("─");print("──────────────");printFillRight("─");println("┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐");
        print("│Номер │     Наименование     │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │");printFillLeft(" ");print(" Номинальная  ");printFillRight(" ");println("│                                                                          Количество ценных бумаг, штук                                                                            │");
        print("│строки│       эмитента       │   эмитента   │  ценной  │   номер ценной    │ валюты │");printFillLeft(" ");print("  стоимость   ");printFillRight(" ");println("├────────────────────────────────────────────┬────────────────────────────────────────────┬─────────────────────────────┬──────────────┬──────────────┬──────────────┬──────────────┤");
        print("│      │                      │              │  бумаги  │      бумаги       │ ценной │");printFillLeft(" ");print("ценной бумаги,");printFillRight(" ");println("│           на счетах владельцев             │              на счетах \"ЛОРО\"              │ на счетах залогодержателей  │  на счетах   │      на      │  на счетах   │  на счетах,  │");
        print("│      │                      │              │          │                   │ бумаги │");printFillLeft(" ");print("  ед.валюты   ");printFillRight(" ");println("├─────────────────────────────┬──────────────┼─────────────────────────────┬──────────────┼──────────────┬──────────────┤доверительных │  эмиссионных │  эмитентов   │  владельцы   │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("обязательства ");printFillRight(" ");println("│          резидентов         │ нерезидентов │          резидентов         │ нерезидентов │ резидентов   │ нерезидентов │ управляющих  │    счетах    │              │   которых    │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("├──────────────┬──────────────┤              ├──────────────┬──────────────┤              │              │              │              │              │              │не установлены│");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│     всего    │   из них:    │              │     всего    │   из них:    │              │              │              │              │              │              │              │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │  кредитные   │              │              │  кредитные   │              │              │              │              │              │              │              │");
        print("│      │                      │              │          │                   │        │");printFillLeft(" ");print("              ");printFillRight(" ");println("│              │ организации  │              │              │ организации  │              │              │              │              │              │              │              │");
        print("├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤");
        print("│  30  │           31         │      32      │    33    │         34        │   35   │");printFillLeft(" ");print("      36      ");printFillRight(" ");println("│      37      │      38      │      39      │      40      │      41      │      42      │      43      │      44      │      45      │      46      │      47      │      48      │");
        print("├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼");printFillLeft("─");print("──────────────");printFillRight("─");println("┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤");

    end;

    private macro constructorTSubpart131TableView_I2332()

        initTPartView();

        calcWidthColumnNominalSum("Ф711_3_1");

        m_table.addColumn("30", 4,  AL_CENTER);
        m_table.addColumn("31", 20, AL_LEFT);
        m_table.addColumn("32", 12, AL_CENTER);
        m_table.addColumn("33", 8,  AL_CENTER);
        m_table.addColumn("34", 17, AL_CENTER);
        m_table.addColumn("35", 6,  AL_CENTER);
        m_table.addColumn("36", m_widthColumnNominalSum, AL_RIGHT);
        m_table.addColumn("37", 12, AL_RIGHT);
        m_table.addColumn("38", 12, AL_RIGHT);
        m_table.addColumn("39", 12, AL_RIGHT);
        m_table.addColumn("40", 12, AL_RIGHT);
        m_table.addColumn("41", 12, AL_RIGHT);
        m_table.addColumn("42", 12, AL_RIGHT);
        m_table.addColumn("43", 12, AL_RIGHT);
        m_table.addColumn("44", 12, AL_RIGHT);
        m_table.addColumn("45", 12, AL_RIGHT);
        m_table.addColumn("46", 12, AL_RIGHT);
        m_table.addColumn("47", 12, AL_RIGHT);
        m_table.addColumn("48", 12, AL_RIGHT);

    end;

    constructorTSubpart131TableView_I2332();

end;

/**
 *  Печатное представление таблицы подраздела 1.3.2
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart132TableView_I2055) TSubpart132TableView_I2332()

    macro printHeader();

        [┌──────┬──────────────────────┬──────────────┬──────────┬───────────────────┬────────┬──────────────┬─────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер │     Наименование     │   Kод ИНН    │ Kод типа │ Идентификационный │  Kод   │ Номинальная  │   Количество ценных бумаг, штук                                                         │];
        [│строки│       эмитента       │   эмитента   │  ценной  │   номер ценной    │ валюты │  стоимость   ├──────────────┬──────────────┬──────────────┬──────────────┬──────────────┬──────────────┤];
        [│      │                      │              │  бумаги  │      бумаги       │ ценной │ценной бумаги,│на счетах,    │на счетах     │  на счетах   │      на      │  на счетах   │    на иных   │];
        [│      │                      │              │          │                   │ бумаги │  ед.валюты   │предназначен- │залогодержа-  │доверительного│  эмиссионных │  эмитента    │    счетах    │];
        [│      │                      │              │          │                   │        │обязательства │ных для учета │теля          │ управляющего │    счетах    │              │              │];
        [│      │                      │              │          │                   │        │              │ценных бумаг, │              │              │              │              │              │];
        [│      │                      │              │          │                   │        │              │принадлежащих │              │              │              │              │              │];
        [│      │                      │              │          │                   │        │              │кредитной     │              │              │              │              │              │];
        [│      │                      │              │          │                   │        │              │организации   │              │              │              │              │              │];
        [│      │                      │              │          │                   │        │              │на праве      │              │              │              │              │              │];
        [│      │                      │              │          │                   │        │              │собственности │              │              │              │              │              │];
        [├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];
        [│  49  │          50          │      51      │    52    │         53        │   54   │      55      │      56      │      57      │      58      │      59      │      60      │      61      │];
        [├──────┼──────────────────────┼──────────────┼──────────┼───────────────────┼────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┼──────────────┤];

    end;

    private macro constructorTSubpart132TableView_I2332()

        initTPartView();

        m_table.addColumn("49", 4,  AL_CENTER);
        m_table.addColumn("50", 20, AL_LEFT);
        m_table.addColumn("51", 12, AL_CENTER);
        m_table.addColumn("52", 8,  AL_CENTER);
        m_table.addColumn("53", 17, AL_CENTER);
        m_table.addColumn("54", 6,  AL_CENTER);
        m_table.addColumn("55", 12, AL_RIGHT);
        m_table.addColumn("56", 12, AL_RIGHT);
        m_table.addColumn("57", 12, AL_RIGHT);
        m_table.addColumn("58", 12, AL_RIGHT);
        m_table.addColumn("59", 12, AL_RIGHT);
        m_table.addColumn("60", 12, AL_RIGHT);
        m_table.addColumn("61", 12, AL_RIGHT);

    end;

    constructorTSubpart132TableView_I2332();

end;

/**
 *  Печатное представление таблицы подраздела 1.4
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TSubpart141TableView_I2055) TSubpart141TableView_I2332()

    macro printHeader()

        [┌──────┬────────────────────────────────────────────────┬───────────┬─────────────────────┐];
        [│Номер │ Наименование регионов, в которых есть филиалы, │Код региона│Количество филиалов, │];
        [│строки│осуществляющие депозитарные операции с клиентами│ по ОКАТО  │   осуществляющих    │];
        [│      │                                                │           │депозитарные операции│];
        [│      │                                                │           │с клиентами в регионе│];
        [├──────┼────────────────────────────────────────────────┼───────────┼─────────────────────┤];
        [│  62  │                     63                         │    64     │         65          │];
        [├──────┼────────────────────────────────────────────────┼───────────┼─────────────────────┤];

    end;

    private macro constructorTSubpart141TableView_I2332()

        initTPartView();

        m_table.addColumn("24",  4, AL_CENTER);
        m_table.addColumn("25", 46, AL_LEFT);
        m_table.addColumn("26",  9, AL_CENTER);
        m_table.addColumn("27", 19, AL_CENTER);

    end;

    constructorTSubpart141TableView_I2332();

end;

/**
 *  Зона с информацией о различных кодах кредитной организации в соответствии с 2332-У
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
private class (TLendingAgencyCodeZone) TLendingAgencyCodeZone711_I2332()

    /**
     * Печать в текущий поток вывода.
     */
    macro print(reportWidth)
        var okatoCode     = strAlign(getOkato(),                                                       10, STR_ALIGN_CENTER);
        var okpoCode      = strAlign(getOkpo(),                                                        16, STR_ALIGN_CENTER);
        var ogrn          = strAlign(getOgrn(),                                                        15, STR_ALIGN_CENTER);
        var regNumber     = strAlign(getRegistrationNumber(),                                          17, STR_ALIGN_CENTER);
        var bic           = strAlign(getBic(),                                                         12, STR_ALIGN_CENTER);
        var licenseNumber = strAlign(repGetPartyCode(party.rec.partyId, RCB_PTCK_ORCBLICENSE, m_date), 19, STR_ALIGN_CENTER);

        println(); //GetLicenseNumber(OurBank);
        println(strAlign("Банковская отчетность", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("┌──────────┬───────────────────────────────────────────────────────────────────────────────────┐", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│   Код    │                       Код кредитной организации (филиала)                         │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│территории├────────────────┬───────────────┬─────────────────┬────────────┬───────────────────┤", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│ по ОКАТО │    по ОКПО     │   основной    │ регистрационный │    БИК     │  Номер лицензии   │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│          │                │государственный│номер(/порядковый│            │ профессионального │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│          │                │регистрационный│   номер)        │            │  участника рынка  │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│          │                │    номер      │                 │            │   ценных бумаг    │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("├──────────┼────────────────┼───────────────┼─────────────────┼────────────┼───────────────────┤", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│"+okatoCode+"│"+okpoCode+ "│" +  ogrn   + "│" + regNumber + "│" +   bic+ "│" +licenseNumber+ "│", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("└──────────┴────────────────┴───────────────┴─────────────────┴────────────┴───────────────────┘", reportWidth, STR_ALIGN_RIGHT));

    end;

    /**
     * Конструктор.
     */
    private macro constructorTLendingAgencyCodeZone711_I2332()
        initTLendingAgencyCodeZone();
    end;

    constructorTLendingAgencyCodeZone711_I2332();
end;

/**
 *  Печатное представление формы в соответствии с 2332-У
 *  @author ABP
 *  @since 6.00.020.29
 */
private class (TReportView) TReportView_I2332()

    private macro constructorTReportView_I2332()

        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I2055(), TPart2View())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2332();
        m_namesZone             = TNamesZone_2332("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);

    end;

    constructorTReportView_I2332();

end;

/**
 *  Контроллер печати формы по 2332-У
 *  @author Shestakov Dmitry
 *  @since 6.00.020.29
 */
class (TPrintController_I2055) TPrintController_I2332()

    private macro constructorTPrintController_I2332()

        initTPrintController_I2055();

        m_view = TReportView_I2332();
    end;

    constructorTPrintController_I2332();

end;

/**
 *  Контроллер печати формы по 2627-У
 *  @author SER
 *  @since 6.00.020.30
 */
class (TPrintController_I2332) TPrintController_I2627()

    private macro constructorTPrintController_I2627()
        m_view = TReportView_I2332();

        m_report = RcbApplication().currentReport;

        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1.1", TDataSourceSubpart1("Ф711_Гр?")),
                                     TObjectDescriptor("подраздел 1.1.2", TDataSourceSubpart1("Ф711_Гр10, Ф711_Гр11, Ф711_Гр12, Ф711_Гр13, Ф711_Гр14, Ф711_Гр15")),
                                     TObjectDescriptor("подраздел 1.2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_2_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_2_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_3_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_3_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator()))
                                    );
    end;

    private macro printPart1()

        var view = m_view.getPart(1);

        view.printHeader();

        printSubpart1(view);

        printSubpart2(view);

        printSubpart3(view);

        view.printFooter();

    end;

    constructorTPrintController_I2627();
end;

/**
 *  Зона с информацией о различных кодах кредитной организации в соответствии с 2851-У
 *  @author ABP
 *  @since 6.00.020.30
 */
private class (TLendingAgencyCodeZone) TLendingAgencyCodeZone711_I2851()

    /**
     * Печать в текущий поток вывода.
     */
    macro print(reportWidth)
        var okatoCode     = strAlign(getOkato(),              16, STR_ALIGN_CENTER);
        var okpoCode      = strAlign(getOkpo(),               16, STR_ALIGN_CENTER);
        var regNumber     = strAlign(getRegistrationNumber(), 23, STR_ALIGN_CENTER);
        var licenseNumber = strAlign(repGetPartyCode(party.rec.partyId, RCB_PTCK_ORCBLICENSE, m_date), 34, STR_ALIGN_CENTER);

        println();
        println(strAlign("Банковская отчетность", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("┌────────────────┬───────────────────────────────────────────────────────────────────────────┐", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│ Код территории │                    Код кредитной организации (филиала)                    │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│    по ОКАТО    ├────────────────┬───────────────────────┬──────────────────────────────────┤", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│                │    по ОКПО     │ регистрационный номер │ Номер лицензии профессионального │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│                │                │  (/порядковый номер)  │   участника рынка ценных бумаг   │", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("├────────────────┼────────────────┼───────────────────────┼──────────────────────────────────┤", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("│"+ okatoCode + "│"+ okpoCode +  "│" + regNumber +       "│" +licenseNumber +               "│", reportWidth, STR_ALIGN_RIGHT));
        println(strAlign("└────────────────┴────────────────┴───────────────────────┴──────────────────────────────────┘", reportWidth, STR_ALIGN_RIGHT));
    end;

    /**
     * Конструктор.
     */
    private macro constructorTLendingAgencyCodeZone711_I2851()
        initTLendingAgencyCodeZone();
    end;

    constructorTLendingAgencyCodeZone711_I2851();
end;

/**
 *  Печатное представление формы в соответствии с 2851-У
 *  @author ABP
 *  @since 6.00.020.30
 */
private class (TReportView) TReportView_I2851()

    private macro constructorTReportView_I2851()

        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I2055(), TPart2View())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_2332("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);

    end;

    constructorTReportView_I2851();

end;

private class (TReportView) TReportView_I3129()

    private macro constructorTReportView_I3129()

        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I3129(), TPart2View())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_2332("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);

    end;

    constructorTReportView_I3129();

end;

private class (TReportView) TReportView_I3129_3()

    private macro constructorTReportView_I3129_3()

        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I3129(), TPart2View(), TPart3View())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_2332("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);

    end;

    constructorTReportView_I3129_3();

end;

private class (TReportView) TReportView_I4212()
    private macro constructorTReportView_I4212()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I4212(), TPart2View(), TPart3View())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_4212("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTReportView_I4212();
end;

private class (TReportView) TReportView_I4637()
    private macro constructorTReportView_I4637()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I4637(), TPart2View(), TPart3View_4637())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_4212("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTReportView_I4637();
end;

private class (TReportView) TReportView_I4927()
    private macro constructorTReportView_I4927()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I4637(), TPart2View_I4927(), TPart3View_4637())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_4212("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTReportView_I4927();
end;

private class (TReportView) TReportView_I5456()
    private macro constructorTReportView_I4927()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I5456(), TPart2View_I5456(), TPart3View_4637())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_4212("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTReportView_I4927();
end;

private class (TReportView) TReportView_I5986()
    private macro constructorTReportView_I5986()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ И ЦИФРОВЫМ ПРАВАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I5986(), TPart2View_I5456(), TPart3View_4637(), TPart4View_I5986())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone711_I2851();
        m_namesZone             = TNamesZone_4212("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ И ЦИФРОВЫМ ПРАВАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
    end;

    constructorTReportView_I5986();
end;

private class (TReportView_I5986) TReportView711_I6800()
    private macro constructor()
        initTReportView("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ И ЦИФРОВЫМ ПРАВАМ",
                        "0409711",
                        RCB_PK_MONTH,
                        DATE_OUT_PERIOD_FORMAT,
                        arrCreate(TPart1View_I5986(), TPart2View_I5456(), TPart3View_4637(), TPart4View_I5986())
                       );

        m_lendingAgencyCodeZone = TLendingAgencyCodeZone_I6800();
        m_namesZone             = TNamesZone_6406("ОТЧЕТ ПО ЦЕННЫМ БУМАГАМ И ЦИФРОВЫМ ПРАВАМ", "0409711", RCB_PK_MONTH, DATE_OUT_PERIOD_FORMAT);
        //m_signatureZone         = TSignatureZone_6406_Var3();
    end;

    constructor();
end;

/**
 *  Контроллер печати формы по 2851-У
 *  @author ABP
 *  @since 6.00.020.30
 */
class (TPrintController_I2627) TPrintController_I2851()
    private macro constructorTPrintController_I2851()
        initTPrintController_I2627();
        m_view = TReportView_I2851();
    end;

    constructorTPrintController_I2851();
end;

class (TPrintController_I5456) TPrintController_I3129()
    private macro printSubpart(view, dataSource)
        var tableView = view.getPart(1);

        view.printHeader();

        if (not dataSource.isEmpty())
            tableView.printHeader();
            tableView.printData(dataSource);
            tableView.printFooter();
        else
            tableView.printEmptyData();
        end;

        view.printFooter();
    end;

    private macro printSubpart1(parent)
        var view = parent.getPart(1);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.1"));
        view.printFooter();
    end;

    private macro printSubpart2(parent)
        var view = parent.getPart(2);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.2"));
        view.printFooter();
    end;

    private macro printSubpart3(parent)
        var view = parent.getPart(3);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.3"));
        view.printFooter();
    end;

    private macro printSubpart4(parent)
        var view = parent.getPart(4);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.4"));
        view.printFooter();
    end;

    private macro printPart1()
        var view = m_view.getPart(1);

        view.printHeader();
        printSubpart1(view);
        printSubpart2(view);
        printSubpart3(view);
        printSubpart4(view);
        view.printFooter();
    end;

    private macro printPart2()
        var view = m_view.getPart(2);

        view.printHeader();

        view.getPart(1).printHeader();
        printSubpart(view.getPart(1).getPart(1), getDataSource("подраздел 2.1"));
        view.getPart(1).printFooter();

        view.getPart(2).printHeader();
        printSubpart(view.getPart(2).getPart(1), getDataSource("подраздел 2.2"));
        view.getPart(2).printFooter();

        view.getPart(3).printHeader();
        printSubpart(view.getPart(3).getPart(1), getDataSource("подраздел 2.3"));
        view.getPart(3).printFooter();

        view.printFooter();
    end;

    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();

        if (not isEmpty())
            printPart1();
            printPart2();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    private macro constructorTPrintController_I3129()
        initTPrintController_I5456();
        m_view = TReportView_I3129();

        m_report = RcbApplication().currentReport;

        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.4", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator()))
                                    );

    end;

    constructorTPrintController_I3129();
end;

class (TPrintController_I3129) TPrintController_I3129_3()
    private macro printPart3()
        var view = m_view.getPart(3);

        view.printHeader();

        view.getPart(1).printHeader();
        printSubpart(view.getPart(1).getPart(1), getDataSource("Раздел 3"));
        view.getPart(1).printFooter();
    end;

    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();

        if (not isEmpty())
            printPart1();
            printPart2();
            printPart3();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    private macro constructorTPrintController_I3129_3()
        initTPrintController_I3129();
        m_view = TReportView_I3129_3();

        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.4", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator())),
                                     TObjectDescriptor("раздел 3",      TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел3").createValueIterator()))
                                    );
    end;

    constructorTPrintController_I3129_3();
end;

class (TPrintController_I3129_3) TPrintController_I4212()
    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации (наименование ее филиала) ");

        if (not isEmpty())
            printPart1();
            printPart2();
            printPart3();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    private macro constructorTPrintController_I4212()
        initTPrintController_I3129_3();

        m_view = TReportView_I4212();
    end;

    constructorTPrintController_I4212();
end;

class (TPrintController_I4212) TPrintController_I4637()
    private macro constructorTPrintController_I4637()
        initTPrintController_I4212();

        m_view = TReportView_I4637();
    end;

    constructorTPrintController_I4637();
end;

class (TPrintController_I4637) TPrintController_I4927()
    private macro constructorTPrintController_I4927()
        initTPrintController_I4637();

        m_view = TReportView_I4927();
    end;

    constructorTPrintController_I4927();
end;

class (TPrintController_I4927) TPrintController_I5456_2()
    private macro printSubpart2(parent)
        var view = parent.getPart(2);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 1.2"));
        view.printFooter();
    end;

    private macro printSubpart21(parent)
        var view = parent.getPart(2);

        view.printHeader();
        printSubpart(view.getPart(2), getDataSource("подраздел 1.2.1"));
        view.printFooter();
    end;

    private macro printPart1()
        var view = m_view.getPart(1);

        view.printHeader();
        printSubpart1(view);
        printSubpart2(view);
        printSubpart21(view);
        printSubpart3(view);
        printSubpart4(view);
        view.printFooter();
    end;

    private macro constructorTPrintController_I5456_2()
        m_view           = TReportView_I5456();
        m_report         = RcbApplication().currentReport;
        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.4",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator())),
                                     TObjectDescriptor("раздел 3",        TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел3").createValueIterator()))
                                    );
    end;

    constructorTPrintController_I5456_2();
end;

class (TPrintController_I5456_2) TPrintController_I5986()
    private macro printSubpart4_1(parent)
        var view = parent.getPart(1);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 4.1"));
        view.printFooter();
    end;

    private macro printSubpart4_2(parent)
        var view = parent.getPart(2);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 4.2"));
        view.printFooter();
    end;

    private macro printSubpart4_2_1(parent)
        var view = parent.getPart(3);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 4.2.1"));
        view.printFooter();
    end;

    private macro printSubpart4_3(parent)
        var view = parent.getPart(4);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 4.3"));
        view.printFooter();
    end;

    private macro printSubpart4_4(parent)
        var view = parent.getPart(5);

        view.printHeader();
        printSubpart(view.getPart(1), getDataSource("подраздел 4.4"));
        view.printFooter();
    end;

    private macro printPart4()
        var view = m_view.getPart(4);

        view.printHeader();
        printSubpart4_1(view);
        printSubpart4_2(view);
        printSubpart4_2_1(view);
        printSubpart4_3(view);
        printSubpart4_4(view);
        view.printFooter();
    end;

    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации (наименование ее филиала) ");

        if (not isEmpty())
            printPart1();
            printPart2();
            printPart3();
            printPart4();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    private macro constructorTPrintController_I5986()
        initTPrintController_I5456_2();
        m_view           = TReportView_I5986();
        m_report         = RcbApplication().currentReport;
        m_dataSourcePool = arrCreate(TObjectDescriptor("подраздел 1.1",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.3",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator())),
                                     TObjectDescriptor("подраздел 1.4",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.1",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.2",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator())),
                                     TObjectDescriptor("подраздел 2.3",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator())),
                                     TObjectDescriptor("раздел 3",        TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел3").createValueIterator())),
                                     TObjectDescriptor("подраздел 4.1",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел4_Подраздел_4_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 4.2",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел4_Подраздел_4_2").createValueIterator())),
                                     TObjectDescriptor("подраздел 4.2.1", TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел4_Подраздел_4_2_1").createValueIterator())),
                                     TObjectDescriptor("подраздел 4.3",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел4_Подраздел_4_3").createValueIterator())),
                                     TObjectDescriptor("подраздел 4.4",   TDataSourceSubpart2_4(m_report.attributeValue("Ф711_Раздел4_Подраздел_4_4").createValueIterator()))
                                    );
    end;

    constructorTPrintController_I5986();
end;

class (TPrintController_I5986) TPrintController_I6800()
    private macro constructor()
        initTPrintController_I5986();

        m_view   = TReportView711_I6800();
        m_report = RcbApplication().currentReport;
    end;

    macro print()
        var oldOutput;

        oldOutput = setOutput(m_view.getFileName());

        m_view.setReportWidth(ternary(isEmpty(), 80, m_view.getWidth()+1));
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Полное фирменное наименование кредитной организации  ", "Адрес кредитной организации в пределах места нахождения кредитной организации  ");

        if (not isEmpty())
            printPart1();
            printPart2();
            printPart3();
            printPart4();
        else
            m_view.printNullDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();

        setOutput(oldOutput, true);
    end;

    constructor();
end;

/************************************************************************************************************
 * Общий контроллер печати формы
 ************************************************************************************************************/
/**
 *  Контроллер печати
 *  @author ABP
 *  @since 6.00.020.29
 */
private class TPrintController(parameters : String)
    private const MODE_PROTOCOL = 1;
    private const MODE_REPORT   = 2;

    private var m_mode : Integer;
    private var m_reportPrintController : Object;
    private var m_protocolPrintController : Object;

    private macro parse(parameters)
        if (parameters == "protocol")
            m_mode = MODE_PROTOCOL;
        else
            m_mode = MODE_REPORT;
        end;
    end;

    macro print()
        if (m_mode == MODE_PROTOCOL)
            m_protocolPrintController.print();
        end;

        if (m_mode == MODE_REPORT)
            m_reportPrintController.print();
        end;
    end;

    private macro constructorTPrintController(parameters)
        parse(parameters);

        m_reportPrintController   = objectFactoryInstance.createPrintController();
        m_protocolPrintController = TProtocolPrintController();
    end;

    constructorTPrintController(parameters);
end;

/* ====================== Точка входа в программу ========================= */
TPrintController(cmdargs()).print();
УстановитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
