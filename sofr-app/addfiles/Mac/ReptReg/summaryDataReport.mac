/*
$Name: summaryDataReport.mac
$Module: Регламентируемая отчетность
$Description: Свод
*/

import RcbProtocolView;

private var logfilePath = RcbApplication.summator.getLogFilePath();

macro clearLog()
    var oldPath = setoutput(logfilePath);

    setoutput(oldPath, true);
end;

macro printReportHead(report : RcbReport)
    var protocolView = TProtocolView("Сведение данных отчета");

    var oldPath = setoutput(logfilePath, true);

    println();
    protocolView.printHead();

    setoutput(oldPath, true);
end;

macro printLine(line : string)
    var oldPath = setoutput(logfilePath, true);
    println(line);
    setoutput(oldPath, true);
end;

macro showLog()
    file protocolFile () txt;

    if (existFile(logfilePath, 0))
        if (open(protocolFile, logfilePath))
            RepTxtFilesQueue().add(logfilePath);
            viewFile(protocolFile);
            close(protocolFile);
        else
            RepErrorsQueue().add(0, string("Ошибка открытия файла:\n", logfilePath));
            msgbox("Ошибка открытия файла:|", logfilePath);
        end;
    else
        RepErrorsQueue().add(0, string("Не найден файл протокола:\n", logfilePath));
        msgbox("Не найден файл протокола:|", logfilePath);
    end;
end;