/*
$Name:          calc_ffor.mac
$Module:        Регламентируемая отчетность
$Description:   ФОР. Интерфейс операций расчета
*/

import "import.mac";

private macro calculate()
    if (global.parameters.getReportLength() < 80)
        RepErrorsQueue().add(0, "Для Приложения 2-5,7 ширина отчета не может быть меньше 80, измените величину настройки REPTREG/REP_GROUPS/COMMON/ШИРИНА_ОТЧЕТА.");
        msgBox("Для Приложения 2-5,7 ширина отчета не может быть меньше 80, измените величину настройки REPTREG/REP_GROUPS/COMMON/ШИРИНА_ОТЧЕТА.");
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    if (ValType(global.form) != V_UNDEF)
        global.form.calculate();
    end;
    установитьФлагВозврата( OK_MACRO_FLAG);
    exit(1);
end;

private macro recalculateItogValues()
    global.form.recalculateItogValues();
    установитьФлагВозврата( OK_MACRO_FLAG);
    exit(1);
end;

private macro controlBeforeSummation()
    global.form.controlBeforeSummation();
    установитьФлагВозврата( OK_MACRO_FLAG);
    exit(1);
end;
