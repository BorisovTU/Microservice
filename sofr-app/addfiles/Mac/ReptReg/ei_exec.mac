/*****************************************************************************
  RS-Bank v 5.0                                     R-Style Software Lab Ltd
  Файл подсистемы "Отчеты ЦБ"

  Макросы, запускаемые системными процедурами экспорта/импорта

  CREATED      : 20.03.2003 - Sal.
  MODIFICATIONS:
  NOTES        :
     Список обрабатываемых отчетов хранится в массиве XMRepList, элменетами
   которого являются объекты класса TXMReport, хранящего данные об одном
   отчете.
     Переменная XMIdxCurrentRep хранит индекс обрабатываемого отчета, который
   в данный момент обрабатывается процедурами экспорта/импорта.
*****************************************************************************/
import rsexts, ReptCBInter;

/* Массив данных об отчетах */
ARRAY XMRepList;

/* Индекс текущего обслуживаемого отчета */
Var   XMIdxCurrentRep = -1;

/* Структура данных об отчете */
CLASS TXMReport
(
  FormName,
  NumDprt,
  VarKind,
  DoubleDates,
  BegDate,
  EndDate,
  EIFName
)
  Var mFormName     : String;  /* Имя формы                       */
  Var mNumDprt      : Integer; /* Номер отделения                 */
  Var mVarKind      : String;  /* Вид переменных                  */
  Var mDoubleDates  : Bool;    /* Использование двух значащих дат */
  Var mBegDate      : Date;    /* Дата начала отчета              */
  Var mEndDate      : Date;    /* Дата конца отчета               */
  Var mEIFName      : String;  /* Имя файла с данными             */

  mFormName    = FormName;
  mNumDprt     = NumDprt;
  mVarKind     = VarKind;
  mDoubleDates = DoubleDates;
  mBegDate     = BegDate;
  mEndDate     = EndDate;
  mEIFName     = EIFName;
END;

/********************************************************* 
 Макрос вызывается до экспорта всех отчетов 
 Параметры: Нет
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, начинаем экспорт
   false - обнаружены ошибки, требуется прервать экспорт

 XMIdxCurrentRep = -1
**********************************************************/
MACRO XMExportBefore()
  return true;
END;

/********************************************************* 
 Макрос вызывается после экспорта всех отчетов 
 Параметры:
   CountExported, тип - V_INTEGER
     Количество проэкспортированных отчетов
 Возвращаемое значение: нет

 XMIdxCurrentRep = -1
**********************************************************/
MACRO XMExportAfter( CountExported )
END;

/********************************************************* 
 Макрос вызывается до импорта всех отчетов 
 Параметры: Нет
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, начинаем импорт
   false - обнаружены ошибки, требуется прервать импорт

 XMIdxCurrentRep = -1
**********************************************************/
MACRO XMImportBefore()
  return true;
END;

/********************************************************* 
 Макрос вызывается после импорта всех отчетов 
 Параметры:
   CountImported, тип - V_INTEGER
     Количество проимпортированных отчетов
 Возвращаемое значение: нет

 XMIdxCurrentRep = -1
**********************************************************/
MACRO XMImportAfter( CountImported )
END;

/********************************************************* 
 Макрос вызывается до экспорта конкретного отчета 
 Параметры: Нет
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, экспортируем отчет
   false - обнаружены ошибки, не экспортируем отчет

 XMIdxCurrentRep указывает индекс обрабатываемого отчета
 в массиве XMRepList
**********************************************************/
MACRO XMExportBeforeSingleReport()
  return true;
END;

/********************************************************* 
 Макрос вызывается после экспорта конкретного отчета 
 Параметры:
   ExportStatus, тип - V_INTEGER
     Результат экспорта отчета ( 0-успешно, !0-ошибки )
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, продолжаем экспорт
   false - обнаружены ошибки, прекращаем экспорт

 XMIdxCurrentRep указывает индекс обрабатываемого отчета
 в массиве XMRepList
**********************************************************/
MACRO XMExportAfterSingleReport( ExportStatus )
  return true;
END;

/********************************************************* 
 Макрос вызывается до импорта конкретного отчета 
 Параметры: Нет
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, импортируем отчет
   false - обнаружены ошибки, не импортируем отчет

 XMIdxCurrentRep указывает индекс обрабатываемого отчета
 в массиве XMRepList
**********************************************************/
MACRO XMImportBeforeSingleReport()
  return true;
END;

/********************************************************* 
 Макрос вызывается после импорта конкретного отчета 
 Параметры:
   ImportStatus, тип - V_INTEGER
     Результат импорта отчета ( 0-успешно, !0-ошибки )
 Возвращаемое значение: тип V_BOOL
   true  - макрос успешно завершен, продолжаем импорт
   false - обнаружены ошибки, прекращаем импорт

 XMIdxCurrentRep указывает индекс обрабатываемого отчета
 в массиве XMRepList
**********************************************************/
MACRO XMImportAfterSingleReport( ImportStatus )
  return true;
END;


/* eof */