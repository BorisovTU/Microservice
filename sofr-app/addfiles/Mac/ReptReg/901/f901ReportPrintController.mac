/* --------------------------------------------------------------------------┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Форма 901. Контроллер печати отчета.

   CREATED : 17.08.2013 ABP.
L-------------------------------------------------------------------------- */
class (RcbReportPrintController) TF901ReportPrintController

    private macro printString(rowNumber : String, description : String, attributeIdRouble : String, attributeIdEquivalent : String)
        var valueAsStringRouble : String = "";
        var valueAsStringEquivalent : String = "";

        if (attributeIdRouble != null)
            valueAsStringRouble = m_report.getPart("1").getAttribute(attributeIdRouble).getValueAsString();
        else
            valueAsStringRouble = "X";
        end;

        if (attributeIdEquivalent != null)
            valueAsStringEquivalent = m_report.getPart("1").getAttribute(attributeIdEquivalent).getValueAsString();
        else
            valueAsStringEquivalent = "X";
        end;

        getReportView().getPartView("1").printString(RcbArray().initialize(rowNumber, description, valueAsStringRouble, valueAsStringEquivalent));
    end;

    private macro printData()
        var dataSource = getDataSources().getDataSource("PrintableForm");
        var filter = getDataSourceFilters().getFilter("PrintableForm");
        var attribute = objectFactoryInstance.createAttribute();

        printString("1",  dataSource.getData(filter.clear().isRowNumberEqual("1")),  attribute.makeId("1",  "X"), attribute.makeId("1",  ""));
        printString("2",  dataSource.getData(filter.clear().isRowNumberEqual("2")),  attribute.makeId("2",  "X"), attribute.makeId("2",  ""));
        printString("3",  dataSource.getData(filter.clear().isRowNumberEqual("3")),  attribute.makeId("3",  "X"), attribute.makeId("3",  ""));
        printString("4",  dataSource.getData(filter.clear().isRowNumberEqual("4")),  attribute.makeId("4",  "X"), null);
        printString("5",  dataSource.getData(filter.clear().isRowNumberEqual("5")),  attribute.makeId("5",  "X"), attribute.makeId("5",  ""));
        printString("6",  dataSource.getData(filter.clear().isRowNumberEqual("6")),  attribute.makeId("6",  "X"), attribute.makeId("6",  ""));
        printString("7",  dataSource.getData(filter.clear().isRowNumberEqual("7")),  attribute.makeId("7",  "X"), attribute.makeId("7",  ""));
        printString("8",  dataSource.getData(filter.clear().isRowNumberEqual("8")),  attribute.makeId("8",  "X"), attribute.makeId("8",  ""));
        printString("9",  dataSource.getData(filter.clear().isRowNumberEqual("9")),  attribute.makeId("9",  "X"), attribute.makeId("9",  ""));
        printString("10", dataSource.getData(filter.clear().isRowNumberEqual("10")), attribute.makeId("10", "X"), attribute.makeId("10", ""));
        printString("11", dataSource.getData(filter.clear().isRowNumberEqual("11")), attribute.makeId("11", "X"), attribute.makeId("11", ""));
    end;

    private macro printDataZone()
        getReportView().getPartView("1").printHead();
        printData();
        getReportView().getPartView("1").printBottom();
    end;

    private macro constructorTF901ReportPrintController()
        initRcbReportPrintController();

        m_reportWidth = getReportView().getPartView("1").getWidth();
    end;

    constructorTF901ReportPrintController();

end;
