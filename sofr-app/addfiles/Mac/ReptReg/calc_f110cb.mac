/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank V6                                                  R-Style Softlab
  Файл подсистемы "Регламентируемая отчетность"

  Расшифровки формы 110 по ГК.
└───────────────────────────────────────────────────────────────────────────*/
import BankInter, rcbconst, objconst, calc_f110;

// Класс вывода в протокол для расшифровок по счетам ГК.
private CLASS( CLogger110 ) CAccountLogger
    InitCLogger110( );

    AddColumn( "Номер л/с", "Account", 25 );
    AddColumn( "Сумма, вошедшая в расчёт", "Rest", 16 );
END;

private CLASS( CLogger110 ) CAccReserveLogger
    InitCLogger110( );

    AddColumn( "Номер л/с резерва", "Account", 25 );
    AddColumn( "Сумма, вошедшая в расчёт", "Rest", 16 );
END;


// Класс фактически не меняет состояний, поэтому можно использовать единственный экземпляр.
private var accLogger = CAccountLogger;
private var reserveLogger = CAccReserveLogger;
private var accountFilter = RcbAccountFilter();

// Расшифровки, вычисляемые по остаткам счетов; возможно, с проверкой категории
// "Категория для отчётности / Для формы 110".
/* name - имя расшифровки, isBegDate - использовать ли дату начала отчетного периода,
    иначе используем дату отчета, attr - атрибут категории, на кот. идёт проверка*/
private CLASS( CCharacteristic110 ) CCharAccRest( name_, isBegDate_, attr_ )
    InitCCharacteristic110( name_, BOCB, accLogger, "Rest" );

    private var isBegDate = isBegDate_;
    private var Attribute = attr_;
    private var CalcDate = Ternary( isBegDate, SqlPrevDate, SqlRepDate );

    // Главное, ради чего перегрузка - собственно алгоритм получения данных.
    private MACRO GetObjects()
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( t_Type_Account, 'П' ) = 0 AND " + accountFilter.GetAsSqlString( "acc" )
                   + "   AND (" + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "t_Account" ) + ")";
        if( Attribute != NULL )
            filter = filter
                    + "  AND rsb_rep_ac.CheckObjAttrPresence( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP
                    + ", rsb_kernel.GetObjAttrId( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP + ", CHR(1), '"
                    + Attribute + "' ), rsb_rep_ac.MakeAccountId( t_Account, t_Code_Currency, t_Chapter, NULL )"
                    + ", " + CalcDate + " ) != 0";
        end;

        var query  = " SELECT t_Account, abs( rsb_account.restac( t_Account, t_code_currency," + CalcDate + ", t_Chapter, 0 ) ) Rest"
                   + "   FROM daccount_dbt acc"
                   + filter
                   + " ORDER BY t_Account";

        return TRsbDataSet( query );
    END;
END;

private CLASS( CCharacteristic110 ) CCharAccRestSub( name_, subkinds_ )
    InitCCharacteristic110( name_, BOCB, reserveLogger, "Rest" );

    private var SubKinds = subkinds_;

    private MACRO GetObjects( )
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( acc.t_Type_Account, 'П' ) = 0 AND (" + accountFilter.GetAsSqlString( "acc" ) +
                    " AND " + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "acc.t_Account" ) + ")";
        var filter1 = " AND ( NOT EXISTS ( SELECT acc.t_Account FROM daccvanl_dbt anv, daccanl_dbt anl"
                    + " WHERE acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND anv.t_FIID = 0"
                    + " AND anv.t_AnaliticsID = anl.t_AnaliticsID AND anl.t_Shortname = 'Резервы' )"
                    + " OR NOT EXISTS ( SELECT sub.t_SubAccountID FROM daccvanl_dbt anv, daccanl_dbt anl, daccsub_dbt sub"
                    + " WHERE acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND anv.t_FIID = 0"
                    + " AND anv.t_AnaliticsID = anl.t_AnaliticsID AND anl.t_Shortname = 'Резервы'"
                    + " AND anv.t_AccAnaliticsID = sub.t_AccAnaliticsID AND NOT sub.t_SubAccountCode LIKE ('%default_subacc%') ) )";
        var filter2 = " AND ( NOT EXISTS ( SELECT acc.t_Account FROM daccvanl_dbt anv, daccanl_dbt anl"
                    + " WHERE acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND acc.t_Code_Currency = anv.t_FIID"
                    + " AND anv.t_AnaliticsID = anl.t_AnaliticsID AND anl.t_ShortName = 'Резервы' )"
                    + " OR NOT EXISTS ( SELECT sub.t_SubAccountID FROM daccvanl_dbt anv, daccanl_dbt anl, daccsub_dbt sub"
                    + " WHERE acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND acc.t_Code_Currency = anv.t_FIID"
                    + " AND anv.t_AnaliticsID = anl.t_AnaliticsID AND anl.t_ShortName = 'Резервы'"
                    + " AND anv.t_AccAnaliticsID = sub.t_AccAnaliticsID AND NOT sub.t_SubAccountCode LIKE ('%default_subacc%') ) )";
        var filter3 = " AND acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND anv.t_FIID = 0"
                    + " AND anv.t_AccAnaliticsID = sub.t_AccAnaliticsID"
                    + " AND sub.t_SubAccountCode IN ('" + SubKinds + "') AND sub.t_ParentID = 0";
        var filter4 = " AND acc.t_Account = anv.t_Account AND acc.t_Chapter = anv.t_Chapter AND acc.t_Code_Currency = anv.t_FIID"
                    + " AND anv.t_AccAnaliticsID = sub.t_AccAnaliticsID"
                    + " AND sub.t_SubAccountCode IN ('" + SubKinds + "') AND sub.t_ParentID = 0";


        var query  = " SELECT acc.t_Account Account, abs( rsb_rep_ac.resta( acc.t_Account, " + SqlRepDate + ", acc.t_Chapter, acc.t_r0 ) ) Rest"
                   + " FROM daccount_dbt acc"
                   + filter + filter1 + " UNION"
                   + " SELECT acc.t_Account Account, abs( rsb_rep_ac.resta( acc.t_Connect_Account, " + SqlRepDate + ", acc.t_Connect_Chapter, acc.t_r0 ) ) Rest"
                   + " FROM daccount_dbt acc"
                   + filter + filter2 + " UNION"
                   + " SELECT acc.t_Account Account, SUM( abs( rsb_account.restsa(sub.t_AccanaliticsID, sub.t_SubAccountID, " + SqlRepDate + ") ) ) Rest"
                   + " FROM daccount_dbt acc, daccvanl_dbt anv, daccsub_dbt sub"
                   + filter + filter4 + " GROUP BY acc.t_Account "
                   + " ORDER BY Account";

        return TRsbDataSet( query );
    END;
END;

private CLASS( CCharacteristic110 ) CCharAccTurnover( name_, isDebet_, attr_ )
    InitCCharacteristic110( name_, BOCB, accLogger, "Rest" );

    private var isDebet = isDebet_;
    private var Attribute = attr_;
    private var Str = Ternary( isDebet, "debet", "kredit" );

    private MACRO GetObjects( )
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( t_Type_Account, 'П' ) = 0 AND " + accountFilter.GetAsSqlString( "acc" )
                   + "   AND (" + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "t_Account" ) + ")";
        if( Attribute != NULL )
            filter = filter
                    + "  AND NOT rsb_rep_ac.CheckObjAttrPresence( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP
                    + ", rsb_kernel.GetObjAttrId( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP + ", CHR(1), '"
                    + Attribute + "' ), rsb_rep_ac.MakeAccountId( t_Account, t_Code_Currency, t_Chapter, NULL )"
                    + ", " + SqlRepDate + " ) != 0";
        end;

        var query  = " SELECT t_Account, rsb_account." + Str + "a( t_Account, t_Chapter, "
                   + SqlBegDate + ", " + SqlRepDate + " ) Rest FROM daccount_dbt acc" + filter
                   + " UNION SELECT t_Account, rsb_account." + Str + "a( t_Connect_Account, t_Connect_Chapter, "
                   + SqlBegDate + ", " + SqlRepDate + " ) Rest FROM daccount_dbt acc" + filter
                   + " ORDER BY t_Account";

        return TRsbDataSet( query );
    END;
END;

private CLASS( CCharacteristic110 ) CCharAccSpecial1( name_ )
    InitCCharacteristic110( name_, BOCB, accLogger, "Rest" );

    private var Attribute = "Премии";

    private MACRO GetObjects( )
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( acc.t_Type_Account, 'П' ) = 0 AND " + accountFilter.GetAsSqlString( "acc" )
                   + " AND (" + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "acc.t_Account" ) + ")"
                   + " AND rsb_rep_ac.CheckObjAttrPresence( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP
                   + ", rsb_kernel.GetObjAttrId( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP + ", CHR(1), '"
                   + Attribute + "' ), rsb_rep_ac.MakeAccountId( acc.t_Account, acc.t_Code_Currency, acc.t_Chapter, NULL )"
                   + ", " + SqlRepDate + " ) != 0";

        var query  = " SELECT acc.t_Account Account, GREATEST( 0, NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Account"
                                                        + " AND SubStr( doc.t_Account_Receiver, 1, 5 ) = '60306'"
                                                        + " AND doc.t_state = 1"
                                                        + " AND doc.t_Code_Currency = 0"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ) - abs( rsb_rep_ac.resta( acc.t_Account, " + SqlPrevDate + ", acc.t_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter
                    + " UNION"
                    + " SELECT acc.t_Account Account, GREATEST( 0, NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Connect_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Connect_Account"
                                                        + " AND SubStr( doc.t_Account_Receiver, 1, 5 ) = '60306'"
                                                        + " AND doc.t_state = 1"
                                                        + " AND doc.t_Code_Currency = 0"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ) - abs( rsb_rep_ac.resta( acc.t_Connect_Account, " + SqlPrevDate + ", acc.t_Connect_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter + " AND (T_CODE_CURRENCY!=0)"
                    + " ORDER BY Account";

        return TRsbDataSet( query );
    END;
END;

private CLASS( CCharacteristic110 ) CCharAccSpecial2( name_ )
    InitCCharacteristic110( name_, BOCB, accLogger, "Rest" );

    private var Attribute = "Премии";

    private MACRO GetObjects( )
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( acc.t_Type_Account, 'П' ) = 0 AND " + accountFilter.GetAsSqlString( "acc" )
                    + " AND (" + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "acc.t_Account" ) + ")"
                    + " AND rsb_rep_ac.CheckObjAttrPresence( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP
                    + ", rsb_kernel.GetObjAttrId( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP + ", CHR(1), '"
                    + Attribute + "' ), rsb_rep_ac.MakeAccountId( acc.t_Account, acc.t_Code_Currency, acc.t_Chapter, NULL )"
                    + ", " + SqlRepDate + " ) != 0";

        var query  = " SELECT acc.t_Account Account, LEAST( NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Account"
                                                        + " AND SubStr( doc.t_Account_Receiver, 1, 5 ) = '60306'"
                                                        + " AND doc.t_state = 1"
                                                        + " AND doc.t_Code_Currency = 0"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ), abs( rsb_rep_ac.resta( acc.t_Account, " + SqlPrevDate + ", acc.t_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter
                    + " UNION"
                    + " SELECT acc.t_Account Account, LEAST( NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Connect_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Connect_Account"
                                                        + " AND SubStr( doc.t_Account_Receiver, 1, 5 ) = '60306'"
                                                        + " AND doc.t_state = 1"
                                                        + " AND doc.t_Code_Currency = 0"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ), abs( rsb_rep_ac.resta( acc.t_Connect_Account, " + SqlPrevDate + ", acc.t_Connect_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter + " AND (T_CODE_CURRENCY!=0)"
                    + " ORDER BY Account";

        return TRsbDataSet( query );
    END;
END;

private CLASS( CCharacteristic110 ) CCharAccSpecial3( name_ )
    InitCCharacteristic110( name_, BOCB, accLogger, "Rest" );

    private var Attribute = "Премии";

    private MACRO GetObjects( )
        if( TuneTable.GetMasks( name ) == "" )
            return;
        end;
        var filter = " WHERE instr( acc.t_Type_Account, 'П' ) = 0 AND " + accountFilter.GetAsSqlString( "acc" )
                    + " AND (" + ConvertMaskToSQLFormat( TuneTable.GetMasks( name ), "acc.t_Account" ) + ")"
                    + " AND NOT rsb_rep_ac.CheckObjAttrPresence( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP
                    + ", rsb_kernel.GetObjAttrId( " + OBJTYPE_ACCOUNT + ", " + OBJ_ACCOUNT_GROUP_REP + ", CHR(1), '"
                    + Attribute + "' ), rsb_rep_ac.MakeAccountId( acc.t_Account, acc.t_Code_Currency, acc.t_Chapter, NULL )"
                    + ", " + SqlRepDate + " ) != 0";

        var query  = " SELECT acc.t_Account Account, LEAST( NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Account"
                                                        + " AND SubStr( doc.t_Account_Receiver, 1, 5 ) = '60306'"
                                                        + " AND doc.t_state = 1"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ), abs( rsb_rep_ac.resta( acc.t_Account, " + SqlPrevDate + ", acc.t_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter
                    + " UNION"
                    + " SELECT acc.t_Account Account, LEAST( NVL( ( SELECT SUM(NVL(t_Sum,0)) FROM  daccTrn_dbt doc"
                                                        + " WHERE doc.t_Chapter = acc.t_Connect_Chapter"
                                                        + " AND doc.t_Account_Payer = acc.t_Connect_Account"
                                                        + " AND doc.t_state = 1"
                                                        + " AND doc.t_Code_Currency = 0"
                                                        + " AND TRUNC(doc.t_Date_Carry) >= TRUNC(" + SqlBegDate + ")"
                                                        + " AND TRUNC(doc.t_Date_Carry) <= TRUNC(" + SqlRepDate + ") )"
                                                        + ", 0 ), abs( rsb_rep_ac.resta( acc.t_Connect_Account, " + SqlPrevDate + ", acc.t_Connect_Chapter, acc.t_r0 ) ) ) Rest"
                    + " FROM daccount_dbt acc" + filter + " AND (T_CODE_CURRENCY!=0)"
                    + " ORDER BY Account";

        return TRsbDataSet( query );
    END;
END;

// Регистрация расшифровок.
MACRO RegisterCharacteristics( )

 if( U_1660 )
    CharProcessor.Register( CCharAccRest( "A107/17", false, "Премии" ), 1 );
    CharProcessor.Register( CCharAccRest( "A40109/5.3", false, "40109/5.3" ), 5 );
    CharProcessor.Register( CCharAccRest( "A40109/9", false, "40109/9" ), 6 );
    CharProcessor.Register( CCharAccRest( "A/13" ), 24 );

    CharProcessor.Register( CCharAccRestSub( "A30126/3", "РВП" ), 2 );
    CharProcessor.Register( CCharAccRestSub( "A30226/3", "РВП" ), 3 );
    CharProcessor.Register( CCharAccRestSub( "A47425/3", "РВП" ), 4 );
    CharProcessor.Register( CCharAccRestSub( "A/5.4", "РВП,РВПС" ), 21 );
    CharProcessor.Register( CCharAccRestSub( "A/10", "РВП" ), 23 );

   if( isQuartal )
    CharProcessor.Register( CCharAccRest( "1111" ), 45 );
    CharProcessor.Register( CCharAccRest( "1121" ), 49 );
    CharProcessor.Register( CCharAccRest( "1122_ГК", true ), 50 );
    CharProcessor.Register( CCharAccRest( "2111" ), 53 );
    CharProcessor.Register( CCharAccRest( "2121" ), 56 );
    CharProcessor.Register( CCharAccRest( "2122_47502", true ), 58 );
    CharProcessor.Register( CCharAccRest( "2401_52505" ), 71 );
    CharProcessor.Register( CCharAccRest( "2402_52505" ), 72 );

    CharProcessor.Register( CCharAccTurnover( "A47402/5.2", false ), 7 );
    CharProcessor.Register( CCharAccTurnover( "S17311/12", false ), 25 );
    CharProcessor.Register( CCharAccTurnover( "S17311/13", false ), 26 );
    CharProcessor.Register( CCharAccTurnover( "S17312/12", false ), 27 );
    CharProcessor.Register( CCharAccTurnover( "S17312/13", false ), 28 );
    CharProcessor.Register( CCharAccTurnover( "S17313/12", false ), 29 );
    CharProcessor.Register( CCharAccTurnover( "S17313/13", false ), 30 );
    CharProcessor.Register( CCharAccTurnover( "S17314/12", false ), 31 );
    CharProcessor.Register( CCharAccTurnover( "S17314/13", false ), 32 );
    CharProcessor.Register( CCharAccTurnover( "S29410/12", true ), 34 );
    CharProcessor.Register( CCharAccTurnover( "S29410/13", true ), 35 );
    CharProcessor.Register( CCharAccTurnover( "S29411/12", true ), 36 );
    CharProcessor.Register( CCharAccTurnover( "S29411/13", true ), 37 );
    CharProcessor.Register( CCharAccTurnover( "S29412/12", true ), 38 );
    CharProcessor.Register( CCharAccTurnover( "S29412/13", true ), 39 );
    CharProcessor.Register( CCharAccTurnover( "S29413/12", true ), 40 );
    CharProcessor.Register( CCharAccTurnover( "S29413/13", true ), 41 );
    CharProcessor.Register( CCharAccTurnover( "4101", true ), 75 );
    CharProcessor.Register( CCharAccTurnover( "4301", true, "Премии" ), 78 );

    CharProcessor.Register( CCharAccSpecial1( "4201" ), 76 );
    CharProcessor.Register( CCharAccSpecial2( "4202" ), 77 );
    CharProcessor.Register( CCharAccSpecial3( "4302" ), 79 );
   end;

 else
    CharProcessor.Register( CCharAccRest( "A10702/17", false, "Премии" ), 1 );
    CharProcessor.Register( CCharAccRest( "A40109/5.3", false, "A40109/5.3" ), 3 );
    CharProcessor.Register( CCharAccRest( "A40109/9", false, "A40109/9" ), 4 );
    CharProcessor.Register( CCharAccRest( "A/5.1_ГК" ), 16 );
    CharProcessor.Register( CCharAccRest( "A/13" ), 21 );

    CharProcessor.Register( CCharAccRestSub( "A30126/3", "РВП" ), 2 );
    CharProcessor.Register( CCharAccRestSub( "A/5.2", "РВП,РВПС" ), 17 );
    CharProcessor.Register( CCharAccRestSub( "A/10", "РВП" ), 20 );

   if( isQuartal )
    CharProcessor.Register( CCharAccRest( "1111" ), 42 );
    CharProcessor.Register( CCharAccRest( "1121" ), 46 );
    CharProcessor.Register( CCharAccRest( "1122_ГК", true ), 47 );
    CharProcessor.Register( CCharAccRest( "2111" ), 50 );
    CharProcessor.Register( CCharAccRest( "2121" ), 53 );
    CharProcessor.Register( CCharAccRest( "2122_47502", true ), 54 );
    CharProcessor.Register( CCharAccRest( "2401_52505" ), 68 );
    CharProcessor.Register( CCharAccRest( "2402_52505" ), 69 );

    CharProcessor.Register( CCharAccTurnover( "S17311/12", false ), 22 );
    CharProcessor.Register( CCharAccTurnover( "S17311/13", false ), 23 );
    CharProcessor.Register( CCharAccTurnover( "S17312/12", false ), 24 );
    CharProcessor.Register( CCharAccTurnover( "S17312/13", false ), 25 );
    CharProcessor.Register( CCharAccTurnover( "S17313/12", false ), 26 );
    CharProcessor.Register( CCharAccTurnover( "S17313/13", false ), 27 );
    CharProcessor.Register( CCharAccTurnover( "S17314/12", false ), 28 );
    CharProcessor.Register( CCharAccTurnover( "S17314/13", false ), 29 );
    CharProcessor.Register( CCharAccTurnover( "S29410/12", true ), 31 );
    CharProcessor.Register( CCharAccTurnover( "S29410/13", true ), 32 );
    CharProcessor.Register( CCharAccTurnover( "S29411/12", true ), 33 );
    CharProcessor.Register( CCharAccTurnover( "S29411/13", true ), 34 );
    CharProcessor.Register( CCharAccTurnover( "S29412/12", true ), 35 );
    CharProcessor.Register( CCharAccTurnover( "S29412/13", true ), 36 );
    CharProcessor.Register( CCharAccTurnover( "S29413/12", true ), 37 );
    CharProcessor.Register( CCharAccTurnover( "S29413/13", true ), 38 );
    CharProcessor.Register( CCharAccTurnover( "4101", true ), 72 );
    CharProcessor.Register( CCharAccTurnover( "4301", true, "Премии" ), 75 );

    CharProcessor.Register( CCharAccSpecial1( "4201" ), 73 );
    CharProcessor.Register( CCharAccSpecial2( "4202" ), 74 );
    CharProcessor.Register( CCharAccSpecial3( "4302" ), 76 );
   end;

 end;

END;

/***************************************************************************************************
 *  Основная функция
 **************************************************************************************************/
macro processCb()
    registerCharacteristics();
end;

/***************************************************************************************************
 *  Точка входа
 **************************************************************************************************/
processCb();
