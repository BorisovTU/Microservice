/*
$Name:          f115CalculationPart2Controller.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 115. Контроллер расчета. Раздел 2.
*/

/**
 * Форма 115. Контроллер расчета. Раздел 2.
 *
 * @since   01.06.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */
import f115CalculationPartController;

/**
 *  Расчет переменных по 2061-У.
 *
 */
class (TCalculationPartController) TCalculationPart2Controller2061(dataSource, tuneTable, protocol, report)

    /**
     * Источник данных по портфелям в Loans-е.
     */
    private var m_loansCaseDataSource;

    /**
     * Источник данных по порфелям в ГК.
     */
    private var m_cbCaseDataSource;

    /**
     * Источик данных по счетам процентов в ГК.
     */
    private var m_cbInterestAccountDataSource;

    /**
     * Конструктор.
     */
    private macro constructor(dataSource, tuneTable, protocol, report)

        initTCalculationPartController(dataSource, tuneTable, protocol, report);

        m_loansCaseDataSource         = m_dataSource.getLoansCaseDataSource();
        m_cbCaseDataSource            = m_dataSource.getCbCaseDataSource();
        m_cbInterestAccountDataSource = m_dataSource.getCbInterestAccountDataSource();
    end;

    private macro setLineValue(attribute : TAttribute, dataSet, backOffice)
         if ((dataSet != null) and (not dataSet.EOF))
            attribute.setValue(dataSet.column_3,   "3", backOffice);
            attribute.setValue(dataSet.column_4,   "4", backOffice);
         else
            attribute.setValue(0,  "3", backOffice);
            attribute.setValue(0,  "4", backOffice);
         end;
    end;

    private macro addLineValue(attribute : TAttribute, dataSet, backOffice)
         if ((dataSet != null) and (not dataSet.EOF))
            attribute.plus(dataSet.column_3,   "3", backOffice);
            attribute.plus(dataSet.column_4,   "4", backOffice);
         end;
    end;

    private macro calculateAttribute1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1  (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("1.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("1.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("1.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("1.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("1.5"));
    end;

    private macro calculateAttribute2_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_3(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_4(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_5(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2  (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.5"));
    end;

    private macro calculateAttribute3_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "4_проц", BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "4_комисс(цб,УВ)", BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_2(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "4_комисс(цб,УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_3(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "4_комисс(цб,УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute3_4(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "4_комисс(цб_УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute3_5(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "4_комисс(цб_УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute3  (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("3.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("3.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("3.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("3.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("3.5"));
    end;

    private macro calculateAttribute4_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("2", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasReservePercent(20),
                                                   m_tuneTable.getRegisterNumber("2", "4.1", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientType("'Ю'","'П'","'КО'")
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasReservePercent(20)
                                                  ),
                     BOCb);
        /*+4комисс*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isJuridicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "4_комисс(цб_УВ)",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
   end;

    private macro calculateAttribute4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("2", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST),
                                                   m_tuneTable.getRegisterNumber("2", "4", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientType("'Ю'","'П'","'КО'")
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "4_проц",  BOCB))
                                                  ),
                     BOCb);
        /*+4комисс*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isJuridicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "4_комисс(цб_УВ)",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
    end;

    macro calculate(part : TPart)

        if (part.getNumber() == 2)

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));
            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));
            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));
            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
            m_protocol.printReportLineNumber("1.5");
            calculateAttribute1_5(part.getAttribute("1.5"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));
            m_protocol.printReportLineNumber("2.5");
            calculateAttribute2_5(part.getAttribute("2.5"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));

            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));
            m_protocol.printReportLineNumber("4");
            calculateAttribute4  (part.getAttribute("4"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("1.1").setUndefinedValue("4");
            part.getAttribute("2.1").setUndefinedValue("4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1");
            calculateAttribute1  (part.getAttribute("1"));

            m_protocol.printReportLineNumber("2");
            calculateAttribute2  (part.getAttribute("2"));

            m_protocol.printReportLineNumber("3");
            calculateAttribute3  (part.getAttribute("3"));
        end;
    end;

    constructor(dataSource, tuneTable, protocol, report);
end;

/**
 *  Расчет переменных по 2332-У.
 *
 */
class (TCalculationPart2Controller2061) TCalculationPart2Controller2332(dataSource, tuneTable, protocol, report)
    initTCalculationPart2Controller2061(dataSource, tuneTable, protocol, report);


    private macro calculateAttribute1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb);
    end;


    private macro calculateAttribute1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb);
    end;


    private macro calculateAttribute2_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 10)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1 (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.5"));
    end;

    private macro calculateAttribute2_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 10)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2 (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.5"));
    end;

    private macro calculateAttribute2 (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2"));
    end;

    private macro calculateAttribute3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4_2(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4_3(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4_4(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4_5(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute4  (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("4.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("4.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("4.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("4.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("4.5"));
    end;

    private macro calculateAttribute5_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц", BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб,УВ)", BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute5_2(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб,УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute5_3(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб,УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute5_4(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб_УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute5_5(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб_УВ)",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),

                     BOCb);
    end;

    private macro calculateAttribute5  (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("5.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("5.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("5.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("5.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("5.5"));
    end;

    private macro calculateAttribute6_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("2", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasReservePercent(20),
                                                   m_tuneTable.getRegisterNumber("2", "6.1", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientType("'Ю'","'П'","'КО'")
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasReservePercent(20)
                                                  ),
                     BOCb);
        /*+4комисс*/
        addLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isJuridicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "6_комисс(цб_УВ)",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("2", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST),
                                                   m_tuneTable.getRegisterNumber("2", "6", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientType("'Ю'","'П'","'КО'")
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "6_проц",  BOCB))
                                                  ),
                     BOCb);
        /*+4комисс*/
        addLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isJuridicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("2", "6_комисс(цб_УВ)",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
    end;


    macro calculate(part : TPart)

        if (part.getNumber() == 2)
            /*1.1-1.5 аналогично 1.1-1.5 TCalculationPart2Controller2061,
             + проверка отсутствия на портфеле категории "Обеспеченность ссуд в портфеле МСП"*/
            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));
            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));
            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));
            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
            m_protocol.printReportLineNumber("1.5");
            calculateAttribute1_5(part.getAttribute("1.5"));
            /*новые строки по 2332У*/
            m_protocol.printReportLineNumber("2.1.1");
            calculateAttribute2_1_1(part.getAttribute("2.1.1"));
            m_protocol.printReportLineNumber("2.1.2");
            calculateAttribute2_1_2(part.getAttribute("2.1.2"));
            m_protocol.printReportLineNumber("2.1.3");
            calculateAttribute2_1_3(part.getAttribute("2.1.3"));
            m_protocol.printReportLineNumber("2.1.4");
            calculateAttribute2_1_4(part.getAttribute("2.1.4"));
            m_protocol.printReportLineNumber("2.1.5");
            calculateAttribute2_1_5(part.getAttribute("2.1.5"));

            m_protocol.printReportLineNumber("2.2.1");
            calculateAttribute2_2_1(part.getAttribute("2.2.1"));
            m_protocol.printReportLineNumber("2.2.2");
            calculateAttribute2_2_2(part.getAttribute("2.2.2"));
            m_protocol.printReportLineNumber("2.2.3");
            calculateAttribute2_2_3(part.getAttribute("2.2.3"));
            m_protocol.printReportLineNumber("2.2.4");
            calculateAttribute2_2_4(part.getAttribute("2.2.4"));
            m_protocol.printReportLineNumber("2.2.5");
            calculateAttribute2_2_5(part.getAttribute("2.2.5"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));

            /*4.1-6.1 аналогично 2.1-4.1 TCalculationPart2Controller2061,
            скопировано в текущий класс с заменой номеров строк*/
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));
            m_protocol.printReportLineNumber("4.2");
            calculateAttribute4_2(part.getAttribute("4.2"));
            m_protocol.printReportLineNumber("4.3");
            calculateAttribute4_3(part.getAttribute("4.3"));
            m_protocol.printReportLineNumber("4.4");
            calculateAttribute4_4(part.getAttribute("4.4"));
            m_protocol.printReportLineNumber("4.5");
            calculateAttribute4_5(part.getAttribute("4.5"));

            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));
            m_protocol.printReportLineNumber("5.2");
            calculateAttribute5_2(part.getAttribute("5.2"));
            m_protocol.printReportLineNumber("5.3");
            calculateAttribute5_3(part.getAttribute("5.3"));
            m_protocol.printReportLineNumber("5.4");
            calculateAttribute5_4(part.getAttribute("5.4"));
            m_protocol.printReportLineNumber("5.5");
            calculateAttribute5_5(part.getAttribute("5.5"));

            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));
            m_protocol.printReportLineNumber("6");
            calculateAttribute6  (part.getAttribute("6"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("1.1").setUndefinedValue("4");
            part.getAttribute("3").setUndefinedValue("3");
            part.getAttribute("3").setUndefinedValue("4");
            part.getAttribute("4.1").setUndefinedValue("4");
            part.getAttribute("5.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1");
            calculateAttribute1  (part.getAttribute("1"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));

            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));

            m_protocol.printReportLineNumber("2");
            calculateAttribute2 (part.getAttribute("2"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4  (part.getAttribute("4"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5  (part.getAttribute("5"));
        end;
    end;
end;


/**
 *  Расчет переменных по 2926-У.
 *
 */
class (TCalculationPart2Controller2332) TCalculationPart2Controller2926(dataSource, tuneTable, protocol, report)
    initTCalculationPart2Controller2332(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute2_1_5(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_1_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_5(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);
    end;

    macro calculate(part : TPart)

        if (part.getNumber() == 2)
            /*1.1-1.5 аналогично 1.1-1.5 TCalculationPart2Controller2061,
             + проверка отсутствия на портфеле категории "Обеспеченность ссуд в портфеле МСП"*/
            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));
            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));
            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));
            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
            m_protocol.printReportLineNumber("1.5");
            calculateAttribute1_5(part.getAttribute("1.5"));
            /*новые строки по 2332У*/
            m_protocol.printReportLineNumber("2.1.1");
            calculateAttribute2_1_1(part.getAttribute("2.1.1"));
            m_protocol.printReportLineNumber("2.1.2");
            calculateAttribute2_1_2(part.getAttribute("2.1.2"));
            m_protocol.printReportLineNumber("2.1.3");
            calculateAttribute2_1_3(part.getAttribute("2.1.3"));
            m_protocol.printReportLineNumber("2.1.4");
            calculateAttribute2_1_4(part.getAttribute("2.1.4"));
            m_protocol.printReportLineNumber("2.1.5");
            calculateAttribute2_1_5(part.getAttribute("2.1.5"));
            m_protocol.printReportLineNumber("2.1.6");
            calculateAttribute2_1_6(part.getAttribute("2.1.6"));

            m_protocol.printReportLineNumber("2.2.1");
            calculateAttribute2_2_1(part.getAttribute("2.2.1"));
            m_protocol.printReportLineNumber("2.2.2");
            calculateAttribute2_2_2(part.getAttribute("2.2.2"));
            m_protocol.printReportLineNumber("2.2.3");
            calculateAttribute2_2_3(part.getAttribute("2.2.3"));
            m_protocol.printReportLineNumber("2.2.4");
            calculateAttribute2_2_4(part.getAttribute("2.2.4"));
            m_protocol.printReportLineNumber("2.2.5");
            calculateAttribute2_2_5(part.getAttribute("2.2.5"));
            m_protocol.printReportLineNumber("2.2.6");
            calculateAttribute2_2_6(part.getAttribute("2.2.6"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));

            /*4.1-6.1 аналогично 2.1-4.1 TCalculationPart2Controller2061,
            скопировано в текущий класс с заменой номеров строк*/
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));
            m_protocol.printReportLineNumber("4.2");
            calculateAttribute4_2(part.getAttribute("4.2"));
            m_protocol.printReportLineNumber("4.3");
            calculateAttribute4_3(part.getAttribute("4.3"));
            m_protocol.printReportLineNumber("4.4");
            calculateAttribute4_4(part.getAttribute("4.4"));
            m_protocol.printReportLineNumber("4.5");
            calculateAttribute4_5(part.getAttribute("4.5"));

            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));
            m_protocol.printReportLineNumber("5.2");
            calculateAttribute5_2(part.getAttribute("5.2"));
            m_protocol.printReportLineNumber("5.3");
            calculateAttribute5_3(part.getAttribute("5.3"));
            m_protocol.printReportLineNumber("5.4");
            calculateAttribute5_4(part.getAttribute("5.4"));
            m_protocol.printReportLineNumber("5.5");
            calculateAttribute5_5(part.getAttribute("5.5"));

            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));
            m_protocol.printReportLineNumber("6");
            calculateAttribute6  (part.getAttribute("6"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("1.1").setUndefinedValue("4");
            part.getAttribute("3").setUndefinedValue("3");
            part.getAttribute("3").setUndefinedValue("4");
            part.getAttribute("4.1").setUndefinedValue("4");
            part.getAttribute("5.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1");
            calculateAttribute1  (part.getAttribute("1"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));

            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));

            m_protocol.printReportLineNumber("2");
            calculateAttribute2 (part.getAttribute("2"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4  (part.getAttribute("4"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5  (part.getAttribute("5"));
        end;
    end;
end;

/**
 * Расчет переменных по 3129-У.
 */
class (TCalculationPart2Controller2926) TCalculationPart2Controller3129(dataSource, tuneTable, protocol, report)
    /**
     * Конструктор базового класса.
     */
    initTCalculationPart2Controller2926(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute7(attribute)
        setLineValue(attribute,
                      m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'")
                                                      ),
                      BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute7_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'", True)
                                                     ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'", rcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute8(attribute)
        setLineValue(attribute,
                      m_loansCaseDataSource.getRequirementsData(
                                                      m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                    + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'")
                                                      ),
                      BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute8_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'", True)
                                                     ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'", rcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute9(attribute)
        setLineValue(attribute,
                      m_loansCaseDataSource.getRequirementsData(
                                                      m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                    + m_loansCaseDataSource.getFilter().hasHigherKks("'3.12.3'")
                                                      ),
                      BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.12.3'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute9_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.12.3'", True)
                                                     ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.12.3'", rcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'")
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                   + m_cbCaseDataSource.getFilter().hasNotAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(5)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 10)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(6)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(7)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(8)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute2_1_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(10)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель обеспеченных ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute2_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(5)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 10)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(6)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(7)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(8)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute2_2_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().isUnSecuredCredit()
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasGot(10)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY, "'Портфель прочих ссуд'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_INST)
                                                   + m_loansCaseDataSource.getFilter().contragentIsEmployer()
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getJuridicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'")
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_ON_SECURITY)
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb); */
    end;

    /**
     * Расчет атрибутов.
     */
    macro calculate(part : TPart)
        if (part.getNumber() == 2)
            /*1.1-1.5 аналогично 1.1-1.5 TCalculationPart2Controller2061,
             + проверка отсутствия на портфеле категории "Обеспеченность ссуд в портфеле МСП"*/
            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));
            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));
            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));
            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
            m_protocol.printReportLineNumber("1.5");
            calculateAttribute1_5(part.getAttribute("1.5"));
            /*новые строки по 2332У*/
            m_protocol.printReportLineNumber("2.1.1");
            calculateAttribute2_1_1(part.getAttribute("2.1.1"));
            m_protocol.printReportLineNumber("2.1.2");
            calculateAttribute2_1_2(part.getAttribute("2.1.2"));
            m_protocol.printReportLineNumber("2.1.3");
            calculateAttribute2_1_3(part.getAttribute("2.1.3"));
            m_protocol.printReportLineNumber("2.1.4");
            calculateAttribute2_1_4(part.getAttribute("2.1.4"));
            m_protocol.printReportLineNumber("2.1.5");
            calculateAttribute2_1_5(part.getAttribute("2.1.5"));
            m_protocol.printReportLineNumber("2.1.6");
            calculateAttribute2_1_6(part.getAttribute("2.1.6"));

            m_protocol.printReportLineNumber("2.2.1");
            calculateAttribute2_2_1(part.getAttribute("2.2.1"));
            m_protocol.printReportLineNumber("2.2.2");
            calculateAttribute2_2_2(part.getAttribute("2.2.2"));
            m_protocol.printReportLineNumber("2.2.3");
            calculateAttribute2_2_3(part.getAttribute("2.2.3"));
            m_protocol.printReportLineNumber("2.2.4");
            calculateAttribute2_2_4(part.getAttribute("2.2.4"));
            m_protocol.printReportLineNumber("2.2.5");
            calculateAttribute2_2_5(part.getAttribute("2.2.5"));
            m_protocol.printReportLineNumber("2.2.6");
            calculateAttribute2_2_6(part.getAttribute("2.2.6"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));

            /*4.1-6.1 аналогично 2.1-4.1 TCalculationPart2Controller2061,
            скопировано в текущий класс с заменой номеров строк*/
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));
            m_protocol.printReportLineNumber("4.2");
            calculateAttribute4_2(part.getAttribute("4.2"));
            m_protocol.printReportLineNumber("4.3");
            calculateAttribute4_3(part.getAttribute("4.3"));
            m_protocol.printReportLineNumber("4.4");
            calculateAttribute4_4(part.getAttribute("4.4"));
            m_protocol.printReportLineNumber("4.5");
            calculateAttribute4_5(part.getAttribute("4.5"));

            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));
            m_protocol.printReportLineNumber("5.2");
            calculateAttribute5_2(part.getAttribute("5.2"));
            m_protocol.printReportLineNumber("5.3");
            calculateAttribute5_3(part.getAttribute("5.3"));
            m_protocol.printReportLineNumber("5.4");
            calculateAttribute5_4(part.getAttribute("5.4"));
            m_protocol.printReportLineNumber("5.5");
            calculateAttribute5_5(part.getAttribute("5.5"));

            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));
            m_protocol.printReportLineNumber("6");
            calculateAttribute6  (part.getAttribute("6"));
            m_protocol.printReportLineNumber("7.1");
            calculateAttribute7_1(part.getAttribute("7.1"));
            m_protocol.printReportLineNumber("7");
            calculateAttribute7  (part.getAttribute("7"));
            m_protocol.printReportLineNumber("8.1");
            calculateAttribute8_1(part.getAttribute("8.1"));
            m_protocol.printReportLineNumber("8");
            calculateAttribute8  (part.getAttribute("8"));
            m_protocol.printReportLineNumber("9.1");
            calculateAttribute9_1(part.getAttribute("9.1"));
            m_protocol.printReportLineNumber("9");
            calculateAttribute9  (part.getAttribute("9"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("1.1").setUndefinedValue("4");
            part.getAttribute("3").setUndefinedValue("3");
            part.getAttribute("3").setUndefinedValue("4");
            part.getAttribute("4.1").setUndefinedValue("4");
            part.getAttribute("5.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1");
            calculateAttribute1  (part.getAttribute("1"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));

            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));

            m_protocol.printReportLineNumber("2");
            calculateAttribute2 (part.getAttribute("2"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4  (part.getAttribute("4"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5  (part.getAttribute("5"));
        end;
    end;
end;

class (TCalculationPart2Controller3129) TCalculationPart2Controller4212(dataSource, tuneTable, protocol, report)
    initTCalculationPart2Controller3129(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute2_1 (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.5"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.1.6"));
    end;

    private macro calculateAttribute2_2 (attribute)
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.1"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.2"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.3"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.4"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.5"));
        addAttribute(attribute, m_report.getPart("2").getAttribute("2.2.6"));
    end;

    private macro calculateAttribute10(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц", BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб,УВ)", BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1, 2, 3, 4, 5)
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.12.3'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute10_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientType("'Ю'", "'П'", "'КО'")
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("2", "6_проц", BOCB),
                                                                                                  m_tuneTable.getAccountMasks("2", "6_комисс(цб,УВ)", BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1, 2, 3, 4, 5)
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.12.3'", rcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    macro calculate(part : TPart)
        if (part.getNumber() == 2)
            /*1.1-1.5 аналогично 1.1-1.5 TCalculationPart2Controller2061,
             + проверка отсутствия на портфеле категории "Обеспеченность ссуд в портфеле МСП"*/
            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));
            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));
            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));
            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
            m_protocol.printReportLineNumber("1.5");
            calculateAttribute1_5(part.getAttribute("1.5"));
            /*новые строки по 2332У*/
            m_protocol.printReportLineNumber("2.1.1");
            calculateAttribute2_1_1(part.getAttribute("2.1.1"));
            m_protocol.printReportLineNumber("2.1.2");
            calculateAttribute2_1_2(part.getAttribute("2.1.2"));
            m_protocol.printReportLineNumber("2.1.3");
            calculateAttribute2_1_3(part.getAttribute("2.1.3"));
            m_protocol.printReportLineNumber("2.1.4");
            calculateAttribute2_1_4(part.getAttribute("2.1.4"));
            m_protocol.printReportLineNumber("2.1.5");
            calculateAttribute2_1_5(part.getAttribute("2.1.5"));
            m_protocol.printReportLineNumber("2.1.6");
            calculateAttribute2_1_6(part.getAttribute("2.1.6"));

            m_protocol.printReportLineNumber("2.2.1");
            calculateAttribute2_2_1(part.getAttribute("2.2.1"));
            m_protocol.printReportLineNumber("2.2.2");
            calculateAttribute2_2_2(part.getAttribute("2.2.2"));
            m_protocol.printReportLineNumber("2.2.3");
            calculateAttribute2_2_3(part.getAttribute("2.2.3"));
            m_protocol.printReportLineNumber("2.2.4");
            calculateAttribute2_2_4(part.getAttribute("2.2.4"));
            m_protocol.printReportLineNumber("2.2.5");
            calculateAttribute2_2_5(part.getAttribute("2.2.5"));
            m_protocol.printReportLineNumber("2.2.6");
            calculateAttribute2_2_6(part.getAttribute("2.2.6"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));

            /*4.1-6.1 аналогично 2.1-4.1 TCalculationPart2Controller2061,
            скопировано в текущий класс с заменой номеров строк*/
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));
            m_protocol.printReportLineNumber("4.2");
            calculateAttribute4_2(part.getAttribute("4.2"));
            m_protocol.printReportLineNumber("4.3");
            calculateAttribute4_3(part.getAttribute("4.3"));
            m_protocol.printReportLineNumber("4.4");
            calculateAttribute4_4(part.getAttribute("4.4"));
            m_protocol.printReportLineNumber("4.5");
            calculateAttribute4_5(part.getAttribute("4.5"));

            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));
            m_protocol.printReportLineNumber("5.2");
            calculateAttribute5_2(part.getAttribute("5.2"));
            m_protocol.printReportLineNumber("5.3");
            calculateAttribute5_3(part.getAttribute("5.3"));
            m_protocol.printReportLineNumber("5.4");
            calculateAttribute5_4(part.getAttribute("5.4"));
            m_protocol.printReportLineNumber("5.5");
            calculateAttribute5_5(part.getAttribute("5.5"));

            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));
            m_protocol.printReportLineNumber("6");
            calculateAttribute6  (part.getAttribute("6"));
            m_protocol.printReportLineNumber("7.1");
            calculateAttribute7_1(part.getAttribute("7.1"));
            m_protocol.printReportLineNumber("7");
            calculateAttribute7  (part.getAttribute("7"));
            m_protocol.printReportLineNumber("8.1");
            calculateAttribute8_1(part.getAttribute("8.1"));
            m_protocol.printReportLineNumber("8");
            calculateAttribute8  (part.getAttribute("8"));
            m_protocol.printReportLineNumber("9.1");
            calculateAttribute9_1(part.getAttribute("9.1"));
            m_protocol.printReportLineNumber("9");
            calculateAttribute9  (part.getAttribute("9"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("1.1").setUndefinedValue("4");
            part.getAttribute("3").setUndefinedValue("3");
            part.getAttribute("3").setUndefinedValue("4");
            part.getAttribute("4.1").setUndefinedValue("4");
            part.getAttribute("5.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1");
            calculateAttribute1  (part.getAttribute("1"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));

            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));

            m_protocol.printReportLineNumber("2");
            calculateAttribute2 (part.getAttribute("2"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4  (part.getAttribute("4"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5  (part.getAttribute("5"));

            m_protocol.printReportLineNumber("10");
            calculateAttribute10(part.getAttribute("10"));
            m_protocol.printReportLineNumber("10.1");
            calculateAttribute10_1(part.getAttribute("10.1"));
        end;
    end;
end;