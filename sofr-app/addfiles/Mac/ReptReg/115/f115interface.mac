/*
$Name:          f115interface.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 115. Доступ к операциям формы.
*/

/**
 * Форма 115. Доступ к операциям формы.
 *
 * @since   01.06.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */
import BankInter;

import ReptCBInter;
import RcbCoreInter;
import SbCrdInter;

import testLib;

import f115Report;
import f115Global;
import f115ObjectFactory;
import f115CalculationController;
import f115CalculationProtocolView;
import f115KlikoExportController;
import f115KlikoView;
import f115PtkPsdExportController;
import f115PtkPsdView;
import f115DataSource;
import f115TuneTable;
import f115ReportView;
import f115PrintController;
import f115DataSource;
import f115NormalizationController;

/**
 *  Запуск операции расчета отчета
 */
macro executeCalculationOperation()
/*
    var profiler = TSQLProfiler(getTxtFileName("!F115CalculateProfile"));
    profiler.clear();
    profiler.on();
*/
    global.initializePackages();
    objectFactoryInstance.createCalculationController().calculateReport();
    begAction(0, "Сохранение рассчитанных данных");
    RcbApplication().TransactionManager().commit();
    endAction(1);
end;


/**
 *  Запуск операции печати отчета
 */
macro executePrintOperation()
    objectFactoryInstance.createPrintController().execute();
    RcbApplication().TransactionManager().rollback();
end;

/**
 *  Запуск операции экспорта в kliko.exe
 */
macro executeKlikoExportOperation()
    objectFactoryInstance.createKlikoExportController().execute();
    RcbApplication().TransactionManager().rollback();
end;

/**
 *  Запуск операции экспорта в ПТК ПСД
 */
macro executePtkPsdExportOperation()
    objectFactoryInstance.createPtkPsdExportController().execute();
    RcbApplication().TransactionManager().rollback();
end;

/**
 *  Запуск операции нормализации расчитанных данных.
 */
macro executeNormalizationOperation()
    objectFactoryInstance.createNormalizationController().execute();
    begAction(0, "Сохранение нормализованных данных");
    RcbApplication().TransactionManager().commit();
    endAction(1);
end;

установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
