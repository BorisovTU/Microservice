/*
$Name:          f115PrintController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 115. Контроллер печати.
*/

/**
 * Форма 115. Контроллер печати.
 *
 * @since   23.06.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */
import f115ObjectFactory;

/**
 * Операция печати.
 */
class TPrintController2061()

    /**
     * Ссылка на отчет
     */
    private var m_report; /* : TReport*/

    /**
     * Ссылка на отчет
     */
    private var m_view; /* Object */

    /**
     * Конструктор.
     */
    private macro constructor()
        m_view   = objectFactoryInstance.createReportView();
        m_report = objectFactoryInstance.createReport();
    end;

    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            view.printHeader();
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                    attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                    attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                    attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                    attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                    attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                    attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                    attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                    attribute[i].getStringValue("19")
                                     );
                elif ((partNumber == 2) OR (partNumber == 3))
                    if ((partNumber == 3) AND (substr(attribute[i].getName(), 4, 4) == ".1.1" ))
                        view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), stringUndefined);
                    else
                        view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                    end;
                elif (partNumber == 4)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;

    /**
     * Печать содержательной части отчета (состоит из таблиц разделов).
     */
    private macro printDataZone()
        var i : Integer;
        i = 1;
        while(m_view.getPartView(i) != null)
            printPart(i);
            i = i + 1;
        end;
    end;

    /**
     * Нахождение максимальной ширины частей отчетной формы.
     */
    private macro getPartsWidthMax() : Integer
        var widthMax : Integer;
        var i        : Integer;

        i        = 1;
        widthMax = 0;

        while(m_view.getPartView(i) != null)
            widthMax = max(widthMax, m_view.getPartView(i).getWidth());
            i = i + 1;
        end;

        return widthMax;
    end;

    /**
     * Выполнить печать.
     */
    macro execute()
        var oldOutput;

        m_view.setOutputFile();

        m_view.setReportWidth(getPartsWidthMax());
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();

        if(m_report.isEmpty())
            m_view.printNullDataZone();
        else
            printDataZone();
        end;

        m_view.printSignatureZone();

        m_view.show();

        m_view.resetOutputFile();
    end;

    constructor();
end;

/**
 * Операция печати.
 */
class (TPrintController2061) TPrintController2627()
   initTPrintController2061();
    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            view.printHeader();
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                    attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                    attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                    attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                    attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                    attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                    attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                    attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                    attribute[i].getStringValue("19")
                                     );
                elif ((partNumber == 2) OR (partNumber == 3))
                        view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                elif (partNumber == 4)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;
end;

class (TPrintController2627) TPrintController2742()
   initTPrintController2627();
    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            view.printHeader();
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                    attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                    attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                    attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                    attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                    attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                    attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                    attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                    attribute[i].getStringValue("19")
                                     );
                elif ((partNumber == 2) OR (partNumber == 3) OR ((partNumber == 4) and in(attribute[i].getName(), "4.1", "4.2", "4.3", "4.4", "4.5")))
                        view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                elif (partNumber == 4)
                        view.printString(attribute[i].getName(), attribute[i].getStringValue());
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;
end;

class (TPrintController2742) TPrintController2835()
   initTPrintController2742();
    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;
        const INITIALATTRIBUTEPART5ITEM4 = 16; //номер атрибута с которого начинается пункт 4 раздела справочно

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            view.printHeader();
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                              attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                              attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                              attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                              attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                              attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                              attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                              attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                              attribute[i].getStringValue("19"));
                elif ((partNumber == 2) OR (partNumber == 3) OR (partNumber == 4))
                    view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                elif (partNumber == 5)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                    view.printHeader();
                    if (i == INITIALATTRIBUTEPART5ITEM4)
                        var j = 1;
                        var iteratorPart5Item4 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт4").createValueIterator();
                        iteratorPart5Item4.moveFirst();
                        while (not iteratorPart5Item4.isDone())
                            view.printStringPart5Item4(j,
                                                  iteratorPart5Item4.currentItem.fieldValue("name").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("inn").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("iLicense").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("nSecurities").current,
                                                  iteratorPart5Item4.currentItem.fieldValue("bookValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("presentValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve283").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve2732").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve").scaled);
                            j = j + 1;
                            iteratorPart5Item4.moveNext();
                        end;
                        if (j > 1)
                            view.printStringPart5Item4(0);
                        end;
                    end;
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;
end;

class (TPrintController2835) TPrintController2926()
   initTPrintController2835();
    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;
        const INITIALATTRIBUTEPART5ITEM4 = 14; //номер атрибута с которого начинается пункт 4 раздела справочно

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            view.printHeader();
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                              attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                              attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                              attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                              attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                              attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                              attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                              attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                              attribute[i].getStringValue("19"));
                elif ((partNumber == 2) OR (partNumber == 3) OR (partNumber == 4))
                    view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                elif (partNumber == 5)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                    view.printHeader();
                    if (i == INITIALATTRIBUTEPART5ITEM4)
                        var j = 1;
                        var iteratorPart5Item4 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт4").createValueIterator();
                        iteratorPart5Item4.moveFirst();
                        while (not iteratorPart5Item4.isDone())
                            view.printStringPart5Item4(j,
                                                  iteratorPart5Item4.currentItem.fieldValue("name").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("inn").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("iLicense").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("nSecurities").current,
                                                  iteratorPart5Item4.currentItem.fieldValue("bookValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("presentValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve283").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve2732").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve").scaled);
                            j = j + 1;
                            iteratorPart5Item4.moveNext();
                        end;
                        if (j > 1)
                            view.printStringPart5Item4(0);
                        end;
                    end;
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;
end;

class (TPrintController2926) TPrintController3129()
   initTPrintController2926();

    /**
     * Выполнить печать.
     */
    macro execute()
        var oldOutput;

        m_view.setOutputFile();
        m_view.setReportWidth(getPartsWidthMax());
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Сокращенное фирменное наименование кредитной организации (головной кредитной организации банковской группы) ");

        if(m_report.isEmpty())
            m_view.printNullDataZone();
        else
            printDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();
        m_view.resetOutputFile();
    end;

    constructor();
end;

class (TPrintController3129) TPrintController3129_2()
   initTPrintController3129();

    /**
     * Выполнить печать.
     */
    macro execute()

        var oldOutput;

        m_view.setOutputFile();
        m_view.setReportWidth(getPartsWidthMax());
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Сокращенное фирменное наименование кредитной организации (головной кредитной организации банковской группы) ");

        if(m_report.isEmpty())
            m_view.printNullDataZone();
        else
            printDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();
        m_view.resetOutputFile();
    end;

    /**
     * Печать раздела.
     */
    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;
        const INITIALATTRIBUTEPART5ITEM4 = 14; //номер атрибута с которого начинается пункт 4 раздела справочно

        view      = m_view.getPartView(partNumber);
        i         = 0;

        view.printPartName();

        if(m_report.getPart(partNumber).isEmpty())
           m_view.printNullDataZone();
        else
            if ((partNumber == 2) or (partNumber == 3))
                view.printHeaderWithoutUnitName();
            else
                view.printHeader();
            end;
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(),  attribute[i].getStringValue( "3"), attribute[i].getStringValue( "4"),
                                                              attribute[i].getStringValue( "5"), attribute[i].getStringValue( "6"),
                                                              attribute[i].getStringValue( "7"), attribute[i].getStringValue( "8"),
                                                              attribute[i].getStringValue( "9"), attribute[i].getStringValue("10"),
                                                              attribute[i].getStringValue("11"), attribute[i].getStringValue("12"),
                                                              attribute[i].getStringValue("13"), attribute[i].getStringValue("14"),
                                                              attribute[i].getStringValue("15"), attribute[i].getStringValue("16"),
                                                              attribute[i].getStringValue("17"), attribute[i].getStringValue("18"),
                                                              attribute[i].getStringValue("19"));
                elif ((partNumber == 2) OR (partNumber == 3) OR (partNumber == 4))
                    view.printString(attribute[i].getName(), attribute[i].getStringValue("3"), attribute[i].getStringValue("4"));
                elif (partNumber == 5)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                    view.printHeader();
                    if (i == INITIALATTRIBUTEPART5ITEM4)
                        var j = 1;
                        var iteratorPart5Item4 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт4").createValueIterator();
                        iteratorPart5Item4.moveFirst();
                        while (not iteratorPart5Item4.isDone())
                            view.printStringPart5Item4(j,
                                                  iteratorPart5Item4.currentItem.fieldValue("name").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("inn").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("iLicense").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("nSecurities").current,
                                                  iteratorPart5Item4.currentItem.fieldValue("bookValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("presentValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve283").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve2732").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve").scaled);
                            j = j + 1;
                            iteratorPart5Item4.moveNext();
                        end;
                        if (j > 1)
                            view.printStringPart5Item4(0);
                        end;
                    end;
                    if (attribute[i].getName() == "5")
                        var iteratorPart5Item_6_1 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1").createValueIterator();
                        iteratorPart5Item_6_1.moveFirst();
                        if (not iteratorPart5Item_6_1.isDone())
                            view.printStringPart5Item6(
                                                      "1",
                                                      iteratorPart5Item_6_1.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1.currentItem.fieldValue("reserve").currentAsString,
                                                      "X"
                                                      );
                        end;
                        var iteratorPart5Item_6_1_1 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1_1").createValueIterator();
                        iteratorPart5Item_6_1_1.moveFirst();
                        if (not iteratorPart5Item_6_1_1.isDone())
                            view.printStringPart5Item6(
                                                      "1.1",
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("reserve").currentAsString,
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("justCost").currentAsString
                                                      );
                        end;
                        var iteratorPart5Item_6_1_2 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1_2").createValueIterator();
                        iteratorPart5Item_6_1_2.moveFirst();
                        if (not iteratorPart5Item_6_1_2.isDone())
                            view.printStringPart5Item6(
                                                      "1.2",
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("reserve").currentAsString,
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("justCost").currentAsString
                                                      );
                        end;
                    end;
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;

    constructor();
end;

class (TPrintController3129_2) TPrintController4212()
   initTPrintController3129_2();

    macro execute()
        var oldOutput;

        m_view.setOutputFile();
        m_view.setReportWidth(getPartsWidthMax());
        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации (головной кредитной организации банковской группы) ");

        if(m_report.isEmpty())
            m_view.printNullDataZone();
        else
            printDataZone();
        end;

        m_view.printSignatureZone();
        m_view.show();
        m_view.resetOutputFile();
    end;
end;

class (TPrintController4212) TPrintController4637()
   initTPrintController4212();

    macro printPart(partNumber : Integer)
        var view;
        var attribute;
        var i;
        const INITIALATTRIBUTEPART5ITEM4 = 14; //номер атрибута с которого начинается пункт 4 раздела справочно

        view = m_view.getPartView(partNumber);
        i    = 0;

        view.printPartName();

        if (m_report.getPart(partNumber).isEmpty())
            m_view.printNullDataZone();
        else
            if ((partNumber == 2) or (partNumber == 3))
                view.printHeaderWithoutUnitName();
            else
                view.printHeader();
            end;
            attribute = m_report.getPart(partNumber).getAttributes();
            while (i < attribute.size)
                view.printSeparator();
                if (partNumber == 1)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue( "3"),
                                                             attribute[i].getStringValue( "4"),
                                                             attribute[i].getStringValue( "5"),
                                                             attribute[i].getStringValue( "6"),
                                                             attribute[i].getStringValue( "7"),
                                                             ternary((i != 32) and (i != 34), attribute[i].getStringValue( "8"), "X"),
                                                             ternary((i != 1), attribute[i].getStringValue( "9"), "X"),
                                                             ternary((i != 1), attribute[i].getStringValue("10"), "X"),
                                                             ternary((i != 1), attribute[i].getStringValue("11"), "X"),
                                                             ternary((i != 1) and (i != 32) and (i != 34), attribute[i].getStringValue( "12"), "X"),
                                                             attribute[i].getStringValue("13"),
                                                             ternary((i != 1), attribute[i].getStringValue("14"), "X"),
                                                             attribute[i].getStringValue("15"),
                                                             attribute[i].getStringValue("16"),
                                                             attribute[i].getStringValue("17"),
                                                             attribute[i].getStringValue("18"),
                                                             ternary((i != 34), attribute[i].getStringValue("19"), "X"));
                elif (partNumber == 2)
                    view.printString(attribute[i].getName(),
                                     ternary((i != 21), attribute[i].getStringValue("3"), "X"),
                                     ternary((i != 1) and (i != 21) and (i != 27) and (i != 33), attribute[i].getStringValue("4"), "X"));
                elif (partNumber == 3)
                    view.printString(attribute[i].getName(),
                                     ternary((i != 57), attribute[i].getStringValue("3"), "X"),
                                     ternary((i != 57) and (i != 58) and (i != 64), attribute[i].getStringValue("4"), "X"));
                elif (partNumber == 4)
                    view.printString(attribute[i].getName(),
                                     attribute[i].getStringValue("3"),
                                     attribute[i].getStringValue("4"));
                elif (partNumber == 5)
                    view.printString(attribute[i].getName(), attribute[i].getStringValue());
                    view.printHeader();
                    if (i == INITIALATTRIBUTEPART5ITEM4)
                        var j = 1;
                        var iteratorPart5Item4 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт4").createValueIterator();
                        iteratorPart5Item4.moveFirst();
                        while (not iteratorPart5Item4.isDone())
                            view.printStringPart5Item4(j,
                                                  iteratorPart5Item4.currentItem.fieldValue("name").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("inn").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("iLicense").currentAsString,
                                                  iteratorPart5Item4.currentItem.fieldValue("nSecurities").current,
                                                  iteratorPart5Item4.currentItem.fieldValue("bookValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("presentValue").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve283").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve2732").scaled,
                                                  iteratorPart5Item4.currentItem.fieldValue("madeReserve").scaled);
                            j = j + 1;
                            iteratorPart5Item4.moveNext();
                        end;
                        if (j > 1)
                            view.printStringPart5Item4(0);
                        end;
                    end;
                    if (attribute[i].getName() == "5")
                        var iteratorPart5Item_6_1 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1").createValueIterator();
                        iteratorPart5Item_6_1.moveFirst();
                        if (not iteratorPart5Item_6_1.isDone())
                            view.printStringPart5Item6(
                                                      "1",
                                                      iteratorPart5Item_6_1.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1.currentItem.fieldValue("reserve").currentAsString,
                                                      "X"
                                                      );
                        end;
                        var iteratorPart5Item_6_1_1 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1_1").createValueIterator();
                        iteratorPart5Item_6_1_1.moveFirst();
                        if (not iteratorPart5Item_6_1_1.isDone())
                            view.printStringPart5Item6(
                                                      "1.1",
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("reserve").currentAsString,
                                                      iteratorPart5Item_6_1_1.currentItem.fieldValue("justCost").currentAsString
                                                      );
                        end;
                        var iteratorPart5Item_6_1_2 = RcbApplication().currentReport.attributeValue("РазделСправочноПункт6_1_2").createValueIterator();
                        iteratorPart5Item_6_1_2.moveFirst();
                        if (not iteratorPart5Item_6_1_2.isDone())
                            view.printStringPart5Item6(
                                                      "1.2",
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("demandAmount").currentAsString,
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("reserve").currentAsString,
                                                      iteratorPart5Item_6_1_2.currentItem.fieldValue("justCost").currentAsString
                                                      );
                        end;
                    end;
                end;
                i = i + 1;
            end;
            view.printBottom();
        end;
    end;
end;