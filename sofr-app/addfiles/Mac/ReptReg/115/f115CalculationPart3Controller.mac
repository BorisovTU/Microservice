/*
$Name:          f115CalculationPart3Controller.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 115. Контроллер расчета. Раздел 3.
*/

/**
 * Форма 115. Контроллер расчета. Раздел 3.
 *
 * @since   01.06.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */
import f115CalculationPartController;

/**
 *  Расчет переменных по 2061-У.
 *
 */
class (TCalculationPartController) TCalculationPart3Controller2061(dataSource, tuneTable, protocol, report)

    /**
     * Источник данных по портфелям в Loans-е.
     */
    private var m_loansCaseDataSource;

    /**
     * Источник данных по порфелям в ГК.
     */
    private var m_cbCaseDataSource;

    /**
     * Источик данных по счетам процентов в ГК.
     */
    private var m_cbInterestAccountDataSource;

    /**
     * Конструктор.
     */
    private macro constructor(dataSource, tuneTable, protocol, report)

       initTCalculationPartController(dataSource, tuneTable, protocol, report);

        m_loansCaseDataSource         = m_dataSource.getLoansCaseDataSource();
        m_cbCaseDataSource            = m_dataSource.getCbCaseDataSource();
        m_cbInterestAccountDataSource = m_dataSource.getCbInterestAccountDataSource();
    end;

    private macro setLineValue(attribute : TAttribute, dataSet, backOffice)
         if ((dataSet != null) and (not dataSet.EOF))
            attribute.setValue(dataSet.column_3,   "3", backOffice);
            attribute.setValue(dataSet.column_4,   "4", backOffice);
         else
            attribute.setValue(0,  "3", backOffice);
            attribute.setValue(0,  "4", backOffice);
         end;
    end;

    private macro addLineValue(attribute : TAttribute, dataSet, backOffice)
         if ((dataSet != null) and (not dataSet.EOF))
            attribute.plus(dataSet.column_3,   "3", backOffice);
            attribute.plus(dataSet.column_4,   "4", backOffice);
         end;
    end;

    private macro setLineUserValue(attribute : TAttribute)
         m_protocol.printUserDataCopyMessage();
        attribute.setValue(m_report.getUserAttributeValue(attribute.getName(), "3"), "3", BOUser);
        attribute.setValue(m_report.getUserAttributeValue(attribute.getName(), "4"), "4", BOUser);
    end;

    private macro calculateAttribute1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;


    private macro calculateAttribute1_3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_3_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);

    end;


    private macro calculateAttribute1_4_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;


    private macro calculateAttribute1_1  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.5"));
    end;

    private macro calculateAttribute1_2  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.5"));
    end;

    private macro calculateAttribute1_3  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.5"));
    end;

    private macro calculateAttribute1_4  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.5"));
    end;

    private macro calculateAttribute2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute2(attribute)
        setLineValue(attribute, null);
    end;


    private macro calculateAttribute3_1(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д) портфель резерв > 20%', 'Комиссия(П/Д) портфель резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(1)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_2(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д) портфель резерв > 20%', 'Комиссия(П/Д) портфель резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_3(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д) портфель резерв > 20%', 'Комиссия(П/Д) портфель резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_4(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д) портфель резерв > 20%', 'Комиссия(П/Д) портфель резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3_5(attribute)
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoss)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasNotAccount(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB),
                                                                                                  m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB),
                                                                                                  "'Комиссия', 'Комиссия(П/Д) портфель резерв > 20%', 'Комиссия(П/Д) портфель резерв < 20%', 'П/Д'"
                                                                                                 )
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute3  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("3.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("3.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("3.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("3.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("3.5"));
    end;

    private macro calculateAttribute4_1  (attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("3", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasReservePercent(20),
                                                   m_tuneTable.getRegisterNumber("3", "4.1", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("3", "4.1_проц",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasReservePercent(20)
                                                  ),
                     BOCb);
        /*+4комисс*/
        addLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isPhysicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("3", "4.1_комисс",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
   end;

    private macro calculateAttribute4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getPercentRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasDataTuneTable(m_tuneTable.getRegisterNumber("3", attribute.getName(),  BOLoans))
                                                   + m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN),
                                                   m_tuneTable.getRegisterNumber("3", "4", BOLoans)
                                                  ),
                     BOLoans);

        /*4проц*/
        setLineValue(attribute,
                     m_cbInterestAccountDataSource.getData(
                                                     m_cbInterestAccountDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("3", "4_проц",  BOCB))
                                                  ),
                     BOCb);
        /*+4комисс*/
        addLineValue(attribute,
                     m_cbInterestAccountDataSource.getCommissionData(
                                                     m_cbInterestAccountDataSource.getFilter().isPhysicalPerson()
                                                   + m_cbInterestAccountDataSource.getFilter().isSatisfiesToAccountMasks(m_tuneTable.getAccountMasks("3", "4_комисс",  BOCB))
                                                   + m_cbInterestAccountDataSource.getFilter().hasAssignedAccountCategory("'Комиссия(П/Д)_портфель_резерв > 20%', 'Комиссия(П/Д)_портфель_резерв < 20%'",RCB_OBJGROUP_ACTIVEKIND)
                                                  ),
                     BOCb);
    end;




    macro calculate(part : TPart)

        if (part.getNumber() == 3)

            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
            else
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_1(part.getAttribute("1.1.1"));
            end;
            m_protocol.printReportLineNumber("1.1.2");
            calculateAttribute1_1_2(part.getAttribute("1.1.2"));
            m_protocol.printReportLineNumber("1.1.3");
            calculateAttribute1_1_3(part.getAttribute("1.1.3"));
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_4(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_5(part.getAttribute("1.1.5"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
            else
                m_protocol.printReportLineNumber("1.2.1");
                calculateAttribute1_2_1(part.getAttribute("1.2.1"));
            end;
            m_protocol.printReportLineNumber("1.2.2");
            calculateAttribute1_2_2(part.getAttribute("1.2.2"));
            m_protocol.printReportLineNumber("1.2.3");
            calculateAttribute1_2_3(part.getAttribute("1.2.3"));
            m_protocol.printReportLineNumber("1.2.4");
            calculateAttribute1_2_4(part.getAttribute("1.2.4"));
            m_protocol.printReportLineNumber("1.2.5");
            calculateAttribute1_2_5(part.getAttribute("1.2.5"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                part.getAttribute("1.3.1").setUndefinedValue( "3", "4");
            else
                m_protocol.printReportLineNumber("1.3.1");
                calculateAttribute1_3_1(part.getAttribute("1.3.1"));
            end;
            m_protocol.printReportLineNumber("1.3.2");
            calculateAttribute1_3_2(part.getAttribute("1.3.2"));
            m_protocol.printReportLineNumber("1.3.3");
            calculateAttribute1_3_3(part.getAttribute("1.3.3"));
            m_protocol.printReportLineNumber("1.3.4");
            calculateAttribute1_3_4(part.getAttribute("1.3.4"));
            m_protocol.printReportLineNumber("1.3.5");
            calculateAttribute1_3_5(part.getAttribute("1.3.5"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                part.getAttribute("1.4.1").setUndefinedValue( "3", "4");
            else
                m_protocol.printReportLineNumber("1.4.1");
                calculateAttribute1_4_1(part.getAttribute("1.4.1"));
            end;
            m_protocol.printReportLineNumber("1.4.2");
            calculateAttribute1_4_2(part.getAttribute("1.4.2"));
            m_protocol.printReportLineNumber("1.4.3");
            calculateAttribute1_4_3(part.getAttribute("1.4.3"));
            m_protocol.printReportLineNumber("1.4.4");
            calculateAttribute1_4_4(part.getAttribute("1.4.4"));
            m_protocol.printReportLineNumber("1.4.5");
            calculateAttribute1_4_5(part.getAttribute("1.4.5"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            /*это переменные, которые не должны были расчитываться*/
            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1 (part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2 (part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3 (part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4 (part.getAttribute("1.4"));
        end;
    end;

    constructor(dataSource, tuneTable, protocol, report);
end;


/**
 *  Расчет переменных по 2332-У.
 *
 */
class (TCalculationPart3Controller2061) TCalculationPart3Controller2332(dataSource, tuneTable, protocol, report)
    initTCalculationPart3Controller2061(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute1_1_0(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("на покупку жилья")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_0_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'На покупку жилья'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);
        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_2_0(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("ипотека")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_0_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Ипотека'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_3_0(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAim("автокредиты")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_0_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Автомобиль'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_4_0(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAim("потребительские ссуды", "овердрафт")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_0_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAim("'Неотложные нужды', 'Овердрафт'")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    macro calculate(part : TPart)

        if (part.getNumber() == 3)
            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_0(part.getAttribute("1.1.1"));
                m_protocol.printReportLineNumber("1.1.1.1");
                calculateAttribute1_1_0_1(part.getAttribute("1.1.1.1"));
                part.getAttribute("1.1.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.1.2");
                calculateAttribute1_1_1(part.getAttribute("1.1.2"));
                m_protocol.printReportLineNumber("1.1.3");
                calculateAttribute1_1_2(part.getAttribute("1.1.3"));
            end;
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_3(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_4(part.getAttribute("1.1.5"));
            m_protocol.printReportLineNumber("1.1.6");
            calculateAttribute1_1_5(part.getAttribute("1.1.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.2.1");
                calculateAttribute1_2_0(part.getAttribute("1.2.1"));
                m_protocol.printReportLineNumber("1.2.1.1");
                calculateAttribute1_2_0_1(part.getAttribute("1.2.1.1"));
                part.getAttribute("1.2.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.2.2");
                calculateAttribute1_2_1(part.getAttribute("1.2.2"));
                m_protocol.printReportLineNumber("1.2.3");
                calculateAttribute1_2_2(part.getAttribute("1.2.3"));
            end;
            m_protocol.printReportLineNumber("1.2.4");
            calculateAttribute1_2_3(part.getAttribute("1.2.4"));
            m_protocol.printReportLineNumber("1.2.5");
            calculateAttribute1_2_4(part.getAttribute("1.2.5"));
            m_protocol.printReportLineNumber("1.2.6");
            calculateAttribute1_2_5(part.getAttribute("1.2.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.3.1");
                calculateAttribute1_3_0(part.getAttribute("1.3.1"));
                m_protocol.printReportLineNumber("1.3.1.1");
                calculateAttribute1_3_0_1(part.getAttribute("1.3.1.1"));
                part.getAttribute("1.3.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.3.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.3.2");
                calculateAttribute1_3_1(part.getAttribute("1.3.2"));
                m_protocol.printReportLineNumber("1.3.3");
                calculateAttribute1_3_2(part.getAttribute("1.3.3"));
            end;
            m_protocol.printReportLineNumber("1.3.4");
            calculateAttribute1_3_3(part.getAttribute("1.3.4"));
            m_protocol.printReportLineNumber("1.3.5");
            calculateAttribute1_3_4(part.getAttribute("1.3.5"));
            m_protocol.printReportLineNumber("1.3.6");
            calculateAttribute1_3_5(part.getAttribute("1.3.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.4.1");
                calculateAttribute1_4_0(part.getAttribute("1.4.1"));
                m_protocol.printReportLineNumber("1.4.1.1");
                calculateAttribute1_4_0_1(part.getAttribute("1.4.1.1"));
                part.getAttribute("1.4.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.4.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.4.2");
                calculateAttribute1_4_1(part.getAttribute("1.4.2"));
                m_protocol.printReportLineNumber("1.4.3");
                calculateAttribute1_4_2(part.getAttribute("1.4.3"));
            end;
            m_protocol.printReportLineNumber("1.4.4");
            calculateAttribute1_4_3(part.getAttribute("1.4.4"));
            m_protocol.printReportLineNumber("1.4.5");
            calculateAttribute1_4_4(part.getAttribute("1.4.5"));
            m_protocol.printReportLineNumber("1.4.6");
            calculateAttribute1_4_5(part.getAttribute("1.4.6"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1 (part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2 (part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3 (part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4 (part.getAttribute("1.4"));
        end;
    end;
end;


/**
 *  Расчет переменных по 2539-У.
 *
 */
class (TCalculationPart3Controller2332) TCalculationPart3Controller2539(dataSource, tuneTable, protocol, report)
    initTCalculationPart3Controller2332(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute1_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);
        setLineUserValue(attribute);
    end;


    private macro calculateAttribute1_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_1_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);

    end;


    private macro calculateAttribute1_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_7_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_7_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_2_7_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_7_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_7_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_7_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_2_7_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_3_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_3_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);

    end;


    private macro calculateAttribute1_4_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20)/*Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getNotOverdueRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,0),
                                                     m_tuneTable.getRegisterNumber("3", attribute.getName(), BOLoans),
                                                     m_tuneTable.getDelayRegisterNumber("3", attribute.getName(), BOLoans)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_4_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /*НЕ Объединять ссуды*/
                                                            )
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181)
                                                  ),
                     BOLoans);
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.1.6"));
    end;

    private macro calculateAttribute1_2  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.6"));
    end;

    private macro calculateAttribute1_2_7  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.2.7.6"));
    end;

    private macro calculateAttribute1_3  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.6"));
    end;

    private macro calculateAttribute1_4  (attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.6"));
    end;

    macro calculate(part : TPart)

        if (part.getNumber() == 3)
            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_1(part.getAttribute("1.1.1"));
                m_protocol.printReportLineNumber("1.1.1.1");
                calculateAttribute1_1_1_1(part.getAttribute("1.1.1.1"));
                part.getAttribute("1.1.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.1.2");
                calculateAttribute1_1_2(part.getAttribute("1.1.2"));
                m_protocol.printReportLineNumber("1.1.3");
                calculateAttribute1_1_3(part.getAttribute("1.1.3"));
            end;
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_4(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_5(part.getAttribute("1.1.5"));
            m_protocol.printReportLineNumber("1.1.6");
            calculateAttribute1_1_6(part.getAttribute("1.1.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.2.1");
                calculateAttribute1_2_1(part.getAttribute("1.2.1"));
                m_protocol.printReportLineNumber("1.2.1.1");
                calculateAttribute1_2_1_1(part.getAttribute("1.2.1.1"));
                part.getAttribute("1.2.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.2.2");
                calculateAttribute1_2_2(part.getAttribute("1.2.2"));
                m_protocol.printReportLineNumber("1.2.3");
                calculateAttribute1_2_3(part.getAttribute("1.2.3"));
            end;
            m_protocol.printReportLineNumber("1.2.4");
            calculateAttribute1_2_4(part.getAttribute("1.2.4"));
            m_protocol.printReportLineNumber("1.2.5");
            calculateAttribute1_2_5(part.getAttribute("1.2.5"));
            m_protocol.printReportLineNumber("1.2.6");
            calculateAttribute1_2_6(part.getAttribute("1.2.6"));
            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.2.7.1");
                calculateAttribute1_2_7_1(part.getAttribute("1.2.7.1"));
                m_protocol.printReportLineNumber("1.2.7.1.1");
                calculateAttribute1_2_7_1_1(part.getAttribute("1.2.7.1.1"));
                part.getAttribute("1.2.7.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.7.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.2.7.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.7.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.2.7.2");
                calculateAttribute1_2_7_2(part.getAttribute("1.2.7.2"));
                m_protocol.printReportLineNumber("1.2.7.3");
                calculateAttribute1_2_7_3(part.getAttribute("1.2.7.3"));
            end;
            m_protocol.printReportLineNumber("1.2.7.4");
            calculateAttribute1_2_7_4(part.getAttribute("1.2.7.4"));
            m_protocol.printReportLineNumber("1.2.7.5");
            calculateAttribute1_2_7_5(part.getAttribute("1.2.7.5"));
            m_protocol.printReportLineNumber("1.2.7.6");
            calculateAttribute1_2_7_6(part.getAttribute("1.2.7.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.3.1");
                calculateAttribute1_3_1(part.getAttribute("1.3.1"));
                m_protocol.printReportLineNumber("1.3.1.1");
                calculateAttribute1_3_1_1(part.getAttribute("1.3.1.1"));
                part.getAttribute("1.3.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.3.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.3.2");
                calculateAttribute1_3_2(part.getAttribute("1.3.2"));
                m_protocol.printReportLineNumber("1.3.3");
                calculateAttribute1_3_3(part.getAttribute("1.3.3"));
            end;
            m_protocol.printReportLineNumber("1.3.4");
            calculateAttribute1_3_4(part.getAttribute("1.3.4"));
            m_protocol.printReportLineNumber("1.3.5");
            calculateAttribute1_3_5(part.getAttribute("1.3.5"));
            m_protocol.printReportLineNumber("1.3.6");
            calculateAttribute1_3_6(part.getAttribute("1.3.6"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.4.1");
                calculateAttribute1_4_1(part.getAttribute("1.4.1"));
                m_protocol.printReportLineNumber("1.4.1.1");
                calculateAttribute1_4_1_1(part.getAttribute("1.4.1.1"));
                part.getAttribute("1.4.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.4.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.4.2");
                calculateAttribute1_4_2(part.getAttribute("1.4.2"));
                m_protocol.printReportLineNumber("1.4.3");
                calculateAttribute1_4_3(part.getAttribute("1.4.3"));
            end;
            m_protocol.printReportLineNumber("1.4.4");
            calculateAttribute1_4_4(part.getAttribute("1.4.4"));
            m_protocol.printReportLineNumber("1.4.5");
            calculateAttribute1_4_5(part.getAttribute("1.4.5"));
            m_protocol.printReportLineNumber("1.4.6");
            calculateAttribute1_4_6(part.getAttribute("1.4.6"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1 (part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2.7");
            calculateAttribute1_2_7(part.getAttribute("1.2.7"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2 (part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3 (part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4 (part.getAttribute("1.4"));
        end;
    end;
end;

/**
 *  Расчет переменных по 2926-У.
 *
 */
class (TCalculationPart3Controller2539) TCalculationPart3Controller2926(dataSource, tuneTable, protocol, report)
    initTCalculationPart3Controller2539(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute1_1_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_1_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_2_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_3_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(180,360)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_3_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);

    end;

    private macro calculateAttribute1_4_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(180,360)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1_4_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(360)
                                                  ),
                     BOLoans); */
        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb);
    end;

    macro calculate(part : TPart)
        if (part.getNumber() == 3)
            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_1(part.getAttribute("1.1.1"));
                m_protocol.printReportLineNumber("1.1.1.1");
                calculateAttribute1_1_1_1(part.getAttribute("1.1.1.1"));
                part.getAttribute("1.1.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.1.2");
                calculateAttribute1_1_2(part.getAttribute("1.1.2"));
                m_protocol.printReportLineNumber("1.1.3");
                calculateAttribute1_1_3(part.getAttribute("1.1.3"));
            end;
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_4(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_5(part.getAttribute("1.1.5"));
            m_protocol.printReportLineNumber("1.1.6");
            calculateAttribute1_1_6(part.getAttribute("1.1.6"));
            m_protocol.printReportLineNumber("1.1.7");
            calculateAttribute1_1_7(part.getAttribute("1.1.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.2.1");
                calculateAttribute1_2_1(part.getAttribute("1.2.1"));
                m_protocol.printReportLineNumber("1.2.1.1");
                calculateAttribute1_2_1_1(part.getAttribute("1.2.1.1"));
                part.getAttribute("1.2.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.2.2");
                calculateAttribute1_2_2(part.getAttribute("1.2.2"));
                m_protocol.printReportLineNumber("1.2.3");
                calculateAttribute1_2_3(part.getAttribute("1.2.3"));
            end;
            m_protocol.printReportLineNumber("1.2.4");
            calculateAttribute1_2_4(part.getAttribute("1.2.4"));
            m_protocol.printReportLineNumber("1.2.5");
            calculateAttribute1_2_5(part.getAttribute("1.2.5"));
            m_protocol.printReportLineNumber("1.2.6");
            calculateAttribute1_2_6(part.getAttribute("1.2.6"));
            m_protocol.printReportLineNumber("1.2.7");
            calculateAttribute1_2_7(part.getAttribute("1.2.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.3.1");
                calculateAttribute1_3_1(part.getAttribute("1.3.1"));
                m_protocol.printReportLineNumber("1.3.1.1");
                calculateAttribute1_3_1_1(part.getAttribute("1.3.1.1"));
                part.getAttribute("1.3.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.3.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.3.2");
                calculateAttribute1_3_2(part.getAttribute("1.3.2"));
                m_protocol.printReportLineNumber("1.3.3");
                calculateAttribute1_3_3(part.getAttribute("1.3.3"));
            end;
            m_protocol.printReportLineNumber("1.3.4");
            calculateAttribute1_3_4(part.getAttribute("1.3.4"));
            m_protocol.printReportLineNumber("1.3.5");
            calculateAttribute1_3_5(part.getAttribute("1.3.5"));
            m_protocol.printReportLineNumber("1.3.6");
            calculateAttribute1_3_6(part.getAttribute("1.3.6"));
            m_protocol.printReportLineNumber("1.3.7");
            calculateAttribute1_3_7(part.getAttribute("1.3.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.4.1");
                calculateAttribute1_4_1(part.getAttribute("1.4.1"));
                m_protocol.printReportLineNumber("1.4.1.1");
                calculateAttribute1_4_1_1(part.getAttribute("1.4.1.1"));
                part.getAttribute("1.4.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.4.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.4.2");
                calculateAttribute1_4_2(part.getAttribute("1.4.2"));
                m_protocol.printReportLineNumber("1.4.3");
                calculateAttribute1_4_3(part.getAttribute("1.4.3"));
            end;
            m_protocol.printReportLineNumber("1.4.4");
            calculateAttribute1_4_4(part.getAttribute("1.4.4"));
            m_protocol.printReportLineNumber("1.4.5");
            calculateAttribute1_4_5(part.getAttribute("1.4.5"));
            m_protocol.printReportLineNumber("1.4.6");
            calculateAttribute1_4_6(part.getAttribute("1.4.6"));
            m_protocol.printReportLineNumber("1.4.7");
            calculateAttribute1_4_7(part.getAttribute("1.4.7"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1 (part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2 (part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3 (part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4 (part.getAttribute("1.4"));
        end;
    end;
end;

/**
 * Расчет переменных по 3129-У.
 */
class (TCalculationPart3Controller2926) TCalculationPart3Controller3129(dataSource, tuneTable, protocol, report)
    /**
     * Конструктор базового класса.
     */
    initTCalculationPart3Controller2926(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'")
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute5_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'", True)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'", RcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'")
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute6_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'", True)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'", RcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

/*        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb);*/
    end;

    private macro calculateAttribute1_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/* Объединять ссуды */
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_1_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_2_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_2_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_3_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_3_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(180,360)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_3_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_4_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_6(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(180,360)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_4_7(attribute)
        /*   реализовывать по запросу #189099
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(360)
                                                  ),
                     BOLoans); */
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb); */
    end;

    macro calculate(part : TPart)
        if (part.getNumber() == 3)
            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_1(part.getAttribute("1.1.1"));
                m_protocol.printReportLineNumber("1.1.1.1");
                calculateAttribute1_1_1_1(part.getAttribute("1.1.1.1"));
                part.getAttribute("1.1.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.1.2");
                calculateAttribute1_1_2(part.getAttribute("1.1.2"));
                m_protocol.printReportLineNumber("1.1.3");
                calculateAttribute1_1_3(part.getAttribute("1.1.3"));
            end;
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_4(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_5(part.getAttribute("1.1.5"));
            m_protocol.printReportLineNumber("1.1.6");
            calculateAttribute1_1_6(part.getAttribute("1.1.6"));
            m_protocol.printReportLineNumber("1.1.7");
            calculateAttribute1_1_7(part.getAttribute("1.1.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.2.1");
                calculateAttribute1_2_1(part.getAttribute("1.2.1"));
                m_protocol.printReportLineNumber("1.2.1.1");
                calculateAttribute1_2_1_1(part.getAttribute("1.2.1.1"));
                part.getAttribute("1.2.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.2.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.2.2");
                calculateAttribute1_2_2(part.getAttribute("1.2.2"));
                m_protocol.printReportLineNumber("1.2.3");
                calculateAttribute1_2_3(part.getAttribute("1.2.3"));
            end;
            m_protocol.printReportLineNumber("1.2.4");
            calculateAttribute1_2_4(part.getAttribute("1.2.4"));
            m_protocol.printReportLineNumber("1.2.5");
            calculateAttribute1_2_5(part.getAttribute("1.2.5"));
            m_protocol.printReportLineNumber("1.2.6");
            calculateAttribute1_2_6(part.getAttribute("1.2.6"));
            m_protocol.printReportLineNumber("1.2.7");
            calculateAttribute1_2_7(part.getAttribute("1.2.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.3.1");
                calculateAttribute1_3_1(part.getAttribute("1.3.1"));
                m_protocol.printReportLineNumber("1.3.1.1");
                calculateAttribute1_3_1_1(part.getAttribute("1.3.1.1"));
                part.getAttribute("1.3.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.3.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.3.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.3.2");
                calculateAttribute1_3_2(part.getAttribute("1.3.2"));
                m_protocol.printReportLineNumber("1.3.3");
                calculateAttribute1_3_3(part.getAttribute("1.3.3"));
            end;
            m_protocol.printReportLineNumber("1.3.4");
            calculateAttribute1_3_4(part.getAttribute("1.3.4"));
            m_protocol.printReportLineNumber("1.3.5");
            calculateAttribute1_3_5(part.getAttribute("1.3.5"));
            m_protocol.printReportLineNumber("1.3.6");
            calculateAttribute1_3_6(part.getAttribute("1.3.6"));
            m_protocol.printReportLineNumber("1.3.7");
            calculateAttribute1_3_7(part.getAttribute("1.3.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.4.1");
                calculateAttribute1_4_1(part.getAttribute("1.4.1"));
                m_protocol.printReportLineNumber("1.4.1.1");
                calculateAttribute1_4_1_1(part.getAttribute("1.4.1.1"));
                part.getAttribute("1.4.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.4.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.4.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.4.2");
                calculateAttribute1_4_2(part.getAttribute("1.4.2"));
                m_protocol.printReportLineNumber("1.4.3");
                calculateAttribute1_4_3(part.getAttribute("1.4.3"));
            end;
            m_protocol.printReportLineNumber("1.4.4");
            calculateAttribute1_4_4(part.getAttribute("1.4.4"));
            m_protocol.printReportLineNumber("1.4.5");
            calculateAttribute1_4_5(part.getAttribute("1.4.5"));
            m_protocol.printReportLineNumber("1.4.6");
            calculateAttribute1_4_6(part.getAttribute("1.4.6"));
            m_protocol.printReportLineNumber("1.4.7");
            calculateAttribute1_4_7(part.getAttribute("1.4.7"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5(part.getAttribute("5"));
            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));

            m_protocol.printReportLineNumber("6");
            calculateAttribute6(part.getAttribute("6"));
            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));

            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1 (part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2 (part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3 (part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4 (part.getAttribute("1.4"));
        end;
    end;
end;

/**
 * Расчет переменных по 3468-У.
 */
class (TCalculationPart3Controller3129) TCalculationPart3Controller3468(dataSource, tuneTable, protocol, report)
    /**
     * Конструктор базового класса.
     */
    initTCalculationPart3Controller3129(dataSource, tuneTable, protocol, report);

    private macro calculateAttribute5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'")
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute5_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.10'", True)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.10'", RcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'")
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'")
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute6_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasHigherKks("'3.14.3'", True)
                                                  ),
                     BOLoans);

        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFICATION_COURT, "'3.14.3'", RcbApplication().currentReport.context.period.beginDate)
                                                  ),
                     BOCb);
    end;

    private macro calculateAttribute1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

/*        setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb);*/
    end;

    private macro calculateAttribute1_1_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_1_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/* Объединять ссуды */
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_1_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_1_7(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("Ж")
                                                   + m_loansCaseDataSource.getFilter().hasGot(9)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Жилищные ссуды'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0,30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_2_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75, 100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_2_7(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(9)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Ипотека п/залог нежилой', 'Ипотека п/залог жилой недвиж'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_3_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_3_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_3_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_3_7(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(361, 720)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_3_8(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("П")
                                                   + m_loansCaseDataSource.getFilter().hasGot(16)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_4_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_4_6(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181, 360 - 1)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_4_7(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(360, 720)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_4_8(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("З,И")
                                                   + m_loansCaseDataSource.getFilter().hasGot(16)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_5_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasGot(1)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_5_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                   ),
                     BOLoans);

        setLineUserValue(attribute);
    end;

    private macro calculateAttribute1_5_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(0.5, 1.5) /* НЕ Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_5_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(0.75, 10),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5,  10) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_5_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(10, 35)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_5_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(35, 75)
                                                  ),
                     BOCb); */

    end;

    private macro calculateAttribute1_5_6(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181,360)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_5_7(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("А")
                                                   + m_loansCaseDataSource.getFilter().hasGot(9)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Автокредиты'")
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_6_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(0, 30)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_1_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20) /* Объединять ссуды */
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasGot(0)
                                                  ),
                     BOLoans);

/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(1, 3) /*НЕ Объединять ссуды*/
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(1, 30)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + ternary(global.parameters.getRegistry().getConsolidateLoans().getValue(),
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(1.5, 20),/*Объединять ссуды*/
                                                             m_cbCaseDataSource.getFilter().hasReservePercent(3,   20) /* НЕ Объединять ссуды */
                                                            )
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(31, 90)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(20, 50)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(91, 180)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )",
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(50, 75)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_6_6(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasOverdueterm(181,360)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercent(75,100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute1_6_7(attribute)
        /*   реализовывать по запросу #189099 */
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditIssueType("Н", 8, CF_CALCKARTA)
                                                   + m_loansCaseDataSource.getFilter().hasGot(9)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + " AND ( (1=1 "+m_cbCaseDataSource.getFilter().hasAssignedCaseCategory(RCB_OBJGROUP_CASE_CLASSIFCRD, "'Потребительские ссуды', 'Овердрафт'")+")"
                                                   + "     or "
                                                   + "       (1=1 "+m_cbCaseDataSource.getFilter().hasAccountMasks("45508,45708")+")"
                                                   + "    )"
                                                   + m_cbCaseDataSource.getFilter().hasReservePercentEqual(100)
                                                  ),
                     BOCb); */
        setLineValue(attribute, null);
    end;

    private macro calculateAttribute2_1(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(1)
                                                   + m_loansCaseDataSource.getFilter().hasAimOrCreditAim("B")
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_2(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(2)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_3(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(3)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_4(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(4)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute2_5(attribute)
        setLineValue(attribute,
                     m_loansCaseDataSource.getRequirementsData(
                                                     m_loansCaseDataSource.getFilter().hasClientType(RCB_PTLEGF_PERSN)
                                                   + m_loansCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOLoans);
/*         setLineValue(attribute,
                      m_cbCaseDataSource.getPhysicalPersonData(
                                                     m_cbCaseDataSource.getFilter().hasReserveKind(KindReserveLoans)
                                                   + m_cbCaseDataSource.getFilter().hasClientTypePhysicalPerson()
                                                   + m_cbCaseDataSource.getFilter().hasRiskGroup(5)
                                                  ),
                     BOCb); */
    end;

    private macro calculateAttribute1_3(attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.6"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.7"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.3.8"));
    end;

    private macro calculateAttribute1_4(attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.6"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.7"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.4.8"));
    end;

    private macro calculateAttribute1_5(attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.6"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.5.7"));
    end;

    private macro calculateAttribute1_6(attribute)
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.1"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.2"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.3"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.4"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.5"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.6"));
        addAttribute(attribute, m_report.getPart("3").getAttribute("1.6.7"));
    end;

    macro calculate(part : TPart)

        if (part.getNumber() == 3)
            m_protocol.printReportLineNumber("1");
            calculateAttribute1(part.getAttribute("1"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.1.1");
                calculateAttribute1_1_1(part.getAttribute("1.1.1"));
                m_protocol.printReportLineNumber("1.1.1.1");
                calculateAttribute1_1_1_1(part.getAttribute("1.1.1.1"));
                part.getAttribute("1.1.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.1.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.1.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.1.2");
                calculateAttribute1_1_2(part.getAttribute("1.1.2"));
                m_protocol.printReportLineNumber("1.1.3");
                calculateAttribute1_1_3(part.getAttribute("1.1.3"));
            end;
            m_protocol.printReportLineNumber("1.1.4");
            calculateAttribute1_1_4(part.getAttribute("1.1.4"));
            m_protocol.printReportLineNumber("1.1.5");
            calculateAttribute1_1_5(part.getAttribute("1.1.5"));
            m_protocol.printReportLineNumber("1.1.6");
            calculateAttribute1_1_6(part.getAttribute("1.1.6"));
            m_protocol.printReportLineNumber("1.1.7");
            calculateAttribute1_1_7(part.getAttribute("1.1.7"));

            if (global.parameters.getRegistry().getMortgageReducedRisk().getValue())
                m_protocol.printReportLineNumber("1.2");
                part.getAttribute("1.2").setUndefinedValue( "3", "4");
                if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                    m_protocol.printReportLineNumber("1.3.1");
                    calculateAttribute1_3_1(part.getAttribute("1.3.1"));
                    m_protocol.printReportLineNumber("1.3.1.1");
                    calculateAttribute1_3_1_1(part.getAttribute("1.3.1.1"));
                else
                    m_protocol.printReportLineNumber("1.3.2");
                    calculateAttribute1_3_2(part.getAttribute("1.3.2"));
                    m_protocol.printReportLineNumber("1.3.3");
                    calculateAttribute1_3_3(part.getAttribute("1.3.3"));
                end;
                m_protocol.printReportLineNumber("1.3.4");
                calculateAttribute1_3_4(part.getAttribute("1.3.4"));
                m_protocol.printReportLineNumber("1.3.5");
                calculateAttribute1_3_5(part.getAttribute("1.3.5"));
                m_protocol.printReportLineNumber("1.3.6");
                calculateAttribute1_3_6(part.getAttribute("1.3.6"));
                m_protocol.printReportLineNumber("1.3.7");
                calculateAttribute1_3_7(part.getAttribute("1.3.7"));
                m_protocol.printReportLineNumber("1.3.8");
                calculateAttribute1_3_8(part.getAttribute("1.3.8"));

                if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                    m_protocol.printReportLineNumber("1.4.1");
                    calculateAttribute1_4_1(part.getAttribute("1.4.1"));
                    m_protocol.printReportLineNumber("1.4.1.1");
                    calculateAttribute1_4_1_1(part.getAttribute("1.4.1.1"));
                else
                    m_protocol.printReportLineNumber("1.4.2");
                    calculateAttribute1_4_2(part.getAttribute("1.4.2"));
                    m_protocol.printReportLineNumber("1.4.3");
                    calculateAttribute1_4_3(part.getAttribute("1.4.3"));
                end;
                m_protocol.printReportLineNumber("1.4.4");
                calculateAttribute1_4_4(part.getAttribute("1.4.4"));
                m_protocol.printReportLineNumber("1.4.5");
                calculateAttribute1_4_5(part.getAttribute("1.4.5"));
                m_protocol.printReportLineNumber("1.4.6");
                calculateAttribute1_4_6(part.getAttribute("1.4.6"));
                m_protocol.printReportLineNumber("1.4.7");
                calculateAttribute1_4_7(part.getAttribute("1.4.7"));
                m_protocol.printReportLineNumber("1.4.8");
                calculateAttribute1_4_8(part.getAttribute("1.4.8"));
            else
                if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                    m_protocol.printReportLineNumber("1.2.1");
                    calculateAttribute1_2_1(part.getAttribute("1.2.1"));
                    m_protocol.printReportLineNumber("1.2.1.1");
                    calculateAttribute1_2_1_1(part.getAttribute("1.2.1.1"));
                    part.getAttribute("1.2.2").setUndefinedValue( "3", "4");
                    part.getAttribute("1.2.3").setUndefinedValue( "3", "4");
                else
                    part.getAttribute("1.2.1").setUndefinedValue( "3", "4");
                    part.getAttribute("1.2.1.1").setUndefinedValue( "3", "4");
                    m_protocol.printReportLineNumber("1.2.2");
                    calculateAttribute1_2_2(part.getAttribute("1.2.2"));
                    m_protocol.printReportLineNumber("1.2.3");
                    calculateAttribute1_2_3(part.getAttribute("1.2.3"));
                end;
                m_protocol.printReportLineNumber("1.2.4");
                calculateAttribute1_2_4(part.getAttribute("1.2.4"));
                m_protocol.printReportLineNumber("1.2.5");
                calculateAttribute1_2_5(part.getAttribute("1.2.5"));
                m_protocol.printReportLineNumber("1.2.6");
                calculateAttribute1_2_6(part.getAttribute("1.2.6"));
                m_protocol.printReportLineNumber("1.2.7");
                calculateAttribute1_2_7(part.getAttribute("1.2.7"));

                part.getAttribute("1.3").setUndefinedValue( "3", "4");
                part.getAttribute("1.4").setUndefinedValue( "3", "4");
            end;

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.5.1");
                calculateAttribute1_5_1(part.getAttribute("1.5.1"));
                m_protocol.printReportLineNumber("1.5.1.1");
                calculateAttribute1_5_1_1(part.getAttribute("1.5.1.1"));
                part.getAttribute("1.5.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.5.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.5.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.5.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.5.2");
                calculateAttribute1_5_2(part.getAttribute("1.5.2"));
                m_protocol.printReportLineNumber("1.5.3");
                calculateAttribute1_5_3(part.getAttribute("1.5.3"));
            end;

            m_protocol.printReportLineNumber("1.5.4");
            calculateAttribute1_5_4(part.getAttribute("1.5.4"));
            m_protocol.printReportLineNumber("1.5.5");
            calculateAttribute1_5_5(part.getAttribute("1.5.5"));
            m_protocol.printReportLineNumber("1.5.6");
            calculateAttribute1_5_6(part.getAttribute("1.5.6"));
            m_protocol.printReportLineNumber("1.5.7");
            calculateAttribute1_5_7(part.getAttribute("1.5.7"));

            if (global.parameters.getRegistry().getConsolidateLoans().getValue())
                m_protocol.printReportLineNumber("1.6.1");
                calculateAttribute1_6_1(part.getAttribute("1.6.1"));
                m_protocol.printReportLineNumber("1.6.1.1");
                calculateAttribute1_6_1_1(part.getAttribute("1.6.1.1"));
                part.getAttribute("1.6.2").setUndefinedValue( "3", "4");
                part.getAttribute("1.6.3").setUndefinedValue( "3", "4");
            else
                part.getAttribute("1.6.1").setUndefinedValue( "3", "4");
                part.getAttribute("1.6.1.1").setUndefinedValue( "3", "4");
                m_protocol.printReportLineNumber("1.6.2");
                calculateAttribute1_6_2(part.getAttribute("1.6.2"));
                m_protocol.printReportLineNumber("1.6.3");
                calculateAttribute1_6_3(part.getAttribute("1.6.3"));
            end;
            m_protocol.printReportLineNumber("1.6.4");
            calculateAttribute1_6_4(part.getAttribute("1.6.4"));
            m_protocol.printReportLineNumber("1.6.5");
            calculateAttribute1_6_5(part.getAttribute("1.6.5"));
            m_protocol.printReportLineNumber("1.6.6");
            calculateAttribute1_6_6(part.getAttribute("1.6.6"));
            m_protocol.printReportLineNumber("1.6.7");
            calculateAttribute1_6_7(part.getAttribute("1.6.7"));

            /*нет примечания, т.к. не расчитывается*/
            calculateAttribute2(part.getAttribute("2"));

            m_protocol.printReportLineNumber("2.1");
            calculateAttribute2_1(part.getAttribute("2.1"));
            m_protocol.printReportLineNumber("2.2");
            calculateAttribute2_2(part.getAttribute("2.2"));
            m_protocol.printReportLineNumber("2.3");
            calculateAttribute2_3(part.getAttribute("2.3"));
            m_protocol.printReportLineNumber("2.4");
            calculateAttribute2_4(part.getAttribute("2.4"));
            m_protocol.printReportLineNumber("2.5");
            calculateAttribute2_5(part.getAttribute("2.5"));

            m_protocol.printReportLineNumber("3.1");
            calculateAttribute3_1(part.getAttribute("3.1"));
            m_protocol.printReportLineNumber("3.2");
            calculateAttribute3_2(part.getAttribute("3.2"));
            m_protocol.printReportLineNumber("3.3");
            calculateAttribute3_3(part.getAttribute("3.3"));
            m_protocol.printReportLineNumber("3.4");
            calculateAttribute3_4(part.getAttribute("3.4"));
            m_protocol.printReportLineNumber("3.5");
            calculateAttribute3_5(part.getAttribute("3.5"));
            m_protocol.printReportLineNumber("3");
            calculateAttribute3(part.getAttribute("3"));

            m_protocol.printReportLineNumber("4");
            calculateAttribute4(part.getAttribute("4"));
            m_protocol.printReportLineNumber("4.1");
            calculateAttribute4_1(part.getAttribute("4.1"));

            m_protocol.printReportLineNumber("5");
            calculateAttribute5(part.getAttribute("5"));
            m_protocol.printReportLineNumber("5.1");
            calculateAttribute5_1(part.getAttribute("5.1"));

            m_protocol.printReportLineNumber("6");
            calculateAttribute6(part.getAttribute("6"));
            m_protocol.printReportLineNumber("6.1");
            calculateAttribute6_1(part.getAttribute("6.1"));

            part.getAttribute("2").setUndefinedValue( "3", "4");
            part.getAttribute("3.1").setUndefinedValue("4");

            part.getValue().summarizeDependentValues(RCB_SU_EXACT);

            m_protocol.printReportLineNumber("1.1");
            calculateAttribute1_1(part.getAttribute("1.1"));

            m_protocol.printReportLineNumber("1.2");
            calculateAttribute1_2(part.getAttribute("1.2"));

            m_protocol.printReportLineNumber("1.3");
            calculateAttribute1_3(part.getAttribute("1.3"));

            m_protocol.printReportLineNumber("1.4");
            calculateAttribute1_4(part.getAttribute("1.4"));
        end;
    end;
end;
