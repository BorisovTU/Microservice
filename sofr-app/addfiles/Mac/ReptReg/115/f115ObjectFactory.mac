/*
$Name:          f115ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 115. фабрика объектов отчетной формы.
*/

/**
 * Форма 115. фабрика объектов отчетной формы.
 *
 * @since   01.06.2008
 * @author  Ivkina Olga
 * @version 6.00.020.28
 */
import repException;
import rcbconst;
import rcbImport;

class (RcbObjectFactoryBase)TObjectFactory()
    macro createCalculationController() /*: TCalculationController*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createCalculationController"));
    end;

    macro createReport() /*: TReport*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createReport"));
    end;

    macro createPart() /*: TPart*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPart"));
    end;

    macro createAttribute() /*: TAttribute*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createAttribute"));
    end;

    macro createDataSource() /*: TDataSource*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSource"));
    end;

    macro createDataSourceFilters() /*: TDataSourceFilters*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSourceFilters"));
    end;

    macro createPrintController() /*: PrintController*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintController"));
    end;

    macro createPtkPsdView() /*: TPtkPsdView*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPtkPsdView"));
    end;

    macro createPtkPsdExportController() /*: TPtkPsdExportController*/

        var strError = "Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2742-У " + "|" + " (окончание отчетного периода - не ранее 01.01.2012г.)";
        repErrorsQueue().add(0, strError);
        msgBox("Экспорт в ПТК ПСД реализован по Указанию ЦБР № 2742-У " , "|" , " (окончание отчетного периода - не ранее 01.01.2012г.)");
        установитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;

    macro createTuneTable() /*: TTuneTable*/
    end;

    macro createPrintCalculationProtocolOperation() /*TPrintOperation*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPrintCalculationProtocolOperation"));
    end;

    macro createNormalizationController()
    end;
end;


class (TObjectFactory) TObjectFactory2061()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory();

    macro constructor()
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2061");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2061");
    end;

    macro createPart(attributeValue /*: RcbCompositeValue*/, number : Integer, name : String) /*: TPart*/
        return genObject("TPart", attributeValue, number, name);
    end;

    macro createAttribute(attributeValue /*: RcbAttributeValue*/, attributeLineNumber : String, attributeColumnNumber : String) /*: TAttribute*/
        return genObject("TAttribute2061",attributeValue /*: RcbAttributeValue*/, attributeLineNumber, attributeColumnNumber);
    end;

    macro createUserAttribute(attributeValue /*: RcbAttributeValue*/, attributeLineNumber : String, attributeColumnNumber : String, attributeColumn : String)
        return genObject("TUserAttribute2061",attributeValue /*: RcbAttributeValue*/, attributeLineNumber, attributeColumnNumber, attributeColumn);
    end;

    macro createDataSource()
        return genObject("TDataSource2061")
    end;

    macro createDataSourceFilter() /*: TDataSourceFilters*/
        return genObject("TDataSourceFilters2061");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2061");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2061");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2061");
    end;

    macro createKlikoView() /*: TKlikoView*/
        return genObject("TKlikoView2061");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2061");
    end;
    /**
     * Создать операцию печати протокола расчета отчета.
     */
    macro createPrintCalculationProtocolOperation() /*: TPrintOperation*/
        return genObject("TProtocolView2061");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2061");
    end;


    constructor();
end;


class (TObjectFactory2061) TObjectFactory2332()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2061();

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2332");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2332");
    end;

    macro createDataSource()
        return genObject("TDataSource2332")
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2332");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2332");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2332");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2332");
    end;
end;

class (TObjectFactory2332) TObjectFactory2539()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2332();

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2539");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2539");
    end;

    macro createDataSource()
        return genObject("TDataSource2539")
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2539");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2539");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2539");
    end;
end;

class (TObjectFactory2539) TObjectFactory2627()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2539();

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2627");
    end;

    macro createCalculationController() /*: TCalculationController */
        return genObject("TCalculationController2627");
    end;
end;

class (TObjectFactory2627) TObjectFactory2742()

    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2627();

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2742");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2742");
    end;

    macro createCalculationController() /*: TCalculationController*/
        return genObject("TCalculationController2742");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2742");
    end;

    macro createDataSource()
        return genObject("TDataSource2742")
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2742");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2742");
    end;

    macro createPtkPsdView() /*: TPtkPsdView*/
        return genObject("TPtkPsdView2742");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdController*/
        return genObject("TPtkPsdExportController2742");
    end;
end;

class (TObjectFactory2742) TObjectFactory2835()
    initTObjectFactory2742();

    macro createCalculationController()/*: TCalculationController*/
        return genObject("TCalculationController2835");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2835");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2835");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2835");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2835");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2835");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdController*/
        return genObject("TPtkPsdExportController2835");
    end;
end;

class (TObjectFactory2835) TObjectFactory2926()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2835();

    macro createCalculationController()/*: TCalculationController*/
        return genObject("TCalculationController2926");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport2926");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController2926");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView2926");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable2926");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController2926");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController2926");
    end;

end;

class (TObjectFactory2926) TObjectFactory3006()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory2926();

    macro createCalculationController()/*: TCalculationController*/
        return genObject("TCalculationController3006");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController3006");
    end;

    macro createTuneTable() /*: TTuneTable*/
        return genObject("TTuneTable3006");
    end;

end;

/**
 * Класс фабрики по указанию 3129-У.
 */
class (TObjectFactory3006) TObjectFactory3129()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactory3006();

    /**
     * Созать класс контроллера расчета отчета.
     * @return TCalculationController Класс контроллера расчета.
     */
    macro createCalculationController()
        return genObject("TCalculationController3129");
    end;

    /**
     * Создать класс отчета.
     * @return TReport Класс отчета.
     */
    macro createReport() /*: TReport*/
        return genObject("TReport3129");
    end;

    /**
     * Создать класс печатной формы.
     */
    macro createReportView() /*: TReportView*/
        return genObject("TReportView3129");
    end;

    /**
     * Создать класс настроечной таблицы.
     * @return TTuneTable Класс настроечной таблицы.
     */
    macro createTuneTable()
        return genObject("TTuneTable3129");
    end;

    /**
     * Создать класс источника данных.
     */
    macro createDataSource()
        return genObject("TDataSource3129")
    end;

    /**
     * Создать класс контроллера нормализатора.
     */
    macro createNormalizationController()
        return genObject("TNormalizationController3129");
    end;

    /**
     * Создать класс контроллера печати.
     */
    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController3129");
    end;

    macro createKlikoExportController() /*: TKlikoExportController*/
        return genObject("TKlikoExportController3129");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdController*/
        return genObject("TPtkPsdExportController2835");
    end;
end;

/**
 * Класс фабрики по указанию 3129-У(2).
 */
class (TObjectFactory3129) TObjectFactory3129_2()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactory3129();

    macro createCalculationController()
        return genObject("TCalculationController3129_2");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController3129_2");
    end;

    macro createPrintController() /*: TPrintController*/
        return genObject("TPrintController3129_2");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdController*/
        return genObject("TPtkPsdExportController3129_2");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport3129_2");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView3129_2");
    end;
end;

class (TObjectFactory3129_2) TObjectFactory3468()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactory3129_2();

    macro createCalculationController()
        return genObject("TCalculationController3468");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController3468");
    end;

    macro createPtkPsdExportController() /*: TPtkPsdController*/
        return genObject("TPtkPsdExportController3468");
    end;

    macro createReport() /*: TReport*/
        return genObject("TReport3468");
    end;

    macro createReportView() /*: TReportView*/
        return genObject("TReportView3468");
    end;

    /**
     * Создать класс настроечной таблицы.
     * @return TTuneTable Класс настроечной таблицы.
     */
    macro createTuneTable()
        return genObject("TTuneTable3468");
    end;
end;

class (TObjectFactory3468) TObjectFactoryF115_43_PAK()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactory3468();


    /**
     * Создать класс источника данных.
     */
    macro createDataSource()
        return genObject("TDataSourceF115_43_PAK")
    end;

    macro createCalculationController()
        return genObject("TCalculationControllerF115_43_PAK");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationControllerF115_43_PAK");
    end;
end;

class (TObjectFactoryF115_43_PAK) TObjectFactory4033()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactoryF115_43_PAK();

    macro createReportView() /*: TReportView*/
        return genObject("TReportView4033");
    end;
end;

class (TObjectFactory4033) TObjectFactory4099()
    /**
     * Конструктор базового класса.
     */
    initTObjectFactory4033();

    macro createCalculationController()
        return genObject("TCalculationController4099");
    end;

    macro createTuneTable()
        return genObject("TTuneTable4099");
    end;
end;

class (TObjectFactory4099) TObjectFactory4212()
    initTObjectFactory4099();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TPrintableView_4212_115", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPrintController()
        return genObject("TPrintController4212");
    end;

    macro createReportView()
        return genObject("TReportView4212");
    end;

    macro createReport()
        return genObject("TReport4212");
    end;

    macro createCalculationController()
        return genObject("TCalculationController4212");
    end;

    macro createNormalizationController()
        return genObject("TNormalizationController_4212");
    end;

    macro createKlikoExportController()
        return genObject("TKlikoExportController_4212");
    end;
end;

class (TObjectFactory4212) TObjectFactory4637()
    initTObjectFactory4212();

    macro createPrintController()
        return genObject("TPrintController4637");
    end;

    macro createReportView()
        return genObject("TReportView4637");
    end;

    macro createCalculationController()
        return genObject("TCalculationController4637");
    end;

    macro createKlikoExportController()
        return genObject("TKlikoExportController_4637");
    end;
end;

if (objectFactoryInstance == null)
    if   (rcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE_F115)
        objectFactoryInstance = TObjectFactory4637();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TObjectFactory4212();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I4099_DATE)
        objectFactoryInstance = TObjectFactory4099();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I4033_DATE)
        objectFactoryInstance = TObjectFactory4033();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_F115_43_PAK_DATE)
        objectFactoryInstance = TObjectFactoryF115_43_PAK();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3468_DATE)
        objectFactoryInstance = TObjectFactory3468();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3129_DATE2)
        objectFactoryInstance = TObjectFactory3129_2();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3129_DATE)
        objectFactoryInstance = TObjectFactory3129();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I3006_DATE)
        objectFactoryInstance = TObjectFactory3006();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2926_DATE)
        objectFactoryInstance = TObjectFactory2926();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2835_DATE)
        objectFactoryInstance = TObjectFactory2835();
    elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2742_DATE)
        objectFactoryInstance = TObjectFactory2742();
    elif(rcbApplication().currentReport.context.period.endDate >= RCB_I2627_DATE)
        objectFactoryInstance = TObjectFactory2627();
    elif(rcbApplication().currentReport.context.period.endDate >= RCB_I2539_DATE)
        objectFactoryInstance = TObjectFactory2539();
    elif(rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
        objectFactoryInstance = TObjectFactory2332();
    else
        objectFactoryInstance = TObjectFactory2061();
    end;
end;
