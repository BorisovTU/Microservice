/*
$Name:          f652CheckReport.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 652. Проверка отчета
*/

import rcbImport;
import f652Global;

if(global.getRcbReport().context.period.endDate >= RCB_I3198_DATE2)
    if (global.getRcbReport().context.period.kind != RCB_PK_DAY)
        var protocolView2  = TProtocolView("ПРОТОКОЛ РАСЧЕТА");
        protocolView2.setProtocolOutput();
        protocolView2.printHead();

        protocolView2.printLine("Отчет формируется только за период = 1 день.");
        protocolView2.resetProtocolOutput();
        protocolView2.show();

        УстановитьФлагВозврата(STOP_PROC_FLG);
        exit(1);
    end;
end;

УстановитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
