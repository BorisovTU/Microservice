/*
$Name:          f652ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 652. Фабрика объектов
*/

/**
 * Форма 652. Фабрика объектов.
 *
 * @since   04.07.2013
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

var p = tsqlprofiler(gettxtfilename("!652!"));
p.clear();
p.on();

class (RcbObjectFactoryBase) F652ObjectFactory()
    initRcbObjectFactoryBase();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("F652Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("F652Part", partId, compositeValue);
    end;

    macro createPartListCurrency(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("F652PartListCurrency", partId, compositeValue);
    end;

    macro createAttribute(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("F652Attribute", id, part, compositeValue);
    end;

    macro createAttributeListCurrency(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("F652AttributeListCurrency", id, part, compositeValue);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("F652ReportCalculateController");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("F652CalculateProtocolView", protocolName);
    end;

    macro createCalculateControlProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("F652CalculateControlProtocolView", protocolName);
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("F652DataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("F652DataSourceFilters");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("F652TuneTable");
    end;

    macro createReportView() : RcbReportView
        return genObject("F652ReportView");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("F652PrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createControlCalculatedData()
        return genObject("F652ControlCalculatedData");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("F652PrintProtocolView", protocolName);
    end;

    macro createReportPrintController(format : String) : RcbReportPrintController
        return genObject("F652ReportPrintController", format);
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("F652KlikoExportController");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("F652PtkPsdExportController");
    end;
end;

class (F652ObjectFactory) F652ObjectFactory_3198()
    initF652ObjectFactory();

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("F652DataSources_3198", protocolView);
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("F652CalculateProtocolView_3198", protocolName);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("F652ReportCalculateController_3198");
    end;

    macro createReportView() : RcbReportView
        return genObject("F652ReportView_3198");
    end;

    macro createReportPrintController(format : String) : RcbReportPrintController
        return genObject("F652ReportPrintController_3198", format);
    end;

    macro createControlCalculatedData()
        return genObject("F652ControlCalculatedData_3198");
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("F652KlikoExportController_3198");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("F652PtkPsdExportController_3198");
    end;
end;

class (F652ObjectFactory_3198) F652ObjectFactory_4212()
    initF652ObjectFactory_3198();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("F652PrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;
end;

class (RcbObjectFactoryBase) F652ObjectFactory_4637()
    initRcbObjectFactoryBase();

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("F652DataSources_3198", protocolView);
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("F652CalculateProtocolView_3198", protocolName);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("F652ReportCalculateController_3198");
    end;

    macro createReportView() : RcbReportView
        return genObject("F652ReportView_4637");
    end;

    macro createReportPrintController(format : String) : RcbReportPrintController
        return genObject("F652ReportPrintController_4637", format);
    end;

    macro createSummaryReportPrintController() : RcbReportPrintController
        return genObject("F652SummaryReportPrintController");
    end;

    macro createControlCalculatedData()
        return genObject("F652ControlCalculatedData_3198");
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("F652KlikoExportController_3198");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("F652PtkPsdExportController_4637");
    end;

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("F652Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("F652Part", partId, compositeValue);
    end;

    macro createPartListCurrency(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("F652PartListCurrency", partId, compositeValue);
    end;

    macro createAttribute(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("F652Attribute", id, part, compositeValue);
    end;

    macro createAttributeListCurrency(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("F652AttributeListCurrency", id, part, compositeValue);
    end;

    macro createCalculateControlProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("F652CalculateControlProtocolView", protocolName);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("F652DataSourceFilters");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("F652TuneTable");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("F652PrintableView_4637", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("F652PrintProtocolView", protocolName);
    end;
end;

if (objectFactoryInstance == null)
    if   (rcbApplication().currentReport().context.period.EndDate >= RCB_I4637_DATE)
        objectFactoryInstance = F652ObjectFactory_4637();
    elif (rcbApplication().currentReport().context.period.EndDate >= RCB_I4212_DATE)
        objectFactoryInstance = F652ObjectFactory_4212();
    elif (rcbApplication().currentReport().context.period.EndDate >= RCB_I3198_DATE2)
        objectFactoryInstance = F652ObjectFactory_3198();
    else
        objectFactoryInstance = F652ObjectFactory();
    end;
end;

