/*
$Name:          f410ObjectFactory.mac
$Module:        Отчеты ЦБ
$Description:   Форма 410. Фабрика объектов.
*/

/**
 * Форма 410. Фабрика объектов.
 *
 * @since 01.10.2018
 * @version 6.20.031.052
 */
private class (RcbObjectFactoryBase) TF410ObjectFactoryImpl()
    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        defaultParm(isLazy, false);
        return genObject("TF410Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("TF410Part", partId, compositeValue);
    end;

    macro createAttribute(id : String, part : RcbPartBase, value : Object, properties : Object) : RcbAttributeBase
        if (in(part.getId(), TF410Global().getPart1Id(), TF410Global().getPart2Id()))
            return genObject("TF410Attribute", id, part, value, properties);
        else
            return null;
        end;
    end;

    macro createAttributeValue(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (in(part.getId(), TF410Global().getPart1Id(), TF410Global().getPart2Id()))
            return genObject("TF410AttributeValue", storage);
        else
            return null;
        end;
    end;

    macro createStandaloneAttributeValue(line : Integer, maxInterestRate : Money) : Object
        return genObject("TF410StandaloneAttributeValue", line, maxInterestRate);
    end;

    macro createAttributeProperties(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (in(part.getId(), TF410Global().getPart1Id(), TF410Global().getPart2Id()))
            return genObject("TF410AttributeProperties", storage);
        else
            return null;
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF410DataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF410DataSourceFilters");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF410CalculateProtocolView", protocolName);
    end;

    macro createPart1CalculateController(reportCalculateController : RcbReportCalculateController) : Object
        return genObject("TF410Part1CalculateController", reportCalculateController);
    end;

    macro createPart2CalculateController(reportCalculateController : RcbReportCalculateController) : Object
        return genObject("TF410Part2CalculateController", reportCalculateController);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF410ReportCalculateController");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF410TuneTable", RCB_I4637_DATE);
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TF410PrintProtocolView", protocolName);
    end;

    macro createPartView(id : String, reportView : RcbReportView) : RcbReportView
        if (id == TF410Global().getPart1Id())
            return genObject("TF410Part1View", reportView);
        elif (id == TF410Global().getPart2Id())
            return genObject("TF410Part2View", reportView);
        elif (id == TF410Global().getPart3Id())
            return genObject("TF410Part3View", reportView);        
        elif (id == TF410Global().getPart4Id())
            return genObject("TF410Part4View", reportView);
        else
            return null;
        end;
    end;

    macro createReportExcelView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF410ReportExcelView", protocolView);
    end;

    macro createReportView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF410ReportView", protocolView);
    end;

    macro createReportPrintController(format : Integer) : RcbReportPrintController
        return genObject("TF410ReportPrintController", format);
    end;

    macro createXmlExportController()
        return genObject("TF410ExportXmlController_XXXX");
    end;

    macro createResource()
        return genObject("TF410Resource");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF410PrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    private macro constructorTF410ObjectFactoryImpl()
        initRcbObjectFactoryBase();
    end;

    constructorTF410ObjectFactoryImpl();
end;

private class (TF410ObjectFactoryImpl) TF410ObjectFactory_I4927()
    macro createReportPrintController(format : Integer) : RcbReportPrintController
        return genObject("TF410ReportPrintController_4927", format);
    end;

    macro createBISExportOperation(formName : String, part : String)
        return genObject("TF410BiscuitExportController", formName, part);
    end;

    macro createBiscuitView(formName : String)
        return genObject("TF410BiscuitView", formName);
    end;

    macro createResource()
        return genObject("TF410Resource_4927");
    end;
	
	macro createExcelPartView(id : String, reportView : RcbReportView, sheetName, tableName, sheetIndex) : RcbReportView
		return genObject("TF410PartExcelView", sheetName, tableName, reportView, sheetIndex);
    end;
	
	macro createReportExcelView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF410ReportExcelView_4927", protocolView);
    end;

    private macro constructorTF410ObjectFactory_I4927()
        initTF410ObjectFactoryImpl();
    end;

    constructorTF410ObjectFactory_I4927();
end;

if (objectFactoryInstance == null)
	if   (RcbApplication().currentReport.context.period.endDate >= RCB_I4927_DATE)
        objectFactoryInstance = TF410ObjectFactory_I4927();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE)
        objectFactoryInstance = TF410ObjectFactoryImpl();
    else
        objectFactoryInstance = null;
    end;
end;
