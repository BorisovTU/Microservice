/*
$Name:          f410AttributeValue.mac
$Module:        Отчеты ЦБ
$Description:   Форма 410. Класс значения атрибута.
*/

/**
 * Форма 410. Интерфейс классов значения атрибута.
 *
 * @since 03.10.2018
 * @version 6.20.031.052
 */
class IF410AttributeValue()
    macro getStorage() : RcbCompositeValue
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getStorage"));
    end;

    macro getLine() : String
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getLine"));
    end;

    macro getSymbol() : String
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getSymbol"));
    end;

    macro getSector() : String
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getSector"));
    end;

    macro getCountry() : String
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getCountry"));
    end;

    macro getCurrency() : String
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getCurrency"));
    end;

    macro getValue() : Object
        throw(TPureVirtualMethodCallException("IF410AttributeValue::getValue"));
    end;

    private macro constructorIF410AttributeValue()
        throw(TPureVirtualMethodCallException("IF410AttributeValue::constructorIF410AttributeValue"));
    end;

    constructorIF410AttributeValue();
end;

/**
 * Форма 410. Базовый класс значения атрибута.
 *
 * @since  03.10.2018
 * @version 6.20.031.052
 */
class (IF410AttributeValue) TF410AttributeValueBase(storage : RcbCompositeValue)
    private var m_storage : RcbCompositeValue;

    macro getStorage() : RcbCompositeValue
        return m_storage;
    end;

    macro getLine() : String
        if (m_storage != null)
            return m_storage.fieldValue("line").exact;
        end;

        return null;
    end;

    macro getSymbol() : String
        if (m_storage != null)
            return m_storage.fieldValue("symbol").exact;
        end;

        return null;
    end;

    macro getSector() : String
        if (m_storage != null)
            return m_storage.fieldValue("sector").exact;
        end;

        return null;
    end;

    macro getCountry() : String
        if (m_storage != null)
            return m_storage.fieldValue("country").exact;
        end;

        return null;
    end;

    macro getCurrency() : String
        if (m_storage != null)
            return m_storage.fieldValue("currency").exact;
        end;

        return null;
    end;

    macro getValue() : Object
        if (m_storage != null)
            return m_storage.fieldValue("value");
        end;

        return null;
    end;

    macro setLine(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setLine"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setLine", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setLine", "value"));
        end;

        if (m_storage != null)
            m_storage.fieldValue("line").exact = value;
        else
            m_storage.fieldValue("line").setUndefined();
        end;

        return this;
    end;

    macro setSymbol(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setSymbol"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setSymbol", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setSymbol", "ValType"));
        end;

        if (m_storage != null)
            if (value != null)
                m_storage.fieldValue("symbol").exact = value;
            else
                m_storage.fieldValue("symbol").setUndefined();
            end;
        end;

        return this;
    end;

    macro setSector(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setSector"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setSector", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setSector", "ValType"));
        end;

        if (m_storage != null)
            m_storage.fieldValue("sector").exact = value;
        else
            m_storage.fieldValue("sector").setUndefined();
        end;

        return this;
    end;

    macro setCountry(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setCountry"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setCountry", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setCountry", "ValType"));
        end;

        if (m_storage != null)
            m_storage.fieldValue("country").exact = value;
        else
            m_storage.fieldValue("country").setUndefined();
        end;

        return this;
    end;

    macro setCurrency(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setCurrency"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setCurrency", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setCurrency", "ValType"));
        end;

        if (m_storage != null)
            m_storage.fieldValue("currency").exact = value;
        else
            m_storage.fieldValue("currency").setUndefined();
        end;

        return this;
    end;

    macro setValue(value : Money)
        if (m_storage != null)
            if (value != null)
                m_storage.fieldValue("value").exact = value;
                m_storage.fieldValue("value").recalculateScaled();
            else
                m_storage.fieldValue("value").setUndefined();
            end;
        end;

        return this;
    end;

    private macro constructorTF410AttributeValueBase(storage : RcbCompositeValue)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::constructorTF410AttributeValueBase"));
        end;

        if (storage == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::constructorTF410AttributeValueBase", "storage"));
        end;

        if (    (valType(storage) != V_GENOBJ)
            and (isEqClass("RcbCompositeValue", storage))
           )
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::constructorTF410AttributeValueBase", "storage"));
        end;

        m_storage = storage;
    end;

    constructorTF410AttributeValueBase(storage);
end;

/**
 * Форма 410. Класс значения атрибута для атрибута разделов 1, 2.
 *
 * @since 03.10.2018
 * @version 6.20.031.052
 */
class (TF410AttributeValueBase) TF410AttributeValue(storage : RcbCompositeValue)
    private macro constructorTF410AttributeValue(storage : RcbCompositeValue)
        initTF410AttributeValueBase(storage);
    end;

    constructorTF410AttributeValue(storage);
end;

/**
 * Форма 410. Класс значения атрибута для атрибута разделов 1, 2, не связанного с БД.
 * Используется как временное хранилище
 *
 * @since 03.10.2018
 * @version 6.20.031.052
 */
class (IF410AttributeValue) TF410StandaloneAttributeValue(line : String, symbol : String, sector : String, country : String, currency : String, value : Money)
    private var m_line : String;
    private var m_symbol : String;
    private var m_sector : String;
    private var m_country : String;
    private var m_currency : String;
    private var m_value : TValue;

    macro getLine() : String
        return m_line;
    end;

    macro getSymbol() : String
        return m_symbol;
    end;

    macro getSector() : String
        return m_sector;
    end;

    macro getCountry() : String
        return m_country;
    end;

    macro getCurrency() : String
        return m_currency;
    end;

    macro getValue() : Object
        return m_value;
    end;

    macro setLine(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setLine"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setLine", "value"));
        end;

        if (valType(value) != STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setLine", "value"));
        end;

        m_line = value;

        return this;
    end;

    macro setSymbol(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setSymbol"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setSymbol", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setSymbol", "ValType"));
        end;

        m_symbol = value;

        return this;
    end;

    macro setSector(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setSector"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setSector", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setSector", "ValType"));
        end;

        m_sector = value;

        return this;
    end;

    macro setCountry(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setCountry"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setCountry", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setCountry", "ValType"));
        end;

        m_country = value;

        return this;
    end;

    macro setCurrency(value : String)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410AttributeValueBase::setCurrency"));
        end;

        if (value == null)
            throw(TUnspecifiedValueException("TF410AttributeValueBase::setCurrency", "value"));
        end;

        if (valType(value) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410AttributeValueBase::setCurrency", "ValType"));
        end;

        m_currency = value;

        return this;
    end;

    macro setValue(value : Variant)
        m_value = TValue(value, null, 1, 3);
        if (value == null)
            m_value.setUndefined();
        end;

        return this;
    end;

    private macro constructorTF410StandaloneAttributeValue(line : String, symbol : String, sector : String, country : String, currency : String, value : Money)
        if (parmCount() < 2)
            throw(TInvalidNumberOfParametersException("TF410StandaloneAttributeValuePart1::constructorTF410StandaloneAttributeValue"));
        end;

        if (line == null)
            throw(TUnspecifiedValueException("TF410StandaloneAttributeValuePart1::constructorTF410StandaloneAttributeValue", "line"));
        end;

        if (valType(line) != V_STRING)
            throw(TIncorrectParameterTypeException("TF410StandaloneAttributeValuePart1::constructorTF410StandaloneAttributeValue", "line"));
        end;

        setLine(line);
        setSymbol(symbol);
        setSector(sector);
        setCountry(country);
        setCurrency(currency);
        setValue(value);
    end;

    constructorTF410StandaloneAttributeValue(line, symbol, sector, country, currency, value);
end;
