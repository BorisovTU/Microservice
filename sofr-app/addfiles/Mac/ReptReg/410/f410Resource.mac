/*
$Name:          f410Resource.mac
$Module:        Отчеты ЦБ
$Description:   Форма 410. Ресурсы для отчета.
*/

/**
 * Ресурсы для отчета
 */
private class TF410ResourceReport()

    /**
     * Наименование формы
     */
    const NAME_FORM: String = "Форма 410";

    /**
     * Полное наименование отчета
     */
    const FULL_NAME_REPORT: String = "СВЕДЕНИЯ ОБ АКТИВАХ И ПАССИВАХ УПОЛНОМОЧЕННОГО БАНКА ПО ВИДАМ ВАЛЮТ И СТРАНАМ";

    /**
     * Код отчета
     */
    const CODE_REPORT: String = "0409410";

end;

/**
 * Ресурсы для разделов
 */
private class TF410ResourcePart()
    /**
     * Ширина раздела
     * Общее для всех разделов
     */
    var PART_WIDTH: Integer = 107;

    /**
     * Заголовоки для колонок
     * Общие для всех разделов
     */
    var headColumn1: String = "Номер|строки";

    var headColumn2: String = "Код актива|(пассива)";

    var headColumn3: String = "Код сектора|дебитора|(кредитора)";

    var headColumn4: String = "Код страны|дебитора|(кредитора)";

    var headColumn5: String = "Валюта|актива|(пассива";

    var headColumn6: String = "Сумма актива|(пассива) на отчетную|дату";

    /**
     * Заголовок раздела 1
     */
    var headPart1: String = "Раздел 1. Активы и пассивы отчитывающегося банка по отношению к дебиторам (кредиторам) - нерезидентам";

    /**
     * Заголовок раздела 2
     */
    var headPart2: String = "Раздел 2. Активы и пассивы отчитывающегося банка по отношению к дебиторам (кредиторам) - резидентам";

    /**
     * Заголовок раздела 3
     */
    var headPart3: String = "Раздел 3. Сектор и страна места нахождения конечного контролирующего инвестора";

    /**
     * Заголовок раздела 4
     */
    var headPart4: String = "Раздел 4. Активы и обязательства кредитных организаций по отношению к дебиторам (кредиторам) - нерезидентам по производным финансовым инструментам";

    /**
     * Конструктор
     */
    macro constructorF410ResourcePart()
    end;

    constructorF410ResourcePart();
end;

/**
 * Ресурсы для разделов
 */
private class (TF410ResourcePart) TF410ResourcePart_4927()
    /**
     * Конструктор
     */
    macro constructorTF410ResourcePart_4927()
        initTF410ResourcePart();

        headPart1 = "Раздел 1. Активы и пассивы уполномоченного банка по отношению к дебиторам (кредиторам) - нерезидентам";
        headPart2 = "Раздел 2. Активы и пассивы уполномоченного банка по отношению к дебиторам (кредиторам) - резидентам";
        headPart4 = "Раздел 4. Активы и обязательства уполномоченных банков по отношению к дебиторам (кредиторам) - нерезидентам по производным финансовым инструментам";
    end;

    constructorTF410ResourcePart_4927();
end;

/**
 * Ресурсы для ИД
 */
private class TF410ResourceDataSource()
   /**
    * Раздел, Символ, Счета л/с, Счета процентов
    */
    var m_partId              = getSQLChar("");
    var m_code                = getSQLChar("");
    var m_accountMasks        = getSQLChar("");
    var m_accountPercentMasks = getSQLChar("");

    /**
     * Код сектора дебитора (кредитора).
     */
    const SECTOR_100 = getSqlString("100"),
          SECTOR_200 = getSqlString("200"),
          SECTOR_400 = getSqlString("400"),
          SECTOR_600 = getSqlString("600"),
          SECTOR_660 = getSqlString("660"),
          SECTOR_700 = getSqlString("700");

    /**
     * Значения категорий
     */
    var value_cis: String = "'СНГ'";

    var value_far_abroad: String = "'Дальнее зарубежье'";

    var value_rus: String = "'RUS'";

    /**
     * Курс ЦБ
     */
    const RATETYPE_CB = 7; 

     /**
     * Список валют
     */
    var currencyList: String = "'643','840','978','826','756','392','933','398','156'";

    /**
     * Код валюты
     */
    var roubleCodeIso = getSqlString("810");    

    /**
     * Код валюты
     */
    var dollarCode = null;

    /**
     * Код валюты
     */
    var otherCode = getSqlString("999");

    macro getPartId();
        return m_partId;
    end;

    macro getAccountMasks();
        return m_accountMasks;
    end;

    macro getAccountPercentMasks();
        return m_accountPercentMasks;
    end;

    macro getCode()
        return m_code;
    end;

    /**
     * Инициализация
     */
    macro initialize(resourceString : Object)
        m_partId              = getSqlString(resourceString.partId);
        m_code                = getSqlString(resourceString.code);
        m_accountMasks        = resourceString.accountMasks;
        m_accountPercentMasks = resourceString.accountPercentMasks;
    end;

    /**
     * Метод получения id валюты
     */
    private macro getCodeId()
        var ds = TRsbDataset("SELECT t_id FROM drepfininstrument_vw WHERE t_code = '840'");
            ds.next();
        return ds.id;
    end;

    /**
     * Конструктор
     */
    macro constructorF410ResourceDataSource()
        dollarCode = getCodeId();
    end;

    constructorF410ResourceDataSource();
end;

/**
 * Ресурсы для экспорта
 */
private class TF410ResourceExport()
    /**
     * Наименование заголовка для раздела 1 рубли
     */
    const BIS_HEAD_PART_1R: String = "f410r1";    

    /**
     * Наименование заголовка для раздела 1 тысячи
     */
    const BIS_HEAD_PART_1T: String = "f410t1";

    /**
     * Наименование заголовка для раздела 2 рубли
     */
    const BIS_HEAD_PART_2R: String = "f410r";

    /**
     * Наименование заголовка для раздела 2 тысячи
     */
    const BIS_HEAD_PART_2T: String = "f410t";

    /**
     * Конструктор строки для экспорта
     */
    private var m_stringArray : TArray = TArray;

    /**
     * Интерфейсы для взаимодействия с конструктором строки экспорта
     */
    macro getStringArray()
        return m_stringArray;
    end;

    /**
     * Интерфейсы для взаимодействия с конструктором строки экспорта
     */
    macro setValueStringArray(index : Integer, value : Variant)
        m_stringArray[index] = value;
    end;

    /**
     * Инициализация конструктора строки экспорта
     */
    macro initializeStringArray(_sizeArray : Integer)
        var i : Integer = 0;
        var sizeArray : Integer = 0;

        m_stringArray.size = 0;

        if (valType(_sizeArray) != V_UNDEF)
            sizeArray = _sizeArray;
        else
            sizeArray = 16;
        end;

        while(i < sizeArray)
            m_stringArray[i] = 0;
            i = i + 1;
        end;
    end;

    private macro constructorTF410ResourceExport()
        initializeStringArray();
    end;

    constructorTF410ResourceExport();
end;

/**
 * Ресурсы для формы 410
 */
class TF410Resource()
    /**
     * Ресурсы для раздела
     */
    private var part: Object = NULL;

    /**
     * Ресурсы для отчета
     */
    private var report: Object = NULL;

    /**
     * Ресурсы для ИД
     */
    private var dataSource: Object = NULL;

    /**
     * Ресурсы для экспорта
     */
    private var export: Object = NULL;

    /**
     * Получить ресурсы раздела
     * @return Object TF410ResourcePart 
     */
    macro getPart()
        return part;
    end;

    /**
     * Получить Ресурсы для отчета
     * @return Object TF410ResourceReport 
     */
    macro getReport()
        return report;
    end;

    /**
     * Получить ресурсы ИД
     * @return Object TF410ResourceDataSource 
     */
    macro getDataSource()
        return dataSource;
    end;

    /**
     * Получить ресурсы экспорта
     */
    macro getExport()
        return export;
    end;

    /**
     * Конструктор
     */
    macro constructorF410Resource()
        part         = TF410ResourcePart();
        dataSource   = TF410ResourceDataSource();
        report       = TF410ResourceReport();
        export       = TF410ResourceExport();
    end;

    constructorF410Resource();
end;

/**
 * Ресурсы для формы 410
 */
class (TF410Resource) TF410Resource_4927()
    /**
     * Конструктор
     */
    macro constructorTF410Resource_4927()
        initTF410Resource();

        part= TF410ResourcePart_4927();
    end;

    constructorTF410Resource_4927();
end;