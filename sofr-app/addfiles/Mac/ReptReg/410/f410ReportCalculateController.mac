/*
$Name:          f410ReportCalculateController.mac
$Module:        Отчеты ЦБ
$Description:   Форма 410. Класс контроллера расчета отчета.
*/

class (RcbReportCalculateController) TF410ReportCalculateController()
    private macro clearValues()
        getReport().getPart(TF410Global().getPart1Id()).getPartCompositeValue().removeAllValues();
        getReport().getPart(TF410Global().getPart2Id()).getPartCompositeValue().removeAllValues();
        RcbApplication().transactionManager.commit();

        getReport().getPart(TF410Global().getPart1Id()).clear();
        getReport().getPart(TF410Global().getPart2Id()).clear();

        getDataSources().clear();
    end;

    private macro pushControllers()
        m_partCalculateControllers.push_back(objectFactoryInstance.createPart1CalculateController(this));
        m_partCalculateControllers.push_back(objectFactoryInstance.createPart2CalculateController(this));
    end;

    private macro printAdditionalProtocolData()
        //TF410Parameters().printCalculationReport(getProtocolView());
    end;

    macro calculate()
        var result = calculate();
        for (var i, m_partCalculateControllers)
            i.getDataProtocolView().save();
        end;
        return result;
    end;

    macro initialize() : Bool
        clearValues();
        pushControllers();

        return m_partCalculateControllers.size > 0;
    end;

    private macro constructorTF410ReportCalculateController()
        initRcbReportCalculateController();
    end;

    constructorTF410ReportCalculateController();
end;
