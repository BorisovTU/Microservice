/*
$Name:          f603Part.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 603. Класс раздела отчета
*/

class (RcbPartBase) F603Part(id : Integer, compositeValue /*: RcbAttributeValue или RcbCompositeValue*/)
    initRcbPartBase(id, compositeValue);

    macro getAttribute(attributeId : String, branchId : Integer) : RcbAttributeBase
        m_attributes.moveFirst();
        while (m_attributes.moveNext())
            if (m_attributes.getCurrentItem().getId() == attributeId)
                return m_attributes.getCurrentItem();
            end;
        end;

        return m_attributes.push_back(objectFactoryInstance.createAttribute(attributeId, this, m_compositeValue, branchId));
    end;

    macro addAttribute(attributeId : String, branchId : Integer)
        getAttribute(attributeId, branchId);

        return this;
    end;

    macro findAttribute(column, value)
        var i = 0;

        while (i < getAttributes().size)
            if (getAttributes()[i].getValueAsString(column) == String(value))
                return getAttributes()[i];
            end;

            i = i + 1;
        end;

        return null;
    end;

    macro getPreviousAttribute(attributeId : String)
        var attribute = null;

        m_attributes.moveFirst();
        while (m_attributes.moveNext())
            if (m_attributes.getCurrentItem().getId() == attributeId)
                return attribute;
            end;

            attribute = m_attributes.getCurrentItem();
        end;

        return null;
    end;
end;
