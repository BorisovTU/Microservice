/*
$Name:          f501Global.mac
$Module:        Отчеты ЦБ
$Description:   Форма 501. Класс глобализмов.
*/

private class (TGlobalBase) TF501GlobalImpl()
    private var m_rcbReport : RcbReport;
    private var m_usdFiId : Integer;
    private var m_tune : Object;

    macro getRcbReport() : RcbReport
        return m_rcbReport;
    end;

    macro getPart1Id() : String
        return "PART1";
    end;

    macro getPart2Id() : String
        return "PART2";
    end;

    macro getPart1UserInputId() : String
        return "PART1USERINPUT";
    end;

    macro getPart2UserInputId() : String
        return "PART2USERINPUT";
    end;

    macro getTune()
        return m_tune;
    end;

    private macro constructorTF501GlobalImpl()
        initTGlobalBase();
        m_rcbReport = RcbApplication().currentReport;
        initializeRepDataPackage(m_rcbReport);

        m_tune = objectFactoryInstance.createTuneTable();
    end;

    constructorTF501GlobalImpl();
end;

macro TF501Global() : TF501GlobalImpl
    if (v_global == null)
        v_global = TF501GlobalImpl();
    end;

    return v_global;
end;
