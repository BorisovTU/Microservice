/*
$Name:          f501PartView.mac
$Module:        Отчеты ЦБ
$Description:   Форма 501. Печатное представления разделов.
*/

/**
 * Форма 501. Печатное представление раздела 1.
 */
class (RcbPartView) TF501Part1View(reportView)
    private var m_rowsData : Object;
    private var m_bankName : String;

    private macro initialize()
        m_table.addColumn("1", 05, AL_CENTER);
        m_table.addColumn("2", 22, AL_LEFT);
        m_table.addColumn("3", 13, AL_RIGHT);
        m_table.addColumn("4", 13, AL_RIGHT);
        m_table.addColumn("5", 13, AL_RIGHT);
        m_table.addColumn("6", 13, AL_RIGHT);
        m_table.addColumn("7", 13, AL_RIGHT);
        m_table.addColumn("8", 13, AL_RIGHT);

        m_table.setUseColumnNumbering(false);
    end;

    private macro getSheetIndexText(sheetIndex, sheetsAmount)
        return "Наименование кредитной организации " + m_bankName + ". Стр." + sheetIndex + " из " + sheetsAmount;
    end;

    macro getWidth(sheetsAmount)
        return max(m_table.getSumLen(), strlen(getSheetIndexText(sheetsAmount, sheetsAmount)));
    end;

    macro printHead()
        m_reportView.getNamesZone().clearExcludeAttributes();
    end;

    macro printSheetHead(sheetsAmount, sheetIndex, nrCode, currencyCode)
        m_table.setEmpty();
    end;

    macro printString(rowCode, value)
        var valueArray = RcbArray();
        valueArray.push_back(rowCode);
    end;

    macro printBottom()
    end;

    private macro constructorTF501Part1View(reportView)
        initRcbPartView(TF501Global().getPart1Id(), reportView);
        m_rowsData;
        m_bankName = trim(m_reportView.getNamesZone().getLendingAgencyName());

    end;

    constructorTF501Part1View(reportView);
end;


/**
 * Форма 501. Печатное представление раздела 2.
 */
class (RcbPartView) TF501Part2View(reportView)
    private var m_rowsData : Object;
    private var m_isPartHeaderNotPrinted : Bool;
    private var m_bankName : String;


    private macro initialize()
        m_table.addColumn("1", 05, AL_CENTER);
        m_table.addColumn("2", 22, AL_LEFT);
        m_table.addColumn("3", 13, AL_RIGHT);
        m_table.addColumn("4", 13, AL_RIGHT);
        m_table.addColumn("5", 13, AL_RIGHT);
        m_table.addColumn("6", 13, AL_RIGHT);
        m_table.addColumn("7", 13, AL_RIGHT);
        m_table.addColumn("8", 13, AL_RIGHT);

        m_table.setUseColumnNumbering(false);
    end;

    private macro getSheetIndexText(sheetIndex, sheetsAmount)
        return "Наименование кредитной организации " + m_bankName + ". Стр." + sheetIndex + " из " + sheetsAmount;
    end;

    macro getWidth(sheetsAmount)
    end;

    macro printHead()
        m_reportView.getNamesZone().clearExcludeAttributes();
    end;

    macro printSheetHead(sheetsAmount, sheetIndex, nrCode, currencyCode)
        var reportWidth = m_reportView.getReportWidth();

        println();


        m_table.setEmpty();
    end;

    macro printString()
    end;

    macro printBottom()
    end;

    private macro constructorTF501Part2View(reportView)
        initRcbPartView(TF501Global().getPart2Id(), reportView);
        m_bankName = trim(m_reportView.getNamesZone().getLendingAgencyName());

    end;

    constructorTF501Part2View(reportView);
end;
