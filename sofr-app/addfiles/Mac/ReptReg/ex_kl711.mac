/*
$Name:          ex_kl711.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 711. Контроллер экспорта в kliko
*/

/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank 6.0                                      R-Style Software Lab Ltd
   Файл подсистемы "Регламентируемая отчетность"

   Экспорт значений переменных формы 711 в текстовый файл для программы
   kliko.exe

   CREATED : 13.01.2006 Лузгин

   MODIFICATIONS:
   NOTES:

└────────────────────────────────────────────────────────────────────────── */

IMPORT RsbDataSet;
IMPORT param;
IMPORT logfile;
IMPORT lib_exp;
IMPORT com_f711;
IMPORT rcbCoreInter;
IMPORT RcbLibrary;
IMPORT RcbObjectFactoryBase;
IMPORT RcbAttributeBase;
IMPORT RcbPartBase;
IMPORT RcbReportBase;
IMPORT RcbKlikoView;
IMPORT RcbProtocolView;
IMPORT RcbKlikoExportController;
IMPORT lib_lang;

/* ============================= Декларации =============================== */

/* ------------------------ Файлы, структуры, диалоги --------------------- */


FILE wrk () txt write;      // Файл экспорта

/* ------------------------- Настройки и константы ------------------------ */


/* -------------------------- Классы и переменные ------------------------- */

VAR ExpFileNames = TArray;
    ExpFileNames = ArrCreate( "", "DEPO_KLN", "DEPO_KON", "LORON", "NOSTRON", "SECL_KLN", "SECL_KON", "FILIALN", "REKW_KKE" );

VAR ExpFileName, ИмяФайлаПротоколаЭксп = GetNameLog( "711e" );

VAR EmptyReport = true;     // Флаг отчета без данных
VAR NoData = TArray;        // Массив индикаторов отсутствия данных
                            //  в отдельных таблицах отчетной формы
VAR VarArray = TArray;      // Массив значений переменных первого раздела
VAR MetaInfo;               // Метаинформация для структур, и ..
                            //  .. сами структурные переменные:
VAR Struct_2_1, Struct_2_2, Struct_3_1, Struct_3_2;

/* ========================= Вспомогательные функции ====================== */

// Вывести отформатированную строку в файл экспорта
private
MACRO PrintExpString( arr )
    var str = "";
    var param, i = 0;
    while( i < arr.size )
        param = arr[i];
        if( ValType(param) != V_STRING )
            param = string( param:0:4 );
        end;
        param = StrSubst( param, "\"", "''" );
        str = str + ",\"" + param + "\"";
        i = i + 1;
    end;
    str = SubStr( str, 2 );
    insert( wrk, str );
END;

// Загрузить все переменные формы из базы данных
private MACRO LoadAllVars()

    var i = 0;
    while( i < 6 )
        NoData[i] = true;
        i = i + 1;
    end;

    message( "Чтение переменных первого раздела..." );
    var name, temp;
    i = 0;
    while( i < MaxColumn_1_1 )
        i = i + 1;
        VarArray[i] = 0;
        name = GetVarName( 1, i );
        if( not ПрочитатьПеременную2( temp, VarArray[i] , ДатаОтчета, ПредДатаОтчета, {Название отчета}, name ) )
            msgbox( "Ошибка чтения переменной ", name );
        elif( (NoData[0]) and ( VarArray[i] > 0 ) )
            NoData[0] = false;
            EmptyReport = false;
        end;
    end;
    while( i < MaxColumn_1 )
        i = i + 1;
        VarArray[i] = 0;
        name = GetVarName( 1, i );
        if( not ПрочитатьПеременную2( temp, VarArray[i] , ДатаОтчета, ПредДатаОтчета, {Название отчета}, name ) )
            msgbox( "Ошибка чтения переменной ", name );
        elif( (NoData[1]) and ( VarArray[i] > 0 ) )
            NoData[1] = false;
            EmptyReport = false;
        end;
    end;

    MetaInfo = CStructMetaInfo711_2;

    message( "Чтение переменных второго раздела..." );
    Struct_2_1 = CStructVar( MetaInfo );
    Struct_2_1.Load( GetVarName(2,1) );
    if( Struct_2_1.Values.size > 0 )
        NoData[2] = false;
        EmptyReport = false;
    end;

    Struct_2_2 = CStructVar( MetaInfo );
    Struct_2_2.Load( GetVarName(2,2) );
    if( Struct_2_2.Values.size > 0 )
        NoData[3] = false;
        EmptyReport = false;
    end;

    message( "Чтение переменных третьего раздела..." );
    MetaInfo = CStructMetaInfo711_3_1;
    Struct_3_1 = CStructVar( MetaInfo );
    Struct_3_1.Load( GetVarName(3,1) );
    if( Struct_3_1.Values.size > 0 )
        NoData[4] = false;
        EmptyReport = false;
    end;

    MetaInfo = CStructMetaInfo711_3_2;
    Struct_3_2 = CStructVar( MetaInfo );
    Struct_3_2.Load( GetVarName(3,2) );
    if( Struct_3_2.Values.size > 0 )
        NoData[5] = false;
        EmptyReport = false;
    end;
END;

/* ================== Процедура экспорта ================================== */
private
MACRO ExportPart( part_ )

    var count = 0;
    macro FormatValues2( values );
        var i = 0;
        while( i < 4 )
            if( (values[i] == NULL) or (values[i] == "") )
                values[i] = "-";
            end;
            i = i + 1;
        end;

        if( values[i] == NULL )
            values[i] = 0;
        end;
    end;

    macro FormatValues3( values )
        var val, j = 0;
        while( j < 5 )
            if( (values[j] == "") or (values[j] == NULL) )
                values[j] = "-";
            end;
            if( ValType(values[j]) != V_STRING )
                values[j] = string( values[j]:0:0 );
            end;
            j = j + 1;
        end;
        while( j < values.size )
            val = values[j];
            if( val == NULL )
                values[j] = 0;
            end;
            j = j + 1;
        end;
    end;

    var i, j, maxj, str = "<" + ExpFileNames[part_] + ">";
    var iterator = RcbApplication.currentReport.attributeValue("Ф711_4").createValueIterator();

    insert( wrk, str );
    var Arr = TArray;
    if( part_ == 1 )
        i = 0;
        while( i < MaxColumn_1_1 )
            i = i + 1;
            Arr[Arr.size] = VarArray[i];
        end;
        PrintExpString( Arr );
        count = count + 1;
    elif( part_ == 2 )
        i = MaxColumn_1_1;
        while( i < MaxColumn_1 )
            i = i + 1;
            Arr[Arr.size] = VarArray[i];
        end;
        PrintExpString( Arr );
        count = count + 1;
    elif( part_ == 3 )
        i = 0;
        while( i < Struct_2_1.Values.size )
            FormatValues2( Struct_2_1.Values[i] );
            Arr.size = 0;
            j = 0;
            while( j < Struct_2_1.MetaInfo.FieldNames.size )
                if( Struct_2_1.MetaInfo.FieldNames[j] == "Признак депозитария" )
                    str = SubStr( Struct_2_1.Values[i][j], 1, 1 );
                else
                    str = string( Struct_2_1.Values[i][j]:0:0 );
                end;
                Arr[Arr.size] = str;
                j = j + 1;
            end;
            PrintExpString( Arr );
            count = count + 1;
            i = i + 1;
        end;
    elif( part_ == 4 )
        i = 0;
        while( i < Struct_2_2.Values.size )
            FormatValues2( Struct_2_2.Values[i] );
            Arr.size = 0;
            j = 0;
            while( j < Struct_2_2.MetaInfo.FieldNames.size )
                if( Struct_2_2.MetaInfo.FieldNames[j] == "Признак депозитария" )
                    str = SubStr( Struct_2_2.Values[i][j], 1, 1 );
                else
                    str = string( Struct_2_2.Values[i][j]:0:0 );
                end;
                Arr[Arr.size] = str;
                j = j + 1;
            end;
            PrintExpString( Arr );
            count = count + 1;
            i = i + 1;
        end;
    elif( part_ == 5 )
        i = 0;
        while( i < Struct_3_1.Values.size )
            FormatValues3( Struct_3_1.Values[i] );
            maxj = Struct_3_1.MetaInfo.FieldNames.size - 3;
            Arr.size = 0;
            Arr[Arr.size] = Struct_3_1.Values[i][0];
            Arr[Arr.size] = Struct_3_1.Values[i][maxj+1];
            Arr[Arr.size] = Struct_3_1.Values[i][1];
            Arr[Arr.size] = Struct_3_1.Values[i][2];
            Arr[Arr.size] = Struct_3_1.Values[i][3];
            Arr[Arr.size] = Struct_3_1.Values[i][maxj+2];
            Arr[Arr.size] = string( Struct_3_1.Values[i][4]:0:0 );
            j = 5;
            while( j < maxj + 1 )
                Arr[Arr.size] = string( Struct_3_1.Values[i][j]:0:4 );
                j = j + 1;
            end;
            PrintExpString( Arr );
            count = count + 1;
            i = i + 1;
        end;
    elif( part_ == 6 )
        i = 0;
        while( i < Struct_3_2.Values.size )
            FormatValues3( Struct_3_2.Values[i] );
            maxj = Struct_3_2.MetaInfo.FieldNames.size - 3;
            Arr.size = 0;
            Arr[Arr.size] = Struct_3_2.Values[i][0];
            Arr[Arr.size] = Struct_3_2.Values[i][maxj+1];
            Arr[Arr.size] = Struct_3_2.Values[i][1];
            Arr[Arr.size] = Struct_3_2.Values[i][2];
            Arr[Arr.size] = Struct_3_2.Values[i][3];
            Arr[Arr.size] = Struct_3_2.Values[i][maxj+2];
            Arr[Arr.size] = string( Struct_3_2.Values[i][4]:0:0 );
            j = 5;
            while( j < maxj + 1 )
                Arr[Arr.size] = string( Struct_3_2.Values[i][j]:0:4 );
                j = j + 1;
            end;
            PrintExpString( Arr );
            count = count + 1;
            i = i + 1;
        end;
    elif( part_ == 7 )

        iterator.moveFirst();

        while (not iterator.isDone())
            Arr.size = 0;
            Arr[Arr.size] = iterator.currentItem.fieldValue("regionName").currentAsString;
            Arr[Arr.size] = iterator.currentItem.fieldValue("okatoCode").currentAsString;
            Arr[Arr.size] = iterator.currentItem.fieldValue("nDepartment").currentAsString;
            PrintExpString( Arr );

            iterator.moveNext();
            count = count + 1;
        end;
    elif( part_ == 8 )
        PrintExpString( ArrCreate( GetLicenseNumber(OurBank), ИНН, {Name_Bank}, "Руководитель депозитария", {Fio_Boss},
                        "", "", "", Исполнитель, Номер_телефона, "", "", "" ) );
        count = count + 1;
    end;

    return count;

END;


MACRO ПечатьПротокола();

 if ( ViewFileLog( ИмяФайлаПротоколаЭксп ) )
   УстановитьФлагВозврата( OK_MACRO_FLAG ); /* Успешное завершение макроса */
 end;

 exit(1);
END;

/* ============================= Точка входа ============================== */
class TKlikoExport_I1841()
var quant, par = CmdArgs();

    macro export()
if( par == "protocol" )
    ПечатьПротокола();
end;

if ( РасчетВКопейках )
    msgbox("Данные для экспорта в kliko.exe должны быть представлены в тысячах");
    exit(1);
end;

SetOutput( ИмяФайлаПротоколаЭксп );

println( "Форма 711. Депозитарный отчет" );
println( "Протокол экспорта в kliko.exe" );
println( "    Период выпуска отчета с ", ПредДатаОтчета:f, " по ", ДатаОтчета:f );
println( "    Исполнитель: ", {oper}, " ", Исполнитель );
println();

LoadAllVars();
message( "Заполнение файлов экспорта" );
var i = 1;
while( i < 9 )
    ExpFileName = ExpFileNames[i] + substr( string(ДатаОтчета:f), 1, 2 ) +
            substr( string(ДатаОтчета), 4, 2 ) +
            substr( string(ДатаОтчета), 7, 4 ) + ".DAT";

    if( not GetExpFileName( ExpFileName ) )
        exit(1);
    end;

    if( not open( wrk, ExpFileName ) )
        msgBox("Невозможно открыть файл экспорта|" + ExpFileName );
        exit(1);
    else
        println( date():f, " ", time(), " Файл: ", ExpFileName );
    end;

    quant = ExportPart(i);
    println( date():f, " ", time(), " Выгружено строк: ", quant );
    println();

    close(wrk);
    i = i + 1;

end;

println( "Создано файлов: 8" );
println();
println( date():f, " ", time(), " Окончание экспорта" );

ПечатьПротокола();
    end;

    macro execute()
        export();
    end;
end;

/**
 * Экспорт ф.711 в соответствии с указанием 2055-У
 *
 * @author Deulya
 * @since 6.00.020.29
 */
class (TRcbKlikoView) TKlikoExport_I2055()
    private var m_report : RcbReport = RcbApplication().currentReport;

    var m_protocolView = TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko.exe");

    const TYPE_DATE   = 1;
    const TYPE_STRING = 2;
    const TYPE_NUMBER = 3;

    macro getFileName(namePart)
        m_rowsCount = 0;
        m_name = "";
        var day;
        var month;
        var year;

        dateSplit(m_reportDate + 1, day, month, year);

        m_name = получитьКаталогЭкспорта() + "\\" + namePart
                                                  + strLpad(String(day),   2, "0")
                                                  + strLpad(String(month), 2, "0")
                                                  + String(year)
                                                  + toAnsi("." + m_fileExtension);
    end;

    private macro getDescriptorInfo()
        return "";
    end;

    /**
     * Форматирование даты
     * @param str - форматируемая строка
     */
    macro formatDate(str) : String

        var day, month, year;
        var dayStr, monthStr, yearStr;

        if (str == date(0,0,0))
            return "";
        end;

        dateSplit(date(str), day, month, year);
        dayStr   = string(day:2:o);
        monthStr = string(month:2:o);
        yearStr  = string(year:4:o);

        return dayStr + "." + monthStr + "." + yearStr;
    end;

    /**
     * Форматирование строки
     * @param str - форматируемая строка
     * @param n - длина строки для экспорта
     */
    macro formatString(str, n : Integer) : String

        var result;

        if (str == null)
            result = "";
        else
            str = string(str);
            if (strLen(str) > n)
                result = subStr(str, 1, n);
            else
                result = str;
            end;
        end;

        return strSubst(result, "\"", "'");
    end;

    /**
     * Форматирование числа
     * @param str - форматируемая строка
     * @param p1 - количество знаков всего
     * @param p2 - количество знаков после запятой (если 0 - выводится как целое)
     */
    macro formatNumber(str, p1 : Integer, p2 : Integer) : String

        var result;

        if ((str != null) and (str != 0))
            result = trim(execExp("string(str:" + p1 + ":" + p2+ ")"));
        else
            result = "0";
        end;

        return result;

    end;

    /**
     * Форматирование строки для экспорта
     * @param str - форматируемая строка
     * @param type - тип формата
     * @param parm1 - количество знаков всего/длина строки для экспорта
     * @param parm2 - количество знаков после запятой (если 0 - выводится как целое)
     */
    macro format(str, type : Integer, parm1 : Integer, parm2 : Integer) : String

        var result;

        if (type == TYPE_DATE)
            result = formatDate(str);
        elif (type == TYPE_STRING)
            result = formatString(str, parm1);
        elif (type == TYPE_NUMBER)
            result = formatNumber(str, parm1, parm2);
        end;
        return result;
    end;

    macro printProtocol()
        [Файл описателя: #] (getDescriptorInfo());
        [Файл экспорта: #] (m_name);
        [Выгружено строк: #####] (m_RowsCount:r);
        println();
    end;

    macro depo_kln()
        getFileName("DEPO_KLN");
        setOutputFile();
        printHead("DEPO_KLN");

        var TValue = TArray();
        var i;

        i = 1;

        while (i < 10)
            TValue[TValue.size] = format(m_report.attributeValue("Ф711_Гр"+String(i)).current, TYPE_NUMBER, 16, 0);
            i = i + 1;
        end;

        printRow(TValue);
        resetOutputFile();
        printProtocol();
    end;

    macro depo_kon()
        getFileName("DEPO_KON");
        setOutputFile();
        printHead("DEPO_KON");

        var TValue = TArray();
        var i;
        i = 10;

        while (i < 16)
            TValue[TValue.size] = format(m_report.attributeValue("Ф711_Гр"+String(i)).current, TYPE_NUMBER, 16, 0);
            i = i + 1;
        end;

        printRow(TValue);
        resetOutputFile();
        printProtocol();
    end;

    macro loron()
        getFileName("LORON");
        setOutputFile();
        printHead("LORON");

        var valueIterator = m_report.attributeValue("Ф711_2_1").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("Наименование депозитария").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("Лицензия участника ОРЦБ").current, TYPE_STRING, 14),
                                format(valueIterator.currentItem.fieldValue("Признак депозитария").current, TYPE_STRING, 1),
                                format(valueIterator.currentItem.fieldValue("Междепозитарный счет").current, TYPE_STRING, 30),
                                format(valueIterator.currentItem.fieldValue("Количество ц/б на счете").current, TYPE_NUMBER, 17, 4));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro nostron()
        getFileName("NOSTRON");
        setOutputFile();
        printHead("NOSTRON");

        var valueIterator = m_report.attributeValue("Ф711_2_2").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("Наименование депозитария").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("Лицензия участника ОРЦБ").current, TYPE_STRING, 14),
                                format(valueIterator.currentItem.fieldValue("Признак депозитария").current, TYPE_STRING, 1),
                                format(valueIterator.currentItem.fieldValue("Междепозитарный счет").current, TYPE_STRING, 30),
                                format(valueIterator.currentItem.fieldValue("Количество ц/б на счете").current, TYPE_NUMBER, 17, 4));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro secl_kln()
        getFileName("SECL_KLN");
        setOutputFile();
        printHead("SECL_KLN");

        var valueIterator = m_report.attributeValue("Ф711_3_1").createValueIterator();
        var TValue = TArray();

        valueIterator.first();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate(format(valueIterator.currentItem.fieldValue("Эмитент").current, TYPE_STRING, 250),
                               format(valueIterator.currentItem.fieldValue("Тип эмитента").current, TYPE_STRING, 2),
                               format(valueIterator.currentItem.fieldValue("ИНН эмитента").current, TYPE_STRING, 12),
                               format(valueIterator.currentItem.fieldValue("Код типа ц/б").current, TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Идентификатор ц/б").current, TYPE_STRING, 50),
                               format(valueIterator.currentItem.fieldValue("Способ заполнения номера").current, TYPE_STRING, 1),
                               format(ternary(valueIterator.currentItem.fieldValue("Валюта ц/б").current == 0, null, valueIterator.currentItem.fieldValue("Валюта ц/б").currentAsString), TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Номинал ц/б").current, TYPE_NUMBER, 18, 6),
                               format(valueIterator.currentItem.fieldValue("Графа 32").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 33").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 34").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 35").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 36").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 37").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 38").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 39").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 40").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 41").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 42").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 43").current, TYPE_NUMBER, 17, 4));

            if (in(TValue[3], "DR", "SHS7", "SHS8", "OPN")) // 12.05.2009 DAA Если код ц/б  принимает значения DR, SHS7, SHS8, OPN,
                TValue[7] = format("", TYPE_STRING, 1);     // 12.05.2009 DAA то номинал не выводится
            end;

            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro secl_kon()
        getFileName("SECL_KON");
        setOutputFile();
        printHead("SECL_KON");

        var valueIterator = m_report.attributeValue("Ф711_3_2").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate(format(valueIterator.currentItem.fieldValue("Эмитент").current, TYPE_STRING, 250),
                               format(valueIterator.currentItem.fieldValue("Тип эмитента").current, TYPE_STRING, 2),
                               format(valueIterator.currentItem.fieldValue("ИНН эмитента").current, TYPE_STRING, 12),
                               format(valueIterator.currentItem.fieldValue("Код типа ц/б").current, TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Идентификатор ц/б").current, TYPE_STRING, 50),
                               format(valueIterator.currentItem.fieldValue("Способ заполнения номера").current, TYPE_STRING, 1),
                               format(ternary(valueIterator.currentItem.fieldValue("Валюта ц/б").current == 0, null, valueIterator.currentItem.fieldValue("Валюта ц/б").currentAsString), TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Номинал ц/б").current,
                                      TYPE_NUMBER,
                                      21,
                                      valueIterator.currentItem.fieldValue("Точность номинала ц/б").current
                                     ),
                               format(valueIterator.currentItem.fieldValue("Графа 50").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 51").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 52").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 53").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 54").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 55").current, TYPE_NUMBER, 17, 4));

            if (TValue[3] == "ENC")
                TValue[1] = format(12, TYPE_NUMBER, 5, 0);
            end;

            if (in(TValue[3], "DR", "SHS7", "SHS8", "OPN")) // 12.05.2009 DAA Если код ц/б  принимает значения DR, SHS7, SHS8, OPN,
                TValue[7] = format("", TYPE_STRING, 1);     // 12.05.2009 DAA то номинал не выводится
            end;

            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro filialn()
        getFileName("FILIALN");
        setOutputFile();
        printHead("FILIALN");

        var valueIterator = m_report.attributeValue("Ф711_4").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("regionName").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("okatoCode").current, TYPE_STRING, 4),
                                format(valueIterator.currentItem.fieldValue("nDepartment").current, TYPE_NUMBER, 12, 0));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro rekw_kke()
        getFileName("REKW_KKE");
        setOutputFile();
        printHead("REKW_KKE");

        var TValue = TArray();
        TValue = arrCreate( GetLicenseNumber(OurBank), ИНН, strSubst({Name_Bank}, "\"", "'"), "Руководитель депозитария", {Fio_Boss},
                            "", "", "", Исполнитель, Номер_телефона, "", "", "" );
        printRow(TValue);
        resetOutputFile();
        printProtocol();
    end;

    macro vek_ko_u()
        getFileName("VEK_KO_U");
        setOutputFile();
        printHead("VEK_KO_U");

        var valueIterator = m_report.attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("issuerName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("code711").current, TYPE_STRING, 5),
                                format(valueIterator.currentItem.fieldValue("issuerInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("series").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("number").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("formNumber").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("issueDate").current, TYPE_DATE),
                                format(valueIterator.currentItem.fieldValue("paymentTerm").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("faceValue").current, TYPE_NUMBER, 17, 4),
                                format(valueIterator.currentItem.fieldValue("faceValueFiCode").current, TYPE_STRING, 3),
                                format(valueIterator.currentItem.fieldValue("dealDate").current, TYPE_DATE),
                                format(valueIterator.currentItem.fieldValue("dealGround").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("dealAgentName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("dealAgentInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("bookValue").current, TYPE_NUMBER, 17, 2),
                                format(valueIterator.currentItem.fieldValue("interest").current, TYPE_NUMBER, 17, 2),
                                format(valueIterator.currentItem.fieldValue("balanceAccount").current, TYPE_STRING, 5),
                                format(valueIterator.currentItem.fieldValue("storagePlaceName").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("storagePlaceInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("storageGround").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("note").current, TYPE_STRING, 250));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro vek_ko_v()
        getFileName("VEK_KO_V");
        setOutputFile();
        printHead("VEK_KO_V");

        var valueIterator = m_report.attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("series").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("number").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("formNumber").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("issueDate").current, TYPE_DATE),
                                format(valueIterator.currentItem.fieldValue("paymentTerm").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("faceValue").current, TYPE_NUMBER, 17, 4),
                                format(valueIterator.currentItem.fieldValue("faceValueFiCode").current, TYPE_STRING, 3),
                                format(valueIterator.currentItem.fieldValue("firstHolderName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("firstHolderInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("state").current, TYPE_STRING, 100),
                                format(valueIterator.currentItem.fieldValue("holderName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("holderInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("note").current, TYPE_STRING, 250));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro vek_stl()
        getFileName("VEK_STL");
        setOutputFile();
        printHead("VEK_STL");

        var valueIterator = m_report.attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate (format(valueIterator.currentItem.fieldValue("issuerName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("code711").current, TYPE_STRING, 5),
                                format(valueIterator.currentItem.fieldValue("issuerInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("series").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("number").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("formNumber").current, TYPE_STRING, 50),
                                format(valueIterator.currentItem.fieldValue("issueDate").current, TYPE_DATE),
                                format(valueIterator.currentItem.fieldValue("paymentTerm").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("faceValue").current, TYPE_NUMBER, 17, 4),
                                format(valueIterator.currentItem.fieldValue("faceValueFiCode").current, TYPE_STRING, 3),
                                format(valueIterator.currentItem.fieldValue("dealDate").current, TYPE_DATE),
                                format(valueIterator.currentItem.fieldValue("dealGround").current, TYPE_STRING, 250),
                                format(valueIterator.currentItem.fieldValue("holderName").current, TYPE_STRING, 150),
                                format(valueIterator.currentItem.fieldValue("holderInn").current, TYPE_STRING, 12),
                                format(valueIterator.currentItem.fieldValue("note").current, TYPE_STRING, 250));
            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro export()
        m_protocolView.printHead();
        depo_kln();
        depo_kon();
        loron();
        nostron();
        secl_kln();
        secl_kon();
        filialn();
        rekw_kke();
        vek_ko_u();
        vek_ko_v();
        vek_stl();
    end;

    macro execute()
        export();
    end;

    initTRcbKlikoView("DAT", m_report.context.period.endDate);
end;

/**
 * Экспорт ф.711 в соответствии с указанием 2627-У
 *
 * @author SER
 * @since 6.00.020.30
 */
class (TKlikoExport_I2055) TKlikoExport_I2627()
    initTKlikoExport_I2055();

    private macro getDescriptorInfo()
        return ""; /* от 26.01.2009 */
    end;

    macro secl_kon()
        getFileName("SECL_KON");
        setOutputFile();
        printHead("SECL_KON");

        var valueIterator = m_report.attributeValue("Ф711_3_2").createValueIterator();
        var TValue = TArray();

        valueIterator.moveFirst();

        while (not valueIterator.isDone())
            TValue.size = 0;
            TValue = arrCreate(format(valueIterator.currentItem.fieldValue("Эмитент").current, TYPE_STRING, 250),
                               format(valueIterator.currentItem.fieldValue("Тип эмитента").current, TYPE_STRING, 2),
                               format(valueIterator.currentItem.fieldValue("ИНН эмитента").current, TYPE_STRING, 12),
                               format(valueIterator.currentItem.fieldValue("Код типа ц/б").current, TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Идентификатор ц/б").current, TYPE_STRING, 50),
                               format(valueIterator.currentItem.fieldValue("Способ заполнения номера").current, TYPE_STRING, 1),
                               format(ternary(valueIterator.currentItem.fieldValue("Валюта ц/б").current == 0, null, valueIterator.currentItem.fieldValue("Валюта ц/б").currentAsString), TYPE_STRING, 5),
                               format(valueIterator.currentItem.fieldValue("Номинал ц/б").current, TYPE_NUMBER, 18, 6),
                               format(valueIterator.currentItem.fieldValue("Графа 50").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 51").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 52").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 53").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 54").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 55").current, TYPE_NUMBER, 17, 4),
                               format(valueIterator.currentItem.fieldValue("Графа 62").current, TYPE_STRING, 250),
                               format(valueIterator.currentItem.fieldValue("Графа 63").current, TYPE_STRING, 12),
                               format(valueIterator.currentItem.fieldValue("Графа 64").current, TYPE_STRING, 14),
                               format(valueIterator.currentItem.fieldValue("Графа 65").current, TYPE_STRING, 1));

            if (TValue[3] == "ENC")
                TValue[1] = format(12, TYPE_NUMBER, 5, 0);
            end;

            if (in(TValue[3], "DR", "SHS7", "SHS8", "OPN")) // 12.05.2009 DAA Если код ц/б  принимает значения DR, SHS7, SHS8, OPN,
                TValue[7] = format("", TYPE_STRING, 1);     // 12.05.2009 DAA то номинал не выводится
            end;

            printRow(TValue);
            valueIterator.moveNext();
        end;
        resetOutputFile();
        printProtocol();
    end;

    macro export()
        m_protocolView.printHead();
        depo_kln();
        depo_kon();
        loron();
        nostron();
        secl_kln();
        secl_kon();
        rekw_kke();
        vek_ko_u();
        vek_ko_v();
        vek_stl();
    end;

    macro execute()
        export();
    end;
end;

/**
 *  Обращение к полю неизвестного типа
 */
private class (TException) TIllegalFieldTypeException(type : Integer)
    initTException("Неизвестный тип поля: " + string(type), true);
end;

private class (TRcbKlikoView) TF711PartKlikoView(reportDate : Date, partName : String)
    private var m_partName : String;

    macro getPartName()
        return m_partName;
    end;

    private macro constructorTF711PartKlikoView(reportDate : Date, partName : String)
        initTRcbKlikoView("DAT", reportDate);

        m_partName = partName;

        var day;
        var month;
        var year;

        dateSplit(m_reportDate + 1, day, month, year);

        m_name = получитьКаталогЭкспорта() + "\\" + getPartName()
                                                  + strLpad(String(day),   2, "0")
                                                  + strLpad(String(month), 2, "0")
                                                  + String(year)
                                                  + "." + m_fileExtension;
    end;

    constructorTF711PartKlikoView(reportDate, partName)
end;

private class (TF711PartKlikoView) TF711PartKlikoView_I3129(reportDate : Date, partName : String)
    initTF711PartKlikoView(reportDate, partName);
end;

private class (TF711PartKlikoView) TF711PartKlikoView_22_PAK(reportDate : Date, partName : String)
    initTF711PartKlikoView(reportDate, partName);
end;

private class (TF711PartKlikoView) TF711PartKlikoView_I4637(reportDate : Date, partName : String)
    initTF711PartKlikoView(reportDate, partName);
end;

private class (TF711PartKlikoView) TF711PartKlikoView_I4927(reportDate : Date, partName : String)
    initTF711PartKlikoView(reportDate, partName);
end;

private class (RcbKlikoExportController) TF711PartKlikoExportController()
    private const TYPE_DATE      = 1;
    private const TYPE_STRING    = 2;
    private const TYPE_NUMBER    = 3;

    /**
     * Поле типа "Дата"
     * @param value - форматируемая дата
     */
    private macro formatDate(value : String) : String
        var day, month, year;

        if (value == date(0,0,0))
            return "";
        end;

        dateSplit(date(value), day, month, year);

        return string(day:2:o) + "." + string(month:2:o) + "." + string(year:4:o);
    end;

    /**
     * Поле типа "С(n.m)"
     * @param value - форматируемая строка или число
     * @param width - ширина поля вывода
     * @param precision - точность
     */
    private macro formatString(value : Variant, width : Integer, precision : Integer) : String
        defaultParm(precision, 0);

        var result;

        if (value == null)
            result = "";
        else
            if (precision == 0)
                if (strlen(value) > width)
                    result = substr(value, 1, width);
                else
                    result = value;
                end;
            else
// 16.01.2015 ABP Если вдруг в RSL отвалится округление при преобразовании строки в число, то нужно использовать нижеследующий код
//                value = TValue(value, value, 1, precision);
//                value.recalculateScaled();
//                result = trim(string(value.scaled : * : *, width, precision));
                result = trim(string(value : * : *, width, precision));
            end;
        end;

        return strsubst(result, "\"", "'");
    end;

    /**
     * Поле типа "Ч(n.m)"
     * @param value - форматируемое число
     * @param width - ширина поля вывода
     * @param precision - точность
     */
    private macro formatNumber(value : Variant, width : Integer, precision : Integer) : String
        var result;

        if ((value != null) and (value != 0))
// 16.01.2015 ABP Если вдруг в RSL отвалится округление при преобразовании строки в число, то нужно использовать нижеследующий код
//            value = TValue(value, value, 1, precision);
//            value.recalculateScaled();
//            result = trim(string(value.scaled : * : *, width, precision));
            result = trim(string(value : * : *, width, precision));
        else
            result = "0";
        end;

        return result;
    end;

    /**
     * Форматирование строки для экспорта
     * @param value - форматируемая значение
     * @param type - тип формата
     * @param parm1 - количество знаков всего/длина строки для экспорта
     * @param parm2 - количество знаков после запятой (если 0 - выводится как целое)
     */
    private macro format(value : Variant, type : Integer, parm1 : Integer, parm2 : Integer) : String
        var result;
        var str = String(value);

        if ((str == "") or (str == null) or (str == date(0,0,0)))
            if (type == TYPE_DATE)
                str = "01.01.0001";
            elif (type == TYPE_STRING)
                str = "000";
            elif (type == TYPE_NUMBER)
                str = "0";
            end;

            return str;
        end;

        if (type == TYPE_DATE)
            result = formatDate(value);
        elif (type == TYPE_STRING)
            result = formatString(value, parm1, parm2);
        elif (type == TYPE_NUMBER)
            result = formatNumber(value, parm1, parm2);
        else
            throw(TIllegalFieldTypeException(type));
        end;

        return ternary((type == TYPE_DATE) and (result == "00.00.0000"), "01.01.0001", result);
    end;

    macro getDepoAccountKind(value)
        if (value == "OWNER")
            return "01";
        elif (value == "DEPOPROG")
            return "02";
        elif (value == "TRUSTEE")
            return "03";
        elif (value == "ISSUER")
            return "04";
        elif (value == "EMISSION")
            return "05";
        elif (value == "DEPOSIT")
            return "06";
        elif (value == "TRANSIT")
            return "07";
        elif (value == "NOMINEE")
            return "08";
        elif (value == "FNOMINEE")
            return "09";
        elif (value == "FAUTHOLDER")
            return "10";
        elif (value == "NONE")
            return "11";
        elif (value == "OTHER")
            return "12";
        else
            return "";
        end;

        return "";
    end;

    macro getValue(value, name)
        if (value != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            value = value.fieldValue(name);
        end;

        if (value != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            value = value.exact;
        else
            msgbox("Не найдено значение поля \"" + name + "\"");
        end;

        return value;
    end;

    private macro printData()
        throw(TPureVirtualMethodCallException("TF711PartKlikoExportController::printData"));
    end;

    private macro printDataZone()
        m_view.printHead(m_view.getPartName());
        printData();
        RcbApplication().transactionManager.rollback();
    end;

    private macro getProtocolDescription()
        return "ПРОТОКОЛ ЭКСПОРТА В kliko раздела " + m_view.getPartName();
    end;

    private macro constructorTF711PartKlikoExportController()
        initRcbKlikoExportController("DAT", RcbReportBase(null, true));
    end;

    constructorTF711PartKlikoExportController();
end;

private class (TF711PartKlikoExportController) TF711PartKlikoExportController_I3129()
    initTF711PartKlikoExportController();

    private macro getDescriptorInfo()
        return "F711_17.PAK от 01.08.2014";
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerLORO_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                                      //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                              //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                                     //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                                 //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                              //"B20S"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           "",
                                           getValue(value, "КорреспИНН")
                                          ), TYPE_STRING, 10),                                                             //"A3"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           getValue(value, "КорреспИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                                 //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                         //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                       //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                        //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                              //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                             //"B27"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                                 //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                         //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                       //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                        //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                          //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                                     //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                            //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                           //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                                          //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                                   //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                          //"A22"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                             //"A23"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                                      //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                              //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                            //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                             //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                                   //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 50)                                       //"A28"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerSECLKLN_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 30),                                                  //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B31S"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A37"
                            format(getDepoAccountKind(getValue(value, "ВидСчётаДепо")), TYPE_STRING, 15),       //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                   //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"A44"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 30),                                                  //"A45"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14)                         //"A49"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerSECLKON_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B44"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 30),                                                  //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B48"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                        //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"B62"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 30),                                                  //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                        //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"B65"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A78"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                    //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                     //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                         //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                 //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                    //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),               //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                  //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                           //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                    //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                        //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6)                         //"A72"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerBAL_ST_V_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 30),                                                  //"A82"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4)          //"A89"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerREKW_KKE_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        m_view.printRow(format(GetLicenseNumber(OurBank), TYPE_STRING, 14),         //"REGNUM"
                        format(ИНН, TYPE_STRING, 12),                               //"INN"
                        format(strSubst({Name_Bank}, "\"", "'"), TYPE_STRING, 250), //"NAMED"
                        format("Руководитель депозитария", TYPE_STRING, 200),       //"DOL_PRD"
                        format({Fio_Boss}, TYPE_STRING, 150),                       //"FIO_PRD"
                        format("", TYPE_STRING, 30),                                //"TEL_PRD"
                        format("", TYPE_STRING, 30),                                //"FAX_PRD"
                        format("", TYPE_STRING, 30),                                //"EMAIL_PRD"
                        format(Исполнитель, TYPE_STRING, 150),                      //"FIO_ISP"
                        format(Номер_телефона, TYPE_STRING, 30),                    //"TEL_ISP"
                        format("", TYPE_STRING, 30),                                //"FAX_ISP"
                        format("", TYPE_STRING, 30),                                //"EMAIL_ISP"
                        format("", TYPE_STRING, 76)                                 //"OTDEL"
                       );

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "REKW_KKE");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerVEK_KO_U_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                        //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                             //"B68"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "",
                                           getValue(value, "issuerInn")
                                          ), TYPE_STRING, 30),                                                              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                             //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                             //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                         //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                                //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                        //"B74"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                       //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                     //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                                 //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                        //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                                     //"B79"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           "",
                                           getValue(value, "dealAgentInn")
                                          ), TYPE_STRING, 30),                                                              //"B80"
                            format(getValue(value, "bookValue"), TYPE_NUMBER, 16, 4),                                       //"B81"
                            format(getValue(value, "interest"), TYPE_NUMBER, 16, 4),                                        //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                                      //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                                  //"B84"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           "",
                                           getValue(value, "storagePlaceInn")
                                          ), TYPE_STRING, 30),                                                              //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                                     //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                              //"B87"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                                      //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                         //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                         //"A94"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           getValue(value, "DealAgentINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                                   //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                                      //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                           //"A108"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           getValue(value, "StoragePlaceINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                                //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                                   //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30)                            //"A115"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerVEK_KO_V_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                         //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                         //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                     //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                            //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                                   //"B93"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                   //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                 //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                               //"B96"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           "",
                                           getValue(value, "firstHolderInn")
                                          ), TYPE_STRING, 30),                                                          //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                        //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                    //"B99"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 30),                                                          //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                          //"B101"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           getValue(value, "FirstHolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                             //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                                //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                         //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                        //"A131"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                                  //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                     //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30)                           //"A135"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportControllerVEK_STL_I3129()
    initTF711PartKlikoExportController_I3129();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                            //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                 //"B104"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "issuerInn")
                                          ), TYPE_STRING, 30),                                                  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                 //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                 //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                             //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                    //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                           //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                           //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                         //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                     //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                            //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                            //"B115"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 30),                                                  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                  //"B117"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 3),                          //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                             //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                              //"A141"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 3),                          //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                             //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3)                    //"A155"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportController_I3129) TF711PartKlikoExportController_19_PAK()
    initTF711PartKlikoExportController_I3129();

    private macro getDescriptorInfo()
        return "F711_19.PAK от 02.10.2014";
    end;
end;

private class (TF711PartKlikoExportController_19_PAK) TF711PartKlikoExportControllerLORO_19_PAK()
    initTF711PartKlikoExportController_19_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                                      //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                              //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                                     //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                                 //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                              //"B20S"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           "",
                                           getValue(value, "КорреспИНН")
                                          ), TYPE_STRING, 10),                                                             //"A3"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           getValue(value, "КорреспИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                                 //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                         //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                       //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                        //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                              //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                             //"B27"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                                 //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                         //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                       //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                        //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                          //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                                     //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                            //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                           //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                                          //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                                   //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                          //"A22"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                             //"A23"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                                      //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                              //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                            //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                             //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                                   //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 50)                                       //"A28"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_19_PAK) TF711PartKlikoExportControllerSECLKLN_19_PAK()
    initTF711PartKlikoExportController_19_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 30),                                                  //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B31S"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),       //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                   //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"A44"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 30),                                                  //"A45"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14)                         //"A49"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_19_PAK) TF711PartKlikoExportControllerSECLKON_19_PAK()
    initTF711PartKlikoExportController_19_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B44"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 30),                                                  //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B48"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                        //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"B62"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 30),                                                  //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                        //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"B65"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A78"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                    //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                     //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                         //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                 //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                    //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),               //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                  //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                           //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                    //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                        //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6)                         //"A72"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I3129(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController) TF711PartKlikoExportController_22_PAK()
    initTF711PartKlikoExportController();

    private macro getDescriptorInfo()
        return "F711_22.PAK от 04.02.2015";
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportController_27_PAK()
    initTF711PartKlikoExportController();

    macro getValue(value, name)
        if (value != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            value = value.fieldValue(name);
        end;

        if (value != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            if (valtype(value.exact) == V_STRING)
                value = strsubst(value.exact, "\"", "~^");
            else
                value = value.exact;
            end;
        else
            msgbox("Не найдено значение поля \"" + name + "\"");
        end;

        return value;
    end;

    private macro getFaceValue(it, faceValName, codeName)
        var value = getValue(it, faceValName);
        var code711 = getValue(it, codeName);

        if (in(code711, "OPN", "SHS7", "SHS71", "SHS8", "DR"))
            value = "";
        else
            if (    (value < 0.0000001)
                and (faceValName == "ЦБНоминал"))
                value = "0.0000001";
            end;
        end;

        return value;
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportController_32_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro getDescriptorInfo()
        return "F711_32.PAK от 08.02.2017";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportController_I4637()
    initTF711PartKlikoExportController_32_PAK();

    macro getValue(value, name)
        var result;

        if (value != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            result = value.fieldValue(name);
        end;

        if (result != null)
            // 09.08.2014 ABP Здесь хорошо бы сделать вывод ошибок поиска значений в протокол,
            //                чтоб отслеживать атрибуты, не выводящиеся в печатную фому.
            result = result.exact;
        else
            msgbox("Не найдено значение поля \"" + name + "\"");
        end;

        return result;
    end;

    private macro getFaceValue(it, faceValName, codeName) : Money
        var value = getValue(it, faceValName);

        if (value == 0.0)
            return null;
        end;

        var code711 = getValue(it, codeName);

        if (in(code711, "OPN", "SHS7", "SHS71", "SHS8", "DR"))
            value = null;
        else
            if (value < 0.000001)
                value = 0.000001;
            end;
        end;

        return value;
    end;

    /**
     * Поле типа "Дата"
     * @param value - форматируемая дата
     */
    private macro formatDate(value : String) : String
        var day, month, year;

        if ((value == null) or (value == "") or (date(value) == date(0,0,0)))
            return "";
        end;

        dateSplit(date(value), day, month, year);

        return string(day:2:o) + "." + string(month:2:o) + "." + string(year:4:o);
    end;

    /**
     * Поле типа "С(n.m)"
     * @param value - форматируемая строка или число
     * @param width - ширина поля вывода
     * @param precision - точность
     */
    private macro formatString(value : Variant, width : Integer, precision : Integer) : String
        defaultParm(precision, 0);

        var result;

        if (value == null)
            result = "";
        else
            if (precision == 0)
                if (strlen(value) > width)
                    result = substr(value, 1, width);
                else
                    result = value;
                end;
            else
// 16.01.2015 ABP Если вдруг в RSL отвалится округление при преобразовании строки в число, то нужно использовать нижеследующий код
//                value = TValue(value, value, 1, precision);
//                value.recalculateScaled();
//                result = trim(string(value.scaled : * : *, width, precision));
                result = trim(string(value : * : *, width, precision));
            end;
        end;

        return strsubst(result, "\"", "~^");
    end;

    /**
     * Форматирование строки для экспорта
     * @param value - форматируемая значение
     * @param type - тип формата
     * @param parm1 - количество знаков всего/длина строки для экспорта
     * @param parm2 - количество знаков после запятой (если 0 - выводится как целое)
     */
    private macro format(value : Variant, type : Integer, parm1 : Integer, parm2 : Integer) : String
        var result;

        if (type == TYPE_DATE)
            result = formatDate(value);
        elif (type == TYPE_STRING)
            result = formatString(value, parm1, parm2);
        elif (type == TYPE_NUMBER)
            result = formatNumber(value, parm1, parm2);
        else
            throw(TIllegalFieldTypeException(type));
        end;

        return result;
    end;

    private macro getInnValue(value, innField, tinField, nameField)
        if ((nameField != null) and (getValue(value, nameField) == ""))
            return "";
        end;

        var innValue = getValue(value, innField);
        return ternary((innValue == getValue(value, tinField)) OR (innValue == "000"), "", innValue);
    end;

    private macro getTinValue(value, innField, tinField, nameField)
        if ((nameField != null) and (getValue(value, nameField) == ""))
            return "";
        end;

        var tinValue = getValue(value, tinField);
        return ternary(getValue(value, innField) == tinValue, tinValue, "");
    end;

    private macro getDescriptorInfo()
        return "F711_39.PAK от 18.06.2018";
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportController_I4927()
    initTF711PartKlikoExportController_I4637();

    private macro getDescriptorInfo()
        return "F711_45.PAK от 22.01.2019";
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportController_55_PAK()
    initTF711PartKlikoExportController_I4927();

    /**
     * Поле типа "Ч(n.m)"
     * @param value     - форматируемое число
     * @param width     - ширина поля вывода целой части
     * @param precision - точность (число цифр после запятой)
     */
    private macro formatNumber(value : Variant, integerPartWidth : Integer, precision : Integer) : String
        defaultParm(precision, 0);

        var result;
        var width = integerPartWidth + ternary(precision != 0, precision + 1, 0);

        if ((value != null) and (value != 0))
// 16.01.2015 ABP Если вдруг в RSL отвалится округление при преобразовании строки в число, то нужно использовать нижеследующий код
//            value = TValue(value, value, 1, precision);
//            value.recalculateScaled();
//            result = trim(string(value.scaled : * : *, width, precision));
            result = trim(string(value : * : *, width, precision));
        else
            result = "0";
        end;

        return result;
    end;

    /**
     * Поле типа "С(n.m)"
     * @param value     - форматируемая строка или число
     * @param width     - ширина поля вывода целой части
     * @param precision - точность (число цифр после запятой)
     */
    private macro formatString(value : Variant, integerPartWidth : Integer, precision : Integer) : String
        defaultParm(precision, 0);

        var result;
        var width = integerPartWidth + ternary(precision != 0, precision + 1, 0);

        if (value == null)
            result = "";
        else
            if (precision == 0)
                if (strlen(value) > width)
                    result = substr(value, 1, width);
                else
                    result = value;
                end;
            else
// 16.01.2015 ABP Если вдруг в RSL отвалится округление при преобразовании строки в число, то нужно использовать нижеследующий код
//                value = TValue(value, value, 1, precision);
//                value.recalculateScaled();
//                result = trim(string(value.scaled : * : *, width, precision));
                result = trim(string(value : * : *, width, precision));
            end;
        end;

        return strsubst(result, "\"", "~^");
    end;

    private macro getDescriptorInfo()
        return "F711_55.PAK от 12.05.2021";
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerLORO_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                                      //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                              //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                                     //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                                 //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                              //"B20S"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           "",
                                           getValue(value, "КорреспИНН")
                                          ), TYPE_STRING, 10),                                                             //"A3"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           getValue(value, "КорреспИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                                 //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                         //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                       //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                        //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                              //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                             //"B27"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                                 //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                         //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                       //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                        //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                          //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                                     //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                            //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                           //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                                          //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                                   //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                          //"A22"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                             //"A23"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                                      //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                              //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                            //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                             //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                                   //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40)                                       //"A28"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportControllerLORO_22_PAK) TF711PartKlikoExportControllerLORO_23_PAK()
    initTF711PartKlikoExportControllerLORO_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerLORO_23_PAK) TF711PartKlikoExportControllerLORO_24_PAK()
    initTF711PartKlikoExportControllerLORO_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerLORO_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                                      //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                              //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                                     //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                                 //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                              //"B20S"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           "",
                                           getValue(value, "КорреспИНН")
                                          ), TYPE_STRING, 10),                                                             //"A3"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           getValue(value, "КорреспИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                                 //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                         //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                       //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                        //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                              //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                             //"B27"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                                 //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                         //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                       //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                        //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                          //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                                     //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                            //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                           //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),                     //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                                   //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                          //"A22"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                             //"A23"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                                      //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                              //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                            //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                             //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                                   //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40)                                       //"A28"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "LORO");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerLORO_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                                      //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                              //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                                     //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                                 //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                              //"B20S"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           "",
                                           getValue(value, "КорреспИНН")
                                          ), TYPE_STRING, 10),                                                             //"A3"
                            format(ternary(getValue(value, "КорреспИНН") == getValue(value, "КорреспИНН_TIN"),
                                           getValue(value, "КорреспИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                                 //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                         //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                       //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                        //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                              //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                             //"B27"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                                 //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                         //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                       //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                        //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                          //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                                     //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                            //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                           //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),                     //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                                   //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                          //"A22"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                             //"A23"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                             //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                                      //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                              //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                            //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                             //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                                   //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40),                                      //"A28"

                            format(getValue(value, "ВсегоОбрем"),   TYPE_STRING, 30, 6),                                   //"B20S1"
                            format(getValue(value, "Залог"),        TYPE_STRING, 30, 6),                                   //"B20S2"
                            format(getValue(value, "ТогрСчета"),    TYPE_STRING, 30, 6),                                   //"B20S3"
                            format(getValue(value, "ОгранКД"),      TYPE_STRING, 30, 6),                                   //"B20S4"
                            format(getValue(value, "ЗапретОпер"),   TYPE_STRING, 30, 6),                                   //"B20S5"
                            format(getValue(value, "Арест"),        TYPE_STRING, 30, 6)                                    //"B20S6"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerLORO_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                               //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                       //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                              //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                          //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                       //"B20S"
                            format(getInnValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 10),            //"A3"
                            format(getTinValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 30),            //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                          //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                  //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                 //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                              //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A22"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A23"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40),                               //"A28"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"B20S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"B20S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"B20S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"B20S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"B20S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6)                                    //"B20S6"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerLORO_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                               //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                       //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                              //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                          //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                       //"B20S"
                            format(getInnValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 10),            //"A3"
                            format(getTinValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 30),            //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                          //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                  //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                 //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                              //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A22"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A23"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40),                               //"A28"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"B20S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"B20S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"B20S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"B20S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"B20S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"B20S6"
                            format(getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3),                      //"A3C"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B27C"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3)                            //"A23C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerLORO_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "КорреспНаим"), TYPE_STRING, 250),                               //"B16"
                            format(getValue(value, "КорреспНомерЛицензии"), TYPE_STRING, 14),                       //"B17"
                            format(getValue(value, "КорреспПризнак"), TYPE_STRING, 1),                              //"B18"
                            format(getValue(value, "КорреспНомерСчета"), TYPE_STRING, 50),                          //"B19"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 29, 6),                       //"B20S"
                            format(getInnValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 10),            //"A3"
                            format(getTinValue(value, "КорреспИНН", "КорреспИНН_TIN"), TYPE_STRING, 30),            //"A3A"
                            format(getValue(value, "КорреспИНН_Признак"), TYPE_STRING, 1),                          //"A3B"
                            format(getValue(value, "КорреспКПП"), TYPE_STRING, 9),                                  //"A4"
                            format(getValue(value, "КорреспОГРН"), TYPE_STRING, 15),                                //"A5"
                            format(getValue(value, "КорреспОКСМ"), TYPE_STRING, 3),                                 //"A6"
                            format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A12"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A13"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A14"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 64),                              //"B29"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A17"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 29, 8),              //"B31S"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A21"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A22"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A23"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A23A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A23B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A24"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A25"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A26"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 18),                            //"A27"
                            format(getValue(value, "МХНомерСчёта"), TYPE_STRING, 40),                               //"A28"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 29, 6),                              //"B20S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 29, 6),                                   //"B20S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 29, 6),                               //"B20S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 29, 6),                                 //"B20S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 29, 6),                              //"B20S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 29, 6),                                   //"B20S6"
                            format(getValue(value, "КорреспИНН_ПризнакКода"), TYPE_STRING, 3),                      //"A3C"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B27C"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3)                            //"A23C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "LORO");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerSECLKLN_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B30"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B31S"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),       //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                   //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"A44"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                  //"A45"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14)                         //"A49"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportControllerSECLKLN_22_PAK) TF711PartKlikoExportControllerSECLKLN_23_PAK()
    initTF711PartKlikoExportControllerSECLKLN_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerSECLKLN_23_PAK) TF711PartKlikoExportControllerSECLKLN_24_PAK()
    initTF711PartKlikoExportControllerSECLKLN_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerSECLKLN_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"B31S"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),       //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                   //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"A44"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                  //"A45"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14)                         //"A49"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "SECLKLN");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerSECLKLN_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B26"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"B31S"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"),       TYPE_STRING, 1),                //"B27B"
                            format(getValue(value, "ЭмитентКПП"),               TYPE_STRING, 9),                //"A32"
                            format(getValue(value, "ЭмитентОГРН"),              TYPE_STRING, 15),               //"A33"
                            format(getValue(value, "ЭмитентОКСМ"),              TYPE_STRING, 3),                //"A34"
                            format(getValue(value, "ЦБISIN"),                   TYPE_STRING, 12),               //"A37"
                            format(getValue(value, "ВидСчётаДепо"),             TYPE_STRING, 15),               //"A40"
                            format(getValue(value, "КоличествоПоСчету"),        TYPE_STRING, 30, 6),            //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"A44"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                  //"A45"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                        //"A49"

                            format(getValue(value, "ВсегоОбрем"),               TYPE_STRING, 30, 6),            //"A41S1"
                            format(getValue(value, "Залог"),                    TYPE_STRING, 30, 6),            //"A41S2"
                            format(getValue(value, "ТогрСчета"),                TYPE_STRING, 30, 6),            //"A41S3"
                            format(getValue(value, "ОгранКД"),                  TYPE_STRING, 30, 6),            //"A41S4"
                            format(getValue(value, "ЗапретОпер"),               TYPE_STRING, 30, 6),            //"A41S5"
                            format(getValue(value, "Арест"),                    TYPE_STRING, 30, 6),            //"A41S6"
                            format(getValue(value, "СВ_ОКМС"),                  TYPE_STRING, 3)                 //"A34"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerSECLKLN_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

//            var depoAccOwnerCode = getValue(value, "Владелец_СекторЭкономики");
//            if (not in(getValue(value, "ВидСчётаДепо"), "OWNER", "DEPOPROG", "TRUSTEE", "NOMINEE", "FNOMINEE", "FAUTHOLDER"))
//                depoAccOwnerCode = "000";
//            end;
            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                              //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B31S"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),                               //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                       //"A41S"
//                            format(depoAccOwnerCode, TYPE_STRING, 6),                                               //"A42"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                    //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A44"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A45"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"A49"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"A41S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"A41S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"A41S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"A41S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"A41S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"A41S6"
                            format(getValue(value, "СВ_ОКМС"), TYPE_STRING, 3)                                      //"A34"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerSECLKLN_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                              //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B31S"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),                               //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                       //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                    //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A44"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A45"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"A49"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"A41S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"A41S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"A41S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"A41S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"A41S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"A41S6"
                            format(getValue(value, "СВ_ОКМС"), TYPE_STRING, 3),                                     //"A34"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B27C"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3)                            //"A45C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerSECLKLN_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                              //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B31S"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),                               //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 30, 6),                       //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                    //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A44"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A45"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"A49"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"A41S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"A41S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"A41S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"A41S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"A41S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"A41S6"
                            format(getValue(value, "СВ_ОКМС"), TYPE_STRING, 3),                                     //"A34"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B27C"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3),                           //"A45C"
                            format(getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE),                           //"C29"
                            format(getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254)                      //"CR30"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerSECLKLN_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B26"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B27"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B28"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 64),                              //"B29"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B30"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 29, 8),              //"B31S"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B27A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B27B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A32"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A33"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A34"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A37"
                            format(getValue(value, "ВидСчётаДепо"), TYPE_STRING, 15),                               //"A40"
                            format(getValue(value, "КоличествоПоСчету"), TYPE_STRING, 29, 6),                       //"A41S"
                            format(getValue(value, "Владелец_СекторЭкономики"), TYPE_STRING, 6),                    //"A42"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"A43"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"A44"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"A45"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"A45A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"A45B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A46"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A47"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A48"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 18),                            //"A49"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 29, 6),                              //"A41S1"
                            format(getValue(value, "Залог"), TYPE_STRING, 29, 6),                                   //"A41S2"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 29, 6),                               //"A41S3"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 29, 6),                                 //"A41S4"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 29, 6),                              //"A41S5"
                            format(getValue(value, "Арест"), TYPE_STRING, 29, 6),                                   //"A41S6"
                            format(getValue(value, "СВ_ОКМС"), TYPE_STRING, 3),                                     //"A34"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B27C"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3),                           //"A45C"
                            format(getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE),                           //"C29"
                            format(getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254)                      //"C30"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKLN");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerR1_2_1()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it   = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value   = it.currentItem;
            m_view.printRow(format(getValue(value, "ЭмитентНаименование"              ), TYPE_STRING, 254),   //G1   атрибут Ф711_Эмитент - Наименование эмитента (тип C254)

                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),    //G2   атрибут Ф711_ЭмитентИНН_1_2_1 - ИНН эмитента (тип C12). Если субъект из атрибута Ф711_Эмитент_1_2_1 является нерезидентом, то выгружать пустые кавычки ""
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),    //G3   атрибут Ф711_ЭмитентИНН_TIN - (TIN - код субъекта экономики 62 - <Иностранный ИНН>), или LEI, или регистрационный номер в стране регистрации (эмитент) (тип С30)
                            format(getValue(value, "ЭмитентИНН_Признак"             ), TYPE_STRING, 1),     //G3A  атрибут Ф711_ЭмитентИНН_признак эмитента - признак эмитента (тип С1)
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"         ), TYPE_STRING, 3),     //G3B  атрибут Ф711_ПризнакКодаЭмНерез - Признак кода эмитента нерезидента (тип С3)
                            format(getValue(value, "ЭмитентКПП"                       ), TYPE_STRING, 9),     //G4   атрибут Ф711_ЭмитентКПП_1_2_1 - КПП эмитента (тип C9)
                            format(getValue(value, "ЭмитентОГРН"                      ), TYPE_STRING, 15),    //G5   атрибут Ф711_ЭмитентОГРН_1_2_1 - ОГРН эмитента (тип C15)
                            format(getValue(value, "ЭмитентОКСМ"                      ), TYPE_STRING, 3),     //G6   атрибут Ф711_ЭмитентОКСМ_1_2_1 - Код ОКСМ страны эмитента (тип C3)
                            format(getValue(value, "ЦБКодТипа"                        ), TYPE_STRING, 5),     //G7   атрибут Ф711_ЦБКодТипа_1_2_1 - Код типа ценной бумаги (тип C5)
                            format(getValue(value, "ЦБНомерГосРег"                    ), TYPE_STRING, 21),    //G8   атрибут Ф711_ЦБНомерГосРег_1_2_1  - Номер государственной регистрации ценной бумаги (тип C21)
                            format(getValue(value, "ЦБISIN"                           ), TYPE_STRING, 12),    //G9   атрибут Ф711_ЦБISIN_1_2_1 - Код ISIN ценной бумаги (тип C12)
                            format(getValue(value, "ЦБВалюта"                          ), TYPE_STRING, 3),     //G10  атрибут Ф711_ЦБВалюта_1_2_1 - Код валюты ценной бумаги (тип C3)
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"       ), TYPE_STRING, 29, 8), //G11  атрибут Ф711_ЦБНоминал_1_2_1 - Номинальная  стоимость ценной бумаги, ед. валюты обязатель-ства (тип C(29.8))
                            format(getValue(value, "ПриемЦБ"                          ), TYPE_STRING, 29, 6), //G12  атрибут Ф711_ПриемЦБ_1_2_1 - Прием ценных бумаг на хранение и учет (тип C(29.6))
                            format(getValue(value, "СнятиеЦБ"                         ), TYPE_STRING, 29, 6), //G13  атрибут Ф711_СнятиеЦБ_1_2_1  - Снятие ценных бумаг с хранения и учета (тип C(29.6))
                            format(getValue(value, "ПереводЦБ"                        ), TYPE_NUMBER, 16, 4)  //G14  атрибут Ф711_ПереводЦБ_1_2_1  - Снятие ценных бумаг с хранения и учета (тип Ч(16.4))
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "R1_2_1");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerR1_2_1_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it   = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_2_1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value   = it.currentItem;
            m_view.printRow(format(getValue(value, "ЭмитентНаименование"            ), TYPE_STRING, 254),   //G1   атрибут Ф711_Эмитент - Наименование эмитента (тип C254)
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),    //G2   атрибут Ф711_ЭмитентИНН_1_2_1 - ИНН эмитента (тип C12). Если субъект из атрибута Ф711_Эмитент_1_2_1 является нерезидентом, то выгружать пустые кавычки ""
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),    //G3   атрибут Ф711_ЭмитентИНН_TIN - (TIN - код субъекта экономики 62 - <Иностранный ИНН>), или LEI, или регистрационный номер в стране регистрации (эмитент) (тип С30)
                            format(getValue(value, "ЭмитентИНН_Признак"             ), TYPE_STRING, 1),     //G3A  атрибут Ф711_ЭмитентИНН_признак эмитента - признак эмитента (тип С1)
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"         ), TYPE_STRING, 3),     //G3B  атрибут Ф711_ПризнакКодаЭмНерез - Признак кода эмитента нерезидента (тип С3)
                            format(getValue(value, "ЭмитентКПП"                     ), TYPE_STRING, 9),     //G4   атрибут Ф711_ЭмитентКПП_1_2_1 - КПП эмитента (тип C9)
                            format(getValue(value, "ЭмитентОГРН"                    ), TYPE_STRING, 15),    //G5   атрибут Ф711_ЭмитентОГРН_1_2_1 - ОГРН эмитента (тип C15)
                            format(getValue(value, "ЭмитентОКСМ"                    ), TYPE_STRING, 3),     //G6   атрибут Ф711_ЭмитентОКСМ_1_2_1 - Код ОКСМ страны эмитента (тип C3)
                            format(getValue(value, "ЦБКодТипа"                      ), TYPE_STRING, 5),     //G7   атрибут Ф711_ЦБКодТипа_1_2_1 - Код типа ценной бумаги (тип C5)
                            format(getValue(value, "ЦБНомерГосРег"                  ), TYPE_STRING, 64),    //G8   атрибут Ф711_ЦБНомерГосРег_1_2_1  - Номер государственной регистрации ценной бумаги (тип C21)
                            format(getValue(value, "ЦБISIN"                         ), TYPE_STRING, 12),    //G9   атрибут Ф711_ЦБISIN_1_2_1 - Код ISIN ценной бумаги (тип C12)
                            format(getValue(value, "ЦБВалюта"                       ), TYPE_STRING, 3),     //G10  атрибут Ф711_ЦБВалюта_1_2_1 - Код валюты ценной бумаги (тип C3)
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"     ), TYPE_STRING, 29, 8), //G11  атрибут Ф711_ЦБНоминал_1_2_1 - Номинальная  стоимость ценной бумаги, ед. валюты обязатель-ства (тип C(29.8))
                            format(getValue(value, "ПриемЦБ"                        ), TYPE_STRING, 29, 6), //G12  атрибут Ф711_ПриемЦБ_1_2_1 - Прием ценных бумаг на хранение и учет (тип C(29.6))
                            format(getValue(value, "СнятиеЦБ"                       ), TYPE_STRING, 29, 6), //G13  атрибут Ф711_СнятиеЦБ_1_2_1  - Снятие ценных бумаг с хранения и учета (тип C(29.6))
                            format(getValue(value, "ПереводЦБ"                      ), TYPE_STRING, 29, 6)  //G14  атрибут Ф711_ПереводЦБ_1_2_1  - Снятие ценных бумаг с хранения и учета (тип Ч(16.4))
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "R1_2_1");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerSECLKON_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B44"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B48"
                            format(ternary(getValue(value, "ЦБНоминал") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "ЦБНоминал")
                                          ), TYPE_STRING, 30, 6),                                               //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                        //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"B62"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                  //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                        //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"B65"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A78"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                    //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                     //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                         //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                 //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                    //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),               //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                  //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                           //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                    //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                        //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6)                         //"A72"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportControllerSECLKON_22_PAK) TF711PartKlikoExportControllerSECLKON_23_PAK()
    initTF711PartKlikoExportControllerSECLKON_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerSECLKON_23_PAK) TF711PartKlikoExportControllerSECLKON_24_PAK()
    initTF711PartKlikoExportControllerSECLKON_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerSECLKON_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"B44"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"B48"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                        //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                        //"B62"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           "",
                                           getValue(value, "МХИНН")
                                          ), TYPE_STRING, 10),                                                  //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                        //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                               //"B65"
                            format(ternary(getValue(value, "МХИНН") == getValue(value, "МХИНН_TIN"),
                                           getValue(value, "МХИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                           //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                   //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                 //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                  //"A78"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                 //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                    //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                     //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                         //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                 //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                    //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),               //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                  //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                           //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                    //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                        //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6)                         //"A72"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "SECLKON");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportControllerSECLKON_27_PAK) TF711PartKlikoExportControllerSECLKON_32_PAK()
    initTF711PartKlikoExportControllerSECLKON_27_PAK();

    private macro getDescriptorInfo()
        return "F711_32.PAK от 08.02.2017";
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerSECLKON_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B44"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                              //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B48"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                            //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"B62"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"B65"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A78"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                        //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                         //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                             //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                     //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                        //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),                   //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                      //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                               //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                        //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                            //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6),                            //"A72"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"GR86"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"GR87"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"GR88"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"GR89"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"GR90"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6)                                    //"GR91"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerSECLKON_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B44"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                              //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B48"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                            //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"B62"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"B65"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A78"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                        //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                         //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                             //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                     //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                        //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),                   //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                      //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                               //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                        //"A70"
                            format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                            //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6),                            //"A72"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"GR86"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"GR87"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"GR88"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"GR89"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"GR90"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"GR91"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B45С"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3)                            //"B63С"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerSECLKON_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B44"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                              //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B48"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),              //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 30, 6),                            //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"B62"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 14),                            //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"B65"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A78"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 30, 6),                        //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 30, 6),                         //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 30, 6),                             //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 30, 6),                     //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 30, 6),                        //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 30, 6),                   //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 30, 6),                      //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 30, 6),                               //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 30, 6),                        //"A70"
                            //format(getValue(value, "СвоиЦБ_Залог"), TYPE_STRING, 30, 6),                            //"A71"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 30, 6),                            //"A72"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 30, 6),                              //"GR86"
                            format(getValue(value, "Залог"), TYPE_STRING, 30, 6),                                   //"GR87"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                               //"GR88"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                                 //"GR89"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                              //"GR90"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                                   //"GR91"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3),                           //"B63С"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B45С"
                            format(getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE),                           //"C36"
                            format(getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254)                      //"C37"

                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerSECLKON_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                       //"B44"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),            //"B45"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                                   //"B46"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 64),                              //"B47"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                    //"B48"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 29, 8),              //"B49S"
                            format(getValue(value, "СвоиЦБ_Всего"), TYPE_STRING, 29, 6),                            //"A61"
                            format(getValue(value, "МХНаименование"), TYPE_STRING, 250),                            //"B62"
                            format(getInnValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 10),    //"B63"
                            format(getValue(value, "МХНомерЛицензии"), TYPE_STRING, 18),                            //"B64"
                            format(getValue(value, "МХПризнак"), TYPE_STRING, 1),                                   //"B65"
                            format(getTinValue(value, "МХИНН", "МХИНН_TIN", "МХНаименование"), TYPE_STRING, 30),    //"B63A"
                            format(getValue(value, "МХИНН_Признак"), TYPE_STRING, 1),                               //"B63B"
                            format(getValue(value, "МХКПП"), TYPE_STRING, 9),                                       //"A76"
                            format(getValue(value, "МХОГРН"), TYPE_STRING, 15),                                     //"A77"
                            format(getValue(value, "МХОКСМ"), TYPE_STRING, 3),                                      //"A78"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),            //"B45A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                          //"B45B"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                                  //"A53"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                                //"A54"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                                 //"A55"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 12),                                     //"A58"
                            format(getValue(value, "СвоиЦБ_ОснБаланс"), TYPE_STRING, 29, 6),                        //"A62"
                            format(getValue(value, "СвоиЦБ_РЕПО_БПП"), TYPE_STRING, 29, 6),                         //"A63"
                            format(getValue(value, "СвоиЦБ_Займ"), TYPE_STRING, 29, 6),                             //"A64"
                            format(getValue(value, "СвоиЦБ_ОбязОтсутств"), TYPE_STRING, 29, 6),                     //"A65"
                            format(getValue(value, "СвоиЦБ_Безнадежн"), TYPE_STRING, 29, 6),                        //"A66"
                            format(getValue(value, "СвоиЦБ_ЗачислОшибочно"), TYPE_STRING, 29, 6),                   //"A67"
                            format(getValue(value, "СвоиЦБ_ИныеПричины"), TYPE_STRING, 29, 6),                      //"A68"
                            format(getValue(value, "СвоиЦБ_ДУ"), TYPE_STRING, 29, 6),                               //"A69"
                            format(getValue(value, "СвоиЦБ_КазнСчета"), TYPE_STRING, 29, 6),                        //"A70"
                            format(getValue(value, "СвоиЦБ_Эмисс"), TYPE_STRING, 29, 6),                            //"A72"
                            format(getValue(value, "ВсегоОбрем"), TYPE_STRING, 29, 6),                              //"GR86"
                            format(getValue(value, "Залог"), TYPE_STRING, 29, 6),                                   //"GR87"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 29, 6),                               //"GR88"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 29, 6),                                 //"GR89"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 29, 6),                              //"GR90"
                            format(getValue(value, "Арест"), TYPE_STRING, 29, 6),                                   //"GR91"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 3),                      //"B45С"
                            format(getValue(value, "МХИНН_ПризнакКода"), TYPE_STRING, 3),                           //"B63С"
                            format(getValue(value, "НРезДатаВыдачиЛицензии"), TYPE_DATE),                           //"C36"
                            format(getValue(value, "НРезКемВыданаЛицензия"), TYPE_STRING, 254)                      //"C37"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "SECLKON");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerBAL_ST_V_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"A82"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4)          //"A89"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportControllerBAL_ST_V_22_PAK) TF711PartKlikoExportControllerBAL_ST_V_23_PAK()
    initTF711PartKlikoExportControllerBAL_ST_V_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerBAL_ST_V_23_PAK) TF711PartKlikoExportControllerBAL_ST_V_24_PAK()
    initTF711PartKlikoExportControllerBAL_ST_V_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerBAL_ST_V_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"A82"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4)          //"A89"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "BAL_ST_V");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerBAL_ST_V_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           "",
                                           getValue(value, "ЭмитентИНН")
                                          ), TYPE_STRING, 12),                                                  //"A82"
                            format(ternary(getValue(value, "ЭмитентИНН") == getValue(value, "ЭмитентИНН_TIN"),
                                           getValue(value, "ЭмитентИНН_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4),         //"A89"

                            format(getValue(value, "БалансСчет"), TYPE_STRING, 5)                               //"A103"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerBAL_ST_V_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),        //"A82"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),        //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 20),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            "",                                                                                 //пустой атрибут
                            format(getValue(value, "БалансСчет"), TYPE_STRING, 5),                              //"A103"
                            format(getValue(value, "ЭмитентОКВЭД"), TYPE_STRING, 8),                            //"GR105"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"GR109"
                            format(getValue(value, "КоличествоЦБ"), TYPE_STRING, 30, 6),                        //"GR110"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"GR111"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4),         //"GR112"
                            format(getValue(value, "НКД"), TYPE_NUMBER, 16, 4),                                 //"GR114"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОтрицПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОтрицПереоценка")) / 1000, TYPE_NUMBER, 16, 4),       //"GR115"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ПоложПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ПоложПереоценка")) / 1000, TYPE_NUMBER, 16, 4),       //"GR116"
                            format(getValue(value, "УровеньИДвиерархииСС"), TYPE_STRING, 3),                    //"GR117"
                            format(getValue(value, "КатКачества"), TYPE_STRING, 1),                             //"GR118"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Резерв")) / 1000, TYPE_NUMBER, 16, 4)                //"GR119"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerBAL_ST_V_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),        //"A82"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),        //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            "",                                                                                 //пустой атрибут
                            format(getValue(value, "БалансСчет"), TYPE_STRING, 5),                              //"A103"
                            format(getValue(value, "ЭмитентОКВЭД"), TYPE_STRING, 8),                            //"GR105"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"GR109"
                            format(getValue(value, "КоличествоЦБ"), TYPE_STRING, 30, 6),                        //"GR110"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"GR111"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4),         //"GR112"
                            format(getValue(value, "НКД"), TYPE_NUMBER, 16, 4),                                 //"GR114"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОтрицПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОтрицПоложПереоценка")) / 1000, TYPE_NUMBER, 16, 4),  //"GR115"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ПоложПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_СС_ПП")) / 1000, TYPE_NUMBER, 16, 4),            //"GR116"
                            format(getValue(value, "УровеньИДвиерархииСС"), TYPE_STRING, 3),                    //"GR117"
                            format(getValue(value, "КатКачества"), TYPE_STRING, 1),                             //"GR118"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Резерв")) / 1000, TYPE_NUMBER, 16, 4),                //"GR119"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 4),                  //"A82B"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_резерва_ВП")) / 1000, TYPE_NUMBER, 16, 4)        //"GR120"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerBAL_ST_V_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),        //"A82"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),        //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 21),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            format(getValue(value, "БалансСчет"), TYPE_STRING, 5),                              //"A103"
                            format(getValue(value, "ЭмитентОКВЭД"), TYPE_STRING, 8),                            //"GR105"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"GR109"
                            format(getValue(value, "КоличествоЦБ"), TYPE_STRING, 30, 6),                        //"GR110"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 30, 6),          //"GR111"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4),         //"GR112"
                            format(getValue(value, "НКД"), TYPE_NUMBER, 16, 4),                                 //"GR114"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОтрицПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОтрицПоложПереоценка")) / 1000, TYPE_NUMBER, 16, 4),  //"GR115"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ПоложПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_СС_ПП")) / 1000, TYPE_NUMBER, 16, 4),            //"GR116"
                            format(getValue(value, "УровеньИДвиерархииСС"), TYPE_STRING, 3),                    //"GR117"
                            format(getValue(value, "КатКачества"), TYPE_STRING, 1),                             //"GR118"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Резерв")) / 1000, TYPE_NUMBER, 16, 4),                //"GR119"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 4),                  //"A82B"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_резерва_ВП")) / 1000, TYPE_NUMBER, 16, 4),       //"GR120"
                            format(strSubst(getValue(value, "РезервПроцент"),"%",""), TYPE_NUMBER, 4, 2)        //C21
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerBAL_ST_V_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел1_Подраздел_1_4").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "ЭмитентНаименование"), TYPE_STRING, 250),                   //"A81"
                            format(getInnValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 12),        //"A82"
                            format(getTinValue(value, "ЭмитентИНН", "ЭмитентИНН_TIN"), TYPE_STRING, 30),        //"A82A"
                            format(getValue(value, "ЭмитентИНН_Признак"), TYPE_STRING, 1),                      //"A82B"
                            format(getValue(value, "ЭмитентОГРН"), TYPE_STRING, 15),                            //"A83"
                            format(getValue(value, "ЭмитентКПП"), TYPE_STRING, 9),                              //"A84"
                            format(getValue(value, "ЭмитентОКСМ"), TYPE_STRING, 3),                             //"A85"
                            format(getValue(value, "ЦБКодТипа"), TYPE_STRING, 5),                               //"A86"
                            format(getValue(value, "ЦБНомерГосРег"), TYPE_STRING, 64),                          //"A87"
                            format(getValue(value, "ЦБISIN"), TYPE_STRING, 20),                                 //"A88"
                            format(getValue(value, "БалансСчет"), TYPE_STRING, 5),                              //"A103"
                            format(getValue(value, "ЭмитентОКВЭД"), TYPE_STRING, 2),                            //"GR105"
                            format(getValue(value, "ЦБВалюта"), TYPE_STRING, 3),                                //"GR109"
                            format(getValue(value, "КоличествоЦБ"), TYPE_STRING, 29, 6),                        //"GR110"
                            format(getFaceValue(value, "ЦБНоминал", "ЦБКодТипа"), TYPE_STRING, 29, 8),          //"GR111"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОбъемВложений" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОбъемВложений")) / 1000, TYPE_NUMBER, 16, 4),         //"GR112"
                            format(getValue(value, "НКД"), TYPE_NUMBER, 16, 4),                                 //"GR114"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ОтрицПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "ОтрицПоложПереоценка")) / 1000, TYPE_NUMBER, 16, 4),  //"GR115"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "ПоложПереоценка" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_СС_ПП")) / 1000, TYPE_NUMBER, 16, 4),            //"GR116"
                            format(getValue(value, "УровеньИДвиерархииСС"), TYPE_STRING, 3),                    //"GR117"
                            format(getValue(value, "КатКачества"), TYPE_STRING, 1),                             //"GR118"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Резерв")) / 1000, TYPE_NUMBER, 16, 4),                //"GR119"
                            format(getValue(value, "ЭмитентИНН_ПризнакКода"), TYPE_STRING, 4),                  //"A82B"
                            // 05.09.2014 ABP Изменяя правила вычисления значения "Резерв" не забываем
                            //                о соответствующих изменений в процедуре печати ф.711
                            format(floor(getValue(value, "Корр_резерва_ВП")) / 1000, TYPE_NUMBER, 16, 4),       //"GR120"
                            format(strSubst(getValue(value, "РезервПроцент"),"%",""), TYPE_NUMBER, 6, 2)        //"C21"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "BAL_ST_V");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerREKW_KKE_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        m_view.printRow(format(GetLicenseNumber(OurBank), TYPE_STRING, 14),         //"REGNUM"
                        format(ИНН, TYPE_STRING, 12),                               //"INN"
                        format(strSubst({Name_Bank}, "\"", "'"), TYPE_STRING, 250), //"NAMED"
                        format("Руководитель депозитария", TYPE_STRING, 200),       //"DOL_PRD"
                        format({Fio_Boss}, TYPE_STRING, 150),                       //"FIO_PRD"
                        format("", TYPE_STRING, 30),                                //"TEL_PRD"
                        format("", TYPE_STRING, 30),                                //"FAX_PRD"
                        format("", TYPE_STRING, 30),                                //"EMAIL_PRD"
                        format(Исполнитель, TYPE_STRING, 150),                      //"FIO_ISP"
                        format(Номер_телефона, TYPE_STRING, 30),                    //"TEL_ISP"
                        format("", TYPE_STRING, 30),                                //"FAX_ISP"
                        format("", TYPE_STRING, 30),                                //"EMAIL_ISP"
                        format("", TYPE_STRING, 76)                                 //"OTDEL"
                       );

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "REKW_KKE");
    end;
end;

private class (TF711PartKlikoExportControllerREKW_KKE_22_PAK) TF711PartKlikoExportControllerREKW_KKE_23_PAK()
    initTF711PartKlikoExportControllerREKW_KKE_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerREKW_KKE_23_PAK) TF711PartKlikoExportControllerREKW_KKE_24_PAK()
    initTF711PartKlikoExportControllerREKW_KKE_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerREKW_KKE_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        m_view.printRow(format(GetLicenseNumber(OurBank), TYPE_STRING, 14),         //"REGNUM"
                        format(ИНН, TYPE_STRING, 12),                               //"INN"
                        format(strSubst({Name_Bank}, "\"", "~^"), TYPE_STRING, 250), //"NAMED"
                        format("Руководитель депозитария", TYPE_STRING, 200),       //"DOL_PRD"
                        format({Fio_Boss}, TYPE_STRING, 150),                       //"FIO_PRD"
                        format("", TYPE_STRING, 30),                                //"TEL_PRD"
                        format("", TYPE_STRING, 30),                                //"FAX_PRD"
                        format("", TYPE_STRING, 30),                                //"EMAIL_PRD"
                        format(Исполнитель, TYPE_STRING, 150),                      //"FIO_ISP"
                        format(Номер_телефона, TYPE_STRING, 30),                    //"TEL_ISP"
                        format("", TYPE_STRING, 30),                                //"FAX_ISP"
                        format("", TYPE_STRING, 30),                                //"EMAIL_ISP"
                        format("", TYPE_STRING, 76)                                 //"OTDEL"
                       );

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "REKW_KKE");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportControllerREKW_KKE_27_PAK) TF711PartKlikoExportControllerREKW_KKE_32_PAK()
    initTF711PartKlikoExportControllerREKW_KKE_27_PAK();

    private macro getDescriptorInfo()
        return "F711_32.PAK от 08.02.2017";
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerREKW_KKE_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        m_view.printRow(format(GetLicenseNumber(OurBank), TYPE_STRING, 14),             //"REGNUM"
                        format(ИНН, TYPE_STRING, 12),                                   //"INN"
                        format(strSubst({Name_Bank}, "\"", "~^"), TYPE_STRING, 250),    //"NAMED"
                        format("Руководитель депозитария", TYPE_STRING, 200),           //"DOL_PRD"
                        format({Fio_Boss}, TYPE_STRING, 150),                           //"FIO_PRD"
                        format("", TYPE_STRING, 30),                                    //"TEL_PRD"
                        format("", TYPE_STRING, 30),                                    //"FAX_PRD"
                        format("", TYPE_STRING, 30),                                    //"EMAIL_PRD"
                        format(Исполнитель, TYPE_STRING, 150),                          //"FIO_ISP"
                        format(Номер_телефона, TYPE_STRING, 30),                        //"TEL_ISP"
                        format("", TYPE_STRING, 30),                                    //"FAX_ISP"
                        format("", TYPE_STRING, 30),                                    //"EMAIL_ISP"
                        format("", TYPE_STRING, 76)                                     //"OTDEL"
                       );

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "REKW_KKE");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerREKW_KKE_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        m_view.printRow(format(GetLicenseNumber(OurBank), TYPE_STRING, 14),             //"REGNUM"
                        format(ИНН, TYPE_STRING, 12),                                   //"INN"
                        format(strSubst({Name_Bank}, "\"", "~^"), TYPE_STRING, 250),    //"NAMED"
                        format("Руководитель депозитария", TYPE_STRING, 200),           //"DOL_PRD"
                        format({Fio_Boss}, TYPE_STRING, 150),                           //"FIO_PRD"
                        format("", TYPE_STRING, 30),                                    //"TEL_PRD"
                        format("", TYPE_STRING, 30),                                    //"FAX_PRD"
                        format("", TYPE_STRING, 30),                                    //"EMAIL_PRD"
                        format(Исполнитель, TYPE_STRING, 150),                          //"FIO_ISP"
                        format(Номер_телефона, TYPE_STRING, 30),                        //"TEL_ISP"
                        format("", TYPE_STRING, 30),                                    //"FAX_ISP"
                        format("", TYPE_STRING, 30),                                    //"EMAIL_ISP"
                        format("", TYPE_STRING, 76)                                     //"OTDEL"
                       );

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "REKW_KKE");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerVEK_KO_U_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                        //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                             //"B68"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "",
                                           getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                             //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                             //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                         //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                                //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                        //"B74"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                       //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                     //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                                 //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                        //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                                     //"B79"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           "",
                                           getValue(value, "dealAgentInn")
                                          ), TYPE_STRING, 12),                                                              //"B80"
                            format(getValue(value, "bookValue"), TYPE_NUMBER, 16, 4),                                       //"B81"
                            format(getValue(value, "interest"), TYPE_NUMBER, 16, 4),                                        //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                                      //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                                  //"B84"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           "",
                                           getValue(value, "storagePlaceInn")
                                          ), TYPE_STRING, 12),                                                              //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                                     //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                              //"B87"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                                      //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                         //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                         //"A94"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           getValue(value, "DealAgentINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                                   //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                                      //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                           //"A108"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           getValue(value, "StoragePlaceINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                                //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                                   //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30)                            //"A115"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportControllerVEK_KO_U_22_PAK) TF711PartKlikoExportControllerVEK_KO_U_23_PAK()
    initTF711PartKlikoExportControllerVEK_KO_U_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerVEK_KO_U_23_PAK) TF711PartKlikoExportControllerVEK_KO_U_24_PAK()
    initTF711PartKlikoExportControllerVEK_KO_U_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerVEK_KO_U_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                        //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                             //"B68"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "",
                                           getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                             //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                             //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                         //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                                //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                        //"B74"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                       //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                     //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                                 //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                        //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                                     //"B79"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           "",
                                           getValue(value, "dealAgentInn")
                                          ), TYPE_STRING, 12),                                                              //"B80"
                            format(getValue(value, "bookValue"), TYPE_NUMBER, 16, 4),                                       //"B81"
                            format(getValue(value, "interest"), TYPE_NUMBER, 16, 4),                                        //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                                      //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                                  //"B84"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           "",
                                           getValue(value, "storagePlaceInn")
                                          ), TYPE_STRING, 12),                                                              //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                                     //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                              //"B87"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                                      //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                         //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                         //"A94"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           getValue(value, "DealAgentINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                                   //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                                      //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                           //"A108"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           getValue(value, "StoragePlaceINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                                //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                                   //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30)                            //"A115"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_U");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerVEK_KO_U_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                        //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                             //"B68"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "",
                                           getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                             //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                             //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                         //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                                //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                        //"B74"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                                     //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                     //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                                 //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                        //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                                     //"B79"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           "",
                                           getValue(value, "dealAgentInn")
                                          ), TYPE_STRING, 12),                                                              //"B80"
                            format(getValue(value, "bookValue"),     TYPE_NUMBER, 16, 4),                                   //"B81"
                            format(getValue(value, "interest"),      TYPE_NUMBER, 16, 4),                                   //"B82"

                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                                      //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                                  //"B84"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           "",
                                           getValue(value, "storagePlaceInn")
                                          ), TYPE_STRING, 12),                                                              //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                                     //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                              //"B87"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                                      //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                         //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                         //"A94"
                            format(ternary(getValue(value, "dealAgentInn") == getValue(value, "DealAgentINN_TIN"),
                                           getValue(value, "DealAgentINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                                   //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                                      //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                           //"A108"
                            format(ternary(getValue(value, "storagePlaceInn") == getValue(value, "StoragePlaceINN_TIN"),
                                           getValue(value, "StoragePlaceINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                              //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                                //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                                   //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30),                           //"A115"

                            format(getValue(value, "TermDate1"),   TYPE_DATE),                                              //"B74_1"
                            format(getValue(value, "TermDate2"),   TYPE_DATE),                                              //"B74_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 7, 3),                                      //"B117"

                            format(getValue(value, "BuyCost"),     TYPE_NUMBER, 16, 4),                                     //"B120"

                            format(getValue(value, "QualityCateg"),  TYPE_STRING, 1),                                       //"B123"
                            format(getValue(value, "ReserveSum"),    TYPE_NUMBER, 16, 4),                                   //"B124"

                            format(getValue(value, "SaleCost"),      TYPE_NUMBER, 16, 4),                                   //"B137"
                            format(getValue(value, "SaleDate"),      TYPE_DATE),                                            //"B138"
                            format(getValue(value, "SaleGround"),    TYPE_STRING, 250),                                     //"B139"
                            format(getValue(value, "SaleAgentName"), TYPE_STRING, 250),                                     //"B140"
                            format(getValue(value, "SaleAgentINN"),  TYPE_STRING,  12),                                     //"B141"
                            format(getValue(value, "SaleAgentINN_TIN"), TYPE_STRING,  30),                                  //"B141A"
                            format(getValue(value, "SaleAgentINN_Mark"), TYPE_STRING,  1),                                  //"B141B"
                            format(getValue(value, "SaleAgentOGRN"), TYPE_STRING,  15),                                     //"B142"
                            format(getValue(value, "SaleAgentCountryCode"), TYPE_STRING,   3)                              //"B143"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerVEK_KO_U_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                     //"B68"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                //"B74"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                         //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                             //"B79"
                            format(getInnValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 12),        //"B80"
                            format(getValue(value, "bookValue"),     TYPE_NUMBER, 16, 4),                           //"B81"
                            format(getValue(value, "interest"),      TYPE_NUMBER, 16, 4),                           //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                              //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                          //"B84"
                            format(getInnValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 12),  //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                             //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B87"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                              //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                 //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                 //"A94"
                            format(getTinValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 30),        //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                           //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                              //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                   //"A108"
                            format(getTinValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 30),  //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                        //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                           //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30),                   //"A115"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B74_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B74_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 7, 3),                              //"B117"
                            format(getValue(value, "BuyCost"), TYPE_NUMBER, 16, 4),                                 //"B120"
                            format(getValue(value, "QualityCateg"), TYPE_STRING, 1),                                //"B123"
                            format(getValue(value, "ReserveSum"), TYPE_NUMBER, 16, 4),                              //"B124"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B137"
                            format(getValue(value, "SaleDate"), TYPE_DATE),                                         //"B138"
                            format(getValue(value, "SaleGround"), TYPE_STRING, 250),                                //"B139"
                            format(getValue(value, "SaleAgentName"), TYPE_STRING, 250),                             //"B140"
                            format(getValue(value, "SaleAgentINN"), TYPE_STRING,  12),                              //"B141"
                            format(getValue(value, "SaleAgentINN_TIN"), TYPE_STRING,  30),                          //"B141A"
                            format(getValue(value, "SaleAgentINN_Mark"), TYPE_STRING,  1),                          //"B141B"
                            format(getValue(value, "SaleAgentOGRN"), TYPE_STRING,  15),                             //"B142"
                            format(getValue(value, "SaleAgentCountryCode"), TYPE_STRING,   3)                       //"B143"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_KO_U_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                     //"B68"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                //"B74"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                         //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                             //"B79"
                            format(getInnValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 12),        //"B80"
                            format(getValue(value, "bookValue"),     TYPE_NUMBER, 16, 4),                           //"B81"
                            format(getValue(value, "interest"),      TYPE_NUMBER, 16, 4),                           //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                              //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                          //"B84"
                            format(getInnValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 12),  //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                             //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B87"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                              //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                 //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                 //"A94"
                            format(getTinValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 30),        //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                           //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                              //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                   //"A108"
                            format(getTinValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 30),  //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                        //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                           //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30),                   //"A115"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B74_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B74_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 7, 3),                              //"B117"
                            format(getValue(value, "BuyCost"), TYPE_NUMBER, 16, 4),                                 //"B120"
                            format(getValue(value, "QualityCateg"), TYPE_STRING, 1),                                //"B123"
                            format(getValue(value, "ReserveSum"), TYPE_NUMBER, 16, 4),                              //"B124"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B137"
                            format(getValue(value, "SaleDate"), TYPE_DATE),                                         //"B138"
                            format(getValue(value, "SaleGround"), TYPE_STRING, 250),                                //"B139"
                            format(getValue(value, "SaleAgentName"), TYPE_STRING, 250),                             //"B140"
                            format(getValue(value, "SaleAgentINN"), TYPE_STRING,  12),                              //"B141"
                            format(getValue(value, "SaleAgentINN_TIN"), TYPE_STRING,  30),                          //"B141A"
                            format(getValue(value, "SaleAgentINN_Mark"), TYPE_STRING,  1),                          //"B141B"
                            format(getValue(value, "SaleAgentOGRN"), TYPE_STRING,  15),                             //"B142"
                            format(getValue(value, "SaleAgentCountryCode"), TYPE_STRING,   3),                      //"B143"
                            format(getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 3),                          //"B69C"
                            format(getValue(value, "OvervalueBill"), TYPE_NUMBER, 16, 4),                           //"GR140"
                            format(getValue(value, "AdjustCost"), TYPE_NUMBER, 16, 4),                              //"GR141"
                            format(getValue(value, "AdjustReserv"), TYPE_NUMBER, 16, 4),                            //"GR144"
                            format(getValue(value, "dealAgentInn_CodeKind"), TYPE_STRING, 3),                       //"B80C"
                            format(getValue(value, "storagePlaceInn_CodeKind"), TYPE_STRING, 3),                    //"B85C"
                            format(getValue(value, "SaleAgentINN_CodeKind"), TYPE_STRING, 3)                        //"B141C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_KO_U_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                     //"B68"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                //"B74"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                         //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                             //"B79"
                            format(getInnValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 12),        //"B80"
                            format(getValue(value, "bookValue"),     TYPE_NUMBER, 16, 4),                           //"B81"
                            format(getValue(value, "interest"),      TYPE_NUMBER, 16, 4),                           //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                              //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                          //"B84"
                            format(getInnValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 12),  //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                             //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B87"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                              //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                 //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                 //"A94"
                            format(getTinValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 30),        //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                           //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                              //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                   //"A108"
                            format(getTinValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 30),  //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                        //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                           //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30),                   //"A115"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B74_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B74_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 7, 3),                              //"B117"
                            format(getValue(value, "BuyCost"), TYPE_NUMBER, 16, 4),                                 //"B120"
                            format(getValue(value, "QualityCateg"), TYPE_STRING, 1),                                //"B123"
                            format(getValue(value, "ReserveSum"), TYPE_NUMBER, 16, 4),                              //"B124"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B137"
                            format(getValue(value, "SaleDate"), TYPE_DATE),                                         //"B138"
                            format(getValue(value, "SaleGround"), TYPE_STRING, 250),                                //"B139"
                            format(getValue(value, "SaleAgentName"), TYPE_STRING, 250),                             //"B140"
                            format(getValue(value, "SaleAgentINN"), TYPE_STRING,  12),                              //"B141"
                            format(getValue(value, "SaleAgentINN_TIN"), TYPE_STRING,  30),                          //"B141A"
                            format(getValue(value, "SaleAgentINN_Mark"), TYPE_STRING,  1),                          //"B141B"
                            format(getValue(value, "SaleAgentOGRN"), TYPE_STRING,  15),                             //"B142"
                            format(getValue(value, "SaleAgentCountryCode"), TYPE_STRING,   3),                      //"B143"
                            format(getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 3),                          //"B69C"
                            format(getValue(value, "OvervalueBill"), TYPE_NUMBER, 16, 4),                           //"GR140"
                            format(getValue(value, "AdjustCost"), TYPE_NUMBER, 16, 4),                              //"GR141"
                            format(getValue(value, "AdjustReserv"), TYPE_NUMBER, 16, 4),                            //"GR144"
                            format(getValue(value, "dealAgentInn_CodeKind"), TYPE_STRING, 3),                       //"B80C"
                            format(getValue(value, "storagePlaceInn_CodeKind"), TYPE_STRING, 3),                    //"B85C"
                            format(getValue(value, "SaleAgentINN_CodeKind"), TYPE_STRING, 3),                       //"B141C"
                            format(getValue(value, "identifiercode"), TYPE_STRING, 100)                             //"C10"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerVEK_KO_U_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел1").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                                //"B67"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                     //"B68"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),              //"B69"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B70"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B71"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B72"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B73"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 50),                                //"B74"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B75"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B76"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                         //"B77"
                            format(getValue(value, "dealGround"), TYPE_STRING, 250),                                //"B78"
                            format(getValue(value, "dealAgentName"), TYPE_STRING, 250),                             //"B79"
                            format(getInnValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 12),        //"B80"
                            format(getValue(value, "bookValue"),     TYPE_NUMBER, 16, 4),                           //"B81"
                            format(getValue(value, "interest"),      TYPE_NUMBER, 16, 4),                           //"B82"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 9),                              //"B83"
                            format(getValue(value, "storagePlaceName"), TYPE_STRING, 250),                          //"B84"
                            format(getInnValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 12),  //"B85"
                            format(getValue(value, "storageGround"), TYPE_STRING, 250),                             //"B86"
                            format(getValue(value, "note"), TYPE_STRING, 512),                                      //"B87"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),              //"B69A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                              //"B69B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                                 //"A93"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 30),                                 //"A94"
                            format(getTinValue(value, "dealAgentInn", "DealAgentINN_TIN"), TYPE_STRING, 30),        //"B80A"
                            format(getValue(value, "DealAgentINN_Mark"), TYPE_STRING, 1),                           //"B80B"
                            format(getValue(value, "dealAgentOGRN"), TYPE_STRING, 30),                              //"A107"
                            format(getValue(value, "dealAgentCountryCodeOksm"), TYPE_STRING, 30),                   //"A108"
                            format(getTinValue(value, "storagePlaceInn", "StoragePlaceINN_TIN"), TYPE_STRING, 30),  //"B85A"
                            format(getValue(value, "StoragePlaceINN_Mark"), TYPE_STRING, 1),                        //"B85B"
                            format(getValue(value, "storagePlaceOGRN"), TYPE_STRING, 30),                           //"A114"
                            format(getValue(value, "StoragePlaceCountryCode2"), TYPE_STRING, 30),                   //"A115"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B74_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B74_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 7, 3),                              //"B117"
                            format(getValue(value, "BuyCost"), TYPE_NUMBER, 16, 4),                                 //"B120"
                            format(getValue(value, "QualityCateg"), TYPE_STRING, 1),                                //"B123"
                            format(getValue(value, "ReserveSum"), TYPE_NUMBER, 16, 4),                              //"B124"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B137"
                            format(getValue(value, "SaleDate"), TYPE_DATE),                                         //"B138"
                            format(getValue(value, "SaleGround"), TYPE_STRING, 250),                                //"B139"
                            format(getValue(value, "SaleAgentName"), TYPE_STRING, 250),                             //"B140"
                            format(getValue(value, "SaleAgentINN"), TYPE_STRING,  12),                              //"B141"
                            format(getValue(value, "SaleAgentINN_TIN"), TYPE_STRING,  30),                          //"B141A"
                            format(getValue(value, "SaleAgentINN_Mark"), TYPE_STRING,  1),                          //"B141B"
                            format(getValue(value, "SaleAgentOGRN"), TYPE_STRING,  15),                             //"B142"
                            format(getValue(value, "SaleAgentCountryCode"), TYPE_STRING,   3),                      //"B143"
                            format(getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 3),                          //"B69C"
                            format(getValue(value, "OvervalueBill"), TYPE_NUMBER, 16, 4),                           //"GR140"
                            format(getValue(value, "AdjustCost"), TYPE_NUMBER, 16, 4),                              //"GR141"
                            format(getValue(value, "AdjustReserv"), TYPE_NUMBER, 16, 4),                            //"GR144"
                            format(getValue(value, "dealAgentInn_CodeKind"), TYPE_STRING, 3),                       //"B80C"
                            format(getValue(value, "storagePlaceInn_CodeKind"), TYPE_STRING, 3),                    //"B85C"
                            format(getValue(value, "SaleAgentINN_CodeKind"), TYPE_STRING, 3),                       //"B141C"
                            format(getValue(value, "identifiercode"), TYPE_STRING, 100)                             //"C10"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_KO_U");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerVEK_KO_V_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                         //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                         //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                     //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                            //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                                   //"B93"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                   //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                 //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                               //"B96"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           "",
                                           getValue(value, "firstHolderInn")
                                          ), TYPE_STRING, 12),                                                          //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                        //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                    //"B99"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                          //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                          //"B101"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           getValue(value, "FirstHolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                             //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                                //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                         //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                        //"A131"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                                  //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                     //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30)                           //"A135"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportControllerVEK_KO_V_22_PAK) TF711PartKlikoExportControllerVEK_KO_V_23_PAK()
    initTF711PartKlikoExportControllerVEK_KO_V_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerVEK_KO_V_23_PAK) TF711PartKlikoExportControllerVEK_KO_V_24_PAK()
    initTF711PartKlikoExportControllerVEK_KO_V_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerVEK_KO_V_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                         //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                         //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                     //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                            //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                                   //"B93"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                                   //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                 //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                               //"B96"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           "",
                                           getValue(value, "firstHolderInn")
                                          ), TYPE_STRING, 12),                                                          //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                        //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                    //"B99"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                          //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                          //"B101"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           getValue(value, "FirstHolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                             //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                                //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                         //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                        //"A131"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                                  //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                     //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30)                           //"A135"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_V");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerVEK_KO_V_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                         //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                         //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                     //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                            //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                                   //"B93"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                                 //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                                 //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                               //"B96"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           "",
                                           getValue(value, "firstHolderInn")
                                          ), TYPE_STRING, 12),                                                          //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                        //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                    //"B99"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                          //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                          //"B101"
                            format(ternary(getValue(value, "firstHolderInn") == getValue(value, "FirstHolderINN_TIN"),
                                           getValue(value, "FirstHolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                             //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                                //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                         //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                        //"A131"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                          //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                                  //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                     //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30),                          //"A135"

                            format(getValue(value, "TermDate1"),   TYPE_DATE),                                          //"B93_1"
                            format(getValue(value, "TermDate2"),   TYPE_DATE),                                          //"B93_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER,  7, 3),                                 //"B153"
                            format(getValue(value, "SaleCost"),    TYPE_NUMBER, 16, 4)                                  //"B156"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerVEK_KO_V_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                               //"B93"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                           //"B96"
                            format(getInnValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 12),    //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                    //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                //"B99"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),              //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B101"
                            format(getTinValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 30),    //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                         //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                            //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                     //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                    //"A131"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),              //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                              //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                 //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30),                      //"A135"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B93_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B93_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER,  7, 3),                             //"B153"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B156"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 5)                               //"GR177"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_KO_V_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                               //"B93"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                           //"B96"
                            format(getInnValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 12),    //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                    //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                //"B99"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),              //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B101"
                            format(getTinValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 30),    //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                         //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                            //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                     //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                    //"A131"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),              //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                              //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                 //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30),                      //"A135"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B93_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B93_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER,  7, 3),                             //"B153"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B156"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 5),                              //"GR177"
                            format(getValue(value, "firstHolderInn_CodeKind"), TYPE_STRING, 3),                     //"B97C"
                            format(getValue(value, "firstHolderInn_CodeKind"), TYPE_STRING, 3)                      //"B100C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_KO_V_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел2").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "series"), TYPE_STRING, 15),                                     //"B89"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                     //"B90"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                                 //"B91"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                        //"B92"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                               //"B93"
                            format(getValue(value, "faceValue"),   TYPE_NUMBER, 16, 4),                             //"B94"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                             //"B95"
                            format(getValue(value, "firstHolderName"), TYPE_STRING, 250),                           //"B96"
                            format(getInnValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 12),    //"B97"
                            format(getValue(value, "state"), TYPE_NUMBER, 2, 0),                                    //"B98"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                                //"B99"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),              //"B100"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                      //"B101"
                            format(getTinValue(value, "firstHolderInn", "FirstHolderINN_TIN"), TYPE_STRING, 30),    //"B97A"
                            format(getValue(value, "FirstHolderINN_Mark"), TYPE_STRING, 1),                         //"B97B"
                            format(getValue(value, "firstHolderOGRN"), TYPE_STRING, 15),                            //"A128"
                            format(getValue(value, "firstHolderCountryCode2"), TYPE_STRING, 3),                     //"A129"
                            format(getValue(value, "repaymentDate"), TYPE_DATE),                                    //"A131"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),              //"B100A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                              //"B100B"
                            format(getValue(value, "holderOgrn"), TYPE_STRING, 30),                                 //"A134"
                            format(getValue(value, "holderCountryCodeOksm"), TYPE_STRING, 30),                      //"A135"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                                        //"B93_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                                        //"B93_2"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER,  7, 3),                             //"B153"
                            format(getValue(value, "SaleCost"), TYPE_NUMBER, 16, 4),                                //"B156"
                            format(getValue(value, "balanceAccount"), TYPE_STRING, 5),                              //"GR177"
                            format(getValue(value, "firstHolderInn_CodeKind"), TYPE_STRING, 3),                     //"B97C"
                            format(getValue(value, "firstHolderInn_CodeKind"), TYPE_STRING, 3),                     //"B100C"
                            format(getValue(value, "identifiercode"), TYPE_STRING, 100)                             //"C5"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_KO_V");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerVEK_STL_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                            //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                 //"B104"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                 //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                 //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                             //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                    //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                           //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                           //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                         //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                     //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                            //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                            //"B115"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                  //"B117"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 3),                          //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                             //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                              //"A141"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 3),                          //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                             //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3)                    //"A155"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportControllerVEK_STL_22_PAK) TF711PartKlikoExportControllerVEK_STL_23_PAK()
    initTF711PartKlikoExportControllerVEK_STL_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerVEK_STL_23_PAK) TF711PartKlikoExportControllerVEK_STL_24_PAK()
    initTF711PartKlikoExportControllerVEK_STL_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerVEK_STL_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                            //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                 //"B104"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                 //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                 //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                             //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                    //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                           //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                           //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                         //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                     //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                            //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                            //"B115"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                  //"B117"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 3),                          //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                             //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                              //"A141"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 3),                          //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                             //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3)                    //"A155"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_STL");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerVEK_STL_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                            //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                                 //"B104"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "issuerInn")
                                          ), TYPE_STRING, 12),                                                  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                                 //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                                 //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                             //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                                    //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                           //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                           //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                         //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                                     //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                            //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                            //"B115"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           "",
                                           getValue(value, "holderInn")
                                          ), TYPE_STRING, 12),                                                  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                                  //"B117"
                            format(ternary(getValue(value, "issuerInn") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 3),                          //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                             //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                              //"A141"
                            format(ternary(getValue(value, "holderInn") == getValue(value, "HolderINN_TIN"),
                                           getValue(value, "HolderINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                          //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                             //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3),                    //"A155"

                            format(getValue(value, "TermDate1"),   TYPE_DATE),                                  //"B110_1"
                            format(getValue(value, "TermDate2"),   TYPE_DATE),                                  //"B110_2"
                            format(getValue(value, "HolderState"), TYPE_STRING, 3)                              //"B186"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerVEK_STL_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                    //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                         //"B104"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                         //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                         //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                     //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                            //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                   //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                   //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                 //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                             //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                    //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                    //"B115"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                          //"B117"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 3),                  //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                     //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                      //"A141"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                  //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                     //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3),           //"A155"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                            //"B110_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                            //"B110_2"
                            format(getValue(value, "HolderState"), TYPE_STRING, 3),                     //"B186"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 6, 3),                  //"GR198"
                            format(getValue(value, "state"), TYPE_NUMBER, 2)                            //"GR208"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_STL_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                    //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                         //"B104"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                         //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                         //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                     //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                            //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                   //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                   //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                 //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                             //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                    //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                    //"B115"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                          //"B117"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                  //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                     //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                      //"A141"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                  //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                     //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3),           //"A155"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                            //"B110_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                            //"B110_2"
                            format(getValue(value, "HolderState"), TYPE_STRING, 3),                     //"B186"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 6, 3),                  //"GR198"
                            format(getValue(value, "state"), TYPE_NUMBER, 2),                           //"GR208"
                            format(getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 3),              //"B105C"
                            format(getValue(value, "holderInn_CodeKind"), TYPE_STRING, 3)               //"B116C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerVEK_STL_I5456()
    initTF711PartKlikoExportController_I4927();

    private macro getDescriptorInfo()
        return "F711_54.pak от 28.04.2021";
    end;

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел2_Подраздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "issuerName"), TYPE_STRING, 250),                    //"B103"
                            format(getValue(value, "code711"), TYPE_STRING, 5),                         //"B104"
                            format(getInnValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B105"
                            format(getValue(value, "series"), TYPE_STRING, 15),                         //"B106"
                            format(getValue(value, "number"), TYPE_STRING, 15),                         //"B107"
                            format(getValue(value, "formNumber"), TYPE_STRING, 15),                     //"B108"
                            format(getValue(value, "issueDate"), TYPE_DATE),                            //"B109"
                            format(getValue(value, "paymentTerm"), TYPE_STRING, 250),                   //"B110"
                            format(getValue(value, "faceValue"), TYPE_NUMBER, 16, 4),                   //"B111"
                            format(getValue(value, "faceValueFiCode"), TYPE_STRING, 3),                 //"B112"
                            format(getValue(value, "dealDate"), TYPE_DATE),                             //"B113"
                            format(getValue(value, "dealGround"), TYPE_STRING, 100),                    //"B114"
                            format(getValue(value, "holderName"), TYPE_STRING, 250),                    //"B115"
                            format(getInnValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 12),  //"B116"
                            format(getValue(value, "note"), TYPE_STRING, 250),                          //"B117"
                            format(getTinValue(value, "issuerInn", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B105A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                  //"B105B"
                            format(getValue(value, "issuerOgrn"), TYPE_STRING, 15),                     //"A140"
                            format(getValue(value, "issuerOksm"), TYPE_STRING, 3),                      //"A141"
                            format(getTinValue(value, "holderInn", "HolderINN_TIN"), TYPE_STRING, 30),  //"B116A"
                            format(getValue(value, "HolderINN_Mark"), TYPE_STRING, 1),                  //"B116B"
                            format(getValue(value, "HolderOgrn"), TYPE_STRING, 15),                     //"A154"
                            format(getValue(value, "HolderCountryCodeOksm"), TYPE_STRING, 3),           //"A155"
                            format(getValue(value, "TermDate1"), TYPE_DATE),                            //"B110_1"
                            format(getValue(value, "TermDate2"), TYPE_DATE),                            //"B110_2"
                            format(getValue(value, "HolderState"), TYPE_STRING, 3),                     //"B186"
                            format(getValue(value, "PercentRate"), TYPE_NUMBER, 6, 3),                  //"GR198"
                            format(getValue(value, "state"), TYPE_NUMBER, 2),                           //"GR208"
                            format(getValue(value, "issuerInn_CodeKind"), TYPE_STRING, 3),              //"B105C"
                            format(getValue(value, "holderInn_CodeKind"), TYPE_STRING, 3),              //"B116C"
                            format(getValue(value, "identifiercode"), TYPE_STRING, 100),                //"C10"
                            format(getValue(value, "avalacept"), TYPE_STRING, 2)                        //"C26"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "VEK_STL");
    end;
end;

private class (TF711PartKlikoExportController_22_PAK) TF711PartKlikoExportControllerZAKLAD1_22_PAK()
    initTF711PartKlikoExportController_22_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"), TYPE_STRING, 250),                            //"B158"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "IssuerINN")
                                          ), TYPE_STRING, 12),                                                  //"B159"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                          //"B159B"
                            format(getValue(value, "IssuerKPP"), TYPE_STRING, 9),                               //"B160"
                            format(getValue(value, "IssuerOGRN"), TYPE_STRING, 15),                             //"B161"
                            format(getValue(value, "IssuerCountryCode"), TYPE_STRING, 3),                       //"B162"
                            format(getValue(value, "Code711"), TYPE_STRING, 5),                                 //"B163"
                            format(getValue(value, "LSIN"), TYPE_STRING, 20),                                   //"B164"
                            format(getValue(value, "ISIN"), TYPE_STRING, 12),                                   //"B165"
                            format(getValue(value, "FaceValueFICode"), TYPE_STRING, 3),                         //"B166"
                            format(ternary(getValue(value, "FaceValue") <= 0.0000001,
                                           0.000001,
                                           getValue(value, "FaceValue")
                                          ), TYPE_STRING, 18, 6),                                               //"B167"
                            format(getValue(value, "SaleREPOAmount"), TYPE_STRING, 30, 6),                      //"B168"
                            format(getValue(value, "TransLoanAmount"), TYPE_STRING, 30, 6),                     //"B169"
                            format(getValue(value, "BuyREPOAmount"), TYPE_STRING, 30, 6),                       //"B170"
                            format(getValue(value, "AcceptLoanAmount"), TYPE_STRING, 30, 6),                    //"B171"
                            format(getValue(value, "TransDUAmount"), TYPE_STRING, 30, 6),                       //"B172"
                            format(getValue(value, "TransRightsDUAmount"), TYPE_STRING, 30, 6),                 //"B173"
                            format(getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 30, 6),                 //"B174"
                            format(getValue(value, "TransPledgeAmount"), TYPE_STRING, 30, 6),                   //"B175"
                            format(getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 30, 6),                  //"B176"
                            format(getValue(value, "note"), TYPE_STRING, 250)                                   //"B177"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "ZAKLAD1");
    end;
end;

private class (TF711PartKlikoExportControllerZAKLAD1_22_PAK) TF711PartKlikoExportControllerZAKLAD1_23_PAK()
    initTF711PartKlikoExportControllerZAKLAD1_22_PAK();

    private macro getDescriptorInfo()
        return "F711_23.PAK от 05.03.2015";
    end;
end;

private class (TF711PartKlikoExportControllerZAKLAD1_23_PAK) TF711PartKlikoExportControllerZAKLAD1_24_PAK()
    initTF711PartKlikoExportControllerZAKLAD1_23_PAK();

    private macro getDescriptorInfo()
        return "F711_24.PAK от 05.05.2015";
    end;
end;

private class (TF711PartKlikoExportController_27_PAK) TF711PartKlikoExportControllerZAKLAD1_27_PAK()
    initTF711PartKlikoExportController_27_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"), TYPE_STRING, 250),                            //"B158"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "IssuerINN")
                                          ), TYPE_STRING, 12),                                                  //"B159"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                          //"B159B"
                            format(getValue(value, "IssuerKPP"), TYPE_STRING, 9),                               //"B160"
                            format(getValue(value, "IssuerOGRN"), TYPE_STRING, 15),                             //"B161"
                            format(getValue(value, "IssuerCountryCode"), TYPE_STRING, 3),                       //"B162"
                            format(getValue(value, "Code711"), TYPE_STRING, 5),                                 //"B163"
                            format(getValue(value, "LSIN"), TYPE_STRING, 20),                                   //"B164"
                            format(getValue(value, "ISIN"), TYPE_STRING, 12),                                   //"B165"
                            format(getValue(value, "FaceValueFICode"), TYPE_STRING, 3),                         //"B166"
                            format(getFaceValue(value, "FaceValue", "Code711"), TYPE_STRING, 18, 6),            //"B167"
                            format(getValue(value, "SaleREPOAmount"), TYPE_STRING, 30, 6),                      //"B168"
                            format(getValue(value, "TransLoanAmount"), TYPE_STRING, 30, 6),                     //"B169"
                            format(getValue(value, "BuyREPOAmount"), TYPE_STRING, 30, 6),                       //"B170"
                            format(getValue(value, "AcceptLoanAmount"), TYPE_STRING, 30, 6),                    //"B171"
                            format(getValue(value, "TransDUAmount"), TYPE_STRING, 30, 6),                       //"B172"
                            format(getValue(value, "TransRightsDUAmount"), TYPE_STRING, 30, 6),                 //"B173"
                            format(getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 30, 6),                 //"B174"
                            format(getValue(value, "TransPledgeAmount"), TYPE_STRING, 30, 6),                   //"B175"
                            format(getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 30, 6),                  //"B176"
                            format(getValue(value, "note"), TYPE_STRING, 250)                                   //"B177"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "ZAKLAD1");
    end;

    private macro getDescriptorInfo()
        return "F711_27.PAK от 16.07.2015";
    end;
end;

private class (TF711PartKlikoExportController_32_PAK) TF711PartKlikoExportControllerZAKLAD1_32_PAK()
    initTF711PartKlikoExportController_32_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"),               TYPE_STRING, 250),              //"B158"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           "", getValue(value, "IssuerINN")
                                          ), TYPE_STRING, 12),                                                  //"B159"
                            format(ternary(getValue(value, "IssuerINN") == getValue(value, "IssuerINN_TIN"),
                                           getValue(value, "IssuerINN_TIN"),
                                           ""
                                          ), TYPE_STRING, 30),                                                  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"),           TYPE_STRING, 1),                //"B159B"
                            format(getValue(value, "IssuerKPP"),                TYPE_STRING, 9),                //"B160"
                            format(getValue(value, "IssuerOGRN"),               TYPE_STRING, 15),               //"B161"
                            format(getValue(value, "IssuerCountryCode"),        TYPE_STRING, 3),                //"B162"
                            format(getValue(value, "Code711"),                  TYPE_STRING, 5),                //"B163"
                            format(getValue(value, "LSIN"),                     TYPE_STRING, 20),               //"B164"
                            format(getValue(value, "ISIN"),                     TYPE_STRING, 12),               //"B165"
                            format(getValue(value, "FaceValueFICode"),          TYPE_STRING, 3),                //"B166"
                            format(getFaceValue(value, "FaceValue", "Code711"), TYPE_STRING, 18, 6),            //"B167"
                            format(getValue(value, "SaleREPOAmount"),           TYPE_STRING, 30, 6),            //"B168"
                            format(getValue(value, "TransLoanAmount"),          TYPE_STRING, 30, 6),            //"B169"
                            format(getValue(value, "BuyREPOAmount"),            TYPE_STRING, 30, 6),            //"B170"
                            format(getValue(value, "AcceptLoanAmount"),         TYPE_STRING, 30, 6),            //"B171"
                            format(getValue(value, "TransDUAmount"),            TYPE_STRING, 30, 6),            //"B172"
                            format(getValue(value, "TransRightsDUAmount"),      TYPE_STRING, 30, 6),            //"B173"
                            format(getValue(value, "TransPledgeBOAmount"),      TYPE_STRING, 30, 6),            //"B174"
                            format(getValue(value, "TransPledgeAmount"),        TYPE_STRING, 30, 6),            //"B175"
                            format(getValue(value, "AcceptPledgeAmount"),       TYPE_STRING, 30, 6),            //"B176"
                            format(getValue(value, "note"),                     TYPE_STRING, 250),              //"B177"

                            format(getValue(value, "ТогрСчета"),                TYPE_STRING, 30, 6),            //"B211"
                            format(getValue(value, "ОгранКД"),                  TYPE_STRING, 30, 6),            //"B212"
                            format(getValue(value, "ЗапретОпер"),               TYPE_STRING, 30, 6),            //"B213"
                            format(getValue(value, "Арест"),                    TYPE_STRING, 30, 6)             //"B214"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_22_PAK(m_report.getPeriod().endDate, "ZAKLAD1");
    end;
end;

private class (TF711PartKlikoExportController_I4637) TF711PartKlikoExportControllerZAKLAD1_I4637()
    initTF711PartKlikoExportController_I4637();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"), TYPE_STRING, 250),                    //"B158"
                            format(getInnValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B159"
                            format(getTinValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                  //"B159B"
                            format(getValue(value, "IssuerKPP"), TYPE_STRING, 9),                       //"B160"
                            format(getValue(value, "IssuerOGRN"), TYPE_STRING, 15),                     //"B161"
                            format(getValue(value, "IssuerCountryCode"), TYPE_STRING, 3),               //"B162"
                            format(getValue(value, "Code711"), TYPE_STRING, 5),                         //"B163"
                            format(getValue(value, "LSIN"), TYPE_STRING, 20),                           //"B164"
                            format(getValue(value, "ISIN"), TYPE_STRING, 12),                           //"B165"
                            format(getValue(value, "FaceValueFICode"), TYPE_STRING, 3),                 //"B166"
                            format(getFaceValue(value, "FaceValue", "Code711"), TYPE_STRING, 18, 6),    //"B167"
                            format(getValue(value, "SaleREPOAmount"), TYPE_STRING, 30, 6),              //"B168"
                            format(getValue(value, "TransLoanAmount"), TYPE_STRING, 30, 6),             //"B169"
                            format(getValue(value, "BuyREPOAmount"), TYPE_STRING, 30, 6),               //"B170"
                            format(getValue(value, "AcceptLoanAmount"), TYPE_STRING, 30, 6),            //"B171"
                            format(getValue(value, "TransDUAmount"), TYPE_STRING, 30, 6),               //"B172"
                            format(getValue(value, "TransRightsDUAmount"), TYPE_STRING, 30, 6),         //"B173"
                            format(getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 30, 6),         //"B174"
                            format(getValue(value, "TransPledgeAmount"), TYPE_STRING, 30, 6),           //"B175"
                            format(getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 30, 6),          //"B176"
                            format(getValue(value, "note"), TYPE_STRING, 250),                          //"B177"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                   //"B211"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                     //"B212"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                  //"B213"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6)                        //"B214"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4637(m_report.getPeriod().endDate, "ZAKLAD1");
    end;
end;

private class (TF711PartKlikoExportController_I4927) TF711PartKlikoExportControllerZAKLAD1_I4927()
    initTF711PartKlikoExportController_I4927();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"), TYPE_STRING, 250),                    //"B158"
                            format(getInnValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B159"
                            format(getTinValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                  //"B159B"
                            format(getValue(value, "IssuerKPP"), TYPE_STRING, 9),                       //"B160"
                            format(getValue(value, "IssuerOGRN"), TYPE_STRING, 15),                     //"B161"
                            format(getValue(value, "IssuerCountryCode"), TYPE_STRING, 3),               //"B162"
                            format(getValue(value, "Code711"), TYPE_STRING, 5),                         //"B163"
                            format(getValue(value, "LSIN"), TYPE_STRING, 21),                           //"B164"
                            format(getValue(value, "ISIN"), TYPE_STRING, 12),                           //"B165"
                            format(getValue(value, "FaceValueFICode"), TYPE_STRING, 3),                 //"B166"
                            format(getFaceValue(value, "FaceValue", "Code711"), TYPE_STRING, 18, 6),    //"B167"
                            format(getValue(value, "SaleREPOAmount"), TYPE_STRING, 30, 6),              //"B168"
                            format(getValue(value, "TransLoanAmount"), TYPE_STRING, 30, 6),             //"B169"
                            format(getValue(value, "BuyREPOAmount"), TYPE_STRING, 30, 6),               //"B170"
                            format(getValue(value, "AcceptLoanAmount"), TYPE_STRING, 30, 6),            //"B171"
                            format(getValue(value, "TransDUAmount"), TYPE_STRING, 30, 6),               //"B172"
                            format(getValue(value, "TransRightsDUAmount"), TYPE_STRING, 30, 6),         //"B173"
                            format(getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 30, 6),         //"B174"
                            format(getValue(value, "TransPledgeAmount"), TYPE_STRING, 30, 6),           //"B175"
                            format(getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 30, 6),          //"B176"
                            format(getValue(value, "note"), TYPE_STRING, 250),                          //"B177"
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 30, 6),                   //"B211"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 30, 6),                     //"B212"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 30, 6),                  //"B213"
                            format(getValue(value, "Арест"), TYPE_STRING, 30, 6),                       //"B214"
                            format(getValue(value, "IssuerINN_CodeKind"), TYPE_STRING, 3)               //"B159C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "ZAKLAD1");
    end;
end;

private class (TF711PartKlikoExportController_55_PAK) TF711PartKlikoExportControllerZAKLAD1_55_PAK()
    initTF711PartKlikoExportController_55_PAK();

    private macro printData()
        var it = m_report.getRcbReport().attributeValue("Ф711_Раздел3").createValueIterator();
        it.moveFirst();
        while (not it.isDone())
            var value = it.currentItem;

            m_view.printRow(format(getValue(value, "IssuerName"), TYPE_STRING, 250),                    //"B158"
                            format(getInnValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 12),  //"B159"
                            format(getTinValue(value, "IssuerINN", "IssuerINN_TIN"), TYPE_STRING, 30),  //"B159A"
                            format(getValue(value, "IssuerINN_Mark"), TYPE_STRING, 1),                  //"B159B"
                            format(getValue(value, "IssuerKPP"), TYPE_STRING, 9),                       //"B160"
                            format(getValue(value, "IssuerOGRN"), TYPE_STRING, 15),                     //"B161"
                            format(getValue(value, "IssuerCountryCode"), TYPE_STRING, 3),               //"B162"
                            format(getValue(value, "Code711"), TYPE_STRING, 5),                         //"B163"
                            format(getValue(value, "LSIN"), TYPE_STRING, 64),                           //"B164"
                            format(getValue(value, "ISIN"), TYPE_STRING, 12),                           //"B165"
                            format(getValue(value, "FaceValueFICode"), TYPE_STRING, 3),                 //"B166"
                            format(getFaceValue(value, "FaceValue", "Code711"), TYPE_STRING, 29, 8),    //"B167"
                            format(getValue(value, "SaleREPOAmount"), TYPE_STRING, 29, 6),              //"B168"
                            format(getValue(value, "TransLoanAmount"), TYPE_STRING, 29, 6),             //"B169"
                            format(getValue(value, "BuyREPOAmount"), TYPE_STRING, 29, 6),               //"B170"
                            format(getValue(value, "AcceptLoanAmount"), TYPE_STRING, 29, 6),            //"B171"
                            format(getValue(value, "TransDUAmount"), TYPE_STRING, 29, 6),               //"B172"
                            format(getValue(value, "TransRightsDUAmount"), TYPE_STRING, 29, 6),         //"B173"
                            format(getValue(value, "TransPledgeBOAmount"), TYPE_STRING, 29, 6),         //"B174"
                            format(getValue(value, "TransPledgeAmount"), TYPE_STRING, 29, 6),           //"B175"
                            format(getValue(value, "AcceptPledgeAmount"), TYPE_STRING, 29, 6),          //"B176"
                            format(getValue(value, "note"), TYPE_STRING, 512),                          //"B177"    //по ТЗ С2000
                            format(getValue(value, "ТогрСчета"), TYPE_STRING, 29, 6),                   //"B211"
                            format(getValue(value, "ОгранКД"), TYPE_STRING, 29, 6),                     //"B212"
                            format(getValue(value, "ЗапретОпер"), TYPE_STRING, 29, 6),                  //"B213"
                            format(getValue(value, "Арест"), TYPE_STRING, 29, 6),                       //"B214"
                            format(getValue(value, "IssuerINN_CodeKind"), TYPE_STRING, 3)               //"B159C"
                           );

            it.moveNext();
        end;

        onError(error)
            exceptionMessage(error);
            runError();
    end;

    private macro createView()
        return TF711PartKlikoView_I4927(m_report.getPeriod().endDate, "ZAKLAD1");
    end;
end;

private class TF711KlikoExportController()
    private var m_partControllers : RcbArray;

    private macro addPartController(partController : RcbKlikoExportController) : TF711KlikoExportController
        m_partControllers.push_back(partController);

        return this;
    end;

    macro execute()
        m_partControllers.moveFirst();
        while (m_partControllers.moveNext())
            m_partControllers.getCurrentItem().execute(false);
        end;
    end;

    private macro constructorTF711KlikoExportController()
        m_partControllers = RcbArray();
    end;

    constructorTF711KlikoExportController();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_I3129()

    private macro constructorTF711KlikoExportController_I3129()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_I3129());
        addPartController(TF711PartKlikoExportControllerSECLKLN_I3129());
        addPartController(TF711PartKlikoExportControllerSECLKON_I3129());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_I3129());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I3129());
    end;

    constructorTF711KlikoExportController_I3129();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_19_PAK()

    private macro constructorTF711KlikoExportController_19_PAK()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_19_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_19_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_19_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_I3129());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I3129());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I3129());
    end;

    constructorTF711KlikoExportController_19_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_22_PAK()

    private macro constructorTF711KlikoExportController_22_PAK()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_22_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_22_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_22_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_22_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_22_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_22_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_22_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_STL_22_PAK());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_22_PAK());
    end;

    constructorTF711KlikoExportController_22_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_23_PAK()

    private macro constructorTF711KlikoExportController_23_PAK()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_23_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_23_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_23_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_23_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_23_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_23_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_23_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_STL_23_PAK());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_23_PAK());
    end;

    constructorTF711KlikoExportController_23_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_24_PAK()

    private macro constructorTF711KlikoExportController_24_PAK()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_24_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_24_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_24_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_24_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_24_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_24_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_24_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_STL_24_PAK());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_24_PAK());
    end;

    constructorTF711KlikoExportController_24_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_27_PAK()

    private macro constructorTF711KlikoExportController_27_PAK()
        initTF711KlikoExportController();

        addPartController(TF711PartKlikoExportControllerLORO_27_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_27_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_27_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_27_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_27_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_27_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_27_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_STL_27_PAK());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_27_PAK());
    end;

    constructorTF711KlikoExportController_27_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_32_PAK()

    private macro constructorTF711KlikoExportController_32_PAK()
        initTF711KlikoExportController();
        addPartController(TF711PartKlikoExportControllerLORO_32_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_32_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_32_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_32_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_32_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_32_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_32_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_STL_32_PAK());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_32_PAK());
    end;

    constructorTF711KlikoExportController_32_PAK();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_I4637()
    private macro constructorTF711KlikoExportController_I4637()
        initTF711KlikoExportController();
        addPartController(TF711PartKlikoExportControllerLORO_I4637());
        addPartController(TF711PartKlikoExportControllerSECLKLN_I4637());
        addPartController(TF711PartKlikoExportControllerSECLKON_I4637());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_I4637());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I4637());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_I4637());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I4637());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I4637());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_I4637());
    end;

    constructorTF711KlikoExportController_I4637();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_I4927()
    private macro constructorTF711KlikoExportController_I4927()
        initTF711KlikoExportController();
        addPartController(TF711PartKlikoExportControllerLORO_I4927());
        addPartController(TF711PartKlikoExportControllerSECLKLN_I4927());
        addPartController(TF711PartKlikoExportControllerSECLKON_I4927());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_I4927());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I4927());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_I4927());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I4927());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I4927());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_I4927());
    end;

    constructorTF711KlikoExportController_I4927();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_I5456()
    private macro constructorTF711KlikoExportController_I5456()
        initTF711KlikoExportController();
        addPartController(TF711PartKlikoExportControllerLORO_I4927());
        addPartController(TF711PartKlikoExportControllerSECLKLN_I5456());
        addPartController(TF711PartKlikoExportControllerR1_2_1());
        addPartController(TF711PartKlikoExportControllerSECLKON_I5456());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_I5456());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I4927());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_I5456());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I5456());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I5456());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_I4927());
    end;

    constructorTF711KlikoExportController_I5456();
end;

private class (TF711KlikoExportController) TF711KlikoExportController_55_PAK()
    private macro constructorTF711KlikoExportController_55_PAK()
        initTF711KlikoExportController();
        addPartController(TF711PartKlikoExportControllerLORO_55_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKLN_55_PAK());
        addPartController(TF711PartKlikoExportControllerR1_2_1_55_PAK());
        addPartController(TF711PartKlikoExportControllerSECLKON_55_PAK());
        addPartController(TF711PartKlikoExportControllerBAL_ST_V_55_PAK());
        addPartController(TF711PartKlikoExportControllerREKW_KKE_I4927());
        addPartController(TF711PartKlikoExportControllerVEK_KO_U_55_PAK());
        addPartController(TF711PartKlikoExportControllerVEK_KO_V_I5456());
        addPartController(TF711PartKlikoExportControllerVEK_STL_I5456());
        addPartController(TF711PartKlikoExportControllerZAKLAD1_55_PAK());
    end;

    constructorTF711KlikoExportController_55_PAK();
end;

private class TExportProtocolController()
    macro show()
    end;
end;

private class (TExportProtocolController) TExportProtocolController_I1841()
    macro show()
    end;
end;

private class (TExportProtocolController) TExportProtocolController_I2055()
    macro show()
    end;
end;

private class (TExportProtocolController) TExportProtocolController_I2627()
    macro show()
    end;
end;

private class (TExportProtocolController) TExportProtocolController_I3129()
    macro show()
        var protocol = TSummaryProtocolView();

        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела LORO"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKLN"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKON"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела BAL_ST_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела REKW_KKE"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_U"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_STL"));

        protocol.show();
    end;
end;

private class (TExportProtocolController) TExportProtocolController_19_PAK()
    macro show()
        var protocol = TSummaryProtocolView();

        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела LORO"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKLN"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKON"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела BAL_ST_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела REKW_KKE"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_U"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_STL"));

        protocol.show();
    end;
end;

private class (TExportProtocolController) TExportProtocolController_22_PAK()
    macro show()
        var protocol = TSummaryProtocolView();

        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела LORO"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKLN"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKON"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела BAL_ST_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела REKW_KKE"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_U"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_STL"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела ZAKLAD1"));

        protocol.show();
    end;
end;

private class (TExportProtocolController) TExportProtocolController_I5456()
    macro show()
        var protocol = TSummaryProtocolView();

        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела LORO"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKLN"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела R1_2_1"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела SECLKON"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела BAL_ST_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела REKW_KKE"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_U"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_KO_V"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела VEK_STL"));
        protocol.add(TProtocolView("ПРОТОКОЛ ЭКСПОРТА В kliko раздела ZAKLAD1"));

        protocol.show();
    end;
end;

private class TExportController()
    private var m_exportController : Object;
    private var m_protocolContorller : Object;

    macro export()
        m_exportController.execute();
    end;

    macro showProtocol()
        m_protocolContorller.show();
    end;

    private macro constructorTExportController()
        if   (rcbApplication().currentReport.context.period.endDate >= RCB_F711_55_PAK_DATE)
            m_exportController   = TF711KlikoExportController_55_PAK();
            m_protocolContorller = TExportProtocolController_I5456();
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I5456_DATE)
            m_exportController   = TF711KlikoExportController_I5456();
            m_protocolContorller = TExportProtocolController_I5456();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4927_DATE)
            m_exportController   = TF711KlikoExportController_I4927();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE2)
            m_exportController   = TF711KlikoExportController_I4637();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_32_PAK_DATE)
            m_exportController   = TF711KlikoExportController_32_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_27_PAK_DATE)
            m_exportController = TF711KlikoExportController_27_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_24_PAK_DATE)
            m_exportController = TF711KlikoExportController_24_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_23_PAK_DATE)
            m_exportController = TF711KlikoExportController_23_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_22_PAK_DATE)
            m_exportController = TF711KlikoExportController_22_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_F711_19_PAK_DATE)
            m_exportController = TF711KlikoExportController_19_PAK();
            m_protocolContorller = TExportProtocolController_22_PAK();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_I3129_DATE2)
            m_exportController = TF711KlikoExportController_I3129();
            m_protocolContorller = TExportProtocolController_I3129();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_I2627_DATE)
            m_exportController = TKlikoExport_I2627();
            m_protocolContorller = TExportProtocolController_I2627();
        elif (RcbApplication().currentReport.context.period.endDate >= RCB_I2055_DATE2)
            m_exportController = TKlikoExport_I2055();
            m_protocolContorller = TExportProtocolController_I2055();
        else
            m_exportController = TKlikoExport_I1841();
            m_protocolContorller = TExportProtocolController_I1841();
        end;
    end;

    constructorTExportController();
end;

macro showKlikoExportProtocol(commandLineArguments : String)
    TExportController().showProtocol();
end;

macro executeKlikoExportOperation()
    var controller = TExportController();
    controller.export();
    controller.showProtocol();
end;

УстановитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
