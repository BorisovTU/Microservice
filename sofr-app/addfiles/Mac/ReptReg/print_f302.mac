/*
$Name:          print_f302.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 302. Печать отчета.
*/


/* ──────────────────────────────────────────────────────────────────────────┐
   RS-Bank V6                                                 R-Style Softlab
   Файл подсистемы "Регламентированная отчетность"

   Печать отчета. Форма 302

   CREATED : 28.08.07 Ser.
└─────────────────────────────────────────────────────────────────────────- */
/*
 *  Общебанковские интеры и модули
 */
import reptcbInter;
import param;
/*
 *  Интеры и модели подсистемы
 */
import rcbCoreInter;
import rcbConst;
import treport;
import rcbimport;

/***************************************************************************************************
 *  Класс для сортировки итератора по значениям переменной раздела
 **************************************************************************************************/
private class TSorter
    /*
     * Количество символов в группе (между разделителями)
     */
    const m_amountNumberInGroup = 2;

    /*
     * Поиск количества вхождений символа symbol в строку str
     */
    private macro findSymbolStr(str : String, symbol : String)
        var lenStr = strLen(str);
        var i = 1;
        var res = 0;
        while(i <= lenStr)
            if(subStr(str, i, 1) == symbol)
                res = res + 1;
            end;
        i = i + 1;
        end;
        return res;
    end;

    /*
     * Нормализация строки: строка разбивается на группы по разделителю
     * Каждая группа дополняется символом "0" слева до длины countNumberInGroup
     * Возвращает строку, собранную уже из коректных групп без разделителя
     */
    private macro correctRowNumber(rowNumber : String, amountGroup : Integer)
        var i;
        var arr = TArray;
        arr = strCut(rowNumber, ".");
        i = 0;
        while(i < amountGroup)
            if(valType(arr[i]) == V_UNDEF)
                arr[i] = "";
            end;
            arr[i] = strLpad(arr[i], m_amountNumberInGroup, "0");
            i = i + 1;
        end;
        return strAssemble(arr);
    end;

    /*
     * Функция сравнения строк
     * amountGroup - количество групп для сравнения строк
     */
    private macro compareStr(rowNumber1 : String, rowNumber2 : String)
        var amountGroupInRowNumber1 = findSymbolStr(rowNumber1, ".") + 1;
        var amountGroupInRowNumber2 = findSymbolStr(rowNumber2, ".") + 1;
        var amountGroup = ternary(amountGroupInRowNumber1 > amountGroupInRowNumber2, amountGroupInRowNumber1, amountGroupInRowNumber2);

        return correctRowNumber(rowNumber1, amountGroup) < correctRowNumber(rowNumber2, amountGroup)
    end;

    /*
     * Функция сортировки
     */
    macro isLess(v1, v2)
        return (v1.fieldValue("okatoCode").currentAsString < v2.fieldValue("okatoCode").currentAsString)
            or (     (v1.fieldValue("okatoCode").currentAsString == v2.fieldValue("okatoCode").currentAsString)
                 and (compareStr(v1.fieldValue("row").currentAsString, v2.fieldValue("row").currentAsString)));
    end;
end;

/***************************************************************************************************
 *  Переопределение метода вывода нижней части отчета в соответствии ТЗ (#165096)
 ***************************************************************************************************/
class (TSignatureZone) TSignatureZone302
    initTSignatureZone();
    macro print(reportWidth)
        var datePrintableReport = string(m_reportIssueDate : f : m);

        var lenFPA = strLen(m_firstPersonAppointment);
        var lenSPA = strLen(m_secondPersonAppointment);
        var lenEx  = strLen("Исполнитель");
        var lenPh  = strLen("Телефон:");
        var lenDPR = strLen(datePrintableReport);
        var maxLen = max(
                         max(lenFPA,lenSPA),
                         max(lenEx,
                             max(lenPh,lenDPR)
                            )
                        ) + 4;
        println();
        println(strAlign(m_firstPersonAppointment  + mkstr(" ", maxLen - lenFPA) + m_firstPersonName,  reportWidth, STR_ALIGN_LEFT));
        println(strAlign(m_secondPersonAppointment + mkstr(" ", maxLen - lenSPA) + m_secondPersonName, reportWidth, STR_ALIGN_LEFT));
        println(strAlign("Исполнитель"             + mkstr(" ", maxLen - lenEx)  + m_executorName  ,   reportWidth, STR_ALIGN_LEFT));
        println(strAlign("Телефон:"                + mkstr(" ", maxLen - lenPh)  + m_executorPhoneNumber, reportWidth, STR_ALIGN_LEFT));
        println(strAlign(datePrintableReport, reportWidth, STR_ALIGN_LEFT));
    end;
end;

/***************************************************************************************************
 *  Базовый класс печати шапки и дна отчета до 2055У
 **************************************************************************************************/
class TPrinter()
    macro printHeader( )
        var m_view = RcbReportView("СВЕДЕНИЯ О РАЗМЕЩЕННЫХ И ПРИВЛЕЧЕННЫХ СРЕДСТВАХ КРЕДИТНЫХ ОРГАНИЗАЦИЙ",
                                "0409302", "Месячная", DATE_OUT_PERIOD_FORMAT);

        m_view.setReportWidth(194);

        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();

    end;

    macro printBottom()
        var signatureZone = TSignatureZone302();
        signatureZone.print(100);
    end;
end;

/***************************************************************************************************
 *  Базовый класс печати шапки и дна отчета после 2055У
 **************************************************************************************************/
class (TPrinter)TPrinter2055()
    initTPrinter();
end;
/***************************************************************************************************
 *  Базовый класс печати шапки и дна отчета после 2332У
 **************************************************************************************************/
class (TPrinter2055)TPrinter2332()
    macro printHeader( )
        var m_view = RcbReportView("СВЕДЕНИЯ О РАЗМЕЩЕННЫХ И ПРИВЛЕЧЕННЫХ СРЕДСТВАХ КРЕДИТНЫХ ОРГАНИЗАЦИЙ",
                                "0409302", "Месячная", DATE_OUT_PERIOD_FORMAT);

        m_view.setReportWidth(194);

        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();
    end;

    initTPrinter2055();
end;

/**
 * Базовый класс печати шапки и подвала отчета в соответствии с 2470-У
 *
 * @since v.6.20.029.153
 * @version 1.0
 * @author ABP
 */
private class (TPrinter2332) TPrinter2470()

    private macro constructorTPrinter2470()
        initTPrinter2332();
    end;

    constructorTPrinter2470();
end;

/**
 * Базовый класс печати шапки и подвала отчета в соответствии с 2742-У
 *
 * @since v.6.20.030.050
 * @version 1.0
 * @author ABP
 */
private class (TPrinter2470) TPrinter2742()
    macro printHeader( )
        var m_view = RcbReportView("СВЕДЕНИЯ О РАЗМЕЩЕННЫХ И ПРИВЛЕЧЕННЫХ СРЕДСТВАХ",
                                   "0409302",
                                   "Месячная",
                                   DATE_OUT_PERIOD_FORMAT);

        m_view.setReportWidth(194);

        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone();
    end;

    private macro constructorTPrinter2742()
        initTPrinter2470();
    end;

    constructorTPrinter2742();
end;

private class (TPrinter2742) TPrinter4212()
    macro printHeader( )
        var m_view = RcbReportView("СВЕДЕНИЯ О РАЗМЕЩЕННЫХ И ПРИВЛЕЧЕННЫХ СРЕДСТВАХ",
                                   "0409302",
                                   "Месячная",
                                   DATE_OUT_PERIOD_FORMAT);

        m_view.setReportWidth(194);

        m_view.printLendingAgencyCodeZone();
        m_view.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации ");
    end;

    private macro constructorTPrinter4212()
        initTPrinter2742();
    end;

    constructorTPrinter2742();
end;

private class (TPrinter4212) TPrinter4637()
    macro printBottom()
        var signatureZone = TSignatureZone_4212();
        signatureZone.excludeAttribute(AC_SECOND_PERSON);
        signatureZone.print(100);
    end;

    private macro constructorTPrinter4637()
        initTPrinter4212();
    end;

    constructorTPrinter4637();
end;

/***************************************************************************************************
 *  Базовый класс печати отчета
 **************************************************************************************************/
private class TReportPrinter()
    private var m_report   : Object = NULL;
    private var m_rowsList : Object = NULL; /*список строк, которые необходимо выводить по каждому ОКАТО*/

    private macro initialize()
    end;

    private macro getNameRow(rowNumber : String)
        msgBox("Ошибка! Вызов чисто виртуального метода.");
    end;

    private macro printZeroRow(rowNumber : String, okatoCode_ : String)
        msgBox("Ошибка! Вызов чисто виртуального метода.");
    end;

    private macro printRow(compositeValue : Object)
        msgBox("Ошибка! Вызов чисто виртуального метода.");
    end;

    private macro getNamePart() : String
        msgBox("Ошибка! Вызов чисто виртуального метода.");
    end;

    macro print()
        printLn(" Нет данных для отчета");
    end;

    private macro processOkato(compositeValue_ : Object)
        var i              = 0;
        var iterator       = compositeValue_.createValueIterator();
        var compositeValue = NULL;

        iterator.setSortOrder(TSorter());

        iterator.moveFirst();
        while (not iterator.isDone())
            compositeValue = iterator.currentItem;
            while ((i < m_rowsList.size) and (m_rowsList[i] != compositeValue.fieldValue("row").currentAsString))
                printZeroRow(m_rowsList[i], compositeValue.fieldValue("okatoCode").currentAsString);
                i = i + 1;
            end;

            printRow(compositeValue);

            i = i + 1;
            iterator.moveNext();
        end;
        while (i < m_rowsList.size)
            printZeroRow(m_rowsList[i], compositeValue.fieldValue("okatoCode").currentAsString);
            i = i + 1;
        end;
    end;

    initialize();
end;

/***************************************************************************************************
 *  Класс печати первого приложения до 1948У
 **************************************************************************************************/
private class (TReportPrinter) TPart1ReportPrinter()
    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",                 5, AL_LEFT);
        m_report.addColumn("Наименование",         48, AL_LEFT);
        m_report.addColumn("ОКАТО",                14, AL_LEFT);
        m_report.addColumn("Кредиты|рубли",        14, AL_RIGHT);
        m_report.addColumn("Кредиты|валюта",       14, AL_RIGHT);
        m_report.addColumn("Задолженность|рубли",  15, AL_RIGHT);
        m_report.addColumn("Задолженность|валюта", 16, AL_RIGHT);
        m_report.addColumn("Просрочка|рубли",      18, AL_RIGHT);
        m_report.addColumn("Просрочка|валюта",     18, AL_RIGHT);
        m_report.addColumn("Срок|рубли",           14, AL_RIGHT);
        m_report.addColumn("Срок|валюта",          14, AL_RIGHT);
        m_report.addColumn("Проценты|рубли",       14, AL_RIGHT);
        m_report.addColumn("Проценты|валюта",      14, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "2.1";
        m_rowsList[m_rowsList.size] = "2.1.1";
        m_rowsList[m_rowsList.size] = "2.2";
        m_rowsList[m_rowsList.size] = "2.3";
        m_rowsList[m_rowsList.size] = "2.4";
        m_rowsList[m_rowsList.size] = "2.5";
        m_rowsList[m_rowsList.size] = "2.6";
        m_rowsList[m_rowsList.size] = "2.7";
        m_rowsList[m_rowsList.size] = "2.8";
        m_rowsList[m_rowsList.size] = "2.9";
        m_rowsList[m_rowsList.size] = "2.10";
        m_rowsList[m_rowsList.size] = "3";
        m_rowsList[m_rowsList.size] = "4";
        m_rowsList[m_rowsList.size] = "4.1";
        m_rowsList[m_rowsList.size] = "4.1.1";
    end;

    private macro printBottom()
        printLn();
    end;

    private macro printTableHeader( )
        [ ################################################################################################################################################################################################################################################################ ](getNamePart():c);
        [                                                                                                                                                                                                                                                                  ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬────────────────────────────────────┬─────────────────────────────────────────┬─────────────────────────────────┬─────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │   Код места    │Объем предоставленных кредитов в │ Задолженность по предоставленным   │Просроченная задолженность по предостав- │      Средневзвешенный срок      │  Средневзвешенная процентная    │];
        [│  п/п  │                                                  │   нахождения   │   отчетном периоде, тыс. руб.   │кредитам на отчетную дату, тыс. руб.│ленным кредитам на отчетную дату, т.руб. │      кредитования, месяцев      │       ставка, процентов         │];
        [│       │                                                  │    заемщика    ├────────────────┬────────────────┼─────────────────┬──────────────────┼────────────────────┬────────────────────┼────────────────┬────────────────┼────────────────┬────────────────┤];
        [│       │                                                  │  (операционных │в валюте Россий-│ в иностранной  │в валюте Россий- │ в иностранной    │в валюте Российской │   в иностранной    │    в валюте    │ в иностранной  │    в валюте    │ в иностранной  │];
        [│       │                                                  │   офисов) по   │ ской Федерации │валюте и драго- │ ской Федерации  │валюте и драго-   │      Федерации     │  валюте и драго-   │   Российской   │валюте и драго- │   Российской   │валюте и драго- │];
        [│       │                                                  │     ОКАТО      │                │ценных металлах │                 │ценных металлах   │                    │  ценных металлах   │    Федерации   │ценных металлах │    Федерации   │ценных металлах │];
        [│       │                                                  │                │                │                │                 │                  │                    │                    │                │                │                │                │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤];
        [│   1   │                        2                         │       3        │       4        │       5        │       6         │       7          │          8         │          9         │       10       │       11       │       12       │       13       │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┼────────────────┼────────────────┼────────────────┼────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Предоставлено кредитов, всего, в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам (сумма строк с 2.1 по 2.10), из них:";
        elif (rowNumber == "2.1")
            return "добыча полезных ископаемых, в том числе:";
        elif (rowNumber == "2.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.2")
            return "обрабатывающие производства";
        elif (rowNumber == "2.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.4")
            return "сельское хозяйство, охота и лесное хозяйство";
        elif (rowNumber == "2.5")
            return "строительство";
        elif (rowNumber == "2.6")
            return "транспорт и связь";
        elif (rowNumber == "2.7")
            return "оптовая и розничная торговля; ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.8")
            return "операции с недвижимым имуществом, аренда, предоставление услуг";
        elif (rowNumber == "2.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.10")
            return "на завершение расчетов";
        elif (rowNumber == "3")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "4")
            return "Физическим лицам, из них:";
        elif (rowNumber == "4.1")
            return "на покупку жилья, в том числе:";
        elif (rowNumber == "4.1.1")
            return "ипотечные жилищные кредиты";
        elif (rowNumber == "5")
            return "Предоставлено кредитов операционными офисами";
        end;
        return "";
    end;

    private macro printZeroRow(rowNumber : String, okatoCode_ : String)
        var okatoCode = okatoCode_;
        var cross     = strLPad("X", 7, " ");

        if (rowNumber == "1")
            okatoCode = cross;
        end;

        if (in(rowNumber, "4.1", "4.1.1", "5"))
            cross = "0.0";
        else
            cross  = strRPad("X", 7, " ");
        end;

        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0, 0, 0, 0, 0, cross, cross, cross, cross);
    end;

    private macro printRow(compositeValue : Object)
        macro correctValue(value : Double, rowNumber : String)
            if (in(rowNumber, "4.1", "4.1.1", "5"))
                return String(value:0:1);
            end;
            return strRPad("X", 7, " ");
        end;

        var okatoCode = compositeValue.fieldValue("okatoCode").currentAsString();
        var rowNumber = compositeValue.fieldValue("row").currentAsString();

        if (rowNumber == "1")
            okatoCode = strLPad("X", 7, " ");
        end;

        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber,
                                           getNameRow(rowNumber),
                                           okatoCode,
                                           compositeValue.fieldValue("roubleSum").currentAsString(),
                                           compositeValue.fieldValue("currencySum").currentAsString(),
                                           compositeValue.fieldValue("roubleDebt").currentAsString(),
                                           compositeValue.fieldValue("currencyDebt").currentAsString(),
                                           compositeValue.fieldValue("roubleDelayedDebt").currentAsString(),
                                           compositeValue.fieldValue("currencyDelayedDebt").currentAsString(),
                                           correctValue(compositeValue.fieldValue("roubleAveragePeriod").exactAsString(), rowNumber),
                                           correctValue(compositeValue.fieldValue("currencyAveragePeriod").exactAsString(), rowNumber),
                                           correctValue(compositeValue.fieldValue("rubAverageInterestRate").exactAsString(), rowNumber),
                                           correctValue(compositeValue.fieldValue("curAverageInterestRate").exactAsString(), rowNumber));
    end;

    macro print()
        var iterator         = RcbApplication().currentReport().attributeValue("Раздел1").createValueIterator();
        var compositeValue   = NULL;
        var isEmpty          = true;

        iterator.moveFirst();

        if (iterator.isDone())
            printLn("\n Нет данных");
        else
            isEmpty = false;

            printTableHeader();
            printRow(iterator.currentItem());

            iterator = iterator.currentItem().createValueIterator();

            iterator.setSortOrder(TSorter());
            iterator.moveFirst();
            while (not iterator.isDone())
                processOkato(iterator.currentItem());
                iterator.moveNext()
            end;
        end;
        if (iterator.count > 0)
            m_report.printSeparator();
            m_report.printString("", "Справочно:");
        end;

        iterator = RcbApplication().currentReport().attributeValue("Раздел1.Строка5").createValueIterator();
        iterator.setSortOrder(TSorter());

        iterator.moveFirst();
        while (not iterator.isDone())
            printRow(iterator.currentItem());
            iterator.moveNext();
        end;

        if ((iterator.count == 0) and not isEmpty)
            printZeroRow("5", "");
            m_report.printBottom();
        else
            m_report.printBottom();
        end;
    end;

    initTReportPrinter();
end;

/***************************************************************************************************
 *  Класс печати первого приложения после 1948У
 **************************************************************************************************/
private class (TPart1ReportPrinter) TPart1ReportPrinter1948()

    private macro getNamePart() : String
        return "Раздел 1. Предоставленные кредиты";
    end;

    initTPart1ReportPrinter();
end;

/***************************************************************************************************
 *  Класс печати первого приложения после 2055У
 **************************************************************************************************/
private class (TPart1ReportPrinter) TPart1ReportPrinter2055()
    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",                9, AL_LEFT);
        m_report.addColumn("Наименование",         48, AL_LEFT);
        m_report.addColumn("ОКАТО",                14, AL_LEFT);
        m_report.addColumn("Кредиты|рубли",        14, AL_RIGHT);
        m_report.addColumn("Кредиты|валюта",       14, AL_RIGHT);
        m_report.addColumn("Задолженность|рубли",  15, AL_RIGHT);
        m_report.addColumn("Задолженность|валюта", 16, AL_RIGHT);
        m_report.addColumn("Просрочка|рубли",      18, AL_RIGHT);
        m_report.addColumn("Просрочка|валюта",     18, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "2.1";
        m_rowsList[m_rowsList.size] = "2.1.1";
        m_rowsList[m_rowsList.size] = "2.1.1.1";
        m_rowsList[m_rowsList.size] = "2.1.2";
        m_rowsList[m_rowsList.size] = "2.1.3";
        m_rowsList[m_rowsList.size] = "2.1.4";
        m_rowsList[m_rowsList.size] = "2.1.5";
        m_rowsList[m_rowsList.size] = "2.1.6";
        m_rowsList[m_rowsList.size] = "2.1.7";
        m_rowsList[m_rowsList.size] = "2.1.8";
        m_rowsList[m_rowsList.size] = "2.1.9";
        m_rowsList[m_rowsList.size] = "2.2";
        m_rowsList[m_rowsList.size] = "2.3";
        m_rowsList[m_rowsList.size] = "2.3.1";
        m_rowsList[m_rowsList.size] = "3";
    end;

    private macro getNamePart() : String
        return "Раздел 1. Предоставленные кредиты";
    end;

    private macro printBottom()
        printLn();
    end;

    private macro printTableHeader( )
        [ ################################################################################################################################################################################################################################################################ ](getNamePart():c);
        [                                                                                                                                                                                                                                                                  ];
        [┌───────────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬────────────────────────────────────┬─────────────────────────────────────────┐];
        [│   Номер   │      Наименование показателя                     │ Код территории │Объем предоставленных кредитов в │ Задолженность по предоставленным   │Просроченная задолженность по предостав- │];
        [│    п/п    │                                                  │ места нахожде- │   отчетном периоде, тыс. руб.   │на отчетную дату кредитам, тыс. руб.│ленным на отчетную дату кредитам, т.руб. │];
        [│           │                                                  │  ния заемщика  ├────────────────┬────────────────┼─────────────────┬──────────────────┼────────────────────┬────────────────────┤];
        [│           │                                                  │  (операционных │в валюте Россий-│ в иностранной  │в валюте Россий- │ в иностранной    │в валюте Российской │   в иностранной    │];
        [│           │                                                  │   офиссов) по  │ ской Федерации │валюте и драго- │ ской Федерации  │валюте и драго-   │      Федерации     │  валюте и драго-   │];
        [│           │                                                  │      ОКАТО     │                │ценных металлах │                 │ценных металлах   │                    │  ценных металлах   │];
        [│           │                                                  │                │                │                │                 │                  │                    │                    │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
        [│     1     │                        2                         │        3       │       4        │       5        │       6         │       7          │          8         │          9         │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Предоставлено кредитов, всего, в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам и индивидуальным предпринимателям (строка  2.1 + 2.2), в том числе:";
        elif (rowNumber == "2.1")
            return "По видам экономической деятельности:";
        elif (rowNumber == "2.1.1")
            return "добыча полезных ископаемых, из них:";
        elif (rowNumber == "2.1.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.1.2")
            return "обрабатывающие производства";
        elif (rowNumber == "2.1.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.1.4")
            return "сельское хозяйство, охота и лесное хозяйство";
        elif (rowNumber == "2.1.5")
            return "строительство";
        elif (rowNumber == "2.1.6")
            return "транспорт и связь";
        elif (rowNumber == "2.1.7")
            return "оптовая и розничная торговля; ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.1.8")
            return "операции с недвижимым имуществом, аренда, предоставление услуг";
        elif (rowNumber == "2.1.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.2")
            return "на завершение расчетов";
        elif (rowNumber == "2.3")
            return "из общей величины кредитов, предоставленных юридическим лицам и индивидуальным предпринимателям, кредиты субъектам малого и среднего предпринимательства, из них:";
        elif (rowNumber == "2.3.1")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "3")
            return "Физическим лицам";
        elif (rowNumber == "4")
            return "Справочно: предоставлено кредитов операционными офисами";
        end;
        return "";
    end;

    private macro printZeroRow(rowNumber : String, okatoCode_ : String)
        var okatoCode = okatoCode_;
        var cross     = strLPad("X", 7, " ");

        if (rowNumber == "1")
            okatoCode = cross;
        end;

        if (rowNumber == "4")
            cross = "0.0";
        else
            cross  = strRPad("X", 7, " ");
        end;

        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0, 0, 0, 0, 0);
    end;

    private macro printRow(compositeValue : Object)
        macro correctValue(value : Double, rowNumber : String)
            if (rowNumber == "4")
                return String(value:0:1);
            end;
            return strRPad("X", 7, " ");
        end;

        var okatoCode = compositeValue.fieldValue("okatoCode").currentAsString();
        var rowNumber = compositeValue.fieldValue("row").currentAsString();

        if (rowNumber == "1")
            okatoCode = strLPad("X", 7, " ");
        end;

        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber,
                                           getNameRow(rowNumber),
                                           okatoCode,
                                           compositeValue.fieldValue("roubleSum").currentAsString(),
                                           compositeValue.fieldValue("currencySum").currentAsString(),
                                           compositeValue.fieldValue("roubleDebt").currentAsString(),
                                           compositeValue.fieldValue("currencyDebt").currentAsString(),
                                           compositeValue.fieldValue("roubleDelayedDebt").currentAsString(),
                                           compositeValue.fieldValue("currencyDelayedDebt").currentAsString());
    end;

    private macro isNullData(compositeValue)
        if(   (compositeValue.fieldValue("roubleSum").scaled != 0)
           or (compositeValue.fieldValue("currencySum").scaled != 0)
           or (compositeValue.fieldValue("roubleDebt").scaled != 0)
           or (compositeValue.fieldValue("currencyDebt").scaled != 0)
           or (compositeValue.fieldValue("roubleDelayedDebt").scaled != 0)
           or (compositeValue.fieldValue("currencyDelayedDebt").scaled != 0))
            return false;
        else
            return true;
        end;
    end;

    macro print()
        var iterator       = RcbApplication().currentReport().attributeValue("Раздел1").createValueIterator();
        var isEmpty        = true;
        var row1Attribute;
        var row4Attribute;

        iterator.moveFirst();

        if (iterator.isDone())
            printLn("\n Раздел1. Нет данных");
        else
            row1Attribute = iterator.currentItem();

            if (not isNullData(row1Attribute))
                isEmpty = false;
                printTableHeader();
                printRow(row1Attribute);

                iterator = row1Attribute.createValueIterator();

                iterator.setSortOrder(TSorter());
                iterator.moveFirst();

                while (not iterator.isDone())
                    if (not isNullData(iterator.currentItem()))
                        processOkato(iterator.currentItem());
                    end;

                    iterator.moveNext();

                    if (not iterator.isDone())
                        m_report.printSeparator();
                    end;
                end;
            end;
        end;

        if (not isEmpty)
            m_report.printBottom();
        end;
    end;

    initTPart1ReportPrinter();
end;

/***************************************************************************************************
 *  Класс печати первого раздела после 2183У
 **************************************************************************************************/
private class (TPart1ReportPrinter2055) TPart1ReportPrinter2183()

    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",                9,  AL_LEFT);
        m_report.addColumn("Наименование",         48, AL_LEFT);
        m_report.addColumn("ОКАТО",                14, AL_LEFT);
        m_report.addColumn("Кредиты|рубли",        14, AL_RIGHT);
        m_report.addColumn("Кредиты|валюта",       14, AL_RIGHT);
        m_report.addColumn("Задолженность|рубли",  15, AL_RIGHT);
        m_report.addColumn("Задолженность|валюта", 16, AL_RIGHT);
        m_report.addColumn("Просрочка|рубли",      18, AL_RIGHT);
        m_report.addColumn("Просрочка|валюта",     18, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "2.1";
        m_rowsList[m_rowsList.size] = "2.1.1";
        m_rowsList[m_rowsList.size] = "2.1.1.1";
        m_rowsList[m_rowsList.size] = "2.1.2";
        m_rowsList[m_rowsList.size] = "2.1.2.1";
        m_rowsList[m_rowsList.size] = "2.1.2.2";
        m_rowsList[m_rowsList.size] = "2.1.2.3";
        m_rowsList[m_rowsList.size] = "2.1.2.4";
        m_rowsList[m_rowsList.size] = "2.1.2.5";
        m_rowsList[m_rowsList.size] = "2.1.2.6";
        m_rowsList[m_rowsList.size] = "2.1.2.7";
        m_rowsList[m_rowsList.size] = "2.1.2.8";
        m_rowsList[m_rowsList.size] = "2.1.2.8.1";
        m_rowsList[m_rowsList.size] = "2.1.2.9";
        m_rowsList[m_rowsList.size] = "2.1.2.9.1";
        m_rowsList[m_rowsList.size] = "2.1.3";
        m_rowsList[m_rowsList.size] = "2.1.4";
        m_rowsList[m_rowsList.size] = "2.1.4.1";
        m_rowsList[m_rowsList.size] = "2.1.5";
        m_rowsList[m_rowsList.size] = "2.1.5.1";
        m_rowsList[m_rowsList.size] = "2.1.6";
        m_rowsList[m_rowsList.size] = "2.1.6.1";
        m_rowsList[m_rowsList.size] = "2.1.7";
        m_rowsList[m_rowsList.size] = "2.1.8";
        m_rowsList[m_rowsList.size] = "2.1.9";
        m_rowsList[m_rowsList.size] = "2.2";
        m_rowsList[m_rowsList.size] = "2.3";
        m_rowsList[m_rowsList.size] = "2.3.1";
        m_rowsList[m_rowsList.size] = "3";
        m_rowsList[m_rowsList.size] = "4";
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Предоставлено кредитов, всего, в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам и индивидуальным предпринимателям (строка  2.1 + 2.2), в том числе:";
        elif (rowNumber == "2.1")
            return "По видам экономической деятельности:";
        elif (rowNumber == "2.1.1")
            return "добыча полезных ископаемых, из них:";
        elif (rowNumber == "2.1.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.1.2")
            return "обрабатывающие производства";
        elif (rowNumber == "2.1.2.1")
            return "производство пищевых продуктов, включая напитки и табак";
        elif (rowNumber == "2.1.2.2")
            return "обработка древесины и производство изделий из дерева";
        elif (rowNumber == "2.1.2.3")
            return "целлюлозно-бумажное производство; издательская и полиграфическая деятельность";
        elif (rowNumber == "2.1.2.4")
            return "производство кокса, нефтепродуктов и ядерных материалов";
        elif (rowNumber == "2.1.2.5")
            return "химическое производство";
        elif (rowNumber == "2.1.2.6")
            return "производство прочих неметаллических минеральных продуктов";
        elif (rowNumber == "2.1.2.7")
            return "металлургическое производство и производство готовых металлических изделий";
        elif (rowNumber == "2.1.2.8")
            return "производство машин и оборудования, в том числе:";
        elif (rowNumber == "2.1.2.8.1")
            return "производство машин и оборудования для сельского и лесного хозяйства";
        elif (rowNumber == "2.1.2.9")
            return "производство транспортных средств и оборудования, в том числе:";
        elif (rowNumber == "2.1.2.9.1")
            return "производство автомобилей";
        elif (rowNumber == "2.1.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.1.4")
            return "сельское хозяйство, охота и лесное хозяйство, в том числе:";
        elif (rowNumber == "2.1.4.1")
            return "сельское хозяйство, охота и предоставление услуг в этих областях";
        elif (rowNumber == "2.1.5")
            return "Строительство, из них";
        elif (rowNumber == "2.1.5.1")
            return "строительство зданий и сооружений";
        elif (rowNumber == "2.1.6")
            return "транспорт и связь, из них";
        elif (rowNumber == "2.1.6.1")
            return "деятельность воздушного транспорта, подчиняющегося и не подчиняющегося расписанию";
        elif (rowNumber == "2.1.7")
            return "оптовая и розничная торговля; ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.1.8")
            return "операции с недвижимым имуществом, аренда, предоставление услуг";
        elif (rowNumber == "2.1.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.2")
            return "на завершение расчетов";
        elif (rowNumber == "2.3")
            return "из общей величины кредитов, предоставленных юридическим лицам и индивидуальным предпринимателям, кредиты субъектам малого и среднего предпринимательства, из них:";
        elif (rowNumber == "2.3.1")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "3")
            return "Физическим лицам";
        elif (rowNumber == "4")
            return "Справочно: предоставлено кредитов операционными офисами";
        end;
        return "";
    end;

    initTPart1ReportPrinter2055();
end;

/***************************************************************************************************
 *  Класс печати первого раздела после 2332У
 **************************************************************************************************/
private class (TPart1ReportPrinter2183) TPart1ReportPrinter2332()

    private macro getNamePart() : String
        return "Раздел 1. Размещенные средства";
    end;

    private macro printTableHeader( )
        [ ################################################################################################################################################################################################################################################################ ](getNamePart():l);
        [                                                                                                                                                                                                                                                                  ];
        [┌───────────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────┐];
        [│   Номер   │                  Наименование                    │ Код территории │     Объем предоставленных       │                     Задолженность по предоставленным                         │];
        [│   строки  │                  показателя                      │ места нахожде- │    в отчетном периоде кредитов  │                         на отчетную дату кредитам                            │];
        [│           │                                                  │  ния заемщика  ├────────────────┬────────────────┼─────────────────┬──────────────────┬─────────────────────────────────────────┤];
        [│           │                                                  │  (операционных │в валюте Россий-│ в иностранной  │в валюте Россий- │ в иностранной    │         в том числе: просроченная       │];
        [│           │                                                  │   офиссов) по  │ ской Федерации │валюте и драго- │ ской Федерации  │валюте и драго-   ├────────────────────┬────────────────────┤];
        [│           │                                                  │      ОКАТО     │                │ценных металлах │                 │ценных металлах   │в валюте Российской │в иностранной валюте│];
        [│           │                                                  │                │                │                │                 │                  │ Федерации          │и драгоценных       │];
        [│           │                                                  │                │                │                │                 │                  │                    │металлах            │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
        [│     1     │                        2                         │        3       │       4        │       5        │       6         │       7          │          8         │          9         │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Предоставлено кредитов, всего (стр. 2 + стр. 3), в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам и индивидуальным предпринимателям (стр.  2.1 + стр. 2.2), в том числе:";
        elif (rowNumber == "2.1")
            return "по видам экономической деятельности:";
        elif (rowNumber == "2.1.1")
            return "добыча полезных ископаемых, из них:";
        elif (rowNumber == "2.1.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.1.2")
            return "обрабатывающие производства, из них:";
        elif (rowNumber == "2.1.2.1")
            return "производство пищевых продуктов, включая напитки, и табака";
        elif (rowNumber == "2.1.2.2")
            return "обработка древесины и производство изделий из дерева";
        elif (rowNumber == "2.1.2.3")
            return "целлюлозно-бумажное производство, издательская и полиграфическая деятельность";
        elif (rowNumber == "2.1.2.4")
            return "производство кокса, нефтепродуктов и ядерных материалов";
        elif (rowNumber == "2.1.2.5")
            return "химическое производство";
        elif (rowNumber == "2.1.2.6")
            return "производство прочих неметаллических минеральных продуктов";
        elif (rowNumber == "2.1.2.7")
            return "металлургическое производство и производство готовых металлических изделий";
        elif (rowNumber == "2.1.2.8")
            return "производство машин и оборудования, из них:";
        elif (rowNumber == "2.1.2.8.1")
            return "производство машин и оборудования для сельского и лесного хозяйства";
        elif (rowNumber == "2.1.2.9")
            return "производство транспортных средств и оборудования, из них:";
        elif (rowNumber == "2.1.2.9.1")
            return "производство автомобилей";
        elif (rowNumber == "2.1.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.1.4")
            return "сельское хозяйство, охота и лесное хозяйство, из них:";
        elif (rowNumber == "2.1.4.1")
            return "сельское хозяйство, охота и предоставление услуг в этих областях";
        elif (rowNumber == "2.1.5")
            return "Строительство, из них";
        elif (rowNumber == "2.1.5.1")
            return "строительство зданий и сооружений";
        elif (rowNumber == "2.1.6")
            return "транспорт и связь, из них";
        elif (rowNumber == "2.1.6.1")
            return "деятельность воздушного транспорта, подчиняющегося и не подчиняющегося расписанию";
        elif (rowNumber == "2.1.7")
            return "оптовая и розничная торговля, ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.1.8")
            return "операции с недвижимым имуществом, аренда и предоставление услуг";
        elif (rowNumber == "2.1.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.2")
            return "на завершение расчетов";
        elif (rowNumber == "2.3")
            return "из общей величины кредитов, предоставленных юридическим лицам и индивидуальным предпринимателям, кредиты субъектам малого и среднего предпринимательства, из них:";
        elif (rowNumber == "2.3.1")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "3")
            return "Физическим лицам";
        elif (rowNumber == "4")
            return "Справочно: предоставлено кредитов операционными офисами";
        end;
        return "";
    end;

    initTPart1ReportPrinter2183();
end;

/**
 * Класс печати первого раздела отчета в соответствии с 2470-У
 *
 * @since v.6.20.029.153
 * @version 1.0
 * @author ABP
 */
private class (TPart1ReportPrinter2332) TPart1ReportPrinter2470()

    private macro printTableHeader( )
        [ ################################################################################################################################################################################################################################################################ ](getNamePart():l);
        [                                                                                                                                                                                                                                                                  ];
        [┌───────────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────┐];
        [│   Номер   │                  Наименование                    │ Код территории │     Объем предоставленных       │                     Задолженность по предоставленным                         │];
        [│   строки  │                  показателя                      │ места нахожде- │    в отчетном периоде кредитов  │                         на отчетную дату кредитам                            │];
        [│           │                                                  │  ния заемщика  ├────────────────┬────────────────┼─────────────────┬──────────────────┬─────────────────────────────────────────┤];
        [│           │                                                  │  (операционных │    в рублях    │ в иностранной  │    в рублях     │ в иностранной    │         в том числе: просроченная       │];
        [│           │                                                  │   офиссов) по  │                │валюте и драго- │                 │валюте и драго-   ├────────────────────┬────────────────────┤];
        [│           │                                                  │      ОКАТО     │                │ценных металлах │                 │ценных металлах   │      в рублях      │в иностранной валюте│];
        [│           │                                                  │                │                │                │                 │                  │                    │и драгоценных       │];
        [│           │                                                  │                │                │                │                 │                  │                    │металлах            │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
        [│     1     │                        2                         │        3       │       4        │       5        │       6         │       7          │          8         │          9         │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
    end;

    private macro constructorTPart1ReportPrinter2470()
        initTPart1ReportPrinter2332();
    end;

    constructorTPart1ReportPrinter2470();

end;

/**
 * Класс печати первого раздела отчета в соответствии с 2742-У
 *
 * @since v.6.20.030.050
 * @version 1.0
 * @author ABP
 */
private class (TPart1ReportPrinter2470) TPart1ReportPrinter2742()

    private macro constructorTPart1ReportPrinter2742()
        initTPart1ReportPrinter2470();
    end;

    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",                9,  AL_LEFT);
        m_report.addColumn("Наименование",         48, AL_LEFT);
        m_report.addColumn("ОКАТО",                14, AL_LEFT);
        m_report.addColumn("Кредиты|рубли",        14, AL_RIGHT);
        m_report.addColumn("Кредиты|валюта",       14, AL_RIGHT);
        m_report.addColumn("Задолженность|рубли",  15, AL_RIGHT);
        m_report.addColumn("Задолженность|валюта", 16, AL_RIGHT);
        m_report.addColumn("Просрочка|рубли",      18, AL_RIGHT);
        m_report.addColumn("Просрочка|валюта",     18, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "2.1";
        m_rowsList[m_rowsList.size] = "2.1.1";
        m_rowsList[m_rowsList.size] = "2.1.1.1";
        m_rowsList[m_rowsList.size] = "2.1.2";
        m_rowsList[m_rowsList.size] = "2.1.2.1";
        m_rowsList[m_rowsList.size] = "2.1.2.2";
        m_rowsList[m_rowsList.size] = "2.1.2.3";
        m_rowsList[m_rowsList.size] = "2.1.2.4";
        m_rowsList[m_rowsList.size] = "2.1.2.5";
        m_rowsList[m_rowsList.size] = "2.1.2.6";
        m_rowsList[m_rowsList.size] = "2.1.2.7";
        m_rowsList[m_rowsList.size] = "2.1.2.8";
        m_rowsList[m_rowsList.size] = "2.1.2.8.1";
        m_rowsList[m_rowsList.size] = "2.1.2.9";
        m_rowsList[m_rowsList.size] = "2.1.2.9.1";
        m_rowsList[m_rowsList.size] = "2.1.3";
        m_rowsList[m_rowsList.size] = "2.1.4";
        m_rowsList[m_rowsList.size] = "2.1.4.1";
        m_rowsList[m_rowsList.size] = "2.1.5";
        m_rowsList[m_rowsList.size] = "2.1.5.1";
        m_rowsList[m_rowsList.size] = "2.1.6";
        m_rowsList[m_rowsList.size] = "2.1.6.1";
        m_rowsList[m_rowsList.size] = "2.1.7";
        m_rowsList[m_rowsList.size] = "2.1.8";
        m_rowsList[m_rowsList.size] = "2.1.9";
        m_rowsList[m_rowsList.size] = "2.2";
        m_rowsList[m_rowsList.size] = "2.3";
        m_rowsList[m_rowsList.size] = "2.3.1";
        m_rowsList[m_rowsList.size] = "3";

    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Предоставлено кредитов, всего (стр. 2 + стр. 3), в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам и индивидуальным предпринимателям (стр.  2.1 + стр. 2.2), в том числе:";
        elif (rowNumber == "2.1")
            return "по видам экономической деятельности:";
        elif (rowNumber == "2.1.1")
            return "добыча полезных ископаемых, из них:";
        elif (rowNumber == "2.1.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.1.2")
            return "обрабатывающие производства, из них:";
        elif (rowNumber == "2.1.2.1")
            return "производство пищевых продуктов, включая напитки, и табака";
        elif (rowNumber == "2.1.2.2")
            return "обработка древесины и производство изделий из дерева";
        elif (rowNumber == "2.1.2.3")
            return "целлюлозно-бумажное производство, издательская и полиграфическая деятельность";
        elif (rowNumber == "2.1.2.4")
            return "производство кокса, нефтепродуктов и ядерных материалов";
        elif (rowNumber == "2.1.2.5")
            return "химическое производство";
        elif (rowNumber == "2.1.2.6")
            return "производство прочих неметаллических минеральных продуктов";
        elif (rowNumber == "2.1.2.7")
            return "металлургическое производство и производство готовых металлических изделий";
        elif (rowNumber == "2.1.2.8")
            return "производство машин и оборудования, из них:";
        elif (rowNumber == "2.1.2.8.1")
            return "производство машин и оборудования для сельского и лесного хозяйства";
        elif (rowNumber == "2.1.2.9")
            return "производство транспортных средств и оборудования, из них:";
        elif (rowNumber == "2.1.2.9.1")
            return "производство автомобилей";
        elif (rowNumber == "2.1.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.1.4")
            return "сельское хозяйство, охота и лесное хозяйство, из них:";
        elif (rowNumber == "2.1.4.1")
            return "сельское хозяйство, охота и предоставление услуг в этих областях";
        elif (rowNumber == "2.1.5")
            return "Строительство, из них";
        elif (rowNumber == "2.1.5.1")
            return "строительство зданий и сооружений";
        elif (rowNumber == "2.1.6")
            return "транспорт и связь, из них";
        elif (rowNumber == "2.1.6.1")
            return "деятельность воздушного транспорта, подчиняющегося и не подчиняющегося расписанию";
        elif (rowNumber == "2.1.7")
            return "оптовая и розничная торговля, ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.1.8")
            return "операции с недвижимым имуществом, аренда и предоставление услуг";
        elif (rowNumber == "2.1.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.2")
            return "на завершение расчетов";
        elif (rowNumber == "2.3")
            return "из общей величины кредитов, предоставленных юридическим лицам и индивидуальным предпринимателям, кредиты субъектам малого и среднего предпринимательства, из них:";
        elif (rowNumber == "2.3.1")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "3")
            return "Физическим лицам";
        end;
        return "";
    end;

    constructorTPart1ReportPrinter2742();
end;

/***************************************************************************************************
 *  Класс печати второго раздела до 1948У
 **************************************************************************************************/
private class (TReportPrinter) TPart2ReportPrinter()
    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",           5, AL_LEFT);
        m_report.addColumn("Наименование",   48, AL_LEFT);
        m_report.addColumn("ОКАТО",          14, AL_LEFT);
        m_report.addColumn("Объем|рубли",    14, AL_RIGHT);
        m_report.addColumn("Объем|валюта",   14, AL_RIGHT);
        m_report.addColumn("Остаток|рубли",  15, AL_RIGHT);
        m_report.addColumn("Остаток|валюта", 16, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "3";
    end;

    private macro getNamePart() : String
        return "Раздел 2. Привлеченные средства";
    end;

    private macro printTableHeader( )
        [ ################################################################################################################################################## ](getNamePart():l);
        [                                                                                                                                                    ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬────────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │   Код места    │Объем предоставленных средств в  │  Остаток привлеченных средств      │];
        [│  п/п  │                                                  │   привлечения  │       отчетном периоде          │       на отчетную дату, тыс. руб.  │];
        [│       │                                                  │    средств     ├────────────────┬────────────────┼─────────────────┬──────────────────┤];
        [│       │                                                  │       по       │в валюте Россий-│ в иностранной  │в валюте Россий- │ в иностранной    │];
        [│       │                                                  │     ОКАТО      │ ской Федерации │валюте и драго- │ ской Федерации  │валюте и драго-   │];
        [│       │                                                  │                │                │ценных металлах │                 │ценных металлах   │];
        [│       │                                                  │                │                │                │                 │                  │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┤];
        [│   1   │                        2                         │       3        │       4        │       5        │       6         │       7          │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства на счетах юридических лиц и индивидуальных предпринимателей";
        elif (rowNumber == "2")
            return "Депозиты юридических лиц";
        elif (rowNumber == "3")
            return "Вклады (депозиты) физических лиц";
        end;
        return "";
    end;

    private macro printZeroRow(rowNumber : String, okatoCode : String)
        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0, 0, 0);
    end;

    private macro printRow(compositeValue : Object)
        m_report.printSeparator();
        m_report.printStringTransferByWord(compositeValue.fieldValue("row").currentAsString(),
                                           getNameRow(compositeValue.fieldValue("row").currentAsString()),
                                           compositeValue.fieldValue("okatoCode").currentAsString(),
                                           compositeValue.fieldValue("roubleObtainedFundsSum").currentAsString(),
                                           compositeValue.fieldValue("currencyObtainedFundsSum").currentAsString(),
                                           compositeValue.fieldValue("rubObtainedFundsRest").currentAsString(),
                                           compositeValue.fieldValue("curObtainedFundsRest").currentAsString());
    end;

    macro print()
        var iterator        = RcbApplication().currentReport().attributeValue("Раздел2").createValueIterator();
        var compositeValue  = NULL;
        var isEmpty         = true;

        if (iterator.count == 0)
            printLn("\n Нет данных");
        else
            isEmpty = false;

            printTableHeader();

            iterator.setSortOrder(TSorter());
            iterator.moveFirst();
            while (not iterator.isDone())
                processOkato(iterator.currentItem());
                iterator.moveNext()
            end;
        end;

        if (not isEmpty)
            m_report.printBottom();
        end;

    end;

    initTReportPrinter();
end;

/***************************************************************************************************
 *  Класс печати второго раздела после 1948У
 **************************************************************************************************/
private class (TPart2ReportPrinter) TPart2ReportPrinter1948()
    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",           5, AL_LEFT);
        m_report.addColumn("Наименование",   48, AL_LEFT);
        m_report.addColumn("ОКАТО",          14, AL_LEFT);
        m_report.addColumn("Остаток|рубли",  15, AL_RIGHT);
        m_report.addColumn("Остаток|валюта", 16, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "2";
        m_rowsList[m_rowsList.size] = "3";
    end;

    private macro printTableHeader( )
        [                                                                                                                  ];
        [ ################################################################################################################ ](getNamePart():l);
        [                                                                                                         тыс.руб. ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬────────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │   Код места    │   Остаток привлеченных средств     │];
        [│  п/п  │                                                  │   привлечения  │       на отчетную дату             │];
        [│       │                                                  │    средств     ├─────────────────┬──────────────────┤];
        [│       │                                                  │       по       │в валюте Россий- │ в иностранной    │];
        [│       │                                                  │     ОКАТО      │ ской Федерации  │валюте и драго-   │];
        [│       │                                                  │                │                 │ценных металлах   │];
        [│       │                                                  │                │                 │                  │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
        [│   1   │                        2                         │       3        │       4         │       5          │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства клиентов (некредитных организаций)";
        elif (rowNumber == "2")
            return "Депозиты юридических лиц";
        elif (rowNumber == "3")
            return "Вклады (депозиты) физических лиц";
        end;
        return "";
    end;

    private macro printZeroRow(rowNumber : String, okatoCode : String)
        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0);
    end;

    private macro printRow(compositeValue : Object)
        m_report.printSeparator();
        m_report.printStringTransferByWord(compositeValue.fieldValue("row").currentAsString(),
                                           getNameRow(compositeValue.fieldValue("row").currentAsString()),
                                           compositeValue.fieldValue("okatoCode").currentAsString(),
                                           compositeValue.fieldValue("rubObtainedFundsRest").currentAsString(),
                                           compositeValue.fieldValue("curObtainedFundsRest").currentAsString());
    end;

    initTPart2ReportPrinter();
end;

/***************************************************************************************************
 *  Класс печати второго раздела после 2055У
 **************************************************************************************************/
private class (TPart2ReportPrinter) TPart2ReportPrinter2055()
    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",           5, AL_LEFT);
        m_report.addColumn("Наименование",   48, AL_LEFT);
        m_report.addColumn("ОКАТО",          14, AL_LEFT);
        m_report.addColumn("Остаток|рубли",  15, AL_RIGHT);
        m_report.addColumn("Остаток|валюта", 16, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "1.1";
        m_rowsList[m_rowsList.size] = "1.2";
    end;

    private macro printTableHeader( )
        [                                                                                                                  ];
        [ ################################################################################################################ ](getNamePart():l);
        [                                                                                                         тыс.руб. ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬────────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │   Код места    │   Остаток привлеченных средств     │];
        [│  п/п  │                                                  │   привлечения  │       на отчетную дату             │];
        [│       │                                                  │    средств     ├─────────────────┬──────────────────┤];
        [│       │                                                  │       по       │в валюте Россий- │ в иностранной    │];
        [│       │                                                  │     ОКАТО      │ ской Федерации  │валюте и драго-   │];
        [│       │                                                  │                │                 │ценных металлах   │];
        [│       │                                                  │                │                 │                  │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
        [│   1   │                        2                         │       3        │       4         │       5          │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства клиентов (некредитных организаций)";
        elif (rowNumber == "1.1")
            return "Депозиты юридических лиц";
        elif (rowNumber == "1.2")
            return "Вклады (депозиты) физических лиц";
        end;
        return "";
    end;

    private macro printZeroRow(rowNumber : String, okatoCode : String)
        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0);
    end;

    private macro printRow(compositeValue : Object)
        m_report.printSeparator();
        m_report.printStringTransferByWord(compositeValue.fieldValue("row").currentAsString(),
                                           getNameRow(compositeValue.fieldValue("row").currentAsString()),
                                           compositeValue.fieldValue("okatoCode").currentAsString(),
                                           compositeValue.fieldValue("rubObtainedFundsRest").currentAsString(),
                                           compositeValue.fieldValue("curObtainedFundsRest").currentAsString());
    end;

    initTPart2ReportPrinter();
end;


/***************************************************************************************************
 *  Класс печати второго раздела после 2183У
 **************************************************************************************************/
private class (TPart2ReportPrinter2055) TPart2ReportPrinter2183()
    initTPart2ReportPrinter2055();
end;

/***************************************************************************************************
 *  Класс печати второго раздела после 2332У
 **************************************************************************************************/
private class (TPart2ReportPrinter2183) TPart2ReportPrinter2332()
    private macro printTableHeader( )
        [                                                                                                                  ];
        [ ################################################################################################################ ](getNamePart():l);
        [                                                                                                                  ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬────────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │ Код территории │   Остаток привлеченных средств     │];
        [│ строки│                                                  │     места      │       на отчетную дату             │];
        [│       │                                                  │  привлечения   ├─────────────────┬──────────────────┤];
        [│       │                                                  │средств по ОКАТО│в валюте Россий- │ в иностранной    │];
        [│       │                                                  │                │ ской Федерации  │валюте и драго-   │];
        [│       │                                                  │                │                 │ценных металлах   │];
        [│       │                                                  │                │                 │                  │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
        [│   1   │                        2                         │       3        │       4         │       5          │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства клиентов, не являющихся кредитными организациями, из них:";
        elif (rowNumber == "1.1")
            return "Депозиты юридических лиц";
        elif (rowNumber == "1.2")
            return "Вклады (депозиты) физических лиц";
        end;
        return "";
    end;

    initTPart2ReportPrinter2183();
end;

/**
 * Класс печати второго раздела отчета в соответствии с 2470-У
 *
 * @since v.6.20.029.153
 * @version 1.0
 * @author ABP
 */
private class (TPart2ReportPrinter2332) TPart2ReportPrinter2470()
    private macro printTableHeader()
        [                                                                                                                  ];
        [ ################################################################################################################ ](getNamePart():l);
        [                                                                                                                  ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬────────────────────────────────────┐];
        [│ Номер │      Наименование показателя                     │ Код территории │   Остаток привлеченных средств     │];
        [│ строки│                                                  │     места      │       на отчетную дату             │];
        [│       │                                                  │  привлечения   ├─────────────────┬──────────────────┤];
        [│       │                                                  │средств по ОКАТО│     в рублях    │ в иностранной    │];
        [│       │                                                  │                │                 │валюте и драго-   │];
        [│       │                                                  │                │                 │ценных металлах   │];
        [│       │                                                  │                │                 │                  │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
        [│   1   │                        2                         │       3        │       4         │       5          │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼──────────────────┤];
    end;

    private macro constructorTPart2ReportPrinter2470()
        initTPart2ReportPrinter2332();
    end;

    constructorTPart2ReportPrinter2470();
end;

/**
 * Класс печати второго раздела отчета в соответствии с 2742-У
 *
 * @since v.6.20.030.050
 * @version 1.0
 * @author ABP
 */
private class (TPart2ReportPrinter2470) TPart2ReportPrinter2742()

    private macro constructorTPart2ReportPrinter2742()
        initTPart2ReportPrinter2470();
    end;

    private macro initialize()
        initialize();

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "1.1";
        m_rowsList[m_rowsList.size] = "1.2";
        m_rowsList[m_rowsList.size] = "1.3";
        m_rowsList[m_rowsList.size] = "1.4";
        m_rowsList[m_rowsList.size] = "1.5";
        m_rowsList[m_rowsList.size] = "1.6";
        m_rowsList[m_rowsList.size] = "1.7";
        m_rowsList[m_rowsList.size] = "1.8";
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства клиентов, не являющихся кредитными организациями, из них:";
        elif (rowNumber == "1.1")
            return "Средства федерального бюджета";
        elif (rowNumber == "1.2")
            return "Средства бюджетов субъектов Российской Федерации и местных бюджетов";
        elif (rowNumber == "1.3")
            return "Прочие бюджетные средства";
        elif (rowNumber == "1.4")
            return "Средства бюджетных фондов";
        elif (rowNumber == "1.5")
            return "Средства на счетах государственных организаций";
        elif (rowNumber == "1.6")
            return "Средства на счетах негосударственных организаций";
        elif (rowNumber == "1.7")
            return "Депозиты юридических лиц";
        elif (rowNumber == "1.8")
            return "Вклады (депозиты) физических лиц";
        end;

        return "";
    end;

    constructorTPart2ReportPrinter2742();
end;

private class (TPart2ReportPrinter2742) TPart2ReportPrinter2926()
    private macro constructorTPart2ReportPrinter2926()
        initTPart2ReportPrinter2742();
    end;

    private macro initialize()
        initialize();

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "1.1";
        m_rowsList[m_rowsList.size] = "1.2";
        m_rowsList[m_rowsList.size] = "1.3";
        m_rowsList[m_rowsList.size] = "1.4";
        m_rowsList[m_rowsList.size] = "1.5";
        m_rowsList[m_rowsList.size] = "1.6";
        m_rowsList[m_rowsList.size] = "1.7";
        m_rowsList[m_rowsList.size] = "1.8";
        m_rowsList[m_rowsList.size] = "1.9";
    end;

    private macro getNameRow(rowNumber : String)
        if (rowNumber == "1")
            return "Средства клиентов, не являющихся кредитными организациями, из них:";
        elif (rowNumber == "1.1")
            return "Средства федерального бюджета";
        elif (rowNumber == "1.2")
            return "Средства бюджетов субъектов Российской Федерации и местных бюджетов";
        elif (rowNumber == "1.3")
            return "Прочие бюджетные средства";
        elif (rowNumber == "1.4")
            return "Средства внебюджетных фондов";
        elif (rowNumber == "1.5")
            return "Средства на счетах государственных организаций";
        elif (rowNumber == "1.6")
            return "Средства на счетах негосударственных организаций";
        elif (rowNumber == "1.7")
            return "Средства индивидуальных предпринимателей";
        elif (rowNumber == "1.8")
            return "Депозиты юридических лиц";
        elif (rowNumber == "1.9")
            return "Вклады (депозиты) физических лиц";
        end;

        return "";
    end;

    constructorTPart2ReportPrinter2926();
end;

private class (TPart2ReportPrinter2926) TPart2ReportPrinter4637()
    private macro constructorTPart2ReportPrinter4637()
        initTPart2ReportPrinter2926();
    end;

    private macro initialize()
        m_report = CTableReport();
        m_report.addColumn("Номер",           5, AL_LEFT);
        m_report.addColumn("Наименование",   48, AL_LEFT);
        m_report.addColumn("ОКАТО",          14, AL_CENTER);
        m_report.addColumn("Остаток|всего",  15, AL_RIGHT);
        m_report.addColumn("Остаток|рубли",  15, AL_RIGHT);
        m_report.addColumn("Остаток|доллары",15, AL_RIGHT);
        m_report.addColumn("Остаток|евро",   15, AL_RIGHT);
        m_report.addColumn("Остаток|юани",   15, AL_RIGHT);

        m_rowsList = TArray();
        m_rowsList[m_rowsList.size] = "1";
        m_rowsList[m_rowsList.size] = "1.1";
        m_rowsList[m_rowsList.size] = "1.2";
        m_rowsList[m_rowsList.size] = "1.3";
        m_rowsList[m_rowsList.size] = "1.4";
        m_rowsList[m_rowsList.size] = "1.5";
        m_rowsList[m_rowsList.size] = "1.6";
        m_rowsList[m_rowsList.size] = "1.7";
        m_rowsList[m_rowsList.size] = "1.8";
        m_rowsList[m_rowsList.size] = "1.9";
    end;

    private macro printTableHeader()
        [                                                                                                                                                                       ];
        [ ##################################################################################################################################################################### ](getNamePart():l);
        [                                                                                                                                                                       ];
        [┌───────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┐];
        [│ Номер │             Наименование показателя              │ Код территории │                      Остаток привлеченных средств на отчетную дату                      │];
        [│ строки│                                                  │     места      ├─────────────────┬───────────────────────────────────────────────────────────────────────┤];
        [│       │                                                  │  привлечения   │      всего      │                                из них:                                │];
        [│       │                                                  │средств по ОКАТО│                 ├─────────────────┬─────────────────┬─────────────────┬─────────────────┤];
        [│       │                                                  │                │                 │    в рублях     │ в долларах США  │     в евро      │     в юанях     │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┤];
        [│   1   │                        2                         │       3        │        4        │        5        │        6        │        7        │        8        │];
        [├───────┼──────────────────────────────────────────────────┼────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┼─────────────────┤];
    end;

    private macro printZeroRow(rowNumber : String, okatoCode : String)
        m_report.printSeparator();
        m_report.printStringTransferByWord(rowNumber, getNameRow(rowNumber), okatoCode, 0, 0, 0, 0, 0);
    end;

    private macro printRow(compositeValue : Object)
        m_report.printSeparator();
        m_report.printStringTransferByWord(compositeValue.fieldValue("row").currentAsString(),
                                           getNameRow(compositeValue.fieldValue("row").currentAsString()),
                                           compositeValue.fieldValue("okatoCode").currentAsString(),
                                           compositeValue.fieldValue("obtainedFundsRestTotal").currentAsString(),
                                           compositeValue.fieldValue("obtainedFundsRest_643").currentAsString(),
                                           compositeValue.fieldValue("obtainedFundsRest_840").currentAsString(),
                                           compositeValue.fieldValue("obtainedFundsRest_978").currentAsString(),
                                           compositeValue.fieldValue("obtainedFundsRest_156").currentAsString());
    end;

    constructorTPart2ReportPrinter4637();
end;

private class (TPart1ReportPrinter2742) TPart1ReportPrinter2835()
    private macro printTableHeader( )
        [ ################################################################################################################################################################################################################################################################ ](getNamePart():l);
        [                                                                                                                                                                                                                                                                  ];
        [┌───────────┬──────────────────────────────────────────────────┬────────────────┬─────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────┐];
        [│   Номер   │                  Наименование                    │ Код территории │     Объем предоставленных       │                     Задолженность по предоставленным                         │];
        [│   строки  │                  показателя                      │ места нахожде- │    в отчетном периоде кредитов  │                         на отчетную дату кредитам                            │];
        [│           │                                                  │  ния заемщика  ├────────────────┬────────────────┼─────────────────┬──────────────────┬─────────────────────────────────────────┤];
        [│           │                                                  │    по ОКАТО    │    в рублях    │ в иностранной  │    в рублях     │  в иностранной   │         в том числе: просроченная       │];
        [│           │                                                  │                │                │валюте и драго- │                 │ валюте и драго-  ├────────────────────┬────────────────────┤];
        [│           │                                                  │                │                │ценных металлах │                 │ ценных металлах  │      в рублях      │в иностранной валюте│];
        [│           │                                                  │                │                │                │                 │                  │                    │   и драгоценных    │];
        [│           │                                                  │                │                │                │                 │                  │                    │      металлах      │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
        [│     1     │                        2                         │        3       │       4        │       5        │       6         │       7          │          8         │          9         │];
        [├───────────┼──────────────────────────────────────────────────┼────────────────┼────────────────┼────────────────┼─────────────────┼──────────────────┼────────────────────┼────────────────────┤];
    end;

    private macro constructorTPart1ReportPrinter2835()
        initTPart1ReportPrinter2742();
    end;

    constructorTPart1ReportPrinter2835();
end;

private class (TPart1ReportPrinter2835) TPart1ReportPrinter4212()
    private macro getNameRow(rowNumber : String)
        if   (rowNumber == "1")
            return "Предоставлено кредитов - всего (сумма строк 2, 3), в том числе:";
        elif (rowNumber == "2")
            return "Юридическим лицам и индивидуальным предпринимателям (сумма строк 2.1, 2.2), в том числе:";
        elif (rowNumber == "2.1")
            return "по видам экономической деятельности:";
        elif (rowNumber == "2.1.1")
            return "добыча полезных ископаемых, из них:";
        elif (rowNumber == "2.1.1.1")
            return "добыча топливно-энергетических полезных ископаемых";
        elif (rowNumber == "2.1.2")
            return "обрабатывающие производства, из них:";
        elif (rowNumber == "2.1.2.1")
            return "производство пищевых продуктов, включая напитки, и табака";
        elif (rowNumber == "2.1.2.2")
            return "обработка древесины и производство изделий из дерева";
        elif (rowNumber == "2.1.2.3")
            return "целлюлозно-бумажное производство, издательская и полиграфическая деятельность";
        elif (rowNumber == "2.1.2.4")
            return "производство кокса, нефтепродуктов и ядерных материалов";
        elif (rowNumber == "2.1.2.5")
            return "химическое производство";
        elif (rowNumber == "2.1.2.6")
            return "производство прочих неметаллических минеральных продуктов";
        elif (rowNumber == "2.1.2.7")
            return "металлургическое производство и производство готовых металлических изделий";
        elif (rowNumber == "2.1.2.8")
            return "производство машин и оборудования, из них:";
        elif (rowNumber == "2.1.2.8.1")
            return "производство машин и оборудования для сельского и лесного хозяйства";
        elif (rowNumber == "2.1.2.9")
            return "производство транспортных средств и оборудования, из них:";
        elif (rowNumber == "2.1.2.9.1")
            return "производство автомобилей";
        elif (rowNumber == "2.1.3")
            return "производство и распределение электроэнергии, газа и воды";
        elif (rowNumber == "2.1.4")
            return "сельское хозяйство, охота и лесное хозяйство, из них:";
        elif (rowNumber == "2.1.4.1")
            return "сельское хозяйство, охота и предоставление услуг в этих областях";
        elif (rowNumber == "2.1.5")
            return "Строительство, из них";
        elif (rowNumber == "2.1.5.1")
            return "строительство зданий и сооружений";
        elif (rowNumber == "2.1.6")
            return "транспорт и связь, из них";
        elif (rowNumber == "2.1.6.1")
            return "деятельность воздушного транспорта, подчиняющегося и не подчиняющегося расписанию";
        elif (rowNumber == "2.1.7")
            return "оптовая и розничная торговля, ремонт автотранспортных средств, мотоциклов, бытовых изделий и предметов личного пользования";
        elif (rowNumber == "2.1.8")
            return "операции с недвижимым имуществом, аренда и предоставление услуг";
        elif (rowNumber == "2.1.9")
            return "прочие виды деятельности";
        elif (rowNumber == "2.2")
            return "на завершение расчетов";
        elif (rowNumber == "2.3")
            return "из общей величины кредитов, предоставленных юридическим лицам и индивидуальным предпринимателям, кредиты субъектам малого и среднего предпринимательства, из них:";
        elif (rowNumber == "2.3.1")
            return "Индивидуальным предпринимателям";
        elif (rowNumber == "3")
            return "Физическим лицам";
        end;

        return "";
    end;

    private macro constructorTPart1ReportPrinter4212()
        initTPart1ReportPrinter2835();
    end;

    constructorTPart1ReportPrinter4212();
end;

/***************************************************************************************************
 *  основная функция
 **************************************************************************************************/
private macro main()

    var printer;
    if (    (RcbApplication().currentReport().attributeValue("Раздел1").createValueIterator.count == 0)
//        and (RcbApplication().currentReport().attributeValue("Раздел1.Строка4").createValueIterator.count == 0)
        and (RcbApplication().currentReport().attributeValue("Раздел2").createValueIterator.count == 0))
        printer = TPrinter();
        printer.printHeader();
        TReportPrinter().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2183_DATE)
        printer = TPrinter2055();
        printer.printHeader();
        TPart1ReportPrinter2055().print();
        TPart2ReportPrinter2055().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2332_DATE)
        printer = TPrinter2055();
        printer.printHeader();
        TPart1ReportPrinter2183().print();
        TPart2ReportPrinter2183().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2470_DATE2)
        printer = TPrinter2332();
        printer.printHeader();
        TPart1ReportPrinter2332().print();
        TPart2ReportPrinter2332().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2742_DATE)
        printer = TPrinter2470();
        printer.printHeader();
        TPart1ReportPrinter2470().print();
        TPart2ReportPrinter2470().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2835_DATE)
        printer = TPrinter2742();
        printer.printHeader();
        TPart1ReportPrinter2742().print();
        TPart2ReportPrinter2742().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I2926_DATE)
        printer = TPrinter2742();
        printer.printHeader();
        TPart1ReportPrinter2835().print();
        TPart2ReportPrinter2742().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I4212_DATE)
        printer = TPrinter2742();
        printer.printHeader();
        TPart1ReportPrinter2835().print();
        TPart2ReportPrinter2926().print();
    elif (RcbApplication().currentReport().context().period().endDate() < RCB_I4637_DATE_F302)
        printer = TPrinter4212();
        printer.printHeader();
        TPart1ReportPrinter4212().print();
        TPart2ReportPrinter2926().print();
    else
        printer = TPrinter4637();
        printer.printHeader();
        TPart1ReportPrinter4212().print();
        TPart2ReportPrinter4637().print();
    end;
    printer.printBottom();
end;

/***************************************************************************************************
 *  точка входа
 **************************************************************************************************/
main();
