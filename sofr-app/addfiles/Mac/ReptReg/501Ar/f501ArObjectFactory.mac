/*
$Name:          f501ArObjectFactory.mac
$Module:        Отчеты ЦБ
$Description:   Форма 501Ar. Фабрика объектов.
*/

/**
 * Форма 501Ar. Фабрика объектов.
 */
private class (RcbObjectFactoryBase) TF501ArObjectFactoryImpl()
    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        defaultParm(isLazy, false);
        return genObject("TF501ArReport", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if (partId == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArPart1", partId, compositeValue);
        elif (partId == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArPart2", partId, compositeValue);
        elif (partId == TF501ArGlobal().getPartSwiftId())
            return genObject("TF501ArPartSwift", partId, compositeValue);
        else
            return null;
        end;
    end;

    macro createAttribute(id : String, part : RcbPartBase, value : Object, properties : Object) : RcbAttributeBase
        if (part.getId() == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArAttributePart1", id, part, value, properties);
        elif (part.getId() == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArAttributePart2", id, part, value, properties);
        elif (part.getId() == TF501ArGlobal().getPartSwiftId())
            return genObject("TF501ArAttributeSwift", id, part, value, properties);
        else
            return null;
        end;
    end;

    macro createAttributeValue(part : RcbPartBase, storage : RcbCompositeValue) : Object
        if (part.getId() == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArAttributeValuePart1", storage);
        elif (part.getId() == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArAttributeValuePart2", storage);
        elif (part.getId() == TF501ArGlobal().getPartSwiftId())
            return genObject("TF501ArAttributeValueSwift", storage);
        else
            return null;
        end;
    end;

    macro createStandaloneAttributeValue(part : RcbPartBase, id : String) : Object
        if (part.getId() == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArStandaloneAttributeValuePart1", id);
        elif (part.getId() == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArStandaloneAttributeValuePart2", id);
        elif (part.getId() == TF501ArGlobal().getPartSwiftId())
            return genObject("TF501ArStandaloneAttributeValueSwift", id);
        else
            return null;
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF501ArDataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF501ArDataSourceFilters");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF501ArCalculateProtocolView", protocolName);
    end;

    macro createPartCalculateController(part : RcbPartBase, reportCalculateController : RcbReportCalculateController) : Object
        if (part.getId() == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArPart1CalculateController", reportCalculateController);
        elif (part.getId() == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArPart2CalculateController", reportCalculateController);
        else
            return null;
        end;
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF501ArReportCalculateController");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF501ArTuneTable", RCB_I4927_DATE);
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TPrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createPartView(id : String, reportView : RcbReportView) : RcbReportView
        if (id == TF501ArGlobal().getPart1Id())
            return genObject("TF501ArPart1View",id, reportView);
        elif (id == TF501ArGlobal().getPart2Id())
            return genObject("TF501ArPart2View",id, reportView);
        else
            return null;
        end;
    end;

    macro createReportView(protocolView : RcbPrintProtocolView) : RcbReportView
        return genObject("TF501ArReportView", protocolView);
    end;

    macro createPrintProtocolView(protocolName)
        return genObject("TF501ArPrintProtocolView", protocolName);
    end;

    macro createReportPrintController(format : Integer) : RcbReportPrintController
        return genObject("TF501ArReportPrintController", format);
    end;

    macro createReportExcelView(protocol : RcbPrintProtocolView) : Object
        return genObject("TF501ArExcelReportView", RcbPrintProtocolView());
    end;

    macro createExportKlikoController() : RcbKlikoExportController
        return genObject("TF501ArExportKlikoController");
    end;

    macro createExportPtkPsdController() : RcbPtkPsdExportController
        return genObject("TF501ArExportPtkPsdController");
    end;

    macro createSettingsContainer(attributeName : String)
        return genObject("TRcbSettingsContainer", attributeName);
    end;

    macro createNormalizationController()
        return genObject("TF501ArNormalizationController");
    end;

    macro createNormalizationProtocolView() : Object
        return genObject("TF501ArNormalizationProtocolView");
    end;

    macro createNormalizer(protocolView : Object) : Object
        return genObject("TF501ArNormalizer", protocolView);
    end;

    macro createServiceOperationController() : Object
        return genObject("TF501ArServiceOperationController");
    end;

    private macro constructorTF501ArObjectFactoryImpl()
        initRcbObjectFactoryBase();
    end;

    constructorTF501ArObjectFactoryImpl();
end;

if (objectFactoryInstance == null)
    if (RcbApplication().currentReport.context.period.endDate >= RCB_I4927_DATE)
        objectFactoryInstance = TF501ArObjectFactoryImpl();
    else
        objectFactoryInstance = null;
    end;
end;
