/*
$Name:          f501ArExportKlikoController.mac
$Module:        Отчеты ЦБ
$Description:   Форма 501Ar. Контроллер экспорта в kliko.exe.
*/

/**
 * Форма 501Ar. Контроллер экспорта в kliko.exe.
 *
 * @since 17.12.2018
 * @author ABP
 * @version 6.20.031.054
 */
class (RcbKlikoExportController) TF501ArExportKlikoController()
    private macro getDescriptorInfo()
        return "Fu501B_2413.pak от 29.10.2018";
    end;

    private macro createView()
        return TF501ArKlikoView(m_fileExtension, m_report.getPeriod().endDate);
    end;

    private macro printAdditionalProtocolData(protocol)
    end;

    private macro printDataZone()
        var i = 0;
        m_view.printHead("F501B");
        for (var partId, RcbArray().init(TF501ArGlobal().getPart1Id(), TF501ArGlobal().getPart2Id()))
            i = i + 1;
            message("Раздел " + i);

            for (var attribute, m_report.getPart(partId).getAttributes(true))
                m_view.printRowData(attribute.getValue());
            end;
        end;
    end;

    private macro constructorTF501ArExportKlikoController()
        initRcbKlikoExportController("501", objectFactoryInstance.createReport());
    end;

    constructorTF501ArExportKlikoController();
end;
