/*
$Name:          f501ArPartView.mac
$Module:        âç¥âë –
$Description:   ”®à¬  501Ar. ¥ç â­®¥ ¯à¥¤áâ ¢«¥­¨ï à §¤¥«®¢.
*/

/**
 * ”®à¬  501Ar. ¥ç â­®¥ ¯à¥¤áâ ¢«¥­¨¥ à §¤¥«  1.
 */
class (RcbPartView) TF501ArPart1View(partId, reportView)
    initRcbPartView(partId, reportView);

    private macro initialize()
        m_table.addColumn("1",  4,  AL_CENTER);
        m_table.addColumn("2",  26, AL_LEFT);
        m_table.addColumn("3",  11, AL_CENTER);
        m_table.addColumn("4",  5, AL_CENTER);
        m_table.addColumn("5",  8, AL_CENTER);
        m_table.addColumn("6",  20, AL_RIGHT);
        m_table.addColumn("7",  12, AL_RIGHT);
        m_table.addColumn("8",  11, AL_RIGHT);
        m_table.addColumn("9",  11, AL_RIGHT);
        m_table.addColumn("10", 11, AL_RIGHT);
        m_table.addColumn("11", 11, AL_RIGHT);
        m_table.addColumn("12", 6, AL_RIGHT);
        m_table.addColumn("_1", 6, AL_CENTER);
        m_table.addColumn("_2", 11, AL_CENTER);
        m_table.addColumn("_3", 11, AL_CENTER);
        m_table.addColumn("13", 19, AL_CENTER);
        m_table.addColumn("14", 11, AL_CENTER);
        m_table.addColumn("15", 14, AL_CENTER);
        m_table.addColumn("16", 11, AL_RIGHT);
        m_table.addColumn("17", 10, AL_CENTER);
    end;

    macro printHead()
    [³                                                                                   I. ‘¢¥¤¥­¨ï ® ¯à¥¤®áâ ¢«¥­­ëå ¬¥¦¡ ­ª®¢áª¨å ªà¥¤¨â å (à §¬¥é¥­­ëå ¤¥¯®§¨â å)                                                                                                                                 ³];
    [ÃÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ´];
    end;

    macro printDate_YYYYMMDD(_date : string) : string
        return SubStr(_date, 7) + SubStr(_date, 4, 2) + SubStr(_date, 1, 2);
    end;

    macro printString(rowNumber : String, value : Object)
        printString(RcbArray().initialize(rowNumber,
                                          value.getClientName(),
                                          value.getRegNumber(),
                                          value.getCountryCode(),
                                          value.getBalance(),
                                          value.getAccount(),
                                          value.getInRest().currentAsString,
                                          value.getDebetTurnover().currentAsString,
                                          value.getCreditTurnover().currentAsString,
                                          value.getOutRest().currentAsString,
                                          printDate_YYYYMMDD( value.getPerformanceDate() ),
                                          ternary(int(value.getGdSign()) == 1, "", string((value.getPercentValue().current):0:2)),
                                          value.getDealNumber(),
                                          "-",
                                          value.getProlongDealDate() + " " + value.getProlongDealNumber,
                                          ternary(getPartid() == TF501ArGlobal().getPart1Id(), value.getEncumbranceParty(), "X"),
                                          ternary(getPartid() == TF501ArGlobal().getPart1Id(), value.getEncumbrancePartyId(), "X"),
                                          ternary(getPartid() == TF501ArGlobal().getPart1Id(), value.getEncumbranceKind(), "X"),
                                          ternary(getPartid() == TF501ArGlobal().getPart1Id(), ternary(value.getEncumbranceKind() != "", value.getEncumbranceRest().currentAsString, ""), "X"),
                                          ternary(getPartid() == TF501ArGlobal().getPart1Id(), value.getMaturityDate(), "X")
                                         )
                   );
    end;
end;

class (TF501ArPart1View) TF501ArPart2View(partId, reportView)
    initTF501ArPart1View(partId, reportView);

    macro printHead()
    [ÃÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄ´];
    [³                                                                                     II. ‘¢¥¤¥­¨ï ® ¯®«ãç¥­­ëå ¬¥¦¡ ­ª®¢áª¨å ªà¥¤¨â å (¯à¨¢«¥ç¥­­ëå ¤¥¯®§¨â å)                                                                                                                                  ³];
    [ÃÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ´];
    end;
end;