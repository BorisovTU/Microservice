/*
$Name:          f501ArInterface.mac
$Module:        Отчеты ЦБ
$Description:   Форма 501Ar. Доступ к операциям формы.
*/

import f501Arimport;

/**
 *  Запуск операции расчета отчета
 */
macro calculate()
    var profiler;
    profiler = TSqlProfiler(getTxtFileName("!f501ArCalculationProfile"));
    profiler.clear();
    profiler.on();

    objectFactoryInstance.createReportCalculateController().calculate();
end;

/**
 *  Запуск операции копирования ручного ввода SWIFT
 */
macro createUserInputAttributes()
    objectFactoryInstance.createServiceOperationController().createSwiftAttributes();
    RcbApplication().transactionManager.commit();
end;

/**
 *  Запуск операции нормализации
 */
macro normalize()
    objectFactoryInstance.createNormalizationController().execute();
    RcbApplication().transactionManager.commit();
end;

/**
 *  Запуск операции печати отчета в plain text
 */
macro printReport()
    objectFactoryInstance.createReportPrintController().print("txt");
end;

/**
 *  Запуск операции печати отчета в excel
 */
macro printReportExcel()
    objectFactoryInstance.createReportPrintController(WINREP_FORMAT_XLSX).print("xls");
end;

/**
 *  Запуск операции экспорта в kliko.exe
 */
macro exportToKliko()
    objectFactoryInstance.createExportKlikoController().execute();
end;

установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
