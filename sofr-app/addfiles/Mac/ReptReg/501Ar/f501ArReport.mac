/*
$Name:          f501ArReport.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 501Ar. Отчет.
*/

/**
 * Форма 501Ar. Отчет.
*/

class (RcbReportBase) TF501ArReport(report : RcbReport, isLazy : Bool)
    private macro initialize()
        addPart(TF501ArGlobal().getPart1Id(), getRcbReport().attributeValue("Ф501_1")).initialize();
        addPart(TF501ArGlobal().getPart2Id(), getRcbReport().attributeValue("Ф501_2")).initialize();
        addPart(TF501ArGlobal().getPartSwiftId(), getRcbReport().attributeValue("SWIFT")).initialize();
   end;

    macro isEmpty()
        m_parts.moveFirst();
        while (m_parts.moveNext())
            if (not m_parts.getCurrentItem().isEmpty())
                return false;
            end;
        end;

        return true;
    end;

    macro isCalculated()
        return getRcbReport().isCalculated();
    end;

    private macro constructorTF501ArReport(report : RcbReport, isLazy : Bool)
        initRcbReportBase(report, isLazy);
    end;

    constructorTF501ArReport(report, isLazy);
end;
