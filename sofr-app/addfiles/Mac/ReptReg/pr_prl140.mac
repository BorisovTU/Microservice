/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank V6                                                  R-Style Softlab
  ” ©« ¯®¤á¨áâ¥¬ë "¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì"

  ¥ç âì ¯à¨«®¦¥­¨ï 14.
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
import pr_prl141, pr_prl142, pr_prl143, pr_prl144, pr_prl145;

private const CHAPTER_LABEL = "-ch:";

private const CHAPTER_NUM_0 = 0;
private const CHAPTER_NUM_1 = 1;
private const CHAPTER_NUM_2 = 2;
private const CHAPTER_NUM_3 = 3;
private const CHAPTER_NUM_4 = 4;
private const CHAPTER_NUM_5 = 5;

private 
CLASS (RRG_PRL14_Report) Report0( Chapter )

    private var m_Reports : TArray;

    private
    Macro Constructor()
        InitRRG_PRL14_Report();

        m_Reports = TArray();

        m_Reports(CHAPTER_NUM_0) = RRG_PRL14_Report ();
        m_Reports(CHAPTER_NUM_1) = RRG_PRL14_Report1();
        m_Reports(CHAPTER_NUM_2) = RRG_PRL14_Report2();
        m_Reports(CHAPTER_NUM_3) = RRG_PRL14_Report3();
        m_Reports(CHAPTER_NUM_4) = RRG_PRL14_Report4();
        m_Reports(CHAPTER_NUM_5) = RRG_PRL14_Report5();
    End;

    Macro Pr( Value, Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].Pr(Value,Parm);
    End;

    Macro PrintChapterName( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].PrintChapterName(Parm);
    End;

    Macro PrintHead( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].PrintHead(Parm);
    End;

    Macro PrintHeadActive( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].PrintHeadActive(Parm);
    End;

    Macro PrintItogActive( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintItogActive(Parm,Itog);
    End;

    Macro PrintHeadPassive( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].PrintHeadPassive(Parm);
    End;

    Macro PrintItogPassive( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintItogPassive(Parm,Itog);
    End;

    Macro PrintLevel2BalanceItog( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintLevel2BalanceItog( Parm, Itog );
    end;

    Macro PrintHeadLevel1Balance( Parm : RRG_PRL14_Parm, level1Balance )
        return m_Reports[Parm.Chapter].PrintLevel1BalanceItog( Parm, level1Balance );
    end;

    Macro PrintLevel1BalanceItog( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintLevel1BalanceItog( Parm, Itog );
    end;

    Macro PrintHeadPartition( Parm: RRG_PRL14_Parm, Balance : RRG_PRL14_Balance )
        return m_Reports[Parm.Chapter].PrintHeadPartition( Parm, Balance );
    end;

    Macro PrintPartitionItog( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintPartitionItog( Parm, Itog );
    end;


    Macro PrintAllTurnsItog( Parm : RRG_PRL14_Parm, Itog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].PrintAllTurnsItog( Parm, Itog );
    end;


    Macro ClearCurrentNames( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].ClearCurrentNames();
    end;

    Macro PrintFoot( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].PrintFoot(Parm);;
    End;

    Macro ProcessBalance( Balance : RRG_PRL14_Balance, Parm : RRG_PRL14_Parm, level2Itog : RRG_PRL14_Itog, level1Itog : RRG_PRL14_Itog, partitionItog : RRG_PRL14_Itog )
        return m_Reports[Parm.Chapter].ProcessBalance(Balance,Parm,level2Itog,level1Itog,partitionItog);
    End;

    Macro ViewDOS( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].ViewDOS(Parm);
    End;

    Macro ViewExcel( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].ViewExcel(Parm);
    End;

    Macro View( Parm : RRG_PRL14_Parm )
        return m_Reports[Parm.Chapter].View(Parm);
    End;
        
    Constructor();
END;    

Private
MACRO GetChapterNum( StrParm )
   var ind = Index( StrParm, CHAPTER_LABEL );

   if ( ind <= 0 )
      return 0;
   end;
   
   return Int(SubStr(StrParm,ind+StrLen(CHAPTER_LABEL),1));
END;

private
MACRO Main()

    var Chapter = GetChapterNum(CmdArgs());
    var Rep     = Report0( Chapter );

    return RRG_PRL14_Main( Chapter, Rep );

END;

Exit( Main() );
