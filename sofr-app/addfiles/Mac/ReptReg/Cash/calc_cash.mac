/**
 * Запуск расчета кассовых оборотов.
 * 
 * @since   09.11.2007
 * @author  Ivkina Olga
 * @version 6.00.004.24
 */
import ReptcbInter;
import repException;

import CFCalculationOperation; 
import CFCheckPreviousPeriodOperation;
import CFObjectFactory;
import testLib;

var profiler = TSQLProfiler(getTxtFileName("!F202CalculateProfile"));
profiler.clear();
profiler.on();

var checkPreviousPeriodOperation = objectFactoryInstance().createCheckPreviousPeriodOperation();
var calculationOperation = objectFactoryInstance().createCalculationOperation();

if (not checkPreviousPeriodOperation.isCorrect)
    checkPreviousPeriodOperation.exeptionMessage();
end;

calculationOperation.execute();

установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);