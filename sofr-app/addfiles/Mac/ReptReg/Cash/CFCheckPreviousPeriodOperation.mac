
import repException;

class (TException) TCheckPreviousPeriodOperation()
    
    macro isCorrect()

        var beginDateOfCurrentPeriod = rcbApplication.currentReport.context.period.beginDate;
        var endDateOfPreviousPeriod  = rcbApplication.currentReport.previousPeriod.endDate;

        if (beginDateOfCurrentPeriod > endDateOfPreviousPeriod) 
            return true;
        else
            return false;
        end;
    end;

    macro exeptionMessage()
        msgBox(m_errorMessage);
    end;

    initTException("Предыдущий период задан неверно.", true);
end;
