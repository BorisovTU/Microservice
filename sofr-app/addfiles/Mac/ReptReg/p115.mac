/* Печать 115 формы.
*/

import lib_str, p115_1, p115_2, rcb_date;

private const HeaderWidth = Section1Width;
private const IsEmpty     = IsSection1Empty and IsSection2Empty;

// Заголовок
private MACRO PrintHeader( )
    // строка, которую нужно подготовить заранее.
    var str = "│";
    str = str + StrAlign( Код_СОАТО,        15, STR_ALIGN_CENTER ) + "│";
    str = str + StrAlign( Код_ОКПО,          9, STR_ALIGN_CENTER ) + "│";
    str = str + StrAlign( ОГРН,             15, STR_ALIGN_CENTER ) + "│";
    str = str + StrAlign( РегНомерБанка,    15, STR_ALIGN_CENTER ) + "│";
    str = str + StrAlign( {MFO_Bank},       12, STR_ALIGN_CENTER ) + "│";

    
    println( StrAlign( "Банковская отчетность ", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "┌───────────────┬──────────────────────────────────────────────────────┐", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│      Код      │          Код кредитной организации (филиала)         │", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│   территории  ├─────────┬───────────────┬───────────────┬────────────┤", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│    по ОКАТО   │ по ОКПО │   Основной    │Регистрационный│    БИК     │", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│               │         │государственный│    номер      │            │", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│               │         │регистрационный│(/порядковый   │            │", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "│               │         │    номер      │    номер)     │            │", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "├───────────────┼─────────┼───────────────┼───────────────┼────────────┤", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( str, HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "└───────────────┴─────────┴───────────────┴───────────────┴────────────┘", HeaderWidth, STR_ALIGN_RIGHT ) );

    println;
    println( StrAlign( "ИНФОРМАЦИЯ О КАЧЕСТВЕ ССУД, ССУДНОЙ И ПРИРАВНЕННОЙ К НЕЙ ЗАДОЛЖЕННОСТИ", HeaderWidth, STR_ALIGN_CENTER ) );
    println( StrAlign( String( "ПО СОСТОЯНИЮ НА ", trim( string( GetCorrectPrnRepDate():m ) ) ), HeaderWidth, STR_ALIGN_CENTER ) );
    println;
    println;
    println;
    println;
    [   ###################################################################################################################### ]( "Наименование кредитной организации " + {Name_Bank}:w );
    [   Почтовый адрес                     #                                                                                   ]( {Post_Addr}:l );
    println;
    println( StrAlign( "Код формы 0409115 ", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "Месячная ", HeaderWidth, STR_ALIGN_RIGHT ) );
    println( StrAlign( "тыс.руб. ", HeaderWidth, STR_ALIGN_RIGHT ) );
END;

// Подвал
private MACRO PrintFooter( )
[ ];
[   #                               ###################################    (Ф.И.О.)      ]( {Name_Boss}:l, {FIO_Boss}:l );
[   #                               ###################################    (Ф.И.О.)      ]( {Name_Book}:l, {FIO_Book}:l );
[   М.П.];
[   Исполнитель                     ###################################    (Ф.И.О.)      ]( Исполнитель:l );
[   телефон:                        ###################################                  ]( Номер_телефона:l );
[   #]( trim( string( {curdate}:m ) ) );
END;

PrintHeader( );
if( IsEmpty )
    println( "Данные отсутствуют." );
else
    PrintSection1( );
    PrintSection2( );
end;
PrintFooter( );
