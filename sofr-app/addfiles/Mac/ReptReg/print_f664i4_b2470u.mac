/*ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
  RS-Bank V6                                                                        R-Style Softlab
  ” ©« ¯®¤á¨áâ¥¬ë "¥£« ¬¥­â¨àã¥¬ ï ®âç¥â­®áâì"

  ¥ç âì ¯à®â®ª®«  à áç¥â  ¨ ä®à¬ë 664.  §¤¥« 4

  ‘®§¤ ­: 09.08.2010 - Shestakov Dmitry
ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ*/
import PTInter;
import print_f664_b2470u;

import param;

/**
 *  Š®­áâ ­âë
 */
private const DEBIT  = "0";
private const CREDIT = "1";

/**
 * Š« áá ¯à®â®ª®« .
 */
class (TProtocol) TProtocolIssue4()

    private var m_operationOverall;

    private var m_currentAccountKind;
    private var m_currentDirection;
    private var m_currentCountry;
    private var m_currentOperation;

    private var m_parameters = TParameters("", "", 34);

    private var m_tableWidth = Tarray();
    private var m_accountsTableWidth;
    private var m_depositsTableWidth;

    macro putTableHeader(backOffice, header : object)

        header.size = 0;

        if (backOffice == BOCB)
            header[header.size] = "ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
            header[header.size] = "³Š®¤ áâà ­ë³   Š®¤    ³  ‘ã¬¬  ¢ àã¡«ïå ”   ³   „ â    ³     ü     ³        ‘ç¥â ¯® ¤¥¡¥âã     ³      ‘ç¥â ¯® ªà¥¤¨âã      ³             ¥à¥§¨¤¥­â -          ³";
            header[header.size] = "³ ­¥à¥§¨¤. ³ ®¯¥à æ¨¨ ³                      ³   ¤®ª.   ³ ¤®ªã¬¥­â  ³                           ³                           ³           ¢« ¤¥«¥æ áç¥â           ³";
            header[header.size] = "ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
        elif (backOffice == BORetail)
            header[header.size] = "ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿";
            header[header.size] = "³Š®¤ áâà ­ë³   Š®¤    ³   „ â    ³  ‘ã¬¬  ¢ àã¡«ïå ”   ³    Š®«¨ç¥áâ¢® ®¯¥à æ¨©    ³";
            header[header.size] = "³ ­¥à¥§¨¤. ³ ®¯¥à æ¨¨ ³          ³                      ³                           ³";
            header[header.size] = "ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ";
        end;

    end;

    macro getTableWidth(backOffice)

        if (m_tableWidth[backOffice] != null)
            return m_tableWidth[backOffice];
        end;

        var header = TArray();

        putTableHeader(backOffice, header);
        if (header.size > 0)
            m_tableWidth[backOffice] = strLen(header[0]);
        end;

        return m_tableWidth[backOffice];
    end;

    macro addTableHeader(backOffice)
        var header = TArray();
        var i = 0;

        putTableHeader(backOffice, header);
        while (i < header.size)
            println(header[i]);
            i = i + 1;
        end;
    end;

    private macro addTableFooter()
        println();
    end;

    macro addTableLineCb(dataSource)

        [    ###       #####    ###################### ########## ###########  #########################   #########################   ################################# ]
        (dataSource.countryCode:c,
                      dataSource.operationCode,
                                dataSource.sum,        dataSource.dateCarry:f,
                                                                  dataSource.numberDocument:l,
                                                                               dataSource.accountPayer,    dataSource.accountReceiver, dataSource.clientCodeAndName:w);

    end;

    macro addTableLineRt(dataSource)

        [    ###       #####    ########## ######################  ######################### ]
        (dataSource.countryCode:r,
                     dataSource.operationCode,
                                dataSource.dateCarry:f,
                                           dataSource.sum,         dataSource.numberDocument:l);

    end;

    macro addTableLine(backOffice, dataSource)
        if (backOffice == BOCB)
            addTableLineCb(dataSource);
        elif (backOffice == BORetail)
            addTableLineRt(dataSource);
        end;
    end;

    macro isEmptyIssue()

        var query =      "SELECT NULL"
                + "\n" + "  FROM dual"
                + "\n" + " WHERE EXISTS("
                + "\n" + "              SELECT NULL"
                + "\n" + "                FROM " + TTurnsTempTable().getTableName() + " turns"
                + "\n" + "               WHERE turns.t_reportIssue = " + m_parameters.getReportIssue()
                + "\n" + "             )";

        return (not TRsbDataSet(query).next());

    end;

    private macro addIssueHeader()

        println();
        println("€‡„…‹ 4");
        println();

    end;

    private macro addBoHeader(backOffice)
        if (backOffice == BOCB)
            println("ƒ‹€‚€Ÿ Šˆƒ€");
        elif (backOffice == BORetail)
            println("RETAIL");
        end;
    end;

    private macro addAccountKindHeader(accountKind)

        defaultParm(accountKind, "«î¡®©");

        println("‚¨¤ áç¥â : ", accountKind);

        m_currentAccountKind = accountKind;

    end;

    private macro addAccountKindFooter()
    end;

    private macro addDirectionHeader(directionCode)

        var directionStr;

        if (directionCode == DEBIT)
            directionStr = "‘¯¨á ­¨¥";
        else
            directionStr = "‡ ç¨á«¥­¨¥";
        end;

        [ ########## ](directionStr:l);

        m_currentDirection = directionCode;

    end;

    private macro addDirectionFooter()
        println();
    end;

    private macro addCountryHeader(countryCode)
        m_currentCountry = countryCode;
    end;

    private macro addCountryFooter()
    end;

    private macro addOperationHeader(operationCode)
        m_currentOperation = operationCode;
    end;

    private macro addOperationFooter()
    end;

    private macro addUnknownCountryCb()

        var isContinue;

        var errorMessage;

        var query =          "WITH errCountryDoc AS"
                    + "\n" + "("
                    + "\n" + "SELECT DECODE(turns.t_isWrongPayment, 0, CHR(1), '!')                 t_errorFlag,"
                    + "\n" + "       turns.t_operationCode                                          t_operationCode,"
                    + "\n" + "       turns.t_dateCarry                                              t_dateCarry,"
                    + "\n" + "       turns.t_accountNumber                                          t_accountNumber,"
                    + "\n" + "       turns.t_accountPayer                                           t_accountPayer,"
                    + "\n" + "       turns.t_accountReceiver                                        t_accountReceiver,"
                    + "\n" + "       turns.t_numberDocument                                         t_numberDocument,"
                    + "\n" + "       turns.t_sum                                                    t_sum,"
                    + "\n" + "       turns.t_countryCode                                            t_countryCode,"
                    + "\n" + "       rsb_rep_pt.get_ptshname(TO_NUMBER(turns.t_clientCodeAndName))  t_contragentShortName"
                    + "\n" + "  FROM " + TTurnsTempTable().getTableName() + " turns"
                    + "\n" + " WHERE turns.t_reportIssue = " + m_parameters.getReportIssue()
                    + "\n" + "   AND turns.t_backOffice = " + BOCB
                    + "\n" + "   AND turns.t_countryCode IN (CHR(1), '997', '998', '999')"
                    + "\n" + ")"
                    + "\n" + "SELECT t_errorFlag,"
                    + "\n" + "       t_operationCode,"
                    + "\n" + "       t_dateCarry,"
                    + "\n" + "       t_accountPayer,"
                    + "\n" + "       t_accountReceiver,"
                    + "\n" + "       t_numberDocument,"
                    + "\n" + "       t_sum,"
                    + "\n" + "       t_countryCode,"
                    + "\n" + "       t_contragentShortName"
                    + "\n" + "  FROM errCountryDoc ecd"
                    + "\n" + " WHERE    (t_accountPayer = t_accountNumber)"                                   // ¥á«¨ ¤«ï ¤®ªã¬¥­â  ¯à¨áãâáâ¢ãîâ
                    + "\n" + "       OR (   (t_accountReceiver = t_accountNumber)"                            // ¤¢¥ § ¯¨á¨ (á® áç¥â®¬ ¯« â¥«ìé¨ª  ¨
                    + "\n" + "           AND NOT EXISTS(SELECT 1"                                             // á® áç¥â®¬ ¯®«ãç â¥«ï), â® ¢ë¢®¤¨âáï
                    + "\n" + "                            FROM errCountryDoc ecdDup"                          // â®«ìª® ®¤­  § ¯¨áì ¤«ï ¤®ªã¬¥­â 
                    + "\n" + "                           WHERE ecd.t_accountPayer = ecdDup.t_accountNumber"   // (á® áç¥â®¬ ¯« â¥«ìé¨ª )
                    + "\n" + "                         )"
                    + "\n" + "          )"
                    + "\n" + " ORDER BY t_errorFlag, t_countryCode, t_operationCode, t_dateCarry, t_numberDocument, t_accountPayer, t_accountReceiver";

        var dataSource = TRsbDataSet(query);

        dataSource.setFieldType("t_dateCarry", V_DATE);
        dataSource.setFieldType("t_sum",       V_MONEY);

        errorMessage = "„«ï ¤®ªã¬¥­â  § ¤ ­® §­ ç¥­¨¥ ª â¥£®à¨¨ \"Š®¤ áâà ­ë ­¥à¥§¨¤¥­â \". "
                       "¥¢®§¬®¦­® ª®àà¥ªâ­® ®¯à¥¤¥«¨âì ª®¤ áâà ­ë ¯« â¥«ìé¨ª  ¨ ¯®«ãç â¥«ï";

        isContinue = dataSource.next();

        if (isContinue)
            println();

            println("Ž¯¥à æ¨¨, ¤«ï ª®â®àëå ­¥¢®§¬®¦­® ®¯à¥¤¥«¨âì ª®¤ áâà ­ë ­¥à¥§¨¤¥­â  - ¢« ¤¥«ìæ  áç¥â :");
            println("ÚÄÂÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿");
            println("³ ³ Š®¤  ³  Š®¤   ³   „ â    ³ ü ¤®ª ³  ‘ã¬¬  ¢ àã¡«ïå ”   ³        ‘ç¥â ¯® ¤¥¡¥âã     ³      ‘ç¥â ¯® ªà¥¤¨âã      ³ ¥à¥§¨¤¥­â - ¢« ¤¥«¥æ ³");
            println("³ ³áâà ­ë³®¯¥à æ¨¨³   ¤®ª    ³       ³                      ³                           ³                           ³          áç¥â         ³");
            println("³ ³­¥à¥§.³        ³          ³       ³                      ³                           ³                           ³                       ³");
            println("ÀÄÁÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ");
        end;

        while (isContinue)

            if (dataSource.countryCode != "")

                [ #  ###    ######  ##########  #####   #####################  #########################   #########################   ###################### ]
                ( dataSource.errorFlag,
                     dataSource.countryCode,
                           dataSource.operationCode,
                                    dataSource.dateCarry:f, dataSource.numberDocument, dataSource.sum:r,
                                                                               dataSource.accountPayer,    dataSource.accountReceiver, dataSource.contragentShortName:w);

            else

                [ #         ######  ##########  #####   #####################  #########################   #########################   ###################### ]
                ( dataSource.errorFlag,
                                    dataSource.dateCarry:f, dataSource.numberDocument, dataSource.sum:r,
                                                                               dataSource.accountPayer,    dataSource.accountReceiver, errorMessage:w);
            end;

            isContinue = dataSource.next();

        end;

    end;

    private macro addUnknownCountryRt()

        var isContinue;

        var query =          "SELECT turns.t_dateCarry      t_dateCarry,"
                    + "\n" + "       turns.t_operationCode  t_operationCode,"
                    + "\n" + "       turns.t_sum            t_sum,"
                    + "\n" + "       turns.t_numberDocument t_numberDocument"
                    + "\n" + "  FROM " + TTurnsTempTable().getTableName() + " turns"
                    + "\n" + " WHERE turns.t_reportIssue = " + m_parameters.getReportIssue()
                    + "\n" + "   AND turns.t_backOffice = " + BORetail
                    + "\n" + "   AND turns.t_countryCode = '999'"
                    + "\n" + " ORDER BY t_operationCode, t_dateCarry, t_sum, t_numberDocument";

        var dataSource = TRsbDataSet(query);

        dataSource.setFieldType("t_dateCarry", V_DATE);
        dataSource.setFieldType("t_sum",       V_MONEY);

        isContinue = dataSource.next();

        if (isContinue)

            println();
            println("Ž¯¥à æ¨¨ ¢ Retail, ¤«ï ª®â®àëå ­¥¢®§¬®¦­® ®¯à¥¤¥«¨âì ª®¤ áâà ­ë ­¥à¥§¨¤¥­â :");
            println("ÚÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿");
            println("³   Š®¤    ³   „ â    ³   ‘ã¬¬  ¢ àã¡«ïå ”   ³    Š®«¨ç¥áâ¢® ®¯¥à æ¨©    ³");
            println("³ ®¯¥à æ¨¨ ³          ³                       ³                           ³");
            println("ÀÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ");

        end;

        while (isContinue)

            [   #####    ##########  #####################   #########################  ]
            ( dataSource.operationCode,
                         dataSource.dateCarry:f,
                                     dataSource.sum:r,       dataSource.numberDocument);

            isContinue = dataSource.next();

        end;

    end;

    private macro printBackOffice(backOffice)

        var isExistsTurns = false;
        var isContinue;

        var query;
        var dataSource;

        query =          "SELECT turns.t_accountKind                                            t_accountKind,"
                + "\n" + "       turns.t_directionCode                                          t_directionCode,"
                + "\n" + "       turns.t_countryCode                                            t_countryCode,"
                + "\n" + "       turns.t_operationCode                                          t_operationCode,"
                + "\n" + "       turns.t_sum                                                    t_sum,"
                + "\n" + "       turns.t_dateCarry                                              t_dateCarry,"
                + "\n" + "       turns.t_numberDocument                                         t_numberDocument,"
                + "\n" + "       turns.t_accountPayer                                           t_accountPayer,"
                + "\n" + "       turns.t_accountReceiver                                        t_accountReceiver,"
                + "\n" + "       rsb_rep_pt.get_ptshname(TO_NUMBER(turns.t_clientCodeAndName))  t_clientCodeAndName"
                + "\n" + "  FROM " + TTurnsTempTable().getTableName() + " turns"
                + "\n" + " WHERE turns.t_reportIssue = " + m_parameters.getReportIssue()
                + "\n" + "   AND turns.t_backOffice = " + backOffice
                + "\n" + "   AND turns.t_countryCode NOT IN (CHR(1), '997', '998', '999')"
                + "\n" + "ORDER BY t_accountKind, t_directionCode, t_countryCode, t_operationCode,"
                + "\n" + "         t_dateCarry, t_numberDocument, t_sum, t_accountPayer, t_accountReceiver";

        dataSource = TRsbDataSet(query);

        dataSource.setFieldType("t_sum",       V_MONEY);
        dataSource.setFieldType("t_dateCarry", V_DATE);

        isContinue = dataSource.next();

        addBoHeader(backOffice);

        if (not isContinue)
            println(strAlign("¥â ¤ ­­ëå", getTableWidth(backOffice), STR_ALIGN_CENTER));
            println();
        end;

        while (isContinue)

            isExistsTurns = true;

            if (dataSource.accountKind != m_currentAccountKind)

                if (m_currentAccountKind != "")
                    addOperationFooter();
                    addCountryFooter();
                    addDirectionFooter();
                    addTableFooter();
                    addAccountKindFooter();
                end;

                addAccountKindHeader(dataSource.accountKind);
                addTableHeader(backOffice);
                addDirectionHeader(dataSource.directionCode);
                addCountryHeader(dataSource.countryCode);
                addOperationHeader(dataSource.operationCode);

            end;

            if (dataSource.directionCode != m_currentDirection)

                if (m_currentDirection != "")
                    addOperationFooter();
                    addCountryFooter();
                    addDirectionFooter();
                end;

                addDirectionHeader(dataSource.directionCode);
                addCountryHeader(dataSource.countryCode);
                addOperationHeader(dataSource.operationCode);

            end;

            if (dataSource.countryCode != m_currentCountry)

                if (m_currentCountry != "")
                    addOperationFooter();
                    addCountryFooter();
                end;

                addCountryHeader(dataSource.countryCode);
                addOperationHeader(dataSource.operationCode);

            end;

            if (dataSource.operationCode != m_currentOperation)

                if (m_currentOperation != "")
                    addOperationFooter();
                end;

                addOperationHeader(dataSource.operationCode);

            end;

            addTableLine(backOffice, dataSource);

            isContinue = dataSource.next();

        end;

        if (isExistsTurns)

            addCountryFooter();
            addDirectionFooter();

        end;

    end;

    macro print()

        switchOutput();

        addIssueHeader();

        if (isEmptyIssue())
            println("¥â ¤ ­­ëå");
        else

            printBackOffice(BOCB);
            printBackOffice(BORetail);

            addUnknownCountryCb();
            addUnknownCountryRt();

        end;

        switchOutput();

    end;

    private macro constructorTProtocolIssue4()

        m_currentAccountKind = "";
        m_currentDirection   = "";
        m_currentCountry     = "";
        m_currentOperation   = "";

        m_parameters = TParameters("", "", 34);

        m_accountsTableWidth = 77;
        m_depositsTableWidth = 102;

        initTProtocol();

    end;

    constructorTProtocolIssue4();

end;

/**
 * Š« áá ¯¥ç â­®© ä®à¬ë à §¤¥«  ¯® 2470-“
 */
class (TPrintableForm664) TIssue4PrintableForm664_I2470(part1RootAttributeName : String, part2RootAttributeName : String)

    /**
     * Š« áá ¯¥ç â­®© ä®à¬ë ¢¨¤  áç¥â 
     */
    private class (TOperByCountryPrintableForm664) TIssue4PartPrintableForm664(rootAttributeName : String, accountKind : String)

        private var m_accountKind;

        private macro constructorTOperByCountryPrintableForm664(rootAttributeName, accountKind)

            initTOperByCountryPrintableForm664(rootAttributeName, false);

            m_accountKind = accountKind;

        end;

        private macro addHeader()
            var isEmptyPart = strAlign(ternary(IsEmpty(), "0", " "), 25, STR_ALIGN_CENTER);
            var accountKind = strAlign(m_accountKind, 11, STR_ALIGN_CENTER);

            switchOutput();

            println();
            println(strAlign("          ÚÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿",   getTableWidth(), STR_ALIGN_RIGHT));
            println(strAlign("‚¨¤ áç¥â  ³" + accountKind + "³" + isEmptyPart + "³", getTableWidth(), STR_ALIGN_RIGHT));
            println(strAlign("          ÀÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ",   getTableWidth(), STR_ALIGN_RIGHT));
            println(strAlign("           ®¡®§­ ç¥­¨¥ ¯à¨§­ ª ®âáãâáâ¢¨ï ¤ ­­ëå ",   getTableWidth(), STR_ALIGN_RIGHT));

            switchOutput();
        end;

        constructorTOperByCountryPrintableForm664(rootAttributeName, accountKind);

    end;

    private var m_part1RootAttributeName;
    private var m_part2RootAttributeName;

    private var m_part1 : TIssue4PartPrintableForm664;
    private var m_part2 : TIssue4PartPrintableForm664;

    private macro constructorTIssue4PrintableForm664_I2470(part1RootAttributeName, part2RootAttributeName)

        initTPrintableForm664();

        m_part1RootAttributeName = part1RootAttributeName;
        m_part2RootAttributeName = part2RootAttributeName;

        m_part1 = TIssue4PartPrintableForm664(m_part1RootAttributeName, "");
        m_part2 = TIssue4PartPrintableForm664(m_part2RootAttributeName, "ž”");

    end;

    macro isEmpty()
        return m_part1.isEmpty() and m_part2.isEmpty();
    end;

    macro getWidth()
        return max(m_part1.getTableWidth(), m_part2.getTableWidth());
    end;

    private macro addHeader()

        switchOutput();

        println();
        println();
        println(strAlign(" §¤¥« 4. ‘âàãªâãà  ®¯¥à æ¨©, ®áãé¥áâ¢«ï¥¬ëå ¯® â¥ªãé¨¬,à áç¥â­ë¬,", getWidth(), STR_ALIGN_CENTER));
        println(strAlign("ª®àà¥á¯®­¤¥­âáª¨¬ áç¥â ¬, áç¥â ¬ ¯® ¢ª« ¤ ¬ (¤¥¯®§¨â ¬)", getWidth(), STR_ALIGN_CENTER));
        println(strAlign("­¥à¥§¨¤¥­â®¢ ¢ ¢ «îâ¥ ®áá¨©áª®© ”¥¤¥à æ¨¨, ¯® áâà ­ ¬ à¥£¨áâà æ¨¨", getWidth(), STR_ALIGN_CENTER));
        println(strAlign("­¥à¥§¨¤¥­â®¢ - ¢« ¤¥«ìæ¥¢ áç¥â®¢", getWidth(), STR_ALIGN_CENTER));

        switchOutput();
    end;

    macro printIssue()

        addHeader();

        m_part1.printIssue();

        m_part2.printIssue();

    end;

    constructorTIssue4PrintableForm664_I2470(part1RootAttributeName, part2RootAttributeName);

end;
