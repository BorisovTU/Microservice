/*
$Name:          f664ProtocolViewIssue2.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 664. Протокол 2 раздела
*/

/**
 * Форма 664. Протокол 2 раздела.
 *
 * @since   03.10.2012
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */


/**
 * Класс протокола.
 */
class (TProtocolView_2867) TProtocolViewIssue2_2867()

    private var m_mainTableWidth;
    private var m_wrongCodeTableWidth;

    macro constructorTProtocolViewIssue2_2867()
        initTProtocolView_2867();
        m_mainTableWidth = 172;
        m_wrongCodeTableWidth = 192;
    end;

    macro getWrongCodeTableWidth()
        return m_wrongCodeTableWidth;
    end;

    macro getMainTableWidth()
        return m_mainTableWidth;
    end;

    macro printIssueHeader()
        println();
        println("РАЗДЕЛ 2");
        println();
    end;

    macro printTableHeader()
        println("┌────────┬────────┬──────────┬──────────┬──────────────────────┬──────────┬─────────────────┬───────────────────────────┬───────────────────────────┬─────────────────────────────────────────────────────────────┐");
        println("│  Код   │  Код   │Код опер. │Код опер. │     Сумма в валюте   │   Дата   │   № документа   │        Счет по дебету     │      Счет по кредиту      │                       Комментарий                           │");
        println("│ страны │ валюты │в отчете  │в платеже │          счета       │документа │                 │                           │                           │                                                             │");
        println("└────────┴────────┴──────────┴──────────┴──────────────────────┴──────────┴─────────────────┴───────────────────────────┴───────────────────────────┴─────────────────────────────────────────────────────────────┘");
    end;

    macro printRowIssue(dataSource)
        var operationCodeOrig = ternary(   (dataSource.operationCodeOrig == dataSource.operationCode)
                                        or (dataSource.operationCodeOrig == "Не задан"), dataSource.operationCodeOrig, "!" + dataSource.operationCodeOrig);

     // │  Код   │  Код   │   Код    │   Код    │     Сумма в валюте   │   Дата   │   № документа   │        Счет по дебету     │      Счет по кредиту      │                   Комментарий
        [ ######   ######  ########## ##########  #####################  ##########  ###############   #########################   #########################  ############################################################ ]
        ( dataSource.countryCode:c,
                   dataSource.currency:c,
                           dataSource.operationCode:r,
                                      operationCodeOrig:r,
                                                 dataSource.sum:r,        dataSource.dateCarry:f,
                                                                                    dataSource.numberDocument:l,
                                                                                                      dataSource.accountPayer,    dataSource.accountReceiver,
                                                                                                                                                             dataSource.comment);
    end;

    macro printDirectionFooter(currentDirection, directionOverall)
        var directionStr;

        if (currentDirection == DEBIT)
            directionStr = "ВСЕГО СПИС";
        else
            directionStr = "ВСЕГО ЗАЧ";
        end;

        [ ##########                              #####################  ](directionStr:l, directionOverall);
        println();
    end;

    macro printDirectionFooterWrong(currentDirection, directionOverall)
        var directionStr;

        if (currentDirection == DEBIT)
            directionStr = "ВСЕГО СПИС";
        else
            directionStr = "ВСЕГО ЗАЧ";
        end;

        [ ##########                                     #####################  ](directionStr:l, directionOverall);
        println();
    end;

    // macro printCountryFooter(currentCountry, currentCurrency, operationOverall)
        // [  ######   ######  ########## #####################  ](currentCountry:c, currentCurrency:c, "ИТОГО":l, operationOverall:r);
    // end;

    // macro printCurrencyFooter(currentCountry, currentCurrency, operationOverall)
        // [  ######   ######  ########## #####################  ](currentCountry:c, currentCurrency:c, "ИТОГО":l, operationOverall:r);
    // end;

    // macro printOperationFooter(currentCountry, currentCurrency, operationOverall)
        // [  ######   ######  ########## #####################  ](currentCountry:c, currentCurrency:c, "ИТОГО":l, operationOverall:r);
    // end;

    macro printTotal(operationOverall)
        [ ##########                              #####################  ]("ИТОГО":r, operationOverall:r);
        println();
    end;

    macro printTotalWrong(operationOverall)
        [ ##########                                     #####################  ]("ИТОГО":r, operationOverall:r);
        println();
    end;

    macro printNoData(width)
        println(strAlign(EMPTY_DATA, width, STR_ALIGN_CENTER));
        println();
    end;

    macro printTurnsWithWrongCodeHeader()
        println("Внимание! Разделы 1 и 2: для перечисленных ниже платежей по операциям списания не задан код валютной операции, либо задан неверно. Платежи не включены в отчет");
        println("┌────────┬────────────┬──────────┬──────────────────────┬──────────┬───────────────────────────┬───────────────────────────┬───────────────┬─────────────────────────────────────────────────────────────┐");
        println("│  Код   │   Валюта   │Код опер. │        Сумма         │   Дата   │      Счет по дебету       │      Счет по кредиту      │  № документа  │                        Комментарий                          │");
        println("│ страны │  платежа   │в платеже │       платежа        │ платежа  │                           │                           │               │                                                             │");
        println("└────────┴────────────┴──────────┴──────────────────────┴──────────┴───────────────────────────┴───────────────────────────┴───────────────┴─────────────────────────────────────────────────────────────┘");
    end;

    macro printRowTurnsWithWrongCode(dataSource)
        [ ######## ############ ########## ###################### ########## ########################### ########################### ############### #############################################################]
        ( dataSource.countryCode,
                   dataSource.currencyCode,
                                dataSource.operationCode,
                                           dataSource.sum,
                                                                  dataSource.dateCarry:f,
                                                                             dataSource.accountPayer,
                                                                                                         dataSource.accountReceiver,
                                                                                                                                     dataSource.numberDocument,
                                                                                                                                                     dataSource.comment
         );
    end;

    constructorTProtocolViewIssue2_2867();
end;