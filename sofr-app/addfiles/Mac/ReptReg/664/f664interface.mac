/*
$Name:          f664interface.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 664. Доступ к операциям формы
*/
/**
 * Форма 664. Доступ к операциям формы.
 *
 * @since   03.10.2012
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

import f664import;

/**
 *  Запуск операции расчета отчета
 */
macro executeCalculationOperation()
    var profiler = TSQLProfiler(getTxtFileName("!F664CalculateProfile"));
    profiler.clear();
    profiler.on();

    objectFactoryInstance.createReportCalculateController().calculate();
end;

/**
 *  Запуск операции печати протокола отчета
 */
macro executePrintOperationProtocol()
    objectFactoryInstance.createProtocolPrintController().show();
end;

/**
 *  Запуск операции печати протокола экспорта
 */
macro executePrintOperationExportProtocol()
    objectFactoryInstance.createKlikoExportController().show();
end;

/**
 *  Запуск операции печати отчета
 */
macro executePrintOperation()
    objectFactoryInstance.createReportPrintController().view();
end;

/**
 *  Запуск операции печати сводного отчета
 */
macro executeSummaryReportPrintOperation()
    objectFactoryInstance.createSummaryReportPrintController().execute();
end;

/**
 *  Запуск операции экспорта в Kliko.exe
 */
macro executeKlikoExportOperation()
    objectFactoryInstance.createKlikoExportController().execute();
end;

/**
 *  Запуск операции округления и нормализации
 */
macro executeNormalizationOperation()
    objectFactoryInstance.createNormalizationController().execute();
end;

установитьФлагВозврата(OK_MACRO_FLAG);
exit(1);
