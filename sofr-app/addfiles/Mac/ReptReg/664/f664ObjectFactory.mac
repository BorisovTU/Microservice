/*
$Name:          f664ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 664. Фабрика объектов
*/

/**
 * Форма 664. Фабрика объектов.
 *
 * @since   03.10.2012
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbObjectFactoryBase) TObjectFactory_2867()
    initRcbObjectFactoryBase();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_2867");
    end;

    /**
     * Создать печатную форму 1 раздела
     */
    macro createIssue1ReportViewController(rootAttributeName : String) : Object
        return genObject("TIssue1ReportViewController_2867", rootAttributeName);
    end;

    /**
     * Создать печатную форму 2 раздела
     */
    macro createIssue2ReportViewController(rootAttributeName : String) : Object
        return genObject("TIssue2ReportViewController_2867", rootAttributeName);
    end;

    /**
     * Создать печатную форму 3 раздела
     */
    macro createIssue3ReportViewController(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue3ReportViewController_2867", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Создать печатную форму 4 раздела
     */
    macro createIssue4ReportViewController(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue4ReportViewController_2867", part1RootAttributeName, part2RootAttributeName);
    end;

    /**
     * Создать печатную форму отчета
     */
    macro createReportPrintController()
        return genObject("TReportPrintController_2867");
    end;

    /**
     * Печать сводной формы
     */
    macro createSummaryReportPrintController()
        return genObject("TSummaryReportPrintController");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TPrintProtocolView", protocolName);
    end;

    /**
     * Создать контроллер экспорта в kliko.exe.
     */
    macro createKlikoExportController()
        return genObject("TKlikoExportController_2867");
    end;

    /**
     * Создать контроллер печати протокола расчета формы
     */
    macro createProtocolPrintController()
        return genObject("TProtocolPrintController_2867");
    end;

    macro createNormalizationController()
        return genObject("TF664NormalizationController");
    end;

    macro createNormalizationProtocolView()
        return genObject("TF664NormalizationProtocolView");
    end;
end;

class (TObjectFactory_2867) TObjectFactory_3656()
    initTObjectFactory_2867();

    /**
     * Создать печатную форму отчета
     */
    macro createReportPrintController()
        return genObject("TReportPrintController_3656");
    end;
end;

class (TObjectFactory_3656) TObjectFactory_4212()
    initTObjectFactory_3656();

    macro createReportPrintController()
        return genObject("TReportPrintController_4212");
    end;

    macro createIssue1ReportViewController(rootAttributeName : String) : Object
        return genObject("TIssue1ReportViewController_4212", rootAttributeName);
    end;

    macro createIssue2ReportViewController(rootAttributeName : String) : Object
        return genObject("TIssue2ReportViewController_4212", rootAttributeName);
    end;

    macro createIssue3ReportViewController(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue3ReportViewController_4212", part1RootAttributeName, part2RootAttributeName);
    end;

    macro createIssue4ReportViewController(part1RootAttributeName : String, part2RootAttributeName : String) : Object
        return genObject("TIssue4ReportViewController_4212", part1RootAttributeName, part2RootAttributeName);
    end;
end;

class (TObjectFactory_4212) TObjectFactory_4637()
    initTObjectFactory_4212();

    macro createReportPrintController()
        return genObject("TReportPrintController_4637");
    end;

    macro createSummaryReportPrintController()
        return genObject("TSummaryReportPrintController_4637");
    end;

    macro createReportView()
        return null;
    end;
end;

if (objectFactoryInstance == null)
    if   (rcbApplication.currentReport.context.period.endDate >= RCB_I4637_DATE1)
        objectFactoryInstance = TObjectFactory_4637();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TObjectFactory_4212();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3656_DATE)
        objectFactoryInstance = TObjectFactory_3656();
    else
        objectFactoryInstance = TObjectFactory_2867();
    end;
end;