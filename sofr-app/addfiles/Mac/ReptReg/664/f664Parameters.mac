/**
 * Форма 664. Параметры, используемые в выпуске отчета.
 *
 * @since   03.10.2012
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

import ReptCbInter;
import BankInter;
import RcbCoreInter;

/***************************************************************************************************
 *  Константы
 **************************************************************************************************/
const DEBIT  = "0";
const CREDIT = "1";

const ACCOUNT_KIND_BN = "БН";
const ACCOUNT_KIND_UN = "ЮН";

/**
 *  Параметры отчета
 */
class TParameters(accountKind : String, rootAttributeName : String, reportIssue : Integer)

    private var m_beginDate : Date;
    private var m_endDate : Date;
    private var m_planNumber : Integer;
    private var m_accountFilter : Object;
    private var m_accountKind : String;
    private var m_reportIssue : Integer;
    private var m_rootAttributeName : String;

    macro getBeginDate()
        return m_beginDate;
    end;

    macro getEndDate()
        return m_endDate;
    end;

    macro getPlanNumber()
        return m_planNumber;
    end;

    macro getAccountFilter()
        return m_accountFilter;
    end;

    macro getAccountKind()
        return m_accountKind;
    end;

    macro getRootAttributeName()
        return m_rootAttributeName;
    end;

    macro getReportIssue()
        return m_reportIssue;
    end;

    private macro constructorTParameters(accountKind : String, rootAttributeName : String, reportIssue : Integer)
        m_beginDate = rcbApplication().currentReport.context.period.beginDate;
        m_endDate = rcbApplication().currentReport.context.period.endDate;
        m_planNumber = rcbApplication().parameters.balancePlanNumber;
        m_accountFilter = RcbAccountFilter();
        m_accountKind = accountKind;
        m_reportIssue = reportIssue;
        m_rootAttributeName = rootAttributeName;
    end;

    constructorTParameters(accountKind, rootAttributeName, reportIssue);
end;

/**
 *  Параметры 1-го и 2-го разделов отчета
 */
class (TParameters) TParametersCbIssue12()

    initTParameters("", "", 12);

end;

/**
 *  Параметры 3-го и 4-го разделов отчета
 */
class (TParameters) TParametersCbIssue34(accountKind)

    initTParameters(accountKind, "", 34);

end;
