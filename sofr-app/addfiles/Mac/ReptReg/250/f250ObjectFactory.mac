/*
$Name:          f250ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 250. Фабрика объектов
*/

/**
 * @since   02.10.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbObjectFactoryBase) TF250ObjectFactory()
    initRcbObjectFactoryBase();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF250Report", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if (partId == "1.1")
            return genObject("TF250Part1SubPart1", partId, compositeValue);
        elif (partId == "1.2")
            return genObject("TF250Part1SubPart2", partId, compositeValue);
        elif (partId == "2")
            return genObject("TF250Part2", partId, compositeValue);
        end;
    end;

    macro createAttributePart1(okato : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF250AttributePart1", okato, part, compositeValue);
    end;

    macro createAttributePart2(okato : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF250AttributePart2", okato, part, compositeValue);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF250ReportCalculateController");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF250CalculateProtocolView", protocolName);
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF250DataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF250DataSourceFilters");
    end;

    macro createReportView() : RcbReportView
        return genObject("TF250ReportView");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TF250PrintProtocolView", protocolName);
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF250ReportPrintController");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        if (rcbApplication().currentReport.context.period.endDate >= RCB_I2851_DATE)
            return genObject("TF250PrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2742_DATE)
            return genObject("TPrintableView_2742", formName, formOkudCode, formPeriodicity, periodFormat);
        elif (rcbApplication().currentReport.context.period.endDate >= RCB_I2332_DATE)
            return genObject("TPrintableView_2332", formName, formOkudCode, formPeriodicity, periodFormat);
        else
            return genObject("TPrintableView", formName, formOkudCode, formPeriodicity, periodFormat);
        end;
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF250KlikoExportController");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF250PtkPsdExportController");
    end;
end;

class (TF250ObjectFactory) TF250ObjectFactory_4212()
    initTF250ObjectFactory();

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if (partId == "1.1")
            return genObject("TF250Part1SubPart1_4212", partId, compositeValue);
        elif (partId == "1.2")
            return genObject("TF250Part1SubPart2", partId, compositeValue);
        elif (partId == "2")
            return genObject("TF250Part2_4212", partId, compositeValue);
        end;
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF250DataSources_4212", protocolView);
    end;

    macro createReportView() : RcbReportView
        return genObject("TF250ReportView_4212");
    end;

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TPrintableView_4212", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF250ReportPrintController_4212");
    end;
end;

class (TF250ObjectFactory_4212) TF250ObjectFactory_4637()
    initTF250ObjectFactory_4212();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity, periodFormat : Integer)
        return genObject("TF250PrintableView_4637", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createReportView() : RcbReportView
        return genObject("TF250ReportView_4637");
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF250DataSources_4637", protocolView);
    end;

    macro createTotalUserAttributePart1(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF250TotalUserAttributePart1", id, part, compositeValue);
    end;

    macro createAttributePart2(okato : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF250AttributePart2_4637", okato, part, compositeValue);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        if   (partId == "1.1")
            return genObject("TF250Part1SubPart1_4637", partId, compositeValue);
        elif (partId == "1.2")
            return genObject("TF250Part1SubPart2", partId, compositeValue);
        elif (partId == "2")
            return genObject("TF250Part2_4637", partId, compositeValue);
        end;
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF250KlikoExportController_4637");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF250PtkPsdExportController_4637");
    end;
end;

if (objectFactoryInstance == null)
    if   (RcbApplication().currentReport.context.period.endDate >= RCB_I4637_DATE)
        objectFactoryInstance = TF250ObjectFactory_4637();
    elif (RcbApplication().currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TF250ObjectFactory_4212();
    else
    objectFactoryInstance = TF250ObjectFactory();
end;

end;
