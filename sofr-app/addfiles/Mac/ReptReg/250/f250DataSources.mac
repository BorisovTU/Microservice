/*
$Name:          f250DataSources.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 250. Источники данных
*/

/**
 * @since   02.10.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

import testlib;
var p = tsqlprofiler(gettxtfilename("!250!"));
p.clear();
p.on();

class (RcbDataSource) TF250Part1SubPart1DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)

        var query = "WITH dataCards AS"
            + "\n" +"("
            + "\n" + "SELECT cards.t_okato         AS t_okato,"
            + "\n" + "       cards.t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "       cards.t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "       cards.t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "       cards.t_cardKind                AS t_cardKind,"
            + "\n" + "       SUM(cards.t_numberOwners)           AS t_numbClientPaymentSystem,"
            + "\n" + "       SUM(cards.t_totalNumb)           AS t_numbPCEndDate,"
            + "\n" + "       SUM(cards.t_usedCards)           AS t_numbPCUsingReportPeriod,"
            + "\n" + "       SUM(cards.t_sumOwn)        AS t_sumPCHoldersCash,"
            + "\n" + "       SUM(cards.t_sumLoans)        AS t_sumPCHoldersCredit,"
            + "\n" + "       SUM(cards.t_numbCashNative)           AS t_numbPCObtainCashRF,"
            + "\n" + "       SUM(cards.t_sumCashNative)        AS t_sumPCObtainCashRF,"
            + "\n" + "       SUM(cards.t_numbCashForeign)           AS t_numbPCObtainCashAbroad,"
            + "\n" + "       SUM(cards.t_sumCashForeign)        AS t_sumPCObtainCashAbroad,"
            + "\n" + "       0           AS t_totalNumbNonCashOp,"
            + "\n" + "       0        AS t_totalSumNonCashOp,"
            + "\n" + "       0           AS t_numbNonCashInternetOp,"
            + "\n" + "       0        AS t_sumNonCashInternetOp,"
            + "\n" + "       0          AS t_numbNonCashMobilOp,"
            + "\n" + "       0       AS t_sumNonCashMobilOp,"
            + "\n" + "       SUM(cards.t_numbNonCashNative)          AS t_numbNonCashOpRF,"
            + "\n" + "       SUM(cards.t_sumNonCashNative)       AS t_sumNonCashOpRF,"
            + "\n" + "       SUM(cards.t_numbNonCashForeign)          AS t_numbNonCashOpAbroad,"
            + "\n" + "       SUM(cards.t_sumNonCashForeign)       AS t_sumNonCashOpAbroad,"
            + "\n" + "       0          AS t_numbNonCashOpOnlineStore,"
            + "\n" + "       0       AS t_sumNonCashOpOnlineStore,"
            + "\n" + "       SUM(cards.t_numbNonCashCustoms)          AS t_numbNonCashOpCustoms,"
            + "\n" + "       SUM(cards.t_sumNonCashCustoms)       AS t_sumNonCashOpCustoms,"
            + "\n" + "       SUM(cards.t_numbNonCashOther)          AS t_numbNonCashOpOther,"
            + "\n" + "       SUM(cards.t_sumNonCashOther)       AS t_sumNonCashOpOther,"
            + "\n" + "       CASE"
            + "\n" + "           WHEN grouping(cards.t_okato) = 1 AND grouping(cards.t_cardKind) = 1 AND grouping(cards.t_codePaymentSystem) = 1 AND grouping(cards.t_namePaymentSystem) = 1"
            + "\n" + "             THEN 1"
            + "\n" + "           ELSE 0"
            + "\n" + "       END                                         AS t_totalCreditOrg,"
            + "\n" + "       CASE"
            + "\n" + "           WHEN grouping(cards.t_okato) = 0 AND grouping(cards.t_cardKind) = 1 AND grouping(cards.t_codePaymentSystem) = 1 AND grouping(cards.t_namePaymentSystem) = 1"
            + "\n" + "             THEN 1"
            + "\n" + "           ELSE 0"
            + "\n" + "       END                                         AS t_totalOkato,"
            + "\n" + "       CASE"
            + "\n" + "           WHEN grouping(cards.t_okato) = 0 AND grouping(cards.t_cardKind) = 1 AND grouping(cards.t_codePaymentSystem) = 0 AND grouping(cards.t_namePaymentSystem) = 0"
            + "\n" + "             THEN 1"
            + "\n" + "           ELSE 0"
            + "\n" + "       END                                         AS t_totalPaymentSystem,"
            + "\n" + "       CASE"
            + "\n" + "           WHEN grouping(cards.t_okato) = 0 AND grouping(cards.t_cardKind) = 0 AND grouping(cards.t_codePaymentSystem) = 1 AND grouping(cards.t_namePaymentSystem) = 1"
            + "\n" + "             THEN 1"
            + "\n" + "           ELSE 0"
            + "\n" + "       END                                         AS t_totalKindOkato,"
            + "\n" + "       CASE"
            + "\n" + "           WHEN grouping(cards.t_okato) = 1 AND grouping(cards.t_cardKind) = 0 AND grouping(cards.t_codePaymentSystem) = 1 AND grouping(cards.t_namePaymentSystem) = 1"
            + "\n" + "             THEN 1"
            + "\n" + "           ELSE 0"
            + "\n" + "       END                                         AS t_totalKindCreditOrganization"
            + "\n" + "    FROM repRtlCardsPayments_vw cards"
            + "\n" + " GROUP BY ROLLUP ((cards.t_okato, t_nameTerritory), (cards.t_codePaymentSystem, cards.t_namePaymentSystem)), ROLLUP(cards.t_cardKind)"
            + "\n" + ")"
            + "\n" + "SELECT *"
            + "\n" + "  FROM ("
            + "\n" + "        SELECT t_okato       AS t_okato,"
            + "\n" + "               t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "               t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "               t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "               t_cardKind       AS t_cardKind,"
            + "\n" + "               t_numbClientPaymentSystem       AS t_numbClientPaymentSystem,"
            + "\n" + "               t_numbPCEndDate       AS t_numbPCEndDate,"
            + "\n" + "               t_numbPCUsingReportPeriod       AS t_numbPCUsingReportPeriod,"
            + "\n" + "               t_sumPCHoldersCash       AS t_sumPCHoldersCash,"
            + "\n" + "               t_sumPCHoldersCredit       AS t_sumPCHoldersCredit,"
            + "\n" + "               t_numbPCObtainCashRF       AS t_numbPCObtainCashRF,"
            + "\n" + "               t_sumPCObtainCashRF       AS t_sumPCObtainCashRF,"
            + "\n" + "               t_numbPCObtainCashAbroad       AS t_numbPCObtainCashAbroad,"
            + "\n" + "               t_sumPCObtainCashAbroad       AS t_sumPCObtainCashAbroad,"
            + "\n" + "               t_totalNumbNonCashOp       AS t_totalNumbNonCashOp,"
            + "\n" + "               t_totalSumNonCashOp       AS t_totalSumNonCashOp,"
            + "\n" + "               t_numbNonCashInternetOp       AS t_numbNonCashInternetOp,"
            + "\n" + "               t_sumNonCashInternetOp       AS t_sumNonCashInternetOp,"
            + "\n" + "               t_numbNonCashMobilOp         AS t_numbNonCashMobilOp,"
            + "\n" + "               t_sumNonCashMobilOp         AS t_sumNonCashMobilOp,"
            + "\n" + "               t_numbNonCashOpRF         AS t_numbNonCashOpRF,"
            + "\n" + "               t_sumNonCashOpRF         AS t_sumNonCashOpRF,"
            + "\n" + "               t_numbNonCashOpAbroad         AS t_numbNonCashOpAbroad,"
            + "\n" + "               t_sumNonCashOpAbroad         AS t_sumNonCashOpAbroad,"
            + "\n" + "               t_numbNonCashOpOnlineStore         AS t_numbNonCashOpOnlineStore,"
            + "\n" + "               t_sumNonCashOpOnlineStore         AS t_sumNonCashOpOnlineStore,"
            + "\n" + "               t_numbNonCashOpCustoms         AS t_numbNonCashOpCustoms,"
            + "\n" + "               t_sumNonCashOpCustoms         AS t_sumNonCashOpCustoms,"
            + "\n" + "               t_numbNonCashOpOther         AS t_numbNonCashOpOther,"
            + "\n" + "               t_sumNonCashOpOther         AS t_sumNonCashOpOther,"
            + "\n" + "               t_totalCreditOrg         AS t_totalCreditOrg,"
            + "\n" + "               t_totalOkato         AS t_totalOkato,"
            + "\n" + "               t_totalPaymentSystem         AS t_totalPaymentSystem,"
            + "\n" + "               t_totalKindOkato         AS t_totalKindOkato,"
            + "\n" + "               t_totalKindCreditOrganization         AS t_totalKindCreditOrganization"
            + "\n" + "           FROM dataCards"
            + "\n" + "       UNION ALL"
            + "\n" + "       SELECT cards.t_okato         AS t_okato,"
            + "\n" + "              cards.t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "              cards.t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "              cards.t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "              'ДО'                AS t_cardKind,"
            + "\n" + "              SUM(cards.t_numbClientPaymentSystem)           AS t_numbClientPaymentSystem,"
            + "\n" + "              SUM(cards.t_numbPCEndDate)           AS t_numbPCEndDate,"
            + "\n" + "              SUM(cards.t_numbPCUsingReportPeriod)           AS t_numbPCUsingReportPeriod,"
            + "\n" + "              SUM(cards.t_sumPCHoldersCash)        AS t_sumPCHoldersCash,"
            + "\n" + "              SUM(cards.t_sumPCHoldersCredit)        AS t_sumPCHoldersCredit,"
            + "\n" + "              SUM(cards.t_numbPCObtainCashRF)           AS t_numbPCObtainCashRF,"
            + "\n" + "              SUM(cards.t_sumPCObtainCashRF)        AS t_sumPCObtainCashRF,"
            + "\n" + "              SUM(cards.t_numbPCObtainCashAbroad)           AS t_numbPCObtainCashAbroad,"
            + "\n" + "              SUM(cards.t_sumPCObtainCashAbroad)        AS t_sumPCObtainCashAbroad,"
            + "\n" + "              0           AS t_totalNumbNonCashOp,"
            + "\n" + "              0        AS t_totalSumNonCashOp,"
            + "\n" + "              0           AS t_numbNonCashInternetOp,"
            + "\n" + "              0        AS t_sumNonCashInternetOp,"
            + "\n" + "              0          AS t_numbNonCashMobilOp,"
            + "\n" + "              0       AS t_sumNonCashMobilOp,"
            + "\n" + "              SUM(cards.t_numbNonCashOpRF)          AS t_numbNonCashOpRF,"
            + "\n" + "              SUM(cards.t_sumNonCashOpRF)       AS t_sumNonCashOpRF,"
            + "\n" + "              SUM(cards.t_numbNonCashOpAbroad)          AS t_numbNonCashOpAbroad,"
            + "\n" + "              SUM(cards.t_sumNonCashOpAbroad)       AS t_sumNonCashOpAbroad,"
            + "\n" + "              0          AS t_numbNonCashOpOnlineStore,"
            + "\n" + "              0       AS t_sumNonCashOpOnlineStore,"
            + "\n" + "              SUM(cards.t_numbNonCashOpCustoms)          AS t_numbNonCashOpCustoms,"
            + "\n" + "              SUM(cards.t_sumNonCashOpCustoms)       AS t_sumNonCashOpCustoms,"
            + "\n" + "              SUM(cards.t_numbNonCashOpOther)          AS t_numbNonCashOpOther,"
            + "\n" + "              SUM(cards.t_sumNonCashOpOther)       AS t_sumNonCashOpOther,"
            + "\n" + "              t_totalCreditOrg                                         AS t_totalCreditOrg,"
            + "\n" + "              t_totalOkato                                         AS t_totalOkato,"
            + "\n" + "              t_totalPaymentSystem                                         AS t_totalPaymentSystem,"
            + "\n" + "              t_totalKindOkato                                         AS t_totalKindOkato,"
            + "\n" + "              t_totalKindCreditOrganization                                         AS t_totalKindCreditOrganization"
            + "\n" + "           FROM dataCards cards"
            + "\n" + "           WHERE cards.t_cardKind = 'Д' or cards.t_cardKind = 'О'"
            + "\n" + "          GROUP BY t_okato, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem, t_totalCreditOrg, t_totalOkato, t_totalPaymentSystem, t_totalKindOkato, t_totalKindCreditOrganization"
            + "\n" + "        )"
            + "\n" + "ORDER BY t_okato, t_namePaymentSystem ,"
            + "\n" + "         CASE t_cardKind"
            + "\n" + "           WHEN 'Д'"
            + "\n" + "             THEN '1'"
            + "\n" + "           WHEN 'О'"
            + "\n" + "             THEN '2'"
            + "\n" + "           WHEN 'К'"
            + "\n" + "             THEN '3'"
            + "\n" + "          ELSE '4' END";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_numbClientPaymentSystem", V_INTEGER);
        dataSet.SetFieldType("t_numbPCEndDate", V_INTEGER);
        dataSet.SetFieldType("t_numbPCUsingReportPeriod", V_INTEGER);
        dataSet.SetFieldType("t_sumPCHoldersCash", V_MONEY);
        dataSet.SetFieldType("t_sumPCHoldersCredit", V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashRF", V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashRF", V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashAbroad", V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashAbroad", V_MONEY);
        dataSet.SetFieldType("t_totalNumbNonCashOp", V_INTEGER);
        dataSet.SetFieldType("t_totalSumNonCashOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashInternetOp", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashInternetOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashMobilOp", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashMobilOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpRF", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpRF", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpAbroad", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpAbroad", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOnlineStore", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOnlineStore", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpCustoms", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpCustoms", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOther", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOther", V_MONEY);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getPaymentSystem()
        var query = "SELECT cards.t_okato               AS t_okato,"
            + "\n" + "      cards.t_nameTerritory   AS t_nameTerritory,"
            + "\n" + "      cards.t_codePaymentSystem   AS t_codePaymentSystem,"
            + "\n" + "      cards.t_namePaymentSystem   AS t_namePaymentSystem"
            + "\n" + "  FROM repRtlCardsPayments_vw cards"
            + "\n" + "GROUP BY (t_okato, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem)"
            + "\n" + "ORDER BY t_okato, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getOkato()
        var query = "SELECT cards.t_okato               AS t_okato"
            + "\n" + "  FROM repRtlCardsPayments_vw cards"
            + "\n" + "GROUP BY t_okato"
            + "\n" + "ORDER BY t_okato";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part1SubPart1DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initRcbDataSource("1.1", protocolView, dataSources);
    end;

    constructorTF250Part1SubPart1DataSource(protocolView, dataSources);
end;

class (TF250Part1SubPart1DataSource) TF250Part1SubPart1DataSource_4212(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)

//        var query = "WITH dataCards AS "
        var query = "WITH repRtlCardsPayments_vw AS ("
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'VISA' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 1000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'visa'  AS t_namePaymentSystem,'Д' AS t_cardKind,1 AS t_processingCardMethod,0 AS t_operationMethod,1000 AS t_sumOwn FROM DUAL"
+ "\n" +" Union all                                                                                                                                                                                                   "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'VISA' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 2000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'visa'  AS t_namePaymentSystem,'О' AS t_cardKind,1 AS t_processingCardMethod,0 AS t_operationMethod,2000 AS t_sumOwn FROM DUAL "
+ "\n" +" union all                                                                                                                                                                                                   "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'VISA' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 3000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'visa'  AS t_namePaymentSystem,'Д' AS t_cardKind,1 AS t_processingCardMethod,0 AS t_operationMethod,3000 AS t_sumOwn FROM DUAL "
+ "\n" +" Union all                                                                                                                                                                                                   "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'VISA' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 4000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'visa'  AS t_namePaymentSystem,'О' AS t_cardKind,0 AS t_processingCardMethod,1 AS t_operationMethod,4000 AS t_sumOwn FROM DUAL "
+ "\n" +"union all                                                                                                                                                                                                    "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'master' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 5000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'master'  AS t_namePaymentSystem,'Д' AS t_cardKind,0 AS t_processingCardMethod,0 AS t_operationMethod,5000 AS t_sumOwn FROM DUAL"
+ "\n" +" Union all                                                                                                                                                                                                      "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'master' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 6000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'master'  AS t_namePaymentSystem,'О' AS t_cardKind,1 AS t_processingCardMethod,1 AS t_operationMethod,6000 AS t_sumOwn FROM DUAL"
+ "\n" +" union all                                                                                                                                                                                                      "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'master' AS t_codePaymentSystem  ,0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 7000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'master'  AS t_namePaymentSystem,'Д' AS t_cardKind,0 AS t_processingCardMethod,1 AS t_operationMethod,7000 AS t_sumOwn FROM DUAL"
+ "\n" +" Union all                                                                                                                                                                                                      "
+ "\n" +" select '12' as t_okato,'12' AS t_nameTerritory,'master' AS t_codePaymentSystem, 0   AS t_numberOwners, 0 t_totalNumb,0 t_usedCards, 0 t_sumLoans, 0 t_numbCashNative, 8000 t_sumCashNative,0 t_numbCashForeign, 0 t_sumCashForeign, 0 t_numbNonCashNative, 0 t_sumNonCashNative, 0 t_numbNonCashForeign, 0 t_sumNonCashForeign, 0 t_numbNonCashCustoms,0 t_sumNonCashCustoms, 0 t_numbNonCashOther, 0 t_sumNonCashOther,'master'  AS t_namePaymentSystem,'О' AS t_cardKind,1 AS t_processingCardMethod,0 AS t_operationMethod,8000 AS t_sumOwn FROM DUAL"
+ "\n" +"   ),"
            + "\n" +"dataCards AS("
            + "\n" + "   SELECT cards.t_okato         AS t_okato,"
            + "\n" + "          cards.t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "          cards.t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "          cards.t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "          cards.t_cardKind                AS t_cardKind,"
            + "\n" + "          SUM(cards.t_numberOwners)           AS t_numbClientPaymentSystem,"
            + "\n" + "          SUM(cards.t_totalNumb)           AS t_numbPCEndDate,"
            + "\n" + "          SUM(cards.t_usedCards)           AS t_numbPCUsingReportPeriod,"
            + "\n" + "          SUM(cards.t_sumOwn)        AS t_sumPCHoldersCash,"
            + "\n" + "          SUM(cards.t_sumLoans)        AS t_sumPCHoldersCredit,"
            + "\n" + "          SUM(cards.t_numbCashNative)           AS t_numbPCObtainCashRF,"
            + "\n" + "          SUM(cards.t_sumCashNative)        AS t_sumPCObtainCashRF,"
            + "\n" + "          SUM(cards.t_numbCashForeign)           AS t_numbPCObtainCashAbroad,"
            + "\n" + "          SUM(cards.t_sumCashForeign)        AS t_sumPCObtainCashAbroad,"
            + "\n" + "          0           AS t_totalNumbNonCashOp,"
            + "\n" + "          0        AS t_totalSumNonCashOp,"
            + "\n" + "          0           AS t_numbNonCashInternetOp,"
            + "\n" + "          0        AS t_sumNonCashInternetOp,"
            + "\n" + "          0          AS t_numbNonCashMobilOp,"
            + "\n" + "          0       AS t_sumNonCashMobilOp,"
            + "\n" + "          SUM(cards.t_numbNonCashNative)          AS t_numbNonCashOpRF,"
            + "\n" + "          SUM(cards.t_sumNonCashNative)       AS t_sumNonCashOpRF,"
            + "\n" + "          SUM(cards.t_numbNonCashForeign)          AS t_numbNonCashOpAbroad,"
            + "\n" + "          SUM(cards.t_sumNonCashForeign)       AS t_sumNonCashOpAbroad,"
            + "\n" + "          0          AS t_numbNonCashOpOnlineStore,"
            + "\n" + "          0       AS t_sumNonCashOpOnlineStore,"
            + "\n" + "          SUM(cards.t_numbNonCashCustoms)          AS t_numbNonCashOpCustoms,"
            + "\n" + "          SUM(cards.t_sumNonCashCustoms)       AS t_sumNonCashOpCustoms,"
            + "\n" + "          SUM(cards.t_numbNonCashOther)          AS t_numbNonCashOpOther,"
            + "\n" + "          SUM(cards.t_sumNonCashOther)       AS t_sumNonCashOpOther,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 31, 1, 23, 1, 15, 1, 0) AS t_totalCreditOrg,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 27, 1, 0) AS t_totalOkato,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 25, 1, 0) AS t_totalPaymentSystem,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 26, 1, 0) AS t_totalKindOkato,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 30, 1, 0) AS t_totalKindCreditOrganization,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 23, 1, 0) AS t_totalContactlessCards,"
            + "\n" + "          DECODE(GROUPING_ID(cards.t_operationMethod,cards.t_processingCardMethod,cards.t_okato,cards.t_codePaymentSystem, cards.t_cardKind), 15, 1, 0) AS t_totalContactlessTechnology"
            + "\n" + "     FROM repRtlCardsPayments_vw cards"
            + "\n" + " GROUP BY GROUPING SETS((cards.t_okato, t_nameTerritory, cards.t_codePaymentSystem, cards.t_namePaymentSystem,cards.t_cardKind), "
            + "\n" + "                        (cards.t_okato, t_nameTerritory, cards.t_codePaymentSystem, cards.t_namePaymentSystem),                  "
            + "\n" + "                        (cards.t_okato, t_nameTerritory, cards.t_cardKind),                                                      "
            + "\n" + "                        (cards.t_okato, t_nameTerritory),                                                                        "
            + "\n" + "                        (cards.t_cardKind),                                                                                      "
            + "\n" + "                        (cards.t_processingCardMethod),                                                                          "
            + "\n" + "                        (cards.t_operationMethod),                                                                               "
            + "\n" + "                        ())                                                                                                      "
            + "\n" + "   HAVING (cards.t_operationMethod != 0 or cards.t_operationMethod IS NULL)           "
            + "\n" + "      AND (cards.t_processingCardMethod != 0 or cards.t_processingCardMethod IS NULL) "
            + "\n" + ")"
            + "\n" + "SELECT *"
            + "\n" + "  FROM ("
            + "\n" + "        SELECT t_okato       AS t_okato,"
            + "\n" + "               t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "               t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "               t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "               t_cardKind       AS t_cardKind,"
            + "\n" + "               t_numbClientPaymentSystem       AS t_numbClientPaymentSystem,"
            + "\n" + "               t_numbPCEndDate       AS t_numbPCEndDate,"
            + "\n" + "               t_numbPCUsingReportPeriod       AS t_numbPCUsingReportPeriod,"
            + "\n" + "               t_sumPCHoldersCash       AS t_sumPCHoldersCash,"
            + "\n" + "               t_sumPCHoldersCredit       AS t_sumPCHoldersCredit,"
            + "\n" + "               t_numbPCObtainCashRF       AS t_numbPCObtainCashRF,"
            + "\n" + "               t_sumPCObtainCashRF       AS t_sumPCObtainCashRF,"
            + "\n" + "               t_numbPCObtainCashAbroad       AS t_numbPCObtainCashAbroad,"
            + "\n" + "               t_sumPCObtainCashAbroad       AS t_sumPCObtainCashAbroad,"
            + "\n" + "               t_totalNumbNonCashOp       AS t_totalNumbNonCashOp,"
            + "\n" + "               t_totalSumNonCashOp       AS t_totalSumNonCashOp,"
            + "\n" + "               t_numbNonCashInternetOp       AS t_numbNonCashInternetOp,"
            + "\n" + "               t_sumNonCashInternetOp       AS t_sumNonCashInternetOp,"
            + "\n" + "               t_numbNonCashMobilOp         AS t_numbNonCashMobilOp,"
            + "\n" + "               t_sumNonCashMobilOp         AS t_sumNonCashMobilOp,"
            + "\n" + "               t_numbNonCashOpRF         AS t_numbNonCashOpRF,"
            + "\n" + "               t_sumNonCashOpRF         AS t_sumNonCashOpRF,"
            + "\n" + "               t_numbNonCashOpAbroad         AS t_numbNonCashOpAbroad,"
            + "\n" + "               t_sumNonCashOpAbroad         AS t_sumNonCashOpAbroad,"
            + "\n" + "               t_numbNonCashOpOnlineStore         AS t_numbNonCashOpOnlineStore,"
            + "\n" + "               t_sumNonCashOpOnlineStore         AS t_sumNonCashOpOnlineStore,"
            + "\n" + "               t_numbNonCashOpCustoms         AS t_numbNonCashOpCustoms,"
            + "\n" + "               t_sumNonCashOpCustoms         AS t_sumNonCashOpCustoms,"
            + "\n" + "               t_numbNonCashOpOther         AS t_numbNonCashOpOther,"
            + "\n" + "               t_sumNonCashOpOther         AS t_sumNonCashOpOther,"
            + "\n" + "               t_totalCreditOrg         AS t_totalCreditOrg,"
            + "\n" + "               t_totalOkato         AS t_totalOkato,"
            + "\n" + "               t_totalPaymentSystem         AS t_totalPaymentSystem,"
            + "\n" + "               t_totalKindOkato         AS t_totalKindOkato,"
            + "\n" + "               t_totalKindCreditOrganization         AS t_totalKindCreditOrganization,"
            + "\n" + "               t_totalContactlessCards         AS t_totalContactlessCards,"
            + "\n" + "               t_totalContactlessTechnology         AS t_totalContactlessTechnology"
            + "\n" + "          FROM dataCards"
            + "\n" + "       UNION ALL"
            + "\n" + "       SELECT cards.t_okato         AS t_okato,"
            + "\n" + "              cards.t_nameTerritory       AS t_nameTerritory,"
            + "\n" + "              cards.t_codePaymentSystem       AS t_codePaymentSystem,"
            + "\n" + "              cards.t_namePaymentSystem       AS t_namePaymentSystem,"
            + "\n" + "              'ДО'                AS t_cardKind,"
            + "\n" + "              SUM(cards.t_numbClientPaymentSystem)           AS t_numbClientPaymentSystem,"
            + "\n" + "              SUM(cards.t_numbPCEndDate)           AS t_numbPCEndDate,"
            + "\n" + "              SUM(cards.t_numbPCUsingReportPeriod)           AS t_numbPCUsingReportPeriod,"
            + "\n" + "              SUM(cards.t_sumPCHoldersCash)        AS t_sumPCHoldersCash,"
            + "\n" + "              SUM(cards.t_sumPCHoldersCredit)        AS t_sumPCHoldersCredit,"
            + "\n" + "              SUM(cards.t_numbPCObtainCashRF)           AS t_numbPCObtainCashRF,"
            + "\n" + "              SUM(cards.t_sumPCObtainCashRF)        AS t_sumPCObtainCashRF,"
            + "\n" + "              SUM(cards.t_numbPCObtainCashAbroad)           AS t_numbPCObtainCashAbroad,"
            + "\n" + "              SUM(cards.t_sumPCObtainCashAbroad)        AS t_sumPCObtainCashAbroad,"
            + "\n" + "              0           AS t_totalNumbNonCashOp,"
            + "\n" + "              0        AS t_totalSumNonCashOp,"
            + "\n" + "              0           AS t_numbNonCashInternetOp,"
            + "\n" + "              0        AS t_sumNonCashInternetOp,"
            + "\n" + "              0          AS t_numbNonCashMobilOp,"
            + "\n" + "              0       AS t_sumNonCashMobilOp,"
            + "\n" + "              SUM(cards.t_numbNonCashOpRF)          AS t_numbNonCashOpRF,"
            + "\n" + "              SUM(cards.t_sumNonCashOpRF)       AS t_sumNonCashOpRF,"
            + "\n" + "              SUM(cards.t_numbNonCashOpAbroad)          AS t_numbNonCashOpAbroad,"
            + "\n" + "              SUM(cards.t_sumNonCashOpAbroad)       AS t_sumNonCashOpAbroad,"
            + "\n" + "              0          AS t_numbNonCashOpOnlineStore,"
            + "\n" + "              0       AS t_sumNonCashOpOnlineStore,"
            + "\n" + "              SUM(cards.t_numbNonCashOpCustoms)          AS t_numbNonCashOpCustoms,"
            + "\n" + "              SUM(cards.t_sumNonCashOpCustoms)       AS t_sumNonCashOpCustoms,"
            + "\n" + "              SUM(cards.t_numbNonCashOpOther)          AS t_numbNonCashOpOther,"
            + "\n" + "              SUM(cards.t_sumNonCashOpOther)       AS t_sumNonCashOpOther,"
            + "\n" + "              t_totalCreditOrg                                         AS t_totalCreditOrg,"
            + "\n" + "              t_totalOkato                                         AS t_totalOkato,"
            + "\n" + "              t_totalPaymentSystem                                         AS t_totalPaymentSystem,"
            + "\n" + "              t_totalKindOkato                                         AS t_totalKindOkato,"
            + "\n" + "              t_totalKindCreditOrganization    AS t_totalKindCreditOrganization,"
            + "\n" + "              0    AS t_totalContactlessCards,"
            + "\n" + "              0    AS t_totalContactlessTechnology"
            + "\n" + "           FROM dataCards cards"
            + "\n" + "           WHERE cards.t_cardKind = 'Д' or cards.t_cardKind = 'О'"
            + "\n" + "          GROUP BY t_okato, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem, t_totalCreditOrg, t_totalOkato, t_totalPaymentSystem, t_totalKindOkato, t_totalKindCreditOrganization"
            + "\n" + "        )"
            + "\n" + "ORDER BY t_okato, t_namePaymentSystem,"
            + "\n" + "         CASE t_cardKind"
            + "\n" + "           WHEN 'Д'"
            + "\n" + "             THEN '1'"
            + "\n" + "           WHEN 'О'"
            + "\n" + "             THEN '2'"
            + "\n" + "           WHEN 'К'"
            + "\n" + "             THEN '3'"
            + "\n" + "          ELSE '4' END";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_numbClientPaymentSystem", V_INTEGER);
        dataSet.SetFieldType("t_numbPCEndDate", V_INTEGER);
        dataSet.SetFieldType("t_numbPCUsingReportPeriod", V_INTEGER);
        dataSet.SetFieldType("t_sumPCHoldersCash", V_MONEY);
        dataSet.SetFieldType("t_sumPCHoldersCredit", V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashRF", V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashRF", V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashAbroad", V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashAbroad", V_MONEY);
        dataSet.SetFieldType("t_totalNumbNonCashOp", V_INTEGER);
        dataSet.SetFieldType("t_totalSumNonCashOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashInternetOp", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashInternetOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashMobilOp", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashMobilOp", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpRF", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpRF", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpAbroad", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpAbroad", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOnlineStore", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOnlineStore", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpCustoms", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpCustoms", V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOther", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOther", V_MONEY);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part1SubPart1DataSource_4212(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initTF250Part1SubPart1DataSource(protocolView, dataSources);
    end;

    constructorTF250Part1SubPart1DataSource_4212(protocolView, dataSources);
end;

class (TF250Part1SubPart1DataSource_4212) TF250Part1SubPart1DataSource_4637(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)

        var query =  "WITH "
            + "\n" + "dataCards AS"
            + "\n" + "("
            + "\n" + " SELECT cards.t_okato                                                                            AS t_okato,"
//            + "\n" + "          cards.t_nameTerritory           AS t_nameTerritory,"
            + "\n" + "        'Наименование территории_' || cards.t_okato                                              AS t_nameTerritory,"
            + "\n" + "        cards.t_codePaymentSystem                                                                AS t_codePaymentSystem,"
            + "\n" + "        cards.t_namePaymentSystem                                                                AS t_namePaymentSystem,"
            + "\n" + "        cards.t_cardKind                                                                         AS t_cardKind,"
            + "\n" + "        SUM(cards.t_numberOwners)                                                                AS t_numbClientPaymentSystem,"
            + "\n" + "        SUM(cards.t_totalNumb)                                                                   AS t_numbPCEndDate,"
            + "\n" + "        SUM(cards.t_usedCards)                                                                   AS t_numbPCUsingReportPeriod,"
            + "\n" + "        SUM(cards.t_sumOwn)                                                                      AS t_sumPCHoldersCash,"
            + "\n" + "        SUM(cards.t_sumLoans)                                                                    AS t_sumPCHoldersCredit,"
            + "\n" + "        SUM(cards.t_numbCashNative)                                                              AS t_numbPCObtainCashRF,"
            + "\n" + "        SUM(cards.t_sumCashNative)                                                               AS t_sumPCObtainCashRF,"
            + "\n" + "        SUM(cards.t_numbCashForeign)                                                             AS t_numbPCObtainCashAbroad,"
            + "\n" + "        SUM(cards.t_sumCashForeign)                                                              AS t_sumPCObtainCashAbroad,"
            + "\n" + "        0                                                                                        AS t_totalNumbNonCashOp,"
            + "\n" + "        0                                                                                        AS t_totalSumNonCashOp,"
            + "\n" + "        0                                                                                        AS t_numbNonCashInternetOp,"
            + "\n" + "        0                                                                                        AS t_sumNonCashInternetOp,"
            + "\n" + "        0                                                                                        AS t_numbNonCashMobilOp,"
            + "\n" + "        0                                                                                        AS t_sumNonCashMobilOp,"
            + "\n" + "        SUM(cards.t_numbNonCashNative)                                                           AS t_numbNonCashOpRF,"
            + "\n" + "        SUM(cards.t_sumNonCashNative)                                                            AS t_sumNonCashOpRF,"
            + "\n" + "        SUM(cards.t_numbNonCashForeign)                                                          AS t_numbNonCashOpAbroad,"
            + "\n" + "        SUM(cards.t_sumNonCashForeign)                                                           AS t_sumNonCashOpAbroad,"
            + "\n" + "        0                                                                                        AS t_numbNonCashOpOnlineStore,"
            + "\n" + "        0                                                                                        AS t_sumNonCashOpOnlineStore,"
            + "\n" + "        SUM(cards.t_numbNonCashCustoms)                                                          AS t_numbNonCashOpCustoms,"
            + "\n" + "        SUM(cards.t_sumNonCashCustoms)                                                           AS t_sumNonCashOpCustoms,"
            + "\n" + "        SUM(cards.t_numbNonCashOther)                                                            AS t_numbNonCashOpOther,"
            + "\n" + "        SUM(cards.t_sumNonCashOther)                                                             AS t_sumNonCashOpOther,"
            + "\n" + "        DECODE(GROUPING_ID(cards.t_okato, cards.t_codePaymentSystem, cards.t_cardKind), 7, 1, 0) AS t_totalCreditOrg,"
            + "\n" + "        DECODE(GROUPING_ID(cards.t_okato, cards.t_codePaymentSystem, cards.t_cardKind), 3, 1, 0) AS t_totalOkato,"
            + "\n" + "        DECODE(GROUPING_ID(cards.t_okato, cards.t_codePaymentSystem, cards.t_cardKind), 1, 1, 0) AS t_totalPaymentSystem,"
            + "\n" + "        DECODE(GROUPING_ID(cards.t_okato, cards.t_codePaymentSystem, cards.t_cardKind), 2, 1, 0) AS t_totalKindOkato,"
            + "\n" + "        DECODE(GROUPING_ID(cards.t_okato, cards.t_codePaymentSystem, cards.t_cardKind), 6, 1, 0) AS t_totalKindCreditOrganization"
            + "\n" + "   FROM repRtlCardsPaymentsOkato_vw cards"
            + "\n" + "  GROUP BY GROUPING SETS((cards.t_okato, cards.t_codePaymentSystem, cards.t_namePaymentSystem, cards.t_cardKind), "
            + "\n" + "                         (cards.t_okato, cards.t_codePaymentSystem, cards.t_namePaymentSystem),                   "
            + "\n" + "                         (cards.t_okato, cards.t_cardKind),                                                       "
            + "\n" + "                         (cards.t_okato),                                                                         "
            + "\n" + "                         (cards.t_cardKind),                                                                      "
            + "\n" + "                         ())                                                                                      "
            + "\n" + ")"
            + "\n" + "SELECT *"
            + "\n" + "  FROM ("
            + "\n" + "        SELECT t_okato                                AS t_okato,"
            + "\n" + "               t_nameTerritory                        AS t_nameTerritory,"
            + "\n" + "               t_codePaymentSystem                    AS t_codePaymentSystem,"
            + "\n" + "               t_namePaymentSystem                    AS t_namePaymentSystem,"
            + "\n" + "               t_cardKind                             AS t_cardKind,"
            + "\n" + "               t_numbClientPaymentSystem              AS t_numbClientPaymentSystem,"
            + "\n" + "               t_numbPCEndDate                        AS t_numbPCEndDate,"
            + "\n" + "               t_numbPCUsingReportPeriod              AS t_numbPCUsingReportPeriod,"
            + "\n" + "               t_sumPCHoldersCash                     AS t_sumPCHoldersCash,"
            + "\n" + "               t_sumPCHoldersCredit                   AS t_sumPCHoldersCredit,"
            + "\n" + "               t_numbPCObtainCashRF                   AS t_numbPCObtainCashRF,"
            + "\n" + "               t_sumPCObtainCashRF                    AS t_sumPCObtainCashRF,"
            + "\n" + "               t_numbPCObtainCashAbroad               AS t_numbPCObtainCashAbroad,"
            + "\n" + "               t_sumPCObtainCashAbroad                AS t_sumPCObtainCashAbroad,"
            + "\n" + "               t_totalNumbNonCashOp                   AS t_totalNumbNonCashOp,"
            + "\n" + "               t_totalSumNonCashOp                    AS t_totalSumNonCashOp,"
            + "\n" + "               t_numbNonCashInternetOp                AS t_numbNonCashInternetOp,"
            + "\n" + "               t_sumNonCashInternetOp                 AS t_sumNonCashInternetOp,"
            + "\n" + "               t_numbNonCashMobilOp                   AS t_numbNonCashMobilOp,"
            + "\n" + "               t_sumNonCashMobilOp                    AS t_sumNonCashMobilOp,"
            + "\n" + "               t_numbNonCashOpRF                      AS t_numbNonCashOpRF,"
            + "\n" + "               t_sumNonCashOpRF                       AS t_sumNonCashOpRF,"
            + "\n" + "               t_numbNonCashOpAbroad                  AS t_numbNonCashOpAbroad,"
            + "\n" + "               t_sumNonCashOpAbroad                   AS t_sumNonCashOpAbroad,"
            + "\n" + "               t_numbNonCashOpOnlineStore             AS t_numbNonCashOpOnlineStore,"
            + "\n" + "               t_sumNonCashOpOnlineStore              AS t_sumNonCashOpOnlineStore,"
            + "\n" + "               t_numbNonCashOpCustoms                 AS t_numbNonCashOpCustoms,"
            + "\n" + "               t_sumNonCashOpCustoms                  AS t_sumNonCashOpCustoms,"
            + "\n" + "               t_numbNonCashOpOther                   AS t_numbNonCashOpOther,"
            + "\n" + "               t_sumNonCashOpOther                    AS t_sumNonCashOpOther,"
            + "\n" + "               t_totalCreditOrg                       AS t_totalCreditOrg,"
            + "\n" + "               t_totalOkato                           AS t_totalOkato,"
            + "\n" + "               t_totalPaymentSystem                   AS t_totalPaymentSystem,"
            + "\n" + "               t_totalKindOkato                       AS t_totalKindOkato,"
            + "\n" + "               t_totalKindCreditOrganization          AS t_totalKindCreditOrganization,"
            + "\n" + "               0                                      AS t_totalContactlessCards,"
            + "\n" + "               0                                      AS t_totalContactlessTechnology"
            + "\n" + "          FROM dataCards"
            + "\n" + "         UNION ALL"
            + "\n" + "        SELECT cards.t_okato                          AS t_okato,"
            + "\n" + "               cards.t_nameTerritory                  AS t_nameTerritory,"
            + "\n" + "               cards.t_codePaymentSystem              AS t_codePaymentSystem,"
            + "\n" + "               cards.t_namePaymentSystem              AS t_namePaymentSystem,"
            + "\n" + "               'ДО'                                   AS t_cardKind,"
            + "\n" + "               SUM(cards.t_numbClientPaymentSystem)   AS t_numbClientPaymentSystem,"
            + "\n" + "               SUM(cards.t_numbPCEndDate)             AS t_numbPCEndDate,"
            + "\n" + "               SUM(cards.t_numbPCUsingReportPeriod)   AS t_numbPCUsingReportPeriod,"
            + "\n" + "               SUM(cards.t_sumPCHoldersCash)          AS t_sumPCHoldersCash,"
            + "\n" + "               SUM(cards.t_sumPCHoldersCredit)        AS t_sumPCHoldersCredit,"
            + "\n" + "               SUM(cards.t_numbPCObtainCashRF)        AS t_numbPCObtainCashRF,"
            + "\n" + "               SUM(cards.t_sumPCObtainCashRF)         AS t_sumPCObtainCashRF,"
            + "\n" + "               SUM(cards.t_numbPCObtainCashAbroad)    AS t_numbPCObtainCashAbroad,"
            + "\n" + "               SUM(cards.t_sumPCObtainCashAbroad)     AS t_sumPCObtainCashAbroad,"
            + "\n" + "               0                                      AS t_totalNumbNonCashOp,"
            + "\n" + "               0                                      AS t_totalSumNonCashOp,"
            + "\n" + "               0                                      AS t_numbNonCashInternetOp,"
            + "\n" + "               0                                      AS t_sumNonCashInternetOp,"
            + "\n" + "               0                                      AS t_numbNonCashMobilOp,"
            + "\n" + "               0                                      AS t_sumNonCashMobilOp,"
            + "\n" + "               SUM(cards.t_numbNonCashOpRF)           AS t_numbNonCashOpRF,"
            + "\n" + "               SUM(cards.t_sumNonCashOpRF)            AS t_sumNonCashOpRF,"
            + "\n" + "               SUM(cards.t_numbNonCashOpAbroad)       AS t_numbNonCashOpAbroad,"
            + "\n" + "               SUM(cards.t_sumNonCashOpAbroad)        AS t_sumNonCashOpAbroad,"
            + "\n" + "               0                                      AS t_numbNonCashOpOnlineStore,"
            + "\n" + "               0                                      AS t_sumNonCashOpOnlineStore,"
            + "\n" + "               SUM(cards.t_numbNonCashOpCustoms)      AS t_numbNonCashOpCustoms,"
            + "\n" + "               SUM(cards.t_sumNonCashOpCustoms)       AS t_sumNonCashOpCustoms,"
            + "\n" + "               SUM(cards.t_numbNonCashOpOther)        AS t_numbNonCashOpOther,"
            + "\n" + "               SUM(cards.t_sumNonCashOpOther)         AS t_sumNonCashOpOther,"
            + "\n" + "               t_totalCreditOrg                       AS t_totalCreditOrg,"
            + "\n" + "               t_totalOkato                           AS t_totalOkato,"
            + "\n" + "               t_totalPaymentSystem                   AS t_totalPaymentSystem,"
            + "\n" + "               t_totalKindOkato                       AS t_totalKindOkato,"
            + "\n" + "               t_totalKindCreditOrganization          AS t_totalKindCreditOrganization,"
            + "\n" + "               0                                      AS t_totalContactlessCards,"
            + "\n" + "               0                                      AS t_totalContactlessTechnology"
            + "\n" + "          FROM dataCards cards"
            + "\n" + "         WHERE cards.t_cardKind = 'Д'"
            + "\n" + "            OR cards.t_cardKind = 'О'"
            + "\n" + "         GROUP BY t_okato, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem, t_totalCreditOrg, t_totalOkato, t_totalPaymentSystem, t_totalKindOkato, t_totalKindCreditOrganization"
            + "\n" + "        )"
            + "\n" + "  ORDER BY t_okato, t_namePaymentSystem,"
            + "\n" + "        CASE t_cardKind"
            + "\n" + "            WHEN 'Д'"
            + "\n" + "                THEN '1'"
            + "\n" + "            WHEN 'О'"
            + "\n" + "                THEN '2'"
            + "\n" + "            WHEN 'К'"
            + "\n" + "                THEN '3'"
            + "\n" + "            ELSE '4' "
            + "\n" + "        END";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_numbClientPaymentSystem",  V_INTEGER);
        dataSet.SetFieldType("t_numbPCEndDate",            V_INTEGER);
        dataSet.SetFieldType("t_numbPCUsingReportPeriod",  V_INTEGER);
        dataSet.SetFieldType("t_sumPCHoldersCash",         V_MONEY);
        dataSet.SetFieldType("t_sumPCHoldersCredit",       V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashRF",       V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashRF",        V_MONEY);
        dataSet.SetFieldType("t_numbPCObtainCashAbroad",   V_INTEGER);
        dataSet.SetFieldType("t_sumPCObtainCashAbroad",    V_MONEY);
        dataSet.SetFieldType("t_totalNumbNonCashOp",       V_INTEGER);
        dataSet.SetFieldType("t_totalSumNonCashOp",        V_MONEY);
        dataSet.SetFieldType("t_numbNonCashInternetOp",    V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashInternetOp",     V_MONEY);
        dataSet.SetFieldType("t_numbNonCashMobilOp",       V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashMobilOp",        V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpRF",          V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpRF",           V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpAbroad",      V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpAbroad",       V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOnlineStore", V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOnlineStore",  V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpCustoms",     V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpCustoms",      V_MONEY);
        dataSet.SetFieldType("t_numbNonCashOpOther",       V_INTEGER);
        dataSet.SetFieldType("t_sumNonCashOpOther",        V_MONEY);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getPaymentSystem()
        var query = "SELECT cards.t_okato                               AS t_okato,"
            + "\n" + "      'Наименование территории_' || cards.t_okato AS t_nameTerritory,"
            + "\n" + "      cards.t_codePaymentSystem                   AS t_codePaymentSystem,"
            + "\n" + "      cards.t_namePaymentSystem                   AS t_namePaymentSystem"
            + "\n" + "  FROM repRtlCardsPaymentsOkato_vw cards"
            + "\n" + "GROUP BY (t_okato, t_codePaymentSystem, t_namePaymentSystem)"
            + "\n" + "ORDER BY t_okato, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);
        dataSet.moveFirst();

        return dataSet;
    end;

    macro getOkato()
        var query =  "SELECT cards.t_okato AS t_okato"
            + "\n" + "  FROM repRtlCardsPaymentsOkato_vw cards"
            + "\n" + " GROUP BY t_okato"
            + "\n" + " ORDER BY t_okato";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);
        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part1SubPart1DataSource_4637(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initTF250Part1SubPart1DataSource_4212(protocolView, dataSources);
    end;

    constructorTF250Part1SubPart1DataSource_4637(protocolView, dataSources);
end;

class (RcbDataSource) TF250Part1SubPart2DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)
        var query =  "SELECT '0'      AS t_okato,"
            + "\n" + "       ' '      AS t_nameTerritory,"
            + "\n" + "       ' '      AS t_codePaymentSystem,"
            + "\n" + "       ' '      AS t_namePaymentSystem,"
            + "\n" + "       0        AS t_numbClientPaymentSystem,"
            + "\n" + "       0        AS t_numbPCEndDate,"
            + "\n" + "       0        AS t_numbPCUsingReportPeriod,"
            + "\n" + "       0        AS t_sumPCHoldersCash,"
            + "\n" + "       0        AS t_sumPCHoldersCredit,"
            + "\n" + "       0        AS t_numbPCObtainCashRF,"
            + "\n" + "       0        AS t_sumPCObtainCashRF,"
            + "\n" + "       0        AS t_numbPCObtainCashAbroad,"
            + "\n" + "       0        AS t_sumPCObtainCashAbroad,"
            + "\n" + "       0        AS t_totalNumbNonCashOp,"
            + "\n" + "       0        AS t_totalSumNonCashOp,"
            + "\n" + "       0        AS t_numbNonCashInternetOp,"
            + "\n" + "       0        AS t_sumNonCashInternetOp,"
            + "\n" + "       0        AS t_numbNonCashMobilOp,"
            + "\n" + "       0        AS t_sumNonCashMobilOp,"
            + "\n" + "       0        AS t_numbNonCashOpRF,"
            + "\n" + "       0        AS t_sumNonCashOpRF,"
            + "\n" + "       0        AS t_numbNonCashOpAbroad,"
            + "\n" + "       0        AS t_sumNonCashOpAbroad,"
            + "\n" + "       0        AS t_numbNonCashOpOnlineStore,"
            + "\n" + "       0        AS t_sumNonCashOpOnlineStore,"
            + "\n" + "       0        AS t_numbNonCashOpCustoms,"
            + "\n" + "       0        AS t_sumNonCashOpCustoms,"
            + "\n" + "       0        AS t_numbNonCashOpOther,"
            + "\n" + "       0        AS t_sumNonCashOpOther"
            + "\n" + "  FROM dual";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part1SubPart2DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initRcbDataSource("1.2", protocolView, dataSources);
    end;

    constructorTF250Part1SubPart2DataSource(protocolView, dataSources);
end;

class (RcbDataSource) TF250Part2DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)
        var query =  "SELECT acq.t_codeTerritory                     AS t_codeTerritory,"
            + "\n" + "       acq.t_nameTerritory                     AS t_nameTerritory,"
            + "\n" + "       acq.t_codePaymentSystem                 AS t_codePaymentSystem,"
            + "\n" + "       acq.t_namePaymentSystem                 AS t_namePaymentSystem,"
            + "\n" + "       SUM(acq.t_totalNumbATM)                 AS t_totalNumbATM,"
            + "\n" + "       SUM(acq.t_totalNumbAtmCashMoney)        AS t_totalNumbAtmCashMoney,"
            + "\n" + "       SUM(acq.t_numbATMFuncPayment)           AS t_numbATMFuncPayment,"
            + "\n" + "       SUM(acq.t_totalNumbCashReceipt)         AS t_totalNumbCashReceipt,"
            + "\n" + "       0                                       AS t_numbCashReceiptNonPC,"
            + "\n" + "       SUM(acq.t_numbCashReceiptPC)            AS t_numbCashReceiptPC,"
            + "\n" + "       SUM(acq.t_numbPOSTermService)           AS t_numbPOSTermService,"
            + "\n" + "       SUM(acq.t_numbPOSTermEncashment)        AS t_numbPOSTermEncashment,"
            + "\n" + "       SUM(acq.t_numbImprintersService)        AS t_numbImprintersService,"
            + "\n" + "       SUM(acq.t_numbImprintersEncashment)     AS t_numbImprintersEncashment,"
            + "\n" + "       0           AS t_totalCreditOrg,"
            + "\n" + "       0       AS t_totalCodeTerritory"
            + "\n" + "  FROM repRtlAcqPaySys_vw acq"
            + "\n" + " GROUP BY t_codeTerritory, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem"
            + "\n" + " UNION ALL"
            + "\n" + "SELECT acq.t_codeTerritory                     AS t_codeTerritory,"
            + "\n" + "       acq.t_nameTerritory                     AS t_nameTerritory,"
            + "\n" + "       NULL                                    AS t_codePaymentSystem,"
            + "\n" + "       NULL                                    AS t_namePaymentSystem,"
            + "\n" + "       SUM(acq.t_totalNumbATM)                 AS t_totalNumbATM,"
            + "\n" + "       SUM(acq.t_totalNumbAtmCashMoney)        AS t_totalNumbAtmCashMoney,"
            + "\n" + "       SUM(acq.t_numbATMFuncPayment)           AS t_numbATMFuncPayment,"
            + "\n" + "       SUM(acq.t_totalNumbCashReceipt)         AS t_totalNumbCashReceipt,"
            + "\n" + "       SUM(t_numbCashReceiptNonPC)             AS t_numbCashReceiptNonPC,"
            + "\n" + "       SUM(acq.t_numbCashReceiptPC)            AS t_numbCashReceiptPC,"
            + "\n" + "       SUM(acq.t_numbPOSTermService)           AS t_numbPOSTermService,"
            + "\n" + "       SUM(acq.t_numbPOSTermEncashment)        AS t_numbPOSTermEncashment,"
            + "\n" + "       SUM(acq.t_numbImprintersService)        AS t_numbImprintersService,"
            + "\n" + "       SUM(acq.t_numbImprintersEncashment)     AS t_numbImprintersEncashment,"
            + "\n" + "       GROUPING(acq.t_codeTerritory)           AS t_totalCreditOrg,"
            + "\n" + "       1                                       AS t_totalCodeTerritory"
            + "\n" + "  FROM repRtlAcquiring_vw acq"
            + "\n" + " GROUP BY ROLLUP ((t_codeTerritory, t_nameTerritory))"
            + "\n" + " ORDER BY t_codeTerritory, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_totalNumbATM", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbAtmCashMoney", V_INTEGER);
        dataSet.SetFieldType("t_numbATMFuncPayment", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbCashReceipt", V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptNonPC", V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermService", V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermEncashment", V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptPC", V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersService", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbNonCashOp", V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersEncashment", V_INTEGER);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getTotalTerritoryData(filter : RcbDataSourceFilter)
        var query = "SELECT *"
            + "\n" + "   FROM repRtlAcquiring_vw acq";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getPaymentSystem()
        var query = "SELECT acq.t_codeTerritory             AS t_codeTerritory,"
            + "\n" + "      acq.t_nameTerritory             AS t_nameTerritory,"
            + "\n" + "      acq.t_codePaymentSystem         AS t_codePaymentSystem,"
            + "\n" + "      acq.t_namePaymentSystem         AS t_namePaymentSystem"
            + "\n" + "  FROM repRtlAcqPaySys_vw acq"
            + "\n" + "GROUP BY t_codeTerritory, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem"
            + "\n" + "ORDER BY t_codeTerritory, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part2DataSource(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initRcbDataSource("2", protocolView, dataSources);
    end;

    constructorTF250Part2DataSource(protocolView, dataSources);
end;

class (TF250Part2DataSource) TF250Part2DataSource_4212(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)
        var query = "SELECT acq.t_codeTerritory                     AS t_codeTerritory,"
            + "\n" + "      acq.t_nameTerritory                     AS t_nameTerritory,"
            + "\n" + "      acq.t_codePaymentSystem                 AS t_codePaymentSystem,"
            + "\n" + "      acq.t_namePaymentSystem                 AS t_namePaymentSystem,"
            + "\n" + "      SUM(acq.t_totalNumbATM)                 AS t_totalNumbATM,"
            + "\n" + "      SUM(acq.t_totalNumbAtmCashMoney)        AS t_totalNumbAtmCashMoney,"
            + "\n" + "      SUM(acq.t_numbATMFuncPayment)           AS t_numbATMFuncPayment,"
            + "\n" + "      SUM(acq.t_totalNumbCashReceipt)         AS t_totalNumbCashReceipt,"
            + "\n" + "      0                                       AS t_numbCashReceiptNonPC,"
            + "\n" + "      SUM(acq.t_numbCashReceiptPC)            AS t_numbCashReceiptPC,"
            + "\n" + "      SUM(acq.t_numbPOSTermService)           AS t_numbPOSTermService,"
            + "\n" + "      SUM(acq.t_numbPOSTermEncashment)        AS t_numbPOSTermEncashment,"
            + "\n" + "      SUM(acq.t_numbImprintersService)        AS t_numbImprintersService,"
            + "\n" + "      SUM(acq.t_numbImprintersEncashment)     AS t_numbImprintersEncashment,"
            + "\n" + "      0                                       AS t_totalCreditOrg,"
            + "\n" + "      0                                       AS t_totalCodeTerritory,"
            + "\n" + "      0                                       AS t_totalContactlessTechnology"
            + "\n" + "   FROM repRtlAcqPaySys_vw acq"
            + "\n" + " GROUP BY (t_codeTerritory, t_nameTerritory, t_codePaymentSystem, t_namePaymentSystem)"
            + "\n" + "UNION ALL"
            + "\n" + "SELECT acq.t_codeTerritory                    AS t_codeTerritory,"
            + "\n" + "      acq.t_nameTerritory                     AS t_nameTerritory,"
            + "\n" + "      NULL                                    AS t_codePaymentSystem,"
            + "\n" + "      NULL                                    AS t_namePaymentSystem,"
            + "\n" + "      SUM(acq.t_totalNumbATM)                 AS t_totalNumbATM,"
            + "\n" + "      SUM(acq.t_totalNumbAtmCashMoney)        AS t_totalNumbAtmCashMoney,"
            + "\n" + "      SUM(acq.t_numbATMFuncPayment)           AS t_numbATMFuncPayment,"
            + "\n" + "      SUM(acq.t_totalNumbCashReceipt)         AS t_totalNumbCashReceipt,"
            + "\n" + "      SUM(t_numbCashReceiptNonPC)             AS t_numbCashReceiptNonPC,"
            + "\n" + "      SUM(acq.t_numbCashReceiptPC)            AS t_numbCashReceiptPC,"
            + "\n" + "      SUM(acq.t_numbPOSTermService)           AS t_numbPOSTermService,"
            + "\n" + "      SUM(acq.t_numbPOSTermEncashment)        AS t_numbPOSTermEncashment,"
            + "\n" + "      SUM(acq.t_numbImprintersService)        AS t_numbImprintersService,"
            + "\n" + "      SUM(acq.t_numbImprintersEncashment)     AS t_numbImprintersEncashment,"
            + "\n" + "      GROUPING(acq.t_codeTerritory)           AS t_totalCreditOrg,"
            + "\n" + "      1                                       AS t_totalCodeTerritory,"
            + "\n" + "      NVL(acq.t_isUseContactlessTechnology,0) AS t_totalContactlessTechnology"
            + "\n" + "   FROM repRtlAcquiring_vw acq"
            + "\n" + " GROUP BY GROUPING SETS ((t_codeTerritory, t_nameTerritory), (t_isUseContactlessTechnology),())"
            + "\n" + "HAVING (t_isUseContactlessTechnology IS NULL OR t_isUseContactlessTechnology = 1)"
            + "\n" + " ORDER BY t_codeTerritory, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_totalNumbATM", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbAtmCashMoney", V_INTEGER);
        dataSet.SetFieldType("t_numbATMFuncPayment", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbCashReceipt", V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptNonPC", V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermService", V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermEncashment", V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptPC", V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersService", V_INTEGER);
        dataSet.SetFieldType("t_totalNumbNonCashOp", V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersEncashment", V_INTEGER);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part2DataSource_4212(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initTF250Part2DataSource(protocolView, dataSources);
    end;

    constructorTF250Part2DataSource_4212(protocolView, dataSources);
end;

class (TF250Part2DataSource_4212) TF250Part2DataSource_4637(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)

    macro getData(filter : RcbDataSourceFilter)
        var query =  "SELECT acq.t_codeTerritory                               AS t_codeTerritory,"
            + "\n" + "       'Наименование территории_' || acq.t_codeTerritory AS t_nameTerritory,"
            + "\n" + "       acq.t_codePaymentSystem                           AS t_codePaymentSystem,"
            + "\n" + "       acq.t_namePaymentSystem                           AS t_namePaymentSystem,"
            + "\n" + "       SUM(acq.t_totalNumbATM)                           AS t_totalNumbATM,"
            + "\n" + "       SUM(acq.t_totalNumbAtmCashMoney)                  AS t_totalNumbAtmCashMoney,"
            + "\n" + "       SUM(acq.t_numbATMFuncPayment)                     AS t_numbATMFuncPayment,"
            + "\n" + "       SUM(acq.t_numbCashReceiptPC)                      AS t_totalNumbCashReceipt,"
            + "\n" + "       0                                                 AS t_numbCashReceiptNonPC,"
            + "\n" + "       SUM(acq.t_numbCashReceiptPC)                      AS t_numbCashReceiptPC,"
            + "\n" + "       0                                                 AS t_numbPosTermBillRecycling,"
            + "\n" + "       SUM(acq.t_numbPosTermService)                     AS t_numbPosTermService,"
            + "\n" + "       SUM(acq.t_numbPosTermEncashment)                  AS t_numbPosTermEncashment,"
            + "\n" + "       SUM(acq.t_numbImprintersService)                  AS t_numbImprintersService,"
            + "\n" + "       SUM(acq.t_numbImprintersEncashment)               AS t_numbImprintersEncashment,"
            + "\n" + "       0                                                 AS t_totalCreditOrg,"
            + "\n" + "       0                                                 AS t_totalCodeTerritory,"
            + "\n" + "       0                                                 AS t_totalContactlessTechnology"
            + "\n" + "  FROM repRtlAcqPaySysOkato_vw acq"
            + "\n" + " GROUP BY (t_codeTerritory, t_codePaymentSystem, t_namePaymentSystem)"
            + "\n" + " UNION ALL"
            + "\n" + "SELECT acq.t_codeTerritory                               AS t_codeTerritory,"
            + "\n" + "       'Наименование территории_' || acq.t_codeTerritory AS t_nameTerritory,"
            + "\n" + "       NULL                                              AS t_codePaymentSystem,"
            + "\n" + "       NULL                                              AS t_namePaymentSystem,"
            + "\n" + "       SUM(acq.t_totalNumbATM)                           AS t_totalNumbATM,"
            + "\n" + "       SUM(acq.t_totalNumbAtmCashMoney)                  AS t_totalNumbAtmCashMoney,"
            + "\n" + "       SUM(acq.t_numbATMFuncPayment)                     AS t_numbATMFuncPayment,"
            + "\n" + "       SUM(acq.t_totalNumbCashReceipt)                   AS t_totalNumbCashReceipt,"
            + "\n" + "       SUM(t_numbCashReceiptNonPC)                       AS t_numbCashReceiptNonPC,"
            + "\n" + "       SUM(acq.t_numbCashReceiptPC)                      AS t_numbCashReceiptPC,"
            + "\n" + "       SUM(acq.t_numbRecyclesBanknotes)                  AS t_numbPosTermBillRecycling,"
            + "\n" + "       SUM(acq.t_numbPosTermService)                     AS t_numbPosTermService,"
            + "\n" + "       SUM(acq.t_numbPosTermEncashment)                  AS t_numbPosTermEncashment,"
            + "\n" + "       SUM(acq.t_numbImprintersService)                  AS t_numbImprintersService,"
            + "\n" + "       SUM(acq.t_numbImprintersEncashment)               AS t_numbImprintersEncashment,"
            + "\n" + "       GROUPING(acq.t_codeTerritory)                     AS t_totalCreditOrg,"
            + "\n" + "       1                                                 AS t_totalCodeTerritory,"
            + "\n" + "       NVL(acq.t_isUseContactlessTechnology,0)           AS t_totalContactlessTechnology"
            + "\n" + "  FROM repRtlAcquiringOkato_vw acq"
            + "\n" + " GROUP BY GROUPING SETS ((t_codeTerritory), (t_isUseContactlessTechnology),())"
            + "\n" + "HAVING (   t_isUseContactlessTechnology IS NULL"
            + "\n" + "        OR t_isUseContactlessTechnology = 1)"
            + "\n" + " ORDER BY t_codeTerritory, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);

        dataSet.SetFieldType("t_totalNumbATM",             V_INTEGER);
        dataSet.SetFieldType("t_totalNumbAtmCashMoney",    V_INTEGER);
        dataSet.SetFieldType("t_numbATMFuncPayment",       V_INTEGER);
        dataSet.SetFieldType("t_totalNumbCashReceipt",     V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptNonPC",     V_INTEGER);
        dataSet.SetFieldType("t_numbPosTermBillRecycling", V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermService",       V_INTEGER);
        dataSet.SetFieldType("t_numbPOSTermEncashment",    V_INTEGER);
        dataSet.SetFieldType("t_numbCashReceiptPC",        V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersService",    V_INTEGER);
        dataSet.SetFieldType("t_totalNumbNonCashOp",       V_INTEGER);
        dataSet.SetFieldType("t_numbImprintersEncashment", V_INTEGER);

        dataSet.moveFirst();
        m_protocolView.printProtocol(dataSet);

        dataSet.moveFirst();

        return dataSet;
    end;

    macro getPaymentSystem()
        var query =  "SELECT acq.t_codeTerritory                                AS t_codeTerritory,"
            + "\n" + "       'Наименование территории_' || acq.t_codeTerritory  AS t_nameTerritory,"
            + "\n" + "       acq.t_codePaymentSystem                            AS t_codePaymentSystem,"
            + "\n" + "       acq.t_namePaymentSystem                            AS t_namePaymentSystem"
            + "\n" + "  FROM repRtlAcqPaySysOkato_vw acq"
            + "\n" + " GROUP BY t_codeTerritory, t_codePaymentSystem, t_namePaymentSystem"
            + "\n" + " ORDER BY t_codeTerritory, t_namePaymentSystem";

        var dataSet = TRsbDataSet(query, RSDVAL_CLIENT, RSDVAL_STATIC);
        dataSet.moveFirst();

        return dataSet;
    end;

    private macro constructorTF250Part2DataSource_4637(protocolView : RcbDataProtocolView, dataSources : RcbDataSources)
        initTF250Part2DataSource_4212(protocolView, dataSources);
    end;

    constructorTF250Part2DataSource_4637(protocolView, dataSources);
end;

class (RcbDataSources) TF250DataSources(protocolView : RcbCalculateProtocolView)
    initRcbDataSources(protocolView);

    macro getProtocolView()
        return m_protocolView;
    end;

    private macro initialize()
        m_dataSourcePool.push_back(TF250Part1SubPart1DataSource(m_protocolView.getDataProtocolView("part1"), this));
        m_dataSourcePool.push_back(TF250Part1SubPart2DataSource(m_protocolView.getDataProtocolView(""), this));
        m_dataSourcePool.push_back(TF250Part2DataSource(m_protocolView.getDataProtocolView("part2"), this));
    end;
end;

class (TF250DataSources) TF250DataSources_4212(protocolView : RcbCalculateProtocolView)
    initTF250DataSources(protocolView);

    macro getProtocolView()
        return m_protocolView;
    end;

    private macro initialize()
        m_dataSourcePool.push_back(TF250Part1SubPart1DataSource_4212(m_protocolView.getDataProtocolView("part1"), this));
        m_dataSourcePool.push_back(TF250Part1SubPart2DataSource(m_protocolView.getDataProtocolView(""), this));
        m_dataSourcePool.push_back(TF250Part2DataSource_4212(m_protocolView.getDataProtocolView("part2"), this));
    end;
end;

class (TF250DataSources_4212) TF250DataSources_4637(protocolView : RcbCalculateProtocolView)
    initTF250DataSources_4212(protocolView);

    private macro initialize()
        m_dataSourcePool.push_back(TF250Part1SubPart1DataSource_4637(m_protocolView.getDataProtocolView("part1"), this));
        m_dataSourcePool.push_back(TF250Part1SubPart2DataSource(m_protocolView.getDataProtocolView(""), this));
        m_dataSourcePool.push_back(TF250Part2DataSource_4637(m_protocolView.getDataProtocolView("part2"), this));
    end;
end;
