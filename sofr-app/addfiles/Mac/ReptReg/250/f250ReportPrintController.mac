/*
$Name:          f250ReportPrintController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 250. Контроллер печати отчета
*/

/**
 * @since   02.10.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbReportPrintController) TF250ReportPrintController()

    private macro printDataZonePart1()
        var part = getReport().getPart("1.1");
        var partView = getReportView().getPartView("1");
        var iterator = RcbApplication.currentReport.attributeValue("Раздел1_Подраздел1").createValueIterator();
        iterator.moveFirst();
        var dataSet = getDataSources().getDataSource("1.1").getPaymentSystem();

        if (not part.isEmpty)
        partView.printHeadPart("Раздел I. Сведения о платежах за товары (работы, услуги) и получении наличных денег с использованием платежных карт, эмитированных кредитной организацией (ее филиалом)");
            partView.printHead();
            partView.printPart1Row(dataSet, part);
            dataSet = getDataSources().getDataSource("1.1").getOkato();
            partView.printTotalCreditOrganization(part);
            partView.endRows();
        else
            partView.printHeadPart("Раздел I. Сведения о платежах за товары (работы, услуги) и получении наличных денег с использованием платежных карт, эмитированных кредитной организацией (ее филиалом)");
            partView.printNullDataZone();
        end;
    end;

    private macro printDataZonePart2()
        var part = getReport().getPart("2");
        var partView = getReportView().getPartView("2");
        var iterator = RcbApplication.currentReport.attributeValue("Раздел2").createValueIterator();
        iterator.moveFirst();
        var dataSet = getDataSources().getDataSource("2").getPaymentSystem();

        if (not part.isEmpty)
        partView.printHeadPart("Раздел II. Сведения об инфраструктуре, предназначенной для совершения операций выдачи (приема) наличных денежных средств и платежей за товары (работы, услуги) с использованием и без использования платежных карт");
            partView.printHead();
            partView.printPart2Row(dataSet, part);
            partView.printTotalPart2(dataSet, part);
            partView.endRows();
        else
            partView.printHeadPart("Раздел II. Сведения об инфраструктуре, предназначенной для совершения операций выдачи (приема) наличных денежных средств и платежей за товары (работы, услуги) с использованием и без использования платежных карт");
            partView.printNullDataZone();
        end;
    end;

    macro printDataZone()
        getReportView().setOutputFile();
        getReportView.setReportWidth(m_reportWidth);
        printDataZonePart1();
        printDataZonePart2();

        println("");
        println("Раздел III. Сведения об операциях, совершенных с использованием платежных карт через устройства, их принимающие");
        println("Данные отсутствуют");
    end;

    private macro constructorTF250ReportPrintController()
        initRcbReportPrintController();
        global().initializeRepDataPackage(global().getRcbReport());
        
        m_reportWidth = 535;
    end;

    constructorTF250ReportPrintController()
end;

class (TF250ReportPrintController) TF250ReportPrintController_4212()
    macro print()
        checkReport();

        getReportView().setOutputFile();

        getReportView().setReportWidth(m_reportWidth);
        getReportView().printLendingAgencyCodeZone();
        getReportView().printNamesZone("Полное или сокращенное фирменное наименование кредитной организации ");

        if (getReport().isEmpty())
            getReportView().printNullDataZone();
        else
            printDataZone();
        end;
    end;

    macro constructorTF250ReportPrintController_4212()
        initTF250ReportPrintController();
    end;

    constructorTF250ReportPrintController_4212();
end;
