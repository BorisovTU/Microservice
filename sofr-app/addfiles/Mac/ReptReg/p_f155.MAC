/*─────────────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                                       R-Style SoftLab
  Файл подсистемы "Отчетность регламентируемая"

  Форма 155. Печать отчета.

  FILENAME: p_f155.mac
  CREATED:  24.11.2005 ABP 
  MODIFICATIONS:
  COMMENTS:
└─────────────────────────────────────────────────────────────────────────────────*/
import calc_f155, param, lib_str, p_f155i1, p_f155i2, rcb_date;

private const HeaderWidth = max(Issue1Width, Issue2Width);
private const IsEmpty     = IsIssue1Empty and IsIssue2Empty;

/* Заголовок */
private MACRO PrintHeader()
  var str = "│";
  str = str + StrAlign(Код_СОАТО,     15, STR_ALIGN_CENTER) + "│";
  str = str + StrAlign(Код_ОКПО,      09, STR_ALIGN_CENTER) + "│";
  str = str + StrAlign(ОГРН,          15, STR_ALIGN_CENTER) + "│";
  str = str + StrAlign(РегНомерБанка, 15, STR_ALIGN_CENTER) + "│";
  str = str + StrAlign({MFO_Bank},    12, STR_ALIGN_CENTER) + "│";

  
  println(StrAlign("Банковская отчетность ", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("┌───────────────┬──────────────────────────────────────────────────────┐", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│      Код      │          Код кредитной организации (филиала)         │", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│   территории  ├─────────┬───────────────┬───────────────┬────────────┤", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│    по ОКАТО   │ по ОКПО │   Основной    │Регистрационный│    БИК     │", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│               │         │государственный│    номер      │            │", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│               │         │регистрационный│(/порядковый   │            │", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("│               │         │    номер      │    номер)     │            │", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("├───────────────┼─────────┼───────────────┼───────────────┼────────────┤", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign(str, HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("└───────────────┴─────────┴───────────────┴───────────────┴────────────┘", HeaderWidth, STR_ALIGN_RIGHT));

  println();
  println(StrAlign("Сведения о резервах на возможные потери", HeaderWidth, STR_ALIGN_CENTER));
  println(StrAlign(String("По состоянию на ", trim(string(GetCorrectPrnRepDate():m))), HeaderWidth, STR_ALIGN_CENTER));
  println();
  println();
  println();
  println();
  [   ###################################################################################################################### ]("Наименование кредитной организации " + {Name_Bank}:w);
  [   Почтовый адрес                     #                                                                                   ]({Post_Addr}:l);
  println();
  println(StrAlign("Код формы 0409155", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("Месячная/Квартальная", HeaderWidth, STR_ALIGN_RIGHT));
  println(StrAlign("тыс.руб.", HeaderWidth, STR_ALIGN_RIGHT));
END;

/* Подвал */
private MACRO PrintFooter()
  println();
[   #                               ###################################          ]({Name_Boss}:l, {FIO_Boss}:l);
[   #                               ###################################          ]({Name_Book}:l, {FIO_Book}:l);
[   Исполнитель                     ###################################          ](Исполнитель:l);
[   телефон:                        ###################################          ](Номер_телефона:l);
[   #](trim(string({curdate}:m)));
END;

PrintHeader();
PrintIssue1();
PrintIssue2();
PrintFooter();
