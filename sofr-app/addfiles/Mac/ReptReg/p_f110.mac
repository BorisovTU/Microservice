/* ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø
   RS-Bank V6                                                 R-Style Softlab 
   î†©´ ØÆ§·®·‚•¨Î "ê•£´†¨•≠‚®‡Æ¢†≠≠†Ô Æ‚Á•‚≠Æ·‚Ï"

   è•Á†‚Ï ‰Æ‡¨Î 110

   CREATED : 23.11.05 ã„ß£®≠

   MODIFICATIONS:
   NOTES:

¿ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ- */
import param;
import chk_regd;
import log_lib;

const ProtocolFileName = GetNameLog("110" + "c");
const Prefix = "î110_";

var MaxChar1, MaxChar2, MaxChar3;

var ReportDay, ReportMonth, isQuartal = false;
    DateSplit( Ñ†‚†é‚Á•‚† + 1, ReportDay, ReportMonth, null );
    if( (ReportDay = 1) and ( mod( ReportMonth, 3 ) == 1 ) )
        isQuartal = true;
    end;

var U_1660, Date1660U = date( 6, 7, 2005 );
    GetRegDateDefault( Date1660U, "ÑÄíÄ1_1660ì" );
    if( Ñ†‚†é‚Á•‚† >= Date1660U )
        U_1660 = true;
    else
        U_1660 = false;
    end;

    if( U_1660 )
        MaxChar1 = 24;
        MaxChar2 = 44;
        MaxChar3 = 80;
    else
        MaxChar1 = 21;
        MaxChar2 = 41;
        MaxChar3 = 77;
    end;

var MaxChar = Ternary( isQuartal, MaxChar3, MaxChar1 );

/* ============================= Ñ•™´†‡†Ê®® =============================== */

CONST NameStr = "ç†®¨•≠Æ¢†≠®• ™‡•§®‚≠Æ© Æ‡£†≠®ß†Ê®®";

VAR Report = CTableReport( 2, false, false );   // Æ°Í•™‚ Æ‚Á•‚† (treport.mac)
VAR CharArray = TArray;
    CharArray[0] = TArray;
    CharArray[1] = TArray;
  if( U_1660 )
    CharArray[0] = ArrCreate( "A107/17", "A30126/3", "A30226/3", "A47425/3", "A40109/5.1", "A40109/9", "A47402/5.2", "A50205/6.1",
                    "A50206/6.1", "A50207/6.1", "A50208/6.1",
                    "A50209/6.1", "A50210/6.1", "A50211/6.1", "A50406/4.1", "A50406/6.1", "A50505/4.1", "A50505/6.1", "A/5.3", "A/5.4", "A/6.2",
                    "A/7", "A/10", "A/13", "S17311/12", "S17311/13", "S17312/12", "S17312/13", "S17313/12", "S17313/13", "S17314/12",
                    "S17314/13", "S17315/1", "S29410/12", "S29410/13", "S29411/12", "S29411/13", "S29412/12", "S29412/13", "S29413/12",
                    "S29413/13", "S29414/7", "3101", "3201", "1111", "1112", "1113", "1114", "1121", "1122", "1123", "1124", "2111",
                    "2112", "2113", "2121", "2122", "2123", "1211", "1212", "1213", "1214", "1221", "1222", "1223", "1224", "1301",
                    "1302", "1303", "1304", "2401", "2402", "2403", "3301", "4101", "4201", "4202", "4301", "4302", "5101" );
  else
    CharArray[0] = ArrCreate( "A10702/17", "A30126/3", "A40109/5.3", "A40109/9", "A50205/6.1", "A50206/6.1", "A50207/6.1", "A50208/6.1",
                    "A50209/6.1", "A50210/6.1", "A50211/6.1", "A50406/4.1", "A50406/6.1", "A50505/4.1", "A50505/6.1", "A/5.1", "A/5.2", "A/6.2",
                    "A/7.2", "A/10", "A/13", "S17311/12", "S17311/13", "S17312/12", "S17312/13", "S17313/12", "S17313/13", "S17314/12",
                    "S17314/13", "S17315/1", "S29410/12", "S29410/13", "S29411/12", "S29411/13", "S29412/12", "S29412/13", "S29413/12",
                    "S29413/13", "S29414/7", "3101", "3201", "1111", "1112", "1113", "1114", "1121", "1122", "1123", "1124", "2111",
                    "2112", "2113", "2121", "2122", "2123", "1211", "1212", "1213", "1214", "1221", "1222", "1223", "1224", "1301",
                    "1302", "1303", "1304", "2401", "2402", "2403", "3301", "4101", "4201", "4202", "4301", "4302", "5101" );
  end;

/* =============================== î„≠™Ê®® ================================ */

private     // à¨Ô ®·ØÆ´≠®‚•´Ô
MACRO GetNameOper()
  FILE pers (person);
  pers.Oper = {oper};
  if ( getEQ( pers ) )
          return pers.Name;
  else    return "";
  end;
END;

private
MACRO LoadAllVars()
  var v_temp, v_value, v_result = false;
  message( "ó‚•≠®• Ø•‡•¨•≠≠ÎÂ ‰Æ‡¨Î..." );
  var i = 0;
  while( i < MaxChar )
    if( not è‡ÆÁ®‚†‚Ïè•‡•¨•≠≠„Ó2( v_temp, v_value, Ñ†‚†é‚Á•‚†, è‡•§Ñ†‚†é‚Á•‚†, {ç†ß¢†≠®• Æ‚Á•‚†}, Prefix + CharArray[0][i] ) )
        msgbox( "éË®°™† Á‚•≠®Ô Ø•‡•¨•≠≠Æ© ", Prefix + CharArray[0][i] );
    end;
    if( (v_value != NULL) and (v_value != $0) )
      v_result = true;
      CharArray[1][i] = v_value;
    else
      CharArray[1][i] = $0;
    end;
  i = i + 1;
  end;
  return v_result;
END;

private
MACRO PrintHeader()
  var day, ReportDate;

  datesplit( (Ñ†‚†é‚Á•‚† + 1), day, NULL, NULL);
  ReportDate  = "çÄ " + "\"" + string( day ) + "\" " + substr( string(( Ñ†‚†é‚Á•‚† + 1):m ), 4 );
  [                                                                                               ];
  [                                                                        Å†≠™Æ¢·™†Ô Æ‚Á•‚≠Æ·‚Ï  ];
  [           ⁄ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø ];
  [           ≥   äÆ§    ≥                 äÆ§ ™‡•§®‚≠Æ© Æ‡£†≠®ß†Ê®®(‰®´®†´†)                   ≥ ];
  [           ≥‚•‡‡®‚Æ‡®®√ƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [           ≥ ØÆ éäÄíé ≥ ØÆ éäèé  ≥é·≠Æ¢≠Æ© £Æ·„§†‡·‚¢•≠≠Î©≥ê•£®·‚‡†Ê®Æ≠≠Î© ≠Æ¨•‡≥    Åàä     ≥ ];
  [           ≥          ≥          ≥  ‡•£®·‚‡†Ê®Æ≠≠Î© ≠Æ¨•‡ ≥ (/ØÆ‡Ô§™Æ¢Î© ≠Æ¨•‡) ≥            ≥ ];
  [           √ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [           ≥    #     ≥    #     ≥           #            ≥          #          ≥     #      ≥ ]( äÆ§_ëéÄíé:c, äÆ§_éäèé:c, éÉêç:c, ê•£_≠Æ¨•‡, {MFO_Bank}:c );
  [           ¿ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒŸ ];
  [                                                                                               ];
  [     êÄëòàîêéÇäà éíÑÖãúçõï ÅÄãÄçëéÇõï ëóÖíéÇ à ëàåÇéãéÇ éíóÖíÄ é èêàÅõãüï à ìÅõíäÄï Ñãü        ];
  [    îéêåàêéÇÄçàü ÅìïÉÄãíÖêëäéÉé ÅÄãÄçëÄ (èìÅãàäìÖåÄü îéêåÄ), éíóÖíÄ é èêàÅõãüï à ìÅõíäÄï       ];
  [      (èìÅãàäìÖåÄü îéêåÄ) à êÄëóÖíÄ èéäÄáÄíÖãÖâ, àëèéãúáìÖåõï Ñãü éñÖçäà îàçÄçëéÇéâ            ];
  [                            ìëíéâóàÇéëíà äêÖÑàíçõï éêÉÄçàáÄñàâ                                 ];
  [                        èé ëéëíéüçàû #                                                         ]( ReportDate );
  [                                                                                               ];
  [  ##################################  ######################################################   ]( NameStr:w, {Name_Bank}:w:l );
  [  èÆÁ‚Æ¢Î© †§‡•·    #                                                                          ]( {Post_Addr}:l );
  [                                                                                               ];

END;

private
MACRO InitReport()
    Report.AddColumn( "", 9, AL_CENTER );
    Report.AddColumn( "", 41, AL_CENTER );
    Report.AddColumn( "", 32, AL_RIGHT );
END;

private
MACRO PrintTableHead()
  [                                                                            äÆ§ ‰Æ‡¨Î 0409110  ];
  [                                                                                     å•·ÔÁ≠†Ô  ];
  [                                                                                     ‚Î·.‡„°.  ];
  [  ⁄ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒø ];
  [  ≥ çÆ¨•‡ Ø/Ø ≥        äÆ§ Æ°Æß≠†Á•≠®Ô ‡†·Ë®‰‡Æ¢™®        ≥              ë„¨¨†               ≥ ];
  [  √ƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ≈ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [  ≥     1     ≥                     2                     ≥                3                 ≥ ];
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [  ≥          ê†ß§•´ I. ê†·Ë®‰‡Æ¢™® °†´†≠·Æ¢ÎÂ ·Á•‚Æ¢, ®·ØÆ´Ïß„•¨Î• §´Ô ‰Æ‡¨®‡Æ¢†≠®Ô          ≥ ];
  [  ≥                         °„Â£†´‚•‡·™Æ£Æ °†´†≠·† (Ø„°´®™„•¨†Ô ‰Æ‡¨†)                       ≥ ];
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
END;

private
MACRO PrintTableSubHead2()
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [  ≥                ê†ß§•´ II. ê†·Ë®‰‡Æ¢™® ·®¨¢Æ´Æ¢ Æ‚Á•‚† Æ Ø‡®°Î´ÔÂ ® „°Î‚™†Â,              ≥ ];
  [  ≥      ®·ØÆ´Ïß„•¨Î• §´Ô ‰Æ‡¨®‡Æ¢†≠®Ô Æ‚Á•‚† Æ Ø‡®°Î´ÔÂ ® „°Î‚™†Â (Ø„°´®™„•¨†Ô ‰Æ‡¨†)       ≥ ];
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
END;

private
MACRO PrintTableSubHead3()
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
  [  ≥                    ê†ß§•´ III. ê†·Ë®‰‡Æ¢™® §´Ô ‡†·Á•‚† ØÆ™†ß†‚•´•©,                      ≥ ];
  [  ≥           ®·ØÆ´Ïß„•¨ÎÂ §´Ô ÆÊ•≠™® ‰®≠†≠·Æ¢Æ© „·‚Æ©Á®¢Æ·‚® ™‡•§®‚≠ÎÂ Æ‡£†≠®ß†Ê®©          ≥ ];
  [  √ƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¬ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¥ ];
END;

private
MACRO PrintTableFooter()
  [  ¿ƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ¡ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒŸ ];
  [                                                                                               ];
END;

private
MACRO PrintFooter()

  [                                                                                               ];
  [  ê„™Æ¢Æ§®‚•´Ï #                                                        (î.à.é.)               ]( {FIO_Boss}:l );
  [  É´†¢≠Î© °„Â£†´‚•‡ #                                                   (î.à.é.)               ]( {FIO_Book}:l );
  [  å.è.                                                                                         ];
  [  à·ØÆ´≠®‚•´Ï #                                                         (î.à.é.)               ]( GetNameOper():l );
  [  í•´•‰Æ≠: #                                                                                   ]( çÆ¨•‡_‚•´•‰Æ≠†:l );
  [                                                                                               ];
  [  #                                                                                            ]( trim( string( {curdate}:m ) ) );
  [                                                                                               ];

END;

private
MACRO PrintNoData()
  [                                                                                               ];
  [  Ñ†≠≠Î• Æ‚·„‚·‚¢„Ó‚.                                                                          ];
  [                                                                                               ];
END;

/* ========================= é·≠Æ¢≠†Ô Ø‡ÆÊ•§„‡† =========================== */

private
MACRO PrintForm()
  var i;

  PrintHeader();
  
  if( LoadAllVars() )

    message( "è•Á†‚Ï Æ‚Á•‚≠Æ© ‰Æ‡¨Î..." );
    InitReport();
    PrintTableHead();
    i = 0;
    while( i < MaxChar1 )
      Report.PrintString( i+1, CharArray[0][i], string(CharArray[1][i]:0:0) );
      i = i + 1;
    end;
    if( IsQuartal )
      PrintTableSubHead2();
      while( i < MaxChar2 )
        Report.PrintString( i+1, CharArray[0][i], string(CharArray[1][i]:0:0) );
        i = i + 1;
      end;
      PrintTableSubHead3();
      while( i < MaxChar3 )
        Report.PrintString( i+1, CharArray[0][i], string(CharArray[1][i]:0:0) );
        i = i + 1;
      end;
    end;
    PrintTableFooter();

  else
    PrintNoData();
  end;

  PrintFooter();

END;

/* =================== íÆÁ™† ¢ÂÆ§† ¢ Ø‡Æ£‡†¨¨„ ============================ */

var par = cmdargs();

if( par == "protocol" )
  ViewFileLog(ProtocolFileName);
  ì·‚†≠Æ¢®‚Ïî´†£ÇÆß¢‡†‚†( OK_MACRO_FLAG ); // ì·Ø•Ë≠Æ• ß†¢•‡Ë•≠®• ¨†™‡Æ·† 
  exit(1);
else
  PrintForm();
end;
