/*
$Name:          f301ReportPrintController_2470.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Контроллер печати
*/

class (TReportPrintController) TReportPrintController_2470U
    initTReportPrintController();

    private macro printPart1(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До востребования:", 3,4,5,6,7,8,9,10,11,12,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Срочные:", 3,4,5,6,7,8,9,10,11,12,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 3,4,5,6,7,8,9,10,11,12,13);
        partView.printString(valuePool);

        partView.printBottom();
    end;

    private macro printPart2(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 16,17,18,19,20,21,22,23,24,25,26,27,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 16,17,18,19,20,21,22,23,24,25,26,27,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 16,17,18,19,20,21,22,23,24,25,26,27,28);
        partView.printString(valuePool);

        partView.printBottom();
    end;

    private macro printPart3(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 31,32,33,34,35,36);
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 31,32,33,34,35,36);
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 31,32,33,34,35,36);
        partView.printString(valuePool);

        partView.printBottom();
    end;
end;

class (TReportPrintController_2470U) TReportPrintController_4212
    initTReportPrintController_2470U();

    private macro printPart1(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До востребования:", 3,4,5,6,7,8,9,10,11,12,13,14,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Срочные:", 3,4,5,6,7,8,9,10,11,12,13,14,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 3,4,5,6,7,8,9,10,11,12,13,14,15);
        partView.printString(valuePool);

        partView.printBottom();
    end;

    private macro printPart2(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 18,19,20,21,22,23,24,25,26,27,28,29,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 18,19,20,21,22,23,24,25,26,27,28,29,"X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 18,19,20,21,22,23,24,25,26,27,28,29,30);
        partView.printString(valuePool);

        partView.printBottom();
    end;

    private macro printPart3(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 33,34,35,36,37,38);
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 33,34,35,36,37,38);
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 33,34,35,36,37,38);
        partView.printString(valuePool);

        partView.printBottom();
    end;

    macro print()
        if (not global.getRcbReport().isCalculated())
            msgBox("Печать может быть выполнена только после выполнения операции \"Расчет\"");
            RepErrorsQueue().add(0, "Печать может быть выполнена только после выполнения операции \"Расчет\"");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        getReportView().setOutputFile();

        getReportView.setReportWidth(m_reportWidth);
        getReportView.printLendingAgencyCodeZone();
        getReportView.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации ");

        if (getReport().isEmpty())
            getReportView.printNullDataZone();
        else
            printPart1(getReportView.getPart1ReportView(), getReport().getPart(1));
            printPart2(getReportView.getPart2ReportView(), getReport().getPart(2));
            printPart3(getReportView.getPart3ReportView(), getReport().getPart(3));
        end;

        getReportView.printSignatureZone();
        getReportView.show();

        getReportView().resetOutputFile();
    end;
end;

class (TReportPrintController_4212) TReportPrintController_4637()
    initTReportPrintController_4212();

    private macro printPart1(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();

        partView.printHead();

        initializeValuePool(valuePool, part, 1, "1", "До востребования:", 3,4,5,6,7,8,9,10,11,12,"X","X","X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Срочные:", 3,4,5,6,7,8,9,10,11,12,"X","X","X");
        partView.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 3,4,5,6,7,8,9,10,11,12,13,14,15);
        partView.printString(valuePool);

        partView.printBottom();
    end;
end;

class (TReportPrintController_4637) TReportPrintController_4927(format : Integer)
    private var m_isExcelReport : Bool = false;
	private var m_reportExcelView : Object = null;
    private var m_excelReport : Object = null;
    private var m_format : Integer;

    private macro printPart1(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();
        var controller = ternary(m_isExcelReport, m_excelReport, partView);

        if (m_isExcelReport)
            controller.printHeaderTable(partView.getTableHeader(), "Обязательства КО");
        else
            controller.printHead()
        end;

        initializeValuePool(valuePool, part, 1, "1", "До востребования:", 3,4,5,6,7,8,9,10,11,12,"X","X","X");
        controller.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 2, "2", "Срочные:", 3,4,5,6,7,8,9,10,11,12,"X","X","X");
        controller.printString(valuePool);
        valuePool.clear();

        initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 3,4,5,6,7,8,9,10,11,12,13,14,15);
        controller.printString(valuePool);

        if (not m_isExcelReport)
            controller.printBottom();
		else
			controller.print();
        end;
    end;

    private macro printPart2(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();
        var controller = ternary(m_isExcelReport, m_excelReport, partView);

        if (m_isExcelReport)
            controller.printHeaderTable(partView.getTableHeader(), "Требования КО");
        else
            controller.printHead()
        end;
            initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 18,19,20,21,22,23,24,25,26,27,28,29,"X");
            controller.printString(valuePool);
            valuePool.clear();

            initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 18,19,20,21,22,23,24,25,26,27,28,29,"X");
            controller.printString(valuePool);
            valuePool.clear();

            initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 18,19,20,21,22,23,24,25,26,27,28,29,30);
            controller.printString(valuePool);

        if (not m_isExcelReport)
            controller.printBottom();
		else
			controller.print();
        end;
    end;

    private macro printPart3(partView : RcbPartView, part : TPart)
        var valuePool = RcbArray();
        var controller = ternary(m_isExcelReport, m_excelReport, partView);

        if (m_isExcelReport)
            controller.printHeaderTable(partView.getTableHeader(), "Межбанковские операции КО");
        else
            controller.printHead()
        end;
            initializeValuePool(valuePool, part, 1, "1", "До 1 года:", 33,34,35,36,37,38);
            controller.printString(valuePool);
            valuePool.clear();

            initializeValuePool(valuePool, part, 2, "2", "Свыше 1 года:", 33,34,35,36,37,38);
            controller.printString(valuePool);
            valuePool.clear();

            initializeValuePool(valuePool, part, 3, "3", "ИТОГО", 33,34,35,36,37,38);
            controller.printString(valuePool);

        if (not m_isExcelReport)
            controller.printBottom();
		else
			controller.print();
        end;
    end;

    private macro printExcel()
        m_excelReport.printHeader();

        if (getReport().isEmpty())
            m_excelReport.printNullDataZone();
        else
            printPart1(getReportView.getPart1ReportView(), getReport().getPart(1));
            printPart2(getReportView.getPart2ReportView(), getReport().getPart(2));
            printPart3(getReportView.getPart3ReportView(), getReport().getPart(3));
        end;

        m_excelReport.printSignatureZone();

        m_excelReport.show(m_reportView.getFileName());
    end;

    macro print()
        if (not global.getRcbReport().isCalculated())
            msgBox("Печать может быть выполнена только после выполнения операции \"Расчет\"");
            RepErrorsQueue().add(0, "Печать может быть выполнена только после выполнения операции \"Расчет\"");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        if (m_isExcelReport)
            return printExcel();
        end;

        getReportView().setOutputFile();

        getReportView.printLendingAgencyCodeZone();
        getReportView.printNamesZone("Полное или сокращенное фирменное наименование кредитной организации ");

        if (getReport().isEmpty())
            getReportView.printNullDataZone();
        else
            printPart1(getReportView.getPart1ReportView(), getReport().getPart(1));
            printPart2(getReportView.getPart2ReportView(), getReport().getPart(2));
            printPart3(getReportView.getPart3ReportView(), getReport().getPart(3));
        end;

        getReportView.printSignatureZone();
        getReportView.show();

        getReportView().resetOutputFile();
    end;

    private macro constructorTReportPrintController_4927(format : Integer)
        initTReportPrintController_4637();

        m_reportView = objectFactoryInstance.createReportView();
        m_reportView.setReportWidth(m_reportWidth);;
        m_format = nvl(format, WINREP_FORMAT_HTML);

        if (m_format == WINREP_FORMAT_XLSX)
            m_isExcelReport = true;
			m_reportExcelView  = objectFactoryInstance.createReportExcelView();
            m_excelReport = objectFactoryInstance.createExcelReportPrintController(m_reportExcelView);
        end;

    end;

    constructorTReportPrintController_4927(format)
end;

/**
 ДОДЕЛАТЬ!!!!!!
 */
class (TAdditionalReportPrintController_2332) TAdditionalReportPrintController_2470U
    initTAdditionalReportPrintController_2332();

    private macro initialize()
        if (not global.getRcbReport().isCalculated())
            msgBox("Для выпуска \"Дополнительного отчета\", необходимо произвести расчет текущего отчета");
            RepErrorsQueue().add(0, "Для выпуска \"Дополнительного отчета\", необходимо произвести расчет текущего отчета");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        var previousRcbReport = global.getRcbReport().createPreviousReport();

        if (not previousRcbReport.isCalculated())
            var protocolView2  = TProtocolView("301additionalReport");

            protocolView2.setProtocolOutput();
            protocolView2.printHead();
            protocolView2.printLine("Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за предыдущий период");
            protocolView2.resetProtocolOutput();
            protocolView2.show();

            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        if (global.getRcbReport().dimension != previousRcbReport.dimension)
            msgBox("Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за текущий и предыдущий периоды в"+
                   " одинаковых единицах измерения");
            RepErrorsQueue().add(0, "Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за текущий и предыдущий периоды в"+
                                    " одинаковых единицах измерения");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        m_view           = objectFactoryInstance.createAdditionalReportView();
        m_currentReport  = objectFactoryInstance.createReport();
        m_previousReport = objectFactoryInstance.createReport(previousRcbReport);

        m_attributeDescriptionPool.push_back(TRcbPair(3,  "В рублях, перед нефинансовыми и финансовыми (кроме кредитных) организациями"));
        m_attributeDescriptionPool.push_back(TRcbPair(4,  "В рублях, перед физическими лицами"));
        m_attributeDescriptionPool.push_back(TRcbPair(5,  "В рублях, перед органами государственного управления и внебюджетными фондами, всего"));
        m_attributeDescriptionPool.push_back(TRcbPair(6,  "В рублях, перед органами государственного управления и внебюджетными фондами, из них перед федеральными органами государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(7,  "В рублях, перед органами государственного управления и внебюджетными фондами, из них перед органами власти субъектов Российской Федерации и органами местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(8,  "В ин. Валюте, перед нефинансовыми и финансовыми (кроме кредитных) организациями"));
        m_attributeDescriptionPool.push_back(TRcbPair(9,  "В ин. валюте, перед физическими лицами"));
        m_attributeDescriptionPool.push_back(TRcbPair(10, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, всего"));
        m_attributeDescriptionPool.push_back(TRcbPair(11, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, из них перед федеральными органами государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(12, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, из них перед органами власти субъектов Российской Федерации и органами местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(13, "Денежные средства"));
        m_attributeDescriptionPool.push_back(TRcbPair(16, "В рублях, к органам гос. Управления и внебюджетным фондам,  федеральным органам государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(17, "В рублях, к органам гос. Управления и внебюджетным фондам,  органам власти субъектов Российской Федерации и органам местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(18, "В рублях, к органам гос. Управления и  внебюджетным фондам, внебюджетным фондам"));
        m_attributeDescriptionPool.push_back(TRcbPair(19, "В рублях, к нефинансовым организациям и финансовым (кроме кредитных) организациям"));
        m_attributeDescriptionPool.push_back(TRcbPair(20, "В рублях, к физическим лицам"));
        m_attributeDescriptionPool.push_back(TRcbPair(21, "В ин. валюте, к органам гос. Управления и внебюджетным фондам,  федеральным органам государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(22, "В ин. валюте, к органам гос. управления и внебюджетным фондам, органам власти субъектов Российской Федерации и органам местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(23, "В ин. валюте, к органам гос. управления и внебюджетным фондам, внебюджетным фондам"));
        m_attributeDescriptionPool.push_back(TRcbPair(24, "В ин. валюте, к нефинансовым организациям и финансовым (кроме кредитных) организациям"));
        m_attributeDescriptionPool.push_back(TRcbPair(25, "В ин. валюте, к физическим лицам"));
        m_attributeDescriptionPool.push_back(TRcbPair(26, "Иностранные активы"));
        m_attributeDescriptionPool.push_back(TRcbPair(27, "Иностранные пассивы"));
        m_attributeDescriptionPool.push_back(TRcbPair(28, "Собственные средства кредитной организации за вычетом вложений в акции других кредитных организаций"));
        m_attributeDescriptionPool.push_back(TRcbPair(31, "В рублях, обязательства перед кредитными организациями - резидентами"));
        m_attributeDescriptionPool.push_back(TRcbPair(32, "В рублях, обязательства перед Банком России"));
        m_attributeDescriptionPool.push_back(TRcbPair(33, "В рублях, требования к кредитным организациям - резидентам"));
        m_attributeDescriptionPool.push_back(TRcbPair(34, "В рублях, требования к Банку России"));
        m_attributeDescriptionPool.push_back(TRcbPair(35, "В ин. валюте, обязательства перед кредитными организациями - резидентами"));
        m_attributeDescriptionPool.push_back(TRcbPair(36, "В ин. валюте, требования к кредитным организациям - резидентам"));
    end;

    macro print()
        m_view.setProtocolOutput();
        m_view.printHead(m_currentReport, m_previousReport);
        m_view.getTableView().printHead();

        m_view.getTableView().printLine("ОБЯЗАТЕЛЬСТВА КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        var partId    = 1;
        var rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12), "д/в");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12), "Срочн.");

        m_view.getTableView().printLine("ДЕНЕЖНЫЕ СРЕДСТВА");
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(13), "Итого");

        m_view.getTableView().printLine("ТРЕБОВАНИЯ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(16,17,18,19,20,21,22,23,24,25), "До 1 года");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(16,17,18,19,20,21,22,23,24,25), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ АКТИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(26), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(26), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ ПАССИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(27), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(27), "Свыше 1 года");

        m_view.getTableView().printLine("СОБСТВЕННЫЕ СРЕДСТВА");
        partId    = 2;
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(28), "ИТОГО");

        m_view.getTableView().printLine("МЕЖБАНКОВСКИЕ ОПЕРАЦИИ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 3;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(31,32,33,34,35,36), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(31,32,33,34,35,36), "Свыше 1 года");

        if (isEmpty())
            m_view.printNoData(differenceValue / 1000);
        else
            m_view.getTableView().printBottom();
        end;

        m_view.resetProtocolOutput();
        m_view.show();
    end;
end;

class (TAdditionalReportPrintController_2470U) TAdditionalReportPrintController_4637()
    initTAdditionalReportPrintController_2470U();

    private macro initialize()
        if (not global.getRcbReport().isCalculated())
            msgBox("Для выпуска \"Дополнительного отчета\", необходимо произвести расчет текущего отчета");
            RepErrorsQueue().add(0, "Для выпуска \"Дополнительного отчета\", необходимо произвести расчет текущего отчета");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        var previousRcbReport = global.getRcbReport().createPreviousReport();

        if (not previousRcbReport.isCalculated())
            var protocolView2  = TProtocolView("301additionalReport");

            protocolView2.setProtocolOutput();
            protocolView2.printHead();
            protocolView2.printLine("Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за предыдущий период");
            protocolView2.resetProtocolOutput();
            protocolView2.show();

            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        if (global.getRcbReport().dimension != previousRcbReport.dimension)
            msgBox("Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за текущий и предыдущий периоды в"+
                   " одинаковых единицах измерения");
            RepErrorsQueue().add(0, "Для выпуска \"Дополнительного отчета\", необходимо рассчитать форму за текущий и предыдущий периоды в"+
                                    " одинаковых единицах измерения");
            установитьФлагВозврата(STOP_PROC_FLG);
            exit(1);
        end;

        m_view           = objectFactoryInstance.createAdditionalReportView();
        m_currentReport  = objectFactoryInstance.createReport();
        m_previousReport = objectFactoryInstance.createReport(previousRcbReport);

        m_attributeDescriptionPool.push_back(TRcbPair(3,  "В рублях, перед нефинансовыми и финансовыми (кроме кредитных) организациями"));
        m_attributeDescriptionPool.push_back(TRcbPair(4,  "В рублях, перед физическими лицами"));
        m_attributeDescriptionPool.push_back(TRcbPair(5,  "В рублях, перед органами государственного управления и внебюджетными фондами, всего"));
        m_attributeDescriptionPool.push_back(TRcbPair(6,  "В рублях, перед органами государственного управления и внебюджетными фондами, из них перед федеральными органами государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(7,  "В рублях, перед органами государственного управления и внебюджетными фондами, из них перед органами власти субъектов Российской Федерации и органами местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(8,  "В ин. Валюте, перед нефинансовыми и финансовыми (кроме кредитных) организациями"));
        m_attributeDescriptionPool.push_back(TRcbPair(9,  "В ин. валюте, перед физическими лицами"));
        m_attributeDescriptionPool.push_back(TRcbPair(10, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, всего"));
        m_attributeDescriptionPool.push_back(TRcbPair(11, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, из них перед федеральными органами государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(12, "В ин. валюте, перед органами государственного управления и внебюджетными фондами, из них перед органами власти субъектов Российской Федерации и органами местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(13, "Обязательства кредитной организации по выпущенным депозитным сертификатам"));
        m_attributeDescriptionPool.push_back(TRcbPair(14, "Обязательства кредитной организации по выпущенным сберегательным сертификатам"));
        m_attributeDescriptionPool.push_back(TRcbPair(15, "Денежные средства"));
        m_attributeDescriptionPool.push_back(TRcbPair(18, "В рублях, к органам гос. Управления и внебюджетным фондам, федеральным органам государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(19, "В рублях, к органам гос. Управления и внебюджетным фондам, органам власти субъектов Российской Федерации и органам местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(20, "В рублях, к органам гос. Управления и внебюджетным фондам, внебюджетным фондам"));
        m_attributeDescriptionPool.push_back(TRcbPair(21, "В рублях, к нефинансовым организациям и финансовым (кроме кредитных) организациям"));
        m_attributeDescriptionPool.push_back(TRcbPair(22, "В рублях, к физическим лицам"));
        m_attributeDescriptionPool.push_back(TRcbPair(23, "В ин. валюте, к органам гос. Управления и внебюджетным фондам, федеральным органам государственной власти"));
        m_attributeDescriptionPool.push_back(TRcbPair(24, "В ин. валюте, к органам гос. управления и внебюджетным фондам, органам власти субъектов Российской Федерации и органам местного самоуправления"));
        m_attributeDescriptionPool.push_back(TRcbPair(25, "В ин. валюте, к органам гос. управления и внебюджетным фондам, внебюджетным фондам"));
        m_attributeDescriptionPool.push_back(TRcbPair(26, "В ин. валюте, к нефинансовым организациям и финансовым (кроме кредитных) организациям"));
        m_attributeDescriptionPool.push_back(TRcbPair(27, "В ин. валюте, к физическим лицам"));
        m_attributeDescriptionPool.push_back(TRcbPair(28, "Иностранные активы"));
        m_attributeDescriptionPool.push_back(TRcbPair(29, "Иностранные пассивы"));
        m_attributeDescriptionPool.push_back(TRcbPair(30, "Собственные средства кредитной организации за вычетом вложений в акции других кредитных организаций"));
        m_attributeDescriptionPool.push_back(TRcbPair(33, "В рублях, требования к кредитным организациям - резидентам"));
        m_attributeDescriptionPool.push_back(TRcbPair(34, "В рублях, обязательства перед Банком России"));
        m_attributeDescriptionPool.push_back(TRcbPair(35, "В рублях, требования к кредитным организациям - резидентам"));
        m_attributeDescriptionPool.push_back(TRcbPair(36, "В рублях, требования к Банку России"));
        m_attributeDescriptionPool.push_back(TRcbPair(37, "В ин. валюте, обязательства перед кредитными организациями - резидентами"));
        m_attributeDescriptionPool.push_back(TRcbPair(38, "В ин. валюте, требования к кредитным организациям - резидентам"));
    end;

    macro print()
        m_view.setProtocolOutput();
        m_view.printHead(m_currentReport, m_previousReport);
        m_view.getTableView().printHead();

        m_view.getTableView().printLine("ОБЯЗАТЕЛЬСТВА КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        var partId    = 1;
        var rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12), "д/в");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12,13,14), "Срочн.");

        m_view.getTableView().printLine("ДЕНЕЖНЫЕ СРЕДСТВА");
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(15), "Итого");

        m_view.getTableView().printLine("ТРЕБОВАНИЯ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(18,19,20,21,22,23,24,25,26,27), "До 1 года");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(18,19,20,21,22,23,24,25,26,27), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ АКТИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(28), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(28), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ ПАССИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(29), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(29), "Свыше 1 года");

        m_view.getTableView().printLine("СОБСТВЕННЫЕ СРЕДСТВА");
        partId    = 2;
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(30), "ИТОГО");

        m_view.getTableView().printLine("МЕЖБАНКОВСКИЕ ОПЕРАЦИИ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 3;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(33,34,35,36,37,38), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(33,34,35,36,37,38), "Свыше 1 года");

        if (isEmpty())
            m_view.printNoData(differenceValue / 1000);
        else
            m_view.getTableView().printBottom();
        end;

        m_view.resetProtocolOutput();
        m_view.show();
    end;
end;

class (TAdditionalReportPrintController_4637) TAdditionalReportPrintController_4927(format : Integer)
    private var m_format : Integer;
    private var m_isExcelReport : Bool = false;
    private var m_excelReport : Object = null;

    private macro printExcel()
        m_excelReport.printExcel();
        m_excelReport.show();
    end;

    macro print()
        m_view.setProtocolOutput();
        m_view.printHead(m_currentReport, m_previousReport);
        m_view.getTableView().printHead(m_currentReport, m_previousReport);

        m_view.getTableView().printLine("ОБЯЗАТЕЛЬСТВА КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        var partId    = 1;
        var rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12), "д/в");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(3,4,5,6,7,8,9,10,11,12,13,14), "Срочн.");

        m_view.getTableView().printLine("ДЕНЕЖНЫЕ СРЕДСТВА");
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(15), "Итого");

        m_view.getTableView().printLine("ТРЕБОВАНИЯ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(18,19,20,21,22,23,24,25,26,27), "До 1 года");
        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(18,19,20,21,22,23,24,25,26,27), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ АКТИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(28), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(28), "Свыше 1 года");

        m_view.getTableView().printLine("ИНОСТРАННЫЕ ПАССИВЫ");
        partId    = 2;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(29), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(29), "Свыше 1 года");

        m_view.getTableView().printLine("СОБСТВЕННЫЕ СРЕДСТВА");
        partId    = 2;
        rowNumber = 3;
        processBlock(partId, rowNumber, RcbArray().initialize(30), "ИТОГО");

        m_view.getTableView().printLine("МЕЖБАНКОВСКИЕ ОПЕРАЦИИ КРЕДИТНЫХ ОРГАНИЗАЦИЙ");
        partId    = 3;
        rowNumber = 1;
        processBlock(partId, rowNumber, RcbArray().initialize(33,34,35,36,37,38), "До 1 года");

        rowNumber = 2;
        processBlock(partId, rowNumber, RcbArray().initialize(33,34,35,36,37,38), "Свыше 1 года");

        if (isEmpty())
            m_view.printNoData(differenceValue / 1000);
        else
            m_view.getTableView().printBottom();
        end;

        m_view.resetProtocolOutput();

        if (m_isExcelReport)
            printExcel();
        else
            m_view.show();
        end;
    end;

    private macro constructorTAdditionalReportPrintController_4927(format : Integer)
        initTAdditionalReportPrintController_4637();

        m_format = nvl(format, WINREP_FORMAT_HTML);
        m_view = objectFactoryInstance.createAdditionalReportView();

        if (m_format == WINREP_FORMAT_XLSX)
            m_isExcelReport = true;
			m_view = objectFactoryInstance.createAdditionalReportExcelView();
            m_excelReport = objectFactoryInstance.createExcelAddReportPrintController(m_view);
        end;
    end;

    constructorTAdditionalReportPrintController_4927(format)
end;