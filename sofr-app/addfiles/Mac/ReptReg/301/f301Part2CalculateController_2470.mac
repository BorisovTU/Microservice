/*
$Name:          f301Part2CalculateController_2470.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Контроллер расчета раздела "Требования кредитных организаций".
*/

class (TPartCalculateController_2055U) TPart2CalculateController_2470U(reportCalculateController : Object /*TReportCalculateController*/)
    initTPartCalculateController_2055U(reportCalculateController, 2);

    macro calculateAttribute16_21_row1(attributeId : Integer)
        var attribute  = m_part.getAttribute(attributeId);
        var dataSource = m_dataSources.getBalanceDataSource();
        var rowNumber = 1;

        var value40308 = dataSource.getValue("40308", TTypeBalanceData().ruA).exact;
        var value40310 = dataSource.getValue("40310", TTypeBalanceData().ruA).exact;
        var value40306 = dataSource.getValue("40306", TTypeBalanceData().ruP).exact;
        var itogValue  = value40308 + value40310 - value40306;

        m_reportCalculateController.getProtocolView().printLine("\nДобавляются данные:");

        printProtocolLine("\nДополнительный расчет");
        printProtocolLine("─────────────────────\n");
        printProtocolLine("Бн40308РуА + Бн40310РуА - Бн40306РуП\n");
        printProtocolLine(value40308 + " + " + value40310 + " - " + value40306 + " = " + itogValue);

        if (itogValue < $0.0)
            printProtocolLine("Результат отрицательный, для расчета полагаем равным нулю");
            itogValue = $0.0;
        else
            printProtocolLine("\nРезультат >= 0, для расчета берем полученное значение");
        end;

        attribute.plus(itogValue, rowNumber);
        m_reportCalculateController.getProtocolView().printLine("\nГрафа" + attributeId + "_Строка" + rowNumber + " = " + attribute.getValue(rowNumber));
    end;

    private macro getCalculateAttribute16Data()
        var calculationDataPool = RcbArray();
        const attributeId = 16;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateAttribute16_21_row1"),
                                                       RcbArray.initialize(attributeId)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute17Data()
        var calculationDataPool = RcbArray();
        const attributeId = 17;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute18Data()
        var calculationDataPool = RcbArray();
        const attributeId = 18;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute19Data()
        var calculationDataPool = RcbArray();
        const attributeId = 19;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isTermGreetOneYear().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.2", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.3", rowNumber).getMasks()).op("AND").op("NOT").isTermGreetOneYear().op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isTermGreetOneYear().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.2", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.3", rowNumber).getMasks()).op("AND").isTermGreetOneYear().op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute20Data()
        var calculationDataPool = RcbArray();
        const attributeId = 20;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.2", rowNumber).getMasks()).OP("AND").op("NOT").isTermGreetOneYear().op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.2", rowNumber).getMasks()).op("AND").isTermGreetOneYear().op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute21Data()
        var calculationDataPool = RcbArray();
        const attributeId = 21;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateAttribute16_21_row1"),
                                                       RcbArray.initialize(attributeId)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute22Data()
        var calculationDataPool = RcbArray();
        const attributeId = 22;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute23Data()
        var calculationDataPool = RcbArray();
        const attributeId = 23;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute24Data()
        var calculationDataPool = RcbArray();
        const attributeId = 24;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isTermGreetOneYear().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.2", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.3", rowNumber).getMasks()).op("AND").op("NOT").isTermGreetOneYear().op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isTermGreetOneYear().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.2", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.3", rowNumber).getMasks()).op("AND").isTermGreetOneYear().op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute25Data()
        var calculationDataPool = RcbArray();
        const attributeId = 25;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.2", rowNumber).getMasks()).op("AND").op("NOT").isTermGreetOneYear().op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.2", rowNumber).getMasks()).op("AND").isTermGreetOneYear().op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;


    private macro getCalculateAttribute26Data()
        var calculationDataPool = RcbArray();
        const attributeId = 26;

        //Строка 1
        var rowNumber = 1;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().poA, "26.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "26.2")));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__A, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute27Data()
        var calculationDataPool = RcbArray();
        const attributeId = 27;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__P, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__P, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute28Data()
        var calculationDataPool = RcbArray();
        const attributeId = 28;

        //Строка 3
        var rowNumber = 3;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__P, "28.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "28.2", true)));

        var filter = m_dataSouceFilters.getAccountFilter().isSatisfiesToMasks(m_tuneTable.setKey("28.3", rowNumber).getMasks()).operator("AND").hasAccountAssignedCategory(RCB_OBJGROUP_REPORT, "УККО");

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute16Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute17Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute18Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute19Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute20Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute21Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute22Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute23Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute24Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute25Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute26Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute27Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute28Data());
    end;
end;

class (TPart2CalculateController_2470U) TPart2CalculateController_2539U(reportCalculateController : Object /*TReportCalculateController*/)
    initTPart2CalculateController_2470U(reportCalculateController, 2);

    macro calculateAttribute21_row1(attributeId : Integer)
        var attribute  = m_part.getAttribute(attributeId);
        var dataSource = m_dataSources.getBalanceDataSource();
        var rowNumber = 1;

        var value40308 = dataSource.getValue("40308", TTypeBalanceData().poA).exact;
        var value40310 = dataSource.getValue("40310", TTypeBalanceData().poA).exact;
        var value40306 = dataSource.getValue("40306", TTypeBalanceData().poP).exact;
        var itogValue  = value40308 + value40310 - value40306;

        m_reportCalculateController.getProtocolView().printLine("\nДобавляются данные:");

        printProtocolLine("\nДополнительный расчет");
        printProtocolLine("─────────────────────\n");
        printProtocolLine("Бн40308ПоА + Бн40310ПоА - Бн40306ПоП\n");
        printProtocolLine(value40308 + " + " + value40310 + " - " + value40306 + " = " + itogValue);

        if (itogValue < $0.0)
            printProtocolLine("Результат отрицательный, для расчета полагаем равным нулю");
            itogValue = $0.0;
        else
            printProtocolLine("\nРезультат >= 0, для расчета берем полученное значение");
        end;

        attribute.plus(itogValue, rowNumber);
        m_reportCalculateController.getProtocolView().printLine("\nГрафа" + attributeId + "_Строка" + rowNumber + " = " + attribute.getValue(rowNumber));
    end;

    private macro getCalculateAttribute19Data()
        var calculationDataPool = RcbArray();
        const attributeId = 19;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("19.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute20Data()
        var calculationDataPool = RcbArray();
        const attributeId = 20;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("20.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute21Data()
        var calculationDataPool = RcbArray();
        const attributeId = 21;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateAttribute21_row1"),
                                                       RcbArray.initialize(attributeId)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute24Data()
        var calculationDataPool = RcbArray();
        const attributeId = 24;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("24.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute25Data()
        var calculationDataPool = RcbArray();
        const attributeId = 25;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("25.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;
end;

class (TPart2CalculateController_2539U) TPart2CalculateController_3468U(reportCalculateController : Object /*TReportCalculateController*/)
    initTPart2CalculateController_2539U(reportCalculateController, 2);

    private macro getCalculateAttribute28Data()
        var calculationDataPool = RcbArray();
        const attributeId = 28;

        //Строка 3
        var rowNumber = 3;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__P, "28.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "28.2", true)));

        var filter = m_dataSouceFilters.getAccountFilter().isSatisfiesToMasks(m_tuneTable.setKey("28.3", rowNumber).getMasks()).operator("AND").hasAccountAssignedCategory(RCB_OBJGROUP_REPORT, "УККО");

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        filter = m_dataSouceFilters.getAccountFilter().isBank().op("AND").isResident().op("AND").op("NOT").isOurBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("28.4", rowNumber).getMasks());

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;
end;

class (TPart2CalculateController_3468U) TPart2CalculateController_4212(reportCalculateController : Object /*TReportCalculateController*/)
    initTPart2CalculateController_3468U(reportCalculateController, 2);

    m_tuneTable = TF301TuneTable_4212();

    macro calculateAttribute18_23_row1(attributeId : Integer)
        var attribute  = m_part.getAttribute(attributeId);
        var dataSource = m_dataSources.getBalanceDataSource();
        var rowNumber = 1;

        var value40308 = dataSource.getValue("40308", TTypeBalanceData().ruA).exact;
        var value40310 = dataSource.getValue("40310", TTypeBalanceData().ruA).exact;
        var value40306 = dataSource.getValue("40306", TTypeBalanceData().ruP).exact;
        var itogValue  = value40308 + value40310 - value40306;

        m_reportCalculateController.getProtocolView().printLine("\nДобавляются данные:");

        printProtocolLine("\nДополнительный расчет");
        printProtocolLine("─────────────────────\n");
        printProtocolLine("Бн40308РуА + Бн40310РуА - Бн40306РуП\n");
        printProtocolLine(value40308 + " + " + value40310 + " - " + value40306 + " = " + itogValue);

        if (itogValue < $0.0)
            printProtocolLine("Результат отрицательный, для расчета полагаем равным нулю");
            itogValue = $0.0;
        else
            printProtocolLine("\nРезультат >= 0, для расчета берем полученное значение");
        end;

        attribute.plus(itogValue, rowNumber);
        m_reportCalculateController.getProtocolView().printLine("\nГрафа" + attributeId + "_Строка" + rowNumber + " = " + attribute.getValue(rowNumber));
    end;

    private macro getCalculateAttribute18Data()
        var calculationDataPool = RcbArray();
        const attributeId = 18;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateAttribute18_23_row1"),
                                                       RcbArray.initialize(attributeId)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute19Data()
        var calculationDataPool = RcbArray();
        const attributeId = 19;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute20Data()
        var calculationDataPool = RcbArray();
        const attributeId = 20;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute21Data()
        var calculationDataPool = RcbArray();
        const attributeId = 21;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").op("NOT").isCentralBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("21.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").op("NOT").isCentralBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("21.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute22Data()
        var calculationDataPool = RcbArray();
        const attributeId = 22;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("22.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().ruA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("22.1", rowNumber).getMasks()).op("AND").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    macro calculateAttribute23_row1(attributeId : Integer)
        var attribute  = m_part.getAttribute(attributeId);
        var dataSource = m_dataSources.getBalanceDataSource();
        var rowNumber  = 1;

        var value40308 = dataSource.getValue("40308", TTypeBalanceData().poA).exact;
        var value40310 = dataSource.getValue("40310", TTypeBalanceData().poA).exact;
        var value40306 = dataSource.getValue("40306", TTypeBalanceData().poP).exact;
        var itogValue  = value40308 + value40310 - value40306;

        m_reportCalculateController.getProtocolView().printLine("\nДобавляются данные:");

        printProtocolLine("\nДополнительный расчет");
        printProtocolLine("─────────────────────\n");
        printProtocolLine("Бн40308ПоА + Бн40310ПоА - Бн40306ПоП\n");
        printProtocolLine(value40308 + " + " + value40310 + " - " + value40306 + " = " + itogValue);

        if (itogValue < $0.0)
            printProtocolLine("Результат отрицательный, для расчета полагаем равным нулю");
            itogValue = $0.0;
        else
            printProtocolLine("\nРезультат >= 0, для расчета берем полученное значение");
        end;

        attribute.plus(itogValue, rowNumber);
        m_reportCalculateController.getProtocolView().printLine("\nГрафа" + attributeId + "_Строка" + rowNumber + " = " + attribute.getValue(rowNumber));
    end;

    private macro getCalculateAttribute23Data()
        var calculationDataPool = RcbArray();
        const attributeId = 23;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateAttribute23_row1"),
                                                       RcbArray.initialize(attributeId)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute24Data()
        var calculationDataPool = RcbArray();
        const attributeId = 24;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute25Data()
        var calculationDataPool = RcbArray();
        const attributeId = 25;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute26Data()
        var calculationDataPool = RcbArray();
        const attributeId = 26;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").op("NOT").isCentralBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("26.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().op("NOT").isPhysicalPerson().op("AND").isResident().op("AND").op("NOT").isBank().op("AND").op("NOT").isCentralBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("26.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute27Data()
        var calculationDataPool = RcbArray();
        const attributeId = 27;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        var filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("27.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().poA, true);

        filter = m_dataSouceFilters.getAccountFilter().isPhysicalPerson().op("AND").isResident().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("27.1", rowNumber).getMasks()).op("AND").op("NOT").isRouble();

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter)));

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute28Data()
        var calculationDataPool = RcbArray();
        const attributeId = 28;

        //Строка 1
        var rowNumber = 1;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().poA, "28.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "28.2")));

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__A, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute29Data()
        var calculationDataPool = RcbArray();
        const attributeId = 29;

        //Строка 1
        var rowNumber = 1;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__P, true);

        //Строка 2
        rowNumber = 2;
        standartCalculateAttributeData(calculationDataPool, attributeId, rowNumber, TTypeBalanceData().__P, true);

        //Строка 3
        standartSummarizeAttributeData(calculationDataPool, attributeId, true);

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    private macro getCalculateAttribute30Data()
        var calculationDataPool = RcbArray();
        const attributeId = 30;

        //Строка 3
        var rowNumber = 3;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__P, "30.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "30.2", true)));

        var filter = m_dataSouceFilters.getAccountFilter().isSatisfiesToMasks(m_tuneTable.setKey("30.3", rowNumber).getMasks()).operator("AND").hasAccountAssignedCategory(RCB_OBJGROUP_REPORT, "УККО");

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        filter = m_dataSouceFilters.getAccountFilter().isBank().op("AND").isResident().op("AND").op("NOT").isOurBank().op("AND").isSatisfiesToMasks(m_tuneTable.setKey("30.4", rowNumber).getMasks());

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;

    macro execute()
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute18Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute19Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute20Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute21Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute22Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute23Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute24Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute25Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute26Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute27Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute28Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute29Data());
        m_reportCalculateController.addCalculationAttributeData(getCalculateAttribute30Data());
    end;
end;

class (TPart2CalculateController_4212) TPart2CalculateController_4927(reportCalculateController : Object /*TReportCalculateController*/)
    initTPart2CalculateController_4212(reportCalculateController, 2);

    m_tuneTable = TF301TuneTable_4927();

    private macro getCalculateAttribute30Data()
        var calculationDataPool = RcbArray();
        const attributeId = 30;

        //Строка 3
        var rowNumber = 3;
        calculationDataPool.push_back(TCalculationData(r2m(this, "printAttributeHead"),
                                                       RcbArray.initialize(attributeId, rowNumber)));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__P, "30.1")));

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForBalance"),
                                                       RcbArray.initialize(attributeId, rowNumber, TTypeBalanceData().__A, "30.2", true)));

        var filter = m_dataSouceFilters.getAccountFilter().isSatisfiesToMasks(m_tuneTable.setKey("30.3", rowNumber).getMasks()).operator("AND").hasAccountAssignedCategory(RCB_OBJGROUP_REPORT, "УККО");

        calculationDataPool.push_back(TCalculationData(r2m(this, "calculateForAccount"),
                                                       RcbArray.initialize(attributeId, rowNumber, filter, true)));

        return TCalculationAttributeData(m_part.getAttribute(attributeId), calculationDataPool, TDependencesData());
    end;
end;