/*
$Name:          f301ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Фабрика объектов.
*/

import repException;

class (RcbObjectFactoryBase) TObjectFactory()
    initRcbObjectFactoryBase();

    macro createReport(report /*: RcbReport*/) /*: TReport*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createReport"));
    end;

    macro createPart() /*: TPart*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createPart"));
    end;

    macro createAttribute() /*: TAttribute*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createAttribute"));
    end;

    macro createDataSources() /*: TDataSources*/
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSources"));
    end;

    macro createDataSourceFilters()
        throw(TPureVirtualMethodCallException("TObjectFactory::createDataSourceFilters"));
    end;

    macro createCalculateProtocolView()
        throw(TPureVirtualMethodCallException("TObjectFactory::createCalculateProtocolView"));
    end;

    macro createReportCalculateController()
        throw(TPureVirtualMethodCallException("TObjectFactory::createReportCalculateController"));
    end;

    macro createReportView()
        throw(TPureVirtualMethodCallException("TObjectFactory::createReportView"));
    end;

    macro createReportPrintController()
        throw(TPureVirtualMethodCallException("TObjectFactory::createReportPrintController"));
    end;

    macro createAdditionalReportPrintController()
        throw(TPureVirtualMethodCallException("TObjectFactory::createAdditionalReportPrintController"));
    end;

    macro createAdditionalReportView()
        throw(TPureVirtualMethodCallException("TObjectFactory::createAdditionalReportView"));
    end;
end;


class (TObjectFactory) TObjectFactory2055U()
    /**
     * Конструктор базового объекта
     */
    initTObjectFactory();

    macro createReport(report /*: RcbReport*/) /*: TReport*/
        return genObject("TReport_2055U", report);
    end;

    macro createPart(partId : Integer, compositeValue : Object)
        return genObject("TPart_2055U", partId, compositeValue);
    end;

    macro createAttribute(id : Integer, compositeValue : Object)
        return genObject("TAttribute_2055U", id, compositeValue);
    end;

    macro createDataSources(protocolView : Object)
        return genObject("TDataSources_2055U", protocolView);
    end;

    macro createDataSourceFilters()
        return genObject("TDataSourceFilters_2055U");
    end;

    macro createCalculateProtocolView()
        return genObject("TCalculateProtocolView_2055U");
    end;

    macro createReportCalculateController()
        return genObject("TReportCalculateController_2055U");
    end;

    macro createReportView()
        return genObject("TReportView");
    end;

    macro createReportPrintController()
        return genObject("TReportPrintController");
    end;

    macro createAdditionalReportPrintController()
        return genObject("TAdditionalReportPrintController");
    end;

    macro createAdditionalReportView()
        return genObject("TAdditionalReportView");
    end;

    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController_2055U");
    end;

    macro createKlikoExportController()
        return genObject("TKlikoExportController");
    end;
end;


class (TObjectFactory2055U) TObjectFactory_2332U()
    initTObjectFactory2055U();

    macro createPrintableView(formName : String, formOkudCode : String, formPeriodicity : Integer, periodFormat : Integer)
        return genObject("TPrintableView_2332", formName, formOkudCode, formPeriodicity, periodFormat);
    end;

    macro createReportView()
        return genObject("TReportView_2332");
    end;

    macro createAdditionalReportPrintController()
        return genObject("TAdditionalReportPrintController_2332");
    end;

    macro createReportCalculateController()
        return genObject("TReportCalculateController_2332");
    end;
end;

class (TObjectFactory2055U) TObjectFactory_2470U()
    initTObjectFactory2055U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_2470U");
    end;

    macro createReportView()
        return genObject("TReportView_2470U");
    end;

    macro createReportPrintController()
        return genObject("TReportPrintController_2470U");
    end;

    macro createAdditionalReportPrintController()
        return genObject("TAdditionalReportPrintController_2470U");
    end;
end;

class (TObjectFactory_2470U) TObjectFactory_2539U()
    initTObjectFactory2055U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_2539U");
    end;

    macro createCalculateProtocolView()
        return genObject("TCalculateProtocolView_2539U");
    end;
end;

class (TObjectFactory_2539U) TObjectFactory_2926U()
    initTObjectFactory_2539U();

    macro createDataSourceFilters()
        return genObject("TDataSourceFilters_2926U");
    end;

    macro createDataSources(protocolView : Object)
        return genObject("TDataSources_2926U", protocolView);
    end;

    macro createCalculateProtocolView()
        return genObject("TCalculateProtocolView_2926U");
    end;
end;

class (TObjectFactory_2926U) TObjectFactory_3006U()
    initTObjectFactory_2926U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_3006U");
    end;
end;

class (TObjectFactory_3006U) TObjectFactory_3129U()
    initTObjectFactory_3006U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_3129U");
    end;
end;

class (TObjectFactory_3129U) TObjectFactory_3269U()
    initTObjectFactory_3129U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_3269U");
    end;
end;

class (TObjectFactory_3269U) TObjectFactory_3468U()
    initTObjectFactory_3269U();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_3468U");
    end;
end;

class (TObjectFactory_3468U) TObjectFactory_4212()
    initTObjectFactory_3468U();

    macro createReport(report /*: RcbReport*/) /*: TReport*/
        return genObject("TReport_4212", report);
    end;

    macro createReportPrintController()
        return genObject("TReportPrintController_4212");
    end;

    macro createReportView()
        return genObject("TReportView_4212");
    end;

    macro createReportCalculateController()
        return genObject("TReportCalculateController_4212");
    end;
end;

class (TObjectFactory_4212) TObjectFactory_4637()
    initTObjectFactory_4212();

    macro createReportPrintController()
        return genObject("TReportPrintController_4637");
    end;

    macro createReportView()
        return genObject("TReportView_4637");
    end;

    macro createAdditionalReportPrintController()
        return genObject("TAdditionalReportPrintController_4637");
    end;

    macro createReportCalculateController()
        return genObject("TReportCalculateController_4637");
    end;

    macro createPtkPsdExportController()
        return genObject("TPtkPsdExportController_4637");
    end;

    macro createKlikoExportController()
        return genObject("TKlikoExportController_4637");
    end;
end;

class (TObjectFactory_4637) TObjectFactory_4927()
    initTObjectFactory_4637();

    macro createReportCalculateController()
        return genObject("TReportCalculateController_4927");
    end;

    macro createExcelPrintEngine(reportView : Object)
        return genObject("TF301ExcelPrintEngine", reportView);
    end;
	
	macro createReportExcelView()
        return genObject("TF301ReportExcelView");
    end;
	
	macro createExcelReportPrintController(reportView : Object)
        return genObject("TF301ExcelReportPrintController", reportView);
    end;
	
	macro createAdditionalReportExcelView()
        return genObject("TAdditionalReportExcelView");
    end;
	
	macro createExcelAddReportPrintController(reportView : Object)
        return genObject("TF301ExcelAddReportPrintController", reportView);
    end;

    macro createReportPrintController(format : Integer)
        return genObject("TReportPrintController_4927", format);
    end;

    macro createAdditionalReportPrintController(format : Integer)
        return genObject("TAdditionalReportPrintController_4927", format);
    end;

    macro createReportView()
        return genObject("TReportView_4927");
    end;
end;

if (objectFactoryInstance == null)
    if   (global.getRcbReport().context.period.endDate >= RCB_I4927_DATE)
        objectFactoryInstance = TObjectFactory_4927();
    elif   (global.getRcbReport().context.period.endDate >= RCB_I4637_DATE)
        objectFactoryInstance = TObjectFactory_4637();
    elif (global.getRcbReport().context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TObjectFactory_4212();
    elif (global.getRcbReport().context.period.endDate >= RCB_I3468_DATE2)
        objectFactoryInstance = TObjectFactory_3468U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I3269_DATE)
        objectFactoryInstance = TObjectFactory_3269U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I3129_DATE)
        objectFactoryInstance = TObjectFactory_3129U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I3006_DATE)
        objectFactoryInstance = TObjectFactory_3006U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I2926_DATE)
        objectFactoryInstance = TObjectFactory_2926U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I2539_DATE)
        objectFactoryInstance = TObjectFactory_2539U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I2470_DATE2)
        objectFactoryInstance = TObjectFactory_2470U();
    elif (global.getRcbReport().context.period.endDate >= RCB_I2332_DATE)
        objectFactoryInstance = TObjectFactory_2332U();
    else
        objectFactoryInstance = TObjectFactory2055U();
    end;
end;
