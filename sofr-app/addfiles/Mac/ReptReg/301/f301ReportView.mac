/*
$Name:          f301ReportView.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Представления для печати
*/

class (RcbPartView) TPartReportView(partId : String)
    initRcbPartView(partId);

    macro printBottom()
        m_table.printBottom();
    println("");
    end;
end;


class (TPartReportView) TPart1ReportView_2055U()
    initTPartReportView();

    private macro initialize()
        m_table.addColumn("1",  3,  AL_CENTER);
        m_table.addColumn("2",  14, AL_LEFT);
        m_table.addColumn("3",  15, AL_RIGHT);
        m_table.addColumn("4",  14, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  15, AL_RIGHT);
        m_table.addColumn("7",  15, AL_RIGHT);
        m_table.addColumn("8",  15, AL_RIGHT);
        m_table.addColumn("9",  14, AL_RIGHT);
        m_table.addColumn("10", 16, AL_RIGHT);
        m_table.addColumn("11", 15, AL_RIGHT);
        m_table.addColumn("12", 15, AL_RIGHT);
        m_table.addColumn("13",  7, AL_RIGHT);
    end;

    macro printHead()
        [┌─────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер│                                                                                          Обязательства кредитных организаций                                                                                 │];
        [│ п/п │                                                                                                                                                                                                              │];
        [│     ├────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────┤];
        [│     │                │                                      в рублях                                           │                             в иностранной валюте                                        │         │];
        [│     │                ├─────────────────┬────────────────┬──────────────────────────────────────────────────────┼─────────────────┬────────────────┬──────────────────────────────────────────────────────┤         │];
        [│     │   по срокам    │      перед      │     перед      │перед органами государственного управлений и          │      перед      │     перед      │перед органами государственного управлений и          │         │];
        [│     │   размещения   │  нефинансовыми  │  физическими   │ внебюджетными фондами                                │  нефинансовыми  │  физическими   │ внебюджетными фондами                                │         │];
        [│     │                │  организациями  │     лицами     ├──────────────────┬───────────────────────────────────┤  организациями  │     лицами     ├──────────────────┬───────────────────────────────────┤         │];
        [│     │                │                 │                │                  │            из них перед           │                 │                │                  │            из них перед           │         │];
        [│     │                │                 │                │                  ├─────────────────┬─────────────────┤                 │                │                  ├─────────────────┬─────────────────┤ денежные│];
        [│     │                │                 │                │                  │   федеральными  │ органами власти │                 │                │                  │   федеральными  │ органами власти │ средства│];
        [│     │                │                 │                │                  │     органами    │    субъектов    │                 │                │                  │     органами    │    субъектов    │         │];
        [│     │                │                 │                │     Всего        │  государственной│   Российской    │                 │                │     Всего        │ государственной │   Российской    │         │];
        [│     │                │                 │                │                  │      власти     │   Федерации и   │                 │                │                  │      власти     │   Федерации и   │         │];
        [│     │                │                 │                │                  │                 │органами местного│                 │                │                  │                 │органами местного│         │];
        [│     │                │                 │                │                  │                 │ самоуправления  │                 │                │                  │                 │ самоуправления  │         │];
        [│     │                │                 │                │                  │                 │                 │                 │                │                  │                 │                 │         │];
        [├─────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
        [│  1  │       2        │        3        │        4       │        5         │         6       │        7        │        8        │        9       │         10       │       11        │        12       │    13   │];
        [├─────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
    end;
end;

class (TPartReportView) TPart1ReportView_2332U()
    initTPartReportView("1");

    private macro initialize()
        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  14, AL_LEFT);
        m_table.addColumn("3",  15, AL_RIGHT);
        m_table.addColumn("4",  14, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  15, AL_RIGHT);
        m_table.addColumn("7",  15, AL_RIGHT);
        m_table.addColumn("8",  15, AL_RIGHT);
        m_table.addColumn("9",  14, AL_RIGHT);
        m_table.addColumn("10", 16, AL_RIGHT);
        m_table.addColumn("11", 15, AL_RIGHT);
        m_table.addColumn("12", 15, AL_RIGHT);
        m_table.addColumn("13",  7, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер │                                                                                          Обязательства кредитных организаций                                                                                 │];
        [│строки│                                                                                                                                                                                                              │];
        [│      ├────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────┤];
        [│      │                │                                      в рублях                                           │                             в иностранной валюте                                        │         │];
        [│      │                ├─────────────────┬────────────────┬──────────────────────────────────────────────────────┼─────────────────┬────────────────┬──────────────────────────────────────────────────────┤         │];
        [│      │   по срокам    │      перед      │     перед      │перед органами государственного управлений и          │      перед      │     перед      │перед органами государственного управлений и          │         │];
        [│      │   размещения   │  нефинансовыми  │  физическими   │ внебюджетными фондами                                │  нефинансовыми  │  физическими   │ внебюджетными фондами                                │         │];
        [│      │                │  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤         │];
        [│      │                │(кроме кредитных)│                │                  │            из них перед           │(кроме кредитных)│                │                  │            из них перед           │         │];
        [│      │                │  организациями  │                │                  ├─────────────────┬─────────────────┤  организациями  │                │                  ├─────────────────┬─────────────────┤ денежные│];
        [│      │                │                 │                │                  │   федеральными  │ органами власти │                 │                │                  │   федеральными  │ органами власти │ средства│];
        [│      │                │                 │                │                  │     органами    │    субъектов    │                 │                │                  │     органами    │    субъектов    │         │];
        [│      │                │                 │                │     Всего        │  государственной│   Российской    │                 │                │     Всего        │ государственной │   Российской    │         │];
        [│      │                │                 │                │                  │      власти     │   Федерации и   │                 │                │                  │      власти     │   Федерации и   │         │];
        [│      │                │                 │                │                  │                 │органами местного│                 │                │                  │                 │органами местного│         │];
        [│      │                │                 │                │                  │                 │ самоуправления  │                 │                │                  │                 │ самоуправления  │         │];
        [│      │                │                 │                │                  │                 │                 │                 │                │                  │                 │                 │         │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
        [│   1  │       2        │        3        │        4       │        5         │         6       │        7        │        8        │        9       │         10       │       11        │        12       │    13   │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
    end;
end;

class (TPartReportView) TPart2ReportView_2055U()
    initTPartReportView();

    private macro initialize()
        m_table.addColumn("14", 3,  AL_CENTER);
        m_table.addColumn("15", 14, AL_LEFT);
        m_table.addColumn("16", 13, AL_RIGHT);
        m_table.addColumn("17", 14, AL_RIGHT);
        m_table.addColumn("18", 13, AL_RIGHT);
        m_table.addColumn("19", 14, AL_RIGHT);
        m_table.addColumn("20", 13, AL_RIGHT);
        m_table.addColumn("21", 14, AL_RIGHT);
        m_table.addColumn("22", 13, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 13, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 16, AL_RIGHT);
    end;

    macro printHead()
        [┌─────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬───────────────┬──────────────────┐];
        [│Номер│                                                            Требования кредитных организаций                                                       │  Иностранные  │  Иностранные  │    Собственные   │];
        [│     ├────────────────┬─────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────┤     активы    │    пассивы    │средства кредитной│];
        [│ п/п │                │                             в рублях                            │                    в иностранной валюте                        │               │               │    организации   │];
        [│     │                ├────────────────────────────────────────────────┬────────────────┼────────────────────────────────────────────────┬───────────────┤               │               │    за вычетом    │];
        [│     │                │    к органам государственного управления       │                │      к органам государственного управления     │               │               │               │ вложений в акции │];
        [│     │                │              и внебюджетным фондам             │  нефинансовым  │              и внебюджетным фондам             │ нефинансовым  │               │               │ других кредитных │];
        [│     │                ├───────────────┬────────────────┬───────────────┤ организациям и ├───────────────┬────────────────┬───────────────┤организациям и │               │               │   организаций    │];
        [│     │                │  федеральным  │органам власти  │ внебюджетным  │физическим лицам│ федеральным   │  органам власти│  внебюджетным │   физическим  │               │               │                  │];
        [│     │    по срокам   │    органам    │   субъектов    │    фондам     │                │   органам     │    субъектов   │    фондам     │     лицам     │               │               │                  │];
        [│     │  кредитования  │государственной│  Российской    │               │                │государственной│   Российской   │               │               │               │               │                  │];
        [│     │                │     власти    │Федерации и     │               │                │    власти     │  Федерации и   │               │               │               │               │                  │];
        [│     │                │               │органам местного│               │                │               │органам местного│               │               │               │               │                  │];
        [│     │                │               │ самоуправления │               │                │               │ самоуправления │               │               │               │               │                  │];
        [├─────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
        [│ 14  │       15       │      16       │       17       │      18       │       19       │      20       │       21       │      22       │      23       │      24       │      25       │        26        │];
        [├─────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
    end;
end;

class (TPartReportView) TPart2ReportView_2332U()
    initTPartReportView("2");

    private macro initialize()
        m_table.addColumn("14", 4,  AL_CENTER);
        m_table.addColumn("15", 14, AL_LEFT);
        m_table.addColumn("16", 13, AL_RIGHT);
        m_table.addColumn("17", 14, AL_RIGHT);
        m_table.addColumn("18", 13, AL_RIGHT);
        m_table.addColumn("19", 14, AL_RIGHT);
        m_table.addColumn("20", 13, AL_RIGHT);
        m_table.addColumn("21", 14, AL_RIGHT);
        m_table.addColumn("22", 13, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 13, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 16, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬───────────────┬──────────────────┐];
        [│Номер │                                                            Требования кредитных организаций                                                       │  Иностранные  │  Иностранные  │    Собственные   │];
        [│строки├────────────────┬─────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────┤     активы    │    пассивы    │средства кредитной│];
        [│      │                │                             в рублях                            │                    в иностранной валюте                        │               │               │    организации   │];
        [│      │                ├────────────────────────────────────────────────┬────────────────┼────────────────────────────────────────────────┬───────────────┤               │               │    за вычетом    │];
        [│      │                │    к органам государственного управления       │       к        │      к органам государственного управления     │      к        │               │               │ вложений в акции │];
        [│      │                │              и внебюджетным фондам             │  нефинансовым  │              и внебюджетным фондам             │ нефинансовым  │               │               │ других кредитных │];
        [│      │                ├───────────────┬────────────────┬───────────────┤ организациям и ├───────────────┬────────────────┬───────────────┤организациям и │               │               │   организаций    │];
        [│      │                │  федеральным  │органам власти  │ внебюджетным  │физическим лицам│ федеральным   │  органам власти│  внебюджетным │   физическим  │               │               │                  │];
        [│      │    по срокам   │    органам    │   субъектов    │    фондам     │                │   органам     │    субъектов   │    фондам     │     лицам     │               │               │                  │];
        [│      │  кредитования  │государственной│  Российской    │               │                │государственной│   Российской   │               │               │               │               │                  │];
        [│      │                │     власти    │Федерации и     │               │                │    власти     │  Федерации и   │               │               │               │               │                  │];
        [│      │                │               │органам местного│               │                │               │органам местного│               │               │               │               │                  │];
        [│      │                │               │ самоуправления │               │                │               │ самоуправления │               │               │               │               │                  │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
        [│  14  │       15       │      16       │       17       │      18       │       19       │      20       │       21       │      22       │      23       │      24       │      25       │        26        │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼────────────────┼───────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
    end;
end;

class (TPartReportView) TPart3ReportView_2055U()
    initTPartReportView();

    private macro initialize()
        m_table.addColumn("27", 3,  AL_CENTER);
        m_table.addColumn("28", 14, AL_LEFT);
        m_table.addColumn("29", 17, AL_RIGHT);
        m_table.addColumn("30", 15, AL_RIGHT);
        m_table.addColumn("31", 17, AL_RIGHT);
        m_table.addColumn("32", 15, AL_RIGHT);
        m_table.addColumn("33", 23, AL_RIGHT);
        m_table.addColumn("34", 26, AL_RIGHT);
    end;

    macro printHead()
        [┌─────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер│                                                     Межбанковские операции кредитных организаций                                                  │];
        [│ п/п │                                                                                                                                                   │];
        [│     ├────────────────┬───────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│     │                │                                в рублях                                   │                    в иностранной валюте              │];
        [│     │                ├─────────────────────────────────────┬─────────────────────────────────────┤                                                      │];
        [│     │                │      обязательства перед            │             требования к            │                                                      │];
        [│     │                ├───────────────────┬─────────────────┼───────────────────┬─────────────────┼─────────────────────────┬────────────────────────────┤];
        [│     │   по срокам    │    кредитными     │                 │    кредитным      │                 │  обязательства перед    │    требования к кредитным  │];
        [│     │   размещения   │  организациями-   │  Банком России  │  организациям -   │   Банку России  │кредитными организациями-│   организациям-резидентам  │];
        [│     │                │   резидентами     │                 │    резидентам     │                 │      резидентами        │                            │];
        [├─────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
        [│  27 │       28       │        29         │        30       │        31         │        32       │           33            │            34              │];
        [├─────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
    end;

    macro printBottom()
        m_table.printBottom();
    end;
end;

class (TPartReportView) TPart3ReportView_2332U()
    initTPartReportView("3");

    private macro initialize()
        m_table.addColumn("27", 4,  AL_CENTER);
        m_table.addColumn("28", 14, AL_LEFT);
        m_table.addColumn("29", 17, AL_RIGHT);
        m_table.addColumn("30", 15, AL_RIGHT);
        m_table.addColumn("31", 17, AL_RIGHT);
        m_table.addColumn("32", 15, AL_RIGHT);
        m_table.addColumn("33", 23, AL_RIGHT);
        m_table.addColumn("34", 26, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер │                                                     Межбанковские операции кредитных организаций                                                  │];
        [│строки│                                                                                                                                                   │];
        [│      ├────────────────┬───────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│      │                │                                в рублях                                   │                    в иностранной валюте              │];
        [│      │   по срокам    ├─────────────────────────────────────┬─────────────────────────────────────┤                                                      │];
        [│      │  привлечения   │      обязательства перед            │             требования к            │                                                      │];
        [│      │ (кредитования) ├───────────────────┬─────────────────┼───────────────────┬─────────────────┼─────────────────────────┬────────────────────────────┤];
        [│      │                │    кредитными     │                 │    кредитным      │                 │  обязательства перед    │    требования к кредитным  │];
        [│      │                │  организациями-   │  Банком России  │  организациям -   │   Банку России  │кредитными организациями-│   организациям-резидентам  │];
        [│      │                │   резидентами     │                 │    резидентам     │                 │      резидентами        │                            │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
        [│  27  │       28       │        29         │        30       │        31         │        32       │           33            │            34              │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
    end;

    macro printBottom()
        m_table.printBottom();
    end;
end;

class (RcbReportView) TReportView()
    initRcbReportView("ОТДЕЛЬНЫЕ ПОКАЗАТЕЛИ, ХАРАКТЕРИЗУЮЩИЕ ДЕЯТЕЛЬНОСТЬ КРЕДИТНОЙ ОРГАНИЗАЦИИ", "0409301", RCB_PK_FIVE_DAYS, DATE_OUT_PERIOD_FORMAT);

    private var m_part1ReportView : TPartReportView = TPart1ReportView_2055U();
    private var m_part2ReportView : TPartReportView = TPart2ReportView_2055U();
    private var m_part3ReportView : TPartReportView = TPart3ReportView_2055U();

    macro getPart1ReportView()
        return m_part1ReportView;
    end;

    macro getPart2ReportView()
        return m_part2ReportView;
    end;

    macro getPart3ReportView()
        return m_part3ReportView;
    end;

    macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);
    end;
end;

/**
 * Представление печати отчета по 2332-У
 */
class (RcbReportView) TReportView_2332()
    initRcbReportView("ОТДЕЛЬНЫЕ ПОКАЗАТЕЛИ, ХАРАКТЕРИЗУЮЩИЕ ДЕЯТЕЛЬНОСТЬ КРЕДИТНОЙ ОРГАНИЗАЦИИ", "0409301", RCB_PK_FIVE_DAYS, DATE_OUT_PERIOD_FORMAT);

    private macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);

        m_partViewPool.push_back(TPart1ReportView_2332U());
        m_partViewPool.push_back(TPart2ReportView_2332U());
        m_partViewPool.push_back(TPart3ReportView_2332U());
    end;

    macro getPart1ReportView()
        return getPartView("1");
    end;

    macro getPart2ReportView()
        return getPartView("2");
    end;

    macro getPart3ReportView()
        return getPartView("3");
    end;
end;

class TAdditionalReportTableView()
    private const PA_UNDEFINE       = 0;
    private const PA_HEAD           = 1;
    private const PA_EXTENSION_HEAD = 2;
    private const PA_ROW            = 3;
    private const PA_EXTENSION_ROW  = 4;
    private const PA_LINE           = 5;
    private const PA_BOTTOM         = 6;

    private var m_previousAction = PA_UNDEFINE;
    private var m_table          = CTableReport();
    private var m_extensionTable = CTableReport();

    macro initializeTable()
        m_table.addColumn("Строка",                                 6, AL_CENTER);
        m_table.addColumn("Графа",                                  5, AL_CENTER);
        m_table.addColumn("Наименование|показателя",               23, AL_LEFT  );
        m_table.addColumn("Значение текущего|периода млн.руб.",    22, AL_RIGHT );
        m_table.addColumn("Значение|предыдущего|периода млн.руб.", 22, AL_RIGHT );
        m_table.addColumn("Изменение|показателя|млн.руб.",         22, AL_RIGHT );
    end;

    macro initializeExtensionTable()
        m_extensionTable.addColumn("",                                                                                    6                 );
        m_extensionTable.addColumn("",                                                                                    5                 );
        m_extensionTable.addColumn("В состав показателя|вошли балансовые счета",                                         23, AL_LEFT        );
        m_extensionTable.addColumn("Номер б/с",                                                                           5, AL_RIGHT       );
        m_extensionTable.addColumn("Остаток за|текущий|период|млн.руб.",                                                 10, AL_RIGHT, false);
        m_extensionTable.addColumn("Номер б/с",                                                                           5, AL_RIGHT       );
        m_extensionTable.addColumn("Остаток за|предыдущий|период|млн.руб.",                                              10, AL_RIGHT, false);
        m_extensionTable.addColumn("Абсолютное изменение|остатка текущего|периода по сравнению с|предыдущим, млн. руб.", 22, AL_RIGHT       );
    end;

    macro initialize()
        initializeTable();
        initializeExtensionTable();
    end;

    macro printExtensionHead()
        m_extensionTable.memHead(null, false, false);

        m_previousAction = PA_EXTENSION_HEAD;
    end;

    macro printHead()
        m_table.printHead();
//        m_table.memHead();
//        m_table.setAllCenter(true);
//        m_table.memString(1,2,3,4,5,6);
//        m_table.setAllCenter(false);

        m_previousAction = PA_HEAD;
    end;

    macro printRow(row, column, description, curentValue, previousValue, resultValue)
        if (m_previousAction == PA_LINE)
            m_table.printSeparatorExt(true, false, 1, false);
        else
            m_table.printSeparator();
        end;

        m_table.printStringTransferByWord(row, column, description, curentValue, previousValue, resultValue);

        m_previousAction = PA_ROW;
    end;

    macro printExtensionRow(balanceNumber, curentValue, previousValue, resultValue)
        macro format(value)
            return String(round(value/global.getRcbReport().multiplier, 3):0:3);
        end;
        m_extensionTable.printStringTransferByWord("", "", "", balanceNumber, format(curentValue), balanceNumber, format(previousValue), format(resultValue));

        m_previousAction = PA_EXTENSION_ROW;
    end;

    macro printBottom()
        m_table.clearMem();
        m_extensionTable.clearMem();

        m_table.printBottom();

        m_previousAction = PA_BOTTOM;
    end;

    macro printLine(text : String)
        if (m_previousAction != PA_HEAD)
            m_table.clearMem();
            m_extensionTable.clearMem();
        end;

        m_table.memSeparatorExt(true, true, 1, false);
        m_table.memStringExt(text, m_table.getAColumns().size);

        m_previousAction = PA_LINE;
    end;

    initialize();
end;

class (TProtocolView) TAdditionalReportView()
    initTProtocolView("301additionalReport");
    private var m_tableView = null;

    macro getTableView()
        if (m_tableView == null)
            m_tableView = TAdditionalReportTableView();
        end;

        return m_tableView;
    end;

    macro printHead(currentReport : TReport, previousReport : TReport);
        [ ];
        [                                      ИЗМЕНЕНИЯ ЗНАЧЕНИЙ ПО ФОРМЕ №301];
        [ ];
        [                (Отдельные показатели, характеризующие деятельность кредитной организации)];
        [ ];
        [ Период выпуска отчета с ########## по ##########](currentReport.getPeriod().beginDate(), currentReport.getPeriod().endDate());
        [ Предыдущий период выпуска отчета с ########## по ##########](previousReport.getPeriod().beginDate(), previousReport.getPeriod().endDate());
        [ ];
    end;

    macro printNoData(delta)
        [Отсутствуют показатели, изменившие по сравнению с прошлым периодом свое значение более чем на ## млрд. рублей](delta:2:0);
    end;

    macro printLine(text : String)
        getTableView().printLine(text);
    end;

    macro printBottom()
        getTableView().printBottom();
    end;
end;
