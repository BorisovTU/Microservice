/*
$Name:          f301ReportView_2470.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Представления для печати по 2470-У
*/

class (TPartReportView) TPart1ReportView_2470U()
    initTPartReportView("1");

    private macro initialize()
        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  14, AL_LEFT);
        m_table.addColumn("3",  15, AL_RIGHT);
        m_table.addColumn("4",  14, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  15, AL_RIGHT);
        m_table.addColumn("7",  15, AL_RIGHT);
        m_table.addColumn("8",  15, AL_RIGHT);
        m_table.addColumn("9",  14, AL_RIGHT);
        m_table.addColumn("10", 16, AL_RIGHT);
        m_table.addColumn("11", 15, AL_RIGHT);
        m_table.addColumn("12", 15, AL_RIGHT);
        m_table.addColumn("13",  7, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер │                                                                                          Обязательства кредитных организаций                                                                                 │];
        [│строки│                                                                                                                                                                                                              │];
        [│      ├────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────┤];
        [│      │                │                                      в рублях                                           │                                   в иностранной валюте                                  │         │];
        [│      │                ├─────────────────┬────────────────┬──────────────────────────────────────────────────────┼─────────────────┬────────────────┬──────────────────────────────────────────────────────┤         │];
        [│      │   по срокам    │      перед      │     перед      │     перед органами государственного управлений и     │      перед      │     перед      │     перед органами государственного управлений и     │         │];
        [│      │   размещения   │  нефинансовыми  │  физическими   │                 внебюджетными фондами                │  нефинансовыми  │  физическими   │                 внебюджетными фондами                │         │];
        [│      │                │  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤         │];
        [│      │                │(кроме кредитных)│                │                  │            из них перед           │(кроме кредитных)│                │                  │            из них перед           │         │];
        [│      │                │  организациями  │                │                  ├─────────────────┬─────────────────┤  организациями  │                │                  ├─────────────────┬─────────────────┤ денежные│];
        [│      │                │                 │                │                  │   федеральными  │ органами власти │                 │                │                  │   федеральными  │ органами власти │ средства│];
        [│      │                │                 │                │                  │     органами    │    субъектов    │                 │                │                  │     органами    │    субъектов    │         │];
        [│      │                │                 │                │      Всего       │  государственной│   Российской    │                 │                │      Всего       │ государственной │   Российской    │         │];
        [│      │                │                 │                │                  │      власти     │   Федерации и   │                 │                │                  │      власти     │   Федерации и   │         │];
        [│      │                │                 │                │                  │                 │органами местного│                 │                │                  │                 │органами местного│         │];
        [│      │                │                 │                │                  │                 │ самоуправления  │                 │                │                  │                 │ самоуправления  │         │];
        [│      │                │                 │                │                  │                 │                 │                 │                │                  │                 │                 │         │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
        [│   1  │       2        │        3        │        4       │        5         │         6       │        7        │        8        │        9       │         10       │       11        │        12       │    13   │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────┤];
    end;
end;

class (TPart1ReportView_2470U) TPart1ReportView_4212()
    initTPart1ReportView_2470U("1");

    private macro initialize()
        m_table.addColumn("1",   4, AL_CENTER);
        m_table.addColumn("2",  14, AL_LEFT);
        m_table.addColumn("3",  15, AL_RIGHT);
        m_table.addColumn("4",  14, AL_RIGHT);
        m_table.addColumn("5",  16, AL_RIGHT);
        m_table.addColumn("6",  15, AL_RIGHT);
        m_table.addColumn("7",  15, AL_RIGHT);
        m_table.addColumn("8",  15, AL_RIGHT);
        m_table.addColumn("9",  14, AL_RIGHT);
        m_table.addColumn("10", 16, AL_RIGHT);
        m_table.addColumn("11", 15, AL_RIGHT);
        m_table.addColumn("12", 15, AL_RIGHT);
        m_table.addColumn("13", 12, AL_RIGHT);
        m_table.addColumn("14", 12, AL_RIGHT);
        m_table.addColumn("15",  8, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│      │                                                                                          Обязательства кредитных организаций                                                                                                                │];
        [│      ├────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────┬──────────────┬──────────────┬──────────┤];
        [│      │                │                                      в рублях                                           │                                   в иностранной валюте                                  │              │              │          │];
        [│      │                ├─────────────────┬────────────────┬──────────────────────────────────────────────────────┼─────────────────┬────────────────┬──────────────────────────────────────────────────────┤              │              │          │];
        [│Номер │   по срокам    │      перед      │     перед      │     перед органами государственного управлений и     │      перед      │     перед      │     перед органами государственного управлений и     │              │              │          │];
        [│строки│   размещения   │  нефинансовыми  │  физическими   │                 внебюджетными фондами                │  нефинансовыми  │  физическими   │                 внебюджетными фондами                │              │              │          │];
        [│      │                │  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤  и финансовыми  │     лицами     ├──────────────────┬───────────────────────────────────┤              │              │          │];
        [│      │                │(кроме кредитных)│                │                  │            из них перед           │(кроме кредитных)│                │                  │            из них перед           │по выпущенным │по выпущенным │ Денежные │];
        [│      │                │  организациями  │                │                  ├─────────────────┬─────────────────┤  организациями  │                │                  ├─────────────────┬─────────────────┤  депозитным  │сберегательным│ средства │];
        [│      │                │                 │                │                  │   федеральными  │ органами власти │                 │                │                  │   федеральными  │ органами власти │ сертификатам │ сертификатам │          │];
        [│      │                │                 │                │                  │     органами    │    субъектов    │                 │                │                  │     органами    │    субъектов    │              │              │          │];
        [│      │                │                 │                │      Всего       │  государственной│   Российской    │                 │                │      Всего       │ государственной │   Российской    │              │              │          │];
        [│      │                │                 │                │                  │      власти     │   Федерации и   │                 │                │                  │      власти     │   Федерации и   │              │              │          │];
        [│      │                │                 │                │                  │                 │органами местного│                 │                │                  │                 │органами местного│              │              │          │];
        [│      │                │                 │                │                  │                 │ самоуправления  │                 │                │                  │                 │ самоуправления  │              │              │          │];
        [│      │                │                 │                │                  │                 │                 │                 │                │                  │                 │                 │              │              │          │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼──────────────┼──────────────┼──────────┤];
        [│   1  │       2        │        3        │        4       │        5         │         6       │        7        │        8        │        9       │         10       │       11        │        12       │      13      │      14      │    15    │];
        [├──────┼────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼─────────────────┼────────────────┼──────────────────┼─────────────────┼─────────────────┼──────────────┼──────────────┼──────────┤];
    end;
end;

class (TPart1ReportView_4212) TPart1ReportView_4927()
    initTPart1ReportView_4212("1");

/**
    *  представление шапки раздела для Excel
    */
    macro getTableHeader()
        var field_number = TTableHeaderField("Номер | строки", 7, STR_ALIGN_CENTER);
        var data_number  = TTableDataField("field_number", field_number.width, getFormatSpecifier(field_number.format));
        var field_deposit = TTableHeaderField("по выпущенным | депозитным|сертификатам", 14, STR_ALIGN_CENTER);
        var data_deposit  = TTableDataField("field_deposit", field_deposit.width, getFormatSpecifier(field_deposit.format));
        var field_savings = TTableHeaderField("по выпущенным | сберегательным|сертификатам", 14, STR_ALIGN_CENTER);
        var data_savings  = TTableDataField("field_savings", field_savings.width, getFormatSpecifier(field_savings.format));
        var field_ammount = TTableHeaderField("Денежные | средства", 10, STR_ALIGN_CENTER);
        var data_ammount  = TTableDataField("field_ammount", field_ammount.width, getFormatSpecifier(field_ammount.format));
        var field_term = TTableHeaderField("по срокам | размещения", 16, STR_ALIGN_CENTER);
        var data_term  = TTableDataField("field_term", field_term.width, getFormatSpecifier(field_term.format));
        var field_notBank = TTableHeaderField("перед | нефинансовыми |и финансовыми |(кроме кредитных)|организациям", 17, STR_ALIGN_CENTER);
        var data_notBank  = TTableDataField("field_notBank", field_notBank.width, getFormatSpecifier(field_notBank.format));
        var field_individual = TTableHeaderField("перед | физическим |лицам", 16, STR_ALIGN_CENTER);
        var data_individual  = TTableDataField("field_individual", field_individual.width, getFormatSpecifier(field_individual.format));
        var field_total = TTableHeaderField("Всего", 18, STR_ALIGN_CENTER);
        var data_total  = TTableDataField("field_total", field_total.width, getFormatSpecifier(field_total.format));
        var field_federalBody = TTableHeaderField("федеральным | органам | государственной | власти", 18, STR_ALIGN_CENTER);
        var data_federalBody  = TTableDataField("field_federalBody", field_federalBody.width, getFormatSpecifier(field_federalBody.format));
        var field_RFBody = TTableHeaderField("органам власти | субъектов | Российской | Федерации и |органам местного|самоуправления", 18, STR_ALIGN_CENTER);
        var data_RFBody  = TTableDataField("field_RFBody", field_RFBody.width, getFormatSpecifier(field_RFBody.format));

        var headerRequirementsBank = TCompositeTableField();
            headerRequirementsBank.setTableField(TTableField("Требования кредитных организаций", null, STR_ALIGN_CENTER));
                headerRequirementsBank.addField(field_term, data_term);
                var headerRouble = TCompositeTableField();
                    headerRouble.setTableField(TTableField("в рублях", null, STR_ALIGN_CENTER));
                        headerRouble.addField(field_notBank, data_notBank);
                        headerRouble.addField(field_individual, data_individual);
                        var headerGovernmentBody = TCompositeTableField();
                            headerGovernmentBody.setTableField(TTableField("перед органами государственного управлений и|внебюджетными фондами", null, STR_ALIGN_CENTER));
                                        headerGovernmentBody.addField(field_total, data_total);
                                        var headerPrev = TCompositeTableField();
                                            headerPrev.setTableField(TTableField("из них перед", null, STR_ALIGN_CENTER));
                                                headerPrev.addField(field_federalBody, data_federalBody);
                                                headerPrev.addField(field_RFBody, data_RFBody);
                                        headerGovernmentBody.addField(headerPrev);
                                headerRouble.addField(headerGovernmentBody);
                        var headerInCurrency = TCompositeTableField();
                            headerInCurrency.setTableField(TTableField("в иностранной валюте", null, STR_ALIGN_CENTER));
                                headerInCurrency.addField(field_notBank, data_notBank);
                                headerInCurrency.addField(field_individual, data_individual);
                                headerInCurrency.addField(headerGovernmentBody);
                headerRequirementsBank.addField(headerRouble);
                headerRequirementsBank.addField(headerInCurrency);
                headerRequirementsBank.addField(field_deposit, data_deposit);
                headerRequirementsBank.addField(field_savings, data_savings);
                headerRequirementsBank.addField(field_ammount, data_ammount);

        var template = TCompositeTableField();
            template.addField(field_number, data_number);
            template.addField(headerRequirementsBank);

        var header = "";
        for (var i, template.getReportHeader(true))
            header = header + "\n" + i;
        end;

        header = substr(header, 2);

        return header;
    end;
end;

class (TPartReportView) TPart2ReportView_2470U()
    initTPartReportView("2");

    private macro initialize()
        m_table.addColumn("14", 4,  AL_CENTER);
        m_table.addColumn("15", 14, AL_LEFT);
        m_table.addColumn("16", 13, AL_RIGHT);
        m_table.addColumn("17", 14, AL_RIGHT);
        m_table.addColumn("18", 13, AL_RIGHT);
        m_table.addColumn("19", 15, AL_RIGHT);
        m_table.addColumn("20", 14, AL_RIGHT);
        m_table.addColumn("21", 13, AL_RIGHT);
        m_table.addColumn("22", 14, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 15, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 13, AL_RIGHT);
        m_table.addColumn("27", 13, AL_RIGHT);
        m_table.addColumn("28", 16, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬───────────────┬──────────────────┐];
        [│      │                                                                           Требования кредитных организаций                                                                            │  Иностранные  │  Иностранные  │    Собственные   │];
        [│      ├────────────────┬───────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────┤     активы    │    пассивы    │средства кредитной│];
        [│      │                │                                     в рублях                                      │                               в иностранной валюте                               │               │               │    организации   │];
        [│      │                ├────────────────────────────────────────────────┬─────────────────┬────────────────┼────────────────────────────────────────────────┬─────────────────┬───────────────┤               │               │    за вычетом    │];
        [│      │                │     к органам государственного управления      │                 │                │      к органам государственного управления     │                 │               │               │               │ вложений в акции │];
        [│Номер │                │             и внебюджетным фондам              │       к         │       к        │              и внебюджетным фондам             │ к нефинансовым  │      к        │               │               │ других кредитных │];
        [│строки│   по срокам    ├───────────────┬────────────────┬───────────────┤  нефинансовым   │   физическим   ├───────────────┬────────────────┬───────────────┤        и        │  физическим   │               │               │   организаций    │];
        [│      │  кредитования  │  федеральным  │ органам власти │ внебюджетным  │  и финансовым   │     лицам      │ федеральным   │  органам власти│  внебюджетным │   финансовым    │    лицам      │               │               │                  │];
        [│      │                │    органам    │   субъектов    │    фондам     │(кроме кредитных)│                │   органам     │    субъектов   │    фондам     │(кроме кредитных)│               │               │               │                  │];
        [│      │                │государственной│   Российской   │               │  организациям   │                │государственной│   Российской   │               │  организациям   │               │               │               │                  │];
        [│      │                │     власти    │  Федерации и   │               │                 │                │    власти     │  Федерации и   │               │                 │               │               │               │                  │];
        [│      │                │               │органам местного│               │                 │                │               │органам местного│               │                 │               │               │               │                  │];
        [│      │                │               │ самоуправления │               │                 │                │               │ самоуправления │               │                 │               │               │               │                  │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
        [│  14  │       15       │      16       │       17       │      18       │       19        │       20       │      21       │       22       │      23       │      24         │      25       │      26       │      27       │        28        │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
    end;
end;

class (TPartReportView) TPart2ReportView_4212()
    initTPartReportView("2");

    private macro initialize()
        m_table.addColumn("16", 4,  AL_CENTER);
        m_table.addColumn("17", 14, AL_LEFT);
        m_table.addColumn("18", 13, AL_RIGHT);
        m_table.addColumn("19", 14, AL_RIGHT);
        m_table.addColumn("20", 13, AL_RIGHT);
        m_table.addColumn("21", 15, AL_RIGHT);
        m_table.addColumn("22", 14, AL_RIGHT);
        m_table.addColumn("23", 13, AL_RIGHT);
        m_table.addColumn("24", 14, AL_RIGHT);
        m_table.addColumn("25", 13, AL_RIGHT);
        m_table.addColumn("26", 15, AL_RIGHT);
        m_table.addColumn("27", 13, AL_RIGHT);
        m_table.addColumn("28", 13, AL_RIGHT);
        m_table.addColumn("29", 13, AL_RIGHT);
        m_table.addColumn("30", 16, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────┬───────────────┬──────────────────┐];
        [│      │                                                                           Требования кредитных организаций                                                                            │  Иностранные  │  Иностранные  │    Собственные   │];
        [│      ├────────────────┬───────────────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────┤     активы    │    пассивы    │средства кредитной│];
        [│      │                │                                     в рублях                                      │                               в иностранной валюте                               │               │               │    организации   │];
        [│      │                ├────────────────────────────────────────────────┬─────────────────┬────────────────┼────────────────────────────────────────────────┬─────────────────┬───────────────┤               │               │    за вычетом    │];
        [│      │                │     к органам государственного управления      │                 │                │      к органам государственного управления     │                 │               │               │               │ вложений в акции │];
        [│Номер │   по срокам    │             и внебюджетным фондам              │        к        │       к        │              и внебюджетным фондам             │ к нефинансовым  │      к        │               │               │ других кредитных │];
        [│строки│  кредитования  ├───────────────┬────────────────┬───────────────┤  нефинансовым   │   физическим   ├───────────────┬────────────────┬───────────────┤        и        │  физическим   │               │               │   организаций    │];
        [│      │                │  федеральным  │ органам власти │ внебюджетным  │  и финансовым   │     лицам      │ федеральным   │  органам власти│  внебюджетным │   финансовым    │    лицам      │               │               │                  │];
        [│      │                │    органам    │   субъектов    │    фондам     │(кроме кредитных)│                │   органам     │    субъектов   │    фондам     │(кроме кредитных)│               │               │               │                  │];
        [│      │                │государственной│   Российской   │               │  организациям   │                │государственной│   Российской   │               │  организациям   │               │               │               │                  │];
        [│      │                │     власти    │  Федерации и   │               │                 │                │    власти     │  Федерации и   │               │                 │               │               │               │                  │];
        [│      │                │               │органам местного│               │                 │                │               │органам местного│               │                 │               │               │               │                  │];
        [│      │                │               │ самоуправления │               │                 │                │               │ самоуправления │               │                 │               │               │               │                  │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
        [│  16  │       17       │      18       │       19       │      20       │       21        │       22       │      23       │       24       │      25       │       26        │      27       │      28       │      29       │        30        │];
        [├──────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼────────────────┼───────────────┼────────────────┼───────────────┼─────────────────┼───────────────┼───────────────┼───────────────┼──────────────────┤];
    end;
end;

class (TPart2ReportView_4212) TPart2ReportView_4927()
    initTPart2ReportView_4212("2");

   /**
    *  представление шапки раздела для Excel
    */
    macro getTableHeader()
        var field_number = TTableHeaderField("Номер | строки", 7, STR_ALIGN_RIGHT);
        var data_number  = TTableDataField("field_number", field_number.width, getFormatSpecifier(field_number.format));
        var field_active = TTableHeaderField("Иностранные| активы", 17, STR_ALIGN_RIGHT);
        var data_active  = TTableDataField("field_active", field_active.width, getFormatSpecifier(field_active.format));
        var field_passive = TTableHeaderField("Иностранные| пассивы", 17, STR_ALIGN_RIGHT);
        var data_passive  = TTableDataField("field_passive", field_passive.width, getFormatSpecifier(field_passive.format));
        var field_ammount = TTableHeaderField("Собственные | средства кредитной|организации|за вычетом|вложений в акции|других кредитных|организаций", 20, STR_ALIGN_RIGHT);
        var data_ammount  = TTableDataField("field_ammount", field_ammount.width, getFormatSpecifier(field_ammount.format));
        var field_term = TTableHeaderField("по срокам | кредитования", 18, STR_ALIGN_RIGHT);
        var data_term  = TTableDataField("field_term", field_term.width, getFormatSpecifier(field_term.format));
        var field_federalBody = TTableHeaderField("федеральным | органам | государственной | власти", 17, STR_ALIGN_RIGHT);
        var data_federalBody  = TTableDataField("field_federalBody", field_federalBody.width, getFormatSpecifier(field_federalBody.format));
        var field_RFBody = TTableHeaderField("органам власти | субъектов | Российской | Федерации и |органам местного|самоуправления", 17, STR_ALIGN_RIGHT);
        var data_RFBody  = TTableDataField("field_RFBody", field_RFBody.width, getFormatSpecifier(field_RFBody.format));
        var field_extrabudgetary = TTableHeaderField("внебюджетным | фондам", 17, STR_ALIGN_RIGHT);
        var data_extrabudgetary  = TTableDataField("field_extrabudgetary", field_extrabudgetary.width, getFormatSpecifier(field_extrabudgetary.format));
        var field_notBank = TTableHeaderField("к | нефинансовым |и финансовым |(кроме кредитных)|организациям", 19, STR_ALIGN_RIGHT);
        var data_notBank  = TTableDataField("field_notBank", field_notBank.width, getFormatSpecifier(field_notBank.format));
        var field_individual = TTableHeaderField("к | физическим |лицам", 19, STR_ALIGN_RIGHT);
        var data_individual  = TTableDataField("field_individual", field_individual.width, getFormatSpecifier(field_individual.format));

        var headerRequirementsBank = TCompositeTableField();
            headerRequirementsBank.setTableField(TTableField("Требования кредитных организаций", null, STR_ALIGN_CENTER));
                headerRequirementsBank.addField(field_term, data_term);      
                var headerRouble = TCompositeTableField();
                    headerRouble.setTableField(TTableField("в рублях", null, STR_ALIGN_CENTER));
                        var headerGovernmentBody = TCompositeTableField();
                            headerGovernmentBody.setTableField(TTableField("к органам государственного управления |и внебюджетным фондам ", null, STR_ALIGN_CENTER));
                                headerGovernmentBody.addField(field_federalBody, data_federalBody);
                                headerGovernmentBody.addField(field_RFBody, data_RFBody);
                                headerGovernmentBody.addField(field_extrabudgetary, data_extrabudgetary);
                        headerRouble.addField(headerGovernmentBody);
                        headerRouble.addField(field_notBank, data_notBank);
                        headerRouble.addField(field_individual, data_individual);
                var headerInCurrency = TCompositeTableField();
                    headerInCurrency.setTableField(TTableField("в иностранной валюте", null, STR_ALIGN_CENTER));
                        headerInCurrency.addField(headerGovernmentBody);
                        headerInCurrency.addField(field_notBank, data_notBank);
                        headerInCurrency.addField(field_individual, data_individual);
                headerRequirementsBank.addField(headerRouble);
                headerRequirementsBank.addField(headerInCurrency);

        var template = TCompositeTableField();
            template.addField(field_number, data_number);
            template.addField(headerRequirementsBank);
            template.addField(field_active,  data_active);
            template.addField(field_passive, data_passive);
            template.addField(field_ammount, data_ammount);

        var header = "";
        for (var i, template.getReportHeader(true))
            header = header + "\n" + i;
        end;

        header = substr(header, 2);

        return header;
    end;
end;

class (TPartReportView) TPart3ReportView_2470U()
    initTPartReportView("3");

    private macro initialize()
        m_table.addColumn("29", 4,  AL_CENTER);
        m_table.addColumn("30", 14, AL_LEFT);
        m_table.addColumn("31", 17, AL_RIGHT);
        m_table.addColumn("32", 15, AL_RIGHT);
        m_table.addColumn("33", 17, AL_RIGHT);
        m_table.addColumn("34", 15, AL_RIGHT);
        m_table.addColumn("35", 23, AL_RIGHT);
        m_table.addColumn("36", 26, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│Номер │                                                     Межбанковские операции кредитных организаций                                                  │];
        [│строки│                                                                                                                                                   │];
        [│      ├────────────────┬───────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│      │                │                                 в рублях                                  │                    в иностранной валюте              │];
        [│      │   по срокам    ├─────────────────────────────────────┬─────────────────────────────────────┤                                                      │];
        [│      │  привлечения   │         обязательства перед         │            требования к             │                                                      │];
        [│      │ (кредитования) ├───────────────────┬─────────────────┼───────────────────┬─────────────────┼─────────────────────────┬────────────────────────────┤];
        [│      │                │    кредитными     │                 │     кредитным     │                 │  обязательства перед    │    требования к кредитным  │];
        [│      │                │  организациями-   │  Банком России  │   организациям-   │   Банку России  │кредитными организациями-│   организациям-резидентам  │];
        [│      │                │    резидентами    │                 │    резидентам     │                 │       резидентами       │                            │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
        [│  29  │       30       │        31         │        32       │        33         │        34       │           35            │            36              │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
    end;

    macro printBottom()
        m_table.printBottom();
    end;
end;

class (TPartReportView) TPart3ReportView_4212()
    initTPartReportView("3");

    private macro initialize()
        m_table.addColumn("31", 4,  AL_CENTER);
        m_table.addColumn("32", 14, AL_LEFT);
        m_table.addColumn("33", 17, AL_RIGHT);
        m_table.addColumn("34", 15, AL_RIGHT);
        m_table.addColumn("35", 17, AL_RIGHT);
        m_table.addColumn("36", 15, AL_RIGHT);
        m_table.addColumn("37", 23, AL_RIGHT);
        m_table.addColumn("38", 26, AL_RIGHT);
    end;

    macro printHead()
        [┌──────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐];
        [│      │                                                     Межбанковские операции кредитных организаций                                                  │];
        [│      ├────────────────┬───────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────┤];
        [│      │                │                                 в рублях                                  │                 в иностранной валюте                 │];
        [│Номер │   по срокам    ├─────────────────────────────────────┬─────────────────────────────────────┤                                                      │];
        [│строки│  привлечения   │         обязательства перед         │            требования к             │                                                      │];
        [│      │ (кредитования) ├───────────────────┬─────────────────┼───────────────────┬─────────────────┼─────────────────────────┬────────────────────────────┤];
        [│      │                │    кредитными     │                 │     кредитным     │                 │  обязательства перед    │   требования к кредитным   │];
        [│      │                │  организациями-   │  Банком России  │   организациям-   │  Банку России   │кредитными организациями-│  организациям-резидентам   │];
        [│      │                │    резидентами    │                 │     резидентам    │                 │       резидентами       │                            │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
        [│  31  │       32       │        33         │        34       │        35         │        36       │           37            │            38              │];
        [├──────┼────────────────┼───────────────────┼─────────────────┼───────────────────┼─────────────────┼─────────────────────────┼────────────────────────────┤];
    end;

    macro printBottom()
        m_table.printBottom();
    end;
end;

class (TPart3ReportView_4212) TPart3ReportView_4927()
    initTPart3ReportView_4212("3");

   /**
    *  представление шапки раздела для Excel
    */
    macro getTableHeader()
        var field_numberDeal = TTableHeaderField("Номер | строки", 7, STR_ALIGN_RIGHT);
        var data_numberDeal  = TTableDataField("field_numberDeal", field_numberDeal.width, getFormatSpecifier(field_numberDeal.format));
        var field_typeDeal = TTableHeaderField("по срокам | привлечения | (кредитования)", 17, STR_ALIGN_RIGHT);
        var data_typeDeal  = TTableDataField("field_typeDeal", field_typeDeal.width, getFormatSpecifier(field_typeDeal.format));
        var field_credit = TTableHeaderField("кредитными | организациями | резидентами", 20, STR_ALIGN_RIGHT);
        var data_credit  = TTableDataField("field_credit", field_credit.width, getFormatSpecifier(field_credit.format));
        var field_bank = TTableHeaderField("Банком | России ", 20, STR_ALIGN_RIGHT);
        var data_bank  = TTableDataField("field_bank", field_bank.width, getFormatSpecifier(field_bank.format));
        var field_ObligationsBank = TTableHeaderField("обязательства перед  | кредитными организациями | резидентами", 25, STR_ALIGN_RIGHT);
        var data_ObligationsBank  = TTableDataField("field_ObligationsBank", field_ObligationsBank.width, getFormatSpecifier(field_ObligationsBank.format));
        var field_RequirementsBank = TTableHeaderField("требования к кредитным | организациям резидентам", 25, STR_ALIGN_RIGHT);
        var data_RequirementsBank  = TTableDataField("field_RequirementsBank", field_RequirementsBank.width, getFormatSpecifier(field_RequirementsBank.format));

        var headerInterOper = TCompositeTableField();
            headerInterOper.setTableField(TTableField("Межбанковские операции кредитных организаций", null, STR_ALIGN_CENTER));
                headerInterOper.addField(field_typeDeal, data_typeDeal);
                var headerRouble = TCompositeTableField();
                    headerRouble.setTableField(TTableField("в рублях", null, STR_ALIGN_CENTER));
                        var headerObligations = TCompositeTableField();
                            headerObligations.setTableField(TTableField("обязательства перед", null, STR_ALIGN_CENTER));
                                headerObligations.addField(field_credit, data_credit);
                                headerObligations.addField(field_bank, data_bank);
                        var headerRequirements = TCompositeTableField();
                            headerRequirements.setTableField(TTableField("требования к", null, STR_ALIGN_CENTER));
                                headerRequirements.addField(field_credit, data_credit);
                                headerRequirements.addField(field_bank, data_bank);
                        headerRouble.addField(headerObligations);
                        headerRouble.addField(headerRequirements);
                var headerInCurrency = TCompositeTableField();
                    headerInCurrency.setTableField(TTableField(" в иностранной валюте", null, STR_ALIGN_CENTER));
                        headerInCurrency.addField(field_ObligationsBank,  data_ObligationsBank);
                        headerInCurrency.addField(field_RequirementsBank,  data_RequirementsBank);
           headerInterOper.addField(headerRouble);
           headerInterOper.addField(headerInCurrency);

        var template = TCompositeTableField();
        template.addField(field_numberDeal, data_numberDeal);
        template.addField(headerInterOper);

        var header = "";
        for (var i, template.getReportHeader(true))
            header = header + "\n" + i;
        end;

        header = substr(header, 2);

        return header;
    end;
end;

/**
 * Представление печати отчета по 2470-У
 */
class (RcbReportView) TReportView_2470U()
    initRcbReportView("ОТДЕЛЬНЫЕ ПОКАЗАТЕЛИ, ХАРАКТЕРИЗУЮЩИЕ ДЕЯТЕЛЬНОСТЬ КРЕДИТНОЙ ОРГАНИЗАЦИИ", "0409301", RCB_PK_FIVE_DAYS, DATE_OUT_PERIOD_FORMAT);

    private macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);

        m_partViewPool.push_back(TPart1ReportView_2470U());
        m_partViewPool.push_back(TPart2ReportView_2470U());
        m_partViewPool.push_back(TPart3ReportView_2470U());
    end;

    macro getPart1ReportView()
        return getPartView("1");
    end;

    macro getPart2ReportView()
        return getPartView("2");
    end;

    macro getPart3ReportView()
        return getPartView("3");
    end;
end;

/**
 * Представление печати отчета по 4212-У
 */
class (TReportView_2470U) TReportView_4212()
    initTReportView_2470U();

    private macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);

        m_partViewPool.push_back(TPart1ReportView_4212());
        m_partViewPool.push_back(TPart2ReportView_4212());
        m_partViewPool.push_back(TPart3ReportView_4212());
    end;
end;

/**
 * Представление печати отчета по 4637-У
 */
class (TReportView_4212) TReportView_4637()
    initTReportView_4212();

    private macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);
        excludeAttribute(AC_SECOND_PERSON);

        m_partViewPool.push_back(TPart1ReportView_4212());
        m_partViewPool.push_back(TPart2ReportView_4212());
        m_partViewPool.push_back(TPart3ReportView_4212());
    end;
end;

/**
 * Представление печати отчета по 4637-У
 */
class (TReportView_4637) TReportView_4927
    initTReportView_4637();

    private macro initialize()
        changePrintZone(MC_LEADING_AGENCY_NAME_WHITHOUT_BRANCH);
        excludeAttribute(AC_SECOND_PERSON);

        m_partViewPool.push_back(TPart1ReportView_4927());
        m_partViewPool.push_back(TPart2ReportView_4927());
        m_partViewPool.push_back(TPart3ReportView_4927());
    end;
end;
