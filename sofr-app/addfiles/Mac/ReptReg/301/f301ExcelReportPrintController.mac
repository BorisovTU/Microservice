/*
$Name:          f301ExcelReportPrintController.mac
$Module:        РегламентируемаЯ отчетность
$Description:   Форма 301. Классы контроллера печати в Excel
*/

/**
 * Форма 301. Класс контроллера печати в Excel
 *
 * @since   v.6.00.020.31.58
 * @author  MFB
 * @version 1.0
 */
class TF301ExcelReportPrintController(reportView)
	private var m_view        : Object;
	private var m_currentPart : Integer;
	private var m_reportView  : Object;
	
	macro printHeader()
		m_view.getPartView(m_currentPart).printHead();
    end;
	
	macro printHeaderTable(headerTable : String, number)
		m_currentPart = m_view.getPartViewNumber(number)
    end;

	macro printString(dataPool : RcbArray)
		m_view.getPartView(m_currentPart).printRow(dataPool);
    end;
	
	macro print()
		m_view.getPartView(m_currentPart).print();
    end;
	
	macro printSignatureZone()
		m_view.getPartView(m_currentPart).printSignature();
    end;
	
	macro printNullDataZone()
		m_view.printNullDataZone();
    end;
		
	macro show(filename)
		m_view.save(strsubst(filename,".txt",""));
    end;
	
	private macro constructorTF301ExcelReportPrintController(reportView)
		m_view        = reportView;
		m_currentPart = 0;
	end;
	constructorTF301ExcelReportPrintController(reportView);
end;

/**
 * Форма 301. Класс контроллера печати в Excel
 *
 * @since   v.6.00.020.31.58
 * @author  MFB
 * @version 1.0
 */
class TF301ExcelAddReportPrintController(reportView)
	private var m_view        : Object;
	private var m_currentPart : Integer;
	private var m_reportView  : Object;
	
	macro printHeader()
		m_view.getPartView().printHead();
    end;
	
	macro printString(dataPool : RcbArray, type)
		m_view.getPartView().printRow(dataPool, type);
    end;
	
	macro printExcel()
		m_view.getPartView().print();
    end;
	
	macro printSignatureZone()
		m_view.getPartView().printSignature();
    end;
	
	macro printNullDataZone()
		m_view.printNullDataZone();
    end;
		
	macro show(filename)
		m_view.save(strsubst(filename,".txt",""));
    end;
	
	private macro constructorTF301ExcelAddReportPrintController(reportView)
		m_view        = reportView;
	end;
	constructorTF301ExcelAddReportPrintController(reportView);
end;