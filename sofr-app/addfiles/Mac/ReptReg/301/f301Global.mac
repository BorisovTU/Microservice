private var v_global = null;
/*
$Name:          f301Global.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 301. Класс глобализмов.
*/

class (TGlobalBase) TGlobal2055U()
    initTGlobalBase();

    private var m_rcbReport = rcbApplication.currentReport;
    private var m_calculateMbk : bool;

    macro getRcbReport() : RcbReport
        return m_rcbReport;
    end;

    private macro setCalculateMbk() 
        getRegistryValue("REPTREG/REP_GROUPS/ФОРМА 301/ДАННЫЕ МБК", V_BOOL, m_calculateMbk, NULL);
    end;

    macro isCalculatedMbk()
        return m_calculateMbk;
    end;

    macro initialzeTGlobal2055U()
        sql_execute("CALL rep_opt.clearOurBankTable()");
        sql_execute("CALL rep_opt.makeOurBankSlice()");
        setCalculateMbk();
    end;

    initializeRepDataPackage(m_rcbReport);
    initialzeTGlobal2055U();
end;

macro global()
    if (v_global == null)
        v_global = TGlobal2055U();
    end;
    return v_global;
end;