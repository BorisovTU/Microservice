/*
$Name:          f123CalculateProtocolView.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Протокол
*/

/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbDataProtocolView) TF123CbDocumentProtocolData()
    initRcbDataProtocolView("Documents", false);

    macro printBottom()
        m_table.printBottom();
    end;

    macro printSeparator()
        m_table.printSeparator();
    end;

    macro printHead(attribute : String)
        m_table.printHead();
    end;

    macro printNullData()
        println("Нет данных для отчета.");
    end;

    macro printString(dataSet : Object)
        m_table.printStringTransferByWord(dataSet.date,
                                          dataSet.number,
                                          dataSet.debetaccount,
                                          dataSet.creditaccount,
                                          dataSet.sum);
    end;

    macro printFreeString(str : String)
        println(str);
    end;

    macro printItog(dataSet : Object)
        const VALUE_COLUMN_NUMBER = 3;
        m_table.printStringExt("Итого:", 
                                VALUE_COLUMN_NUMBER - 1, 
                                dataSet.sum);
    end;

    private macro initialize()
        m_table.addColumn("Дата Проводки",     15);
        m_table.addColumn("Номер проводки",    17);
        m_table.addColumn("Счет дебета",       25);
        m_table.addColumn("Счет кредита",      25);
        m_table.addColumn("Сумма|в|рублях",    17);
    end;
end;

class (RcbDataProtocolView) TF123CbAccountProtocolData()
    initRcbDataProtocolView("Accounts", false);

    macro printBottom()
        m_table.printBottom();
    end;

    macro printSeparator()
        m_table.printSeparator();
    end;

    macro printHead(attribute : String)
        m_table.printHead();
    end;

    macro printNullData()
        println("Нет данных для отчета.");
    end;

    macro printString(dataSet : Object)
        m_table.printStringTransferByWord(dataSet.account,
                                          dataSet.sum,
                                          dataSet.comment);
    end;

    macro printFreeString(str : String)
        println(str);
    end;

    macro printItog(dataSet : Object)
        const VALUE_COLUMN_NUMBER = 2;
        m_table.printStringExt("Итого:", 
                                VALUE_COLUMN_NUMBER - 1, 
                                dataSet.sum);
    end;

    private macro initialize()
        m_table.addColumn("Лицевой счет",    25);
        m_table.addColumn("Сумма|в|рублях", 17);
        m_table.addColumn("Комментарий", 55);
    end;
end;

class (RcbDataProtocolView) TF123CbAccountNoteProtocolData()
    initRcbDataProtocolView("AccountNote", false);

    macro printBottom()
        m_table.printBottom();
    end;

    macro printSeparator()
        m_table.printSeparator();
    end;

    macro printHead(attribute : String)
        m_table.printHead();
    end;

    macro printNullData()
        println("Нет данных для отчета.");
    end;

    macro printString(dataSet : Object)
        m_table.printStringTransferByWord(dataSet.account,
                                          dataSet.sum,
                                          dataSet.comment);
    end;

    macro printFreeString(str : String)
        println(str);
    end;

    macro printItog(dataSet : Object)
        const VALUE_COLUMN_NUMBER = 2;
        m_table.printStringExt("Итого:", 
                                VALUE_COLUMN_NUMBER - 1, 
                                dataSet.sum);
    end;

    private macro initialize()
        m_table.addColumn("Лицевой счет",    25);
        m_table.addColumn("Сумма|в|рублях", 17);
        m_table.addColumn("Комментарий", 55);
    end;
end;

class (RcbCalculateProtocolView) TF123CalculateProtocolView(protocolName : String)
    initRcbCalculateProtocolView(null, protocolName);

    macro printLineInfo(attributeId : String)
        println();
        println("Данные ГК. Переменная Строка_" + attributeId + ":");
    end;

    macro printLineValueInfo(attributeId : String, value : double)
        println();
        println("Строка_" + attributeId + " = " + value);
    end;

    macro printSummValueInfo(summId : String, value : double)
        println();
        println(summId + " = " + value);
    end;

    macro printParamValue(paramId : String, value)
        println();
        println(paramId + " = " + value);
    end;

    macro printAlg(attributeId : String, algorithm : String);
        println("Строка_" + attributeId + " = " + algorithm);
    end;

    macro printString(str : String)
        println(str);
    end;

    macro printThatNewCapital(newDate : Date, newValue : Money)
        println();
        println();
        println("В справочник капитала введена новая запись:");
        println("На дату = " + newDate);
        println("Сумма (тыс. руб.) = " + newValue);
    end;

    macro printThatUpdateCapital(newDate : Date, oldValue : Money, newValue : Money)
        println();
        println();
        println("В справочнике капитала значение капитала " + newDate + " заменено c " + oldValue + " на " + newValue);
        println("Примечание. При этом значение переменной Строка_000 выводится в тысячах рублей");
    end;

    private macro initialize()
        m_dataProtocolViewPull.push_back(TF123CbDocumentProtocolData());
        m_dataProtocolViewPull.push_back(TF123CbAccountProtocolData());
        m_dataProtocolViewPull.push_back(TF123CbAccountNoteProtocolData());
    end;
end;