/*
$Name:          f123PtkPsdExportController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Контроллер экспорта в АС ПСД
*/

/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbPtkPsdExportController) TF123PtkPsdExportController()
    initRcbPtkPsdExportController("123", objectFactoryInstance.createReport(RcbApplication.currentReport), "Форма 123");

    m_view = TPtkPsdView("123", m_report.getPeriod().endDate+1, "rsansi");

    private macro printString(rowNumber : String)
        m_view.printRow("F123B", rowNumber, "3", m_report.getPart("").getAttribute(rowNumber).getValueAsString());
    end;

    private macro getDescriptorInfo()
        return "ALB2_2_4.doc от 01.10.2014";
    end;

    private macro printData()
        printString("000");
        printString("100.1");
        printString("100.1.1");
        printString("100.1.2");
        printString("100.1.3");
        printString("100.2");
        printString("100.2.1");
        printString("100.2.1.1");
        printString("100.2.1.2");
        printString("100.2.2");
        printString("100.3");
        printString("100.4");
        printString("100.5");
        printString("100.5.1а");
        printString("100.5.1б");
        printString("100.5.1в");
        printString("100.5.1г");
        printString("100.5.1.1.1");
        printString("100.5.1.1.2");
        printString("100.5.1.2.1");
        printString("100.5.1.2.2");
        printString("100.5.2");
        printString("100.5.2.1");
        printString("100.5.2.2");
        printString("100.5.2.3");
        printString("100.5.2.4");
        printString("100.5.3");
        printString("100.6");
        printString("100.6.1а");
        printString("100.6.1б");
        printString("100.6.1в");
        printString("100.6.1г");
        printString("100.6.1.1.1");
        printString("100.6.1.1.2");
        printString("100.6.1.2.1");
        printString("100.6.1.2.2");
        printString("100.6.2");
        printString("100.6.2.1");
        printString("100.6.2.2");
        printString("100.6.2.3");
        printString("100.6.2.4");
        printString("100.6.3");
        printString("100.7");
        printString("101.1");
        printString("101.2");
        printString("101.3");
        printString("101.4");
        printString("101.4.1");
        printString("101.4.2");
        printString("101.4.3");
        printString("101.5");
        printString("101.5.1");
        printString("101.5.2");
        printString("101.5.3");
        printString("101.6");
        printString("101.7");
        printString("101.8");
        printString("101.8.1а");
        printString("101.8.1б");
        printString("101.8.1в");
        printString("101.8.1г");
        printString("101.8.1.1.1");
        printString("101.8.1.1.2");
        printString("101.8.1.2.1");
        printString("101.8.1.2.2");
        printString("101.8.2");
        printString("101.8.2.1");
        printString("101.8.2.2");
        printString("101.8.2.3");
        printString("101.8.2.4");
        printString("101.8.3");
        printString("101.9");
        printString("101.9.1а");
        printString("101.9.1б");
        printString("101.9.1в");
        printString("101.9.1г");
        printString("101.9.1.1.1");
        printString("101.9.1.1.2");
        printString("101.9.1.2.1");
        printString("101.9.1.2.2");
        printString("101.9.2");
        printString("101.9.2.1");
        printString("101.9.2.2");
        printString("101.9.2.3");
        printString("101.9.2.4");
        printString("101.9.3");
        printString("101.10");
        printString("101.10.1");
        printString("101.10.2");
        printString("101.10.3");
        printString("101.11");
        printString("101.12");
        printString("101.13");
        printString("101.14");
        printString("102");
        printString("103.1");
        printString("103.1.1");
        printString("103.2");
        printString("103.3");
        printString("103.4");
        printString("103.4.1");
        printString("103.4.2");
        printString("103.5");
        printString("104.1");
        printString("104.1.1");
        printString("104.1.2");
        printString("104.1.3");
        printString("104.2");
        printString("104.2.1");
        printString("104.2.2");
        printString("104.3");
        printString("104.3.1");
        printString("104.3.1.1");
        printString("104.3.2");
        printString("104.3.2.1");
        printString("104.4");
        printString("104.5");
        printString("104.6");
        printString("104.7");
        printString("104.7.1");
        printString("104.7.2");
        printString("104.7.3");
        printString("104.7.4");
        printString("104.7.5");
        printString("104.8");
        printString("105");
        printString("106");
        printString("200.1");
        printString("200.1.1");
        printString("200.1.2");
        printString("200.2");
        printString("200.3");
        printString("200.4");
        printString("200.5");
        printString("200.5.1а");
        printString("200.5.1б");
        printString("200.5.1в");
        printString("200.5.1г");
        printString("200.5.1.1.1");
        printString("200.5.1.1.2");
        printString("200.5.1.2.1");
        printString("200.5.1.2.2");
        printString("200.5.2");
        printString("200.5.2.1");
        printString("200.5.2.2");
        printString("200.5.2.3");
        printString("200.5.2.4");
        printString("200.5.3");
        printString("200.6");
        printString("200.6.1а");
        printString("200.6.1б");
        printString("200.6.1в");
        printString("200.6.1г");
        printString("200.6.1.1.1");
        printString("200.6.1.1.2");
        printString("200.6.1.2.1");
        printString("200.6.1.2.2");
        printString("200.6.2");
        printString("200.6.2.1");
        printString("200.6.2.2");
        printString("200.6.2.3");
        printString("200.6.2.4");
        printString("200.6.3");
        printString("200.7");
        printString("200.7.1");
        printString("200.7.2");
        printString("200.8");
        printString("200.9");
        printString("201.1");
        printString("201.1.1");
        printString("201.1.2");
        printString("201.1.3");
        printString("201.2");
        printString("201.2.1");
        printString("201.2.2");
        printString("201.3");
        printString("201.3.1");
        printString("201.3.1.1");
        printString("201.3.2");
        printString("201.3.2.1");
        printString("201.4");
        printString("201.5");
        printString("201.6");
        printString("201.7");
        printString("201.7.1");
        printString("201.7.2");
        printString("201.7.3");
        printString("201.7.4");
        printString("201.7.5");
        printString("201.7.6");
        printString("201.8");
        printString("202.1");
        printString("202.2");
        printString("202.3");
        printString("202.3.1");
        printString("202.3.2");
        printString("202.3.3");
        printString("202.4");
        printString("202.5");
        printString("203");
    end;

    private macro printDataZone()
        m_view.setOutputFile();
        printData();
        m_view.resetOutputFile();
    end;

    macro execute()
        m_view.setoutputFile();

        printDataZone();

        m_view.resetoutputFile();

        var protocolView = TProtocolView("ПРОТОКОЛ ЭКСПОРТА В АС ПСД", m_reportName);

        protocolView.setProtocolOutput();
        protocolView.printHead();

        protocolView.printLine("Альбом форм АС ПСД: " + getDescriptorInfo());
        protocolView.printLine("Файл экспорта: " + m_view.getFileName());
        protocolView.printLine(" ");

        protocolView.printLine("Выгружено строк: " + String( m_view.getRowsCount()) + ".");

        protocolView.resetProtocolOutput();

        protocolView.show();
    end;
end;
class (TF123PtkPsdExportController) TF123PtkPsdExportController_3714()
    initTF123PtkPsdExportController();

    private macro printData()
        printString("000");
        printString("100.1");
        printString("100.1.1");
        printString("100.1.2");
        printString("100.1.3");
        printString("100.2");
        printString("100.2.1");
        printString("100.2.1.1");
        printString("100.2.1.2");
        printString("100.2.2");
        printString("100.3");
        printString("100.4");
        printString("100.5");
        printString("100.5.1");
        printString("100.5.1.1");
        printString("100.5.1.2");
        printString("100.5.2");
        printString("100.5.2.1");
        printString("100.5.2.2");
        printString("100.5.2.3");
        printString("100.5.2.4");
        printString("100.5.3");
        printString("100.6");
        printString("100.6.1");
        printString("100.6.1.1");
        printString("100.6.1.2");
        printString("100.6.2");
        printString("100.6.2.1");
        printString("100.6.2.2");
        printString("100.6.2.3");
        printString("100.6.2.4");
        printString("100.6.3");
        printString("100.7");
        printString("101.1");
        printString("101.2");
        printString("101.3");
        printString("101.4");
        printString("101.4.1");
        printString("101.4.2");
        printString("101.4.3");
        printString("101.5");
        printString("101.5.1");
        printString("101.5.2");
        printString("101.5.3");
        printString("101.6");
        printString("101.7");
        printString("101.8");
        printString("101.8.1");
        printString("101.8.1.1");
        printString("101.8.1.2");
        printString("101.8.2");
        printString("101.8.2.1");
        printString("101.8.2.2");
        printString("101.8.2.3");
        printString("101.8.2.4");
        printString("101.8.3");
        printString("101.9");
        printString("101.9.1");
        printString("101.9.1.1");
        printString("101.9.1.2");
        printString("101.9.2");
        printString("101.9.2.1");
        printString("101.9.2.2");
        printString("101.9.2.3");
        printString("101.9.2.4");
        printString("101.9.3");
        printString("101.10");
        printString("101.10.1");
        printString("101.10.2");
        printString("101.10.3");
        printString("101.11");
        printString("101.12");
        printString("101.13");
        printString("101.14");
        printString("102");
        printString("103.1");
        printString("103.1.1");
        printString("103.2");
        printString("103.3");
        printString("103.4");
        printString("103.4.1");
        printString("103.4.2");
        printString("103.5");
        printString("104.1");
        printString("104.1.1");
        printString("104.1.2");
        printString("104.1.3");
        printString("104.2");
        printString("104.2.1");
        printString("104.2.2");
        printString("104.3");
        printString("104.3.1");
        printString("104.3.1.1");
        printString("104.3.2");
        printString("104.3.2.1");
        printString("104.4");
        printString("104.5");
        printString("104.6");
        printString("104.7");
        printString("104.7.1");
        printString("104.7.2");
        printString("104.7.3");
        printString("104.7.4");
        printString("104.7.5");
        printString("104.8");
        printString("105");
        printString("106");
        printString("200.1");
        printString("200.1.1");
        printString("200.1.2");
        printString("200.2");
        printString("200.3");
        printString("200.4");
        printString("200.5");
        printString("200.5.1");
        printString("200.5.1.1");
        printString("200.5.1.2");
        printString("200.5.2");
        printString("200.5.2.1");
        printString("200.5.2.2");
        printString("200.5.2.3");
        printString("200.5.2.4");
        printString("200.5.3");
        printString("200.6");
        printString("200.6.1");
        printString("200.6.1.1");
        printString("200.6.1.2");
        printString("200.6.2");
        printString("200.6.2.1");
        printString("200.6.2.2");
        printString("200.6.2.3");
        printString("200.6.2.4");
        printString("200.6.3");
        printString("200.7");
        printString("200.7.1");
        printString("200.7.2");
        printString("200.8");
        printString("200.9");
        printString("201.1");
        printString("201.1.1");
        printString("201.1.2");
        printString("201.1.3");
        printString("201.2");
        printString("201.2.1");
        printString("201.2.2");
        printString("201.3");
        printString("201.3.1");
        printString("201.3.1.1");
        printString("201.3.2");
        printString("201.3.2.1");
        printString("201.4");
        printString("201.5");
        printString("201.6");
        printString("201.7");
        printString("201.7.1");
        printString("201.7.2");
        printString("201.7.3");
        printString("201.7.4");
        printString("201.7.5");
        printString("201.7.6");
        printString("201.8");
        printString("202.1");
        printString("202.2");
        printString("202.3");
        printString("202.3.1");
        printString("202.3.2");
        printString("202.3.3");
        printString("202.4");
        printString("202.5");
        printString("203");
    end;
end;

/**
 * Класс контроллера экспорта отчета в АС ПСД по указанию 3875-У.
 */
class (TF123PtkPsdExportController) TF123PtkPsdExportController_3875()
    initTF123PtkPsdExportController();

    /**
     * Печать строк "Справочно"
     *
     * @param rowNumberForPrint Номер строки для печати в файл экспорта
     * @param rowNumberForGetValue Номер строки для получения значения
     *
     * @return Печать строки в файл экспорта
     */
    private macro printReferenceString(rowNumberForPrint: String, rowNumberForGetValue: String)
        m_view.printRow("F123B", rowNumberForPrint, "3", m_report.getPart("").getAttribute(rowNumberForGetValue).getValueAsString());
    end;

    /**
     * Печать данных по основным строкам в файл экспорта
     *
     * @return Печать строк отчета в файл экспорта
     */
    private macro printData()
        printString("000");
        printString("100.1");
        printString("100.1.1");
        printString("100.1.2");
        printString("100.1.3");
        printString("100.2");
        printString("100.2.1");
        printString("100.2.1.1");
        printString("100.2.1.2");
        printString("100.2.2");
        printString("100.3");
        printString("100.4");
        printString("100.5");
        printString("100.5.1");
        printString("100.5.1.1");
        printString("100.5.1.2");
        printString("100.5.2");
        printString("100.5.2.1");
        printString("100.5.2.2");
        printString("100.5.2.3");
        printString("100.5.2.4");
        printString("100.5.3");
        printString("100.6");
        printString("100.6.1");
        printString("100.6.1.1");
        printString("100.6.1.2");
        printString("100.6.2");
        printString("100.6.2.1");
        printString("100.6.2.2");
        printString("100.6.2.3");
        printString("100.6.2.4");
        printString("100.6.3");
        printString("100.7");
        printString("101.1");
        printString("101.2");
        printString("101.3");
        printString("101.4");
        printString("101.4.1");
        printString("101.4.2");
        printString("101.4.3");
        printString("101.5");
        printString("101.5.1");
        printString("101.5.2");
        printString("101.5.3");
        printString("101.6");
        printString("101.7");
        printString("101.8");
        printString("101.8.1");
        printString("101.8.1.1");
        printString("101.8.1.2");
        printString("101.8.2");
        printString("101.8.2.1");
        printString("101.8.2.2");
        printString("101.8.2.3");
        printString("101.8.2.4");
        printString("101.8.3");
        printString("101.9");
        printString("101.9.1");
        printString("101.9.1.1");
        printString("101.9.1.2");
        printString("101.9.2");
        printString("101.9.2.1");
        printString("101.9.2.2");
        printString("101.9.2.3");
        printString("101.9.2.4");
        printString("101.9.3");
        printString("101.10");
        printString("101.10.1");
        printString("101.10.2");
        printString("101.10.3");
        printString("101.11");
        printString("101.12");
        printString("101.13");
        printString("101.14");
        printString("101.14.1");
        printString("101.14.2");
        printString("101.14.3");
        printString("101.15");
        printString("102");
        printString("103.1");
        printString("103.1.1");
        printString("103.2");
        printString("103.3");
        printString("103.4");
        printString("103.4.1");
        printString("103.4.2");
        printString("103.5");
        printString("104.1");
        printString("104.1.1");
        printString("104.1.2");
        printString("104.1.3");
        printString("104.2");
        printString("104.2.1");
        printString("104.2.2");
        printString("104.3");
        printString("104.3.1");
        printString("104.3.1.1");
        printString("104.3.2");
        printString("104.3.2.1");
        printString("104.4");
        printString("104.5");
        printString("104.6");
        printString("104.7");
        printString("104.7.1");
        printString("104.7.2");
        printString("104.7.3");
        printString("104.7.4");
        printString("104.7.5");
        printString("104.8");
        printString("105");
        printString("106");
        printString("200.1");
        printString("200.1.1");
        printString("200.1.2");
        printString("200.2");
        printString("200.3");
        printString("200.4");
        printString("200.5");
        printString("200.5.1");
        printString("200.5.1.1");
        printString("200.5.1.2");
        printString("200.5.2");
        printString("200.5.2.1");
        printString("200.5.2.2");
        printString("200.5.2.3");
        printString("200.5.2.4");
        printString("200.5.3");
        printString("200.6");
        printString("200.6.1");
        printString("200.6.1.1");
        printString("200.6.1.2");
        printString("200.6.2");
        printString("200.6.2.1");
        printString("200.6.2.2");
        printString("200.6.2.3");
        printString("200.6.2.4");
        printString("200.6.3");
        printString("200.7");
        printString("200.7.1");
        printString("200.7.2");
        printString("200.8");
        printString("200.9");
        printString("201.1");
        printString("201.1.1");
        printString("201.1.2");
        printString("201.1.3");
        printString("201.2");
        printString("201.2.1");
        printString("201.2.2");
        printString("201.3");
        printString("201.3.1");
        printString("201.3.1.1");
        printString("201.3.2");
        printString("201.3.2.1");
        printString("201.4");
        printString("201.5");
        printString("201.6");
        printString("201.7");
        printString("201.7.1");
        printString("201.7.2");
        printString("201.7.3");
        printString("201.7.4");
        printString("201.7.5");
        printString("201.7.5.1");
        printString("201.7.6");
        printString("201.8");
        printString("202.1");
        printString("202.2");
        printString("202.3");
        printString("202.3.1");
        printString("202.3.2");
        printString("202.3.3");
        printString("202.3.4");
        printString("202.4");
        printString("202.5");
        printString("203");
        printReferenceString("Стр1", "Справ_1");
        printReferenceString("Стр2", "Справ_2");
    end;
end;

/**
 * Класс контроллера экспорта отчета в АС ПСД по указанию 4033-У.
 */
class (TF123PtkPsdExportController) TF123PtkPsdExportController_4033()
    initTF123PtkPsdExportController();

    /**
     * Печать строк "Справочно"
     *
     * @param rowNumberForPrint Номер строки для печати в файл экспорта
     * @param rowNumberForGetValue Номер строки для получения значения
     *
     * @return Печать строки в файл экспорта
     */
    private macro printReferenceString(rowNumberForPrint: String, rowNumberForGetValue: String)
        m_view.printRow("F123B", rowNumberForPrint, "3", m_report.getPart("").getAttribute(rowNumberForGetValue).getValueAsString());
    end;

    /**
     * Печать данных по основным строкам в файл экспорта
     *
     * @return Печать строк отчета в файл экспорта
     */

    private macro printData()
        printString("000");
        printString("100");
        printString("100.1");
        printString("100.1.1");
        printString("100.1.2");
        printString("100.1.3");
        printString("100.2");
        printString("100.2.1");
        printString("100.2.1.1");
        printString("100.2.1.2");
        printString("100.2.2");
        printString("100.3");
        printString("100.4");
        printString("100.5");
        printString("100.5.1");
        printString("100.5.1.1");
        printString("100.5.1.2");
        printString("100.5.1.3");
        printString("100.5.1.4");
        printString("100.5.2");
        printString("100.6");
        printString("100.6.1");
        printString("100.6.1.1");
        printString("100.6.1.2");
        printString("100.6.1.3");
        printString("100.6.1.4");
        printString("100.6.2");
        printString("101");
        printString("101.1");
        printString("101.1.1");
        printString("101.1.2");
        printString("101.2");
        printString("101.3");
        printString("101.4");
        printString("101.4.1");
        printString("101.4.2");
        printString("101.4.3");
        printString("101.4.4");
        printString("101.4.5");
        printString("101.5");
        printString("101.5.1");
        printString("101.5.2");
        printString("101.5.3");
        printString("101.6");
        printString("101.7");
        printString("101.8");
        printString("101.8.1");
        printString("101.8.1.1");
        printString("101.8.1.2");
        printString("101.8.1.3");
        printString("101.8.1.4");
        printString("101.8.2");
        printString("101.9");
        printString("101.9.1");
        printString("101.9.1.1");
        printString("101.9.1.2");
        printString("101.9.1.3");
        printString("101.9.1.4");
        printString("101.9.2");
        printString("101.10");
        printString("101.10.1");
        printString("101.10.2");
        printString("101.10.3");
        printString("101.10.4");
        printString("101.11");
        printString("101.12");
        printString("101.13");
        printString("101.14");
        printString("101.14.1");
        printString("101.14.2");
        printString("101.14.3");
        printString("101.15");
        printString("102");
        printString("103");
        printString("103.1");
        printString("103.1.1");
        printString("103.2");
        printString("103.3");
        printString("103.4");
        printString("103.4.1");
        printString("104");
        printString("104.1");
        printString("104.1.1");
        printString("104.1.2");
        printString("104.1.3");
        printString("104.1.4");
        printString("104.1.5");
        printString("104.2");
        printString("104.2.1");
        printString("104.2.2");
        printString("104.2.3");
        printString("104.3");
        printString("104.3.1");
        printString("104.3.2");
        printString("104.3.2.1");
        printString("104.3.3");
        printString("104.3.3.1");
        printString("104.4");
        printString("104.5");
        printString("104.6");
        printString("104.7");
        printString("104.7.1");
        printString("104.7.2");
        printString("104.7.3");
        printString("104.7.4");
        printString("104.7.5");
        printString("105");
        printString("106");
        printString("200");
        printString("200.1");
        printString("200.1.1");
        printString("200.1.2");
        printString("200.2");
        printString("200.3");
        printString("200.4");
        printString("200.5");
        printString("200.5.1");
        printString("200.5.1.1");
        printString("200.5.1.2");
        printString("200.5.1.3");
        printString("200.5.1.4");
        printString("200.5.2");
        printString("200.6");
        printString("200.6.1");
        printString("200.6.1.1");
        printString("200.6.1.2");
        printString("200.6.1.3");
        printString("200.6.1.4");
        printString("200.6.2");
        printString("200.7");
        printString("200.7.1");
        printString("200.7.2");
        printString("200.7.3");
        printString("200.8");
        printString("200.9");
        printString("201");
        printString("201.1");
        printString("201.1.1");
        printString("201.1.2");
        printString("201.1.3");
        printString("201.1.4");
        printString("201.1.5");
        printString("201.2");
        printString("201.2.1");
        printString("201.2.2");
        printString("201.2.3");
        printString("201.3");
        printString("201.3.1");
        printString("201.3.2");
        printString("201.3.2.1");
        printString("201.3.3");
        printString("201.3.3.1");
        printString("201.4");
        printString("201.5");
        printString("201.6");
        printString("201.7");
        printString("201.7.1");
        printString("201.7.2");
        printString("201.7.3");
        printString("201.7.4");
        printString("201.7.5");
        printString("201.7.5.1");
        printString("201.7.6");
        printString("202");
        printString("202.1");
        printString("202.2");
        printString("202.3");
        printString("202.3.1");
        printString("202.3.2");
        printString("202.3.3");
        printString("202.3.4");
        printString("202.4");
        printString("203");

        printReferenceString("1", "Справ_1");
        printReferenceString("2", "Справ_2");
        printReferenceString("3.1", "Справ_3.1");
        printReferenceString("3.2", "Справ_3.2");
    end;
end;

