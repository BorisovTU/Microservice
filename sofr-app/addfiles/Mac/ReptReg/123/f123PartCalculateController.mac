/*
$Name:          f123PartCalculateController.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Контроллеры расчета разделов
*/
 
/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbPartCalculateController) TF123PartCalculateController(reportCalculateController : Object, partId : String)

    private var m_tuneTable;
    private var m_dataSourceAcc;
    private var m_dataSourceFilterAcc;
    private var m_dataSourceDoc;
    private var m_dataSourceFilterDoc;
    private var m_protocolView;

    /* Нераспределенная прибыль / непокрытый убыток от ПФИ */
    private CONST Нераспределенная_прибыль_непокрытый_убыток_от_ПФИ = 64;
    private CONST Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой = 65;
    private CONST Стоимость_выкупленных_долей = 23;
    private CONST Неиспользованные_суммы_фондов = 66;


    private CONST Доля_в_УК = 20;
    private CONST Финансовая_организация = 69;
    private CONST Банк = 2;

    macro constructorTF123PartCalculateController(reportCalculateController : Object, partId : String)
        initRcbPartCalculateController(reportCalculateController, "");

        m_tuneTable = objectFactoryInstance.createTuneTable();
        m_dataSourceAcc = m_dataSources.getDataSource("Accounts");
        m_dataSourceFilterAcc = m_dataSouceFilters.getFilter("Accounts");

        m_dataSourceDoc = m_dataSources.getDataSource("Documents");
        m_dataSourceFilterDoc = m_dataSouceFilters.getFilter("Documents");

        m_protocolView = m_reportCalculateController.getProtocolView();
    end;

    private macro calculateLine_100_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ОА'");

                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K3");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "100.1.1 + 100.1.2");
            m_protocolView.printLineValueInfo("100.1.1", m_part.getAttribute("100.1.1").getValue());
            m_protocolView.printLineValueInfo("100.1.2", m_part.getAttribute("100.1.2").getValue());

            attribute.plus(m_part.getAttribute("100.1.1").getValue()).
                      plus(m_part.getAttribute("100.1.2").getValue());
        else
            m_protocolView.printAlg(attributeId, "100.1.3");
            m_protocolView.printLineValueInfo("100.1.3", m_part.getAttribute("100.1.3").getValue());
            attribute.setValue(m_part.getAttribute("100.1.3").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ОА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K3");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "100.2.1.1 + 100.2.1.2");
            m_protocolView.printLineValueInfo("100.2.1.1", m_part.getAttribute("100.2.1.1").getValue());
            m_protocolView.printLineValueInfo("100.2.1.2", m_part.getAttribute("100.2.1.2").getValue());

            attribute.plus(m_part.getAttribute("100.2.1.1").getValue()).
                      plus(m_part.getAttribute("100.2.1.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1"));
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1"));
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1"));
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.2.1 + 100.2.2");
        m_protocolView.printLineValueInfo("100.2.1", m_part.getAttribute("100.2.1").getValue());
        m_protocolView.printLineValueInfo("100.2.2", m_part.getAttribute("100.2.2").getValue());

        attribute.plus(m_part.getAttribute("100.2.1").getValue()).
                  plus(m_part.getAttribute("100.2.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_3_PrPL(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);

        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (not global.parameters.isConfirmedProfitLastDate() and (rcbApplication().currentReport.context.period.endDate + 1 <= Date(1, 7, year)))
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "70801*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.3"));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attribute.setValue(sum);

            m_dataSourceFilterDoc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "70801*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.3"));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_3_PrTG(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);

        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.3"));
        sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
        attribute.setValue(sum);

        m_dataSourceFilterDoc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.3"));
        sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.3_ПрПЛ - 100.3_ПрТГ");
        m_protocolView.printLineValueInfo("100.3_ПрПЛ", m_part.getAttribute("100.3_ПрПЛ").getValue());
        m_protocolView.printLineValueInfo("100.3_ПрТГ", m_part.getAttribute("100.3_ПрТГ").getValue());

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        attribute.minus(m_part.getAttribute("100.3_ПрПЛ").getValue()).
                  minus(m_part.getAttribute("100.3_ПрТГ").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);

        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), Date(global.parameters.getConfirmedProfitCurrentDate()) - 1).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attribute.setValue(sum);

            m_dataSourceFilterDoc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            if (global.parameters.isConfirmedProfitCurrentDate())
                if (m_part.getAttribute("100.5.1_доп").getValue() < 0)
                    m_protocolView.printAlg(attributeId, "100.5.1_доп * (-1)");
                    m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
                    m_protocolView.printString("Значение переменной 100.5.1_доп < 0!");
                    attribute.setValue(m_part.getAttribute("100.5.1_доп").getValue() * (-1));
                else
                    attribute.setValue($0.0);
                end;
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            if (global.parameters.isConfirmedProfitCurrentDate())
                if (m_part.getAttribute("100.5.1_доп").getValue() > 0)
                    m_protocolView.printAlg(attributeId, "100.5.1_доп / 100 * K4");
                    m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
                    m_protocolView.printString("Значение переменной 100.5.1_доп > 0!");
                    m_protocolView.printParamValue("K4", global.parameters.getK4());

                    attribute.setValue(m_part.getAttribute("100.5.1_доп").getValue()).
                                   div(100).
                              multiply(global.parameters.getK4());
                else
                    attribute.setValue($0.0);
                end;
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5.1г").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.1г");
            m_protocolView.printLineValueInfo("100.5.1г", m_part.getAttribute("100.5.1г").getValue());
            m_protocolView.printString("Значение переменной 100.5.1г > 0!");

            attribute.setValue(m_part.getAttribute("100.5.1г").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5.1в").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.1в");
            m_protocolView.printLineValueInfo("100.5.1в", m_part.getAttribute("100.5.1в").getValue());
            m_protocolView.printString("Значение переменной 100.5.1в > 0!");

            attribute.setValue(m_part.getAttribute("100.5.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_TOTAL_PFI(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5.1а").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.1а");
            m_protocolView.printLineValueInfo("100.5.1а", m_part.getAttribute("100.5.1а").getValue());
            m_protocolView.printString("Значение переменной 100.5.1а > 0!");

            attribute.setValue(m_part.getAttribute("100.5.1а").getValue());
        elif (m_part.getAttribute("100.5.1б").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.1б * (-1)");
            m_protocolView.printLineValueInfo("100.5.1б", m_part.getAttribute("100.5.1б").getValue());
            m_protocolView.printString("Значение переменной 100.5.1б > 0!");

            attribute.setValue(m_part.getAttribute("100.5.1б").getValue());
            attribute.multiply(-1);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 100.5_дисконт + 100.5.1_итог_ПФИ + 100.5.3_доп - 100.5.2_доп");

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;
        else
            attrSum1.setValue(0);
        end;

        m_dataSourceFilterAcc.clear();

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum2.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;
        else
            attrSum2.setValue(0);
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5.1_итог_ПФИ", m_part.getAttribute("100.5.1_итог_ПФИ").getValue());
        m_protocolView.printLineValueInfo("100.5.3_доп", m_part.getAttribute("100.5.3_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5.1_итог_ПФИ").getValue()).
                      plus(m_part.getAttribute("100.5.3_доп").getValue()).
                      minus(m_part.getAttribute("100.5.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");

            if (m_part.getAttribute("100.5_доп").getValue() > 0)
                m_protocolView.printAlg(attributeId, "100.5_доп");
                m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());
                m_protocolView.printString("Значение переменной 101.9_доп > 0!");

                attribute.setValue(m_part.getAttribute("100.5_доп").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "100.5.2")
            m_protocolView.printAlg(attributeId, "100.5.2.1 + 100.5.2.2 + 100.5.2.3 + 100.5.2.4");

            m_protocolView.printLineValueInfo("100.5.2.1", m_part.getAttribute("100.5.2.1").getValue());
            m_protocolView.printLineValueInfo("100.5.2.2", m_part.getAttribute("100.5.2.2").getValue());
            m_protocolView.printLineValueInfo("100.5.2.3", m_part.getAttribute("100.5.2.3").getValue());
            m_protocolView.printLineValueInfo("100.5.2.4", m_part.getAttribute("100.5.2.4").getValue());

            attribute.setValue(m_part.getAttribute("100.5.2.1").getValue()).
                          plus(m_part.getAttribute("100.5.2.2").getValue()).
                          plus(m_part.getAttribute("100.5.2.3").getValue()).
                          plus(m_part.getAttribute("100.5.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "100.6.2")
            m_protocolView.printAlg(attributeId, "100.6.2.1 + 100.6.2.2 + 100.6.2.3 + 100.6.2.4");

            m_protocolView.printLineValueInfo("100.6.2.1", m_part.getAttribute("100.6.2.1").getValue());
            m_protocolView.printLineValueInfo("100.6.2.2", m_part.getAttribute("100.6.2.2").getValue());
            m_protocolView.printLineValueInfo("100.6.2.3", m_part.getAttribute("100.6.2.3").getValue());
            m_protocolView.printLineValueInfo("100.6.2.4", m_part.getAttribute("100.6.2.4").getValue());

            attribute.setValue(m_part.getAttribute("100.6.2.1").getValue()).
                          plus(m_part.getAttribute("100.6.2.2").getValue()).
                          plus(m_part.getAttribute("100.6.2.3").getValue()).
                          plus(m_part.getAttribute("100.6.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп <= 0!");

            if (m_part.getAttribute("100.6_доп").getValue() > 0)
                m_protocolView.printAlg(attributeId, "100.6_доп");
                m_protocolView.printLineValueInfo("100.6_доп", m_part.getAttribute("100.6_доп").getValue());
                m_protocolView.printString("Значение переменной 100.6_доп > 0!");

                attribute.setValue(m_part.getAttribute("100.6_доп").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            if (m_part.getAttribute("100.6.1_доп").getValue() < 0)
                m_protocolView.printAlg(attributeId, "100.6.1_доп * (-1)");
                m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());
                m_protocolView.printString("Значение переменной 100.6.1_доп < 0!");

                attribute.setValue(m_part.getAttribute("100.6.1_доп").getValue()).
                          multiply(-1);
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            if (m_part.getAttribute("100.6.1_доп").getValue() > 0)
                m_protocolView.printAlg(attributeId, "100.6.1_доп /100 * K4");
                m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());
                m_protocolView.printString("Значение переменной 100.6.1_доп > 0!");
                m_protocolView.printParamValue("K4", global.parameters.getK4());

                attribute.setValue(m_part.getAttribute("100.6.1_доп").getValue()).
                               div(100).
                          multiply(global.parameters.getK4());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6.1г").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.1г");
            m_protocolView.printLineValueInfo("100.6.1г", m_part.getAttribute("100.6.1г").getValue());
            m_protocolView.printString("Значение переменной 100.6.1г > 0!");

            attribute.setValue(m_part.getAttribute("100.6.1г").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6.1в").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.1в");
            m_protocolView.printLineValueInfo("100.6.1в", m_part.getAttribute("100.6.1в").getValue());
            m_protocolView.printString("Значение переменной 100.6.1в > 0!");

            attribute.setValue(m_part.getAttribute("100.6.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.2_доп");
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            attribute.setValue(m_part.getAttribute("100.6.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.3_доп");
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            attribute.setValue(m_part.getAttribute("100.6.3_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.1 + 100.2 + 100.3 + 100.4 + 100.5 + 100.6");
        m_protocolView.printLineValueInfo("100.1", m_part.getAttribute("100.1").getValue());
        m_protocolView.printLineValueInfo("100.2", m_part.getAttribute("100.2").getValue());
        m_protocolView.printLineValueInfo("100.3", m_part.getAttribute("100.3").getValue());
        m_protocolView.printLineValueInfo("100.4", m_part.getAttribute("100.4").getValue());
        m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
        m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());

        attribute.setValue(m_part.getAttribute("100.1").getValue()).
                      plus(m_part.getAttribute("100.2").getValue()).
                      plus(m_part.getAttribute("100.3").getValue()).
                      plus(m_part.getAttribute("100.4").getValue()).
                      plus(m_part.getAttribute("100.5").getValue()).
                      plus(m_part.getAttribute("100.6").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.4.1 + 101.4.2 + 101.4.3");
        m_protocolView.printLineValueInfo("101.4.1", m_part.getAttribute("101.4.1").getValue());
        m_protocolView.printLineValueInfo("101.4.2", m_part.getAttribute("101.4.2").getValue());
        m_protocolView.printLineValueInfo("101.4.3", m_part.getAttribute("101.4.3").getValue());

        attribute.setValue(m_part.getAttribute("101.4.1").getValue()).
                      plus(m_part.getAttribute("101.4.2").getValue()).
                      plus(m_part.getAttribute("101.4.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var previousReport = objectFactoryInstance.createPreviousReport();
        var attr_100_6 = 0;

        m_protocolView.printLineInfo(attributeId);

        if (objectFactoryInstance.createPreviousReport().isCalculated)
            attr_100_6 = previousReport.getPart("").getAttribute("100.6").getValue();
        end;

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за Дата Ауд_прошлГ - 100.6.2_доп");
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
            m_protocolView.printLineValueInfo("100.6.2_доп", m_part.getAttribute("100.6.2_доп").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue()).
                         minus(m_part.getAttribute("100.6.2_доп").getValue()).
        else
            if (global.parameters.getUnconfirmedProfitBasel() == "2.1.8")
                m_protocolView.printAlg(attributeId, "MIN(Прибыль прошлых лет за Дата Ауд_прошлГ, 100.6) + Прибыль предшествующих лет без прибыли прошлого года - 100.6.2_доп");
                m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
                m_protocolView.printLineValueInfo("100.6", attr_100_6);
                m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printLineValueInfo("100.6.2_доп", m_part.getAttribute("100.6.2_доп").getValue());

                attribute.setValue(min(m_part.getAttribute("Прибыль прошлого года").getValue(), attr_100_6));
            else
                attribute.setValue($0.0);
            end;

            attribute.plus(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue()).
                     minus(m_part.getAttribute("100.6.2_доп").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.2_доп");
            m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
            m_protocolView.printString("Значение переменной 100.5 > 0!");

            attribute.setValue(m_part.getAttribute("100.5.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.3_доп");
            m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
            m_protocolView.printString("Значение переменной 100.5 > 0!");

            attribute.setValue(m_part.getAttribute("100.5.3_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_PFI_707(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "100.6.1_ПФИ_707 + 100.6.1_ПФИ_108_109_708");
            m_protocolView.printLineValueInfo("100.6.1_ПФИ_707", m_part.getAttribute("100.6.1_ПФИ_707").getValue());
            m_protocolView.printLineValueInfo("100.6.1_ПФИ_108_109_708", m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue());

            attribute.setValue(m_part.getAttribute("100.6.1_ПФИ_707").getValue()).
                          plus(m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue());

            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_3_DOP(attributeId : String)

        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal =TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;

            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            m_dataSourceFilterAcc.clear();

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum2.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum3.setValue(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                         minus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Финансовый рез-т предшествующих лет без прибыли прошлого года */
    private macro finResultLastYearsWithoutProfit(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Нераспределенная_прибыль_непокрытый_убыток_от_ПФИ);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10901*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Нераспределенная_прибыль_непокрытый_убыток_от_ПФИ);
        attrSum2.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10901*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum2.getValue());

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Прибыль предшествующих лет без прибыли прошлого года */
    private macro profitPreviousYearsWithoutLastYear(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() > 0)
            m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года + (Сумма1 - Сумма2)");

            m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года > 0!");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterDoc.clear();
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_dataSourceFilterDoc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum2.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterDoc.clear();
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());

            attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          plus(attrSum1.getValue()).
                         minus(attrSum2.getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Финансовый результат прошлого года за ДООП*/
    private macro finResultPreviousYearForDate(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var attrSum4_1 = m_part.getAttribute("attrSum4_1");
        var attrSum5 = m_part.getAttribute("attrSum5");
        var attrSum5_1 = m_part.getAttribute("attrSum5_1");
        var attrSum6 = m_part.getAttribute("attrSum6");
        var attrSum7 = m_part.getAttribute("attrSum7");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1  + Сумма2 + Сумма3 + Сумма4 - Сумма5 + Сумма6 + Сумма7");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attrSum3.minus(sum);
        attrSum3.multiply(global.parameters.getK1());
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", "(" + tempVal[0] + " - " + tempVal[1] + ") * " + global.parameters.getK1() + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70801*");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum4_1.setValue(sum);
        tempVal[1] = sum;

        attrSum4.minus(attrSum4_1.getValue());
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма5:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70802*");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum5.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70802*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum5_1.setValue(sum);
        tempVal[1] = sum;

        attrSum5.minus(attrSum5_1.getValue());
        m_protocolView.printAlg("Сумма5", tempVal[0] + " - " + tempVal[1] + " = " + attrSum5.getValue());
        tempVal.size = 0;

        attrSum6.setValue(attrSum4_1.getValue());
        attrSum6.minus(attrSum5_1.getValue());
        attrSum6.multiply(global.parameters.getK1());
        m_protocolView.printAlg("Сумма6", "(" + attrSum4_1.getValue() + " - " + attrSum5_1.getValue() + ") * " + global.parameters.getK1() + " = " + attrSum6.getValue());

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма7:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum7.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum7.minus(sum);
        tempVal[1] = sum;

        if (attrSum7.getValue > 0)
            attrSum7.div(100);
            attrSum7.multiply(global.parameters.getK4());
            m_protocolView.printParamValue("K4", global.parameters.getK4());
            m_protocolView.printAlg("Сумма7", "(" + tempVal[0] + " - " + tempVal[1] + ") / 100 * " + global.parameters.getK4() + " = " + attrSum7.getValue());
        else
            m_protocolView.printAlg("Сумма7", tempVal[0] + " - " + tempVal[1] + " = " + attrSum7.getValue());
        end;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                     minus(attrSum5.getValue()).
                      plus(attrSum6.getValue()).
                      plus(attrSum7.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Прибыль прошлого года */
    private macro profitLastYear(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() > 0)
            m_protocolView.printAlg(attributeId, "Финансовый результат ПГ за ДООП");
            m_protocolView.printLineValueInfo("Финансовый результат ПГ за ДООП", m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат ПГ за ДООП > 0!");

            attribute.setValue(m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Прибыль прошлых лет */
    private macro profitLastYears(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 + 100.6.1_ПФИ_108_109_708 + Сумма3 + Сумма4 + 100.6.1_доп + 100.6.3_доп");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов, forDate);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue()).
                      plus(m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                      plus(m_part.getAttribute("100.6.1_доп").getValue()).
                      plus(m_part.getAttribute("100.6.3_доп").getValue());

        m_protocolView.printLineValueInfo("100.6.1_ПФИ_108_109_708", m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue());
        m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.6.3_доп", m_part.getAttribute("100.6.3_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Убыток прошлых лет */
    private macro lossLastYears(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue() < 0)
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за ДООП", m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue());
            m_protocolView.printString("Значение переменной Прибыль прошлых лет за ДООП < 0!");

            m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за ДООП * (-1)");
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за ДООП", m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue()).
                      multiply(-1);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.acceptedDistributedProfit() or
            (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() < 0))
           )
            m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ < 0!");
            m_protocolView.printAlg(attributeId, "Финансовый результат ПГ за Дата Ауд_прошлГ");
            attribute.setValue(m_part.getAttribute("Убыток прошлых лет").getValue());

        elif (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0))
            if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() < 0)

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года < 0!");
                m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года * (-1) + (Сумма1 - Сумма2)");

                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
                tempVal.size = 0;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
                tempVal.size = 0;

                attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          multiply(-1).
                              plus(attrSum1.getValue()).
                             minus(attrSum2.getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за Дата Ауд_прошлГ + 101.8.1_ПФИ_108_109_708");
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", m_part.getAttribute("101.8.1_ПФИ_707 за Дата Ауд_прошлГ").getValue());
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());

                        attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за Дата Ауд_прошлГ").getValue()).
                                      plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                    else
                        m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_108_109_708");
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                        attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за ДООП + 101.8.1_ПФИ_108_109_708");
                    m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за ДООП", m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue());
                    m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());

                    attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue()).
                                  plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за ДООП + 101.8.1_ПФИ_108_109_708");
                m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за ДООП", m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue());
                m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());

                attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue()).
                              plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            if (m_part.getAttribute("101.8.1_доп").getValue() < 0)
                m_protocolView.printLineValueInfo("101.8.1_доп", m_part.getAttribute("101.8.1_доп").getValue());
                m_protocolView.printString("Значение переменной 101.8.1_доп < 0!");
                m_protocolView.printAlg(attributeId, "101.8.1_доп * (-1)");

                attribute.setValue(m_part.getAttribute("101.8.1_доп").getValue()).
                          multiply(-1);
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            if (m_part.getAttribute("101.8.1_доп").getValue() > 0)
                m_protocolView.printLineValueInfo("101.8.1_доп", m_part.getAttribute("101.8.1_доп").getValue());
                m_protocolView.printString("Значение переменной 101.8.1_доп > 0!");
                m_protocolView.printAlg(attributeId, "101.8.1_доп / 100 * K4");
                m_protocolView.printParamValue("K4", global.parameters.getK4());

                attribute.setValue(m_part.getAttribute("101.8.1_доп").getValue()).
                               div(100).
                          multiply(global.parameters.getK4());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8.1г").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8.1г", m_part.getAttribute("101.8.1г").getValue());
            m_protocolView.printString("Значение переменной 101.8.1г > 0!");
            m_protocolView.printAlg(attributeId, "101.8.1г");

            attribute.setValue(m_part.getAttribute("101.8.1г").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8.1в").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8.1в", m_part.getAttribute("101.8.1в").getValue());
            m_protocolView.printString("Значение переменной 101.8.1в > 0!");
            m_protocolView.printAlg(attributeId, "101.8.1в");

            attribute.setValue(m_part.getAttribute("101.8.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.8.2")
            m_protocolView.printAlg(attributeId, "101.8.2.1 + 101.8.2.2 + 101.8.2.3 + 101.8.2.4");

            attribute.setValue(m_part.getAttribute("101.8.2.1").getValue()).
                          plus(m_part.getAttribute("101.8.2.2").getValue()).
                          plus(m_part.getAttribute("101.8.2.3").getValue()).
                          plus(m_part.getAttribute("101.8.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            m_protocolView.printAlg(attributeId, "101.8_доп");

            attribute.setValue(m_part.getAttribute("101.8_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "101.8.2_доп");

            attribute.setValue(m_part.getAttribute("101.8.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Прибыль");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Убыток");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");

            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue()).
                                     minus(attrSum1.getValue());
                    else
                        m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1");
                    m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                    m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                    m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                    attribute.setValue(attrSum3.getValue()).
                                 minus(attrSum2.getValue()).
                                 minus(attrSum1.getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1");
                m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                attribute.setValue(attrSum3.getValue()).
                             minus(attrSum2.getValue()).
                             minus(attrSum1.getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            m_protocolView.printAlg(attributeId, "101.8.3_доп");

            attribute.setValue(m_part.getAttribute("101.8.3_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_PFI_707(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_НА")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.plus(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum).
               multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.2"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.2_Обязательства")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Отл. НО зав. от прибыли'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Отл. НО зав. от прибыли'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum).
               multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* 101.3_данные */
    private macro calculateLine_101_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.3"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.2_Обязательства")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Отл. НО не зав. от прибыли'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Отл. НО не зав. от прибыли'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum).
               multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())

            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum2);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum2);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "Сумма1 * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "Сумма1 * K1");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Стоимость_выкупленных_долей);
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.5.1 + 101.5.2 + 101.5.3");
        m_protocolView.printLineValueInfo("101.5.1", m_part.getAttribute("101.5.1").getValue());
        m_protocolView.printLineValueInfo("101.5.2", m_part.getAttribute("101.5.2").getValue());
        m_protocolView.printLineValueInfo("101.5.3", m_part.getAttribute("101.5.3").getValue());

        attribute.setValue(m_part.getAttribute("101.5.1").getValue()).
                      plus(m_part.getAttribute("101.5.2").getValue()).
                      plus(m_part.getAttribute("101.5.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.6")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ПТЛ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ПТЛ'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.minus(sum);
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.1_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.1_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    private macro calculateLine_101_9_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.9.2")
            m_protocolView.printAlg(attributeId, "101.9.2.1 + 101.9.2.2 + 101.9.2.3 + 101.9.2.4");
            m_protocolView.printLineValueInfo("101.9.2.1", m_part.getAttribute("101.9.2.1").getValue());
            m_protocolView.printLineValueInfo("101.9.2.2", m_part.getAttribute("101.9.2.2").getValue());
            m_protocolView.printLineValueInfo("101.9.2.3", m_part.getAttribute("101.9.2.3").getValue());
            m_protocolView.printLineValueInfo("101.9.2.4", m_part.getAttribute("101.9.2.4").getValue());
            attribute.setValue(m_part.getAttribute("101.9.2.1").getValue()).
                          plus(m_part.getAttribute("101.9.2.2").getValue()).
                          plus(m_part.getAttribute("101.9.2.3").getValue()).
                          plus(m_part.getAttribute("101.9.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.3_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.3_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum);
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        m_dataSourceFilterAcc.clear();
        var tempVal = TArray();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 101.9_дисконт + 101.9.1_доп + 101.9.2_доп + 101.9.3_доп");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.3_доп", m_part.getAttribute("101.9.3_доп").getValue());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(m_part.getAttribute("101.9_дисконт").getValue()).
                      plus(m_part.getAttribute("101.9.1_доп").getValue()).
                      plus(m_part.getAttribute("101.9.2_доп").getValue()).
                      plus(m_part.getAttribute("101.9.3_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");

            attribute.setValue(m_part.getAttribute("101.9_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_BK(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.7 - 101.1 - 101.2 - 101.4 - 101.5 - 101.6 - 101.7 - 101.8 - 101.9");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.1").getValue()).
                     minus(m_part.getAttribute("101.2").getValue()).
                     minus(m_part.getAttribute("101.4").getValue()).
                     minus(m_part.getAttribute("101.5").getValue()).
                     minus(m_part.getAttribute("101.6").getValue()).
                     minus(m_part.getAttribute("101.7").getValue()).
                     minus(m_part.getAttribute("101.8").getValue()).
                     minus(m_part.getAttribute("101.9").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");

            if (m_part.getAttribute("101.9.1_доп").getValue() > 0)
                m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
                m_protocolView.printString("Значение переменной 101.9.1_доп > 0!");
                m_protocolView.printAlg(attributeId, "101.9.1_доп * K4");
                m_protocolView.printParamValue("K4", global.parameters.getK4());
                attribute.setValue(m_part.getAttribute("101.9.1_доп").getValue());
                attribute.multiply(global.parameters.getK4());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");

            if (m_part.getAttribute("101.9.1_доп").getValue() < 0)
                m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
                m_protocolView.printString("Значение переменной 101.9.1_доп < 0!");
                m_protocolView.printAlg(attributeId, "101.9.1_доп * (-1)");

                attribute.setValue(m_part.getAttribute("101.9.1_доп").getValue());
                attribute.multiply(-1);
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9.1в").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9.1в", m_part.getAttribute("101.9.1в").getValue());
            m_protocolView.printString("Значение переменной 101.9.1в > 0!");
            m_protocolView.printAlg(attributeId, "101.9.1в");

            attribute.setValue(m_part.getAttribute("101.9.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
            m_protocolView.printString("Значение переменной 101.9 > 0!");
            m_protocolView.printAlg(attributeId, "101.9.2_доп");

            attribute.setValue(m_part.getAttribute("101.9.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
            m_protocolView.printString("Значение переменной 101.9 > 0!");
            m_protocolView.printAlg(attributeId, "101.9.3_доп");

            attribute.setValue(m_part.getAttribute("101.9.3_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9.1г").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9.1г", m_part.getAttribute("101.9.1г").getValue());
            m_protocolView.printString("Значение переменной 101.9.1г > 0!");
            m_protocolView.printAlg(attributeId, "101.9.1г");

            attribute.setValue(m_part.getAttribute("101.9.1г").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = Tarray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + Сумма3");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "MIN(101.10.2_данные, Сумма1)");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.1);

        m_protocolView.printLine("Сумма1 = 101.10.2_данные - 0.1 * Сумма_БК_1");
        m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.10.2_данные").getValue()).
                     minus(attrSum1.getValue());
        println();
        println("Сумма1 = " + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        attribute.setValue(min(attribute.getValue(), m_part.getAttribute("101.10.2_данные").getValue()));

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "MIN(101.3_данные, Сумма2)");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.1);

        m_protocolView.printLine("Сумма2 = 101.3_данные - (0.1 * Сумма_БК_1)");
        m_protocolView.printLineValueInfo("101.3_данные", m_part.getAttribute("101.3_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.3_данные").getValue()).
                     minus(attrSum1.getValue());

        println();
        println("Сумма2 = " + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма2 < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        attribute.setValue(min(m_part.getAttribute("101.3_данные").getValue(), attribute.getValue()));

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.10.1 + 101.10.2 + 101.10.3");
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());
        m_protocolView.printLineValueInfo("101.10.2", m_part.getAttribute("101.10.2").getValue());
        m_protocolView.printLineValueInfo("101.10.3", m_part.getAttribute("101.10.3").getValue());

        attribute.setValue(m_part.getAttribute("101.10.1").getValue()).
                      plus(m_part.getAttribute("101.10.2").getValue()).
                      plus(m_part.getAttribute("101.10.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.3_данные + 101.10.2_данные");
        m_protocolView.printLineValueInfo("101.3_данные", m_part.getAttribute("101.3_данные").getValue());
        m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());

        attribute.setValue(m_part.getAttribute("101.3_данные").getValue()).
                      plus(m_part.getAttribute("101.10.2_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "MIN((101.10.3_данные - 101.3 - 101.10.2), Сумма1)");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.15);

        m_protocolView.printLine("Сумма1 = 101.10.3_данные - (0.15 * Сумма_БК_1)");
        m_protocolView.printLineValueInfo("101.10.3_данные", m_part.getAttribute("101.10.3_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.10.3_данные").getValue()).
                     minus(attrSum1.getValue());

        println();
        println("Сумма1 =" + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        attrSum2.setValue(m_part.getAttribute("101.10.3_данные").getValue()).
                 minus(m_part.getAttribute("101.3").getValue()).
                 minus(m_part.getAttribute("101.10.2").getValue());

        attribute.setValue(min(attribute.getValue(), attrSum2.getValue()));

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg("103.1", "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("103.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 181-ФЗ'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("103.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 181-ФЗ'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("103.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 181-ФЗ'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 181-ФЗ'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        attribute.setValue(attribute.GetValue() + m_part.getAttribute("103.1.1").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        sum = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc);
        attribute.setValue(sum).
                  multiply(global.parameters.getK3());

        m_protocolView.printParamValue("K3", global.parameters.getK3());
        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        var filterForComment = m_dataSourceFilterAcc.setCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК бессрочный'") + "UNION" + m_dataSourceFilterAcc.setCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК иностр. госуд.'") + " UNION " + m_dataSourceFilterAcc.setCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");

        sum = m_dataSourceAcc.getDataForCategory(m_dataSourceFilterAcc, filterForComment);

        attribute.setValue(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "103.1 + 103.2 + 103.3 + 103.4");
        m_protocolView.printLineValueInfo("103.1", m_part.getAttribute("103.1").getValue());
        m_protocolView.printLineValueInfo("103.2", m_part.getAttribute("103.2").getValue());
        m_protocolView.printLineValueInfo("103.3", m_part.getAttribute("103.3").getValue());
        m_protocolView.printLineValueInfo("103.4", m_part.getAttribute("103.4").getValue());

        attribute.setValue(m_part.getAttribute("103.1").getValue()).
                      plus(m_part.getAttribute("103.2").getValue()).
                      plus(m_part.getAttribute("103.3").getValue()).
                      plus(m_part.getAttribute("103.4").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_4_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("103.4")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК иностр. госуд.'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК иностр. госуд.'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_4_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("103.4")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_1_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "Сумма1 * K1");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "104.1.1 + 104.1.2 + 104.1.3");
            m_protocolView.printLineValueInfo("104.1.1", m_part.getAttribute("104.1.1").getValue());
            m_protocolView.printLineValueInfo("104.1.2", m_part.getAttribute("104.1.2").getValue());
            m_protocolView.printLineValueInfo("104.1.3", m_part.getAttribute("104.1.3").getValue());

            attribute.plus(m_part.getAttribute("104.1.1").getValue()).
                      plus(m_part.getAttribute("104.1.2").getValue()).
                      plus(m_part.getAttribute("104.1.3").getValue());
        else
            m_protocolView.printAlg(attributeId, "100.1.3");
            m_protocolView.printLineValueInfo("100.1.3", m_part.getAttribute("100.1.3").getValue());

            attribute.setValue(m_part.getAttribute("100.1.3").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K2");

        /*Сумма1*/
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();

        /*Сумма2*/
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_НА")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'НМА'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.plus(sum);

        m_dataSourceFilterAcc.clear();

        /*Сумма3*/
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.minus(sum);

        m_protocolView.printParamValue("K2", global.parameters.getK2());
        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.7.2_АО")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K2", global.parameters.getK2());
            attribute.minus(sum);
            attribute.multiply(global.parameters.getK2());
        else

            var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");

            m_dataSourceFilterAcc.clear();

            if (global.parameters.isOurBankOOO())
                m_protocolView.printAlg(attributeId, "Сумма1 * K2");
                m_protocolView.printLine("Сумма1:");

                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.7.2_ООО")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
                dataSourceNoteAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
                sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Стоимость_выкупленных_долей);

                attribute.setValue(sum);
                m_protocolView.printParamValue("K2", global.parameters.getK2());
                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");;
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.7.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.7.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.setValue(sum);
        attribute.multiply(global.parameters.getK2());
        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "Сумма1 * K3");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА до 01.03.2013'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА до 01.03.2013'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K3", global.parameters.getK3());

            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK3());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА после 01.03.2013'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА после 01.03.2013'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "200.1.1 + 200.1.2");
            m_protocolView.printLineValueInfo("200.1.1", m_part.getAttribute("200.1.1").getValue());
            m_protocolView.printLineValueInfo("200.1.2", m_part.getAttribute("200.1.2").getValue());

            attribute.plus(m_part.getAttribute("200.1.1").getValue()).
                      plus(m_part.getAttribute("200.1.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.2_АО")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УК ПрИмДоВыб'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УК ПрИмДоВыб'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
        elif (global.parameters.isOurBankOOO())
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.2_ООО")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УК ПрИмДоВыб'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УК ПрИмДоВыб'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "Сумма1 * K3");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K3", global.parameters.getK3());

            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK3());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("200.4"));
        sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterDoc.clear();
        m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "70612*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("200.4"));
        sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
        attrSum1.minus(sum);
        attrSum1.minus(m_part.getAttribute("100.4").getValue());
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + m_part.getAttribute("100.4").getValue() + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterDoc.clear();
        m_protocolView.printLine("Сумма2:");
        if (not global.parameters.isConfirmedProfitLastDate() and (rcbApplication().currentReport.context.period.endDate + 1 <= Date(1, 7, year)))
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "70801*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("200.4"));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum2.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterDoc.clear();
            m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "70801*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("200.4"));
            sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;
        else
            attrSum2.setValue(0);
        end;

        attribute.setValue(attrSum1.getValue());
        attribute.plus(attrSum2.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum);
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_PFI_707(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.1_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.1_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);
    end;

    private macro calculateLine_200_6_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Прибыль_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Убыток_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                     minus(attrSum3.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "Сумма1 * K1");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(sum);
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_NV(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.10.1_данные + 104.2.1_данные + 104.3.1_данные + 201.2.1_данные + 201.3.1_данные");
        m_protocolView.printLineValueInfo("101.10.1_данные", m_part.getAttribute("101.10.1_данные").getValue());
        m_protocolView.printLineValueInfo("104.2.1_данные", m_part.getAttribute("104.2.1_данные").getValue());
        m_protocolView.printLineValueInfo("104.3.1_данные", m_part.getAttribute("104.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("201.3.1_данные", m_part.getAttribute("201.3.1_данные").getValue());

        attribute.setValue(m_part.getAttribute("101.10.1_данные").getValue()).
                      plus(m_part.getAttribute("104.2.1_данные").getValue()).
                      plus(m_part.getAttribute("104.3.1_данные").getValue()).
                      plus(m_part.getAttribute("201.2.1_данные").getValue()).
                      plus(m_part.getAttribute("201.3.1_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_NV_BK(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма_НВ - ((Сумма_БК * 10) / 100))");
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК", m_part.getAttribute("Сумма_БК").getValue());

        attrSum1.setValue(m_part.getAttribute("Сумма_БК").getValue()).
                 multiply(10).
                      div(100);

        attribute.setValue(m_part.getAttribute("Сумма_НВ").getValue()).
                     minus(attrSum1.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.2.1_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.2.1_данные", m_part.getAttribute("104.2.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("104.2.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.2.1_данные * Коэф_НВ_104.2.1)");
            m_protocolView.printLineValueInfo("104.2.1_данные", m_part.getAttribute("104.2.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.2.1", m_part.getAttribute("Коэф_НВ_104.2.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.2.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.2.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.2.1 + 104.2.2");
        m_protocolView.printLineValueInfo("104.2.1", m_part.getAttribute("104.2.1").getValue());
        m_protocolView.printLineValueInfo("104.2.2", m_part.getAttribute("104.2.2").getValue());

        attribute.setValue(m_part.getAttribute("104.2.1").getValue()).
                      plus(m_part.getAttribute("104.2.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.3.1_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.3.1_данные", m_part.getAttribute("104.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("104.3.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.1_данные * Коэф_НВ_104.3.1)");
            m_protocolView.printLineValueInfo("104.3.1_данные", m_part.getAttribute("104.3.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.1", m_part.getAttribute("Коэф_НВ_104.3.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.3.1 + 104.3.2");
        m_protocolView.printLineValueInfo("104.3.1", m_part.getAttribute("104.3.1").getValue());
        m_protocolView.printLineValueInfo("104.3.2", m_part.getAttribute("104.3.2").getValue());

        attribute.setValue(m_part.getAttribute("104.3.1").getValue()).
                      plus(m_part.getAttribute("104.3.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.3.1.1_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.3.1.1_данные", m_part.getAttribute("104.3.1.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                 multiply(m_part.getAttribute("104.3.1.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.1.1_данные * Коэф_НВ_104.3.1.1)");
            m_protocolView.printLineValueInfo("104.3.1.1_данные", m_part.getAttribute("104.3.1.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.1.1", m_part.getAttribute("Коэф_НВ_104.3.1.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.1.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.1.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_101_10_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 101.10.1_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("101.10.1_данные", m_part.getAttribute("101.10.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                  multiply(m_part.getAttribute("101.10.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (101.10.1_данные * Коэф_НВ_101.10.1)");
            m_protocolView.printLineValueInfo("101.10.1_данные", m_part.getAttribute("101.10.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_101.10.1", m_part.getAttribute("Коэф_НВ_101.10.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("101.10.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_101.10.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_BK_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.7 - (101.1 + 101.2 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10.1)");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.1").getValue()).
                     minus(m_part.getAttribute("101.2").getValue()).
                     minus(m_part.getAttribute("101.4").getValue()).
                     minus(m_part.getAttribute("101.5").getValue()).
                     minus(m_part.getAttribute("101.6").getValue()).
                     minus(m_part.getAttribute("101.7").getValue()).
                     minus(m_part.getAttribute("101.8").getValue()).
                     minus(m_part.getAttribute("101.9").getValue()).
                     minus(m_part.getAttribute("101.10.1").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_1_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLine("Сумма2:");
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").isTermDelay(" > 30");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLine("Сумма2:");
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLine("Сумма2:");

        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.7.4_202.2 * K2");
        m_protocolView.printLineValueInfo("201.7.4_202.2", m_part.getAttribute("201.7.4_202.2").getValue());
        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.setValue(m_part.getAttribute("201.7.4_202.2").getValue()).
                  multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLine("Сумма1:");
        tempFilter.op("(").isSatisfiesToBalanceMasks("60701*").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op(")").op("OR").op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_ОС")).op("AND NOT").isSatisfiesToBalanceMasks("60701*").op(")");
        sum = m_dataSourceAcc.getData(tempFilter);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.op("AND").add(tempFilter);
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[2] = sum;

        m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        tempVal[3] = m_part.getAttribute("201.7.5_202.3.1_имущество").getValue();
        attrSum1.minus(tempVal[3]);

        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " - " + tempVal[3] + " = " + attrSum1.getValue());

        tempVal.size = 0;

        m_protocolView.printLine("Сумма2 = 100.7 + 103.5 + 200.9 - (200.7 + 200.8) - 104.7 - (201.7.1 + 201.7.2 + 201.7.3) - (101.8 + 101.9)");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("103.5", m_part.getAttribute("103.5").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("104.7", m_part.getAttribute("104.7").getValue());
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("201.7.2", m_part.getAttribute("201.7.2").getValue());
        m_protocolView.printLineValueInfo("201.7.3", m_part.getAttribute("201.7.3").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());

        attrSum2.setValue(m_part.getAttribute("100.7").getValue()).
                     plus(m_part.getAttribute("103.5").getValue()).
                     plus(m_part.getAttribute("200.9").getValue()).
                    minus(m_part.getAttribute("200.7").getValue()).
                    minus(m_part.getAttribute("200.8").getValue()).
                    minus(m_part.getAttribute("104.7").getValue()).
                    minus(m_part.getAttribute("201.7.1").getValue()).
                    minus(m_part.getAttribute("201.7.2").getValue()).
                    minus(m_part.getAttribute("201.7.3").getValue()).
                    minus(m_part.getAttribute("101.8").getValue()).
                    minus(m_part.getAttribute("101.9").getValue());

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.8"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.plus(sum);

        if (attrSum2.getValue() >= 0)
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 >= 0!");

            attribute.setValue(attrSum1.getValue()).
                         minus(attrSum2.getValue());
            if (attribute.getValue() >= 0)
                m_protocolView.printSummValueInfo("Сумма2", attribute.getValue());
                m_protocolView.printString("Значение Сумма1 - Сумма2 >= 0!");

                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
                m_protocolView.printParamValue("K2", global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue(attrSum1.getValue());
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 < 0!");

            if (attribute.getValue() > 0)
                m_protocolView.printSummValueInfo("Сумма1", attrSum2.getValue());
                m_protocolView.printString("Значение Сумма1 > 0!");
                m_protocolView.printAlg(attributeId, "Сумма1 * K2");
                attribute.multiply(global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.7.1 + 201.7.2 + 201.7.3 + 201.7.4 + Стро-ка_201.7.5 + 201.7.6");
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("201.7.2", m_part.getAttribute("201.7.2").getValue());
        m_protocolView.printLineValueInfo("201.7.3", m_part.getAttribute("201.7.3").getValue());
        m_protocolView.printLineValueInfo("201.7.4", m_part.getAttribute("201.7.4").getValue());
        m_protocolView.printLineValueInfo("201.7.5", m_part.getAttribute("201.7.5").getValue());
        m_protocolView.printLineValueInfo("201.7.6", m_part.getAttribute("201.7.6").getValue());

        attribute.plus(m_part.getAttribute("201.7.1").getValue()).
                  plus(m_part.getAttribute("201.7.2").getValue()).
                  plus(m_part.getAttribute("201.7.3").getValue()).
                  plus(m_part.getAttribute("201.7.4").getValue()).
                  plus(m_part.getAttribute("201.7.5").getValue()).
                  plus(m_part.getAttribute("201.7.6").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.1 + 201.2 + 201.3 + 201.4 + 201.5 + 201.7");
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());
        m_protocolView.printLineValueInfo("201.4", m_part.getAttribute("201.4").getValue());
        m_protocolView.printLineValueInfo("201.5", m_part.getAttribute("201.5").getValue());
        m_protocolView.printLineValueInfo("201.7", m_part.getAttribute("201.7").getValue());

        attribute.plus(m_part.getAttribute("201.1").getValue()).
                  plus(m_part.getAttribute("201.2").getValue()).
                  plus(m_part.getAttribute("201.3").getValue()).
                  plus(m_part.getAttribute("201.4").getValue()).
                  plus(m_part.getAttribute("201.5").getValue()).
                  plus(m_part.getAttribute("201.7").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").isTermDelay(" > 30");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);
        m_protocolView.printLine("Сумма2:");
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.7.4_202.2 * K1");
        m_protocolView.printLineValueInfo("201.7.4_202.2", m_part.getAttribute("201.7.4_202.2").getValue());
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.plus(m_part.getAttribute("201.7.4_202.2").getValue()).
              multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_IST_SS(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.7 + 103.5 + 200.9 - (103.3 + 103.4 + 200.7 + 200.8) - (101.1 + 101.2 + 101.3 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10 + 101.12 + 101.13) - (104.1 + 104.2 + 104.3 + 104.5 + 104.6) - (201.1 + 201.2 + 201.3) + Сумма1");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("103.5", m_part.getAttribute("103.5").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("103.3", m_part.getAttribute("103.3").getValue());
        m_protocolView.printLineValueInfo("103.4", m_part.getAttribute("103.4").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10", m_part.getAttribute("101.10").getValue());
        m_protocolView.printLineValueInfo("101.12", m_part.getAttribute("101.12").getValue());
        m_protocolView.printLineValueInfo("101.13", m_part.getAttribute("101.13").getValue());
        m_protocolView.printLineValueInfo("104.1", m_part.getAttribute("104.1").getValue());
        m_protocolView.printLineValueInfo("104.2", m_part.getAttribute("104.2").getValue());
        m_protocolView.printLineValueInfo("104.3", m_part.getAttribute("104.3").getValue());
        m_protocolView.printLineValueInfo("104.5", m_part.getAttribute("104.5").getValue());
        m_protocolView.printLineValueInfo("104.6", m_part.getAttribute("104.6").getValue());
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());

        attribute.plus(m_part.getAttribute("100.7").getValue()).
                  plus(m_part.getAttribute("103.5").getValue()).
                  plus(m_part.getAttribute("200.9").getValue()).
                 minus(m_part.getAttribute("103.3").getValue()).
                 minus(m_part.getAttribute("103.4").getValue()).
                 minus(m_part.getAttribute("200.7").getValue()).
                 minus(m_part.getAttribute("200.8").getValue()).
                 minus(m_part.getAttribute("101.1").getValue()).
                 minus(m_part.getAttribute("101.2").getValue()).
                 minus(m_part.getAttribute("101.3").getValue()).
                 minus(m_part.getAttribute("101.4").getValue()).
                 minus(m_part.getAttribute("101.5").getValue()).
                 minus(m_part.getAttribute("101.6").getValue()).
                 minus(m_part.getAttribute("101.7").getValue()).
                 minus(m_part.getAttribute("101.8").getValue()).
                 minus(m_part.getAttribute("101.9").getValue()).
                 minus(m_part.getAttribute("101.10").getValue()).
                 minus(m_part.getAttribute("101.12").getValue()).
                 minus(m_part.getAttribute("101.13").getValue()).
                 minus(m_part.getAttribute("104.1").getValue()).
                 minus(m_part.getAttribute("104.2").getValue()).
                 minus(m_part.getAttribute("104.3").getValue()).
                 minus(m_part.getAttribute("104.5").getValue()).
                 minus(m_part.getAttribute("104.6").getValue()).
                 minus(m_part.getAttribute("201.1").getValue()).
                 minus(m_part.getAttribute("201.2").getValue()).
                 minus(m_part.getAttribute("201.3").getValue());

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10601*");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.plus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ п. 4.2.2 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ п. 4.2.2 395-П'");
        sum = m_dataSourceAcc.getData(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.setValue(sum);

        m_protocolView.printLine("Сумма2:");
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.1_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.1_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.5.1_данные - 100.5.1_итог_ПФИ");
        m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
        m_protocolView.printLineValueInfo("100.5.1_итог_ПФИ", m_part.getAttribute("100.5.1_итог_ПФИ").getValue());

        attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue()).
                     minus(m_part.getAttribute("100.5.1_итог_ПФИ").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_доп").getValue() < 0)
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_доп < 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_доп * (-1)");
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());

            attribute.setValue(m_part.getAttribute("200.5.1_доп").getValue());
            attribute.multiply(-1);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_доп > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_доп / 100 * K4");
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());
            m_protocolView.printParamValue("K4", global.parameters.getK4());

                attribute.setValue(m_part.getAttribute("200.5.1_доп").getValue()).
                               div(100).
                          multiply(global.parameters.getK4());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1г").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1г", m_part.getAttribute("200.5.1г").getValue());
            m_protocolView.printString("Значение переменной 200.5.1г > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1г");
            m_protocolView.printLineValueInfo("200.5.1г", m_part.getAttribute("200.5.1г").getValue());

                attribute.setValue(m_part.getAttribute("200.5.1г").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1в").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1в", m_part.getAttribute("200.5.1в").getValue());
            m_protocolView.printString("Значение переменной 200.5.1в > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1в");
            m_protocolView.printLineValueInfo("200.5.1в", m_part.getAttribute("200.5.1в").getValue());

                attribute.setValue(m_part.getAttribute("200.5.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_TOTAL_PFI(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_данные").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_данные > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_данные / 100 * K4");
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
            m_protocolView.printParamValue("K4", global.parameters.getK4());
                attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue()).
                               div(100).
                          multiply(global.parameters.getK4());

        elif (m_part.getAttribute("200.5.1_данные").getValue() < 0)
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_данные < 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_данные  * (-1)");
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());

                attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue()).
                          multiply(-1);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.5.2")
            m_protocolView.printAlg(attributeId, "200.5.2.1 + 200.5.2.2 + 200.5.2.3 + 200.5.2.4");
            m_protocolView.printLineValueInfo("200.5.2.1", m_part.getAttribute("200.5.2.1").getValue());
            m_protocolView.printLineValueInfo("200.5.2.2", m_part.getAttribute("200.5.2.2").getValue());
            m_protocolView.printLineValueInfo("200.5.2.3", m_part.getAttribute("200.5.2.3").getValue());
            m_protocolView.printLineValueInfo("200.5.2.4", m_part.getAttribute("200.5.2.4").getValue());

            attribute.setValue(m_part.getAttribute("200.5.2.1").getValue()).
                          plus(m_part.getAttribute("200.5.2.2").getValue()).
                          plus(m_part.getAttribute("200.5.2.3").getValue()).
                          plus(m_part.getAttribute("200.5.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
            m_protocolView.printString("Значение переменной 200.5 > 0!");
            m_protocolView.printAlg(attributeId, "200.5.3_данные - 100.5.3");
            m_protocolView.printLineValueInfo("200.5.3_данные", m_part.getAttribute("200.5.3_данные").getValue());
            m_protocolView.printLineValueInfo("100.5.3", m_part.getAttribute("100.5.3").getValue());

                attribute.setValue(m_part.getAttribute("200.5.3_данные").getValue()).
                             minus(m_part.getAttribute("100.5.3").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.6.2")
            m_protocolView.printAlg(attributeId, "200.6.2.1 + 200.6.2.2 + 200.6.2.3 + 200.6.2.4");
            m_protocolView.printLineValueInfo("200.6.2.1", m_part.getAttribute("200.6.2.1").getValue());
            m_protocolView.printLineValueInfo("200.6.2.2", m_part.getAttribute("200.6.2.2").getValue());
            m_protocolView.printLineValueInfo("200.6.2.3", m_part.getAttribute("200.6.2.3").getValue());
            m_protocolView.printLineValueInfo("200.6.2.4", m_part.getAttribute("200.6.2.4").getValue());

            attribute.setValue(m_part.getAttribute("200.6.2.1").getValue()).
                          plus(m_part.getAttribute("200.6.2.2").getValue()).
                          plus(m_part.getAttribute("200.6.2.3").getValue()).
                          plus(m_part.getAttribute("200.6.2.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за ДООП - 200.6.2_доп - 100.6");
        m_protocolView.printLineValueInfo("Прибыль прошлых лет за ДООП", m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue());
        m_protocolView.printLineValueInfo("200.6.2_доп", m_part.getAttribute("200.6.2_доп").getValue());
        m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());

        attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue()).
                      minus(m_part.getAttribute("200.6.2_доп").getValue()).
                      minus(m_part.getAttribute("100.6").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_G(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");

            if (m_part.getAttribute("200.6.1_доп").getValue() < 0)
                m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
                m_protocolView.printString("Значение переменной 200.6.1_доп > 0!");
                m_protocolView.printAlg(attributeId, "200.6.1_доп * (-1)");

                attribute.setValue(m_part.getAttribute("200.6.1_доп").getValue());
                attribute.multiply(-1);
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_V(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");

            if (m_part.getAttribute("200.6.1_доп").getValue() > 0)
                m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
                m_protocolView.printString("Значение переменной 200.6.1_доп > 0!");
                m_protocolView.printAlg(attributeId, "200.6.1_доп / 100 * K4");
                m_protocolView.printParamValue("K4", global.parameters.getK4());

                attribute.setValue(m_part.getAttribute("200.6.1_доп").getValue()).
                               div(100).
                          multiply(global.parameters.getK4());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_B(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6.1").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6.1", m_part.getAttribute("200.6.1").getValue());
            m_protocolView.printString("Значение переменной 200.6.1 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.1");

            attribute.setValue(m_part.getAttribute("200.6.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_A(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6.1в").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6.1в", m_part.getAttribute("200.6.1в").getValue());
            m_protocolView.printString("Значение переменной 200.6.1в > 0!");
            m_protocolView.printAlg(attributeId, "200.6.1в");

            attribute.setValue(m_part.getAttribute("200.6.1в").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.6.1_ПФИ_707 + 200.6.1_ПФИ_108_109_708 - Стро-ка_100.6.1_доп");
        m_protocolView.printLineValueInfo("200.6.1_ПФИ_707", m_part.getAttribute("200.6.1_ПФИ_707").getValue());
        m_protocolView.printLineValueInfo("200.6.1_ПФИ_108_109_708", m_part.getAttribute("200.6.1_ПФИ_108_109_708").getValue());
        m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());

        attribute.setValue(m_part.getAttribute("200.6.1_ПФИ_707").getValue()).
                      plus(m_part.getAttribute("200.6.1_ПФИ_108_109_708").getValue()).
                     minus(m_part.getAttribute("100.6.1_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.2_доп");

            attribute.setValue(m_part.getAttribute("200.6.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.3_доп - 100.6.3");
            m_protocolView.printLineValueInfo("200.6.3_доп", m_part.getAttribute("200.6.3_доп").getValue());
            m_protocolView.printLineValueInfo("100.6.3", m_part.getAttribute("100.6.3").getValue());

            attribute.setValue(m_part.getAttribute("200.6.3_доп").getValue()).
                             minus(m_part.getAttribute("100.6.3").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        sum = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc);

        m_protocolView.printParamValue("K3", global.parameters.getK3());

        attribute.setValue(sum).
                  multiply(global.parameters.getK3());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        sum = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc);

        m_protocolView.printParamValue("K3", global.parameters.getK3());

        attribute.setValue(sum).
                  multiply(global.parameters.getK3());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + 200.7.1 + 200.7.2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        sum = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc);

        m_protocolView.printLineValueInfo("200.7.1", m_part.getAttribute("200.7.1").getValue());
        m_protocolView.printLineValueInfo("200.7.2", m_part.getAttribute("200.7.2").getValue());

        attribute.setValue(sum).
                      plus(m_part.getAttribute("200.7.1").getValue()).
                      plus(m_part.getAttribute("200.7.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.getDateRevaluation() <= rcbApplication().currentReport.context.period.endDate)
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getDateRevaluation());
            attribute.setValue(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_9(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.1 + 200.2 + 200.3 + 200.4 + 200.5 + 200.6 + 200.7 + 200.8");
        m_protocolView.printLineValueInfo("200.1", m_part.getAttribute("200.1").getValue());
        m_protocolView.printLineValueInfo("200.2", m_part.getAttribute("200.2").getValue());
        m_protocolView.printLineValueInfo("200.3", m_part.getAttribute("200.3").getValue());
        m_protocolView.printLineValueInfo("200.4", m_part.getAttribute("200.4").getValue());
        m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
        m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());

        attribute.setValue(m_part.getAttribute("200.1").getValue()).
                      plus(m_part.getAttribute("200.2").getValue()).
                      plus(m_part.getAttribute("200.3").getValue()).
                      plus(m_part.getAttribute("200.4").getValue()).
                      plus(m_part.getAttribute("200.5").getValue()).
                      plus(m_part.getAttribute("200.6").getValue()).
                      plus(m_part.getAttribute("200.7").getValue()).
                      plus(m_part.getAttribute("200.8").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.9 - 201.7.1");
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());

        attribute.setValue(m_part.getAttribute("200.9").getValue()).
                      minus(m_part.getAttribute("201.7.1").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.7.1 + 104.7.2 + 104.7.3 + 104.7.4 + Стро-ка_104.7.5");
        m_protocolView.printLineValueInfo("104.7.1", m_part.getAttribute("104.7.1").getValue());
        m_protocolView.printLineValueInfo("104.7.2", m_part.getAttribute("104.7.2").getValue());
        m_protocolView.printLineValueInfo("104.7.3", m_part.getAttribute("104.7.3").getValue());
        m_protocolView.printLineValueInfo("104.7.4", m_part.getAttribute("104.7.4").getValue());
        m_protocolView.printLineValueInfo("104.7.5", m_part.getAttribute("104.7.5").getValue());

        attribute.setValue(m_part.getAttribute("104.7.1").getValue()).
                      plus(m_part.getAttribute("104.7.2").getValue()).
                      plus(m_part.getAttribute("104.7.3").getValue()).
                      plus(m_part.getAttribute("104.7.4").getValue()).
                      plus(m_part.getAttribute("104.7.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.1.1 + 201.1.2 + 201.1.3");
        m_protocolView.printLineValueInfo("201.1.1", m_part.getAttribute("201.1.1").getValue());
        m_protocolView.printLineValueInfo("201.1.2", m_part.getAttribute("201.1.2").getValue());
        m_protocolView.printLineValueInfo("201.1.3", m_part.getAttribute("201.1.3").getValue());

        attribute.setValue(m_part.getAttribute("201.1.1").getValue()).
                      plus(m_part.getAttribute("201.1.2").getValue()).
                      plus(m_part.getAttribute("201.1.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.2.1_данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.2.1_данные", m_part.getAttribute("201.2.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0 )
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("201.2.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.2.1_данные * Коэф_НВ_201.2.1");
            m_protocolView.printLineValueInfo("201.2.1_данные", m_part.getAttribute("201.2.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.2.1", m_part.getAttribute("Коэф_НВ_201.2.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.2.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.2.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.2.1 + 201.2.2");
        m_protocolView.printLineValueInfo("201.2.1", m_part.getAttribute("201.2.1").getValue());
        m_protocolView.printLineValueInfo("201.2.2", m_part.getAttribute("201.2.2").getValue());

        attribute.setValue(m_part.getAttribute("201.2.1").getValue()).
                      plus(m_part.getAttribute("201.2.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.3.1_данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.3.1_данные", m_part.getAttribute("201.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("201.3.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.3.1_данные * Коэф_НВ_201.3.1");
            m_protocolView.printLineValueInfo("201.3.1_данные", m_part.getAttribute("201.3.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.1", m_part.getAttribute("Коэф_НВ_201.3.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.3.1.1_Данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.3.1.1_Данные", m_part.getAttribute("201.3.1.1_Данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                 multiply(m_part.getAttribute("201.3.1.1_Данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.3.1.1_Данные * Коэф_НВ_201.3.1.1");
            m_protocolView.printLineValueInfo("201.3.1.1_Данные", m_part.getAttribute("201.3.1.1_Данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.1.1", m_part.getAttribute("Коэф_НВ_201.3.1.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1.1_Данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.3.1 + 201.3.2");
        m_protocolView.printLineValueInfo("201.3.1", m_part.getAttribute("201.3.1").getValue());
        m_protocolView.printLineValueInfo("201.3.2", m_part.getAttribute("201.3.2").getValue());

        attribute.setValue(m_part.getAttribute("201.3.1").getValue()).
                      plus(m_part.getAttribute("201.3.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3_ист_СС").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());
            m_protocolView.printString("Значение переменной 202.3_ист_СС > 0!");
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");
            tempFilter.op("(").isSatisfiesToBalanceMasks("60701*").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op(")").op("OR").op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС")).op("AND NOT").isSatisfiesToBalanceMasks("60701*").op(")");
            sum = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация"));
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(sum).
                      minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        else
            m_dataSourceFilterAcc.clear();
            tempFilter.clear();
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");

            tempFilter.op("(").isSatisfiesToBalanceMasks("60701*").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op(")").op("OR").op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС_1")).op("AND NOT").isSatisfiesToBalanceMasks("60701*").op(")");
            sum = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация_1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Амортизация ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Амортизация ОС'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(sum).
                     minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3.1_данные + 202.3.2_данные + 202.3.3_данные");
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());

        attribute.setValue(m_part.getAttribute("202.3.1_данные").getValue()).
                      plus(m_part.getAttribute("202.3.2_данные").getValue()).
                      plus(m_part.getAttribute("202.3.3_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3_ист_СС").getValue() >= 0)
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());
            m_protocolView.printString("Значение переменной 202.3_ист_СС >= 0!");
            m_protocolView.printAlg(attributeId, "(202.3_данные - 202.3_ист_СС) * K1");
            m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                         minus(m_part.getAttribute("202.3_ист_СС").getValue()).
                      multiply(global.parameters.getK1());

            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

                attribute.setValue($0.0);
            end;
        else
            if (m_part.getAttribute("202.3_данные").getValue() >= 0)
                m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
                m_protocolView.printString("Значение переменной 202.3_данные >= 0!");
                m_protocolView.printAlg(attributeId, "202.3_данные * K1");
                m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
                m_protocolView.printParamValue("K1", global.parameters.getK1());

                attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                          multiply(global.parameters.getK1());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_K_202_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3_данные / 202.3.1_данные");
        m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());

        if (m_part.getAttribute("202.3.1_данные").getValue() > 0)
            attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                         div(m_part.getAttribute("202.3.1_данные").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной 202.3 > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.1");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.1", m_part.getAttribute("К_202.3.1").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_K_202_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3_данные / 202.3.2_данные");
        m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());

        if (m_part.getAttribute("202.3.2_данные").getValue() > 0)
            attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                         div(m_part.getAttribute("202.3.2_данные").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной 202.3 > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.2");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.2", m_part.getAttribute("К_202.3.2").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_K_202_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3_данные / 202.3.3_данные");
        m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());

        if (m_part.getAttribute("202.3.3_данные").getValue() > 0)
            attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                         div(m_part.getAttribute("202.3.3_данные").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной  > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.3");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.3", m_part.getAttribute("К_202.3.3").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.3").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.1 + 202.2 + 202.3 + 202.4");
        m_protocolView.printLineValueInfo("202.1", m_part.getAttribute("202.1").getValue());
        m_protocolView.printLineValueInfo("202.2", m_part.getAttribute("202.2").getValue());
        m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
        m_protocolView.printLineValueInfo("202.4", m_part.getAttribute("202.4").getValue());

        attribute.setValue(m_part.getAttribute("202.1").getValue()).
                      plus(m_part.getAttribute("202.2").getValue()).
                      plus(m_part.getAttribute("202.3").getValue()).
                      plus(m_part.getAttribute("202.4").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_203(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.9 - 201.8 - 202.5");
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("201.8", m_part.getAttribute("201.8").getValue());
        m_protocolView.printLineValueInfo("202.5", m_part.getAttribute("202.5").getValue());

        attribute.setValue(m_part.getAttribute("200.9").getValue()).
                     minus(m_part.getAttribute("201.8").getValue()).
                     minus(m_part.getAttribute("202.5").getValue());

        if (attribute.getValue() <= 0)
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("201.8", m_part.getAttribute("201.8").getValue());
        m_protocolView.printLineValueInfo("202.5", m_part.getAttribute("202.5").getValue());

        attribute.setValue(m_part.getAttribute("200.9").getValue()).
                     minus(m_part.getAttribute("201.8").getValue()).
                     minus(m_part.getAttribute("202.5").getValue());

        if (attribute.getValue() >= 0)
            m_protocolView.printString("Значение 200.9 - (201.8 + 202.5) >= 0!");

            attribute.setValue($0.0);
        else
            if (m_part.getAttribute("104.7.5").getValue() > 0)
                m_protocolView.printLineValueInfo("104.7.5", m_part.getAttribute("104.7.5").getValue());
                m_protocolView.printString("Значение переменной 104.7.5 > 0!");
                m_protocolView.printAlg(attributeId, "(201.8 - 201.7.1 + 202.5) - 200.9");
                m_protocolView.printLineValueInfo("201.8", m_part.getAttribute("201.8").getValue());
                m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
                m_protocolView.printLineValueInfo("202.5", m_part.getAttribute("202.5").getValue());
                m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());

                attribute.setValue(m_part.getAttribute("201.8").getValue()).
                             minus(m_part.getAttribute("201.7.1").getValue()).
                             plus(m_part.getAttribute("202.5").getValue()).
                             minus(m_part.getAttribute("200.9").getValue());
            elif (m_part.getAttribute("104.7.5").getValue() == 0)
                m_protocolView.printLineValueInfo("104.7.5", m_part.getAttribute("104.7.5").getValue());
                m_protocolView.printString("Значение переменной 104.7.5 = 0!");
                m_protocolView.printAlg(attributeId, "(201.8 + 202.5) - 200.9");
                m_protocolView.printLineValueInfo("201.8", m_part.getAttribute("201.8").getValue());
                m_protocolView.printLineValueInfo("202.5", m_part.getAttribute("202.5").getValue());
                m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());

                attribute.setValue(m_part.getAttribute("201.8").getValue()).
                             plus(m_part.getAttribute("202.5").getValue()).
                             minus(m_part.getAttribute("200.9").getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "104.1 + 104.2 + 104.3 + 104.4 + 104.5 + 104.6 + 104.7");
        m_protocolView.printLineValueInfo("104.1", m_part.getAttribute("104.1").getValue());
        m_protocolView.printLineValueInfo("104.2", m_part.getAttribute("104.2").getValue());
        m_protocolView.printLineValueInfo("104.3", m_part.getAttribute("104.3").getValue());
        m_protocolView.printLineValueInfo("104.4", m_part.getAttribute("104.4").getValue());
        m_protocolView.printLineValueInfo("104.5", m_part.getAttribute("104.5").getValue());
        m_protocolView.printLineValueInfo("104.6", m_part.getAttribute("104.6").getValue());
        m_protocolView.printLineValueInfo("104.7", m_part.getAttribute("104.7").getValue());

        attribute.setValue(m_part.getAttribute("104.1").getValue()).
                      plus(m_part.getAttribute("104.2").getValue()).
                      plus(m_part.getAttribute("104.3").getValue()).
                      plus(m_part.getAttribute("104.4").getValue()).
                      plus(m_part.getAttribute("104.5").getValue()).
                      plus(m_part.getAttribute("104.6").getValue()).
                      plus(m_part.getAttribute("104.7").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_105(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "103.5 + 104.8");
        m_protocolView.printLineValueInfo("103.5", m_part.getAttribute("103.5").getValue());
        m_protocolView.printLineValueInfo("104.8", m_part.getAttribute("104.8").getValue());

        attribute.setValue(m_part.getAttribute("103.5").getValue()).
                     minus(m_part.getAttribute("104.8").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_11(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.8 - 103.5");
        m_protocolView.printLineValueInfo("104.8", m_part.getAttribute("104.8").getValue());
        m_protocolView.printLineValueInfo("103.5", m_part.getAttribute("103.5").getValue());

        attribute.setValue(m_part.getAttribute("104.8").getValue()).
                     minus(m_part.getAttribute("103.5").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_14(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.1 + 101.2 + 101.3 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10 + 101.11 + 101.12 + 101.13");
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10", m_part.getAttribute("101.10").getValue());
        m_protocolView.printLineValueInfo("101.11", m_part.getAttribute("101.11").getValue());
        m_protocolView.printLineValueInfo("101.12", m_part.getAttribute("101.12").getValue());
        m_protocolView.printLineValueInfo("101.13", m_part.getAttribute("101.13").getValue());

        attribute.setValue(m_part.getAttribute("101.1").getValue()).
                      plus(m_part.getAttribute("101.2").getValue()).
                      plus(m_part.getAttribute("101.3").getValue()).
                      plus(m_part.getAttribute("101.4").getValue()).
                      plus(m_part.getAttribute("101.5").getValue()).
                      plus(m_part.getAttribute("101.6").getValue()).
                      plus(m_part.getAttribute("101.7").getValue()).
                      plus(m_part.getAttribute("101.8").getValue()).
                      plus(m_part.getAttribute("101.9").getValue()).
                      plus(m_part.getAttribute("101.10").getValue()).
                      plus(m_part.getAttribute("101.11").getValue()).
                      plus(m_part.getAttribute("101.12").getValue()).
                      plus(m_part.getAttribute("101.13").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_102(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.7 - 101.14");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.14", m_part.getAttribute("101.14").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.14").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_106(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "102 + 105");
        m_protocolView.printLineValueInfo("102", m_part.getAttribute("102").getValue());
        m_protocolView.printLineValueInfo("105", m_part.getAttribute("105").getValue());

        attribute.setValue(m_part.getAttribute("102").getValue()).
                      plus(m_part.getAttribute("105").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_000(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "106 + 203");
        m_protocolView.printLineValueInfo("106", m_part.getAttribute("106").getValue());
        m_protocolView.printLineValueInfo("203", m_part.getAttribute("203").getValue());

        attribute.setValue(m_part.getAttribute("106").getValue()).
                      plus(m_part.getAttribute("203").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 200.5_дисконт + 200.5.1_итог_ПФИ + 200.5.3_данные - 200.5.2_данные");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Расходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printLineValueInfo("200.5_дисконт", m_part.getAttribute("200.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("200.5.1_итог_ПФИ", m_part.getAttribute("200.5.1_итог_ПФИ").getValue());
        m_protocolView.printLineValueInfo("200.5.3_данные", m_part.getAttribute("200.5.3_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(m_part.getAttribute("200.5_дисконт").getValue()).
                      plus(m_part.getAttribute("200.5.1_итог_ПФИ").getValue()).
                      plus(m_part.getAttribute("200.5.3_данные").getValue()).
                     minus(m_part.getAttribute("200.5.2_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.5_данные - 100.5");
        m_protocolView.printLineValueInfo("200.5_данные", m_part.getAttribute("200.5_данные").getValue());
        m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());

        attribute.setValue(m_part.getAttribute("200.5_данные").getValue()).
                     minus(m_part.getAttribute("100.5").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
            m_protocolView.printString("Значение переменной 200.5 > 0!");
            m_protocolView.printAlg(attributeId, "200.5.2_данные");
            m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());

            attribute.setValue(m_part.getAttribute("200.5.2_данные").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "106 + 200.9 - (201.1 + 201.2 + 201.3 + 201.4 + 201.5)");
        m_protocolView.printLineValueInfo("106", m_part.getAttribute("106").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());
        m_protocolView.printLineValueInfo("201.4", m_part.getAttribute("201.4").getValue());
        m_protocolView.printLineValueInfo("201.5", m_part.getAttribute("201.5").getValue());

        attribute.setValue(m_part.getAttribute("106").getValue()).
                      plus(m_part.getAttribute("200.9").getValue()).
                     minus(m_part.getAttribute("201.1").getValue()).
                     minus(m_part.getAttribute("201.2").getValue()).
                     minus(m_part.getAttribute("201.3").getValue()).
                     minus(m_part.getAttribute("201.4").getValue()).
                     minus(m_part.getAttribute("201.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro fillTempTables()
        m_dataSourceAcc.cacheData();
        m_dataSourceDoc.cacheData();
    end;

    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

       if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;

        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_G("101.8.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_V("101.8.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_B("101.8.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_A("101.8.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_1("101.8.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_2("101.8.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_1("101.8.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_2("101.8.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_1("101.9.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_2("101.9.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_1("101.9.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_2("101.9.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_G("100.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_V("100.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_B("100.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_A("100.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_TOTAL_PFI("100.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_1("100.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_2("100.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_1("100.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_2("100.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_G("100.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_V("100.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_B("100.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_A("100.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_1("100.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_1("100.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_V("101.9.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_G("101.9.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_B("101.9.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_A("101.9.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_1("200.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_2("200.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_1("200.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_2("200.6.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_G("200.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_V("200.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_B("200.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_A("200.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_1("200.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_2("200.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_1("200.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_2("200.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_G("200.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_V("200.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_B("200.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_A("200.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;

    constructorTF123PartCalculateController(reportCalculateController, partId);
end;

class (TF123PartCalculateController) TF123PartCalculateController_3377(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController(reportCalculateController, partId);

    private macro calculateLine_100_1_2_before032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K3");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            else
                m_protocolView.printAlg(attributeId, "Сумма * K3");
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_2_after032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2)");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.1.2_до_03.2013 + 100.1.2_с_03.2013");
        m_protocolView.printLineValueInfo("100.1.2_до_03.2013", m_part.getAttribute("100.1.2_до_03.2013").getValue());
        m_protocolView.printLineValueInfo("100.1.2_с_03.2013", m_part.getAttribute("100.1.2_с_03.2013").getValue());

        attribute.plus(m_part.getAttribute("100.1.2_до_03.2013").getValue()).
                  plus(m_part.getAttribute("100.1.2_с_03.2013").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_2_before032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K3");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            else
                m_protocolView.printAlg(attributeId, "Сумма * K3");
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ до 01.03.2013'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);

                attribute.multiply(global.parameters.getK3());
                m_protocolView.printParamValue("K3", global.parameters.getK3());
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_2_after032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2)");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.2.1.2_до_03.2013 + 100.2.1.2_с_03.2013");
        m_protocolView.printLineValueInfo("100.2.1.2_до_03.2013", m_part.getAttribute("100.2.1.2_до_03.2013").getValue());
        m_protocolView.printLineValueInfo("100.2.1.2_с_03.2013", m_part.getAttribute("100.2.1.2_с_03.2013").getValue());

        attribute.plus(m_part.getAttribute("100.2.1.2_до_03.2013").getValue()).
                  plus(m_part.getAttribute("100.2.1.2_с_03.2013").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_G("101.8.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_V("101.8.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_B("101.8.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_A("101.8.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_1("101.8.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_2("101.8.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_1("101.8.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_2("101.8.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_1("101.9.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_2("101.9.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_1("101.9.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_2("101.9.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_G("100.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_V("100.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_B("100.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_A("100.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_TOTAL_PFI("100.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_1("100.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_2("100.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_1("100.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_2("100.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_G("100.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_V("100.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_B("100.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_A("100.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_1("100.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_1("100.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_V("101.9.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_G("101.9.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_B("101.9.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_A("101.9.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_1("200.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_2("200.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_1("200.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_2("200.6.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_G("200.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_V("200.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_B("200.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_A("200.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_1("200.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_2("200.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_1("200.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_2("200.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_G("200.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_V("200.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_B("200.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_A("200.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;

end;

class (TF123PartCalculateController_3377) TF123PartCalculateController_3643(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_3377(reportCalculateController, partId);

    private macro calculateLine_100_2_1_2_after032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2)");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_2_after032013(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2)");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND ( ").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА по 173-ФЗ с 01.03.2013'").op("OR").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'").op(")");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SHARESTYPE, "'ПА, оплаченные АСВ'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_G("101.8.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_V("101.8.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_B("101.8.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_A("101.8.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_1("101.8.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1_2("101.8.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_1("101.8.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2_2("101.8.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_1("101.9.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1_2("101.9.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_1("101.9.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2_2("101.9.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_G("100.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_V("100.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_B("100.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_A("100.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_TOTAL_PFI("100.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_1("100.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_2("100.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_1("100.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_2("100.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_G("100.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_V("100.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_B("100.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_A("100.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_1("100.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_1("100.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2_2("100.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_V("101.9.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_G("101.9.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_B("101.9.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_A("101.9.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_1("200.6.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1_2("200.6.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_1("200.6.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2_2("200.6.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_G("200.5.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_V("200.5.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_B("200.5.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_A("200.5.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_1("200.5.1.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1_2("200.5.1.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_1("200.5.1.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2_2("200.5.1.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_G("200.6.1г"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_V("200.6.1в"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_B("200.6.1б"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_A("200.6.1а"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;

end;

class (TF123PartCalculateController_3643) TF123PartCalculateController_3714(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_3643(reportCalculateController, partId);

    private macro calculateLine_100_5_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 100.5_дисконт + 100.5.1_доп + 100.5.3_доп - 100.5.2_доп");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;
        else
            attrSum1.setValue(0);
        end;

        m_dataSourceFilterAcc.clear();

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum2.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;
        else
            attrSum2.setValue(0);
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.3_доп", m_part.getAttribute("100.5.3_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5.1_доп").getValue()).
                      plus(m_part.getAttribute("100.5.3_доп").getValue()).
                      minus(m_part.getAttribute("100.5.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Прибыль прошлых лет */
    private macro profitLastYears(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 + Сумма3 + Сумма4 + 100.6.1_доп + 100.6.3_доп");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов, forDate);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                      plus(m_part.getAttribute("100.6.1_доп").getValue()).
                      plus(m_part.getAttribute("100.6.3_доп").getValue());

        m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.6.3_доп", m_part.getAttribute("100.6.3_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.6.1_ПФИ_707 + 100.6.1_ПФИ_108_109_708");
        m_protocolView.printLineValueInfo("100.6.1_ПФИ_707", m_part.getAttribute("100.6.1_ПФИ_707").getValue());
        m_protocolView.printLineValueInfo("100.6.1_ПФИ_108_109_708", m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue());

        attribute.setValue(m_part.getAttribute("100.6.1_ПФИ_707").getValue()).
                      plus(m_part.getAttribute("100.6.1_ПФИ_108_109_708").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_PFI_707(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);


        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.acceptedDistributedProfit() or
            (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() < 0))
           )
            m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ < 0!");
            m_protocolView.printAlg(attributeId, "Финансовый результат ПГ за Дата Ауд_прошлГ");
            attribute.setValue(m_part.getAttribute("Убыток прошлых лет").getValue());

        elif (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0))
            if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() < 0)

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года < 0!");
                m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года * (-1) + (Сумма1 - Сумма2)");

                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
                tempVal.size = 0;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
                tempVal.size = 0;

                attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          multiply(-1).
                              plus(attrSum1.getValue()).
                             minus(attrSum2.getValue());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_TOTAL_PFI(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_данные").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_данные > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_данные ");
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());

            attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue());

        elif (m_part.getAttribute("200.5.1_данные").getValue() < 0)
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_данные < 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_данные  * (-1)");
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());

                attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue()).
                          multiply(-1);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.5.1_данные - 100.5.1_доп");
        m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());

        attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue()).
                     minus(m_part.getAttribute("100.5.1_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            if (global.parameters.isConfirmedProfitCurrentDate())
                m_protocolView.printAlg(attributeId, "100.5.1_доп ");
                m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());

                attribute.setValue(m_part.getAttribute("100.5.1_доп").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro basicNotImplementedPfi(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Увеличение"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Уменьшение"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro basicImplementedPfi(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_protocolView.printLineValueInfo("Нереализ ПФИ базовый", m_part.getAttribute("Нереализ ПФИ базовый").getValue());
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum).minus(m_part.getAttribute("Нереализ ПФИ базовый").getValue());

            m_protocolView.printAlg("Сумма1", sum + " - " + m_part.getAttribute("Нереализ ПФИ базовый").getValue() + " = " + attribute.getValue());

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            m_protocolView.printAlg(attributeId, "Реализ ПФИ базовый");

            attribute.setValue(m_part.getAttribute("Реализ ПФИ базовый").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            m_protocolView.printAlg(attributeId, "Нереализ ПФИ базовый");

            attribute.setValue(m_part.getAttribute("Нереализ ПФИ базовый").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");
            m_protocolView.printAlg(attributeId, "100.6.1_доп");

            attribute.setValue(m_part.getAttribute("100.6.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_PFI_108_109_708(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro notImplementedPfiForDate(attributeId : String, restDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Увеличение"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, restDate);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Уменьшение"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, restDate);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro implementedPfiForDate(attributeId : String, restDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var forPeriodString = ternary(restDate == rcbApplication().currentReport.context.period.endDate, "ДООП", "Дата Ауд_прошлГ");
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_protocolView.printLineValueInfo("Нереализ ПФИ ПГ за " + forPeriodString, m_part.getAttribute("Нереализ ПФИ ПГ за " + forPeriodString).getValue());
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, restDate);
        attribute.setValue(sum).minus(m_part.getAttribute("Нереализ ПФИ ПГ за " + forPeriodString).getValue());

        m_protocolView.printAlg("Сумма1", sum + " - " + m_part.getAttribute("Нереализ ПФИ ПГ за " + forPeriodString).getValue() + " = " + attribute.getValue());

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.1_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, restDate);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");
            m_protocolView.printAlg(attributeId, "Реализов ПФИ ПГ за Дата Ауд_прошлГ + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Реализов ПФИ ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Реализов ПФИ ПГ за Дата Ауд_прошлГ").getValue());
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Реализов ПФИ ПГ за Дата Ауд_прошлГ").getValue()).plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");
            m_protocolView.printAlg(attributeId, "Нереализ ПФИ ПГ за Дата Ауд_прошлГ + ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Нереализ ПФИ ПГ за Дата Ауд_прошлГ").getValue());
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Нереализ ПФИ ПГ за Дата Ауд_прошлГ").getValue()).plus(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            m_protocolView.printAlg(attributeId, "101.8.1_доп");

            attribute.setValue(m_part.getAttribute("101.8.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_PFI_108_109_708(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            m_protocolView.printAlg(attributeId, "Реализов ПФИ ПГ за ДООП + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Реализов ПФИ ПГ за ДООП", m_part.getAttribute("Реализов ПФИ ПГ за ДООП").getValue());
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Реализов ПФИ ПГ за ДООП").getValue()).
                          plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears()).
                          plus(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            m_protocolView.printAlg(attributeId, "Нереализ ПФИ ПГ за ДООП + ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Нереализ ПФИ ПГ за ДООП", m_part.getAttribute("Нереализ ПФИ ПГ за ДООП").getValue());
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Нереализ ПФИ ПГ за ДООП").getValue()).
                          plus(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                          plus(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");
            m_protocolView.printAlg(attributeId, "101.9.1_доп");

            attribute.setValue(m_part.getAttribute("101.9.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");
            m_protocolView.printAlg(attributeId, "Реализованный ПФИ ДООП");
            m_protocolView.printLineValueInfo("Реализованный ПФИ ДООП", m_part.getAttribute("Реализованный ПФИ ДООП").getValue());

            attribute.setValue(m_part.getAttribute("Реализованный ПФИ ДООП").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп > 0!");
            m_protocolView.printAlg(attributeId, "Нереализованный ПФИ ДООП");
            m_protocolView.printLineValueInfo("Нереализованный ПФИ ДООП", m_part.getAttribute("Нереализованный ПФИ ДООП").getValue());

            attribute.setValue(m_part.getAttribute("Нереализованный ПФИ ДООП").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        if ((m_part.getAttribute("200.5_данные").getValue() - m_part.getAttribute("100.5").getValue()) > 0)
            m_protocolView.printString("Значение выражения (Строка_200.5_данные - Строка_100.5) > 0!");
            m_protocolView.printLineValueInfo("200.5_данные", m_part.getAttribute("200.5_данные").getValue());
            m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
            m_protocolView.printAlg(attributeId, "200.5.1_доп");

            attribute.setValue(m_part.getAttribute("200.5.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     private macro notImplementedPfiDoop(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Увеличение"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, rcbApplication().currentReport.context.period.endDate);
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.1.1_Уменьшение"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, rcbApplication().currentReport.context.period.endDate);
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro implementedPfiDoop(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_protocolView.printLineValueInfo("Нереализованный ПФИ ДООП", m_part.getAttribute("Нереализованный ПФИ ДООП").getValue());
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.1_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, rcbApplication().currentReport.context.period.endDate);
            attribute.setValue(sum).minus(m_part.getAttribute("Нереализованный ПФИ ДООП").getValue());

            m_protocolView.printAlg("Сумма1", sum + " - " + m_part.getAttribute("Нереализованный ПФИ ДООП").getValue() + " = " + attribute.getValue());

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.1_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, rcbApplication().currentReport.context.period.endDate);
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_доп > 0!");
            m_protocolView.printAlg(attributeId, "Реализованный ПФИ ДООП - Строка_100.5.1.1");
            m_protocolView.printLineValueInfo("Реализованный ПФИ ДООП", m_part.getAttribute("Реализованный ПФИ ДООП").getValue());
            m_protocolView.printLineValueInfo("100.5.1.1", m_part.getAttribute("100.5.1.1").getValue());

            attribute.setValue(m_part.getAttribute("Реализованный ПФИ ДООП").getValue()).
                         minus(m_part.getAttribute("100.5.1.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5.1_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5.1_доп", m_part.getAttribute("200.5.1_доп").getValue());
            m_protocolView.printString("Значение переменной 200.5.1_доп > 0!");
            m_protocolView.printAlg(attributeId, "Нереализованный ПФИ ДООП - Строка_100.5.1.2");
            m_protocolView.printLineValueInfo("Нереализованный ПФИ ДООП", m_part.getAttribute("Нереализованный ПФИ ДООП").getValue());
            m_protocolView.printLineValueInfo("100.5.1.2", m_part.getAttribute("100.5.1.2").getValue());

            attribute.setValue(m_part.getAttribute("Нереализованный ПФИ ДООП").getValue()).
                         minus(m_part.getAttribute("100.5.1.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;



    private macro calculateLine_200_6_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.1_доп");

            attribute.setValue(m_part.getAttribute("200.6.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_PFI_108_109_708(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());

            attribute.setValue(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

            attribute.setValue(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_108_109_708("100.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708("101.8.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiDoop("Нереализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiDoop("Реализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1("101.8.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2("101.8.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1("101.9.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2("101.9.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1("100.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2("100.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1("100.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2("100.6.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_108_109_708("200.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1("200.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2("200.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1("200.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2("200.6.1.2"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;
end;

/**
 * Класс контролллера рассчета по указанию 3875-У
 */
class (TF123PartCalculateController_3714) TF123PartCalculateController_3875(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_3714(reportCalculateController, partId);

    /**
     * Расчет атрибута 103.3
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_103_3(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 103.3");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ K3 */
        attribute.multiply(global.parameters.getK3());
        m_protocolView.printParamValue("K3", global.parameters.getK3());
        /* K3 }}} */

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.7.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_200_7_1(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K3");

        /* {{{ Сумма 1 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        m_protocolView.printParamValue("Сумма1", currentValue);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        m_protocolView.printParamValue("Сумма2", currentValue);
        attribute.plus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printParamValue("K3", global.parameters.getK3());
        attribute.multiply(global.parameters.getK3());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.7.2
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_200_7_2(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7.2");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        m_protocolView.printParamValue("Сумма1", currentValue);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        m_protocolView.printParamValue("Сумма2", currentValue);
        attribute.plus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printParamValue("K3", global.parameters.getK3());
        attribute.multiply(global.parameters.getK3());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.7
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_200_7(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Сумма
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 200.7.1 + 200.7.2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc/*, m_tuneTable*/);
        attribute.plus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printLineValueInfo("200.7.1", m_part.getAttribute("200.7.1").getValue());
        m_protocolView.printLineValueInfo("200.7.2", m_part.getAttribute("200.7.2").getValue());

        attribute.plus(m_part.getAttribute("200.7.1").getValue());
        attribute.plus(m_part.getAttribute("200.7.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_100_5(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");

            if (m_part.getAttribute("100.5_доп").getValue() > 0)
                m_protocolView.printAlg(attributeId, "100.5_доп");
                m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());
                m_protocolView.printString("Значение переменной 101.5_доп > 0!");

                if (global.parameters.isConfirmedProfitCurrentDate())
                    attribute.setValue(m_part.getAttribute("100.5_доп").getValue());
                else
                    if (global.parameters.getInclude106InBaseCapital())
                        if (m_part.getAttribute("100.5_доб_капитал").getValue() >= 0)
                            m_protocolView.printAlg(attributeId, "100.5_доб_капитал");
                            m_protocolView.printLineValueInfo("100.5_доб_капитал", m_part.getAttribute("100.5_доб_капитал").getValue());
                            m_protocolView.printString("Значение переменной 101.5_доб_капитал >= 0!");
                            attribute.setValue(m_part.getAttribute("100.5_доб_капитал").getValue());
                        else
                            attribute.setValue($0.0);
                        end;
                    else
                        attribute.setValue($0.0);
                    end;
                end;
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5_доб_капитал
     *
     * @param attributeId Идентификатор атрибута
     */
    macro calculateLine_100_5_add_capital(attributeId: String): Object
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доб_капитал");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);
        m_protocolView.printAlg("Сумма1", currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);
        m_protocolView.printAlg("Сумма2", currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 100.5_дисконт + 100.5.1_доп + 100.5.3_доп - 100.5.2_доп");

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.plus(currentValue);
            temporaryValue[1] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[2] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[3] = currentValue;

            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
        else
            attributeSum1.setValue(0);
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
        else
            attributeSum2.setValue(0);
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum3.setValue(currentValue);
            m_protocolView.printAlg("Сумма3", currentValue);
        else
            attributeSum3.setValue(0);
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.3_доп", m_part.getAttribute("100.5.3_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());

        attribute.setValue(attributeSum1.getValue()).
                      plus(attributeSum2.getValue()).
                      minus(attributeSum3.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5.1_доп").getValue()).
                      plus(m_part.getAttribute("100.5.3_доп").getValue()).
                      minus(m_part.getAttribute("100.5.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.1
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_1(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;


        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3 - Сумма4) * K1");

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_НА")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.plus(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_НА"));
        currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.4.2
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_4_2(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.4.2");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Фильтр 1 для суммы 1
         */
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Фильтр 2 для суммы 2
         */
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            currentValue = m_dataSourceAcc.getData(filterFromSum1);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum2);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum2);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 101.9_дисконт - 101.9.1_доп + 101.9.2_доп + 101.9.3_доп");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.3_доп", m_part.getAttribute("101.9.3_доп").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("101.9_дисконт").getValue());
        attribute.minus(m_part.getAttribute("101.9.1_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.2_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.3_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 104.1.2
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_104_1_2(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 104.1.2");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Фильтр для суммы 1 атрибута
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2: Object = m_dataSouceFilters.getFilter("Accounts");

        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");

            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");

            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            currentValue = m_dataSourceAcc.getData(filterFromSum2);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;
            currentValue = m_dataSourceAcc.getReservesData(filterFromSum2);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 104.7.1
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_104_7_1(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 104.7.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1"));
        m_dataSOurceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printParamValue("K2", global.parameters.getK2());
        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.8
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_8(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.8");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Сумма 1
         */
        var attributeSum1: Money = $0.0;
        /**
         * Сумма 2
         */
        var attributeSum2: Money = $0.0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "min(Сумма1; Сумма2)");

        /* {{{ Сумма 1 */
        if (global.parameters.getDateRevaluation() <= rcbApplication().currentReport.context.period.endDate)
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            attributeSum1 = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getDateRevaluation());
        else
            attributeSum1 = $0.0;
        end;
        m_protocolView.printParamValue("Сумма1", attributeSum1);
        /* Сумма 1 */

        /* {{{ Сумма 2 */
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10610*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        attributeSum2 = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getDateRevaluation());
        m_protocolView.printParamValue("Сумма2", attributeSum2);
        /* Сумма 2 */

        if (attributeSum1 < attributeSum2)
            attribute.setValue(attributeSum1);
        else
            attribute.setValue(attributeSum2);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.1.2
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_201_1_2(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.8");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущие значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2 : Object= m_part.getAttribute("attrSum2");
        /**
         * Сумма 3
         */
        var attributeSum3 : Object= m_part.getAttribute("attrSum3");
        /**
         * Фильтр для суммы 1
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");

            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");

            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            currentValue = m_dataSourceAcc.getData(filterFromSum2);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;
            currentValue = m_dataSourceAcc.getReservesData(filterFromSum2);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            temporaryValue.size = 0;
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.5
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_201_5(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 201.5");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.5_ввод * K1");
        m_protocolView.printLineValueInfo("201.5_ввод", m_part.getAttribute("201.5_ввод").getValue());

        attribute.setValue(m_part.getAttribute("201.5_ввод").getValue());
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.1_данные
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_202_3_1_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 202.3.1_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 2
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Временный фильтр
         */
        var tempFilter: Object = m_dataSouceFilters.getFilter("Accounts");

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3_ист_СС").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());
            m_protocolView.printString("Значение переменной 202.3_ист_СС > 0!");
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");
            tempFilter.op("(");
            tempFilter.isSatisfiesToBalanceMasks("60701*");
            tempFilter.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
            tempFilter.op(")");
            tempFilter.op("OR");
            tempFilter.op("(");
            tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС"));
            tempFilter.op("AND NOT").isSatisfiesToBalanceMasks("60701*");
            tempFilter.op(")");
            currentValue = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(currentValue);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(currentValue);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(currentValue).
                      minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        else
            m_dataSourceFilterAcc.clear();
            tempFilter.clear();
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");

            tempFilter.op("(");
            tempFilter.isSatisfiesToBalanceMasks("60701*");
            tempFilter.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
            tempFilter.op(")");
            tempFilter.op("OR");
            tempFilter.op("(");
            tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС_1"));
            tempFilter.op("AND NOT").isSatisfiesToBalanceMasks("60701*");
            tempFilter.op(")");
            currentValue = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(currentValue);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Амортизация ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Амортизация ОС'");
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(currentValue);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(currentValue).
                     minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.2_данные
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_202_3_2_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 202.3.2_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временный фильтр
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Врменное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + Сумма3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2"));
        filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ п. 4.2.2 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ п. 4.2.2 395-П'");
        currentValue = m_dataSourceAcc.getData(filterFromSum1);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
        attributeSum1.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2_полож_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2_отриц_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2_ПИФ"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        temporaryValue[0] = currentValue;
        currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attributeSum3.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
        temporaryValue.size = 0;
        /* Сумма 3 }}} */

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.plus(attributeSum3.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.5_данные
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_5_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.5_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 200.5_дисконт + 200.5.1_итог_ПФИ + 200.5.3_данные - 200.5.2_данные");

        /* {{{  Сумма 1 */
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;

        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /*  Сумма 1 }}} */


        /* {{{ Сумма2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Расходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("200.5_дисконт", m_part.getAttribute("200.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("200.5.1_итог_ПФИ", m_part.getAttribute("200.5.1_итог_ПФИ").getValue());
        m_protocolView.printLineValueInfo("200.5.3_данные", m_part.getAttribute("200.5.3_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("200.5_дисконт").getValue());
        attribute.plus(m_part.getAttribute("200.5.1_итог_ПФИ").getValue());
        attribute.plus(m_part.getAttribute("200.5.3_данные").getValue());
        attribute.minus(m_part.getAttribute("200.5.2_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.6
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_6(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.6");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Год окончания отчетного периода
         */
        var yearEndDate:  Integer = 0;
        /**
         * Месяц окончания отчетного периода
         */
        var monthEndDate: Integer = 0;
        /**
         * День окончания отчетного периода
         */
        var dayEndDate:   Integer = 0;

        dateSplit(rcbApplication().currentReport.context.period.endDate, dayEndDate, monthEndDate, yearEndDate);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за ДООП - 200.6.2_доп - 100.6");
        if ((monthEndDate < 7) OR ((monthEndDate == 7) AND (dayEndDate < 1)))
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за ДООП", m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue());
            m_protocolView.printLineValueInfo("200.6.2_доп", m_part.getAttribute("200.6.2_доп").getValue());
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за ДООП").getValue()).
                          minus(m_part.getAttribute("200.6.2_доп").getValue()).
                          minus(m_part.getAttribute("100.6").getValue());

            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.14
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_14(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.14.1 + 101.14.2 + 101.14.3");
        m_protocolView.printLineValueInfo("101.14.1", m_part.getAttribute("101.14.1").getValue());
        m_protocolView.printLineValueInfo("101.14.2", m_part.getAttribute("101.14.2").getValue());
        m_protocolView.printLineValueInfo("101.14.3", m_part.getAttribute("101.14.3").getValue());

        attribute.setValue(m_part.getAttribute("101.14.1").getValue()).
                      plus(m_part.getAttribute("101.14.2").getValue()).
                      plus(m_part.getAttribute("101.14.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.15
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_15(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.1 + 101.2 + 101.3 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10 + 101.11 + 101.12 + 101.13 + 101.14");
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10", m_part.getAttribute("101.10").getValue());
        m_protocolView.printLineValueInfo("101.11", m_part.getAttribute("101.11").getValue());
        m_protocolView.printLineValueInfo("101.12", m_part.getAttribute("101.12").getValue());
        m_protocolView.printLineValueInfo("101.13", m_part.getAttribute("101.13").getValue());
        m_protocolView.printLineValueInfo("101.14", m_part.getAttribute("101.14").getValue());

        attribute.setValue(m_part.getAttribute("101.1").getValue()).
                      plus(m_part.getAttribute("101.2").getValue()).
                      plus(m_part.getAttribute("101.3").getValue()).
                      plus(m_part.getAttribute("101.4").getValue()).
                      plus(m_part.getAttribute("101.5").getValue()).
                      plus(m_part.getAttribute("101.6").getValue()).
                      plus(m_part.getAttribute("101.7").getValue()).
                      plus(m_part.getAttribute("101.8").getValue()).
                      plus(m_part.getAttribute("101.9").getValue()).
                      plus(m_part.getAttribute("101.10").getValue()).
                      plus(m_part.getAttribute("101.11").getValue()).
                      plus(m_part.getAttribute("101.12").getValue()).
                      plus(m_part.getAttribute("101.13").getValue()).
                      plus(m_part.getAttribute("101.14").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 102
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_102(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.7 - 101.15");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.15", m_part.getAttribute("101.15").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.15").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 202.3.4
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3.1_данные + 202.3.2_данные + 202.3.3_данные");
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());

        attribute.setValue(m_part.getAttribute("202.3.1_данные").getValue()).
                      plus(m_part.getAttribute("202.3.2_данные").getValue()).
                      plus(m_part.getAttribute("202.3.3_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 201.7.5.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_201_7_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);
        tempFilter.op("(").isSatisfiesToBalanceMasks("60701*").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op(")").op("OR").op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_ОС")).op("AND NOT").isSatisfiesToBalanceMasks("60701*").op(")");
        sum = m_dataSourceAcc.getData(tempFilter);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.op("AND").add(tempFilter);
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[2] = sum;

        m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        tempVal[3] = m_part.getAttribute("201.7.5_202.3.1_имущество").getValue();
        attrSum1.minus(tempVal[3]);

        m_protocolView.printAlg(attributeId, tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " - " + tempVal[3] + " = " + attrSum1.getValue());
    end;

     /**
     * Расчет атрибута 101.4.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_4_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


     /**
     * Расчет атрибута 101.10.1_Данные
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_10_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = Tarray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + Сумма3");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.10.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_10_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (101.10.1_данные * Коэф_НВ_101.10.1) + Строка_101.10.1_ВстрВлож");
            m_protocolView.printLineValueInfo("101.10.1_данные", m_part.getAttribute("101.10.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_101.10.1", m_part.getAttribute("Коэф_НВ_101.10.1").getValue());
            m_protocolView.printLineValueInfo("101.10.1_ВстрВлож", m_part.getAttribute("101.10.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("101.10.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_101.10.1").getValue()).
                      plus(m_part.getAttribute("101.10.1_ВстрВлож").getValue());
        else
            m_protocolView.printLineValueInfo("101.10.1_ВстрВлож", m_part.getAttribute("101.10.1_ВстрВлож").getValue());
            attribute.setValue(m_part.getAttribute("101.10.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.10.Данные
     *
     * @param attributeId Идетификатор атрибута
     */
     private macro calculateLine_101_10_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = Tarray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.10.1_ВстрВлож
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_10_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = Tarray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;


        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

      /**
     * Расчет атрибута 101.10.2
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_10_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attr2 = m_part.getAttribute("attr2");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "MIN(101.10.2_данные, Сумма1) + Строка_101.10.2_ВстрВлож");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.1);

        m_protocolView.printLine("Сумма1 = 101.10.2_данные - 0.1 * Сумма_БК_1");
        m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.10.2_данные").getValue()).
                     minus(attrSum1.getValue());
        println();
        println("Сумма1 = " + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        m_protocolView.printLineValueInfo("101.10.2_ВстрВлож", m_part.getAttribute("101.10.2_ВстрВлож").getValue());

        attribute.setValue(min(attribute.getValue(), m_part.getAttribute("101.10.2_данные").getValue())).
                      plus(m_part.getAttribute("101.10.2_ВстрВлож").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 101.10.2.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_101_10_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrLess(0, 10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrLess(0, 10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").op(" ( ").isExistAccountNoteGreatOrLess(0, 10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 101.10.2.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_101_10_2_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 101.10.3.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_101_10_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.3_данные + 101.10.2_данные + Строка_101.10.2_ВстрВлож");
        m_protocolView.printLineValueInfo("101.3_данные", m_part.getAttribute("101.3_данные").getValue());
        m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());
        m_protocolView.printLineValueInfo("101.10.2_ВстрВлож", m_part.getAttribute("101.10.2_ВстрВлож").getValue());

        attribute.setValue(m_part.getAttribute("101.3_данные").getValue()).
                      plus(m_part.getAttribute("101.10.2_данные").getValue()).
                      plus(m_part.getAttribute("101.10.2_ВстрВлож").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.2.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.2.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_2_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.2.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.2.1_данные * Коэф_НВ_104.2.1) + 104.2.1_ВстрВлож");
            m_protocolView.printLineValueInfo("104.2.1_данные", m_part.getAttribute("104.2.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.2.1", m_part.getAttribute("Коэф_НВ_104.2.1").getValue());
            m_protocolView.printLineValueInfo("104.2.1_ВстрВлож", m_part.getAttribute("104.2.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.2.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.2.1").getValue()).
                      plus(m_part.getAttribute("104.2.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("104.2.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.3.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.1_данные * Коэф_НВ_104.3.1) + 104.3.1_ВстрВлож");
            m_protocolView.printLineValueInfo("104.3.1_данные", m_part.getAttribute("104.3.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.1", m_part.getAttribute("Коэф_НВ_104.3.1").getValue());
            m_protocolView.printLineValueInfo("104.3.1_ВстрВлож", m_part.getAttribute("104.3.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.1").getValue()).
                      plus(m_part.getAttribute("104.3.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("104.3.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.3.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
    * Расчет атрибута 104.3.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.3.1.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.1.1_данные * Коэф_НВ_104.3.1.1)");
            m_protocolView.printLineValueInfo("104.3.1.1_данные", m_part.getAttribute("104.3.1.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.1.1", m_part.getAttribute("Коэф_НВ_104.3.1.1").getValue());
            m_protocolView.printLineValueInfo("104.3.1.1_ВстрВлож", m_part.getAttribute("104.3.1.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.1.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.1.1").getValue()).
                      plus(m_part.getAttribute("104.3.1.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("104.3.1.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.3.1.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 104.3.1.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_104_3_1_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.2.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.2.1_данные * Коэф_НВ_201.2.1");
            m_protocolView.printLineValueInfo("201.2.1_данные", m_part.getAttribute("201.2.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.2.1", m_part.getAttribute("Коэф_НВ_201.2.1").getValue());
            m_protocolView.printLineValueInfo("201.2.1_ВстрВлож", m_part.getAttribute("201.2.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.2.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.2.1").getValue()).
                      plus(m_part.getAttribute("201.2.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("201.2.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
    * Расчет атрибута 201.2.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
    * Расчет атрибута 201.2.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_2_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (201.3.1_данные * Коэф_НВ_201.3.1) + Строка_201.3.1.1_ВстрВлож");
            m_protocolView.printLineValueInfo("201.3.1_данные", m_part.getAttribute("201.3.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.1", m_part.getAttribute("Коэф_НВ_201.3.1").getValue());
            m_protocolView.printLineValueInfo("201.3.1_ВстрВлож", m_part.getAttribute("201.3.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1").getValue()).
                      plus(m_part.getAttribute("201.3.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("201.3.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1.1
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.3.1.1_Данные * Коэф_НВ_201.3.1.1 + 201.3.1.1_ВстрВлож");
            m_protocolView.printLineValueInfo("201.3.1.1_Данные", m_part.getAttribute("201.3.1.1_Данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.1.1", m_part.getAttribute("Коэф_НВ_201.3.1.1").getValue());
            m_protocolView.printLineValueInfo("201.3.1.1_ВстрВлож", m_part.getAttribute("201.3.1.1_ВстрВлож").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1.1_Данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1.1").getValue()).
                      plus(m_part.getAttribute("201.3.1.1_ВстрВлож").getValue());
        else
            attribute.setValue(m_part.getAttribute("201.3.1.1_ВстрВлож").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1.1.ВстрВлож
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1_1_VstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) *K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
    * Расчет атрибута 201.3.1.1.Данные
    *
    * @param attributeId Идетификатор атрибута
    */
    private macro calculateLine_201_3_1_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_BK(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.7 - 101.1 - 101.2 - 101.4 - 101.5 - 101.6 - 101.7 - 101.8 - 101.9 - 101.10_данные");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10_данные", m_part.getAttribute("101.10_данные").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.1").getValue()).
                     minus(m_part.getAttribute("101.2").getValue()).
                     minus(m_part.getAttribute("101.4").getValue()).
                     minus(m_part.getAttribute("101.5").getValue()).
                     minus(m_part.getAttribute("101.6").getValue()).
                     minus(m_part.getAttribute("101.7").getValue()).
                     minus(m_part.getAttribute("101.8").getValue()).
                     minus(m_part.getAttribute("101.9").getValue()).
                     minus(m_part.getAttribute("101.10_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_BK_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100.7 - (101.1 + 101.2 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10.1 + 101.10_данные)");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());
        m_protocolView.printLineValueInfo("101.10_данные", m_part.getAttribute("101.10_данные").getValue());

        attribute.setValue(m_part.getAttribute("100.7").getValue()).
                     minus(m_part.getAttribute("101.1").getValue()).
                     minus(m_part.getAttribute("101.2").getValue()).
                     minus(m_part.getAttribute("101.4").getValue()).
                     minus(m_part.getAttribute("101.5").getValue()).
                     minus(m_part.getAttribute("101.6").getValue()).
                     minus(m_part.getAttribute("101.7").getValue()).
                     minus(m_part.getAttribute("101.8").getValue()).
                     minus(m_part.getAttribute("101.9").getValue()).
                     minus(m_part.getAttribute("101.10.1").getValue()).
                     minus(m_part.getAttribute("101.10_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
     * Расчет атрибута 101.8.3_убыток
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_3_UB(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма_3 - Сумма_2  - Сумма_1 - 101.8.3_оцен_сниж_СС_ПрошлЛет - 101.8.3_оцен_сниж_СС_ПрошлГода) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printParamValue("101.8.3_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue());
        m_protocolView.printParamValue("101.8.3_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum3.getValue()).
                     minus(attrSum2.getValue()).
                     minus(attrSum1.getValue()).
                     minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue()).
                     minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8.1_ПФИ_108_109_708_неподтв
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами + ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.8
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(101.8_доп + 101.8.2_доп)");
        m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
        m_protocolView.printLineValueInfo("101.8.2_доп", m_part.getAttribute("101.8.2_доп").getValue());

        attribute.setValue(m_part.getAttribute("101.8_доп").getValue()).
                     plus(m_part.getAttribute("101.8.2_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута Финансовый рез-т предшествующих лет без прибыли прошлого года
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro finResultLastYearsWithoutProfit(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);

        m_protocolView.printAlg("Сумма2", attrSum2.getValue());

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8_доп
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.acceptedDistributedProfit() or
            (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() < 0))
           )
            m_protocolView.printLineValueInfo("Финансовый результат ПГ за ДООП", m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат ПГ за ДООП < 0!");
            m_protocolView.printAlg(attributeId, "Финансовый результат ПГ за ДООП");
            attribute.setValue(m_part.getAttribute("Убыток прошлых лет").getValue());

        elif (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() > 0))
            if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() < 0)

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года < 0!");
                m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года * (-1) + (Сумма1 - Сумма2)");

                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
                tempVal.size = 0;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
                tempVal.size = 0;

                attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          multiply(-1).
                              plus(attrSum1.getValue()).
                             minus(attrSum2.getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута Убыток прошлых лет
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro lossLastYears(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма_2 - Сумма_1 + Сумма_3 + Сумма_4 + 101.8.1_ПФИ_707 за ДООП + 101.8.1_ПФИ_108_109_708 + 101.8.1_ПФИ_108_109_708_неподтв + 101.8.3_убыток");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum4.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum2.getValue()).
                     minus(attrSum1.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                      plus(m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue()).
                      plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue()).
                      plus(m_part.getAttribute("101.8.3_убыток").getValue()).
                      plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());

        m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за ДООП", m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue());
        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708_неподтв", m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue());
        m_protocolView.printLineValueInfo("101.8.3_убыток", m_part.getAttribute("101.8.3_убыток").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.8.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "101.8.1_доп");

            attribute.setValue(m_part.getAttribute("101.8.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.8.1_доп
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");
            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за Дата Ауд_прошлГ + 101.8.1_ПФИ_108_109_708");
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", m_part.getAttribute("101.8.1_ПФИ_707 за Дата Ауд_прошлГ").getValue());
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());

                        attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за Дата Ауд_прошлГ").getValue()).
                                      plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                    else
                        m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_108_109_708");
                        m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                        attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за ДООП + 101.8.1_ПФИ_108_109_708 + 101.8.1_ПФИ_108_109_708_неподтв");
                    m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за ДООП", m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue());
                    m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                    m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708_неподтв", m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue());

                    attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue()).
                                  plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue()).
                                  plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "101.8.1_ПФИ_707 за ДООП + 101.8.1_ПФИ_108_109_708 + 101.8.1_ПФИ_108_109_708_неподтв");
                m_protocolView.printLineValueInfo("101.8.1_ПФИ_707 за ДООП", m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue());
                m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708", m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue());
                m_protocolView.printLineValueInfo("101.8.1_ПФИ_108_109_708_неподтв", m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue());

                attribute.setValue(m_part.getAttribute("101.8.1_ПФИ_707 за ДООП").getValue()).
                              plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708").getValue()).
                              plus(m_part.getAttribute("101.8.1_ПФИ_108_109_708_неподтв").getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8.1.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "Реализов ПФИ ПГ за ДООП + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Реализов ПФИ ПГ за ДООП", m_part.getAttribute("Реализов ПФИ ПГ за ДООП").getValue());
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());
            m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Реализов ПФИ ПГ за ДООП").getValue()).
                          plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears()).
                          plus(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8.1.2
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "Нереализ ПФИ ПГ за ДООП + ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами");
            m_protocolView.printLineValueInfo("Нереализ ПФИ ПГ за ДООП", m_part.getAttribute("Нереализ ПФИ ПГ за ДООП").getValue());
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
            m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

            attribute.setValue(m_part.getAttribute("Нереализ ПФИ ПГ за ДООП").getValue()).
                          plus(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                          plus(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8.3
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_8_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "101.8.3_доп");

            attribute.setValue(m_part.getAttribute("101.8.3_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
     * Выполнение расчета
     */
    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_108_109_708("100.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_UB("101.8.3_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708("101.8.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiDoop("Нереализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiDoop("Реализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_VstrVl("101.10.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_VstrVl("101.10.2_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_VstrVl("104.2.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_VstrVl("104.3.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_VstrVl("104.3.1.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_VstrVl("201.2.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_VstrVl("201.3.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_VstrVl("201.3.1.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1("101.8.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2("101.8.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1("101.9.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2("101.9.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1("100.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2("100.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1("100.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2("100.6.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_Data("101.10_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_108_109_708("200.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1("200.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2("200.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1("200.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2("200.6.1.2"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_15("101.15"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;
end;


/**
 * Класс контролллера рассчета по указанию XXXX-У
 */
class (TF123PartCalculateController_3875) TF123PartCalculateController_XXXX(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_3875(reportCalculateController, partId);

    /**
     * Расчет атрибута 100.5_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 100.5_дисконт  + 100.5_ден_потоки_не_СС + 100.5.1_доп + 100.5.3_доп - 100.5.2_доп");

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.plus(currentValue);
            temporaryValue[1] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[2] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[3] = currentValue;

            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
        else
            attributeSum1.setValue(0);
            m_protocolView.printAlg("Сумма1", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
        else
            attributeSum2.setValue(0);
            m_protocolView.printAlg("Сумма2", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum3.setValue(currentValue);
            m_protocolView.printAlg("Сумма3", currentValue);
        else
            attributeSum3.setValue(0);
            m_protocolView.printAlg("Сумма3", attributeSum3.getValue());
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5_ден_потоки_не_СС", m_part.getAttribute("100.5_ден_потоки_не_СС").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.3_доп", m_part.getAttribute("100.5.3_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());

        attribute.setValue(attributeSum1.getValue()).
                      plus(attributeSum2.getValue()).
                      minus(attributeSum3.getValue()).
                      plus(m_part.getAttribute("100.5_ден_потоки_не_СС").getValue()).
                      plus(m_part.getAttribute("100.5.1_доп").getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5.3_доп").getValue()).
                      minus(m_part.getAttribute("100.5.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5_ден_потоки_не_СС
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_STREAMS_NOT_SS(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum = 0;
        var sum1 = 0;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - 100.5.3_оцен_сниж_СС) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);
            sum1 = attribute.getValue();

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printAlg("Сумма1", sum1 + " - " + sum + " = " + attribute.getValue());

            m_protocolView.printLineValueInfo("100.5.3_оцен_сниж_СС", m_part.getAttribute("100.5.3_оцен_сниж_СС").getValue());
            attribute.minus(m_part.getAttribute("100.5.3_оцен_сниж_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.6.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_6_3_DOP(attributeId : String)

        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма_3 - 100.6.3_оцен_сниж_СС) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;

            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            m_dataSourceFilterAcc.clear();

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum2.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum3.setValue(sum);

            m_protocolView.printLineValueInfo("100.6.3_оцен_сниж_СС", m_part.getAttribute("100.6.3_оцен_сниж_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                         minus(attrSum3.getValue()).
                         minus(m_part.getAttribute("100.6.3_оцен_сниж_СС").getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 101.8.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_8_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Прибыль");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Убыток");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");

            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1 - 101.8.3_оцен_сниж_СС_ПрошлЛет - 101.8.3_оцен_сниж_СС_ПрошлГода");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                        m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue());
                        m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue()).
                                     minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue()).
                                     minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue()).
                                     minus(attrSum1.getValue());
                    else
                        m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - 101.8.3_оцен_сниж_СС_ПрошлЛет");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue()).
                                     minus(attrSum2.getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1 - 101.8.3_оцен_сниж_СС_ПрошлЛет - 101.8.3_оцен_сниж_СС_ПрошлГода");
                    m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                    m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                    m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                    m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue());
                    m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue());

                    attribute.setValue(attrSum3.getValue()).
                                 minus(attrSum2.getValue()).
                                 minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue()).
                                 minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue()).
                                 minus(attrSum1.getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "Сумма3 - Сумма2 - Сумма1 - 101.8.3_оцен_сниж_СС_ПрошлЛет - 101.8.3_оцен_сниж_СС_ПрошлГода");
                m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue());
                m_protocolView.printSummValueInfo("101.8.3_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue());

                attribute.setValue(attrSum3.getValue()).
                             minus(attrSum2.getValue()).
                             minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлЛет").getValue()).
                             minus(m_part.getAttribute("101.8.3_оцен_сниж_СС_ПрошлГода").getValue()).
                             minus(attrSum1.getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 101.9_дисконт + 101.9_ден_потоки_не_СС - 101.9.1_доп + 101.9.2_доп + 101.9.3_доп");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9_ден_потоки_не_СС", m_part.getAttribute("101.9_ден_потоки_не_СС").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.3_доп", m_part.getAttribute("101.9.3_доп").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("101.9_дисконт").getValue());
        attribute.plus(m_part.getAttribute("101.9_ден_потоки_не_СС").getValue());
        attribute.minus(m_part.getAttribute("101.9.1_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.2_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.3_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_ден_потоки_не_СС
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_MONEY_STREAMS_NOT_SS(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_ден_потоки_не_СС");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;


        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
    m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var sum1;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - 101.9.3_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.3_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);
        sum1 = attribute.getValue();

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.3_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.minus(sum);
        m_protocolView.printAlg("Сумма1", sum1 + " - " + sum + " = " + attribute.getValue());

        m_protocolView.printLineValueInfo("101.9.3_оцен_сниж_СС", m_part.getAttribute("101.9.3_оцен_сниж_СС").getValue());
        attribute.minus(m_part.getAttribute("101.9.3_оцен_сниж_СС").getValue());

        attribute.multiply(global.parameters.getK1());
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.5.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_5_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var sum1;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - 200.5.3_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);
        sum1 = attribute.getValue();

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.minus(sum);
        m_protocolView.printAlg("Сумма1", sum1 + " - " + sum + " = " + attribute.getValue());

        m_protocolView.printLineValueInfo("200.5.3_оцен_сниж_СС", m_part.getAttribute("200.5.3_оцен_сниж_СС").getValue());
        attribute.minus(m_part.getAttribute("200.5.3_оцен_сниж_СС").getValue());

        attribute.multiply(global.parameters.getK1());
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.6.3_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_6_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3 - 200.6.3_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Прибыль_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.3_Убыток_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printParamValue("200.6.3_оцен_сниж_СС", m_part.getAttribute("200.6.3_оцен_сниж_СС").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                     minus(attrSum3.getValue()).
                     minus(m_part.getAttribute("200.6.3_оцен_сниж_СС").getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.7.5
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_201_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.7.5.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_201_7_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.2
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.3
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 202.3.4
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_202_3_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        attribute.setValue($0.0);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.1_0
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_100_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

         if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").op("(").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");

                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").op("(").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 100.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_100_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "100.1.1 + 100.1.2");
            m_protocolView.printLineValueInfo("100.1.1", m_part.getAttribute("100.1.1").getValue());
            m_protocolView.printLineValueInfo("100.1.2", m_part.getAttribute("100.1.2").getValue());

            attribute.plus(m_part.getAttribute("100.1.1").getValue()).
                      plus(m_part.getAttribute("100.1.2").getValue());
        else
            m_protocolView.printAlg(attributeId, "100.1.3 + 100.1_0");
            m_protocolView.printLineValueInfo("100.1.3", m_part.getAttribute("100.1.3").getValue());
            m_protocolView.printLineValueInfo("100.1_0", m_part.getAttribute("100.1_0").getValue());

            attribute.plus(m_part.getAttribute("100.1.3").getValue()).
                      plus(m_part.getAttribute("100.1_0").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.2.1_0
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_100_2_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments)
                    m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                    m_protocolView.printLine("Сумма1:");
                    m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory("doc.t_creditAccount", RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");

                    sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                    attribute.setValue(sum);

                    m_dataSourceFilterDoc.clear();
                    m_protocolView.printLine("Сумма2:");
                    m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory("doc.t_debetAccount", RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                    attribute.minus(sum);
                else
                    m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                    m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                    attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.2
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_100_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.2.1_0 + 100.2.1 + 100.2.2");
        m_protocolView.printLineValueInfo("100.2.1_0", m_part.getAttribute("100.2.1_0").getValue());
        m_protocolView.printLineValueInfo("100.2.1", m_part.getAttribute("100.2.1").getValue());
        m_protocolView.printLineValueInfo("100.2.2", m_part.getAttribute("100.2.2").getValue());

        attribute.plus(m_part.getAttribute("100.2.1_0").getValue()).
                  plus(m_part.getAttribute("100.2.1").getValue()).
                  plus(m_part.getAttribute("100.2.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.4_0
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_4_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.4
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.4_0 + 101.4.1 + 101.4.2 + 101.4.3");
        m_protocolView.printLineValueInfo("101.4_0", m_part.getAttribute("101.4_0").getValue());
        m_protocolView.printLineValueInfo("101.4.1", m_part.getAttribute("101.4.1").getValue());
        m_protocolView.printLineValueInfo("101.4.2", m_part.getAttribute("101.4.2").getValue());
        m_protocolView.printLineValueInfo("101.4.3", m_part.getAttribute("101.4.3").getValue());

        attribute.setValue(m_part.getAttribute("101.4_0").getValue()).
                      plus(m_part.getAttribute("101.4.1").getValue()).
                      plus(m_part.getAttribute("101.4.2").getValue()).
                      plus(m_part.getAttribute("101.4.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.5_0
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_5_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            filterFromSum2.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    /**
     * Расчет атрибута 101.5
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.5_0 + 101.5.1 + 101.5.2 + 101.5.3");
        m_protocolView.printLineValueInfo("101.5_0", m_part.getAttribute("101.5_0").getValue());
        m_protocolView.printLineValueInfo("101.5.1", m_part.getAttribute("101.5.1").getValue());
        m_protocolView.printLineValueInfo("101.5.2", m_part.getAttribute("101.5.2").getValue());
        m_protocolView.printLineValueInfo("101.5.3", m_part.getAttribute("101.5.3").getValue());

        attribute.setValue(m_part.getAttribute("101.5_0").getValue()).
                      plus(m_part.getAttribute("101.5.1").getValue()).
                      plus(m_part.getAttribute("101.5.2").getValue()).
                      plus(m_part.getAttribute("101.5.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 104.1_0
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_104_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 104.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_104_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "104.1_0 + 104.1.1 + 104.1.2 + 104.1.3");
        m_protocolView.printLineValueInfo("104.1_0", m_part.getAttribute("104.1_0").getValue());
        m_protocolView.printLineValueInfo("104.1.1", m_part.getAttribute("104.1.1").getValue());
        m_protocolView.printLineValueInfo("104.1.2", m_part.getAttribute("104.1.2").getValue());
        m_protocolView.printLineValueInfo("104.1.3", m_part.getAttribute("104.1.3").getValue());

        attribute.plus(m_part.getAttribute("104.1_0").getValue()).
                  plus(m_part.getAttribute("104.1.1").getValue()).
                  plus(m_part.getAttribute("104.1.2").getValue()).
                  plus(m_part.getAttribute("104.1.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_201_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.1_0 + 201.1.1 + 201.1.2 + 201.1.3");
        m_protocolView.printLineValueInfo("201.1_0", m_part.getAttribute("201.1_0").getValue());
        m_protocolView.printLineValueInfo("201.1.1", m_part.getAttribute("201.1.1").getValue());
        m_protocolView.printLineValueInfo("201.1.2", m_part.getAttribute("201.1.2").getValue());
        m_protocolView.printLineValueInfo("201.1.3", m_part.getAttribute("201.1.3").getValue());

        attribute.setValue(m_part.getAttribute("201.1_0").getValue()).
                      plus(m_part.getAttribute("201.1.1").getValue()).
                      plus(m_part.getAttribute("201.1.2").getValue()).
                      plus(m_part.getAttribute("201.1.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.5_1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_101_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var sum2;
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var dataSourceNoteAcc2 = m_dataSources.getDataSource("AccountNote");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");

        filterFromSum1.clear();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "Сумма1 * K1");
            m_protocolView.printLine("Сумма1:");

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Стоимость_выкупленных_долей);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма остатоков за ДООП:");
            sum2 = dataSourceNoteAcc2.getDataWithoutNote(m_dataSourceFilterAcc, Стоимость_выкупленных_долей);
            attribute.plus(sum2);

            m_protocolView.printAlg("Сумма1", sum + " + " + sum2 + " = " +  attribute.getValue());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 201.1_0
     *
     * @param attributeId Идетификатор атрибута
     */

    private macro calculateLine_201_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Выполнение расчета
     */
    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3_DOP("100.5.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3_DOP("100.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_707("100.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_PFI_108_109_708("100.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicNotImplementedPfi("Нереализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(basicImplementedPfi("Реализ ПФИ базовый"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_UB("101.8.3_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708("101.8.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiDoop("Нереализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiDoop("Реализованный ПФИ ДООП"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_707("101.8.1_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_VstrVl("101.10.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_VstrVl("101.10.2_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_VstrVl("104.2.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_VstrVl("104.3.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_VstrVl("104.3.1.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_VstrVl("201.2.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_VstrVl("201.3.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_VstrVl("201.3.1.1_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_1("101.8.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_2("101.8.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3_DOP("101.8.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3_DOP("101.9.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_MONEY_STREAMS_NOT_SS("101.9_ден_потоки_не_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_1("101.9.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_2("101.9.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1("100.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2("100.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_1("100.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_2("100.6.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_3("100.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_7("100.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_3("100.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_Data("101.10_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_3("101.9.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_Data("101.10.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_5("103.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_2("103.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_0("104.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1_Data("104.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_Data("104.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1_Data("104.3.1.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3_Data("200.5.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_108_109_708("200.6.1_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_PFI_707("200.6.1_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3_DOP("200.6.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1_Data("201.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_Data("201.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_1("Коэф_НВ_104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1("Коэф_НВ_104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_1_1("Коэф_НВ_104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1_1("104.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_1("Коэф_НВ_101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1_Data("201.3.1.1_Данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_DOP("200.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_1("200.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_2("200.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_TOTAL_PFI("200.5.1_итог_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_3("200.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_3("200.6.3"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_1("200.6.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_2("200.6.1.2"));

        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_9("200.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_1("Коэф_НВ_201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1("Коэф_НВ_201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_1_1("Коэф_НВ_201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_8("201.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_5("202.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_8("104.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_15("101.15"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
    end;
end;

class (TF123PartCalculateController_XXXX) TF123PartCalculateController_4033(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_XXXX(reportCalculateController, partId);

    private macro calculateLine_100(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.1 + 100.2 + 100.3 + 100.4 + 100.5 + 100.6");
        m_protocolView.printLineValueInfo("100.1", m_part.getAttribute("100.1").getValue());
        m_protocolView.printLineValueInfo("100.2", m_part.getAttribute("100.2").getValue());
        m_protocolView.printLineValueInfo("100.3", m_part.getAttribute("100.3").getValue());
        m_protocolView.printLineValueInfo("100.4", m_part.getAttribute("100.4").getValue());
        m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
        m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());

        attribute.plus(m_part.getAttribute("100.1").getValue()).
                  plus(m_part.getAttribute("100.2").getValue()).
                  plus(m_part.getAttribute("100.3").getValue()).
                  plus(m_part.getAttribute("100.4").getValue()).
                  plus(m_part.getAttribute("100.5").getValue()).
                  plus(m_part.getAttribute("100.6").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_3(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 103.3");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        /**
         * фильтр только по б/с для определения примечания на счете
         */
        var addFilter = m_dataSouceFilters.getFilter("Accounts");
        addFilter.clear();
        addFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК с ДУ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ K3 */
        attribute.multiply(global.parameters.getK3());
        m_protocolView.printParamValue("K3", global.parameters.getK3());
        /* K3 }}} */

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7_3(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        /**
         * фильтр только по б/с для определения примечания на счете
         */
        var addFilter = m_dataSouceFilters.getFilter("Accounts");
        addFilter.clear();
        addFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));

        m_protocolView.printLineInfo(attributeId);
        if (global.getRcbReport().context.period.endDate >= Date(1, 1, 2018))
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K3");
        else
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2)");
        end;

        /* {{{ Сумма 1 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК по 173-ФЗ'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        m_protocolView.printParamValue("Сумма1", currentValue);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        if (global.getRcbReport().context.period.endDate >= Date(1, 1, 2018))
            m_protocolView.printParamValue("K3", global.parameters.getK3());
            attribute.multiply(global.parameters.getK3());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "200.1.1 + 200.1.2 + 200.1.3 + 200.1.4 + 200.1.5 + 200.1.6 + 200.1.7");
            m_protocolView.printLineValueInfo("200.1.1", m_part.getAttribute("200.1.1").getValue());
            m_protocolView.printLineValueInfo("200.1.2", m_part.getAttribute("200.1.2").getValue());
            m_protocolView.printLineValueInfo("200.1.3", m_part.getAttribute("200.1.3").getValue());
            m_protocolView.printLineValueInfo("200.1.4", m_part.getAttribute("200.1.4").getValue());
            m_protocolView.printLineValueInfo("200.1.5", m_part.getAttribute("200.1.5").getValue());
            m_protocolView.printLineValueInfo("200.1.6", m_part.getAttribute("200.1.6").getValue());
            m_protocolView.printLineValueInfo("200.1.7", m_part.getAttribute("200.1.7").getValue());

            attribute.plus(m_part.getAttribute("200.1.1").getValue()).
                      plus(m_part.getAttribute("200.1.2").getValue()).
                      plus(m_part.getAttribute("200.1.3").getValue()).
                      plus(m_part.getAttribute("200.1.4").getValue()).
                      plus(m_part.getAttribute("200.1.5").getValue()).
                      plus(m_part.getAttribute("200.1.6").getValue()).
                      plus(m_part.getAttribute("200.1.7").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7_2(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7.2");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        /**
         * фильтр только по б/с для определения примечания на счете
         */
        var addFilter = m_dataSouceFilters.getFilter("Accounts");
        addFilter.clear();
        addFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК до 01.03.2013'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        m_protocolView.printParamValue("Сумма1", currentValue);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        m_protocolView.printParamValue("K3", global.parameters.getK3());
        attribute.multiply(global.parameters.getK3());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.7");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Сумма
         */
        var currentValue: Money = $0.0;

        /**
         * фильтр только по б/с для определения примечания на счете
         */
        var addFilter = m_dataSouceFilters.getFilter("Accounts");
        addFilter.clear();
        addFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + 200.7.1 + 200.7.2 + 200.7.3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК п. 3.1.8'");
        currentValue = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        attribute.plus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printLineValueInfo("200.7.1", m_part.getAttribute("200.7.1").getValue());
        m_protocolView.printLineValueInfo("200.7.2", m_part.getAttribute("200.7.2").getValue());
        m_protocolView.printLineValueInfo("200.7.3", m_part.getAttribute("200.7.3").getValue());

        attribute.plus(m_part.getAttribute("200.7.1").getValue());
        attribute.plus(m_part.getAttribute("200.7.2").getValue());
        attribute.plus(m_part.getAttribute("200.7.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_7_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var addFilter = m_dataSouceFilters.getFilter("Accounts");                    //фильтр только по б/с для определения примечания на счете

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND(").op("NOT").isSatisfiesToBalanceMasks("52006*").op("OR NOT").contragentIsResident().op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДопК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        addFilter.clear();
        addFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.7_Внебаланс"));
        sum = m_dataSourceAcc.getResidualCostSubLoan(m_dataSourceFilterAcc, addFilter);
        attribute.plus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");

            if (m_part.getAttribute("100.5_доп").getValue() > 0)
                m_protocolView.printAlg(attributeId, "100.5_доп");
                m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());
                m_protocolView.printString("Значение переменной 101.5_доп > 0!");

                if (global.parameters.isConfirmedProfitCurrentDate())
                    attribute.setValue(m_part.getAttribute("100.5_доп").getValue());
                else
                    if (global.parameters.getInclude106InBaseCapital())
                        if (m_part.getAttribute("100.5_доб_капитал").getValue() >= 0)
                            m_protocolView.printAlg(attributeId, "100.5_доб_капитал");
                            m_protocolView.printLineValueInfo("100.5_доб_капитал", m_part.getAttribute("100.5_доб_капитал").getValue());
                            m_protocolView.printString("Значение переменной 101.5_доб_капитал >= 0!");
                            attribute.setValue(m_part.getAttribute("100.5_доб_капитал").getValue());
                        else
                            attribute.setValue($0.0);
                        end;
                    else
                        attribute.setValue($0.0);
                    end;
                end;
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro calculateLine_100_5_add_capital(attributeId: String): Object
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доб_капитал");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);
        m_protocolView.printAlg("Сумма1", currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);
        m_protocolView.printAlg("Сумма2", currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 100.5_дисконт + 100.5.1_доп + 100.5.3_доп - 100.5.2_доп");

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.plus(currentValue);
            temporaryValue[1] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[2] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[3] = currentValue;

            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
        else
            attributeSum1.setValue(0);
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Доходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Расходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
        else
            attributeSum2.setValue(0);
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum3.setValue(currentValue);
            m_protocolView.printAlg("Сумма3", currentValue);
        else
            attributeSum3.setValue(0);
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5._ПФИ", m_part.getAttribute("100.5._ПФИ").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());

        attribute.setValue(attributeSum1.getValue()).
                      plus(attributeSum2.getValue()).
                      minus(attributeSum3.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5._ПФИ").getValue()).
                      plus(m_part.getAttribute("100.5.2_доп").getValue()).
                      minus(m_part.getAttribute("100.5.1_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_PFI(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9_доп").getValue() <= 0)
            m_protocolView.printLineValueInfo("101.9_доп", m_part.getAttribute("101.9_доп").getValue());
            m_protocolView.printString("Значение переменной 101.9_доп <= 0!");
            if (global.parameters.isConfirmedProfitCurrentDate())
                m_protocolView.printAlg(attributeId, "100.5_ПФИ_доп ");
                m_protocolView.printLineValueInfo("100.5_ПФИ_доп", m_part.getAttribute("100.5_ПФИ_доп").getValue());

                attribute.setValue(m_part.getAttribute("100.5_ПФИ_доп").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_PFI_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_ПФИ_Доходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_ПФИ_Расходы"));
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "100.5.1")
            m_protocolView.printAlg(attributeId, "100.5.1.1 + 100.5.1.2 + 100.5.1.3 + 100.5.1.4");

            m_protocolView.printLineValueInfo("100.5.1.1", m_part.getAttribute("100.5.1.1").getValue());
            m_protocolView.printLineValueInfo("100.5.1.2", m_part.getAttribute("100.5.1.2").getValue());
            m_protocolView.printLineValueInfo("100.5.1.3", m_part.getAttribute("100.5.1.3").getValue());
            m_protocolView.printLineValueInfo("100.5.1.4", m_part.getAttribute("100.5.1.4").getValue());

            attribute.setValue(m_part.getAttribute("100.5.1.1").getValue()).
                          plus(m_part.getAttribute("100.5.1.2").getValue()).
                          plus(m_part.getAttribute("100.5.1.3").getValue()).
                          plus(m_part.getAttribute("100.5.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.1_доп");
            m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
            m_protocolView.printString("Значение переменной 100.5 > 0!");

            attribute.setValue(m_part.getAttribute("100.5.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.5").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.5.2_доп");
            m_protocolView.printLineValueInfo("100.5", m_part.getAttribute("100.5").getValue());
            m_protocolView.printString("Значение переменной 100.5 > 0!");

            attribute.setValue(m_part.getAttribute("100.5.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var previousReport = objectFactoryInstance.createPreviousReport();
        var attr_100_6 = 0;

        m_protocolView.printLineInfo(attributeId);

        if (objectFactoryInstance.createPreviousReport().isCalculated)
            attr_100_6 = previousReport.getPart("").getAttribute("100.6").getValue();
        end;

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за Дата Ауд_прошлГ - 100.6.1_доп");
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
            m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue()).
                         minus(m_part.getAttribute("100.6.1_доп").getValue()).
        else
            if (global.parameters.getUnconfirmedProfitBasel() == "2.1.8")
                m_protocolView.printAlg(attributeId, "MIN(Прибыль прошлых лет за Дата Ауд_прошлГ, 100.6) + Прибыль предшествующих лет без прибыли прошлого года - 100.6.1_доп");
                m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
                m_protocolView.printLineValueInfo("100.6", attr_100_6);
                m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());

                attribute.setValue(min(m_part.getAttribute("Прибыль прошлого года").getValue(), attr_100_6));
            else
                attribute.setValue($0.0);
            end;

            attribute.plus(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue()).
                     minus(m_part.getAttribute("100.6.2_доп").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Прибыль прошлых лет */
    private macro profitLastYears(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 + Сумма3 + Сумма4 + 100.6_ПФИ_доп + 100.6.2_доп");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов, forDate);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                      plus(m_part.getAttribute("100.6_ПФИ_доп").getValue()).
                      plus(m_part.getAttribute("100.6.2_доп").getValue());

        m_protocolView.printLineValueInfo("100.6_ПФИ_доп", m_part.getAttribute("100.6_ПФИ_доп").getValue());
        m_protocolView.printLineValueInfo("100.6.2_доп", m_part.getAttribute("100.6.2_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /* Финансовый результат прошлого года за ДООП*/
    private macro finResultPreviousYearForDate(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var attrSum4_1 = m_part.getAttribute("attrSum4_1");
        var attrSum5 = m_part.getAttribute("attrSum5");
        var attrSum5_1 = m_part.getAttribute("attrSum5_1");
        var attrSum6 = m_part.getAttribute("attrSum6");
        var attrSum7 = m_part.getAttribute("attrSum7");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1  + Сумма2 + Сумма3 + Сумма4 - Сумма5 + Сумма6 + Сумма7");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attrSum3.minus(sum);
        attrSum3.multiply(global.parameters.getK1());
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", "(" + tempVal[0] + " - " + tempVal[1] + ") * " + global.parameters.getK1() + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70801*");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum4_1.setValue(sum);
        tempVal[1] = sum;

        attrSum4.minus(attrSum4_1.getValue());
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма5:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70802*");
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum5.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("70802*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, forDate);
        attrSum5_1.setValue(sum);
        tempVal[1] = sum;

        attrSum5.minus(attrSum5_1.getValue());
        m_protocolView.printAlg("Сумма5", tempVal[0] + " - " + tempVal[1] + " = " + attrSum5.getValue());
        tempVal.size = 0;

        attrSum6.setValue(attrSum4_1.getValue());
        attrSum6.minus(attrSum5_1.getValue());
        attrSum6.multiply(global.parameters.getK1());
        m_protocolView.printAlg("Сумма6", "(" + attrSum4_1.getValue() + " - " + attrSum5_1.getValue() + ") * " + global.parameters.getK1() + " = " + attrSum6.getValue());

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма7:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum7.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attrSum7.minus(sum);
        tempVal[1] = sum;

        if (attrSum7.getValue > 0)
            attrSum7.div(100);
            attrSum7.multiply(global.parameters.getK4());
            m_protocolView.printParamValue("K4", global.parameters.getK4());
            m_protocolView.printAlg("Сумма7", "(" + tempVal[0] + " - " + tempVal[1] + ") / 100 * " + global.parameters.getK4() + " = " + attrSum7.getValue());
        else
            m_protocolView.printAlg("Сумма7", tempVal[0] + " - " + tempVal[1] + " = " + attrSum7.getValue());
        end;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                     minus(attrSum5.getValue()).
                      plus(attrSum6.getValue()).
                      plus(attrSum7.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_PFI_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "100.6_ПФИ_707 + 100.6_ПФИ_108_109_708");
        m_protocolView.printLineValueInfo("100.6_ПФИ_707", m_part.getAttribute("100.6_ПФИ_707").getValue());
        m_protocolView.printLineValueInfo("100.6_ПФИ_108_109_708", m_part.getAttribute("100.6_ПФИ_108_109_708").getValue());

        attribute.setValue(m_part.getAttribute("100.6_ПФИ_707").getValue()).
                      plus(m_part.getAttribute("100.6_ПФИ_108_109_708").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_PFI_707(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);


        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_PFI_108_109_708(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "100.6.1")
            m_protocolView.printAlg(attributeId, "100.6.1.1 + 100.6.1.2 + 100.6.1.3 + 100.6.1.4");

            m_protocolView.printLineValueInfo("100.6.1.1", m_part.getAttribute("100.6.1.1").getValue());
            m_protocolView.printLineValueInfo("100.6.1.2", m_part.getAttribute("100.6.1.2").getValue());
            m_protocolView.printLineValueInfo("100.6.1.3", m_part.getAttribute("100.6.1.3").getValue());
            m_protocolView.printLineValueInfo("100.6.1.4", m_part.getAttribute("100.6.1.4").getValue());

            attribute.setValue(m_part.getAttribute("100.6.1.1").getValue()).
                          plus(m_part.getAttribute("100.6.1.2").getValue()).
                          plus(m_part.getAttribute("100.6.1.3").getValue()).
                          plus(m_part.getAttribute("100.6.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.1_доп");
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            attribute.setValue(m_part.getAttribute("100.6.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_2_DOP(attributeId : String)

        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal =TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;

            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            m_dataSourceFilterAcc.clear();

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum2.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum3.setValue(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                         minus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("100.6").getValue() > 0)
            m_protocolView.printAlg(attributeId, "100.6.2_доп");
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printString("Значение переменной 100.6 > 0!");

            attribute.setValue(m_part.getAttribute("100.6.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.1 + 101.2 + 101.3 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10 + 101.11 + 101.12 + 101.13 + 101.14 + 101.15");
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10", m_part.getAttribute("101.10").getValue());
        m_protocolView.printLineValueInfo("101.11", m_part.getAttribute("101.11").getValue());
        m_protocolView.printLineValueInfo("101.12", m_part.getAttribute("101.12").getValue());
        m_protocolView.printLineValueInfo("101.13", m_part.getAttribute("101.13").getValue());
        m_protocolView.printLineValueInfo("101.14", m_part.getAttribute("101.14").getValue());
        m_protocolView.printLineValueInfo("101.15", m_part.getAttribute("101.15").getValue());

        attribute.plus(m_part.getAttribute("101.1").getValue()).
                  plus(m_part.getAttribute("101.2").getValue()).
                  plus(m_part.getAttribute("101.3").getValue()).
                  plus(m_part.getAttribute("101.4").getValue()).
                  plus(m_part.getAttribute("101.5").getValue()).
                  plus(m_part.getAttribute("101.6").getValue()).
                  plus(m_part.getAttribute("101.7").getValue()).
                  plus(m_part.getAttribute("101.8").getValue()).
                  plus(m_part.getAttribute("101.9").getValue()).
                  plus(m_part.getAttribute("101.10").getValue()).
                  plus(m_part.getAttribute("101.11").getValue()).
                  plus(m_part.getAttribute("101.12").getValue()).
                  plus(m_part.getAttribute("101.13").getValue()).
                  plus(m_part.getAttribute("101.14").getValue()).
                  plus(m_part.getAttribute("101.15").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_1(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;


        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма_1 - Сумма_2) * K1 + Строка_101.1.1 + Строка_101.1.2,");

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo("101.1.1", m_part.getAttribute("101.1.1").getValue());
        m_protocolView.printLineValueInfo("101.1.2", m_part.getAttribute("101.1.2").getValue());

        attribute.plus(m_part.getAttribute("101.1.1").getValue()).
                  plus(m_part.getAttribute("101.1.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'АктОтч при ООВО БПП'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'АктОтч при ООВО БПП'");
        sum = m_dataSourceAcc.getData(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'НМА'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Активы под упр. УпрК'");
        sum = m_dataSourceAcc.getData(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.4.0 + 101.4.1 + 101.4.2 + 101.4.3 + 101.4.4 + 101.4.5");
        m_protocolView.printLineValueInfo("101.4.0", m_part.getAttribute("101.4.0").getValue());
        m_protocolView.printLineValueInfo("101.4.1", m_part.getAttribute("101.4.1").getValue());
        m_protocolView.printLineValueInfo("101.4.2", m_part.getAttribute("101.4.2").getValue());
        m_protocolView.printLineValueInfo("101.4.3", m_part.getAttribute("101.4.3").getValue());
        m_protocolView.printLineValueInfo("101.4.4", m_part.getAttribute("101.4.4").getValue());
        m_protocolView.printLineValueInfo("101.4.5", m_part.getAttribute("101.4.5").getValue());

        attribute.setValue(m_part.getAttribute("101.4.0").getValue()).
                      plus(m_part.getAttribute("101.4.1").getValue()).
                      plus(m_part.getAttribute("101.4.2").getValue()).
                      plus(m_part.getAttribute("101.4.3").getValue()).
                      plus(m_part.getAttribute("101.4.4").getValue()).
                      plus(m_part.getAttribute("101.4.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.3")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.5")).op(")").
                                  op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_4(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.4.2");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Фильтр 1 для суммы 1
         */
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Фильтр 2 для суммы 2
         */
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            currentValue = m_dataSourceAcc.getData(filterFromSum1);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum2);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum2);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.5")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_ПИФ"));
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            filterFromSum2.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВЛ в ДУ НВР'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.2_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_5_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.5.3_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_7(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankOOO())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДУЧ ООВ'");
            sum = m_dataSourceAcc.getData(filterFromSum2);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum2);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 101.9_дисконт - 101.9_ПФИ_доп + 101.9.1_доп + 101.9.2_доп");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Расходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Доходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9_ПФИ_доп", m_part.getAttribute("101.9_ПФИ_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("101.9_дисконт").getValue());
        attribute.minus(m_part.getAttribute("101.9_ПФИ_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.1_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_PFI_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
            m_protocolView.printString("Значение переменной 101.9 > 0!");
            m_protocolView.printAlg(attributeId, "101.9.1_доп");

            attribute.setValue(m_part.getAttribute("101.9.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.9.1")
            m_protocolView.printAlg(attributeId, "101.9.1.1 + 101.9.1.2 + 101.9.1.3 + 101.9.1.4");
            m_protocolView.printLineValueInfo("101.9.1.1", m_part.getAttribute("101.9.1.1").getValue());
            m_protocolView.printLineValueInfo("101.9.1.2", m_part.getAttribute("101.9.1.2").getValue());
            m_protocolView.printLineValueInfo("101.9.1.3", m_part.getAttribute("101.9.1.3").getValue());
            m_protocolView.printLineValueInfo("101.9.1.4", m_part.getAttribute("101.9.1.4").getValue());
            attribute.setValue(m_part.getAttribute("101.9.1.1").getValue()).
                          plus(m_part.getAttribute("101.9.1.2").getValue()).
                          plus(m_part.getAttribute("101.9.1.3").getValue()).
                          plus(m_part.getAttribute("101.9.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.9").getValue() > 0)
            m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
            m_protocolView.printString("Значение переменной 101.9 > 0!");
            m_protocolView.printAlg(attributeId, "101.9.2_доп");

            attribute.setValue(m_part.getAttribute("101.9.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.2_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.2_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.minus(sum);
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.10.1 + 101.10.2 + 101.10.3 + 101.10.4");
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());
        m_protocolView.printLineValueInfo("101.10.2", m_part.getAttribute("101.10.2").getValue());
        m_protocolView.printLineValueInfo("101.10.3", m_part.getAttribute("101.10.3").getValue());
        m_protocolView.printLineValueInfo("101.10.4", m_part.getAttribute("101.10.4").getValue());

        attribute.setValue(m_part.getAttribute("101.10.1").getValue()).
                      plus(m_part.getAttribute("101.10.2").getValue()).
                      plus(m_part.getAttribute("101.10.3").getValue()).
                      plus(m_part.getAttribute("101.10.4").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.10.1_Несущ_ВстрВлож + 101.10.1_Сущ_ВстрВлож");
        m_protocolView.printLineValueInfo("101.10.1_Несущ_ВстрВлож", m_part.getAttribute("101.10.1_Несущ_ВстрВлож").getValue());
        m_protocolView.printLineValueInfo("101.10.1_Сущ_ВстрВлож", m_part.getAttribute("101.10.1_Сущ_ВстрВлож").getValue());

        attribute.setValue(m_part.getAttribute("101.10.1_Несущ_ВстрВлож").getValue()).
                      plus(m_part.getAttribute("101.10.1_Сущ_ВстрВлож").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_4(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 104.1.4");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Фильтр для суммы 1 атрибута
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2: Object = m_dataSouceFilters.getFilter("Accounts");

        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");

            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ПИФ'");
            currentValue = m_dataSourceAcc.getData(filterFromSum1);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;
            currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.5")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_ПИФ"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.2.1 + 104.2.2 + 104.2.3");
        m_protocolView.printLineValueInfo("104.2.1", m_part.getAttribute("104.2.1").getValue());
        m_protocolView.printLineValueInfo("104.2.2", m_part.getAttribute("104.2.2").getValue());
        m_protocolView.printLineValueInfo("104.2.3", m_part.getAttribute("104.2.3").getValue());

        attribute.setValue(m_part.getAttribute("104.2.1").getValue()).
                      plus(m_part.getAttribute("104.2.2").getValue()).
                      plus(m_part.getAttribute("104.2.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_1(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 104.7.1");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1"));
        m_dataSOurceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.1_Амортизация"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК Прил. к 395-П'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);
        /* Сумма 2 }}} */

        m_protocolView.printParamValue("K2", global.parameters.getK2());
        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_8(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.8");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Сумма 1
         */
        var attributeSum1: Money = $0.0;
        /**
         * Сумма 2
         */
        var attributeSum2: Money = $0.0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "min(Сумма1; Сумма2)");

        /* {{{ Сумма 1 */
        if (global.parameters.getDateRevaluation() <= rcbApplication().currentReport.context.period.endDate)
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            attributeSum1 = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getDateRevaluation());
        else
            attributeSum1 = $0.0;
        end;
        m_protocolView.printParamValue("Сумма1", attributeSum1);
        /* Сумма 1 */

        /* {{{ Сумма 2 */
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10610*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        attributeSum2 = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getDateRevaluation());
        m_protocolView.printParamValue("Сумма2", attributeSum2);
        /* Сумма 2 */

        if (attributeSum1 < attributeSum2)
            attribute.setValue(attributeSum1);
        else
            attribute.setValue(attributeSum2);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_3(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 201.1.3");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущие значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2 : Object= m_part.getAttribute("attrSum2");
        /**
         * Фильтр для суммы 1
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");

            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");
            currentValue = m_dataSourceAcc.getData(filterFromSum1);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;
            currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_4(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.8");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущие значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2 : Object= m_part.getAttribute("attrSum2");
        /**
         * Сумма 3
         */
        var attributeSum3 : Object= m_part.getAttribute("attrSum3");
        /**
         * Фильтр для суммы 1
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");

            /* {{{ Сумма 1 */
            m_protocolView.printLine("Сумма1:");
            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");

            filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId));
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            filterFromSum2.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");

            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
            currentValue = m_dataSourceAcc.getData(filterFromSum2);
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;
            currentValue = m_dataSourceAcc.getReservesData(filterFromSum2);
            attributeSum1.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
            /* Сумма 1 }}} */

            /* {{{ Сумма 2 */
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
            currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
            /* Сумма 2 }}} */

            /* {{{ Сумма 3 */
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_ПИФ"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            temporaryValue[0] = currentValue;
            attributeSum3.setValue(currentValue);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            temporaryValue[1] = currentValue;
            attributeSum3.minus(currentValue);
            m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
            temporaryValue.size = 0;
            /* Сумма 3 }}} */

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(attributeSum1.getValue());
            attribute.plus(attributeSum2.getValue());
            attribute.plus(attributeSum3.getValue());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.5")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Иные влож. в капитал'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_ПИФ"));
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВЛ в ДУ'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attrSum3.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attrSum3.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                          plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.2_0 + 201.2.1 + 201.2.2 + 201.2.3");
        m_protocolView.printLineValueInfo("201.2_0", m_part.getAttribute("201.2_0").getValue());
        m_protocolView.printLineValueInfo("201.2.1", m_part.getAttribute("201.2.1").getValue());
        m_protocolView.printLineValueInfo("201.2.2", m_part.getAttribute("201.2.2").getValue());
        m_protocolView.printLineValueInfo("201.2.3", m_part.getAttribute("201.2.3").getValue());

        attribute.setValue(m_part.getAttribute("201.2_0").getValue()).
                      plus(m_part.getAttribute("201.2.1").getValue()).
                      plus(m_part.getAttribute("201.2.2").getValue()).
                      plus(m_part.getAttribute("201.2.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_203(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200 - 201 + 202");
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("201", m_part.getAttribute("201").getValue());
        m_protocolView.printLineValueInfo("202", m_part.getAttribute("202").getValue());

        attribute.setValue(m_part.getAttribute("200").getValue()).
                     minus(m_part.getAttribute("201").getValue()).
                      plus(m_part.getAttribute("202").getValue());

        if (attribute.getValue() < 0)
            attribute.setValue($0.0)
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Sprav_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) - Справ_3.2");

        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);

        m_protocolView.printLineValueInfo("Справ_3.2", m_part.getAttribute("Справ_3.2").getValue());

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue()).
                     minus(m_part.getAttribute("Справ_3.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Sprav_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var year;

        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        year = year - 1;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2)");

        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("Справ_3_Увел_Нер_ПФИ"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, Date(31, 12, year));
        attrSum1.minus(sum).
                 minus(m_part.getAttribute("Сумма_Оплач_Премий_52601").getValue());

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("Справ_3_Уменьш_Нер_ПФИ"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, Date(31, 12, year));
        attrSum2.minus(sum).
                 minus(m_part.getAttribute("Сумма_Получ_Премий_52602").getValue());

        m_protocolView.printLineValueInfo("Справ_3.2", m_part.getAttribute("Справ_3.2").getValue());

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_5(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 201.5");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.5_ввод * K1");
        m_protocolView.printLineValueInfo("201.5_ввод", m_part.getAttribute("201.5_ввод").getValue());

        attribute.setValue(m_part.getAttribute("201.5_ввод").getValue());
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_1_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 202.3.1_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 2
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Временный фильтр
         */
        var tempFilter: Object = m_dataSouceFilters.getFilter("Accounts");

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3_ист_СС").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());
            m_protocolView.printString("Значение переменной 202.3_ист_СС > 0!");
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");

            tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС"));
            currentValue = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(currentValue);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация"));
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(currentValue);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(currentValue).
                      minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        else
            m_dataSourceFilterAcc.clear();
            tempFilter.clear();
            m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2 - Сумма3 201.7.5_202.3.1_имущество");
            m_protocolView.printLine("Сумма1:");

            tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_ОС_1"));
            currentValue = m_dataSourceAcc.getData(tempFilter);
            attribute.setValue(currentValue);
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.1_Амортизация"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
            currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.minus(currentValue);
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.op("AND").add(tempFilter);
            currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());

            attribute.minus(currentValue).
                     minus(m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_2_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 202.3.2_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временный фильтр
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Врменное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.2"));
        filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
        currentValue = m_dataSourceAcc.getData(filterFromSum1);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
        attributeSum1.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3_полож_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3_отриц_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма 2 }}} */

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_3_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 202.3.2_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Текущее значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временный фильтр
         */
        var filterFromSum1: Object = m_dataSouceFilters.getFilter("Accounts");
        /**
         * Врменное значение
         */
        var temporaryValue: TArray = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 + Сумма3");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3"));
        filterFromSum1.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Активы под упр. УпрК'");
        currentValue = m_dataSourceAcc.getData(filterFromSum1);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        currentValue = m_dataSourceAcc.getReservesData(filterFromSum1);
        attributeSum1.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3_полож_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3_отриц_переоц"));
        currentValue = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("202.3.3_ПИФ")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ВложКО в соотв. с п.4.2.2'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        temporaryValue[0] = currentValue;
        currentValue = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attributeSum3.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма3", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum3.getValue());
        temporaryValue.size = 0;
        /* Сумма 3 }}} */

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.plus(attributeSum3.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.5_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 200.5_дисконт + 200.5_ПФИ_данные + 200.5.2_данные - 200.5.1_данные");

        /* {{{  Сумма 1 */
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;

        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /*  Сумма 1 }}} */


        /* {{{ Сумма2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Расходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("200.5_дисконт", m_part.getAttribute("200.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("200.5_ПФИ_данные", m_part.getAttribute("200.5_ПФИ_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("200.5_дисконт").getValue());
        attribute.plus(m_part.getAttribute("200.5_ПФИ_данные").getValue());
        attribute.plus(m_part.getAttribute("200.5.2_данные").getValue());
        attribute.minus(m_part.getAttribute("200.5.1_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_PFI_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
            m_protocolView.printString("Значение переменной 200.5 > 0!");
            m_protocolView.printAlg(attributeId, "200.5.1_данные");
            m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());

            attribute.setValue(m_part.getAttribute("200.5.1_данные").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.5.1")
            m_protocolView.printAlg(attributeId, "200.5.2.1 + 200.5.2.2 + 200.5.2.3 + 200.5.2.4");
            m_protocolView.printLineValueInfo("200.5.1.1", m_part.getAttribute("200.5.1.1").getValue());
            m_protocolView.printLineValueInfo("200.5.1.2", m_part.getAttribute("200.5.1.2").getValue());
            m_protocolView.printLineValueInfo("200.5.1.3", m_part.getAttribute("200.5.1.3").getValue());
            m_protocolView.printLineValueInfo("200.5.1.4", m_part.getAttribute("200.5.1.4").getValue());

            attribute.setValue(m_part.getAttribute("200.5.1.1").getValue()).
                          plus(m_part.getAttribute("200.5.1.2").getValue()).
                          plus(m_part.getAttribute("200.5.1.3").getValue()).
                          plus(m_part.getAttribute("200.5.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.5").getValue() > 0)
            m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
            m_protocolView.printString("Значение переменной 200.5 > 0!");
            m_protocolView.printAlg(attributeId, "200.5.2_данные - 100.5.2");
            m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());
            m_protocolView.printLineValueInfo("100.5.2", m_part.getAttribute("100.5.2").getValue());

                attribute.setValue(m_part.getAttribute("200.5.2_данные").getValue()).
                             minus(m_part.getAttribute("100.5.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.2_доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.6");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Год окончания отчетного периода
         */
        var yearEndDate:  Integer = 0;
        /**
         * Месяц окончания отчетного периода
         */
        var monthEndDate: Integer = 0;
        /**
         * День окончания отчетного периода
         */
        var dayEndDate:   Integer = 0;

        dateSplit(rcbApplication().currentReport.context.period.endDate, dayEndDate, monthEndDate, yearEndDate);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Прибыль предшествующих лет без прибыли прошлого года + Прибыль прошлого года - 200.6.1_доп - 100.6");
        if ((monthEndDate < 7) OR ((monthEndDate == 7) AND (dayEndDate < 1)))
            m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
            m_protocolView.printLineValueInfo("Прибыль прошлого года", m_part.getAttribute("Прибыль прошлого года").getValue());
            m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue()).
                           plus(m_part.getAttribute("Прибыль прошлого года").getValue()).
                          minus(m_part.getAttribute("200.6.1_доп").getValue()).
                          minus(m_part.getAttribute("100.6").getValue());

            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

                attribute.setValue($0.0);
            end;
        elif (global.parameters.isConfirmedProfitLastDate())
            attribute.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue()).
                         minus(m_part.getAttribute("200.6.1_доп").getValue()).
                         minus(m_part.getAttribute("100.6").getValue());
            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.6.1")
            m_protocolView.printAlg(attributeId, "200.6.1.1 + 200.6.1.2 + 200.6.1.3 + 200.6.1.4");
            m_protocolView.printLineValueInfo("200.6.1.1", m_part.getAttribute("200.6.1.1").getValue());
            m_protocolView.printLineValueInfo("200.6.1.2", m_part.getAttribute("200.6.1.2").getValue());
            m_protocolView.printLineValueInfo("200.6.1.3", m_part.getAttribute("200.6.1.3").getValue());
            m_protocolView.printLineValueInfo("200.6.1.4", m_part.getAttribute("200.6.1.4").getValue());

            attribute.setValue(m_part.getAttribute("200.6.1.1").getValue()).
                          plus(m_part.getAttribute("200.6.1.2").getValue()).
                          plus(m_part.getAttribute("200.6.1.3").getValue()).
                          plus(m_part.getAttribute("200.6.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.1_доп");

            attribute.setValue(m_part.getAttribute("200.6.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Прибыль_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Убыток_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                     minus(attrSum3.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6").getValue() > 0)
            m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
            m_protocolView.printString("Значение переменной 200.6 > 0!");
            m_protocolView.printAlg(attributeId, "200.6.2_доп - 100.6.2");
            m_protocolView.printLineValueInfo("200.6.2_доп", m_part.getAttribute("200.6.2_доп").getValue());
            m_protocolView.printLineValueInfo("100.6.2", m_part.getAttribute("100.6.2").getValue());

            attribute.setValue(m_part.getAttribute("200.6.2_доп").getValue()).
                             minus(m_part.getAttribute("100.6.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_14(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.14.1 + 101.14.2 + 101.14.3");
        m_protocolView.printLineValueInfo("101.14.1", m_part.getAttribute("101.14.1").getValue());
        m_protocolView.printLineValueInfo("101.14.2", m_part.getAttribute("101.14.2").getValue());
        m_protocolView.printLineValueInfo("101.14.3", m_part.getAttribute("101.14.3").getValue());

        attribute.setValue(m_part.getAttribute("101.14.1").getValue()).
                      plus(m_part.getAttribute("101.14.2").getValue()).
                      plus(m_part.getAttribute("101.14.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_102(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100 - 101");
        m_protocolView.printLineValueInfo("100", m_part.getAttribute("100").getValue());
        m_protocolView.printLineValueInfo("101", m_part.getAttribute("101").getValue());

        attribute.setValue(m_part.getAttribute("100").getValue()).
                     minus(m_part.getAttribute("101").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "103.1 + 103.2 + 103.3 + 103.4");
        m_protocolView.printLineValueInfo("103.1", m_part.getAttribute("103.1").getValue());
        m_protocolView.printLineValueInfo("103.2", m_part.getAttribute("103.2").getValue());
        m_protocolView.printLineValueInfo("103.3", m_part.getAttribute("103.3").getValue());
        m_protocolView.printLineValueInfo("103.4", m_part.getAttribute("103.4").getValue());

        attribute.setValue(m_part.getAttribute("103.1").getValue()).
                      plus(m_part.getAttribute("103.2").getValue()).
                      plus(m_part.getAttribute("103.3").getValue()).
                      plus(m_part.getAttribute("103.4").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК бессрочный'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК бессрочный'");

        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);

        attribute.setValue(sum).
                      plus(m_part.getAttribute("103.4.1").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_103_4_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("103.4.1")).op("AND(").op("NOT").isSatisfiesToBalanceMasks("52006*").op("OR NOT").contragentIsResident().op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'СК на 50 лет'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ДобК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.1 + 104.2 + 104.3 + 104.4 + 104.5 + 104.6 + 104.7");
        m_protocolView.printLineValueInfo("104.1", m_part.getAttribute("104.1").getValue());
        m_protocolView.printLineValueInfo("104.2", m_part.getAttribute("104.2").getValue());
        m_protocolView.printLineValueInfo("104.3", m_part.getAttribute("104.3").getValue());
        m_protocolView.printLineValueInfo("104.4", m_part.getAttribute("104.4").getValue());
        m_protocolView.printLineValueInfo("104.5", m_part.getAttribute("104.5").getValue());
        m_protocolView.printLineValueInfo("104.6", m_part.getAttribute("104.6").getValue());
        m_protocolView.printLineValueInfo("104.7", m_part.getAttribute("104.7").getValue());

        attribute.setValue(m_part.getAttribute("104.1").getValue()).
                      plus(m_part.getAttribute("104.2").getValue()).
                      plus(m_part.getAttribute("104.3").getValue()).
                      plus(m_part.getAttribute("104.4").getValue()).
                      plus(m_part.getAttribute("104.5").getValue()).
                      plus(m_part.getAttribute("104.6").getValue()).
                      plus(m_part.getAttribute("104.7").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3.1_данные + 202.3.2_данные + 202.3.3_данные");
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());

        attribute.setValue(m_part.getAttribute("202.3.1_данные").getValue()).
                      plus(m_part.getAttribute("202.3.2_данные").getValue()).
                      plus(m_part.getAttribute("202.3.3_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_5_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);
        tempFilter.op("(").isSatisfiesToBalanceMasks("60701*").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'НМА'").op(")").op("OR").op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_ОС")).op("AND NOT").isSatisfiesToBalanceMasks("60701*").op(")");
        sum = m_dataSourceAcc.getData(tempFilter);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.op("AND").add(tempFilter);
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[2] = sum;

        m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        tempVal[3] = m_part.getAttribute("201.7.5_202.3.1_имущество").getValue();
        attrSum1.minus(tempVal[3]);

        m_protocolView.printAlg(attributeId, tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " - " + tempVal[3] + " = " + attrSum1.getValue());
    end;

    private macro calculateLine_101_4_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");

            filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.3")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения, отчужд. по сделкам РЕПО'");
            sum = m_dataSourceAcc.getData(filterFromSum1);
            attrSum1.setValue(sum);
            tempVal[0] = sum;
            sum = m_dataSourceAcc.getReservesData(filterFromSum1);
            attrSum1.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            tempVal.size = 0;

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_полож_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
            attrSum2.setValue(sum);
            tempVal[0] = sum;
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.4_отриц_переоц"));
            sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
            attrSum2.minus(sum);
            tempVal[1] = sum;
            m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
            tempVal.size = 0;

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_101_10_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 101.10.2) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("101.10.2", m_part.getAttribute("101.10.2").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                  multiply(m_part.getAttribute("101.10.2").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (101.10.2_данные * Коэф_НВ_101.10.2)");
            m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_101.10.2", m_part.getAttribute("Коэф_НВ_101.10.2").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("101.10.2_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_101.10.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_1_NesVstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = Tarray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;


        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_3_NeudVloj(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Неуд. влож. КО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'Неуд. влож. КО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Неуд. влож. КО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_3(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        var attrSum1  = $0.0;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "MIN(101.10.3_данные, Сумма1) + 101.10.3_НеудВлож");

        attrSum1 = m_part.getAttribute("101.10.3_данные").getValue() - (m_part.getAttribute("Сумма_БК_1").getValue() * 0.1);

        m_protocolView.printLine("Сумма1 = 101.10.3_данные - (0.1 * Сумма_БК_1)");
        m_protocolView.printLineValueInfo("101.10.3_данные", m_part.getAttribute("101.10.3_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        println();
        println("Сумма1 = " + attrSum1);

        if (attrSum1 < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attrSum1 = $0.0;
        end;

        attribute.setValue(min(m_part.getAttribute("101.10.3_данные").getValue(), attrSum1) + m_part.getAttribute("101.10.3_НеудВлож").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_1_SushVstrVl(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 + Сумма3) * K1");
        m_protocolView.printLine("Сумма1:");
        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10.1_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.10_кредиты")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").contragentIsFinancialInstitution().op(")").op("AND").op(" ( ").isExistAccountNoteGreatOrEq(10).op("OR").hasAssignedCategoryContr(RCB_OBJTYPE_PARTY, RCB_OBJGROUP_AFFILIATES_CREDIT_ORG, "'АФЛ'").op(" ) ");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue).
                      plus(attrSum2.getValue()).
                      plus(attrSum3.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.15);

        m_protocolView.printLine("Сумма1 = 101.10.4_данные - 101.3 - 101.10.3 - (0.15 * Сумма_БК_1)");
        m_protocolView.printLineValueInfo("101.10.4_данные", m_part.getAttribute("101.10.4_данные").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.10.3", m_part.getAttribute("101.10.3").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.10.4_данные").getValue()).
                     minus(m_part.getAttribute("101.3").getValue()).
                     minus(m_part.getAttribute("101.10.3").getValue()).
                     minus(attrSum1.getValue());

        println();
        println("Сумма1 =" + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_11(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104 - 103");
        m_protocolView.printLineValueInfo("104", m_part.getAttribute("104").getValue());
        m_protocolView.printLineValueInfo("103", m_part.getAttribute("103").getValue());

        attribute.setValue(m_part.getAttribute("104").getValue()).
                     minus(m_part.getAttribute("103").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.2.2_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.2.2_данные", m_part.getAttribute("104.2.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("104.2.2_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.2.2_данные * Коэф_НВ_104.2.2)");
            m_protocolView.printLineValueInfo("104.2.2_данные", m_part.getAttribute("104.2.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.2.2", m_part.getAttribute("Коэф_НВ_104.2.2").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.2.2_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.2.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_2_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "104.3.1 + 104.3.2 + 104.3.3");
        m_protocolView.printLineValueInfo("104.3.1", m_part.getAttribute("104.3.1").getValue());
        m_protocolView.printLineValueInfo("104.3.2", m_part.getAttribute("104.3.2").getValue());
        m_protocolView.printLineValueInfo("104.3.3", m_part.getAttribute("104.3.3").getValue());

        attribute.setValue(m_part.getAttribute("104.3.1").getValue()).
                      plus(m_part.getAttribute("104.3.2").getValue()).
                      plus(m_part.getAttribute("104.3.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.2_данные * Коэф_НВ_104.3.2)");
            m_protocolView.printLineValueInfo("104.3.2_данные", m_part.getAttribute("104.3.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.2", m_part.getAttribute("Коэф_НВ_104.3.2").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.2_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.3.2_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.3.2_данные", m_part.getAttribute("104.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("104.3.2_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Значение переменной Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (104.3.1.2_данные * Коэф_НВ_104.3.2.1)");
            m_protocolView.printLineValueInfo("104.3.1.2_данные", m_part.getAttribute("104.3.1.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_104.3.2.1", m_part.getAttribute("Коэф_НВ_104.3.2.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("104.3.1.2_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_104.3.2.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_нерез")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_нерез")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.7.1 - 200");
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());

        attribute.setValue(m_part.getAttribute("200").getValue()).
                     minus(m_part.getAttribute("201.7.1").getValue());

        if (attribute.getValue() <= 0)
            attribute.setValue(m_part.getAttribute("201.7.1").getValue()).
                         minus(m_part.getAttribute("200").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_105(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "103 - 104");
        m_protocolView.printLineValueInfo("103", m_part.getAttribute("103").getValue());
        m_protocolView.printLineValueInfo("104", m_part.getAttribute("104").getValue());

        attribute.setValue(m_part.getAttribute("103").getValue()).
                     minus(m_part.getAttribute("104").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200.1 + 200.2 + 200.3 + 200.4 + 200.5 + 200.6 + 200.7 + 200.8 + 200.9");
        m_protocolView.printLineValueInfo("200.1", m_part.getAttribute("200.1").getValue());
        m_protocolView.printLineValueInfo("200.2", m_part.getAttribute("200.2").getValue());
        m_protocolView.printLineValueInfo("200.3", m_part.getAttribute("200.3").getValue());
        m_protocolView.printLineValueInfo("200.4", m_part.getAttribute("200.4").getValue());
        m_protocolView.printLineValueInfo("200.5", m_part.getAttribute("200.5").getValue());
        m_protocolView.printLineValueInfo("200.6", m_part.getAttribute("200.6").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());

        attribute.setValue(m_part.getAttribute("200.1").getValue()).
                      plus(m_part.getAttribute("200.2").getValue()).
                      plus(m_part.getAttribute("200.3").getValue()).
                      plus(m_part.getAttribute("200.4").getValue()).
                      plus(m_part.getAttribute("200.5").getValue()).
                      plus(m_part.getAttribute("200.6").getValue()).
                      plus(m_part.getAttribute("200.7").getValue()).
                      plus(m_part.getAttribute("200.8").getValue()).
                      plus(m_part.getAttribute("200.9").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.1 + 201.2 + 201.3 + 201.4 + 201.5 + 201.7");
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());
        m_protocolView.printLineValueInfo("201.4", m_part.getAttribute("201.4").getValue());
        m_protocolView.printLineValueInfo("201.5", m_part.getAttribute("201.5").getValue());
        m_protocolView.printLineValueInfo("201.7", m_part.getAttribute("201.7").getValue());

        attribute.setValue(m_part.getAttribute("201.1").getValue()).
                      plus(m_part.getAttribute("201.2").getValue()).
                      plus(m_part.getAttribute("201.3").getValue()).
                      plus(m_part.getAttribute("201.4").getValue()).
                      plus(m_part.getAttribute("201.5").getValue()).
                      plus(m_part.getAttribute("201.7").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_3_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_нерез")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_нерез")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_104_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "((Сумма_НВ_БК * 104.3.2.1_данные) / Сумма_НВ) / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("104.3.2.1_данные", m_part.getAttribute("104.3.2.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                 multiply(m_part.getAttribute("104.3.2.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.2.2_данные * Коэф_НВ_201.2.2");
            m_protocolView.printLineValueInfo("201.2.2_данные", m_part.getAttribute("201.2.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.2.2", m_part.getAttribute("Коэф_НВ_201.2.2").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.2.2_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.2.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.3.1 + 201.3.2 + 201.3.3");
        m_protocolView.printLineValueInfo("201.3.1", m_part.getAttribute("201.3.1").getValue());
        m_protocolView.printLineValueInfo("201.3.2", m_part.getAttribute("201.3.2").getValue());
        m_protocolView.printLineValueInfo("201.3.3", m_part.getAttribute("201.3.3").getValue());

        attribute.setValue(m_part.getAttribute("201.3.1").getValue()).
                      plus(m_part.getAttribute("201.3.2").getValue()).
                      plus(m_part.getAttribute("201.3.3").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_2_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.2.2_данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.2.2_данные", m_part.getAttribute("201.2.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0 )
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("201.2.2_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORTKIND_ACTIVE, "'Вложения КО в акции ФО'");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Вложения КО в акции ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");


        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )");
        m_dataSourceAcc.makeCommentForOwn(Финансовая_организация);
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.4_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;
        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                      multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * (201.3.2_данные * Коэф_НВ_201.3.2)");
            m_protocolView.printLineValueInfo("201.3.2_данные", m_part.getAttribute("201.3.2_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.2", m_part.getAttribute("Коэф_НВ_201.3.2").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.3.2_данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.3.2_данные", m_part.getAttribute("201.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                   multiply(m_part.getAttribute("201.3.2_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("Сумма_НВ_БК").getValue() > 0)
            m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
            m_protocolView.printString("Сумма_НВ_БК > 0!");
            m_protocolView.printAlg(attributeId, "K1 * 201.3.2.1_данные * Коэф_НВ_201.3.2.1");
            m_protocolView.printLineValueInfo("201.3.2.1_данные", m_part.getAttribute("201.3.2.1_данные").getValue());
            m_protocolView.printLineValueInfo("Коэф_НВ_201.3.2.1", m_part.getAttribute("Коэф_НВ_201.3.2.1").getValue());
            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(global.parameters.getK1()).
                      multiply(m_part.getAttribute("201.3.1.1_данные").getValue()).
                      multiply(m_part.getAttribute("Коэф_НВ_201.3.1.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K1");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrEq(10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, ">= 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var filterFromSum2 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        filterFromSum2.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        filterFromSum2.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");

        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum2);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum2);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
             multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.1 + 202.2 + 202.3 + 202.4");
        m_protocolView.printLineValueInfo("202.1", m_part.getAttribute("202.1").getValue());
        m_protocolView.printLineValueInfo("202.2", m_part.getAttribute("202.2").getValue());
        m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
        m_protocolView.printLineValueInfo("202.4", m_part.getAttribute("202.4").getValue());

        attribute.setValue(m_part.getAttribute("202.1").getValue()).
                      plus(m_part.getAttribute("202.2").getValue()).
                      plus(m_part.getAttribute("202.3").getValue()).
                      plus(m_part.getAttribute("202.4").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3.1_данные + 202.3.2_данные + 202.3.3 + 202.3.4_данные");
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.4_данные", m_part.getAttribute("202.3.4_данные").getValue());

        attribute.setValue(m_part.getAttribute("202.3.1_данные").getValue()).
                      plus(m_part.getAttribute("202.3.2_данные").getValue()).
                      plus(m_part.getAttribute("202.3.3_данные").getValue()).
                      plus(m_part.getAttribute("202.3.4_данные").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_IST_SS(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100 + 103 + 200 - (103.3 + 103.4 + 200.7 + 200.8) - (101.1 + 101.2 + 101.3 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10 + 101.12 + 101.13) - (104.1 + 104.2 + 104.3 + 104.5 + 104.6) - (201.1 + 201.2 + 201.3) + Сумма1");
        m_protocolView.printLineValueInfo("100", m_part.getAttribute("100").getValue());
        m_protocolView.printLineValueInfo("103", m_part.getAttribute("103").getValue());
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("103.3", m_part.getAttribute("103.3").getValue());
        m_protocolView.printLineValueInfo("103.4", m_part.getAttribute("103.4").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10", m_part.getAttribute("101.10").getValue());
        m_protocolView.printLineValueInfo("101.12", m_part.getAttribute("101.12").getValue());
        m_protocolView.printLineValueInfo("101.13", m_part.getAttribute("101.13").getValue());
        m_protocolView.printLineValueInfo("104.1", m_part.getAttribute("104.1").getValue());
        m_protocolView.printLineValueInfo("104.2", m_part.getAttribute("104.2").getValue());
        m_protocolView.printLineValueInfo("104.3", m_part.getAttribute("104.3").getValue());
        m_protocolView.printLineValueInfo("104.5", m_part.getAttribute("104.5").getValue());
        m_protocolView.printLineValueInfo("104.6", m_part.getAttribute("104.6").getValue());
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());

        attribute.plus(m_part.getAttribute("100").getValue()).
                  plus(m_part.getAttribute("103").getValue()).
                  plus(m_part.getAttribute("200").getValue()).
                 minus(m_part.getAttribute("103.3").getValue()).
                 minus(m_part.getAttribute("103.4").getValue()).
                 minus(m_part.getAttribute("200.7").getValue()).
                 minus(m_part.getAttribute("200.8").getValue()).
                 minus(m_part.getAttribute("101.1").getValue()).
                 minus(m_part.getAttribute("101.2").getValue()).
                 minus(m_part.getAttribute("101.3").getValue()).
                 minus(m_part.getAttribute("101.4").getValue()).
                 minus(m_part.getAttribute("101.5").getValue()).
                 minus(m_part.getAttribute("101.6").getValue()).
                 minus(m_part.getAttribute("101.7").getValue()).
                 minus(m_part.getAttribute("101.8").getValue()).
                 minus(m_part.getAttribute("101.9").getValue()).
                 minus(m_part.getAttribute("101.10").getValue()).
                 minus(m_part.getAttribute("101.12").getValue()).
                 minus(m_part.getAttribute("101.13").getValue()).
                 minus(m_part.getAttribute("104.1").getValue()).
                 minus(m_part.getAttribute("104.2").getValue()).
                 minus(m_part.getAttribute("104.3").getValue()).
                 minus(m_part.getAttribute("104.5").getValue()).
                 minus(m_part.getAttribute("104.6").getValue()).
                 minus(m_part.getAttribute("201.1").getValue()).
                 minus(m_part.getAttribute("201.2").getValue()).
                 minus(m_part.getAttribute("201.3").getValue());

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10601*");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.plus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Coeff_NV_201_3_2_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма_НВ_БК * 201.3.2.1_данные / Сумма_НВ / 100");
        m_protocolView.printLineValueInfo("Сумма_НВ_БК", m_part.getAttribute("Сумма_НВ_БК").getValue());
        m_protocolView.printLineValueInfo("201.3.2.1_данные", m_part.getAttribute("201.3.2.1_данные").getValue());
        m_protocolView.printLineValueInfo("Сумма_НВ", m_part.getAttribute("Сумма_НВ").getValue());

        if (m_part.getAttribute("Сумма_НВ").getValue() > 0)
            attribute.setValue(m_part.getAttribute("Сумма_НВ_БК").getValue()).
                 multiply(m_part.getAttribute("201.3.2.1_данные").getValue()).
                              div(m_part.getAttribute("Сумма_НВ").getValue()).
                              div(100);
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_BK(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var summa;

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100 - (101.1 + 101.2 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10.1)");
        m_protocolView.printLineValueInfo("100",      m_part.getAttribute("100").getValue());
        m_protocolView.printLineValueInfo("101.1",    m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2",    m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4",    m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5",    m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6",    m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7",    m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8",    m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9",    m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());

        summa = m_part.getAttribute("101.1").getValue()
              + m_part.getAttribute("101.2").getValue()
              + m_part.getAttribute("101.4").getValue()
              + m_part.getAttribute("101.5").getValue()
              + m_part.getAttribute("101.6").getValue()
              + m_part.getAttribute("101.7").getValue()
              + m_part.getAttribute("101.8").getValue()
              + m_part.getAttribute("101.9").getValue()
              + m_part.getAttribute("101.10.1").getValue();

        attribute.setValue(m_part.getAttribute("100").getValue()).
                     minus(summa);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;
    private macro calculateLine_Summa_BK_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "100 - (101.1 +101.2 + 101.4 + 101.5 + 101.6 + 101.7 + 101.8 + 101.9 + 101.10.1 + 101.10.2)");
        m_protocolView.printLineValueInfo("100", m_part.getAttribute("100").getValue());
        m_protocolView.printLineValueInfo("101.1", m_part.getAttribute("101.1").getValue());
        m_protocolView.printLineValueInfo("101.2", m_part.getAttribute("101.2").getValue());
        m_protocolView.printLineValueInfo("101.4", m_part.getAttribute("101.4").getValue());
        m_protocolView.printLineValueInfo("101.5", m_part.getAttribute("101.5").getValue());
        m_protocolView.printLineValueInfo("101.6", m_part.getAttribute("101.6").getValue());
        m_protocolView.printLineValueInfo("101.7", m_part.getAttribute("101.7").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());
        m_protocolView.printLineValueInfo("101.10.1", m_part.getAttribute("101.10.1").getValue());
        m_protocolView.printLineValueInfo("101.10.2", m_part.getAttribute("101.10.2").getValue());

        attribute.setValue(m_part.getAttribute("100").getValue()).
                     minus(m_part.getAttribute("101.1").getValue()).
                     minus(m_part.getAttribute("101.2").getValue()).
                     minus(m_part.getAttribute("101.4").getValue()).
                     minus(m_part.getAttribute("101.5").getValue()).
                     minus(m_part.getAttribute("101.6").getValue()).
                     minus(m_part.getAttribute("101.7").getValue()).
                     minus(m_part.getAttribute("101.8").getValue()).
                     minus(m_part.getAttribute("101.9").getValue()).
                     minus(m_part.getAttribute("101.10.1").getValue()).
                     minus(m_part.getAttribute("101.10.2").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_2_UB(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма_3 - Сумма_2  - Сумма_1 - 101.8.2_оцен_сниж_СС_ПрошлЛет - 101.8.2_оцен_сниж_СС_ПрошлГода) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printParamValue("101.8.2_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue());
        m_protocolView.printParamValue("101.8.2_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum3.getValue()).
                     minus(attrSum2.getValue()).
                     minus(attrSum1.getValue()).
                     minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue()).
                     minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Прибыль");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Убыток");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");

            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1) * K1");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue()).
                                     minus(attrSum1.getValue());
                    else
                        m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2) * K1");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1) * K1");
                    m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                    m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                    m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                    attribute.setValue(attrSum3.getValue()).
                                 minus(attrSum2.getValue()).
                                 minus(attrSum1.getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1) * K1");
                m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());

                attribute.setValue(attrSum3.getValue()).
                             minus(attrSum2.getValue()).
                             minus(attrSum1.getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами + ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, не подтвержденный аудиторами", global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiNotConfirmedImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiNotConfirmedNotImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_PFI_108_109_708(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами + ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами");
        m_protocolView.printLineValueInfo("ПФИ: нереализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears());
        m_protocolView.printLineValueInfo("ПФИ: реализованный фин. результат прошлых лет, подтвержденный аудиторами", global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        attribute.setValue(global.parameters.getPfiConfirmedNotImplementedFinResultPrevYears()).
                      plus(global.parameters.getPfiConfirmedImplementedFinResultPrevYears());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.8.1")
            m_protocolView.printAlg(attributeId, "101.8.1.1 + 101.8.1.2 + 101.8.1.3 + 101.8.1.4");

            attribute.setValue(m_part.getAttribute("101.8.1.1").getValue()).
                          plus(m_part.getAttribute("101.8.1.2").getValue()).
                          plus(m_part.getAttribute("101.8.1.3").getValue()).
                          plus(m_part.getAttribute("101.8.1.4").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var attrSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(101.8_доп + 101.8.1_доп)");
        m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
        m_protocolView.printLineValueInfo("101.8.1_доп", m_part.getAttribute("101.8.1_доп").getValue());

        attribute.setValue(m_part.getAttribute("101.8_доп").getValue()).
                     plus(m_part.getAttribute("101.8.1_доп").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro finResultLastYearsWithoutProfit(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempVal = TArray();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("10801*");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);

        m_protocolView.printAlg("Сумма2", attrSum2.getValue());

        attribute.setValue(attrSum1.getValue()).
                     minus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.acceptedDistributedProfit() or
            (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() < 0))
           )
            m_protocolView.printLineValueInfo("Финансовый результат ПГ за ДООП", m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue());
            m_protocolView.printString("Значение переменной Финансовый результат ПГ за ДООП < 0!");
            m_protocolView.printAlg(attributeId, "Финансовый результат ПГ за ДООП");
            attribute.setValue(m_part.getAttribute("Убыток прошлых лет").getValue());

        elif (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() > 0))
            if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() < 0)

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года < 0!");
                m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года * (-1) + (Сумма1 - Сумма2)");

                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
                tempVal.size = 0;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
                tempVal.size = 0;

                attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          multiply(-1).
                              plus(attrSum1.getValue()).
                             minus(attrSum2.getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro lossLastYears(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var attrSum4 = m_part.getAttribute("attrSum4");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма_2 - Сумма_1 + Сумма_3 + Сумма_4 + 101.8_ПФИ_707 за ДООП + 101.8_ПФИ_108_109_708 + 101.8_ПФИ_108_109_708_неподтв + 101.8.2_убыток");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Неиспользованные_суммы_фондов);
        attrSum1.minus(sum);
        tempVal[2] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Расходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Доходы"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum3.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма3", tempVal[0] + " - " + tempVal[1] + " = " + attrSum3.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма4:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum4.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum4.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма4", tempVal[0] + " - " + tempVal[1] + " = " + attrSum4.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum2.getValue()).
                     minus(attrSum1.getValue()).
                      plus(attrSum3.getValue()).
                      plus(attrSum4.getValue()).
                      plus(m_part.getAttribute("101.8_ПФИ_707 за ДООП").getValue()).
                      plus(m_part.getAttribute("101.8_ПФИ_108_109_708_неподтв").getValue()).
                      plus(m_part.getAttribute("101.8.2_убыток").getValue()).
                      plus(m_part.getAttribute("101.8_ПФИ_108_109_708").getValue());

        m_protocolView.printLineValueInfo("101.8_ПФИ_707 за ДООП", m_part.getAttribute("101.8_ПФИ_707 за ДООП").getValue());
        m_protocolView.printLineValueInfo("101.8_ПФИ_108_109_708", m_part.getAttribute("101.8_ПФИ_108_109_708").getValue());
        m_protocolView.printLineValueInfo("101.8_ПФИ_108_109_708_неподтв", m_part.getAttribute("101.8_ПФИ_108_109_708_неподтв").getValue());
        m_protocolView.printLineValueInfo("101.8.2_убыток", m_part.getAttribute("101.8.2_убыток").getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_PFI_707(attributeId : String, forDate : Date)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Доходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_ПФИ_Расходы"));
        sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, forDate);
        attribute.minus(sum);

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "101.8.1_доп");

            attribute.setValue(m_part.getAttribute("101.8.1_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("101.8").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
            m_protocolView.printString("Значение переменной 101.8 > 0!");
            m_protocolView.printAlg(attributeId, "101.8.2_доп");

            attribute.setValue(m_part.getAttribute("101.8.2_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

         if (global.parameters.isCalculateForDocuments)
                m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                m_protocolView.printLine("Сумма1:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").op("(").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");

                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.setValue(sum);

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLine("Сумма2:");
                m_dataSourceFilterDoc.isExistsPayment().op("AND").op("(").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attribute.minus(sum);
            else
                m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.1.3")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                attribute.setValue(sum);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_4_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.3_данные + 101.10.3_данные + 101.10.1_Сущ_ВстрВлож + 101.10.3_НеудВлож");
        m_protocolView.printLineValueInfo("101.3_данные", m_part.getAttribute("101.3_данные").getValue());
        m_protocolView.printLineValueInfo("101.10.3_данные", m_part.getAttribute("101.10.3_данные").getValue());
        m_protocolView.printLineValueInfo("101.10.1_Сущ_ВстрВлож", m_part.getAttribute("101.10.1_Сущ_ВстрВлож").getValue());
        m_protocolView.printLineValueInfo("101.10.3_НеудВлож", m_part.getAttribute("101.10.3_НеудВлож").getValue());

        attribute.setValue(m_part.getAttribute("101.3_данные").getValue()).
                      plus(m_part.getAttribute("101.10.3_данные").getValue()).
                      plus(m_part.getAttribute("101.10.1_Сущ_ВстрВлож").getValue()).
                      plus(m_part.getAttribute("101.10.3_НеудВлож").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Прямые вложения'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks(attributeId)).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "201.1.0 + 201.1.1 + 201.1.2 + 201.1.3 + 201.1.4 + 201.1.5");
        m_protocolView.printLineValueInfo("201.1.0", m_part.getAttribute("201.1.0").getValue());
        m_protocolView.printLineValueInfo("201.1.1", m_part.getAttribute("201.1.1").getValue());
        m_protocolView.printLineValueInfo("201.1.2", m_part.getAttribute("201.1.2").getValue());
        m_protocolView.printLineValueInfo("201.1.3", m_part.getAttribute("201.1.3").getValue());
        m_protocolView.printLineValueInfo("201.1.4", m_part.getAttribute("201.1.4").getValue());
        m_protocolView.printLineValueInfo("201.1.5", m_part.getAttribute("201.1.5").getValue());

        attribute.setValue(m_part.getAttribute("201.1.0").getValue()).
                      plus(m_part.getAttribute("201.1.1").getValue()).
                      plus(m_part.getAttribute("201.1.2").getValue()).
                      plus(m_part.getAttribute("201.1.3").getValue()).
                      plus(m_part.getAttribute("201.1.4").getValue()).
                      plus(m_part.getAttribute("201.1.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_2_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterDoc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            if (global.parameters.isCalculateForDocuments())
                    m_protocolView.printAlg(attributeId, "Сумма1 - Сумма2");
                    m_protocolView.printLine("Сумма1:");
                    m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory("doc.t_creditAccount", RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_creditAccount", "doc.t_creditFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");

                    sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                    attribute.setValue(sum);

                    m_dataSourceFilterDoc.clear();
                    m_protocolView.printLine("Сумма2:");
                    m_dataSourceFilterDoc.isExistsPayment().op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory("doc.t_debetAccount", RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, "doc.t_debetAccount", "doc.t_debetFiid", RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                    attribute.minus(sum);
                else
                    m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.2.1.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'БК'");
                    m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УстК_Проч'");
                    sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
                    attribute.setValue(sum);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;


    private macro calculateLine_100_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "100.1.1 + 100.1.2 + 100.1_0");
            m_protocolView.printLineValueInfo("100.1.1", m_part.getAttribute("100.1.1").getValue());
            m_protocolView.printLineValueInfo("100.1.2", m_part.getAttribute("100.1.2").getValue());
            m_protocolView.printLineValueInfo("100.1_0", m_part.getAttribute("100.1_0").getValue());

            attribute.plus(m_part.getAttribute("100.1.1").getValue()).
                      plus(m_part.getAttribute("100.1.2").getValue()).
                      plus(m_part.getAttribute("100.1_0").getValue());
        else
            m_protocolView.printAlg(attributeId, "100.1.3 + 100.1_0");
            m_protocolView.printLineValueInfo("100.1.3", m_part.getAttribute("100.1.3").getValue());
            m_protocolView.printLineValueInfo("100.1_0", m_part.getAttribute("100.1_0").getValue());

            attribute.plus(m_part.getAttribute("100.1.3").getValue()).
                      plus(m_part.getAttribute("100.1_0").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

     /**
     * Расчет атрибута 104.1
     *
     * @param attributeId Идетификатор атрибута
     */
    private macro calculateLine_104_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "104.1_0 + 104.1.1 + 104.1.2 + 104.1.3 + 104.1.4 + 104.1.5");
        m_protocolView.printLineValueInfo("104.1_0", m_part.getAttribute("104.1_0").getValue());
        m_protocolView.printLineValueInfo("104.1.1", m_part.getAttribute("104.1.1").getValue());
        m_protocolView.printLineValueInfo("104.1.2", m_part.getAttribute("104.1.2").getValue());
        m_protocolView.printLineValueInfo("104.1.3", m_part.getAttribute("104.1.3").getValue());
        m_protocolView.printLineValueInfo("104.1.4", m_part.getAttribute("104.1.4").getValue());
        m_protocolView.printLineValueInfo("104.1.5", m_part.getAttribute("104.1.5").getValue());

        attribute.plus(m_part.getAttribute("104.1_0").getValue()).
                  plus(m_part.getAttribute("104.1.1").getValue()).
                  plus(m_part.getAttribute("104.1.2").getValue()).
                  plus(m_part.getAttribute("104.1.3").getValue()).
                  plus(m_part.getAttribute("104.1.4").getValue()).
                  plus(m_part.getAttribute("104.1.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_3_2_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var filterFromSum1 = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        filterFromSum1.clear();
        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2");
        m_protocolView.printLine("Сумма1:");

        filterFromSum1.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3.2.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'").op("AND").op("(").op("NOT").isOurBank().op("AND").op("(").contragentIsBank().op("OR").contragentIsFinancialInstitution().op(") )").op("AND").isExistAccountNoteGreatOrLess(0, 10);
        m_dataSourceAcc.makeCommentForNote(Доля_в_УК, "> 0 и < 10");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_SUBORDINATEDLOAN, "'Предоставленный СК'");
        sum = m_dataSourceAcc.getDataForOwn(filterFromSum1);
        attrSum1.setValue(sum);
        tempVal[0] = sum;
        sum = m_dataSourceAcc.getReservesData(filterFromSum1);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_полож_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_POSITIVEOVERVALUATION, filterFromSum1);
        attrSum2.setValue(sum);
        tempVal[0] = sum;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.3_отриц_переоц"));
        sum = m_dataSourceAcc.getRestForRevaluation(m_dataSourceFilterAcc, RCB_OBJTYPE_ACCOUNT_NEGATIVEOVERVALUATION, filterFromSum1);
        attrSum2.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
        tempVal.size = 0;

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLine("Сумма1:");
        tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_ОС"));
        sum = m_dataSourceAcc.getData(tempFilter);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.op("AND").add(tempFilter);
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[2] = sum;

        m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        tempVal[3] = m_part.getAttribute("201.7.5_202.3.1_имущество").getValue();
        attrSum1.minus(tempVal[3]);

        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " - " + tempVal[3] + " = " + attrSum1.getValue());

        tempVal.size = 0;

        m_protocolView.printLine("Сумма2 = 100.7 + 103.5 + 200.9 - (200.7 + 200.8) - 104.7 - (201.7.1 + 201.7.2 + 201.7.3) - (101.8 + 101.9)");
        m_protocolView.printLineValueInfo("100.7", m_part.getAttribute("100.7").getValue());
        m_protocolView.printLineValueInfo("103.5", m_part.getAttribute("103.5").getValue());
        m_protocolView.printLineValueInfo("200.9", m_part.getAttribute("200.9").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("104.7", m_part.getAttribute("104.7").getValue());
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("201.7.2", m_part.getAttribute("201.7.2").getValue());
        m_protocolView.printLineValueInfo("201.7.3", m_part.getAttribute("201.7.3").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());

        attrSum2.setValue(m_part.getAttribute("100.7").getValue()).
                     plus(m_part.getAttribute("103.5").getValue()).
                     plus(m_part.getAttribute("200.9").getValue()).
                    minus(m_part.getAttribute("200.7").getValue()).
                    minus(m_part.getAttribute("200.8").getValue()).
                    minus(m_part.getAttribute("104.7").getValue()).
                    minus(m_part.getAttribute("201.7.1").getValue()).
                    minus(m_part.getAttribute("201.7.2").getValue()).
                    minus(m_part.getAttribute("201.7.3").getValue()).
                    minus(m_part.getAttribute("101.8").getValue()).
                    minus(m_part.getAttribute("101.9").getValue());

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.8"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.plus(sum);

        if (attrSum2.getValue() >= 0)
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 >= 0!");

            attribute.setValue(attrSum1.getValue()).
                         minus(attrSum2.getValue());
            if (attribute.getValue() >= 0)
                m_protocolView.printSummValueInfo("Сумма2", attribute.getValue());
                m_protocolView.printString("Значение Сумма1 - Сумма2 >= 0!");

                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
                m_protocolView.printParamValue("K2", global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue(attrSum1.getValue());
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 < 0!");

            if (attribute.getValue() > 0)
                m_protocolView.printSummValueInfo("Сумма1", attrSum2.getValue());
                m_protocolView.printString("Значение Сумма1 > 0!");
                m_protocolView.printAlg(attributeId, "Сумма1 * K2");
                attribute.multiply(global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3_ист_СС").getValue() >= 0)
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());
            m_protocolView.printString("Значение переменной 202.3_ист_СС >= 0!");
            m_protocolView.printAlg(attributeId, "(202.3_данные - 202.3_ист_СС) * K1");
            m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
            m_protocolView.printLineValueInfo("202.3_ист_СС", m_part.getAttribute("202.3_ист_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());

            attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                         minus(m_part.getAttribute("202.3_ист_СС").getValue()).
                      multiply(global.parameters.getK1());

            if (attribute.getValue() < 0)
                m_protocolView.printString("Значение переменной " + attributeId + " < 0! В расчете принимаем равным 0");

                attribute.setValue($0.0);
            end;
        else
            if (m_part.getAttribute("202.3_данные").getValue() >= 0)
                m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
                m_protocolView.printString("Значение переменной 202.3_данные >= 0!");
                m_protocolView.printAlg(attributeId, "202.3_данные * K1");
                m_protocolView.printLineValueInfo("202.3_данные", m_part.getAttribute("202.3_данные").getValue());
                m_protocolView.printParamValue("K1", global.parameters.getK1());

                attribute.setValue(m_part.getAttribute("202.3_данные").getValue()).
                          multiply(global.parameters.getK1());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной 202.3 > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.1");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.1", m_part.getAttribute("К_202.3.1").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.1").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной 202.3 > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.2");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.2", m_part.getAttribute("К_202.3.2").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("202.3").getValue() > 0)
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printString("Значение переменной  > 0!");
            m_protocolView.printAlg(attributeId, "202.3 * К_202.3.3");
            m_protocolView.printLineValueInfo("202.3", m_part.getAttribute("202.3").getValue());
            m_protocolView.printLineValueInfo("К_202.3.3", m_part.getAttribute("К_202.3.3").getValue());

            attribute.setValue(m_part.getAttribute("202.3").getValue()).
                      multiply(m_part.getAttribute("К_202.3.3").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_1_0(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.op("(").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.1")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.2")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.3")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.4")).op("OR").isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.1.5")).op(")").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Влож. в СобствАкции'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);

            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            attribute.minus(sum);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_Summa_NV(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "101.10.2_данные + 104.2.2_данные + 104.3.2_данные + 201.2.2_данные + 201.3.2_данные");
        m_protocolView.printLineValueInfo("101.10.2_данные", m_part.getAttribute("101.10.2_данные").getValue());
        m_protocolView.printLineValueInfo("104.2.2_данные", m_part.getAttribute("104.2.2_данные").getValue());
        m_protocolView.printLineValueInfo("104.3.2_данные", m_part.getAttribute("104.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("201.2.2_данные", m_part.getAttribute("201.2.2_данные").getValue());
        m_protocolView.printLineValueInfo("201.3.2_данные", m_part.getAttribute("201.3.2_данные").getValue());

        attribute.setValue(m_part.getAttribute("101.10.2_данные").getValue()).
                      plus(m_part.getAttribute("104.2.2_данные").getValue()).
                      plus(m_part.getAttribute("104.3.2_данные").getValue()).
                      plus(m_part.getAttribute("201.2.2_данные").getValue()).
                      plus(m_part.getAttribute("201.3.2_данные").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Выполнение расчета
     */
    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_NeudVloj("101.10.3_НеудВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI_DOP("100.5_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_707("100.6_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_108_109_708("100.6_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_DOP("100.6_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_UB("101.8.2_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708("101.8_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED("101.8_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_NesVstrVl("101.10.1_Несущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_SushVstrVl("101.10.1_Сущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_0("201.2_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_1("101.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_2("101.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_4("101.4.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_5("101.4.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_PFI_DOP("101.9_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI("100.5_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100("100"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4_Data("101.10.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103("103"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_4("104.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_5("104.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2_Data("104.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_Data("104.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1_Data("104.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3("104.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3_1("104.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_4("201.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_5("201.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2_Data("201.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_3("201.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_Data("201.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_2("Коэф_НВ_104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_3("104.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2("Коэф_НВ_104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2_1("Коэф_НВ_104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_2("Коэф_НВ_101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4("101.10.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3("201.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3_1("201.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_PFI_Data("200.5_ПФИ_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_3("200.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200("200"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_2("Коэф_НВ_201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2("Коэф_НВ_201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1_Data("201.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2_1("Коэф_НВ_201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201("201"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202("202"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104("104"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101("101"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_2("Справ_3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_1("Справ_3.1"));
    end;
end;

class (TF123PartCalculateController_4033) TF123PartCalculateController_4098(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_4033(reportCalculateController, partId);

    /**
     * Расчет атрибута 100.5_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 100.5_дисконт + 100.5_ден_потоки_не_СС + 100.5_ПФИ + 100.5.2_доп - 100.5.1_доп");

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.plus(currentValue);
            temporaryValue[1] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[2] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[3] = currentValue;

            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
        else
            attributeSum1.setValue(0);
            m_protocolView.printAlg("Сумма1", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
        else
            attributeSum2.setValue(0);
            m_protocolView.printAlg("Сумма2", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum3.setValue(currentValue);
            m_protocolView.printAlg("Сумма3", currentValue);
        else
            attributeSum3.setValue(0);
            m_protocolView.printAlg("Сумма3", attributeSum3.getValue());
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5_ден_потоки_не_СС", m_part.getAttribute("100.5_ден_потоки_не_СС").getValue());
        m_protocolView.printLineValueInfo("100.5_ПФИ", m_part.getAttribute("100.5_ПФИ").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());

        attribute.setValue(attributeSum1.getValue()).
                      plus(attributeSum2.getValue()).
                      minus(attributeSum3.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5_ден_потоки_не_СС").getValue()).
                      plus(m_part.getAttribute("100.5_ПФИ").getValue()).
                      plus(m_part.getAttribute("100.5.2_доп").getValue()).
                      minus(m_part.getAttribute("100.5.1_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.5_ден_потоки_не_СС
     *
     * @param attributeId Идентификатор атрибута
     */

    private macro calculateLine_100_5_STREAMS_NOT_SS(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 101.9_дисконт + 101.9_ден_потоки_не_СС - 101.9_ПФИ_доп + 101.9.1_доп + 101.9.2_доп");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9_ден_потоки_не_СС", m_part.getAttribute("101.9_ден_потоки_не_СС").getValue());
        m_protocolView.printLineValueInfo("101.9_ПФИ_доп", m_part.getAttribute("101.9_ПФИ_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("101.9_дисконт").getValue());
        attribute.plus(m_part.getAttribute("101.9_ден_потоки_не_СС").getValue());
        attribute.minus(m_part.getAttribute("101.9_ПФИ_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.1_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.2_доп").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2 - 100.5.2_оцен_сниж_СС) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.2_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attribute.minus(sum);

            m_protocolView.printLineValueInfo("100.5.2_оцен_сниж_СС", m_part.getAttribute("100.5.2_оцен_сниж_СС").getValue());
            attribute.minus(m_part.getAttribute("100.5.2_оцен_сниж_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_ден_потоки_не_СС
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_MONEY_STREAMS_NOT_SS(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_ден_потоки_не_СС");
        end;
        /**
         * Атрибут
         */
        var attribute: Object  = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;


        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(currentValue);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(currentValue);

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_2_DOP(attributeId : String)

        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal =TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3 - 100.6.2_оцен_сниж_СС) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.setValue(sum);
            tempVal[0] = sum;

            m_dataSourceFilterAcc.clear();

            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'", global.parameters.getLastDateProfit());
            sum = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getLastDateProfit());
            attrSum1.minus(sum);
            tempVal[1] = sum;

            m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
            m_dataSourceFilterAcc.clear();

            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Прибыль"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum2.setValue(sum);

            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6_Убыток"));
            sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой, global.parameters.getLastDateProfit());
            attrSum3.setValue(sum);

            m_protocolView.printLineValueInfo("100.6.2_оцен_сниж_СС", m_part.getAttribute("100.6.2_оцен_сниж_СС").getValue());

            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.setValue(attrSum1.getValue()).
                          plus(attrSum2.getValue()).
                         minus(attrSum3.getValue()).
                         minus(m_part.getAttribute("100.6.2_оцен_сниж_СС").getValue()).
                      multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Прибыль");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks("100.6_Убыток");
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        if (m_part.getAttribute("101.8_доп").getValue() > 0)
            m_protocolView.printLineValueInfo("101.8_доп", m_part.getAttribute("101.8_доп").getValue());
            m_protocolView.printString("Значение переменной 101.8_доп > 0!");

            if (global.parameters.getLastDateProfit() <= rcbApplication().currentReport.context.period.endDate)
                if (m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue() > 0)
                    m_protocolView.printLineValueInfo("Финансовый результат ПГ за Дата Ауд_прошлГ", m_part.getAttribute("Финансовый результат ПГ за Дата Ауд_прошлГ").getValue());
                    m_protocolView.printString("Значение переменной Финансовый результат ПГ за Дата Ауд_прошлГ > 0!");

                    if (global.parameters.acceptedDistributedProfit())
                        m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1 - 101.8.2_оцен_сниж_СС_ПрошлЛет - 101.8.2_оцен_сниж_СС_ПрошлГода) * K1");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                        m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue());
                        m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(attrSum2.getValue()).
                                     minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue()).
                                     minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue()).
                                     minus(attrSum1.getValue());
                    else
                        m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - 101.8.2_оцен_сниж_СС_ПрошлЛет) * K1");
                        m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                        m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                        m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue());

                        attribute.setValue(attrSum3.getValue()).
                                     minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue()).
                                     minus(attrSum2.getValue());
                    end;
                else
                    m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1 - 101.8.2_оцен_сниж_СС_ПрошлЛет - 101.8.2_оцен_сниж_СС_ПрошлГода) * K1");
                    m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                    m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                    m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                    m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue());
                    m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue());

                    attribute.setValue(attrSum3.getValue()).
                                 minus(attrSum2.getValue()).
                                 minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue()).
                                 minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue()).
                                 minus(attrSum1.getValue());
                end;
            else
                m_protocolView.printAlg(attributeId, "(Сумма3 - Сумма2 - Сумма1 - 101.8.2_оцен_сниж_СС_ПрошлЛет - 101.8.2_оцен_сниж_СС_ПрошлГода) * K1");
                m_protocolView.printSummValueInfo("Сумма3", attrSum3.getValue());
                m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
                m_protocolView.printSummValueInfo("Сумма1", attrSum1.getValue());
                m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлЛет", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue());
                m_protocolView.printSummValueInfo("101.8.2_оцен_сниж_СС_ПрошлГода", m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue());

                attribute.setValue(attrSum3.getValue()).
                             minus(attrSum2.getValue()).
                             minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлЛет").getValue()).
                             minus(m_part.getAttribute("101.8.2_оцен_сниж_СС_ПрошлГода").getValue()).
                             minus(attrSum1.getValue());
            end;
        else
            attribute.setValue($0.0);
        end;

        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2 - 101.9.2_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.2_Расходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9.2_Доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printSummValueInfo("101.9.2_оцен_сниж_СС", m_part.getAttribute("101.9.2_оцен_сниж_СС").getValue());
        attribute.minus(m_part.getAttribute("101.9.2_оцен_сниж_СС").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - 200.5.2_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.2_доходы")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printSummValueInfo("200.5.2_оцен_сниж_СС", m_part.getAttribute("200.5.2_оцен_сниж_СС").getValue());
        attribute.minus(m_part.getAttribute("200.5.2_оцен_сниж_СС").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());
        attribute.multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var attrSum3 = m_part.getAttribute("attrSum3");
        var dataSourceNoteAcc = m_dataSources.getDataSource("AccountNote");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 + Сумма2 - Сумма3 - 200.5.2_оцен_сниж_СС) * K1");
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Доходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Расходы_ц/б")).op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;
        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
        tempVal.size = 0;

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Прибыль_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum2.setValue(sum);

        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.6.2_Убыток_ц/б"));
        sum = dataSourceNoteAcc.getData(m_dataSourceFilterAcc, Сумма_переоценки_цб_ТСС_которых_не_является_средневзвешенной_ценой);
        attrSum3.setValue(sum);

        m_protocolView.printSummValueInfo("200.5.2_оцен_сниж_СС", m_part.getAttribute("200.5.2_оцен_сниж_СС").getValue());

        m_protocolView.printParamValue("K1", global.parameters.getK1());

        attribute.setValue(attrSum1.getValue()).
                      plus(attrSum2.getValue()).
                     minus(attrSum3.getValue()).
                     minus(m_part.getAttribute("200.5.2_оцен_сниж_СС").getValue()).
                  multiply(global.parameters.getK1());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Выполнение расчета
     */
    macro execute()
        println("Значения настроек, используемых при расчете:");

        if (global.parameters.isOurBankCorporation())
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  Yes ");
        else
            println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                  No ");
        end;

        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                      " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                           " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                          " + string(global.parameters.getConfirmedProfitCurrentDate()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                               " + string(global.parameters.getCurrentDateProfit()));

        if (global.parameters.isCalculateForDocuments())
           println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                             Yes ");
        else
            println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                            No ");
        end;
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                   " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                     " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014" + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                   " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_NeudVloj("101.10.3_НеудВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI_DOP("100.5_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_707("100.6_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_108_109_708("100.6_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_DOP("100.6_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_UB("101.8.2_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708("101.8_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED("101.8_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_NesVstrVl("101.10.1_Несущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_SushVstrVl("101.10.1_Сущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_0("201.2_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_1("101.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_2("101.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_4("101.4.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_5("101.4.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_PFI_DOP("101.9_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI("100.5_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100("100"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4_Data("101.10.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103("103"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_4("104.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_5("104.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2_Data("104.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_Data("104.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1_Data("104.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3("104.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3_1("104.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_4("201.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_5("201.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2_Data("201.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_3("201.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_Data("201.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_2("Коэф_НВ_104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_3("104.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2("Коэф_НВ_104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2_1("Коэф_НВ_104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_2("Коэф_НВ_101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4("101.10.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3("201.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3_1("201.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_PFI_Data("200.5_ПФИ_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_3("200.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200("200"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_2("Коэф_НВ_201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2("Коэф_НВ_201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1_Data("201.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2_1("Коэф_НВ_201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201("201"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202("202"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104("104"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101("101"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_2("Справ_3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_1("Справ_3.1"));
    end;
end;

class (TF123PartCalculateController_4098) TF123PartCalculateController_41_1_1_4_330(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_4098(reportCalculateController, partId);

    /**
     * Расчет атрибута 100.5_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_5_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 100.5_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1: Object = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2: Object = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3: Object = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 100.5_дисконт + 100.5_ден_потоки_не_СС + 100.5_ПФИ + ДохТГ_10801_Подтв + 100.5.2_доп - 100.5.1_доп - РасхТГ_10901_Подтв");

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_dataSourceFilterAcc.clear();
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.plus(currentValue);
            temporaryValue[1] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[2] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum1.minus(currentValue);
            temporaryValue[3] = currentValue;

            m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
            temporaryValue.size = 0;
        else
            attributeSum1.setValue(0);
            m_protocolView.printAlg("Сумма1", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма2:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.setValue(currentValue);
            temporaryValue[0] = currentValue;

            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum2.minus(currentValue);
            temporaryValue[1] = currentValue;
            m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
            temporaryValue.size = 0;
        else
            attributeSum2.setValue(0);
            m_protocolView.printAlg("Сумма2", attributeSum1.getValue());
        end;

        if (global.parameters.isConfirmedProfitCurrentDate())
            m_protocolView.printLine("Сумма3:");
            m_dataSourceFilterAcc.clear();
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
            m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
            m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
            currentValue = m_dataSourceAcc.getRestForDate(m_dataSourceFilterAcc, global.parameters.getCurrentDateProfit());
            attributeSum3.setValue(currentValue);
            m_protocolView.printAlg("Сумма3", currentValue);
        else
            attributeSum3.setValue(0);
            m_protocolView.printAlg("Сумма3", attributeSum3.getValue());
        end;

        m_protocolView.printLineValueInfo("100.5_дисконт", m_part.getAttribute("100.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("100.5_ден_потоки_не_СС", m_part.getAttribute("100.5_ден_потоки_не_СС").getValue());
        m_protocolView.printLineValueInfo("100.5_ПФИ", m_part.getAttribute("100.5_ПФИ").getValue());
        m_protocolView.printLineValueInfo("ДохТГ_10801_Подтв", m_part.getAttribute("ДохТГ_10801_Подтв").getValue());
        m_protocolView.printLineValueInfo("100.5.2_доп", m_part.getAttribute("100.5.2_доп").getValue());
        m_protocolView.printLineValueInfo("100.5.1_доп", m_part.getAttribute("100.5.1_доп").getValue());
        m_protocolView.printLineValueInfo("РасхТГ_10901_Подтв", m_part.getAttribute("РасхТГ_10901_Подтв").getValue());

        attribute.setValue(attributeSum1.getValue()).
                      plus(attributeSum2.getValue()).
                      minus(attributeSum3.getValue()).
                      plus(m_part.getAttribute("100.5_дисконт").getValue()).
                      plus(m_part.getAttribute("100.5_ден_потоки_не_СС").getValue()).
                      plus(m_part.getAttribute("100.5_ПФИ").getValue()).
                      plus(m_part.getAttribute("ДохТГ_10801_Подтв").getValue()).
                      plus(m_part.getAttribute("100.5.2_доп").getValue()).
                      minus(m_part.getAttribute("100.5.1_доп").getValue()).
                      minus(m_part.getAttribute("РасхТГ_10901_Подтв").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 100.6_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_100_6_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var previousReport = objectFactoryInstance.createPreviousReport();
        var attr_100_6 = 0;

        m_protocolView.printLineInfo(attributeId);

        if (objectFactoryInstance.createPreviousReport().isCalculated)
            attr_100_6 = previousReport.getPart("").getAttribute("100.6").getValue();
        end;

        if (global.parameters.isConfirmedProfitLastDate())
            m_protocolView.printAlg(attributeId, "Прибыль прошлых лет за Дата Ауд_прошлГ - 100.6.1_доп");
            m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
            m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());

            attribute.setValue(m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue()).
                         minus(m_part.getAttribute("100.6.1_доп").getValue()).
        else
            if (global.parameters.getUnconfirmedProfitBasel() == "2.1.8")
                m_protocolView.printAlg(attributeId, "MIN(Прибыль прошлых лет за Дата Ауд_прошлГ, 100.6) + Прибыль предшествующих лет без прибыли прошлого года - 100.6.1_доп");
                m_protocolView.printLineValueInfo("Прибыль прошлых лет за Дата Ауд_прошлГ", m_part.getAttribute("Прибыль прошлых лет за Дата Ауд_прошлГ").getValue());
                m_protocolView.printLineValueInfo("100.6", attr_100_6);
                m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printLineValueInfo("100.6.1_доп", m_part.getAttribute("100.6.1_доп").getValue());
                m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
                m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

                attribute.setValue(min(m_part.getAttribute("Прибыль прошлого года").getValue(), attr_100_6));
            else
                attribute.setValue($0.0);
            end;

            attribute.plus(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue()).
                     minus(m_part.getAttribute("100.6.2_доп").getValue()).
                     minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue()).
                     minus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.8_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_8_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var year;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var tempVal = TArray();

        macro showUserInputAttribute()
            m_protocolView.printLineValueInfo("Убыток прошлых лет", m_part.getAttribute("Убыток прошлых лет").getValue());
            m_protocolView.printLineValueInfo("ДохТГ_10801_Подтв", m_part.getAttribute("ДохТГ_10801_Подтв").getValue());
            m_protocolView.printLineValueInfo("РасхТГ_10901_Подтв", m_part.getAttribute("РасхТГ_10901_Подтв").getValue());
            m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
            m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());
        end;

        m_protocolView.printLineInfo(attributeId);

        if (   global.parameters.acceptedDistributedProfit()
            or (    not global.parameters.acceptedDistributedProfit()
                and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() < 0)
               )
           )
            if (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() < 0)
                m_protocolView.printLineValueInfo("Финансовый результат ПГ за ДООП", m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue());
                m_protocolView.printString("Значение переменной Финансовый результат ПГ за ДООП < 0!");
            end;
            m_protocolView.printAlg(attributeId, "Убыток прошлых лет - ДохТГ_10801_Подтв + РасхТГ_10901_Подтв - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв");
            showUserInputAttribute();
            attribute.setValue(m_part.getAttribute("Убыток прошлых лет").getValue()).
                         minus(m_part.getAttribute("ДохТГ_10801_Подтв").getValue()).
                          plus(m_part.getAttribute("РасхТГ_10901_Подтв").getValue()).
                         minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue()).
                          plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

        elif (not global.parameters.acceptedDistributedProfit() and (m_part.getAttribute("Финансовый результат ПГ за ДООП").getValue() > 0))
            if (m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue() < 0)

                m_dataSourceFilterDoc.clear();
                m_protocolView.printLineValueInfo("Финансовый результат предшествующих лет без прибыли прошлого года", m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue());
                showUserInputAttribute();
                m_protocolView.printString("Значение переменной Финансовый результат предшествующих лет без прибыли прошлого года < 0!");
                m_protocolView.printAlg(attributeId, "Финансовый результат предшествующих лет без прибыли прошлого года * (-1) + (Сумма1 - Сумма2)");

                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10801*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum1.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " = " + attrSum1.getValue());
                tempVal.size = 0;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.setValue(sum);
                tempVal[0] = sum;

                m_dataSourceFilterDoc.clear();
                m_dataSourceFilterDoc.dateDocumentBetween(Date(1, 1, year), rcbApplication().currentReport.context.period.endDate).op("AND").isSatisfiesToBalanceMasks("doc.t_creditAccount", "10901*").op("AND").isSatisfiesToBalanceMasks("doc.t_debetAccount", "708*");
                sum = m_dataSourceDoc.getData(m_dataSourceFilterDoc);
                attrSum2.minus(sum);
                tempVal[1] = sum;
                m_protocolView.printAlg("Сумма2", tempVal[0] + " - " + tempVal[1] + " = " + attrSum2.getValue());
                tempVal.size = 0;

                attribute.setValue(m_part.getAttribute("Финансовый результат предшествующих лет без прибыли прошлого года").getValue()).
                          multiply(-1).
                             minus(m_part.getAttribute("ДохТГ_10801_Подтв").getValue()).
                              plus(m_part.getAttribute("РасхТГ_10901_Подтв").getValue()).
                             minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue()).
                              plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue()).
                              plus(attrSum1.getValue()).
                             minus(attrSum2.getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 101.9_доп
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_101_9_DOP(attributeId: String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 101.9_доп");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue;
        /**
         * Сумма 1 для атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 для атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 для атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 101.9_дисконт - 101.9_ПФИ_доп + 101.9.1_доп + 101.9.2_доп - ДохТГ_10801_Подтв + РасхТГ_10901_Подтв - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв");

        /* {{{ Сумма 1 */
        m_protocolView.printLine("Сумма1:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.9_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;
        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /* Сумма 1 }}} */

        /* {{{ Сумма 2 */
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Расходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5.3_Доходы"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        /* Сумма 2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("101.9_дисконт", m_part.getAttribute("101.9_дисконт").getValue());
        m_protocolView.printLineValueInfo("101.9_ПФИ_доп", m_part.getAttribute("101.9_ПФИ_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.1_доп", m_part.getAttribute("101.9.1_доп").getValue());
        m_protocolView.printLineValueInfo("101.9.2_доп", m_part.getAttribute("101.9.2_доп").getValue());
        m_protocolView.printLineValueInfo("ДохТГ_10801_Подтв", m_part.getAttribute("ДохТГ_10801_Подтв").getValue());
        m_protocolView.printLineValueInfo("РасхТГ_10901_Подтв", m_part.getAttribute("РасхТГ_10901_Подтв").getValue());
        m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
        m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("101.9_дисконт").getValue());
        attribute.minus(m_part.getAttribute("101.9_ПФИ_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.1_доп").getValue());
        attribute.plus(m_part.getAttribute("101.9.2_доп").getValue());
        attribute.minus(m_part.getAttribute("ДохТГ_10801_Подтв").getValue());
        attribute.plus(m_part.getAttribute("РасхТГ_10901_Подтв").getValue());
        attribute.minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
        attribute.plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.5_данные
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_5_Data(attributeId : String)
        /**
         * Проверка входящих параметров
         */
        if ((attributeId == "") OR (attributeId == NULL))
            runError("Некорректные параметры функции расчета атрибута 200.5_данные");
        end;
        /**
         * Атрибут
         */
        var attribute: Object = m_part.getAttribute(attributeId);
        if (attribute == NULL)
            runError("Не найден атрибут \"" + attributeId + "\"");
        end;
        /**
         * Временное значение
         */
        var currentValue: Money = $0.0;
        /**
         * Сумма 1 атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");
        /**
         * Сумма 2 атрибута
         */
        var attributeSum2 = m_part.getAttribute("attrSum2");
        /**
         * Сумма 3 атрибута
         */
        var attributeSum3 = m_part.getAttribute("attrSum3");
        /**
         * Временное значение
         */
        var temporaryValue: TArray = TArray();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 + Сумма2 - Сумма3 + 200.5_дисконт + 200.5_ПФИ_данные + 200.5.2_данные - 200.5.1_данные + ДохТГ_10801_Неподтв - РасхТГ_10901_Неподтв");

        /* {{{  Сумма 1 */
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Доходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.plus(currentValue);
        temporaryValue[1] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы"));
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[2] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5_Расходы_Хедж_ДП"));
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ПИХДП по СС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum1.minus(currentValue);
        temporaryValue[3] = currentValue;

        m_protocolView.printAlg("Сумма1", temporaryValue[0] + " + " + temporaryValue[1] + " - " + temporaryValue[2] + " - " + temporaryValue[3] + " = " + attributeSum1.getValue());
        temporaryValue.size = 0;
        /*  Сумма 1 }}} */

        /* {{{ Сумма2 */
        m_dataSourceFilterAcc.clear();
        m_protocolView.printLine("Сумма2:");
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Доходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.setValue(currentValue);
        temporaryValue[0] = currentValue;

        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.5.3_Расходы")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ТСС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum2.minus(currentValue);
        temporaryValue[1] = currentValue;
        m_protocolView.printAlg("Сумма2", temporaryValue[0] + " - " + temporaryValue[1] + " = " + attributeSum2.getValue());
        temporaryValue.size = 0;
        /* Сумма2 }}} */

        /* {{{ Сумма 3 */
        m_protocolView.printLine("Сумма3:");
        m_dataSourceFilterAcc.clear();
        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("100.5_Расходы"));
        m_dataSourceFilterAcc.op("AND").isSatisfiesToBalanceMasks("106*");
        m_dataSourceFilterAcc.op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'ОНО по ОС'");
        currentValue = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attributeSum3.setValue(currentValue);
        m_protocolView.printAlg("Сумма3", currentValue);
        /* Сумма 3 }}} */

        m_protocolView.printLineValueInfo("200.5_дисконт", m_part.getAttribute("200.5_дисконт").getValue());
        m_protocolView.printLineValueInfo("200.5_ПФИ_данные", m_part.getAttribute("200.5_ПФИ_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.2_данные", m_part.getAttribute("200.5.2_данные").getValue());
        m_protocolView.printLineValueInfo("200.5.1_данные", m_part.getAttribute("200.5.1_данные").getValue());
        m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
        m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

        attribute.setValue(attributeSum1.getValue());
        attribute.plus(attributeSum2.getValue());
        attribute.minus(attributeSum3.getValue());
        attribute.plus(m_part.getAttribute("200.5_дисконт").getValue());
        attribute.plus(m_part.getAttribute("200.5_ПФИ_данные").getValue());
        attribute.plus(m_part.getAttribute("200.5.2_данные").getValue());
        attribute.minus(m_part.getAttribute("200.5.1_данные").getValue());
        attribute.plus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
        attribute.minus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Расчет атрибута 200.6
     *
     * @param attributeId Идентификатор атрибута
     */
    private macro calculateLine_200_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var d, m, y;

        /**
         * Сумма 1 атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);

        DateSplit(RcbApplication().currentReport.context.period.endDate, d, m, y);

        if (m < 7)
            m_protocolView.printLine("ДООП < 1 июля");

            attributeSum1.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
            attributeSum1.plus(m_part.getAttribute("Прибыль прошлого года").getValue());
            attributeSum1.minus(m_part.getAttribute("200.6.1_доп").getValue());
            attributeSum1.minus(m_part.getAttribute("100.6").getValue());
            attributeSum1.minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
            attributeSum1.plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

            m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
            m_protocolView.printLineValueInfo("Прибыль прошлого года", m_part.getAttribute("Прибыль прошлого года").getValue());
            m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
            m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

            if (m_part.getAttribute("attrSum1").getValue() > 0)
                m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года + Прибыль прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв > 0");
            else
                m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года + Прибыль прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв <= 0");
                attributeSum1.setValue($0.0);
            end;
        else
            if (global.parameters.isConfirmedProfitLastDate())
                m_protocolView.printLine("ДООП >= 1 июля и Прибыль предшествующих лет НЕ подтверждена");

                attributeSum1.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                attributeSum1.minus(m_part.getAttribute("200.6.1_доп").getValue());
                attributeSum1.minus(m_part.getAttribute("100.6").getValue());
                attributeSum1.minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
                attributeSum1.plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

                m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
                m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
                m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
                m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

                if (m_part.getAttribute("attrSum1").getValue() > 0)
                    m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв > 0");
                else
                    m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв <= 0");
                    attributeSum1.setValue($0.0);
                end;
            else
                attributeSum1.setValue($0.0);
            end;
        end;

        attribute.setValue(attributeSum1.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_203(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "200 - (201 + 202)");
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("201", m_part.getAttribute("201").getValue());
        m_protocolView.printLineValueInfo("202", m_part.getAttribute("202").getValue());

        attribute.setValue(m_part.getAttribute("200").getValue()).
                     minus(m_part.getAttribute("201").getValue()).
                     minus(m_part.getAttribute("202").getValue());

        if (attribute.getValue() < 0)
            attribute.setValue($0.0)
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    /**
     * Выполнение расчета
     */
    macro execute()
        println("Значения настроек, используемых при расчете:");

        println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                   " + ternary(global.parameters.isOurBankCorporation(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                            " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                                " + string(global.parameters.getCurrentDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                       " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                           " + string(global.parameters.getConfirmedProfitCurrentDate()));

        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                             " + ternary(global.parameters.isCalculateForDocuments(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014 " + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                      " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ЗАПОЛНИТЬ СПРАВОЧНИК КАПИТАЛА                                      " + ternary(global.parameters.getFillCapitalData(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                    " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ВКЛЮЧАТЬ 106 СЧЕТ В БАЗ. КАПИТ.                                    " + ternary(global.parameters.getInclude106InBaseCapital(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                    " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " +  m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " +  m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " +  m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " +  m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " +  global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_NeudVloj("101.10.3_НеудВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI_DOP("100.5_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_707("100.6_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_108_109_708("100.6_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_DOP("100.6_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_UB("101.8.2_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708("101.8_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED("101.8_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_NesVstrVl("101.10.1_Несущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_SushVstrVl("101.10.1_Сущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_0("201.2_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_1("101.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_2("101.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_4("101.4.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_5("101.4.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_PFI_DOP("101.9_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI("100.5_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100("100"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4_Data("101.10.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103("103"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_0("104.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_4("104.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_5("104.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2_Data("104.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_Data("104.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1_Data("104.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3("104.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3_1("104.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_4("201.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_5("201.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2_Data("201.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_3("201.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_Data("201.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_2("Коэф_НВ_104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_3("104.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2("Коэф_НВ_104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2_1("Коэф_НВ_104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_2("Коэф_НВ_101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4("101.10.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3("201.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3_1("201.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_PFI_Data("200.5_ПФИ_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_3("200.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200("200"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_2("Коэф_НВ_201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2("Коэф_НВ_201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1_Data("201.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2_1("Коэф_НВ_201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201("201"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202("202"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104("104"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101("101"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_2("Справ_3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_1("Справ_3.1"));
    end;
end;

class (TF123PartCalculateController_41_1_1_4_330) TF123PartCalculateController_4212(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_41_1_1_4_330(reportCalculateController, partId);

    private macro calculateLineForUnrequiredReserve(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var stringLen  = StrLen(attributeId);
        var lineNumber = SubStr(attributeId, stringLen - 4, 1);
        var line       = SubStr(attributeId, 1, stringLen - 6);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == line)
            if (lineNumber == "1")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
            elif (lineNumber == "2")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
            elif (lineNumber == "3")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
            elif (lineNumber == "4")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLineForAdditionalRows(attributeId : String, conditionAttribute : String)
        var attribute  = m_part.getAttribute(attributeId);
        var line       = attributeId +"_доп";
        var plus       = Index(conditionAttribute, "+" );
        var minus      = Index(conditionAttribute, "-" );

        if (plus != 0)
            if ((m_part.getAttribute(SubStr(conditionAttribute, 1, plus - 1)).getValue() + m_part.getAttribute(SubStr(conditionAttribute, plus + 1)).getValue()) > 0)
                attribute.setValue(m_part.getAttribute(line).getValue());
            else
                attribute.setValue($0.0);
            end;
        elif (minus != 0)
             if ((m_part.getAttribute(SubStr(conditionAttribute, 1,minus - 1)).getValue() - m_part.getAttribute(SubStr(conditionAttribute, minus + 1)).getValue()) > 0)
                attribute.setValue(m_part.getAttribute(line).getValue());
            else
                attribute.setValue($0.0);
            end;
       elif (m_part.getAttribute(conditionAttribute).getValue() > 0)
                attribute.setValue(m_part.getAttribute(line).getValue());
       else
            attribute.setValue($0.0);
       end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_8_1_DOP(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.8.1")
            m_protocolView.printAlg(attributeId, "101.8.1.1_доп + 101.8.1.2_доп + 101.8.1.3_доп + 101.8.1.4_доп");
            attribute.setValue(m_part.getAttribute("101.8.1.1_доп").getValue()).
                          plus(m_part.getAttribute("101.8.1.2_доп").getValue()).
                          plus(m_part.getAttribute("101.8.1.3_доп").getValue()).
                          plus(m_part.getAttribute("101.8.1.4_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_9_1_DOP(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "101.9.1")
            m_protocolView.printAlg(attributeId, "101.9.1.1_доп + 101.9.1.2_доп + 101.9.1.3_доп + 101.9.1.4_доп");

            attribute.setValue(m_part.getAttribute("101.9.1.1_доп").getValue()).
                          plus(m_part.getAttribute("101.9.1.2_доп").getValue()).
                          plus(m_part.getAttribute("101.9.1.3_доп").getValue()).
                          plus(m_part.getAttribute("101.9.1.4_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_6_1_DOP(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "100.6.1")
            m_protocolView.printAlg(attributeId, "100.6.1.1_доп + 100.6.1.2_доп + 100.6.1.3_доп + 100.6.1.4_доп");

            m_protocolView.printLineValueInfo("100.6.1.1_доп", m_part.getAttribute("100.6.1.1_доп").getValue());

            attribute.setValue(m_part.getAttribute("100.6.1.1_доп").getValue()).
                          plus(m_part.getAttribute("100.6.1.2_доп").getValue()).
                          plus(m_part.getAttribute("100.6.1.3_доп").getValue()).
                          plus(m_part.getAttribute("100.6.1.4_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_5_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.5.1")
            m_protocolView.printAlg(attributeId, "200.5.2.1_доп + 200.5.2.2_доп + 200.5.2.3_доп + 200.5.2.4_доп");

            attribute.setValue(m_part.getAttribute("200.5.1.1_доп").getValue()).
                          plus(m_part.getAttribute("200.5.1.2_доп").getValue()).
                          plus(m_part.getAttribute("200.5.1.3_доп").getValue()).
                          plus(m_part.getAttribute("200.5.1.4_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == "200.6.1")
            m_protocolView.printAlg(attributeId, "200.6.1.1_доп + 200.6.1.2_доп + 200.6.1.3_доп + 200.6.1.4_доп");

            attribute.setValue(m_part.getAttribute("200.6.1.1_доп").getValue()).
                          plus(m_part.getAttribute("200.6.1.2_доп").getValue()).
                          plus(m_part.getAttribute("200.6.1.3_доп").getValue()).
                          plus(m_part.getAttribute("200.6.1.4_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (m_part.getAttribute("200.6_доп").getValue() > 0)
            attribute.setValue(m_part.getAttribute("200.6_доп").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_6_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var d, m, y;

        /**
         * Сумма 1 атрибута
         */
        var attributeSum1 = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);

        DateSplit(RcbApplication().currentReport.context.period.endDate, d, m, y);

        if (m < 7)
            m_protocolView.printLine("ДООП < 1 июля");

            attributeSum1.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
            attributeSum1.plus(m_part.getAttribute("Прибыль прошлого года").getValue());
            attributeSum1.minus(m_part.getAttribute("200.6.1_доп").getValue());
            attributeSum1.minus(m_part.getAttribute("100.6").getValue());
            attributeSum1.minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
            attributeSum1.plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

            m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
            m_protocolView.printLineValueInfo("Прибыль прошлого года", m_part.getAttribute("Прибыль прошлого года").getValue());
            m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
            m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
            m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
            m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

            if (m_part.getAttribute("attrSum1").getValue() > 0)
                m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года + Прибыль прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв > 0");
            else
                m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года + Прибыль прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв <= 0");
                attributeSum1.setValue($0.0);
            end;
        else
            if (global.parameters.isConfirmedProfitLastDate())
                m_protocolView.printLine("ДООП >= 1 июля и Прибыль предшествующих лет НЕ подтверждена");

                attributeSum1.setValue(m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                attributeSum1.minus(m_part.getAttribute("200.6.1_доп").getValue());
                attributeSum1.minus(m_part.getAttribute("100.6").getValue());
                attributeSum1.minus(m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
                attributeSum1.plus(m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

                m_protocolView.printLineValueInfo("Прибыль предшествующих лет без прибыли прошлого года", m_part.getAttribute("Прибыль предшествующих лет без прибыли прошлого года").getValue());
                m_protocolView.printLineValueInfo("200.6.1_доп", m_part.getAttribute("200.6.1_доп").getValue());
                m_protocolView.printLineValueInfo("100.6", m_part.getAttribute("100.6").getValue());
                m_protocolView.printLineValueInfo("ДохТГ_10801_Неподтв", m_part.getAttribute("ДохТГ_10801_Неподтв").getValue());
                m_protocolView.printLineValueInfo("РасхТГ_10901_Неподтв", m_part.getAttribute("РасхТГ_10901_Неподтв").getValue());

                if (m_part.getAttribute("attrSum1").getValue() > 0)
                    m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв > 0");
                else
                    m_protocolView.printLine("Прибыль предшествующих лет без прибыли прошлого года - 200.6.1_доп - 100.6 - ДохТГ_10801_Неподтв + РасхТГ_10901_Неподтв <= 0");
                    attributeSum1.setValue($0.0);
                end;
            else
                attributeSum1.setValue($0.0);
            end;
        end;

        attribute.setValue(attributeSum1.getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_2_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var reserve;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K1");
            m_protocolView.printLine("Сумма1:");
            m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("101.4.2")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'").op("AND NOT").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_ACTIVEKIND, "'ВВ КО и ФО'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИБК'");
            m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'КВ в СА'");
            sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
            attribute.setValue(sum);
            m_protocolView.printLine("Сумма2:");
            sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
            m_protocolView.printParamValue("K1", global.parameters.getK1());
            attribute.minus(sum).
                   multiply(global.parameters.getK1());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_4_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "101.4.2_данные + 101.4.2_ввод");
        m_protocolView.printLineValueInfo("101.4.2_данные", m_part.getAttribute("101.4.2_данные").getValue());
        m_protocolView.printLineValueInfo("101.4.2_ввод", m_part.getAttribute("101.4.2_ввод").getValue());

        attribute.setValue(m_part.getAttribute("101.4.2_данные").getValue()).
                      plus(m_part.getAttribute("101.4.2_ввод").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_4_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1 * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("104.7.4")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.setValue(sum);
        attribute.multiply(global.parameters.getK2());
        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_7_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "104.7.4_данные + 104.7.4_ввод");
        m_protocolView.printLineValueInfo("104.7.4_данные", m_part.getAttribute("104.7.4_данные").getValue());
        m_protocolView.printLineValueInfo("104.7.4_ввод", m_part.getAttribute("104.7.4_ввод").getValue());

        attribute.setValue(m_part.getAttribute("104.7.4_данные").getValue()).
                      plus(m_part.getAttribute("104.7.4_ввод").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_1_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;

        m_dataSourceFilterAcc.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
        m_protocolView.printLine("Сумма1:");

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.1")).op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'").op("AND").hasAssignedCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'УмИДопК'");
        m_dataSourceAcc.makeCommentForCategory(RCB_OBJTYPE_ACCOUNT, RCB_OBJGROUP_REPORT, "'Ненадлежащие активы'");
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attribute.setValue(sum);

        m_protocolView.printLine("Сумма2:");
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attribute.minus(sum);

        m_protocolView.printParamValue("K2", global.parameters.getK2());

        attribute.multiply(global.parameters.getK2());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printAlg(attributeId, "201.7.1_данные + 201.7.1_ввод");
        m_protocolView.printLineValueInfo("201.7.1_данные", m_part.getAttribute("201.7.1_данные").getValue());
        m_protocolView.printLineValueInfo("201.7.1_ввод", m_part.getAttribute("201.7.1_ввод").getValue());

        attribute.setValue(m_part.getAttribute("201.7.1_данные").getValue()).
                      plus(m_part.getAttribute("201.7.1_ввод").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_200_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        if (global.parameters.isOurBankCorporation())
            m_protocolView.printAlg(attributeId, "200.1.1 + 200.1.2");
            m_protocolView.printLineValueInfo("200.1.1", m_part.getAttribute("200.1.1").getValue());
            m_protocolView.printLineValueInfo("200.1.2", m_part.getAttribute("200.1.2").getValue());

            attribute.plus(m_part.getAttribute("200.1.1").getValue()).
                      plus(m_part.getAttribute("200.1.2").getValue());
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_202_3_Data(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "202.3.1_данные + 202.3.2_данные + 202.3.3");
        m_protocolView.printLineValueInfo("202.3.1_данные", m_part.getAttribute("202.3.1_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.2_данные", m_part.getAttribute("202.3.2_данные").getValue());
        m_protocolView.printLineValueInfo("202.3.3_данные", m_part.getAttribute("202.3.3_данные").getValue());

        attribute.setValue(m_part.getAttribute("202.3.1_данные").getValue()).
                      plus(m_part.getAttribute("202.3.2_данные").getValue()).
                      plus(m_part.getAttribute("202.3.3_данные").getValue());

        if (attribute.getValue() <= 0)
            m_protocolView.printString("Значение переменной " + attributeId + " <= 0! В расчете принимаем равным 0");

            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro execute()
        println("Значения настроек, используемых при расчете:");

        println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                   " + ternary(global.parameters.isOurBankCorporation(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                            " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                                " + string(global.parameters.getCurrentDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                       " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                           " + string(global.parameters.getConfirmedProfitCurrentDate()));

        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                             " + ternary(global.parameters.isCalculateForDocuments(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014 " + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                      " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ЗАПОЛНИТЬ СПРАВОЧНИК КАПИТАЛА                                      " + ternary(global.parameters.getFillCapitalData(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                    " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ВКЛЮЧАТЬ 106 СЧЕТ В БАЗ. КАПИТ.                                    " + ternary(global.parameters.getInclude106InBaseCapital(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                    " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_254П_ввод      " + m_part.getAttribute("Недосозд_резерв_254П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " + m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " + m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " + m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_NeudVloj("101.10.3_НеудВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI_DOP("100.5_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_707("100.6_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_108_109_708("100.6_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_DOP("100.6_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_UB("101.8.2_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708("101.8_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED("101.8_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_NesVstrVl("101.10.1_Несущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_SushVstrVl("101.10.1_Сущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_0("201.2_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.1","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.2","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.3","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.4","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_1("101.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_2("101.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2_Data("101.4.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_4("101.4.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_5("101.4.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_PFI_DOP("101.9_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.1","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.2","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.3","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.4","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI("100.5_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.1","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.2","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.3","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.4","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100("100"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4_Data("101.10.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103("103"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_0("104.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_4("104.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_5("104.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2_Data("104.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_Data("104.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1_Data("104.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3("104.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3_1("104.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4_Data("104.7.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_4("201.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_5("201.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2_Data("201.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_3("201.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_Data("201.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_2("Коэф_НВ_104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_3("104.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2("Коэф_НВ_104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2_1("Коэф_НВ_104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_2("Коэф_НВ_101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4("101.10.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3("201.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3_1("201.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1_Data("201.7.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_PFI_Data("200.5_ПФИ_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.1","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.2","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.3","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.4","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_DOP("200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.1","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.2","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.3","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.4","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_3("200.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200("200"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_2("Коэф_НВ_201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2("Коэф_НВ_201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1_Data("201.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2_1("Коэф_НВ_201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201("201"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202("202"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104("104"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101("101"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_2("Справ_3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_1("Справ_3.1"));
    end;
end;

class (TF123PartCalculateController_4212) TF123PartCalculateController_4637(reportCalculateController : Object, partId : String)
    initTF123PartCalculateController_4212(reportCalculateController, partId);

    private macro calculateLineForUnrequiredReserve(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var stringLen  = StrLen(attributeId);
        var lineNumber = SubStr(attributeId, stringLen - 4, 1);
        var line       = SubStr(attributeId, 1, stringLen - 6);

        if (m_part.getAttributeReserve("Строка_недосозд_рез_ввод").exact == line)
            if   (lineNumber == "1")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_590П_ввод").getValue());
            elif (lineNumber == "2")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
            elif (lineNumber == "3")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
            elif (lineNumber == "4")
                attribute.setValue(m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_1_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printString("Строка_недосозд_рез_ввод = " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());

        if (global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString() == "100.5.1")
            attribute.setValue(m_part.getAttribute("Недосозд_резерв_590П_ввод").getValue());
        else
            m_protocolView.printString("Значение переменной Строка_недосозд_рез_ввод != \"Недосозд_резерв_590П_ввод\"!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_1(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());

        if (m_part.getAttribute("100.5_доп").getValue() > 0)
            attribute.setValue(m_part.getAttribute("100.5.1.1_доп").getValue());
        else
            m_protocolView.printString("Значение переменной 100.5_доп <= 0!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_2_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printString("Строка_недосозд_рез_ввод = " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());

        if (global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString() == "100.5.1")
            attribute.setValue(m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        else
            m_protocolView.printString("Значение переменной Строка_недосозд_рез_ввод != \"Недосозд_резерв_283П_ввод\"!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_2(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());

        if (m_part.getAttribute("100.5_доп").getValue() > 0)
            attribute.setValue(m_part.getAttribute("100.5.1.2_доп").getValue());
        else
            m_protocolView.printString("Значение переменной 100.5_доп <= 0!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_3_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printString("Строка_недосозд_рез_ввод = " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());

        if (global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString() == "100.5.1")
            attribute.setValue(m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        else
            m_protocolView.printString("Значение переменной Строка_недосозд_рез_ввод != \"Недосозд_резерв_1584У_ввод\"!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_3(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());

        if (m_part.getAttribute("100.5_доп").getValue() > 0)
            attribute.setValue(m_part.getAttribute("100.5.1.3_доп").getValue());
        else
            m_protocolView.printString("Значение переменной 100.5_доп <= 0!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_4_DOP(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printString("Строка_недосозд_рез_ввод = " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());

        if (global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString() == "100.5.1")
            attribute.setValue(m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        else
            m_protocolView.printString("Значение переменной Строка_недосозд_рез_ввод != \"Недосозд_резерв_2732У_ввод\"!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_100_5_1_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLineValueInfo("100.5_доп", m_part.getAttribute("100.5_доп").getValue());

        if (m_part.getAttribute("100.5_доп").getValue() > 0)
            attribute.setValue(m_part.getAttribute("100.5.1.4_доп").getValue());
        else
            m_protocolView.printString("Значение переменной 100.5_доп <= 0!");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_101_10_4(attributeId : String)
        var attribute = m_part.getAttribute(attributeId);
        var attrSum1  = m_part.getAttribute("attrSum1");

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "Сумма1");

        attrSum1.setValue(m_part.getAttribute("Сумма_БК_1").getValue()).
                 multiply(0.1765);

        m_protocolView.printLine("Сумма1 = 101.10.4_данные - 101.3 - 101.10.3 - (0.1765 * Сумма_БК_1)");
        m_protocolView.printLineValueInfo("101.10.4_данные", m_part.getAttribute("101.10.4_данные").getValue());
        m_protocolView.printLineValueInfo("101.3", m_part.getAttribute("101.3").getValue());
        m_protocolView.printLineValueInfo("101.10.3", m_part.getAttribute("101.10.3").getValue());
        m_protocolView.printLineValueInfo("Сумма_БК_1", m_part.getAttribute("Сумма_БК_1").getValue());

        attribute.setValue(m_part.getAttribute("101.10.4_данные").getValue()).
                     minus(m_part.getAttribute("101.3").getValue()).
                     minus(m_part.getAttribute("101.10.3").getValue()).
                     minus(attrSum1.getValue());

        println();
        println("Сумма1 =" + attribute.getValue());

        if (attribute.getValue() < 0)
            m_protocolView.printString("Значение Сумма1 < 0! В расчете принимаем равным 0");
            attribute.setValue($0.0);
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_104_4(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);

        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("201", m_part.getAttribute("201").getValue());
        m_protocolView.printLineValueInfo("202", m_part.getAttribute("202").getValue());

        attribute.setValue(m_part.getAttribute("200").getValue()).
                     minus(m_part.getAttribute("201").getValue()).
                     minus(m_part.getAttribute("202").getValue());

        if (attribute.getValue() >= 0)
            m_protocolView.printString("Значение 200 - (201 + 202) >= 0!");

            attribute.setValue($0.0);
        else
            if (m_part.getAttribute("104.7.5").getValue() > 0)
                m_protocolView.printLineValueInfo("104.7.5", m_part.getAttribute("104.7.5").getValue());
                m_protocolView.printString("Значение переменной 104.7.5 > 0!");
                m_protocolView.printAlg(attributeId, "(201 - 201.7.1 + 202) - 200");
                m_protocolView.printLineValueInfo("201", m_part.getAttribute("201").getValue());
                m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
                m_protocolView.printLineValueInfo("202", m_part.getAttribute("202").getValue());
                m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());

                attribute.setValue(m_part.getAttribute("201").getValue()).
                             minus(m_part.getAttribute("201.7.1").getValue()).
                             plus(m_part.getAttribute("202").getValue()).
                             minus(m_part.getAttribute("200").getValue());
            elif (m_part.getAttribute("104.7.5").getValue() == 0)
                m_protocolView.printLineValueInfo("104.7.5", m_part.getAttribute("104.7.5").getValue());
                m_protocolView.printString("Значение переменной 104.7.5 = 0!");
                m_protocolView.printAlg(attributeId, "(201 + 202) - 200");
                m_protocolView.printLineValueInfo("201", m_part.getAttribute("201").getValue());
                m_protocolView.printLineValueInfo("202", m_part.getAttribute("202").getValue());
                m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());

                attribute.setValue(m_part.getAttribute("201").getValue()).
                             plus(m_part.getAttribute("202").getValue()).
                             minus(m_part.getAttribute("200").getValue());
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_6(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printAlg(attributeId, "106 + 200 - (201.1 + 201.2 + 201.3 + 201.4 + 201.5)");
        m_protocolView.printLineValueInfo("106", m_part.getAttribute("106").getValue());
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("201.1", m_part.getAttribute("201.1").getValue());
        m_protocolView.printLineValueInfo("201.2", m_part.getAttribute("201.2").getValue());
        m_protocolView.printLineValueInfo("201.3", m_part.getAttribute("201.3").getValue());
        m_protocolView.printLineValueInfo("201.4", m_part.getAttribute("201.4").getValue());
        m_protocolView.printLineValueInfo("201.5", m_part.getAttribute("201.5").getValue());

        attribute.setValue(m_part.getAttribute("106").getValue()).
                      plus(m_part.getAttribute("200").getValue()).
                     minus(m_part.getAttribute("201.1").getValue()).
                     minus(m_part.getAttribute("201.2").getValue()).
                     minus(m_part.getAttribute("201.3").getValue()).
                     minus(m_part.getAttribute("201.4").getValue()).
                     minus(m_part.getAttribute("201.5").getValue());

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    private macro calculateLine_201_7_5(attributeId : String)
        var attribute  = m_part.getAttribute(attributeId);
        var sum;
        var attrSum1 = m_part.getAttribute("attrSum1");
        var attrSum2 = m_part.getAttribute("attrSum2");
        var tempFilter = m_dataSouceFilters.getFilter("Accounts");
        var tempVal = TArray();

        m_dataSourceFilterAcc.clear();
        tempFilter.clear();

        m_protocolView.printLineInfo(attributeId);
        m_protocolView.printLine("Сумма1:");
        tempFilter.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_ОС"));
        sum = m_dataSourceAcc.getData(tempFilter);
        attrSum1.setValue(sum);
        tempVal[0] = sum;

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("201.7.5_Амортизация"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[1] = sum;

        m_dataSourceFilterAcc.op("AND").add(tempFilter);
        sum = m_dataSourceAcc.getReservesData(m_dataSourceFilterAcc);
        attrSum1.minus(sum);
        tempVal[2] = sum;

        m_protocolView.printLineValueInfo("201.7.5_202.3.1_имущество", m_part.getAttribute("201.7.5_202.3.1_имущество").getValue());
        tempVal[3] = m_part.getAttribute("201.7.5_202.3.1_имущество").getValue();
        attrSum1.minus(tempVal[3]);

        m_protocolView.printAlg("Сумма1", tempVal[0] + " - " + tempVal[1] + " - " + tempVal[2] + " - " + tempVal[3] + " = " + attrSum1.getValue());

        tempVal.size = 0;

        m_protocolView.printLine("Сумма2 = 100 + 103 + 200 - (103.3 + 103.4 + 200.7 + 200.8) - 104.7 - (201.7.1 + 201.7.2 + 201.7.3) - (101.8 + 101.9)");
        m_protocolView.printLineValueInfo("100", m_part.getAttribute("100").getValue());
        m_protocolView.printLineValueInfo("103", m_part.getAttribute("103").getValue());
        m_protocolView.printLineValueInfo("200", m_part.getAttribute("200").getValue());
        m_protocolView.printLineValueInfo("103.3", m_part.getAttribute("103.3").getValue());
        m_protocolView.printLineValueInfo("103.4", m_part.getAttribute("103.4").getValue());
        m_protocolView.printLineValueInfo("200.7", m_part.getAttribute("200.7").getValue());
        m_protocolView.printLineValueInfo("200.8", m_part.getAttribute("200.8").getValue());
        m_protocolView.printLineValueInfo("104.7", m_part.getAttribute("104.7").getValue());
        m_protocolView.printLineValueInfo("201.7.1", m_part.getAttribute("201.7.1").getValue());
        m_protocolView.printLineValueInfo("201.7.2", m_part.getAttribute("201.7.2").getValue());
        m_protocolView.printLineValueInfo("201.7.3", m_part.getAttribute("201.7.3").getValue());
        m_protocolView.printLineValueInfo("101.8", m_part.getAttribute("101.8").getValue());
        m_protocolView.printLineValueInfo("101.9", m_part.getAttribute("101.9").getValue());

        attrSum2.setValue(m_part.getAttribute("100").getValue()).
                     plus(m_part.getAttribute("103").getValue()).
                     plus(m_part.getAttribute("200").getValue()).
                    minus(m_part.getAttribute("103.3").getValue()).
                    minus(m_part.getAttribute("103.4").getValue()).
                    minus(m_part.getAttribute("200.7").getValue()).
                    minus(m_part.getAttribute("200.8").getValue()).
                    minus(m_part.getAttribute("104.7").getValue()).
                    minus(m_part.getAttribute("201.7.1").getValue()).
                    minus(m_part.getAttribute("201.7.2").getValue()).
                    minus(m_part.getAttribute("201.7.3").getValue()).
                    minus(m_part.getAttribute("101.8").getValue()).
                    minus(m_part.getAttribute("101.9").getValue());

        m_dataSourceFilterAcc.clear();

        m_dataSourceFilterAcc.isSatisfiesToBalanceMasks(m_tuneTable.getAccountMasks("200.8"));
        sum = m_dataSourceAcc.getData(m_dataSourceFilterAcc);
        attrSum2.plus(sum);

        if (attrSum2.getValue() >= 0)
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 >= 0!");

            attribute.setValue(attrSum1.getValue()).
                         minus(attrSum2.getValue());
            if (attribute.getValue() >= 0)
                m_protocolView.printSummValueInfo("Сумма2", attribute.getValue());
                m_protocolView.printString("Значение Сумма1 - Сумма2 >= 0!");

                m_protocolView.printAlg(attributeId, "(Сумма1 - Сумма2) * K2");
                m_protocolView.printParamValue("K2", global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        else
            attribute.setValue(attrSum1.getValue());
            m_protocolView.printSummValueInfo("Сумма2", attrSum2.getValue());
            m_protocolView.printString("Значение Сумма2 < 0!");

            if (attribute.getValue() > 0)
                m_protocolView.printSummValueInfo("Сумма1", attrSum2.getValue());
                m_protocolView.printString("Значение Сумма1 > 0!");
                m_protocolView.printAlg(attributeId, "Сумма1 * K2");
                attribute.multiply(global.parameters.getK2());

                attribute.multiply(global.parameters.getK2());
            else
                attribute.setValue($0.0);
            end;
        end;

        m_protocolView.printLineValueInfo(attributeId, attribute.getValue());
    end;

    macro execute()
        println("Значения настроек, используемых при расчете:");

        println("REPTREG/REP_GROUPS/COMMON/ОПФ_КО_АО                                                                   " + ternary(global.parameters.isOurBankCorporation(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ПРОШЛЫЙГ                                                            " + string(global.parameters.getLastDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУД_ТЕКГ                                                                " + string(global.parameters.getCurrentDateProfit()));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ПРОШЛЫЙГ                                                       " + string(global.parameters.getConfirmedProfitLastDate));
        println("REPTREG/REP_GROUPS/COMMON/ДАТААУДПОДТВ_ТЕКГ                                                           " + string(global.parameters.getConfirmedProfitCurrentDate()));

        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/РАСЧЕТ_УК_ПО_ПРОВОДКАМ                                             " + ternary(global.parameters.isCalculateForDocuments(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/СУБКРЕДИТ В Ф.134 НА 01.01.2014 " + string(global.parameters.getSubCredit134F()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ПОДТВЕРЖДЕНИЯ ПЕРЕОЦЕНКИ                                      " + string(global.parameters.getDateRevaluation()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ЗАПОЛНИТЬ СПРАВОЧНИК КАПИТАЛА                                      " + ternary(global.parameters.getFillCapitalData(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ДАТА ГОДОВОГО СОБРАНИЯ АКЦИОНЕР                                    " + string(global.parameters.getDateMeetingShareHolders()));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/ВКЛЮЧАТЬ 106 СЧЕТ В БАЗ. КАПИТ.                                    " + ternary(global.parameters.getInclude106InBaseCapital(), "Yes", "No"));
        println("REPTREG/REP_GROUPS/РАСЧЕТ КАПИТАЛА/НЕПОД_ПРИБ_ПРЕДШ_ЛЕТ_БАЗЕЛЬ III                                    " + string(global.parameters.getUnconfirmedProfitBasel()));
        println();
        println();
        println("Недосозд_резерв_590П_ввод      " + m_part.getAttribute("Недосозд_резерв_590П_ввод").getValue());
        println("Недосозд_резерв_283П_ввод      " + m_part.getAttribute("Недосозд_резерв_283П_ввод").getValue());
        println("Недосозд_резерв_1584У_ввод     " + m_part.getAttribute("Недосозд_резерв_1584У_ввод").getValue());
        println("Недосозд_резерв_2732У_ввод     " + m_part.getAttribute("Недосозд_резерв_2732У_ввод").getValue());
        println("Строка_недосозд_рез_ввод       " + global.getRcbReport().attributeValue("Строка_недосозд_рез_ввод").currentAsString());
        println();
        println();

        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_before032013("100.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_NeudVloj("101.10.3_НеудВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2_after032013("100.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_2("100.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_3("100.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_1("100.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1_0("100.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_1("100.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_0("100.2.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_1("100.2.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_before032013("100.2.1.2_до_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2_after032013("100.2.1.2_с_03.2013"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1_2("100.2.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_1("100.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2_2("100.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_2("100.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrPL("100.3_ПрПЛ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3_PrTG("100.3_ПрТГ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_3("100.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_4("100.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI_DOP("100.5_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2_DOP("100.5.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2_DOP("100.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_707("100.6_ПФИ_707"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_108_109_708("100.6_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_PFI_DOP("100.6_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_PFI_108_109_708_NOT_CONFIRMED("101.8.1_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(finResultLastYearsWithoutProfit("Финансовый результат предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitPreviousYearsWithoutLastYear("Прибыль предшествующих лет без прибыли прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(finResultPreviousYearForDate("Финансовый результат ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(profitLastYear("Прибыль прошлого года"));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(profitLastYears("Прибыль прошлых лет за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_UB("101.8.2_убыток"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708("101.8_ПФИ_108_109_708"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_108_109_708_NOT_CONFIRMED("101.8_ПФИ_108_109_708_неподтв"));
        m_reportCalculateController.addCalculationAttributeData(lossLastYears("Убыток прошлых лет"));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(notImplementedPfiForDate("Нереализ ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за ДООП", rcbApplication().currentReport.context.period.endDate));
        m_reportCalculateController.addCalculationAttributeData(implementedPfiForDate("Реализов ПФИ ПГ за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_DOP("101.8_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_PFI_707("101.8_ПФИ_707 за Дата Ауд_прошлГ", global.parameters.getLastDateProfit()));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_NesVstrVl("101.10.1_Несущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1_SushVstrVl("101.10.1_Сущ_ВстрВлож"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_1("104.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_0("201.2_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_1("201.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.8.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1_DOP("101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.1","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.2","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.3","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.8.1.4","101.8_доп+101.8.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8("101.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_1("101.8.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2_DOP("101.8.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_3("101.8.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_8_2("101.8.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_1("101.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1_2("101.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_1("101.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_2("101.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3_Data("101.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_1("101.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2_Data("101.4.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_2("101.4.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_14("101.14"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_4("101.4.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_3("101.4.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_5("101.4.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4_0("101.4.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_4("101.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_1("101.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_2("101.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_3("101.5.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5_0("101.5_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_5("101.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_6("101.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_7("101.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_PFI_DOP("101.9_ПФИ_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("101.9.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1_DOP("101.9.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2_DOP("101.9.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_DOP("101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.1","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.2","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.3","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("101.9.1.4","101.9_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_PFI("100.5_ПФИ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_DOP("100.5.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_DOP("100.5_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5("100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1("100.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_add_capital("100.5_доб_капитал"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("100.6.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1_DOP("100.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_DOP("100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.1","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.2","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.3","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("100.6.1.4","100.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6("100.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100("100"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_1("100.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_6_2("100.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_2("100.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9("101.9"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_1("101.10.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK("Сумма_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_1("101.9.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_9_2("101.9.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1_DOP("100.5.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_1("100.5.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2_DOP("100.5.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_2("100.5.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_3_DOP("100.5.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_3("100.5.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_4_DOP("100.5.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_100_5_1_4("100.5.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2_Data("101.10.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3_Data("101.10.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4_Data("101.10.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1_1("103.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_1("103.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_2("103.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_3("103.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4_1("103.4.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103_4("103.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_103("103"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_0("104.1_0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_1("104.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_2("104.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_3("104.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_4("104.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1_5("104.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_1("104.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2_Data("104.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_2("104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_Data("104.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2("104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1_Data("104.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3("104.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_3_1("104.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_1("104.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_2("104.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_3("104.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4_Data("104.7.4_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_4("104.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_1("200.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1_2("200.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_1("200.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_2("200.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_3("200.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_4("200.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2_Data("200.5.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2_DOP("200.6.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_2("201.1.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_3("201.1.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_4("201.1.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_5("201.1.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2_Data("201.2.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_2("201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2_3("201.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_Data("201.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV("Сумма_НВ"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_NV_BK("Сумма_НВ_БК"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_2_2("Коэф_НВ_104.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2_3("104.2.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_2("104.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2("Коэф_НВ_104.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_1("104.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3("104.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_104_3_2_1("Коэф_НВ_104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_3_2_1("104.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_101_10_2("Коэф_НВ_101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_2("101.10.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Summa_BK_1("Сумма_БК_1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_3("101.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_3("101.10.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10_4("101.10.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_10("101.10"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2("201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3("201.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_3_1("201.3.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1_Data("201.7.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_1("201.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_2("201.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_3("201.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_4("201.7.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2_Data("202.3.2_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3_Data("202.3.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_PFI_Data("200.5_ПФИ_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.5.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1_Data("200.5.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_Data("200.5_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.1","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.2","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.3","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.5.1.4","200.5_данные-100.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5("200.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_2("200.5.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.2_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.3_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForUnrequiredReserve("200.6.1.4_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1_DOP("200.6.1_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_DOP("200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.1","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.2","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.3","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLineForAdditionalRows("200.6.1.4","200.6_доп"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6("200.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_1("200.6.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_6_2("200.6.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_1("200.7.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_2("200.7.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7_3("200.7.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_7("200.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_8("200.8"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200("200"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7_5("104.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_7("104.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_1("201.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1_0("201.1.0"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_1("201.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_2_2("Коэф_НВ_201.2.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_2("201.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2("Коэф_НВ_201.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1_Data("201.3.2.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Coeff_NV_201_3_2_1("Коэф_НВ_201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1_1("201.3.1.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_2_1("201.3.2.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3_1("201.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_3("201.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5("201.7.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7_5_1("201.7.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_7("201.7"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_5("201.5"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201("201"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_1("202.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_2("202.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1_Data("202.3.1_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_Data("202.3_данные"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_4("202.3.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3("202.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_1("К_202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_1("202.3.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_2("К_202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_2("202.3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_K_202_3_3("К_202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_3("202.3.3"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202("202"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_203("203"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104_4("104.4"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_104("104"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_105("105"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101_11("101.11"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_101("101"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_102("102"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_106("106"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_000("000"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_200_5_1("200.5.1"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_201_6("201.6"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_202_3_IST_SS("202.3_ист_СС"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_2("Справ_3.2"));
        m_reportCalculateController.addCalculationAttributeData(calculateLine_Sprav_3_1("Справ_3.1"));
    end;
end;
