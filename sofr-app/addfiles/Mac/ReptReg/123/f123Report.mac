/*
$Name:          f123Report.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Отчет
*/

/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbReportBase) TF123Report(report : RcbReport, isLazy : Bool)
    private var m_attributeValue;
    private var m_userAttributeValue;
    private var m_zeroInitialize = TArray();

    private macro getAttributeValue()
        if (m_attributeValue == null)
            m_attributeValue = m_rcbReport.attributeValue("ДанныеОтчета");
        end;

        return m_attributeValue;
    end;

    private macro getUserAttributeValue()
        if (m_userAttributeValue == null)
            m_userAttributeValue = m_rcbReport.attributeValue("ПользовательскийВвод");
        end;

        return m_userAttributeValue;
    end;

    private macro getPartCompositeValue(code : String)
        var keyValue = getAttributeValue().createKeyValue();

        keyValue.fieldValue("code") = code;

        var compositeValue = getAttributeValue().findValue(keyValue);

        if (compositeValue != null)
            return compositeValue;
        end;

        compositeValue = getAttributeValue().addValue();
        compositeValue.reset();
        compositeValue.fieldValue("code").exact = code;

        return compositeValue;
    end;

    private macro getPartUserCompositeValue(code : String)
        var keyValue = getUserAttributeValue().createKeyValue();

        keyValue.fieldValue("code") = code;

        var compositeValue = getUserAttributeValue().findValue(keyValue);

        if (compositeValue != null)
            return compositeValue;
        end;

        compositeValue = getUserAttributeValue().addValue();
        compositeValue.reset();
        compositeValue.fieldValue("code").exact = code;
        compositeValue.fieldValue("value").setUndefined();

        return compositeValue;
    end;

    macro initialize()
    end;

    macro isCalculated()
        return getRcbReport().isCalculated;
    end;

    macro isEmpty()
        return getPart("").initialize();
    end;

    private macro defineAtribute(attributeId : String, value : Variant)
        var part = getPart("");
        part.getAttribute(attributeId).setValue(value);
    end;

    private macro defineUserAtribute(attributeId : String, value : Variant)
        if (not getPartUserCompositeValue(attributeId).fieldValue("value").isDefined)
            getPartUserCompositeValue(attributeId).fieldValue("value").exact = NVL(value, 0);
            if (nvl(value, 0) == 0)
                m_zeroInitialize[m_zeroInitialize.size] = attributeId;
            end;
        end;
    end;

    macro ControlReserveInput()
        println();

        if (not getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact == 0)
                println("Недосозд_резерв_254П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact < 0)
            println("Недосозд_резерв_254П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_254П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact == 0)
                println("Недосозд_резерв_283П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact < 0)
            println("Недосозд_резерв_283П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_283П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact == 0)
                println("Недосозд_резерв_1584У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact < 0)
            println("Недосозд_резерв_1584У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_1584У_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact == 0)
                println("Недосозд_резерв_2732У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact < 0)
            println("Недосозд_резерв_2732У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_2732У_ввод не может быть меньше 0.");
        end;

        if (   (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.5.2")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.6.2")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.8.2")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.9.2")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.5.2")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.6.2")
           )
            println();
            println("Строка_недосозд_рез_ввод = " + getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact + ". Номер строки, в которой должен отражаться недосозданный резерв, введен неверно. Введите одно из значений: 100.5.2, 100.6.2, 101.8.2, 101.9.2, 200.5.2, 200.6.2.")
        end;
    end;

    macro defineUserInputByReserve()
        defineUserAtribute("100.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("100.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("100.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("100.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.8.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("101.8.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.8.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.8.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.9.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("101.9.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.9.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.9.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("200.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("200.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
    end;

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("100.6.1_ПФИ_108_109_708", $0.0);
        defineUserAtribute("101.8.1_ПФИ_108_109_708", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("101.12", $0.0);
        defineUserAtribute("101.13", $0.0);
        defineUserAtribute("104.5", $0.0);
        defineUserAtribute("104.6", $0.0);
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("200.6.1_ПФИ_108_109_708", $0.0);
        defineUserAtribute("201.4", $0.0);
        defineUserAtribute("201.5", $0.0);
        defineUserAtribute("201.7.4_202.2", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0);
        defineUserAtribute("201.7.6", $0.0);
        defineUserAtribute("202.4", $0.0);

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());
        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.6.1_ПФИ_108_109_708", getPartUserCompositeValue("100.6.1_ПФИ_108_109_708").fieldValue("value").exact);
        defineAtribute("100.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.1_ПФИ_108_109_708", getPartUserCompositeValue("101.8.1_ПФИ_108_109_708").fieldValue("value").exact * (-1));
        defineAtribute("101.8.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.6.1_ПФИ_108_109_708", getPartUserCompositeValue("200.6.1_ПФИ_108_109_708").fieldValue("value").exact);
        defineAtribute("200.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5", getPartUserCompositeValue("201.5").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
    end;

    private macro constructorTF123Report(report : RcbReport, isLazy : Bool)
        initRcbReportBase(report, isLazy);
        m_attributeValue = m_rcbReport.attributeValue("ДанныеОтчета");
        m_userAttributeValue = m_rcbReport.attributeValue("ПользовательскийВвод");
    end;

    constructorTF123Report(report, isLazy);
end;

class (TF123Report) TF123Report_3714(report : RcbReport, isLazy : Bool)
    initTF123Report(report, isLazy);

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("101.12", $0.0);
        defineUserAtribute("101.13", $0.0);
        defineUserAtribute("104.5", $0.0);
        defineUserAtribute("104.6", $0.0);
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0);
        defineUserAtribute("201.5", $0.0);
        defineUserAtribute("201.7.4_202.2", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0);
        defineUserAtribute("201.7.6", $0.0);
        defineUserAtribute("202.4", $0.0);

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());
        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5", getPartUserCompositeValue("201.5").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
    end;
end;

class (TF123Report) TF123Report_3875(report : RcbReport, isLazy : Bool)
    initTF123Report(report, isLazy);

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("101.12", $0.0);
        defineUserAtribute("101.13", $0.0);
        defineUserAtribute("104.5", $0.0);
        defineUserAtribute("104.6", $0.0);
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0);
        defineUserAtribute("201.5_ввод", $0.0);
        defineUserAtribute("201.7.4_202.2", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0);
        defineUserAtribute("201.7.6", $0.0);
        defineUserAtribute("202.4", $0.0);
        defineUserAtribute("101.14.1", $0.0);
        defineUserAtribute("101.14.2", $0.0);
        defineUserAtribute("101.14.3", $0.0);
        defineUserAtribute("Справ_1", $0.0);
        defineUserAtribute("Справ_2", $0.0);

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());
        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
    end;
end;

class (TF123Report) TF123Report_XXXX(report : RcbReport, isLazy : Bool)
    initTF123Report(report, isLazy);

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("101.12", $0.0);
        defineUserAtribute("101.13", $0.0);
        defineUserAtribute("104.5", $0.0);
        defineUserAtribute("104.6", $0.0);
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0);
        defineUserAtribute("201.5_ввод", $0.0);
        defineUserAtribute("201.7.4_202.2", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0);
        defineUserAtribute("201.7.6", $0.0);
        defineUserAtribute("202.4", $0.0);
        defineUserAtribute("101.14.1", $0.0);
        defineUserAtribute("101.14.2", $0.0);
        defineUserAtribute("101.14.3", $0.0);
        defineUserAtribute("Справ_1", $0.0);
        defineUserAtribute("Справ_2", $0.0);
        defineUserAtribute("100.5.3_оцен_сниж_СС", $0.0);
        defineUserAtribute("100.6.3_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.8.3_оцен_сниж_СС_ПрошлГода", $0.0);
        defineUserAtribute("101.8.3_оцен_сниж_СС_ПрошлЛет", $0.0);
        defineUserAtribute("101.9.3_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.5.3_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.6.3_оцен_сниж_СС", $0.0);

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());
        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.6.2.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.2.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.2.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.2.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
        defineAtribute("100.5.3_оцен_сниж_СС", getPartUserCompositeValue("100.5.3_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.3_оцен_сниж_СС", getPartUserCompositeValue("100.6.3_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.8.3_оцен_сниж_СС_ПрошлГода", getPartUserCompositeValue("101.8.3_оцен_сниж_СС_ПрошлГода").fieldValue("value").exact);
        defineAtribute("101.8.3_оцен_сниж_СС_ПрошлЛет", getPartUserCompositeValue("101.8.3_оцен_сниж_СС_ПрошлЛет").fieldValue("value").exact);
        defineAtribute("101.9.3_оцен_сниж_СС", getPartUserCompositeValue("101.9.3_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.5.3_оцен_сниж_СС", getPartUserCompositeValue("200.5.3_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.6.3_оцен_сниж_СС", getPartUserCompositeValue("200.6.3_оцен_сниж_СС").fieldValue("value").exact);
    end;
end;

class (TF123Report) TF123Report_4033(report : RcbReport, isLazy : Bool)
    initTF123Report(report, isLazy);

    private macro defineUserAtribute(attributeId : String, value : Variant, comment : String)
        if (not getPartUserCompositeValue(attributeId).fieldValue("value").isDefined)
            getPartUserCompositeValue(attributeId).fieldValue("value").exact = NVL(value, 0);
            if (nvl(value, 0) == 0)
                m_zeroInitialize[m_zeroInitialize.size] = attributeId;
            end;
        end;

        if (comment != null)
            getPartUserCompositeValue(attributeId).fieldValue("comment").exact = comment;
        end;
    end;

    macro defineUserInputByReserve()
        defineUserAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineUserAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
    end;

    macro ControlReserveInput()
        println();

        if (not getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact == 0)
                println("Недосозд_резерв_254П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact < 0)
            println("Недосозд_резерв_254П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_254П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact == 0)
                println("Недосозд_резерв_283П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact < 0)
            println("Недосозд_резерв_283П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_283П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact == 0)
                println("Недосозд_резерв_1584У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact < 0)
            println("Недосозд_резерв_1584У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_1584У_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact == 0)
                println("Недосозд_резерв_2732У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact < 0)
            println("Недосозд_резерв_2732У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_2732У_ввод не может быть меньше 0.");
        end;

        if (   (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.5.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.6.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.8.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.9.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.5.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.6.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").isDefined)
           )
            println();
            println("Строка_недосозд_рез_ввод = " + getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact + ". Номер строки, в которой должен отражаться недосозданный резерв, введен неверно. Введите одно из значений: 100.5.1, 100.6.1, 101.8.1, 101.9.1, 200.5.1, 200.6.1.")
        end;
    end;

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("100.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("100.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", $0.0);
        defineUserAtribute("101.9.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.12", $0.0, "Обязательства КО по приобретению источников БК с учетом п. 8.1");
        defineUserAtribute("101.13", $0.0, "Средства, поступившие в оплату акций КО с учетом п. 8.1");
        defineUserAtribute("104.5", $0.0, "Обязательства КО по приобретению источников добавочного капитала с учетом п. 8.1");
        defineUserAtribute("104.6", $0.0, "Средства, поступившие в оплату акций КО, включаемые в состав добав. капитала,  с учетом п. 8.1");
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0, "Обязательства КО по приобретению источников ДопК с учетом п. 8.1");
        defineUserAtribute("201.5_ввод", $0.0, "Средства, поступившие в оплату акций, включаемых в ДопК");
        defineUserAtribute("201.7.4_202.2", $0.0, "Величина превышения  совокупной суммы кредитов, банковских гарантий, предоставленных участникам и инсайдерам, над ее максимальным размером");
        defineUserAtribute("201.7.6", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику  с учетом п. 8.1.1");
        defineUserAtribute("202.4", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику с учетом п. 8.1");
        defineUserAtribute("101.14.1", $0.0);
        defineUserAtribute("101.14.2", $0.0);
        defineUserAtribute("101.14.3", $0.0);
        defineUserAtribute("101.15", $0.0);
        defineUserAtribute("Справ_1", $0.0);
        defineUserAtribute("Справ_2", $0.0);
        defineUserAtribute("101.8.3_оцен_сниж_СС_ПрошлГода", $0.0);
        defineUserAtribute("101.8.3_оцен_сниж_СС_ПрошлЛет", $0.0);
        defineUserAtribute("200.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.9", $0.0);
        defineUserAtribute("Сумма_Оплач_Премий_52601", $0.0);
        defineUserAtribute("Сумма_Получ_Премий_52602", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0, "Часть счета 604 (неденежные активы, внесенные в оплату размещаемых акций до регистрации отчета об итогах выпуска акций) и сумма остатков, числящихся на БС 60311 и 60313, в части фактически израсходованных на строительство средств, поступивших от участников долевого строительства и учитываемых на отдельных лицевых счетах дольщиков");

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());
        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.5.2_оцен_сниж_СС", getPartUserCompositeValue("100.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.2_оцен_сниж_СС", getPartUserCompositeValue("100.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлГода").fieldValue("value").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлЛет").fieldValue("value").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("101.15", getPartUserCompositeValue("101.15").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.5.2_оцен_сниж_СС", getPartUserCompositeValue("200.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("200.6.2_оцен_сниж_СС", getPartUserCompositeValue("200.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.9", getPartUserCompositeValue("200.9").fieldValue("value").exact);
        defineAtribute("201.7.5_202.3.1_имущество", getPartUserCompositeValue("201.7.5_202.3.1_имущество").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
        defineAtribute("Сумма_Оплач_Премий_52601", getPartUserCompositeValue("Сумма_Оплач_Премий_52601").fieldValue("value").exact);
        defineAtribute("Сумма_Получ_Премий_52602", getPartUserCompositeValue("Сумма_Получ_Премий_52602").fieldValue("value").exact);
    end;
end;

class (TF123Report_4033) TF123Report_41_1_1_4_330(report : RcbReport, isLazy : Bool)
    initTF123Report_4033(report, isLazy);

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("100.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("100.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", $0.0);
        defineUserAtribute("101.9.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.12", $0.0, "Обязательства КО по приобретению источников БК с учетом п. 8.1");
        defineUserAtribute("101.13", $0.0, "Средства, поступившие в оплату акций КО с учетом п. 8.1");
        defineUserAtribute("104.5", $0.0, "Обязательства КО по приобретению источников добавочного капитала с учетом п. 8.1");
        defineUserAtribute("104.6", $0.0, "Средства, поступившие в оплату акций КО, включаемые в состав добав. капитала,  с учетом п. 8.1");
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0, "Обязательства КО по приобретению источников ДопК с учетом п. 8.1");
        defineUserAtribute("201.5_ввод", $0.0, "Средства, поступившие в оплату акций, включаемых в ДопК");
        defineUserAtribute("201.7.4_202.2", $0.0, "Величина превышения  совокупной суммы кредитов, банковских гарантий, предоставленных участникам и инсайдерам, над ее максимальным размером");
        defineUserAtribute("201.7.6", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику  с учетом п. 8.1.1");
        defineUserAtribute("202.4", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику с учетом п. 8.1");
        defineUserAtribute("101.14.1", $0.0);
        defineUserAtribute("101.14.2", $0.0);
        defineUserAtribute("101.14.3", $0.0);
        defineUserAtribute("101.15", $0.0);
        defineUserAtribute("Справ_1", $0.0);
        defineUserAtribute("Справ_2", $0.0);
        defineUserAtribute("200.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.9", $0.0);
        defineUserAtribute("Сумма_Оплач_Премий_52601", $0.0);
        defineUserAtribute("Сумма_Получ_Премий_52602", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0, "Часть счета 604 (неденежные активы, внесенные в оплату размещаемых акций до регистрации отчета об итогах выпуска акций) и сумма остатков, числящихся на БС 60311 и 60313, в части фактически израсходованных на строительство средств, поступивших от участников долевого строительства и учитываемых на отдельных лицевых счетах дольщиков");

        defineUserAtribute("ДохТГ_10801_Подтв", $0.0, "Подтвержденные доходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 108.");
        defineUserAtribute("ДохТГ_10801_Неподтв", $0.0, "Неподтвержденные доходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 108.");
        defineUserAtribute("РасхТГ_10901_Подтв", $0.0, "Подтвержденные расходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 109.");
        defineUserAtribute("РасхТГ_10901_Неподтв", $0.0, "Неподтвержденные расходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 109.");

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());

        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.5.2_оцен_сниж_СС", getPartUserCompositeValue("100.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.2_оцен_сниж_СС", getPartUserCompositeValue("100.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлГода").fieldValue("value").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлЛет").fieldValue("value").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("101.15", getPartUserCompositeValue("101.15").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.5.2_оцен_сниж_СС", getPartUserCompositeValue("200.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("200.6.2_оцен_сниж_СС", getPartUserCompositeValue("200.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.9", getPartUserCompositeValue("200.9").fieldValue("value").exact);
        defineAtribute("201.7.5_202.3.1_имущество", getPartUserCompositeValue("201.7.5_202.3.1_имущество").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
        defineAtribute("Сумма_Оплач_Премий_52601", getPartUserCompositeValue("Сумма_Оплач_Премий_52601").fieldValue("value").exact);
        defineAtribute("Сумма_Получ_Премий_52602", getPartUserCompositeValue("Сумма_Получ_Премий_52602").fieldValue("value").exact);

        defineAtribute("ДохТГ_10801_Подтв", getPartUserCompositeValue("ДохТГ_10801_Подтв").fieldValue("value").exact);
        defineAtribute("ДохТГ_10801_Неподтв", getPartUserCompositeValue("ДохТГ_10801_Неподтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Подтв", getPartUserCompositeValue("РасхТГ_10901_Подтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Неподтв", getPartUserCompositeValue("РасхТГ_10901_Неподтв").fieldValue("value").exact);
    end;
end;

class (TF123Report_41_1_1_4_330) TF123Report_4212(report : RcbReport, isLazy : Bool)
    initTF123Report_41_1_1_4_330(report, isLazy);

    macro defineUserInput()
        defineUserAtribute("100.5_дисконт", $0.0);
        defineUserAtribute("101.9_дисконт", $0.0);
        defineUserAtribute("100.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("100.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", $0.0);
        defineUserAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", $0.0);
        defineUserAtribute("101.9.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("101.12", $0.0, "Обязательства КО по приобретению источников БК с учетом п. 8.1");
        defineUserAtribute("101.13", $0.0, "Средства, поступившие в оплату акций КО с учетом п. 8.1");
        defineUserAtribute("104.5", $0.0, "Обязательства КО по приобретению источников добавочного капитала с учетом п. 8.1");
        defineUserAtribute("104.6", $0.0, "Средства, поступившие в оплату акций КО, включаемые в состав добав. капитала,  с учетом п. 8.1");
        defineUserAtribute("200.5_дисконт", $0.0);
        defineUserAtribute("201.4", $0.0, "Обязательства КО по приобретению источников ДопК с учетом п. 8.1");
        defineUserAtribute("201.5_ввод", $0.0, "Средства, поступившие в оплату акций, включаемых в ДопК");
        defineUserAtribute("201.7.4_202.2", $0.0, "Величина превышения  совокупной суммы кредитов, банковских гарантий, предоставленных участникам и инсайдерам, над ее максимальным размером");
        defineUserAtribute("201.7.6", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику  с учетом п. 8.1.1");
        defineUserAtribute("202.4", $0.0, "Разница между действительной стоимостью доли, причитающейся вышедшим из общества участникам, и стоимостью, по которой доля была реализована другому участнику с учетом п. 8.1");
        defineUserAtribute("101.14.1", $0.0);
        defineUserAtribute("101.14.2", $0.0);
        defineUserAtribute("101.14.3", $0.0);
        defineUserAtribute("101.15", $0.0);
        defineUserAtribute("Справ_1", $0.0);
        defineUserAtribute("Справ_2", $0.0);
        defineUserAtribute("200.5.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.6.2_оцен_сниж_СС", $0.0);
        defineUserAtribute("200.9", $0.0);
        defineUserAtribute("Сумма_Оплач_Премий_52601", $0.0);
        defineUserAtribute("Сумма_Получ_Премий_52602", $0.0);
        defineUserAtribute("201.7.5_202.3.1_имущество", $0.0, "Часть счета 604 (неденежные активы, внесенные в оплату размещаемых акций до регистрации отчета об итогах выпуска акций) и сумма остатков, числящихся на БС 60311 и 60313, в части фактически израсходованных на строительство средств, поступивших от участников долевого строительства и учитываемых на отдельных лицевых счетах дольщиков");
        defineUserAtribute("101.4.2_ввод", $0.0, "константа по ненадлежащим активам, установленная после проверки ЦБ");
        defineUserAtribute("104.7.4_ввод", $0.0, "константа по ненадлежащим активам, установленная после проверки ЦБ");
        defineUserAtribute("201.7.1_ввод", $0.0, "константа по ненадлежащим активам, установленная после проверки ЦБ");

        defineUserAtribute("ДохТГ_10801_Подтв", $0.0, "Подтвержденные доходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 108.");
        defineUserAtribute("ДохТГ_10801_Неподтв", $0.0, "Неподтвержденные доходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 108.");
        defineUserAtribute("РасхТГ_10901_Подтв", $0.0, "Подтвержденные расходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 109.");
        defineUserAtribute("РасхТГ_10901_Неподтв", $0.0, "Неподтвержденные расходы текущего года от переоценки при выбытии ОС в текущем году при переносе с БС 106 на БС 109.");

        var i = 0;
        var zeroAttribute = "";
        while (i < m_zeroInitialize.size)
            zeroAttribute = zeroAttribute + m_zeroInitialize[i] + ", ";
            i = i + 1;
        end;
        zeroAttribute = substr(zeroAttribute, 1, strlen(zeroAttribute) - 2);

        if (m_zeroInitialize.size > 0)
            println();
            println("Переменные на пользовательском вводе, проинициализированные нулевым значением:");
            println(zeroAttribute);
        end;
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_254П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());

        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.5.2_оцен_сниж_СС", getPartUserCompositeValue("100.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.2_оцен_сниж_СС", getPartUserCompositeValue("100.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлГода").fieldValue("value").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлЛет").fieldValue("value").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("101.15", getPartUserCompositeValue("101.15").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.5.2_оцен_сниж_СС", getPartUserCompositeValue("200.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_254П_ввод").exact);
        defineAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("200.6.2_оцен_сниж_СС", getPartUserCompositeValue("200.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.9", getPartUserCompositeValue("200.9").fieldValue("value").exact);
        defineAtribute("201.7.5_202.3.1_имущество", getPartUserCompositeValue("201.7.5_202.3.1_имущество").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
        defineAtribute("Сумма_Оплач_Премий_52601", getPartUserCompositeValue("Сумма_Оплач_Премий_52601").fieldValue("value").exact);
        defineAtribute("Сумма_Получ_Премий_52602", getPartUserCompositeValue("Сумма_Получ_Премий_52602").fieldValue("value").exact);
        defineAtribute("101.4.2_ввод", getPartUserCompositeValue("101.4.2_ввод").fieldValue("value").exact);
        defineAtribute("104.7.4_ввод", getPartUserCompositeValue("104.7.4_ввод").fieldValue("value").exact);
        defineAtribute("201.7.1_ввод", getPartUserCompositeValue("201.7.1_ввод").fieldValue("value").exact);

        defineAtribute("ДохТГ_10801_Подтв", getPartUserCompositeValue("ДохТГ_10801_Подтв").fieldValue("value").exact);
        defineAtribute("ДохТГ_10801_Неподтв", getPartUserCompositeValue("ДохТГ_10801_Неподтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Подтв", getPartUserCompositeValue("РасхТГ_10901_Подтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Неподтв", getPartUserCompositeValue("РасхТГ_10901_Неподтв").fieldValue("value").exact);
    end;
end;

class (TF123Report_4212) TF123Report_4637(report : RcbReport, isLazy : Bool)
    initTF123Report_4212(report, isLazy);

    macro ControlReserveInput()
        println();

        if (not getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact == 0)
                println("Недосозд_резерв_590П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact < 0)
            println("Недосозд_резерв_590П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_590П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact == 0)
                println("Недосозд_резерв_283П_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact < 0)
            println("Недосозд_резерв_283П_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_283П_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact == 0)
                println("Недосозд_резерв_1584У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact < 0)
            println("Недосозд_резерв_1584У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_1584У_ввод не может быть меньше 0.");
        end;

        if (not getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").isDefined)
            if (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact == 0)
                println("Недосозд_резерв_2732У_ввод - переменная инициализирована нулем");
            end;
        elif (getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact < 0)
            println("Недосозд_резерв_2732У_ввод = " + getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact + ". Значение переменной на пользовательском вводе Недосозд_резерв_2732У_ввод не может быть меньше 0.");
        end;

        if (   (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.5.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "100.6.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.8.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "101.9.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.5.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact != "200.6.1")
           and (getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").isDefined)
           )
            println();
            println("Строка_недосозд_рез_ввод = " + getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").exact + ". Номер строки, в которой должен отражаться недосозданный резерв, введен неверно. Введите одно из значений: 100.5.1, 100.6.1, 101.8.1, 101.9.1, 200.5.1, 200.6.1.")
        end;
    end;

    macro defineUserInputByReserve()
        defineUserAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineUserAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineUserAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineUserAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineUserAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
    end;

    macro storeUserInput()
        global.getRcbReport().attributeValue("ДанныеОтчета").removeAllValues();
        defineAtribute("Недосозд_резерв_590П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("Недосозд_резерв_1584У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("Недосозд_резерв_2732У_ввод", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("Недосозд_резерв_283П_ввод", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("Строка_недосозд_рез_ввод", getPart("").getAttributeReserve("Строка_недосозд_рез_ввод").currentAsString());

        defineAtribute("100.5_дисконт", getPartUserCompositeValue("100.5_дисконт").fieldValue("value").exact);
        defineAtribute("100.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("100.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("100.5.2_оцен_сниж_СС", getPartUserCompositeValue("100.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.2_оцен_сниж_СС", getPartUserCompositeValue("100.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("100.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("100.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("100.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("100.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("101.8.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.8.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.8.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлГода", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлГода").fieldValue("value").exact);
        defineAtribute("101.8.2_оцен_сниж_СС_ПрошлЛет", getPartUserCompositeValue("101.8.2_оцен_сниж_СС_ПрошлЛет").fieldValue("value").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.9_дисконт", getPartUserCompositeValue("101.9_дисконт").fieldValue("value").exact);
        defineAtribute("101.9.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("101.9.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("101.9.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("101.9.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("101.9.2_оцен_сниж_СС", getPartUserCompositeValue("101.9.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("101.12", getPartUserCompositeValue("101.12").fieldValue("value").exact);
        defineAtribute("101.13", getPartUserCompositeValue("101.13").fieldValue("value").exact);
        defineAtribute("101.14.1", getPartUserCompositeValue("101.14.1").fieldValue("value").exact);
        defineAtribute("101.14.2", getPartUserCompositeValue("101.14.2").fieldValue("value").exact);
        defineAtribute("101.14.3", getPartUserCompositeValue("101.14.3").fieldValue("value").exact);
        defineAtribute("101.15", getPartUserCompositeValue("101.15").fieldValue("value").exact);
        defineAtribute("104.5", getPartUserCompositeValue("104.5").fieldValue("value").exact);
        defineAtribute("104.6", getPartUserCompositeValue("104.6").fieldValue("value").exact);
        defineAtribute("200.5_дисконт", getPartUserCompositeValue("200.5_дисконт").fieldValue("value").exact);
        defineAtribute("200.5.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("200.5.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.5.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.5.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("200.5.2_оцен_сниж_СС", getPartUserCompositeValue("200.5.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.6.1.1", getPart("").getAttributeReserve("Недосозд_резерв_590П_ввод").exact);
        defineAtribute("200.6.1.2", getPart("").getAttributeReserve("Недосозд_резерв_283П_ввод").exact);
        defineAtribute("200.6.1.3", getPart("").getAttributeReserve("Недосозд_резерв_1584У_ввод").exact);
        defineAtribute("200.6.1.4", getPart("").getAttributeReserve("Недосозд_резерв_2732У_ввод").exact);
        defineAtribute("201.4", getPartUserCompositeValue("201.4").fieldValue("value").exact);
        defineAtribute("201.5_ввод", getPartUserCompositeValue("201.5_ввод").fieldValue("value").exact);
        defineAtribute("201.7.4_202.2", getPartUserCompositeValue("201.7.4_202.2").fieldValue("value").exact);
        defineAtribute("201.7.6", getPartUserCompositeValue("201.7.6").fieldValue("value").exact);
        defineAtribute("202.4", getPartUserCompositeValue("202.4").fieldValue("value").exact);
        defineAtribute("200.6.2_оцен_сниж_СС", getPartUserCompositeValue("200.6.2_оцен_сниж_СС").fieldValue("value").exact);
        defineAtribute("200.9", getPartUserCompositeValue("200.9").fieldValue("value").exact);
        defineAtribute("201.7.5_202.3.1_имущество", getPartUserCompositeValue("201.7.5_202.3.1_имущество").fieldValue("value").exact);
        defineAtribute("Справ_1", getPartUserCompositeValue("Справ_1").fieldValue("value").exact);
        defineAtribute("Справ_2", getPartUserCompositeValue("Справ_2").fieldValue("value").exact);
        defineAtribute("Сумма_Оплач_Премий_52601", getPartUserCompositeValue("Сумма_Оплач_Премий_52601").fieldValue("value").exact);
        defineAtribute("Сумма_Получ_Премий_52602", getPartUserCompositeValue("Сумма_Получ_Премий_52602").fieldValue("value").exact);
        defineAtribute("101.4.2_ввод", getPartUserCompositeValue("101.4.2_ввод").fieldValue("value").exact);
        defineAtribute("104.7.4_ввод", getPartUserCompositeValue("104.7.4_ввод").fieldValue("value").exact);
        defineAtribute("201.7.1_ввод", getPartUserCompositeValue("201.7.1_ввод").fieldValue("value").exact);

        defineAtribute("ДохТГ_10801_Подтв", getPartUserCompositeValue("ДохТГ_10801_Подтв").fieldValue("value").exact);
        defineAtribute("ДохТГ_10801_Неподтв", getPartUserCompositeValue("ДохТГ_10801_Неподтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Подтв", getPartUserCompositeValue("РасхТГ_10901_Подтв").fieldValue("value").exact);
        defineAtribute("РасхТГ_10901_Неподтв", getPartUserCompositeValue("РасхТГ_10901_Неподтв").fieldValue("value").exact);
    end;
end;

class (RcbReportBase) TF123PreviousReport()

    private var m_attributeValue;

    private macro getAttributeValue()
        return m_attributeValue = m_rcbReport.attributeValue("ДанныеОтчета");
    end;

    private macro getPartCompositeValue(code : String)

        var keyValue = getAttributeValue().createKeyValue();

        keyValue.fieldValue("code") = code;

        var compositeValue = getAttributeValue().findValue(keyValue);

        if (compositeValue != null)
            return compositeValue;
        end;

        compositeValue = getAttributeValue().addValue();
        compositeValue.reset();
        compositeValue.fieldValue("code").exact = code;

        return compositeValue;
    end;

    macro initialize()
    end;

    macro isCalculated()
        return getRcbReport().isCalculated;
    end;

    macro isEmpty()
        return getPart("").isEmpty;
    end;

    private macro constructorTF123PreviousReport()
        initRcbReportBase();

        var report;

        var year;
        datesplit(rcbApplication().currentReport.context.period.endDate, null, null, year);
        var context = RcbReportContext(RcbPeriod(date(1, 12, year - 1), date(31, 12, year - 1)),
                                       getRcbReport().context.departmentCode,
                                       getRcbReport().context.issueMode,
                                       getRcbReport().context.organizationStructure,
                                       getRcbReport().context.isSummaryMode
                                      );

        report = RcbApplication().objectFactory.createReport(getRcbReport().form.id, context);

        if (report.isCalculated())
            setRcbReport(report);
            else
                context = RcbReportContext(RcbPeriod(date(31, 12, year - 1), date(31, 12, year - 1)),
                                           getRcbReport().context.departmentCode,
                                           getRcbReport().context.issueMode,
                                           getRcbReport().context.organizationStructure,
                                       getRcbReport().context.isSummaryMode
                                      );
            report = RcbApplication().objectFactory.createReport(getRcbReport().form.id, context);
            if (report.isCalculated())
                setRcbReport(report);
                else
                setRcbReport(global.getRcbReport().createPreviousReport());
                end;
            end;
    end;

    constructorTF123PreviousReport();
end;
