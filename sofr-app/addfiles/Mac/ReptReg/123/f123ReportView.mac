/*
$Name:          f123ReportView.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Представление отчета
*/

/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */
class (RcbPartView) TF123PartView()
    initRcbPartView("");

    private macro initialize()
        m_table.addColumn("Номер|строки",  12,  AL_LEFT);
        m_table.addColumn("Наименование показателя",  84, AL_LEFT);
        m_table.addColumn("Остаток на|отчетную дату",  17, AL_RIGHT);
    end;

    macro printHead()
        m_table.printHead();
        m_table.printString(strLpad("1", 4, " "),
                            strLpad("2", 42, " "),
                            strRpad("3", 8, " "));
    end;
end;

class (RcbReportView) TF123ReportView()
    var kind;
    if ((rcbApplication().currentReport.context.period.kind == RCB_PK_DAY) or
        (rcbApplication().currentReport.context.period.kind == RCB_PK_MONTH) or
        (rcbApplication().currentReport.context.period.kind == RCB_PK_QUARTER) or
        (rcbApplication().currentReport.context.period.kind == RCB_PK_HALFYEAR))
        kind = rcbApplication().currentReport.context.period.kind;
    else
        kind = -1;
    end;

    initRcbReportView("РАСЧЕТ СОБСТВЕННЫХ СРЕДСТВ (КАПИТАЛА) (\"БАЗЕЛЬ III\")", "0409123", kind, DATE_OUT_PERIOD_FORMAT);

    private macro initialize()
        m_partViewPool.push_back(TF123PartView());
    end;
end;