/*
$Name:          f123Normalizer.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Нормализатор.
*/

/**
 * Форма 123. Нормализатор.
 *
 * @since   29.03.2013
 * @author  Kirin Pavel
 * @version 6.00.020.30
 */


class (ReportNormalizer) TF123ReportNormalizer(protocolView)

    private var m_report           = objectFactoryInstance.createReport();
    private var m_attributes       = m_report.getPart("");
    private var m_balanceAttribute = objectFactoryInstance.createBalanceAttribute();
    private var m_protocolView;
    private var m_rowsNumber = RcbArray(0);

    macro contructorTF123ReportNormalizer(protocolView)
        initReportNormalizer(rcbApplication.currentReport.multiplier);
        m_protocolView = protocolView;
    end;

    macro getValueBalanceForKind(firstOrderBalance : RcbArray, kind : String)
        var i = 0;
        var firstOrderBalanceIterator;
        var secondOrderBalanceIterator;
        var balanceResult = 0;

        while (i < firstOrderBalance.size)
            firstOrderBalanceIterator = m_balanceAttribute.getBalanceAttribute(1, firstOrderBalance[i], false);
            if (firstOrderBalanceIterator != null)
                secondOrderBalanceIterator = firstOrderBalanceIterator.createValueIterator();
                if (secondOrderBalanceIterator != null)
                    secondOrderBalanceIterator.moveFirst();
                    while (not secondOrderBalanceIterator.isDone())
                        if ((kind == "П") and (secondOrderBalanceIterator.currentitem.fieldValue("kind").currentAsString == kind))
                            balanceResult = balanceResult + secondOrderBalanceIterator.currentitem.fieldValue("restPassive").scaled;
                        elif ((kind == "А") and (secondOrderBalanceIterator.currentitem.fieldValue("kind").currentAsString == kind))
                            balanceResult = balanceResult + secondOrderBalanceIterator.currentitem.fieldValue("restActive").scaled;
                        end;

                        secondOrderBalanceIterator.moveNext();
                    end;
                end;
            end;
            i = i + 1;
        end;

        return balanceResult;
    end;

    macro addRule(attribute : TF123Attribute, value : Double, sign)
        if (attribute.getValue() != null)
            var relation = ReportLinearRelation(sign);
            var node = normalizer.addNode(attribute.getId());

            node.exact = attribute.getValue();
            node.recalculateScaled();

            relation.lhs.plus(node);
            relation.rhs.plus(double(nvl(value, 0)));

            this.addRelation(relation);

            m_rowsNumber.push_back(attribute.getId());
        end;
    end;

    macro getValueBalance(balance)
        var attributeBalance = m_balanceAttribute.getBalanceAttribute(1, balance, false);

        if (attributeBalance != null)
            if (attributeBalance.fieldValue("kind").currentAsString == "П")
                return attributeBalance.fieldValue("restPassive").scaled;
            else
                return attributeBalance.fieldValue("restActive").scaled;
            end;
        end;

        return 0;
    end;

    macro addRuleFor_100_1_1()
        addRule(m_attributes.getAttribute("100.1.1"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_1_2()
        addRule(m_attributes.getAttribute("100.1.2"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_1_3()
        addRule(m_attributes.getAttribute("100.1.3"), getValueBalance("10208"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_2_1_1()
        addRule(m_attributes.getAttribute("100.2.1.1"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_2_1_2()
        addRule(m_attributes.getAttribute("100.2.1.2"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_2_2()
        addRule(m_attributes.getAttribute("100.2.2"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_3()
        addRule(m_attributes.getAttribute("100.3"), getValueBalance("10701"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_4()
        addRule(m_attributes.getAttribute("100.4"), getValueBalance("10701"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_5()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("100.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") +
                getValueBalance("61304");
            Y = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") +
                getValueBalance("70609") + getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70612") + getValueBalance("70614") +
                getValueBalance("70616") + getValueBalance("50905") + getValueBalance("61401") + getValueBalance("61403");

            Z = X - Y - m_attributes.getAttribute("101.9").getScaledValue() - m_attributes.getAttribute("200.5").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("100.5"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.5"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_100_5_1_V()
        var X;

        if (m_attributes.getAttribute("100.5").getValue() > 0)
            X = getValueBalance("70613") - getValueBalance("70614");

            if (X > 0)
                addRule(m_attributes.getAttribute("100.5.1в"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.5.1в"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.5.1в"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_100_5_1_G()
        var X;

        if (m_attributes.getAttribute("100.5").getValue() > 0)
            X = getValueBalance("70614") - getValueBalance("70613");

            if (X > 0)
                addRule(m_attributes.getAttribute("100.5.1г"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.5.1г"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.5.1г"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_100_5_1_A()
        addRule(m_attributes.getAttribute("100.5.1а"), m_attributes.getAttribute("100.5.1в").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_5_1_B()
        addRule(m_attributes.getAttribute("100.5.1б"), m_attributes.getAttribute("100.5.1г").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_5_3()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("100.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("70602");
            Y = getValueBalance("10605") + getValueBalance("70607");

            Z = X - Y - m_attributes.getAttribute("101.9.3").getScaledValue() - m_attributes.getAttribute("200.5.3").getScaledValue();

            addRule(m_attributes.getAttribute("100.5.3"), Z, RCB_RS_LESS_OR_EQUAL);
        else
            addRule(m_attributes.getAttribute("100.5.3"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_100_6()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("100.6").getValue() > 0)
            X = getValueBalance("10801") + getValueBalance("70701") + getValueBalance("70702") + getValueBalance("70703") + getValueBalance("70704") +
                getValueBalance("70705") + getValueBalance("70713") + getValueBalance("70715") + getValueBalance("70801");
            Y = getValueBalance("10901") + getValueBalance("70706") + getValueBalance("70707") + getValueBalance("70708") + getValueBalance("70709") +
                getValueBalance("70710") + getValueBalance("70711") + getValueBalance("70712") + getValueBalance("70714") + getValueBalance("70716") +
                getValueBalance("70802");

            Z = X - Y - m_attributes.getAttribute("101.8").getScaledValue() - m_attributes.getAttribute("200.6").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("100.6"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.6"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.6"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_1()
        var X;

        X = getValueBalance("60701") + getValueBalance("60901") + getValueBalance("60905") - getValueBalance("60903");

        addRule(m_attributes.getAttribute("101.1"), X, RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_2()
        addRule(m_attributes.getAttribute("101.2"), getValueBalance("61703"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_3()
        addRule(m_attributes.getAttribute("101.3"), getValueBalance("61702"), RCB_RS_LESS_OR_EQUAL);
    end;


    macro addRuleFor_101_4_1()
        var X;

        X = getValueBalance("10501") + getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("101.4.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
            getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") +
            getValueBalance("50718") - getValueBalance("50719");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("100.6"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_3()
        addRule(m_attributes.getAttribute("101.4.3"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_5_1()
        addRule(m_attributes.getAttribute("101.5.1"), getValueBalance("10502"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_5_2()
        var X;
        var Y;
        var Z;

        X = getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
        getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
        getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
        getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
        getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
        getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
        getValueBalance("47308") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
        getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") -
        getValueBalance("50719");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.5.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_5_3()
        var X;
        var Y;
        var Z;

        X = getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
        getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
        getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
        getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
        getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
        getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
        getValueBalance("47308") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
        getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") -
        getValueBalance("50719");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.5.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_6()
        var X;

        X = getValueBalance("10208") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("101.6"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_7()
        var X;

        X = getValueBalance("10502") + getValueBalance("47901") + getValueBalance("506") + getValueBalance("507");
        addRule(m_attributes.getAttribute("101.7"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_8()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("101.8").getValue() > 0)
            X = getValueBalance("10901") + getValueBalance("70706") + getValueBalance("70707") + getValueBalance("70708") + getValueBalance("70709") +
                getValueBalance("70710") + getValueBalance("70711") + getValueBalance("70712") + getValueBalance("70714") + getValueBalance("70716") +
                getValueBalance("70802");
            Y = getValueBalance("10801") + getValueBalance("70701") + getValueBalance("70702") + getValueBalance("70703") + getValueBalance("70704") +
                getValueBalance("70705") + getValueBalance("70713") + getValueBalance("70715") + getValueBalance("70801");

            Z = X - Y - m_attributes.getAttribute("100.6").getScaledValue() - m_attributes.getAttribute("200.6").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("101.8"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.8"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.8"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_9()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("101.9").getValue() > 0)
            X = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") +
                getValueBalance("70609") + getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70612") + getValueBalance("70614") +
                getValueBalance("70616") + getValueBalance("50905") + getValueBalance("61401") + getValueBalance("61403");

            Y = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") +
                getValueBalance("61304");

            Z = X - Y - m_attributes.getAttribute("100.5").getScaledValue() - m_attributes.getAttribute("200.5").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("101.9"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.9"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.9"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_9_1_V()
        var X;

        if (m_attributes.getAttribute("101.9").getValue() > 0)
            X = getValueBalance("70613") - getValueBalance("70614");

            if (X > 0)
                addRule(m_attributes.getAttribute("101.9.1в"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.9.1в"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.9.1в"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_9_1_G()
        var X;

        if (m_attributes.getAttribute("101.9").getValue() > 0)
            X = getValueBalance("70614") - getValueBalance("70613");

            if (X > 0)
                addRule(m_attributes.getAttribute("101.9.1г"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.9.1г"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.9.1г"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_9_3()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("101.9").getValue() > 0)
            X = getValueBalance("10605") + getValueBalance("70607");

            Y = getValueBalance("10603") + getValueBalance("70602");

            Z = X - Y - m_attributes.getAttribute("100.5.3").getScaledValue() - m_attributes.getAttribute("200.5.3").getScaledValue();

            addRule(m_attributes.getAttribute("101.9"), Z, RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("101.9"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_10_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_10_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_10_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_1_1()
        addRule(m_attributes.getAttribute("103.1.1"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_2()
        addRule(m_attributes.getAttribute("103.2"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_3()
        var X;

        X = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
            getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
            getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
            getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
            getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");

        addRule(m_attributes.getAttribute("103.3"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_4()
        var X;

        X = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
            getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
            getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
            getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
            getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");

        addRule(m_attributes.getAttribute("103.4"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_1()
        var X;

        X = getValueBalance("10501") + getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("104.1.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.1.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_3()
        addRule(m_attributes.getAttribute("104.1.3"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") +
            getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_1()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_1_1()
        var X;

        X = getValueBalance("32109") + getValueBalance("32309") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50210") + getValueBalance("50211") +
            getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.1.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_1()
        var X;

        X = getValueBalance("32109") + getValueBalance("32309") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50210") + getValueBalance("50211") +
            getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.2.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_6()
        addRule(m_attributes.getAttribute("104.6"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_7_1()
        var X;

        X = getValueBalance("60901") + getValueBalance("60905") - getValueBalance("60903");

        addRule(m_attributes.getAttribute("104.7.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_7_2()
        var X;

        if (global.parameters.isOurBankCorporation())
            X = getValueBalance("10501") + getValueBalance("60323");
        else
            X = getValueBalance("10502");
        end;

        addRule(m_attributes.getAttribute("104.7.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_7_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") +
            getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.7.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_1_1()
        addRule(m_attributes.getAttribute("200.1.1"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_1_2()
        addRule(m_attributes.getAttribute("200.1.2"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_2()
        addRule(m_attributes.getAttribute("200.2"), getValueBalance("102"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_3()
        addRule(m_attributes.getAttribute("200.3"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_4()
        addRule(m_attributes.getAttribute("200.4"), getValueBalance("107"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_5()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("200.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") +
                getValueBalance("61304");

            Y = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") +
                getValueBalance("70609") + getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70612") + getValueBalance("70614") +
                getValueBalance("70616") + getValueBalance("50905") + getValueBalance("61401") + getValueBalance("61403");

            Z = X - Y - m_attributes.getAttribute("100.5").getScaledValue() - m_attributes.getAttribute("101.9").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("200.5"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("200.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("200.5"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200_5_1_V()
        var X;

        if (m_attributes.getAttribute("200.5").getValue() > 0)
            X = getValueBalance("70613") - getValueBalance("70614");

            if (X > 0)
                addRule(m_attributes.getAttribute("200.5.1в"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("200.5.1в"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("200.5.1в"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200_5_1_G()
        var X;

        if (m_attributes.getAttribute("200.5").getValue() > 0)
            X = getValueBalance("70613") - getValueBalance("70614");

            if (X > 0)
                addRule(m_attributes.getAttribute("200.5.1г"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("200.5.1г"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("200.5.1г"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200_5_3()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("200.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("70602");
            Y = getValueBalance("10605") + getValueBalance("70607");

            Z = X - Y - m_attributes.getAttribute("100.5.3").getScaledValue() - m_attributes.getAttribute("101.9.3").getScaledValue();

            addRule(m_attributes.getAttribute("200.5.3"), Z, RCB_RS_LESS_OR_EQUAL);
        else
            addRule(m_attributes.getAttribute("200.5.3"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200_6()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("200.6").getValue() > 0)
            X = getValueBalance("10801") + getValueBalance("70701") + getValueBalance("70702") + getValueBalance("70703") + getValueBalance("70704") +
                getValueBalance("70705") + getValueBalance("70713") + getValueBalance("70715") + getValueBalance("70801");

            Y = getValueBalance("10901") + getValueBalance("70706") + getValueBalance("70707") + getValueBalance("70708") + getValueBalance("70709") +
                getValueBalance("70710") + getValueBalance("70711") + getValueBalance("70712") + getValueBalance("70714") + getValueBalance("70716") +
                getValueBalance("70802");

            Z = X - Y - m_attributes.getAttribute("100.6").getScaledValue() - m_attributes.getAttribute("101.8").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("200.6"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("200.6"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("200.6"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200_7_1()
        var X;

        X = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
            getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
            getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
            getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
            getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");

        addRule(m_attributes.getAttribute("200.7.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_7_2()
        var X;

        X = getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") +
            getValueBalance("43107") + getValueBalance("43207") + getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607");

        addRule(m_attributes.getAttribute("200.7.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_8()
        addRule(m_attributes.getAttribute("200.8"), getValueBalance("10601"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_1()
        var X;

        X = getValueBalance("10501") + getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("201.1.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_2()
        var X;

        X = getValueBalance("47901") + getValueBalance("506") + getValueBalance("507");
        addRule(m_attributes.getAttribute("201.1.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_1_3()
        addRule(m_attributes.getAttribute("200.1.3"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_2_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") +
            getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.2.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_2_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") +
            getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.2.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_3_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.3.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_3_1_1()
        var X;

        X = getValueBalance("32109") + getValueBalance("32309") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50210") + getValueBalance("50211") +
            getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("201.3.1.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_3_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.3.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_7_2()
        var X;

        X = getValueBalanceForKind(RcbArray.initialize("474"), "А") -
            getValueBalance("47402") - getValueBalance("47408") - getValueBalance("47423") - getValueBalance("47427") +
            getValueBalanceForKind(RcbArray.initialize("603"), "А") -
            getValueBalance("60312") - getValueBalance("60314") - getValueBalance("60315") - getValueBalance("60323") - getValueBalance("60337") - getValueBalance("60339") -
            getValueBalance("60341") - getValueBalance("60343");

        addRule(m_attributes.getAttribute("201.7.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_7_3()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("47802") + getValueBalance("50106") + getValueBalance("50107") +
            getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50307") + getValueBalance("50308");

        addRule(m_attributes.getAttribute("201.7.3"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_7_5()
        var X;
        var Y;

        X = getValueBalanceForKind(RcbArray.initialize("604"), "А") + getValueBalanceForKind(RcbArray.initialize("607"), "А") - m_attributes.getAttribute("101.1").getScaledValue() +
            getValueBalance("61002") + getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61011") - getValueBalance("60601") - getValueBalance("60311") - getValueBalance("60313");

        Y = m_attributes.getAttribute("100.7").getScaledValue() + m_attributes.getAttribute("103.5").getScaledValue() + m_attributes.getAttribute("200.9").getScaledValue() -
            (m_attributes.getAttribute("200.7").getScaledValue() + m_attributes.getAttribute("200.8").getScaledValue()) - m_attributes.getAttribute("104.7").getScaledValue() -
            (m_attributes.getAttribute("201.7.1").getScaledValue() + m_attributes.getAttribute("201.7.2").getScaledValue() + m_attributes.getAttribute("201.7.3").getScaledValue()) -
            (m_attributes.getAttribute("101.8").getScaledValue() + m_attributes.getAttribute("101.9").getScaledValue()) +
            getValueBalance("10601");

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("201.7.5"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("201.7.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("201.7.5"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("201.7.5"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_202_1()
        var X;

        X = getValueBalanceForKind(RcbArray.initialize("474"), "А") -
            getValueBalance("47402") - getValueBalance("47408") - getValueBalance("47423") - getValueBalance("47427") + getValueBalanceForKind(RcbArray.initialize("603"), "А") -
            getValueBalance("60312") - getValueBalance("60314") - getValueBalance("60315") - getValueBalance("60323") - getValueBalance("60337") - getValueBalance("60339") -
            getValueBalance("60341") - getValueBalance("60343");

        addRule(m_attributes.getAttribute("202.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_202_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") +
            getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("604"), "А") + getValueBalanceForKind(RcbArray.initialize("607"), "А") +
            getValueBalanceForKind(RcbArray.initialize("607"), "А") - m_attributes.getAttribute("101.1").getScaledValue() +
            getValueBalance("60804") + getValueBalance("61002") + getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61011") + getValueBalance("61012") -
            getValueBalance("61012") - getValueBalance("60311") - getValueBalance("60313") - getValueBalance("60601") - getValueBalance("60602") - getValueBalance("60603") -
            getValueBalance("60805");

        Z = getValueBalance("50621") - getValueBalance("50620");

        if (Z > 0)
            X = X + Z;
        end;

        Z = getValueBalance("50721") - getValueBalance("50720");

        if (Z > 0)
            X = X + Z;
        end;

        Y = m_attributes.getAttribute("100.7").getScaledValue() + m_attributes.getAttribute("103.5").getScaledValue() + m_attributes.getAttribute("200.9").getScaledValue() -
            m_attributes.getAttribute("200.7").getScaledValue() - m_attributes.getAttribute("200.8").getScaledValue() - m_attributes.getAttribute("101.1").getScaledValue() -
            m_attributes.getAttribute("101.2").getScaledValue() - m_attributes.getAttribute("101.3").getScaledValue() - m_attributes.getAttribute("101.4").getScaledValue() -
            m_attributes.getAttribute("101.5").getScaledValue() - m_attributes.getAttribute("101.6").getScaledValue() - m_attributes.getAttribute("101.7").getScaledValue() -
            m_attributes.getAttribute("101.8").getScaledValue() - m_attributes.getAttribute("101.9").getScaledValue() - m_attributes.getAttribute("101.10").getScaledValue() -
            m_attributes.getAttribute("101.12").getScaledValue() - m_attributes.getAttribute("101.13").getScaledValue() - m_attributes.getAttribute("104.1").getScaledValue() -
            m_attributes.getAttribute("104.2").getScaledValue() - m_attributes.getAttribute("104.3").getScaledValue() - m_attributes.getAttribute("104.5").getScaledValue() -
            m_attributes.getAttribute("104.6").getScaledValue() - m_attributes.getAttribute("201.1").getScaledValue() - m_attributes.getAttribute("201.2").getScaledValue() -
            m_attributes.getAttribute("201.3").getScaledValue() + getValueBalance("10601");

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("202.3"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("202.3"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_000()
        addRule(m_attributes.getAttribute("000"), m_attributes.getAttribute("106").getScaledValue() +
                                                  m_attributes.getAttribute("203").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_1()
        addRule(m_attributes.getAttribute("100.1"), m_attributes.getAttribute("100.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("100.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("100.1.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_2()
        addRule(m_attributes.getAttribute("100.2"), m_attributes.getAttribute("100.2.1").getScaledValue() +
                                                    m_attributes.getAttribute("100.2.2").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_2_1()
        addRule(m_attributes.getAttribute("100.2.1"), m_attributes.getAttribute("100.2.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.2.1.2").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_5_2()
        addRule(m_attributes.getAttribute("100.5.2"), m_attributes.getAttribute("100.5.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_6_2()
        addRule(m_attributes.getAttribute("100.6.2"), m_attributes.getAttribute("100.6.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_7()
        addRule(m_attributes.getAttribute("100.7"), m_attributes.getAttribute("100.1").getScaledValue() +
                                                    m_attributes.getAttribute("100.2").getScaledValue() +
                                                    m_attributes.getAttribute("100.3").getScaledValue() +
                                                    m_attributes.getAttribute("100.4").getScaledValue() +
                                                    m_attributes.getAttribute("100.5").getScaledValue() +
                                                    m_attributes.getAttribute("100.6").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_4()
        addRule(m_attributes.getAttribute("101.4"), m_attributes.getAttribute("101.4.1").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.2").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_5()
        addRule(m_attributes.getAttribute("101.5"), m_attributes.getAttribute("101.5.1").getScaledValue() +
                                                    m_attributes.getAttribute("101.5.2").getScaledValue() +
                                                    m_attributes.getAttribute("101.5.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_8_2()
        addRule(m_attributes.getAttribute("101.8.2"), m_attributes.getAttribute("101.8.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_9_1_A()
        addRule(m_attributes.getAttribute("101.9.1а"), m_attributes.getAttribute("101.9.1в").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_9_1_G_ForLines()
        addRule(m_attributes.getAttribute("101.9.1г"), m_attributes.getAttribute("101.9.1б").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_9_2()
        addRule(m_attributes.getAttribute("101.9.2"), m_attributes.getAttribute("101.9.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_10()
        addRule(m_attributes.getAttribute("101.10"), m_attributes.getAttribute("101.10.1").getScaledValue() +
                                                     m_attributes.getAttribute("101.10.2").getScaledValue() +
                                                     m_attributes.getAttribute("101.10.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_11()
        addRule(m_attributes.getAttribute("101.11"), max(m_attributes.getAttribute("104.8").getScaledValue() + m_attributes.getAttribute("103.5").getScaledValue(), 0), RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_14()
        addRule(m_attributes.getAttribute("101.14"), m_attributes.getAttribute("101.1").getScaledValue()  +
                                                     m_attributes.getAttribute("101.2").getScaledValue()  +
                                                     m_attributes.getAttribute("101.3").getScaledValue()  +
                                                     m_attributes.getAttribute("101.4").getScaledValue()  +
                                                     m_attributes.getAttribute("101.5").getScaledValue()  +
                                                     m_attributes.getAttribute("101.6").getScaledValue()  +
                                                     m_attributes.getAttribute("101.7").getScaledValue()  +
                                                     m_attributes.getAttribute("101.8").getScaledValue()  +
                                                     m_attributes.getAttribute("101.9").getScaledValue()  +
                                                     m_attributes.getAttribute("101.10").getScaledValue() +
                                                     m_attributes.getAttribute("101.11").getScaledValue() +
                                                     m_attributes.getAttribute("101.12").getScaledValue() +
                                                     m_attributes.getAttribute("101.13").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_102()
        addRule(m_attributes.getAttribute("102"), m_attributes.getAttribute("100.7").getScaledValue()  +
                                                  m_attributes.getAttribute("101.14").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_103_1()
        addRule(m_attributes.getAttribute("103.1"), m_attributes.getAttribute("103.1.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_103_4_ForLines()
        addRule(m_attributes.getAttribute("103.4"), m_attributes.getAttribute("103.4.1").getScaledValue()  +
                                                    m_attributes.getAttribute("103.4.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_103_5()
        addRule(m_attributes.getAttribute("103.5"), m_attributes.getAttribute("103.1").getScaledValue() +
                                                    m_attributes.getAttribute("103.2").getScaledValue() +
                                                    m_attributes.getAttribute("103.3").getScaledValue() +
                                                    m_attributes.getAttribute("103.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_104_1()
        addRule(m_attributes.getAttribute("104.1"), m_attributes.getAttribute("104.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_104_3_ForLines()
        addRule(m_attributes.getAttribute("104.3"), m_attributes.getAttribute("104.3.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.3.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.1"), m_attributes.getAttribute("104.3.1.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_1_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.1.1"), m_attributes.getAttribute("103.4.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_ForLines()
        addRule(m_attributes.getAttribute("104.3.2"), m_attributes.getAttribute("104.3.2.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.2.1"), m_attributes.getAttribute("103.4.2").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_4()
        if (m_attributes.getAttribute("200.9").getScaledValue() - m_attributes.getAttribute("201.8").getScaledValue() - m_attributes.getAttribute("202.5").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("104.4"), 0, RCB_RS_EQUAL);
        else
            if (m_attributes.getAttribute("104.7.5").getScaledValue() > 0)
                addRule(m_attributes.getAttribute("104.4"), m_attributes.getAttribute("201.8").getScaledValue() -
                                                            m_attributes.getAttribute("201.7.1").getScaledValue() +
                                                            m_attributes.getAttribute("202.5").getScaledValue() -
                                                            m_attributes.getAttribute("200.9").getScaledValue(),
                        RCB_RS_EQUAL);
            elif (m_attributes.getAttribute("104.7.5").getScaledValue() == 0)
                addRule(m_attributes.getAttribute("104.4"), m_attributes.getAttribute("201.8").getScaledValue() +
                                                            m_attributes.getAttribute("202.5").getScaledValue() -
                                                            m_attributes.getAttribute("200.9").getScaledValue(),
                        RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_104_7()
        addRule(m_attributes.getAttribute("104.7"), m_attributes.getAttribute("104.7.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.7.2").getScaledValue() +
                                                    m_attributes.getAttribute("104.7.3").getScaledValue() +
                                                    m_attributes.getAttribute("104.7.4").getScaledValue() +
                                                    m_attributes.getAttribute("104.7.5").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_104_7_5()
        if (m_attributes.getAttribute("200.9").getScaledValue() - m_attributes.getAttribute("201.7.1").getScaledValue() <= 0)
            addRule(m_attributes.getAttribute("104.7.5"), m_attributes.getAttribute("201.7.1").getScaledValue() -
                                                          m_attributes.getAttribute("200.9").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("104.7.5"), 0, RCB_RS_EQUAL);

        end;
    end;

    macro addRuleFor_104_8()
        addRule(m_attributes.getAttribute("104.8"), m_attributes.getAttribute("104.4.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.2").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.3").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.4").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.5").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.6").getScaledValue() +
                                                    m_attributes.getAttribute("104.4.7").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_105()
        if (m_attributes.getAttribute("103.5").getScaledValue() - m_attributes.getAttribute("104.8").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("105"), m_attributes.getAttribute("103.5").getScaledValue() -
                                                      m_attributes.getAttribute("104.8").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("103.5"), 0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_106()
        addRule(m_attributes.getAttribute("106"), m_attributes.getAttribute("102").getScaledValue() +
                                                    m_attributes.getAttribute("105").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_1()
        addRule(m_attributes.getAttribute("200.1"), m_attributes.getAttribute("200.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("200.1.2").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_5_1_A()
        addRule(m_attributes.getAttribute("200.5.1а"), m_attributes.getAttribute("200.5.1в").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_5_1_B()
        addRule(m_attributes.getAttribute("200.5.1.б"), m_attributes.getAttribute("200.5.1г").getScaledValue(), RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_5_2()
        addRule(m_attributes.getAttribute("200.5.2"), m_attributes.getAttribute("200.5.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_6_2()
        addRule(m_attributes.getAttribute("200.6.2"), m_attributes.getAttribute("200.6.2.1").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.2.2").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.2.3").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.2.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_7()
        addRule(m_attributes.getAttribute("200.7"), m_attributes.getAttribute("200.7.1").getScaledValue() +
                                                    m_attributes.getAttribute("200.7.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_200_9()
        addRule(m_attributes.getAttribute("200.9"), m_attributes.getAttribute("200.1").getScaledValue() +
                                                    m_attributes.getAttribute("200.2").getScaledValue() +
                                                    m_attributes.getAttribute("200.3").getScaledValue() +
                                                    m_attributes.getAttribute("200.4").getScaledValue() +
                                                    m_attributes.getAttribute("200.5").getScaledValue() +
                                                    m_attributes.getAttribute("200.6").getScaledValue() +
                                                    m_attributes.getAttribute("200.7").getScaledValue() +
                                                    m_attributes.getAttribute("200.8").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201_1()
        addRule(m_attributes.getAttribute("201.1"), m_attributes.getAttribute("201.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_2()
        addRule(m_attributes.getAttribute("201.2"), m_attributes.getAttribute("201.2.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.2.2").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201_3()
        addRule(m_attributes.getAttribute("201.3"), m_attributes.getAttribute("201.3.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.3.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3_1_ForLines()
        addRule(m_attributes.getAttribute("201.3.1"), m_attributes.getAttribute("201.3.1.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3_2_ForLines()
        addRule(m_attributes.getAttribute("201.3.2"), m_attributes.getAttribute("201.3.2.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_6()
        addRule(m_attributes.getAttribute("201.6"), m_attributes.getAttribute("106").getScaledValue() +
                                                    m_attributes.getAttribute("200.9").getScaledValue() -
                                                    m_attributes.getAttribute("201.1").getScaledValue() -
                                                    m_attributes.getAttribute("201.2").getScaledValue() -
                                                    m_attributes.getAttribute("201.3").getScaledValue() -
                                                    m_attributes.getAttribute("201.4").getScaledValue() -
                                                    m_attributes.getAttribute("201.5").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201_7()
        addRule(m_attributes.getAttribute("201.7"), m_attributes.getAttribute("201.7.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.7.2").getScaledValue() +
                                                    m_attributes.getAttribute("201.7.3").getScaledValue() +
                                                    m_attributes.getAttribute("201.7.4").getScaledValue() +
                                                    m_attributes.getAttribute("201.7.5").getScaledValue() +
                                                    m_attributes.getAttribute("201.7.6").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201_8()
        addRule(m_attributes.getAttribute("201.8"), m_attributes.getAttribute("201.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.2").getScaledValue() +
                                                    m_attributes.getAttribute("201.3").getScaledValue() +
                                                    m_attributes.getAttribute("201.4").getScaledValue() +
                                                    m_attributes.getAttribute("201.5").getScaledValue() +
                                                    m_attributes.getAttribute("201.7").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_202_3_ForLines()
        addRule(m_attributes.getAttribute("202.3"), m_attributes.getAttribute("202.3.1").getScaledValue() +
                                                    m_attributes.getAttribute("202.3.2").getScaledValue() +
                                                    m_attributes.getAttribute("202.3.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_202_5()
        addRule(m_attributes.getAttribute("202.5"), m_attributes.getAttribute("202.1").getScaledValue() +
                                                    m_attributes.getAttribute("202.2").getScaledValue() +
                                                    m_attributes.getAttribute("202.3").getScaledValue() +
                                                    m_attributes.getAttribute("202.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_203()
        if (m_attributes.getAttribute("200.9").getScaledValue() - m_attributes.getAttribute("201.8").getScaledValue() - m_attributes.getAttribute("202.5").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("203"), m_attributes.getAttribute("200.9").getScaledValue() -
                                                      m_attributes.getAttribute("201.8").getScaledValue() -
                                                      m_attributes.getAttribute("202.5").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("203"), 0, RCB_RS_EQUAL);

        end;
    end;

    macro addRuleFor_103_3___200_7_1()
        var relation = ReportLinearRelation(RCB_RS_LESS_OR_EQUAL);
        var node = normalizer.addNode("103.3");
        node.exact = m_attributes.getAttribute("103.3").getValue();
        node.recalculateScaled();

        relation.lhs.plus(node);
        node.exact = m_attributes.getAttribute("200.7.1").getValue();
        node.recalculateScaled();

        relation.lhs.plus(node);
        relation.rhs.plus(double(nvl(global.parameters.getSubCredit134F() * global.parameters.getK3(), 0)));

        this.addRelation(relation);
    end;

    macro addRulesWithBalance()
        addRuleFor_100_1_1();
        addRuleFor_100_1_2();
        addRuleFor_100_1_3();
        addRuleFor_100_2_1_1();
        addRuleFor_100_2_1_2();
        addRuleFor_100_2_2();
        addRuleFor_100_3();
        addRuleFor_100_4();
        addRuleFor_100_5();
        addRuleFor_100_5_1_V();
        addRuleFor_100_5_1_G();
        addRuleFor_100_5_1_A();
        addRuleFor_100_5_1_B();
        addRuleFor_100_5_3();
        addRuleFor_100_6();
        addRuleFor_101_1();
        addRuleFor_101_2();
        addRuleFor_101_3();
        addRuleFor_101_4_1();
        addRuleFor_101_4_2();
        addRuleFor_101_4_3();
        addRuleFor_101_5_1();
        addRuleFor_101_5_2();
        addRuleFor_101_5_3();
        addRuleFor_101_6();
        addRuleFor_101_7();
        addRuleFor_101_8();
        addRuleFor_101_9();
        addRuleFor_101_9_1_V();
        addRuleFor_101_9_1_G();
        addRuleFor_101_9_3();
        addRuleFor_101_10_1();
        addRuleFor_101_10_2();
        addRuleFor_101_10_3();
        addRuleFor_103_1_1();
        addRuleFor_103_2();
        addRuleFor_103_3();
        addRuleFor_103_4();
        addRuleFor_104_1_1();
        addRuleFor_104_1_2();
        addRuleFor_104_1_3();
        addRuleFor_104_2();
        addRuleFor_104_3();
        addRuleFor_104_3_1();
        addRuleFor_104_3_1_1();
        addRuleFor_104_3_2();
        addRuleFor_104_3_2_1();
        addRuleFor_104_6();
        addRuleFor_104_7_1();
        addRuleFor_104_7_2();
        addRuleFor_104_7_3();
        addRuleFor_200_1_1();
        addRuleFor_200_1_2();
        addRuleFor_200_2();
        addRuleFor_200_3();
        addRuleFor_200_4();
        addRuleFor_200_5();
        addRuleFor_200_5_1_V();
        addRuleFor_200_5_1_G();
        addRuleFor_200_5_3();
        addRuleFor_200_6();
        addRuleFor_200_7_1();
        addRuleFor_200_7_2();
        addRuleFor_200_8();
        addRuleFor_201_1_1();
        addRuleFor_201_1_2();
        addRuleFor_201_2_1();
        addRuleFor_201_2_2();
        addRuleFor_201_3_1();
        addRuleFor_201_3_1_1();
        addRuleFor_201_3_2();
        addRuleFor_201_7_2();
        addRuleFor_201_7_3();
        addRuleFor_201_7_5();
        addRuleFor_202_1();
        addRuleFor_202_3();
    end;

    macro saveLine(line : RcbArray)

        line.moveFirst();
        while (line.moveNext())
            var node = normalizer.node(m_attributes.getAttribute(line.getCurrentItem()).getId());

            if ((m_attributes.getAttribute(line.getCurrentItem()).getValue() != null) and
                (m_attributes.getAttribute(line.getCurrentItem()).getScaledValue() != floor(Double(m_attributes.getAttribute(line.getCurrentItem()).getValue()) / rcbApplication.currentReport.multiplier + 0.5)))

                m_protocolView.printString(line.getCurrentItem(), m_attributes.getAttribute(line.getCurrentItem()).getValue(), m_attributes.getAttribute(line.getCurrentItem()).getScaledValue());
                m_attributes.getAttribute(line.getCurrentItem()).setValue(node.getExact());
                m_attributes.getAttribute(line.getCurrentItem()).setScaledValue(node.getScaled());
            end;
        end;
    end;

    macro normalizeTotalLines()
        addRuleFor_000();
        addRuleFor_100_1();
        addRuleFor_100_2();
        addRuleFor_100_2_1();
        addRuleFor_100_5_2();
        addRuleFor_100_6_2();
        addRuleFor_100_7();
        addRuleFor_101_4();
        addRuleFor_101_5();
        addRuleFor_101_8_2();
        addRuleFor_101_9_1_A();
        addRuleFor_101_9_1_G_ForLines();
        addRuleFor_101_9_2();
        addRuleFor_101_10();
        addRuleFor_101_11();
        addRuleFor_101_14();
        addRuleFor_102();
        addRuleFor_103_1();
        addRuleFor_103_4_ForLines();
        addRuleFor_103_5();
        addRuleFor_104_1();
        addRuleFor_104_3_ForLines();
        addRuleFor_104_3_1_ForLines();
        addRuleFor_104_3_1_1_ForLines();
        addRuleFor_104_3_2_ForLines();
        addRuleFor_104_3_2_1_ForLines();
        addRuleFor_104_4();
        addRuleFor_104_7();
        addRuleFor_104_7_5();
        addRuleFor_104_8();
        addRuleFor_105();
        addRuleFor_106();
        addRuleFor_200_1();
        addRuleFor_200_5_1_A();
        addRuleFor_200_5_1_B();
        addRuleFor_200_5_2();
        addRuleFor_200_6_2();
        addRuleFor_200_7();
        addRuleFor_200_9();
        addRuleFor_201_1();
        addRuleFor_201_2();
        addRuleFor_201_3();
        addRuleFor_201_3_1_ForLines();
        addRuleFor_201_3_2_ForLines();
        addRuleFor_201_6();
        addRuleFor_201_7();
        addRuleFor_201_8();
        addRuleFor_202_3_ForLines();
        addRuleFor_202_5();
        addRuleFor_203();

        normalize();
        saveLine(RcbArray().initialize("000", "100.1", "100.2", "100.2.1", "100.5.2", "100.6.2", "100.7", "101.4", "101.5", "101.8.2", "101.9.1а", "101.9.1г", "101.9.2", "101.10", "101.11",
                                       "101.14", "102", "103.1", "103.4", "103.5", "104.1", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.4", "104.7", "104.7.5", "104.8",
                                       "105", "106", "200.1", "200.5.1а", "200.5.1б", "200.5.2", "200.6.2", "200.7", "200.9", "201.1", "201.2", "201.3", "201.3.1", "201.3.2", "201.6",
                                       "201.7", "201.8", "202.3", "202.5", "203", "103.3", "200.7.1"));

    end;

    private macro logicalControl()
        m_rowsNumber.moveFirst();

        while (m_rowsNumber.moveNext())
            if (not in (m_rowsNumber.getCurrentItem(), "000", "100.5.3", "100.6.3", "101.8.3", "101.9.3", "200.5.3", "200.6.3")
                and (m_attributes.getAttribute(m_rowsNumber.getCurrentItem()).getValue() < 0))
                m_protocolView.printLogicalWarning(m_rowsNumber.getCurrentItem());
            end;
        end;
    end;

    macro execute()
        addRulesWithBalance();
        normalize();
        saveLine(RcbArray().initialize("100.1.1", "100.1.2", "100.1.3", "100.2.1.1", "100.2.1.2", "100.2.2", "100.3", "100.4", "100.5", "100.5.1в", "100.5.1г", "100.5.1а",
                                                  "100.5.1б", "100.5.3", "100.6", "101.1", "101.2", "101.3", "101.4.1", "101.4.2", "101.4.3", "101.5.1", "101.5.2", "101.5.3", "101.6",
                                                  "101.7", "101.8", "101.9", "101.9.1в", "101.9.1г", "101.9.3", "101.10.1", "101.10.2", "101.10.3", "103.1.1", "103.2", "103.3", "103.4",
                                                  "104.1.1", "104.1.2", "104.1.3", "104.2", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.6", "104.7.1", "104.7.2", "104.7.3",
                                                  "200.1.1", "200.1.2", "200.2", "200.3", "200.4", "200.5", "200.5.1в", "200.5.1г", "200.5.3", "200.6", "200.7.1", "200.7.2", "200.8", "201.1.1",
                                                  "201.1.2", "201.1.3", "201.2.1", "201.2.2", "201.3.1", "201.3.1.1", "201.3.2", "201.3.2.1", "201.7.2", "201.7.3", "201.7.5", "202.1", "202.3"));

        RcbApplication().TransactionManager().commit();

        normalizeTotalLines();

        RcbApplication().TransactionManager().commit();

        logicalControl();

    end;

    contructorTF123ReportNormalizer(protocolView);
end;

class (TF123ReportNormalizer) TF123ReportNormalizer_3714(protocolView)
    initTF123ReportNormalizer(protocolView);

   macro addRulesWithBalance()
        addRuleFor_100_1_1();
        addRuleFor_100_1_2();
        addRuleFor_100_1_3();
        addRuleFor_100_2_1_1();
        addRuleFor_100_2_1_2();
        addRuleFor_100_2_2();
        addRuleFor_100_3();
        addRuleFor_100_4();
        addRuleFor_100_5();
        addRuleFor_100_5_3();
        addRuleFor_100_6();
        addRuleFor_101_1();
        addRuleFor_101_2();
        addRuleFor_101_3();
        addRuleFor_101_4_1();
        addRuleFor_101_4_2();
        addRuleFor_101_4_3();
        addRuleFor_101_5_1();
        addRuleFor_101_5_2();
        addRuleFor_101_5_3();
        addRuleFor_101_6();
        addRuleFor_101_7();
        addRuleFor_101_8();
        addRuleFor_101_9();
        addRuleFor_101_9_3();
        addRuleFor_101_10_1();
        addRuleFor_101_10_2();
        addRuleFor_101_10_3();
        addRuleFor_103_1_1();
        addRuleFor_103_2();
        addRuleFor_103_3();
        addRuleFor_103_4();
        addRuleFor_104_1_1();
        addRuleFor_104_1_2();
        addRuleFor_104_1_3();
        addRuleFor_104_2();
        addRuleFor_104_3();
        addRuleFor_104_3_1();
        addRuleFor_104_3_1_1();
        addRuleFor_104_3_2();
        addRuleFor_104_3_2_1();
        addRuleFor_104_6();
        addRuleFor_104_7_1();
        addRuleFor_104_7_2();
        addRuleFor_104_7_3();
        addRuleFor_200_1_1();
        addRuleFor_200_1_2();
        addRuleFor_200_2();
        addRuleFor_200_3();
        addRuleFor_200_4();
        addRuleFor_200_5();
        addRuleFor_200_5_3();
        addRuleFor_200_6();
        addRuleFor_200_7_1();
        addRuleFor_200_7_2();
        addRuleFor_200_8();
        addRuleFor_201_1_1();
        addRuleFor_201_1_2();
        addRuleFor_201_2_1();
        addRuleFor_201_2_2();
        addRuleFor_201_3_1();
        addRuleFor_201_3_1_1();
        addRuleFor_201_3_2();
        addRuleFor_201_7_2();
        addRuleFor_201_7_3();
        addRuleFor_201_7_5();
        addRuleFor_202_1();
        addRuleFor_202_3();
    end;

    macro normalizeTotalLines()
        addRuleFor_000();
        addRuleFor_100_1();
        addRuleFor_100_2();
        addRuleFor_100_2_1();
        addRuleFor_100_5_2();
        addRuleFor_100_6_2();
        addRuleFor_100_7();
        addRuleFor_101_4();
        addRuleFor_101_5();
        addRuleFor_101_8_2();
        addRuleFor_101_9_2();
        addRuleFor_101_10();
        addRuleFor_101_11();
        addRuleFor_101_14();
        addRuleFor_102();
        addRuleFor_103_1();
        addRuleFor_103_4_ForLines();
        addRuleFor_103_5();
        addRuleFor_104_1();
        addRuleFor_104_3_ForLines();
        addRuleFor_104_3_1_ForLines();
        addRuleFor_104_3_1_1_ForLines();
        addRuleFor_104_3_2_ForLines();
        addRuleFor_104_3_2_1_ForLines();
        addRuleFor_104_4();
        addRuleFor_104_7();
        addRuleFor_104_7_5();
        addRuleFor_104_8();
        addRuleFor_105();
        addRuleFor_106();
        addRuleFor_200_1();
        addRuleFor_200_5_2();
        addRuleFor_200_6_2();
        addRuleFor_200_7();
        addRuleFor_200_9();
        addRuleFor_201_1();
        addRuleFor_201_2();
        addRuleFor_201_3();
        addRuleFor_201_3_1_ForLines();
        addRuleFor_201_3_2_ForLines();
        addRuleFor_201_6();
        addRuleFor_201_7();
        addRuleFor_201_8();
        addRuleFor_202_3_ForLines();
        addRuleFor_202_5();
        addRuleFor_203();

        normalize();
        saveLine(RcbArray().initialize("000", "100.1", "100.2", "100.2.1", "100.5.2", "100.6.2", "100.7", "101.4", "101.5", "101.8.2", "101.9.1а", "101.9.1г", "101.9.2", "101.10", "101.11",
                                       "101.14", "102", "103.1", "103.4", "103.5", "104.1", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.4", "104.7", "104.7.5", "104.8",
                                       "105", "106", "200.1", "200.5.1а", "200.5.1б", "200.5.2", "200.6.2", "200.7", "200.9", "201.1", "201.2", "201.3", "201.3.1", "201.3.2", "201.6",
                                       "201.7", "201.8", "202.3", "202.5", "203", "103.3", "200.7.1"));

    end;

    private macro logicalControl()
        m_rowsNumber.moveFirst();

        while (m_rowsNumber.moveNext())
            if (not in (m_rowsNumber.getCurrentItem(), "000", "100.5.1", "100.5.1.1", "100.5.1.2", "100.5.3", "100.6.1", "100.6.1.1", "100.6.1.2", "100.6.3",
                                                       "101.8.1", "101.8.1.1", "101.8.1.2", "101.8.3", "101.9.3", "200.5.1", "200.5.1.1", "200.5.1.2", "200.5.3",
                                                       "200.6.1", "200.6.1.1", "200.6.1.2", "200.6.3")
                and (m_attributes.getAttribute(m_rowsNumber.getCurrentItem()).getValue() < 0))
                m_protocolView.printLogicalWarning(m_rowsNumber.getCurrentItem());
            end;
        end;
    end;

    macro execute()
        addRulesWithBalance();
        normalize();
        saveLine(RcbArray().initialize("100.1.1", "100.1.2", "100.1.3", "100.2.1.1", "100.2.1.2", "100.2.2", "100.3", "100.4", "100.5",
                                                  "100.5.3", "100.6", "101.1", "101.2", "101.3", "101.4.1", "101.4.2", "101.4.3", "101.5.1", "101.5.2", "101.5.3", "101.6",
                                                  "101.7", "101.8", "101.9", "101.9.3", "101.10.1", "101.10.2", "101.10.3", "103.1.1", "103.2", "103.3", "103.4",
                                                  "104.1.1", "104.1.2", "104.1.3", "104.2", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.6", "104.7.1", "104.7.2", "104.7.3",
                                                  "200.1.1", "200.1.2", "200.2", "200.3", "200.4", "200.5", "200.5.3", "200.6", "200.7.1", "200.7.2", "200.8", "201.1.1",
                                                  "201.1.2", "201.1.3", "201.2.1", "201.2.2", "201.3.1", "201.3.1.1", "201.3.2", "201.3.2.1", "201.7.2", "201.7.3", "201.7.5", "202.1", "202.3"));

        RcbApplication().TransactionManager().commit();

        normalizeTotalLines();

        RcbApplication().TransactionManager().commit();

        logicalControl();

    end;
end;

/**
 * Класс нормализации данных отчета по указанию 3875-У
 *
 * @param protocolView Протокол нормализации данных
 */
class (TF123ReportNormalizer) TF123ReportNormalizer_3875(protocolView)
    initTF123ReportNormalizer(protocolView);

    /**
     * Добавить правило для нормализации итоговой строки 101.14
     */
    macro addRuleFor_101_14()
        addRule(m_attributes.getAttribute("101.14"),
                m_attributes.getAttribute("101.14.1").getScaledValue()  +
                    m_attributes.getAttribute("101.14.2").getScaledValue()  +
                    m_attributes.getAttribute("101.14.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 101.15
     */
    macro addRuleFor_101_15()
        addRule(m_attributes.getAttribute("101.15"),
                m_attributes.getAttribute("101.1").getScaledValue()  +
                    m_attributes.getAttribute("101.2").getScaledValue()  +
                    m_attributes.getAttribute("101.3").getScaledValue()  +
                    m_attributes.getAttribute("101.4").getScaledValue()  +
                    m_attributes.getAttribute("101.5").getScaledValue()  +
                    m_attributes.getAttribute("101.6").getScaledValue()  +
                    m_attributes.getAttribute("101.7").getScaledValue()  +
                    m_attributes.getAttribute("101.8").getScaledValue()  +
                    m_attributes.getAttribute("101.9").getScaledValue()  +
                    m_attributes.getAttribute("101.10").getScaledValue() +
                    m_attributes.getAttribute("101.11").getScaledValue() +
                    m_attributes.getAttribute("101.12").getScaledValue() +
                    m_attributes.getAttribute("101.13").getScaledValue() +
                    m_attributes.getAttribute("101.14").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 102
     */
    macro addRuleFor_102()
        addRule(m_attributes.getAttribute("102"),
                m_attributes.getAttribute("100.7").getScaledValue()  -
                    m_attributes.getAttribute("101.15").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 110
     */
    macro addRuleFor_101_10()
        addRule(m_attributes.getAttribute("101.10"),
                m_attributes.getAttribute("101.10.1").getScaledValue() +
                    m_attributes.getAttribute("101.10.2").getScaledValue() +
                    m_attributes.getAttribute("101.10.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 104.2
     */
    macro addRuleFor_104_2_ForLines()
        addRule(m_attributes.getAttribute("104.2"),
                m_attributes.getAttribute("104.2.1").getScaledValue() +
                    m_attributes.getAttribute("104.2.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 201.2
     */
    macro addRuleFor_201_2()
        addRule(m_attributes.getAttribute("201.2"),
                m_attributes.getAttribute("201.2.1").getScaledValue() +
                    m_attributes.getAttribute("201.2.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;



    macro addRuleFor_202_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") +
            getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("604"), "А") + getValueBalanceForKind(RcbArray.initialize("607"), "А") +
            getValueBalanceForKind(RcbArray.initialize("607"), "А") - m_attributes.getAttribute("101.1").getScaledValue() +
            getValueBalance("60804") + getValueBalance("61002") + getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61011") + getValueBalance("61012") -
            getValueBalance("61012") - getValueBalance("60311") - getValueBalance("60313") - getValueBalance("60601") - getValueBalance("60602") - getValueBalance("60603") -
            getValueBalance("60805");

        Z = getValueBalance("50621") - getValueBalance("50620");

        if (Z > 0)
            X = X + Z;
        end;

        Z = getValueBalance("50721") - getValueBalance("50720");

        if (Z > 0)
            X = X + Z;
        end;

        Y = m_attributes.getAttribute("100.7").getScaledValue() + m_attributes.getAttribute("103.5").getScaledValue() + m_attributes.getAttribute("200.9").getScaledValue() -
            m_attributes.getAttribute("200.7").getScaledValue() - m_attributes.getAttribute("200.8").getScaledValue() - m_attributes.getAttribute("101.1").getScaledValue() -
            m_attributes.getAttribute("101.2").getScaledValue() - m_attributes.getAttribute("101.3").getScaledValue() - m_attributes.getAttribute("101.4").getScaledValue() -
            m_attributes.getAttribute("101.5").getScaledValue() - m_attributes.getAttribute("101.6").getScaledValue() - m_attributes.getAttribute("101.7").getScaledValue() -
            m_attributes.getAttribute("101.8").getScaledValue() - m_attributes.getAttribute("101.9").getScaledValue() - m_attributes.getAttribute("101.10").getScaledValue() -
            m_attributes.getAttribute("101.12").getScaledValue() - m_attributes.getAttribute("101.13").getScaledValue() - m_attributes.getAttribute("101.14").getScaledValue() -
            m_attributes.getAttribute("104.1").getScaledValue() - m_attributes.getAttribute("104.2").getScaledValue() - m_attributes.getAttribute("104.3").getScaledValue() -
            m_attributes.getAttribute("104.5").getScaledValue() - m_attributes.getAttribute("104.6").getScaledValue() - m_attributes.getAttribute("201.1").getScaledValue() -
            m_attributes.getAttribute("201.2").getScaledValue() - m_attributes.getAttribute("201.3").getScaledValue() + getValueBalance("10601");

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("202.3"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("202.3"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;


    /**
     * Добавить правила для баланса
     */
   macro addRulesWithBalance()
        addRuleFor_100_1_1();
        addRuleFor_100_1_2();
        addRuleFor_100_1_3();
        addRuleFor_100_2_1_1();
        addRuleFor_100_2_1_2();
        addRuleFor_100_2_2();
        addRuleFor_100_3();
        addRuleFor_100_4();
        addRuleFor_100_5();
        addRuleFor_100_5_3();
        addRuleFor_100_6();
        addRuleFor_101_1();
        addRuleFor_101_2();
        addRuleFor_101_3();
        addRuleFor_101_4_1();
        addRuleFor_101_4_2();
        addRuleFor_101_4_3();
        addRuleFor_101_5_1();
        addRuleFor_101_5_2();
        addRuleFor_101_5_3();
        addRuleFor_101_6();
        addRuleFor_101_7();
        addRuleFor_101_8();
        addRuleFor_101_9();
        addRuleFor_101_9_3();
        addRuleFor_101_10_1();
        addRuleFor_101_10_2();
        addRuleFor_101_10_3();
        addRuleFor_103_1_1();
        addRuleFor_103_2();
        addRuleFor_103_3();
        addRuleFor_103_4();
        addRuleFor_104_1_1();
        addRuleFor_104_1_2();
        addRuleFor_104_1_3();
        addRuleFor_104_2();
        addRuleFor_104_3();
        addRuleFor_104_3_1();
        addRuleFor_104_3_1_1();
        addRuleFor_104_3_2();
        addRuleFor_104_3_2_1();
        addRuleFor_104_6();
        addRuleFor_104_7_1();
        addRuleFor_104_7_2();
        addRuleFor_104_7_3();
        addRuleFor_200_1_1();
        addRuleFor_200_1_2();
        addRuleFor_200_2();
        addRuleFor_200_3();
        addRuleFor_200_4();
        addRuleFor_200_5();
        addRuleFor_200_5_3();
        addRuleFor_200_6();
        addRuleFor_200_7_1();
        addRuleFor_200_7_2();
        addRuleFor_200_8();
        addRuleFor_201_1_1();
        addRuleFor_201_1_2();
        addRuleFor_201_2_1();
        addRuleFor_201_2_2();
        addRuleFor_201_3_1();
        addRuleFor_201_3_1_1();
        addRuleFor_201_3_2();
        addRuleFor_201_7_2();
        addRuleFor_201_7_3();
        addRuleFor_201_7_5();
        addRuleFor_202_1();
        addRuleFor_202_3();
    end;

    /**
     * Нормализация итоговых строк
     */
    macro normalizeTotalLines()
        addRuleFor_000();
        addRuleFor_100_1();
        addRuleFor_100_2();
        addRuleFor_100_2_1();
        addRuleFor_100_5_2();
        addRuleFor_100_6_2();
        addRuleFor_100_7();
        addRuleFor_101_4();
        addRuleFor_101_5();
        addRuleFor_101_8_2();
        addRuleFor_101_9_2();
        addRuleFor_101_10();
        addRuleFor_101_11();
        addRuleFor_101_14();
        addRuleFor_101_15();
        addRuleFor_102();
        addRuleFor_103_1();
        addRuleFor_103_4_ForLines();
        addRuleFor_103_5();
        addRuleFor_104_1();
        addRuleFor_104_2_ForLines();
        addRuleFor_104_3_ForLines();
        addRuleFor_104_3_1_ForLines();
        addRuleFor_104_3_1_1_ForLines();
        addRuleFor_104_3_2_ForLines();
        addRuleFor_104_3_2_1_ForLines();
        addRuleFor_104_4();
        addRuleFor_104_7();
        addRuleFor_104_7_5();
        addRuleFor_104_8();
        addRuleFor_105();
        addRuleFor_106();
        addRuleFor_200_1();
        addRuleFor_200_5_2();
        addRuleFor_200_6_2();
        addRuleFor_200_7();
        addRuleFor_200_9();
        addRuleFor_201_1();
        addRuleFor_201_2();
        addRuleFor_201_3();
        addRuleFor_201_3_1_ForLines();
        addRuleFor_201_3_2_ForLines();
        addRuleFor_201_6();
        addRuleFor_201_7();
        addRuleFor_201_8();
        addRuleFor_202_3_ForLines();
        addRuleFor_202_5();
        addRuleFor_203();

        normalize();
        saveLine(RcbArray().initialize("000", "100.1", "100.2", "100.2.1", "100.5.2", "100.6.2", "100.7", "101.4", "101.5", "101.8.2", "101.9.1а", "101.9.1г", "101.9.2", "101.10", "101.11",
                                       "101.14", "102", "103.1", "103.4", "103.5", "104.1", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.4", "104.7", "104.7.5", "104.8",
                                       "105", "106", "200.1", "200.5.1а", "200.5.1б", "200.5.2", "200.6.2", "200.7", "200.9", "201.1", "201.2", "201.3", "201.3.1", "201.3.2", "201.6",
                                       "201.7", "201.8", "202.3", "202.5", "203", "103.3", "200.7.1"));
    end;

    /**
     * Логический контроль
     */
    private macro logicalControl()
        m_rowsNumber.moveFirst();

        while (m_rowsNumber.moveNext())
            if (not in (m_rowsNumber.getCurrentItem(), "000", "100.5.1", "100.5.1.1", "100.5.1.2", "100.5.3", "100.6.1", "100.6.1.1", "100.6.1.2", "100.6.3",
                                                       "101.8.1", "101.8.1.1", "101.8.1.2", "101.8.3", "101.9.3", "200.5.1", "200.5.1.1", "200.5.1.2", "200.5.3",
                                                       "200.6.1", "200.6.1.1", "200.6.1.2", "200.6.3")
                and (m_attributes.getAttribute(m_rowsNumber.getCurrentItem()).getValue() < 0))
                m_protocolView.printLogicalWarning(m_rowsNumber.getCurrentItem());
            end;
        end;
    end;

    /**
     * Выполнение нормализации
     */
    macro execute()
        addRulesWithBalance();
        normalize();
        saveLine(RcbArray().initialize(
            "100.1.1", "100.1.2",   "100.1.3", "100.2.1.1", "100.2.1.2", "100.2.2",   "100.3",
            "100.4",   "100.5",     "100.5.3", "100.6",     "101.1",     "101.2",     "101.3",
            "101.4.1", "101.4.2",   "101.4.3", "101.5.1",   "101.5.2",   "101.5.3",   "101.6",
            "101.7",   "101.8",     "101.9",   "101.9.3",   "101.10.1",  "101.10.2",  "101.10.3",
            "103.1.1", "103.2",     "103.3",   "103.4",     "104.1.1",   "104.1.2",   "104.1.3",
            "104.2",   "104.3",     "104.3.1", "104.3.1.1", "104.3.2",   "104.3.2.1", "104.6",
            "104.7.1", "104.7.2",   "104.7.3", "200.1.1",   "200.1.2",   "200.2",     "200.3",
            "200.4",   "200.5",     "200.5.3", "200.6",     "200.7.1",   "200.7.2",   "200.8",
            "201.1.1", "201.1.2",   "201.1.3", "201.2.1",   "201.2.2",   "201.3.1",   "201.3.1.1",
            "201.3.2", "201.3.2.1", "201.7.2", "201.7.3",   "201.7.5",   "202.1",     "202.3"));

        RcbApplication().TransactionManager().commit();

        normalizeTotalLines();

        RcbApplication().TransactionManager().commit();

        logicalControl();
    end;
end;



/**
 * Класс нормализации данных отчета по указанию XXXX-У
 *
 * @param protocolView Протокол нормализации данных
 */
class (TF123ReportNormalizer) TF123ReportNormalizer_XXXX(protocolView)
    initTF123ReportNormalizer(protocolView);

        /**
     * Добавить правило для нормализации итоговой строки 101.14
     */
    macro addRuleFor_101_14()
        addRule(m_attributes.getAttribute("101.14"),
                m_attributes.getAttribute("101.14.1").getScaledValue()  +
                    m_attributes.getAttribute("101.14.2").getScaledValue()  +
                    m_attributes.getAttribute("101.14.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 101.15
     */
    macro addRuleFor_101_15()
        addRule(m_attributes.getAttribute("101.15"),
                m_attributes.getAttribute("101.1").getScaledValue()  +
                    m_attributes.getAttribute("101.2").getScaledValue()  +
                    m_attributes.getAttribute("101.3").getScaledValue()  +
                    m_attributes.getAttribute("101.4").getScaledValue()  +
                    m_attributes.getAttribute("101.5").getScaledValue()  +
                    m_attributes.getAttribute("101.6").getScaledValue()  +
                    m_attributes.getAttribute("101.7").getScaledValue()  +
                    m_attributes.getAttribute("101.8").getScaledValue()  +
                    m_attributes.getAttribute("101.9").getScaledValue()  +
                    m_attributes.getAttribute("101.10").getScaledValue() +
                    m_attributes.getAttribute("101.11").getScaledValue() +
                    m_attributes.getAttribute("101.12").getScaledValue() +
                    m_attributes.getAttribute("101.13").getScaledValue() +
                    m_attributes.getAttribute("101.14").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 102
     */
    macro addRuleFor_102()
        addRule(m_attributes.getAttribute("102"),
                m_attributes.getAttribute("100.7").getScaledValue()  -
                    m_attributes.getAttribute("101.15").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 110
     */
    macro addRuleFor_101_10()
        addRule(m_attributes.getAttribute("101.10"),
                m_attributes.getAttribute("101.10.1").getScaledValue() +
                    m_attributes.getAttribute("101.10.2").getScaledValue() +
                    m_attributes.getAttribute("101.10.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 104.2
     */
    macro addRuleFor_104_2_ForLines()
        addRule(m_attributes.getAttribute("104.2"),
                m_attributes.getAttribute("104.2.1").getScaledValue() +
                    m_attributes.getAttribute("104.2.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;


    macro addRuleFor_100_1()
        addRule(m_attributes.getAttribute("100.1"), m_attributes.getAttribute("100.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("100.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("100.1.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_100_2_1()
        addRule(m_attributes.getAttribute("100.2.1"), m_attributes.getAttribute("100.2.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.2.1.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_101_4()
        addRule(m_attributes.getAttribute("101.4"), m_attributes.getAttribute("101.4.1").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.2").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_101_5()
        addRule(m_attributes.getAttribute("101.5"), m_attributes.getAttribute("101.5.1").getScaledValue() +
                                                    m_attributes.getAttribute("101.5.2").getScaledValue() +
                                                    m_attributes.getAttribute("101.5.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;


    macro addRuleFor_104_1()
        addRule(m_attributes.getAttribute("104.1"), m_attributes.getAttribute("104.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_1_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.1.1"), m_attributes.getAttribute("103.4.1").getScaledValue(), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.2.1"), m_attributes.getAttribute("103.4.2").getScaledValue(), RCB_RS_LESS_OR_EQUAL);
    end;


    macro addRuleFor_201_2()
        addRule(m_attributes.getAttribute("201.2"),
                m_attributes.getAttribute("201.2.1").getScaledValue() +
                    m_attributes.getAttribute("201.2.2").getScaledValue(),
                RCB_RS_EQUAL);
    end;


    macro addRuleFor_202_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") +
            getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("604"), "А") + getValueBalanceForKind(RcbArray.initialize("607"), "А") +
            getValueBalanceForKind(RcbArray.initialize("607"), "А") - m_attributes.getAttribute("101.1").getScaledValue() +
            getValueBalance("60804") + getValueBalance("61002") + getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61011") + getValueBalance("61012") -
            getValueBalance("61012") - getValueBalance("60311") - getValueBalance("60313") - getValueBalance("60601") - getValueBalance("60602") - getValueBalance("60603") -
            getValueBalance("60805");

        Z = getValueBalance("50621") - getValueBalance("50620");

        if (Z > 0)
            X = X + Z;
        end;

        Z = getValueBalance("50721") - getValueBalance("50720");

        if (Z > 0)
            X = X + Z;
        end;

        Y = m_attributes.getAttribute("100.7").getScaledValue() + m_attributes.getAttribute("103.5").getScaledValue() + m_attributes.getAttribute("200.9").getScaledValue() -
            m_attributes.getAttribute("200.7").getScaledValue() - m_attributes.getAttribute("200.8").getScaledValue() - m_attributes.getAttribute("101.1").getScaledValue() -
            m_attributes.getAttribute("101.2").getScaledValue() - m_attributes.getAttribute("101.3").getScaledValue() - m_attributes.getAttribute("101.4").getScaledValue() -
            m_attributes.getAttribute("101.5").getScaledValue() - m_attributes.getAttribute("101.6").getScaledValue() - m_attributes.getAttribute("101.7").getScaledValue() -
            m_attributes.getAttribute("101.8").getScaledValue() - m_attributes.getAttribute("101.9").getScaledValue() - m_attributes.getAttribute("101.10").getScaledValue() -
            m_attributes.getAttribute("101.12").getScaledValue() - m_attributes.getAttribute("101.13").getScaledValue() - m_attributes.getAttribute("101.14").getScaledValue() -
            m_attributes.getAttribute("104.1").getScaledValue() - m_attributes.getAttribute("104.2").getScaledValue() - m_attributes.getAttribute("104.3").getScaledValue() -
            m_attributes.getAttribute("104.5").getScaledValue() - m_attributes.getAttribute("104.6").getScaledValue() - m_attributes.getAttribute("201.1").getScaledValue() -
            m_attributes.getAttribute("201.2").getScaledValue() - m_attributes.getAttribute("201.3").getScaledValue() + getValueBalance("10601");

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("202.3"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("202.3"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;


    macro addRulesWithBalance()
        addRuleFor_100_1_1();
        addRuleFor_100_1_2();
        addRuleFor_100_1_3();
        addRuleFor_100_2_1_1();
        addRuleFor_100_2_1_2();
        addRuleFor_100_2_2();
        addRuleFor_100_3();
        addRuleFor_100_4();
        addRuleFor_100_5();
        addRuleFor_100_5_3();
        addRuleFor_100_6();
        addRuleFor_101_1();
        addRuleFor_101_2();
        addRuleFor_101_3();
        addRuleFor_101_4_1();
        addRuleFor_101_4_2();
        addRuleFor_101_4_3();
        addRuleFor_101_5_1();
        addRuleFor_101_5_2();
        addRuleFor_101_5_3();
        addRuleFor_101_6();
        addRuleFor_101_7();
        addRuleFor_101_8();
        addRuleFor_101_9();
        addRuleFor_101_9_3();
        addRuleFor_101_10_1();
        addRuleFor_101_10_2();
        addRuleFor_101_10_3();
        addRuleFor_103_1_1();
        addRuleFor_103_2();
        addRuleFor_103_3();
        addRuleFor_103_4();
        addRuleFor_104_1_1();
        addRuleFor_104_1_2();
        addRuleFor_104_1_3();
        addRuleFor_104_2();
        addRuleFor_104_3();
        addRuleFor_104_3_1();
        addRuleFor_104_3_1_1();
        addRuleFor_104_3_2();
        addRuleFor_104_3_2_1();
        addRuleFor_104_6();
        addRuleFor_104_7_1();
        addRuleFor_104_7_2();
        addRuleFor_104_7_3();
        addRuleFor_200_1_1();
        addRuleFor_200_1_2();
        addRuleFor_200_2();
        addRuleFor_200_3();
        addRuleFor_200_4();
        addRuleFor_200_5();
        addRuleFor_200_5_3();
        addRuleFor_200_6();
        addRuleFor_200_7_1();
        addRuleFor_200_7_2();
        addRuleFor_200_8();
        addRuleFor_201_1_1();
        addRuleFor_201_1_2();
        addRuleFor_201_2_1();
        addRuleFor_201_2_2();
        addRuleFor_201_3_1();
        addRuleFor_201_3_1_1();
        addRuleFor_201_3_2();
        addRuleFor_201_7_2();
        addRuleFor_201_7_3();
        addRuleFor_201_7_5();
        addRuleFor_202_1();
        addRuleFor_202_3();
    end;

    macro normalizeTotalLines()
        addRuleFor_000();
        addRuleFor_100_1();
        addRuleFor_100_2();
        addRuleFor_100_2_1();
        addRuleFor_100_5_2();
        addRuleFor_100_6_2();
        addRuleFor_100_7();
        addRuleFor_101_4();
        addRuleFor_101_5();
        addRuleFor_101_8_2();
        addRuleFor_101_9_2();
        addRuleFor_101_10();
        addRuleFor_101_11();
        addRuleFor_101_14();
        addRuleFor_101_15();
        addRuleFor_102();
        addRuleFor_103_1();
        addRuleFor_103_4_ForLines();
        addRuleFor_103_5();
        addRuleFor_104_1();
        addRuleFor_104_2_ForLines();
        addRuleFor_104_3_ForLines();
        addRuleFor_104_3_1_ForLines();
        addRuleFor_104_3_1_1_ForLines();
        addRuleFor_104_3_2_ForLines();
        addRuleFor_104_3_2_1_ForLines();
        addRuleFor_104_4();
        addRuleFor_104_7();
        addRuleFor_104_7_5();
        addRuleFor_104_8();
        addRuleFor_105();
        addRuleFor_106();
        addRuleFor_200_1();
        addRuleFor_200_5_2();
        addRuleFor_200_6_2();
        addRuleFor_200_7();
        addRuleFor_200_9();
        addRuleFor_201_1();
        addRuleFor_201_2();
        addRuleFor_201_3();
        addRuleFor_201_3_1_ForLines();
        addRuleFor_201_3_2_ForLines();
        addRuleFor_201_6();
        addRuleFor_201_7();
        addRuleFor_201_8();
        addRuleFor_202_3_ForLines();
        addRuleFor_202_5();
        addRuleFor_203();

        normalize();
        saveLine(RcbArray().initialize("000", "100.1", "100.2", "100.2.1", "100.5.2", "100.6.2", "100.7", "101.4", "101.5", "101.8.2", "101.9.1а", "101.9.1г", "101.9.2", "101.10", "101.11",
                                       "101.14", "102", "103.1", "103.4", "103.5", "104.1", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.4", "104.7", "104.7.5", "104.8",
                                       "105", "106", "200.1", "200.5.1а", "200.5.1б", "200.5.2", "200.6.2", "200.7", "200.9", "201.1", "201.2", "201.3", "201.3.1", "201.3.2", "201.6",
                                       "201.7", "201.8", "202.3", "202.5", "203", "103.3", "200.7.1"));
    end;

    private macro logicalControl()
        m_rowsNumber.moveFirst();

        while (m_rowsNumber.moveNext())
            if (not in (m_rowsNumber.getCurrentItem(), "000", "100.5.1", "100.5.1.1", "100.5.1.2", "100.5.3", "100.6.1", "100.6.1.1", "100.6.1.2", "100.6.3",
                                                       "101.8.1", "101.8.1.1", "101.8.1.2", "101.8.3", "101.9.3", "200.5.1", "200.5.1.1", "200.5.1.2", "200.5.3",
                                                       "200.6.1", "200.6.1.1", "200.6.1.2", "200.6.3")
                and (m_attributes.getAttribute(m_rowsNumber.getCurrentItem()).getValue() < 0))
                m_protocolView.printLogicalWarning(m_rowsNumber.getCurrentItem());
            end;
        end;
    end;

     macro execute()
        addRulesWithBalance();
        normalize();
        saveLine(RcbArray().initialize("100.1.1", "100.1.2",   "100.1.3", "100.2.1.1", "100.2.1.2", "100.2.2",   "100.3",
            "100.4",   "100.5",     "100.5.3", "100.6",     "101.1",     "101.2",     "101.3",
            "101.4.1", "101.4.2",   "101.4.3", "101.5.1",   "101.5.2",   "101.5.3",   "101.6",
            "101.7",   "101.8",     "101.9",   "101.9.3",   "101.10.1",  "101.10.2",  "101.10.3",
            "103.1.1", "103.2",     "103.3",   "103.4",     "104.1.1",   "104.1.2",   "104.1.3",
            "104.2",   "104.3",     "104.3.1", "104.3.1.1", "104.3.2",   "104.3.2.1", "104.6",
            "104.7.1", "104.7.2",   "104.7.3", "200.1.1",   "200.1.2",   "200.2",     "200.3",
            "200.4",   "200.5",     "200.5.3", "200.6",     "200.7.1",   "200.7.2",   "200.8",
            "201.1.1", "201.1.2",   "201.1.3", "201.2.1",   "201.2.2",   "201.3.1",   "201.3.1.1",
            "201.3.2", "201.3.2.1", "201.7.2", "201.7.3",   "201.7.5",   "202.1",     "202.3"));

        RcbApplication().TransactionManager().commit();

        normalizeTotalLines();

        RcbApplication().TransactionManager().commit();

        logicalControl();

    end;
end;

class (TF123ReportNormalizer) TF123ReportNormalizer_4033(protocolView)
    initTF123ReportNormalizer(protocolView);

    macro addRuleFor_100_2()
        addRule(m_attributes.getAttribute("100.2"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_2_ForLines()
        addRule(m_attributes.getAttribute("100.2"), m_attributes.getAttribute("100.2.1").getScaledValue() +
                                                    m_attributes.getAttribute("100.2.2").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_100_2_1()
        addRule(m_attributes.getAttribute("100.2.1"), getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("10611") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") +
            getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") +
            getValueBalance("50708") + getValueBalance("50709") + getValueBalance("50718") - getValueBalance("50719") + getValueBalance("60106") +
            getValueBalance("60118") + getValueBalance("60901") + getValueBalance("60905") + getValueBalance("60906") - getValueBalance("60903");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_1_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("10611") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") +
            getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") +
            getValueBalance("50708") + getValueBalance("50709") + getValueBalance("50718") - getValueBalance("50719") + getValueBalance("60106") +
            getValueBalance("60118") + getValueBalance("60901") + getValueBalance("60905") + getValueBalance("60906") - getValueBalance("60903");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.1.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_1_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("10611") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") +
            getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") +
            getValueBalance("50708") + getValueBalance("50709") + getValueBalance("50718") - getValueBalance("50719") + getValueBalance("60106") +
            getValueBalance("60118") + getValueBalance("60901") + getValueBalance("60905") + getValueBalance("60906") - getValueBalance("60903");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.1.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_100_5()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("100.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("10619") + getValueBalance("10621") + getValueBalance("10622") + getValueBalance("70601") +
                getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") +
                getValueBalance("61304");
            Y = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("10620") + getValueBalance("10623") + getValueBalance("10625") + getValueBalance("11101") +
                getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") +
                getValueBalance("70609") + getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70612") + getValueBalance("70614") +
                getValueBalance("70616") + getValueBalance("50905") + getValueBalance("61401") + getValueBalance("61403");

            Z = X - Y - m_attributes.getAttribute("101.9").getScaledValue() - m_attributes.getAttribute("200.5").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("100.5"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.5"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_100_6()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("100.6").getValue() > 0)
            X = getValueBalance("10801") + getValueBalance("70701") + getValueBalance("70702") + getValueBalance("70703") + getValueBalance("70704") +
                getValueBalance("70705") + getValueBalance("70713") + getValueBalance("70715") + getValueBalance("70801");
            Y = getValueBalance("10901") + getValueBalance("70706") + getValueBalance("70707") + getValueBalance("70708") + getValueBalance("70709") +
                getValueBalance("70710") + getValueBalance("70711") + getValueBalance("70714") + getValueBalance("70716") + getValueBalance("70802");

            Z = X - Y - m_attributes.getAttribute("101.8").getScaledValue() - m_attributes.getAttribute("200.6").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("100.6"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("100.6"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("100.6"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_4_1()
        addRule(m_attributes.getAttribute("101.4.1"), getValueBalance("10207") + getValueBalance("10501") + getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_2()
        var X;

        X = getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("101.4.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") +
            getValueBalance("50718") - getValueBalance("50719") + getValueBalance("60118");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.4.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_4()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") - getValueBalance("50719") + getValueBalance("60106");
        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.4.4"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_4_5()
        var X;
        var Y;
        var Z;

        X = getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
        getValueBalance("10207") + getValueBalance("10501") + getValueBalance("10602") + getValueBalance("47901") + getValueBalance("50605") - getValueBalance("50608") +
        getValueBalance("50705") - getValueBalance("50709") + getValueBalance("60106") + getValueBalance("60118") + getValueBalance("60323") - getValueBalance("44115") -
        getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") - getValueBalance("44715") -
        getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") - getValueBalance("45315") -
        getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") - getValueBalance("46108") -
        getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") - getValueBalance("46708") -
        getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") - getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.4.5"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_7()
        var X;
        var Y;
        var Z;

        X = getValueBalance("10502") + getValueBalance("10602") + getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") +
            getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") +
            getValueBalance("50718") - getValueBalance("50719");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.7"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_2_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") +
            getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.2.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_2_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") +
            getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.2.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_2_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") +
            getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.2.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_1()
        addRule(m_attributes.getAttribute("200.1"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_5()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("200.5").getValue() > 0)
            X = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("10614") + getValueBalance("10619") + getValueBalance("10621") +
                getValueBalance("10622") + getValueBalance("10624") + getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") +
                getValueBalance("61304");

            Y = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("10620") + getValueBalance("10623") + getValueBalance("10625") +
                getValueBalance("11101") + getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") + getValueBalance("70609") +
                getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70614") + getValueBalance("70616") + getValueBalance("50905") +
                getValueBalance("61401") + getValueBalance("61403");

            Z = X - Y - m_attributes.getAttribute("100.5").getScaledValue() - m_attributes.getAttribute("101.9").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("200.5"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("200.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("200.5"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_8()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("101.8").getValue() > 0)
            X = getValueBalance("10901") + getValueBalance("70706") + getValueBalance("70707") + getValueBalance("70708") + getValueBalance("70709") +
                getValueBalance("70710") + getValueBalance("70711") + getValueBalance("70714") + getValueBalance("70716") +
                getValueBalance("70802");
            Y = getValueBalance("10801") + getValueBalance("70701") + getValueBalance("70702") + getValueBalance("70703") + getValueBalance("70704") +
                getValueBalance("70705") + getValueBalance("70713") + getValueBalance("70715") + getValueBalance("70801");

            Z = X - Y - m_attributes.getAttribute("100.6").getScaledValue() - m_attributes.getAttribute("200.6").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("101.8"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.8"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.8"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_9()
        var X;
        var Y;
        var Z;

        if (m_attributes.getAttribute("101.9").getValue() > 0)
            X = getValueBalance("10605") + getValueBalance("10610") + getValueBalance("10620") + getValueBalance("10623") + getValueBalance("10625") + getValueBalance("11101") +
                getValueBalance("70606") + getValueBalance("70607") + getValueBalance("70608") +
                getValueBalance("70609") + getValueBalance("70610") + getValueBalance("70611") + getValueBalance("70614") +
                getValueBalance("70616") + getValueBalance("50905") + getValueBalance("61401") + getValueBalance("61403");

            Y = getValueBalance("10603") + getValueBalance("10609") + getValueBalance("10614") + getValueBalance("10619") + getValueBalance("10621") + getValueBalance("10622") +
                getValueBalance("10624") + getValueBalance("70601") + getValueBalance("70602") + getValueBalance("70603") +
                getValueBalance("70604") + getValueBalance("70605") + getValueBalance("70613") + getValueBalance("70615") + getValueBalance("61301") + getValueBalance("61304");

            Z = X - Y - m_attributes.getAttribute("100.5").getScaledValue() - m_attributes.getAttribute("200.5").getScaledValue();

            if (Z > 0)
                addRule(m_attributes.getAttribute("101.9"), Z, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("101.9"), 0.0, RCB_RS_EQUAL);
            end;
        else
            addRule(m_attributes.getAttribute("101.9"), 0.0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_101_10_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_10_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.2"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_10_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_10_4()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50719") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") +
            getValueBalance("60204") + getValueBalance("47408") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.10.4"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_1()
        addRule(m_attributes.getAttribute("103.1"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_1()
        addRule(m_attributes.getAttribute("104.1.1"), getValueBalance("10207") + getValueBalance("10501") + getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_2()
        var X;

        X = getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("104.1.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_101_1_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50618") + getValueBalance("50718") + getValueBalance("60118");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("101.1.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_4()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
            getValueBalance("50705") + getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") - getValueBalance("50709");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("104.1.4"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_1_5()
        addRule(m_attributes.getAttribute("104.1.5"), getValueBalance("10207"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_1()
        var X;

        X = getValueBalance("32109") + getValueBalance("32309") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50210") + getValueBalance("50211") +
            getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.1.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_3()
        var X;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_3_1()
        var X;

        X = getValueBalance("32109") + getValueBalance("32309") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50210") + getValueBalance("50211") +
            getValueBalance("50310") + getValueBalance("50311");

        addRule(m_attributes.getAttribute("104.3.2.1"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_7()
        var balanceValue;

        balanceValue = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
                       getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
                       getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
                       getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
                       getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
                       getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");



        addRule(m_attributes.getAttribute("200.7"), balanceValue + getValueBalance("91314"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_7_1()
        var X;

        X = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
            getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
            getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
            getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
            getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");

        addRule(m_attributes.getAttribute("200.7.1"), X + getValueBalance("91314"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_7_2()
        var X;

        X = getValueBalance("20313") + getValueBalance("20314") + getValueBalance("31309") + getValueBalance("31409") + getValueBalance("31509") + getValueBalance("31609") +
            getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42007") + getValueBalance("42107") + getValueBalance("42207") +
            getValueBalance("42507") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") + getValueBalance("43107") + getValueBalance("43207") +
            getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607") + getValueBalance("43707") + getValueBalance("43807") +
            getValueBalance("43907") + getValueBalance("44007") + getValueBalance("52006");

        addRule(m_attributes.getAttribute("200.7.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_200_7_3()
        var X;

        X = getValueBalance("41107") + getValueBalance("41207") + getValueBalance("41307") + getValueBalance("41407") + getValueBalance("41507") + getValueBalance("41607") +
            getValueBalance("41707") + getValueBalance("41807") + getValueBalance("41907") + getValueBalance("42807") + getValueBalance("42907") + getValueBalance("43007") +
            getValueBalance("43107") + getValueBalance("43207") + getValueBalance("43307") + getValueBalance("43407") + getValueBalance("43507") + getValueBalance("43607");

        addRule(m_attributes.getAttribute("200.7.3"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_1()
        addRule(m_attributes.getAttribute("201.1.1"), getValueBalance("10207") + getValueBalance("10501") + getValueBalance("10602"), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_2()
        var X;

        X = getValueBalance("10501") + getValueBalance("60323") + getValueBalance("10207") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");

        addRule(m_attributes.getAttribute("201.1.2"), X, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50618") + getValueBalance("50718") + getValueBalance("60118");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.1.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_4()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") +
            getValueBalance("50705") + getValueBalance("50506") + getValueBalance("50507") + getValueBalance("50508") + getValueBalance("60106") - getValueBalance("50719");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.1.4"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_1_5()
        var X;
        var Y;
        var Z;

        X = getValueBalance("10207") + getValueBalance("10501") + getValueBalance("10602") + getValueBalance("47901") + getValueBalance("50605") -
            getValueBalance("50608") + getValueBalance("50705") - getValueBalance("50709") + getValueBalance("60106") + getValueBalance("60118") - getValueBalance("60323") +
            getValueBalanceForKind(RcbArray.initialize("441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460",
                                                       "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473"), "А") -
            getValueBalance("44115") - getValueBalance("44215") - getValueBalance("44315") - getValueBalance("44415") - getValueBalance("44515") - getValueBalance("44615") -
            getValueBalance("44715") - getValueBalance("44815") - getValueBalance("44915") - getValueBalance("45015") - getValueBalance("45115") - getValueBalance("45215") -
            getValueBalance("45315") - getValueBalance("45415") - getValueBalance("45515") - getValueBalance("45615") - getValueBalance("45715") - getValueBalance("46008") -
            getValueBalance("46108") - getValueBalance("46208") - getValueBalance("46308") - getValueBalance("46408") - getValueBalance("46508") - getValueBalance("46608") -
            getValueBalance("46708") - getValueBalance("46808") - getValueBalance("46908") - getValueBalance("47008") - getValueBalance("47108") - getValueBalance("47208") -
            getValueBalance("47308");


        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.1.5"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_2_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") + getValueBalance("50706") +
            getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60201") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") +
            getValueBalance("47408");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.2.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_3_1()
        var X;
        var Y;
        var Z;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.3.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_3_2()
        var X;
        var Y;
        var Z;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.3.1"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_7_5()
        var X;
        var Y;

        X = getValueBalanceForKind(RcbArray.initialize("604", "620", "621"), "А") + getValueBalanceForKind(RcbArray.initialize("607"), "А") - m_attributes.getAttribute("101.1").getScaledValue() +
            getValueBalance("61002") + getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61013") + getValueBalance("61901") + getValueBalance("61903") +
            getValueBalance("61905") + getValueBalance("61907") + getValueBalance("61911") - getValueBalance("60405") - getValueBalance("61912") - getValueBalance("62002") -
            getValueBalance("62103") - getValueBalance("60311") - getValueBalance("60313") - getValueBalance("60414") - getValueBalance("61909");

        Y = m_attributes.getAttribute("100").getScaledValue() + m_attributes.getAttribute("103").getScaledValue() + m_attributes.getAttribute("200").getScaledValue() -
            (m_attributes.getAttribute("103.3").getScaledValue() + m_attributes.getAttribute("103.4").getScaledValue() + m_attributes.getAttribute("200.7").getScaledValue() + m_attributes.getAttribute("200.8").getScaledValue()) - m_attributes.getAttribute("104.7").getScaledValue() -
            (m_attributes.getAttribute("201.7.1").getScaledValue() + m_attributes.getAttribute("201.7.2").getScaledValue() + m_attributes.getAttribute("201.7.3").getScaledValue()) -
            (m_attributes.getAttribute("101.8").getScaledValue() + m_attributes.getAttribute("101.9").getScaledValue());

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("201.7.5"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("201.7.5"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("201.7.5"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("201.7.5"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_202_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("47901") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") +
            getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") + getValueBalance("60106") + getValueBalance("60118") +
            getValueBalanceForKind(RcbArray.initialize("604"), "А") - m_attributes.getAttribute("101.1").getScaledValue() + getValueBalance("60804") + getValueBalance("61002") +
            getValueBalance("61008") + getValueBalance("61009") + getValueBalance("61013") + getValueBalanceForKind(RcbArray.initialize("619", "620", "621"), "А") - getValueBalance("50719") -
            getValueBalance("60105") - getValueBalance("61912") - getValueBalance("62002") - getValueBalance("62103") - getValueBalance("60311") - getValueBalance("60414") -
            getValueBalance("60805") - getValueBalance("61909") - getValueBalance("61910");

        Z = getValueBalance("50621") - getValueBalance("50620");

        if (Z > 0)
            X = X + Z;
        end;

        Z = getValueBalance("50721") - getValueBalance("50720");

        if (Z > 0)
            X = X + Z;
        end;

        Y = m_attributes.getAttribute("100").getScaledValue() + m_attributes.getAttribute("103").getScaledValue() + m_attributes.getAttribute("200").getScaledValue() - m_attributes.getAttribute("103.3").getScaledValue() - m_attributes.getAttribute("103.4").getScaledValue() -
            m_attributes.getAttribute("200.7").getScaledValue() - m_attributes.getAttribute("200.8").getScaledValue() - m_attributes.getAttribute("101").getScaledValue() -
            m_attributes.getAttribute("104.1").getScaledValue() - m_attributes.getAttribute("104.2").getScaledValue() - m_attributes.getAttribute("104.3").getScaledValue() -
            m_attributes.getAttribute("104.5").getScaledValue() - m_attributes.getAttribute("104.6").getScaledValue() - m_attributes.getAttribute("201.1").getScaledValue() -
            m_attributes.getAttribute("201.2").getScaledValue() - m_attributes.getAttribute("201.3").getScaledValue() + getValueBalance("10601");

        if (Y >= 0)
            if (X - Y >= 0)
                addRule(m_attributes.getAttribute("202.3"), X - Y, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        else
            if (X >= 0)
                addRule(m_attributes.getAttribute("202.3"), X, RCB_RS_LESS_OR_EQUAL);
            else
                addRule(m_attributes.getAttribute("202.3"), 0.0, RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_100()
        addRule(m_attributes.getAttribute("100"), m_attributes.getAttribute("101.1").getScaledValue() +
                                                  m_attributes.getAttribute("101.2").getScaledValue() +
                                                  m_attributes.getAttribute("101.3").getScaledValue() +
                                                  m_attributes.getAttribute("101.4").getScaledValue() +
                                                  m_attributes.getAttribute("101.5").getScaledValue() +
                                                  m_attributes.getAttribute("101.6").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_5_1()
        addRule(m_attributes.getAttribute("100.5.1"), m_attributes.getAttribute("100.5.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("100.5.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_100_6_1()
        addRule(m_attributes.getAttribute("100.6.1"), m_attributes.getAttribute("100.6.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("100.6.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101()
        addRule(m_attributes.getAttribute("101"), m_attributes.getAttribute("101.1").getScaledValue() +
                                                  m_attributes.getAttribute("101.2").getScaledValue() +
                                                  m_attributes.getAttribute("101.3").getScaledValue() +
                                                  m_attributes.getAttribute("101.4").getScaledValue() +
                                                  m_attributes.getAttribute("101.5").getScaledValue() +
                                                  m_attributes.getAttribute("101.6").getScaledValue() +
                                                  m_attributes.getAttribute("101.7").getScaledValue() +
                                                  m_attributes.getAttribute("101.8").getScaledValue() +
                                                  m_attributes.getAttribute("101.9").getScaledValue() +
                                                  m_attributes.getAttribute("101.10").getScaledValue() +
                                                  m_attributes.getAttribute("101.11").getScaledValue() +
                                                  m_attributes.getAttribute("101.12").getScaledValue() +
                                                  m_attributes.getAttribute("101.13").getScaledValue() +
                                                  m_attributes.getAttribute("101.14").getScaledValue() +
                                                  m_attributes.getAttribute("101.15").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_4()
        addRule(m_attributes.getAttribute("101.4"), m_attributes.getAttribute("101.4.1").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.2").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.3").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.4").getScaledValue() +
                                                    m_attributes.getAttribute("101.4.5").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_101_8_1()
        addRule(m_attributes.getAttribute("101.8.1"), m_attributes.getAttribute("101.8.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("101.8.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_9_1()
        addRule(m_attributes.getAttribute("101.9.1"), m_attributes.getAttribute("101.9.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("101.9.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_101_11()
        addRule(m_attributes.getAttribute("101.11"), max(m_attributes.getAttribute("104").getScaledValue() + m_attributes.getAttribute("103").getScaledValue(), 0), RCB_RS_EQUAL);
    end;

    macro addRuleFor_102()
        addRule(m_attributes.getAttribute("102"), m_attributes.getAttribute("100").getScaledValue()  -
                                                  m_attributes.getAttribute("101").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_103()
        addRule(m_attributes.getAttribute("103"), m_attributes.getAttribute("103.1").getScaledValue()  +
                                                  m_attributes.getAttribute("103.2").getScaledValue() +
                                                  m_attributes.getAttribute("103.3").getScaledValue() +
                                                  m_attributes.getAttribute("103.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_103_4_ForLines()
        addRule(m_attributes.getAttribute("103.4"), m_attributes.getAttribute("103.4.1").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104()
        addRule(m_attributes.getAttribute("104"), m_attributes.getAttribute("104.1").getScaledValue()  +
                                                  m_attributes.getAttribute("104.2").getScaledValue() +
                                                  m_attributes.getAttribute("104.3").getScaledValue() +
                                                  m_attributes.getAttribute("104.4").getScaledValue() +
                                                  m_attributes.getAttribute("104.5").getScaledValue() +
                                                  m_attributes.getAttribute("104.6").getScaledValue() +
                                                  m_attributes.getAttribute("104.7").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_104_1()
        addRule(m_attributes.getAttribute("104.1"), m_attributes.getAttribute("104.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.3").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.4").getScaledValue() +
                                                    m_attributes.getAttribute("104.1.5").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_2_ForLines()
        addRule(m_attributes.getAttribute("104.2"),
                m_attributes.getAttribute("104.2.1").getScaledValue() + m_attributes.getAttribute("104.2.2").getScaledValue() + m_attributes.getAttribute("104.2.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_ForLines()
        addRule(m_attributes.getAttribute("104.3"),
                m_attributes.getAttribute("104.3.1").getScaledValue() + m_attributes.getAttribute("104.3.2").getScaledValue() + m_attributes.getAttribute("104.3.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_ForLines()
        addRule(m_attributes.getAttribute("104.3.2"), m_attributes.getAttribute("104.3.3.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_2_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.1.1"), m_attributes.getAttribute("103.4.2").getScaledValue(), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_3_3_ForLines()
        addRule(m_attributes.getAttribute("104.3.3"), m_attributes.getAttribute("104.3.3.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_104_3_3_1_ForLines()
        addRule(m_attributes.getAttribute("104.3.3.1"), m_attributes.getAttribute("103.4.3").getScaledValue(), RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_104_4()
        if (m_attributes.getAttribute("200").getScaledValue() - m_attributes.getAttribute("201").getScaledValue() - m_attributes.getAttribute("202").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("104.4"), 0, RCB_RS_EQUAL);
        else
            if (m_attributes.getAttribute("104.7.5").getScaledValue() > 0)
                addRule(m_attributes.getAttribute("104.4"), m_attributes.getAttribute("201").getScaledValue() -
                                                            m_attributes.getAttribute("201.7.1").getScaledValue() +
                                                            m_attributes.getAttribute("202").getScaledValue() -
                                                            m_attributes.getAttribute("200").getScaledValue(),
                        RCB_RS_EQUAL);
            elif (m_attributes.getAttribute("104.7.5").getScaledValue() == 0)
                addRule(m_attributes.getAttribute("104.4"), m_attributes.getAttribute("201").getScaledValue() +
                                                            m_attributes.getAttribute("202").getScaledValue() -
                                                            m_attributes.getAttribute("200").getScaledValue(),
                        RCB_RS_EQUAL);
            end;
        end;
    end;

    macro addRuleFor_104_7_5()
        if (m_attributes.getAttribute("200").getScaledValue() - m_attributes.getAttribute("201.7.1").getScaledValue() <= 0)
            addRule(m_attributes.getAttribute("104.7.5"), m_attributes.getAttribute("201.7.1").getScaledValue() -
                                                          m_attributes.getAttribute("200").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("104.7.5"), 0, RCB_RS_EQUAL);

        end;
    end;

    macro addRuleFor_105()
        if (m_attributes.getAttribute("103").getScaledValue() - m_attributes.getAttribute("104").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("105"), m_attributes.getAttribute("103").getScaledValue() -
                                                      m_attributes.getAttribute("104").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("103.5"), 0, RCB_RS_EQUAL);
        end;
    end;

    macro addRuleFor_200()
        addRule(m_attributes.getAttribute("200"), m_attributes.getAttribute("200.1").getScaledValue() +
                                                  m_attributes.getAttribute("200.2").getScaledValue() +
                                                  m_attributes.getAttribute("200.3").getScaledValue() +
                                                  m_attributes.getAttribute("200.4").getScaledValue() +
                                                  m_attributes.getAttribute("200.5").getScaledValue() +
                                                  m_attributes.getAttribute("200.6").getScaledValue() +
                                                  m_attributes.getAttribute("200.7").getScaledValue() +
                                                  m_attributes.getAttribute("200.8").getScaledValue() +
                                                  m_attributes.getAttribute("200.9").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_5_1()
        addRule(m_attributes.getAttribute("200.5.1"), m_attributes.getAttribute("200.5.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("200.5.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_200_6_1()
        addRule(m_attributes.getAttribute("200.6.1"), m_attributes.getAttribute("200.6.1.1").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.1.2").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.1.3").getScaledValue() +
                                                      m_attributes.getAttribute("200.6.1.4").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201()
        addRule(m_attributes.getAttribute("201"), m_attributes.getAttribute("201.1").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.2").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.3").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.4").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.5").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.6").getScaledValue() +
                                                  m_attributes.getAttribute("200.1.7").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_201_1()
        addRule(m_attributes.getAttribute("201.1"), m_attributes.getAttribute("201.1.1").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.2").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.3").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.4").getScaledValue() +
                                                    m_attributes.getAttribute("201.1.5").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_2_ForLines()
        var X;
        var Y;
        var Z;

        X = getValueBalance("50605") + getValueBalance("50606") + getValueBalance("50607") + getValueBalance("50608") + getValueBalance("50618") + getValueBalance("50705") +
            getValueBalance("50706") + getValueBalance("50707") + getValueBalance("50708") + getValueBalance("50718") + getValueBalance("60201") +
            getValueBalanceForKind(RcbArray.initialize("601"), "А") + getValueBalance("60202") + getValueBalance("60203") + getValueBalance("60204") + getValueBalance("47408");


        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.1.5"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_201_2()
        addRule(m_attributes.getAttribute("201.2"),
                m_attributes.getAttribute("201.2.1").getScaledValue() + m_attributes.getAttribute("201.2.2").getScaledValue() + m_attributes.getAttribute("201.2.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3()
        addRule(m_attributes.getAttribute("201.3"), m_attributes.getAttribute("201.3.1").getScaledValue() + m_attributes.getAttribute("201.3.2").getScaledValue() + m_attributes.getAttribute("201.3.3").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3_2_ForLines()
        addRule(m_attributes.getAttribute("201.3.2"), m_attributes.getAttribute("201.3.2.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3_3_ForLines()
        addRule(m_attributes.getAttribute("201.3.3"), m_attributes.getAttribute("201.3.3.1").getScaledValue(), RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_6()
        addRule(m_attributes.getAttribute("201.6"), m_attributes.getAttribute("106").getScaledValue() +
                                                    m_attributes.getAttribute("200").getScaledValue() -
                                                    m_attributes.getAttribute("201.1").getScaledValue() -
                                                    m_attributes.getAttribute("201.2").getScaledValue() -
                                                    m_attributes.getAttribute("201.3").getScaledValue() -
                                                    m_attributes.getAttribute("201.4").getScaledValue() -
                                                    m_attributes.getAttribute("201.5").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    macro addRuleFor_203()
        if (m_attributes.getAttribute("200").getScaledValue() - m_attributes.getAttribute("201").getScaledValue() - m_attributes.getAttribute("202").getScaledValue() >= 0)
            addRule(m_attributes.getAttribute("203"), m_attributes.getAttribute("200").getScaledValue() -
                                                      m_attributes.getAttribute("201").getScaledValue() -
                                                      m_attributes.getAttribute("202").getScaledValue(),
                    RCB_RS_EQUAL);
        else
            addRule(m_attributes.getAttribute("203"), 0, RCB_RS_EQUAL);

        end;
    end;

    /**
     * Добавить правило для нормализации итоговой строки 101.14
     */
    macro addRuleFor_101_14()
        addRule(m_attributes.getAttribute("101.14"),
                m_attributes.getAttribute("101.14.1").getScaledValue()  +
                    m_attributes.getAttribute("101.14.2").getScaledValue()  +
                    m_attributes.getAttribute("101.14.3").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 101.15
     */
    macro addRuleFor_101_15()
        addRule(m_attributes.getAttribute("101.15"),
                m_attributes.getAttribute("101.1").getScaledValue()  +
                    m_attributes.getAttribute("101.2").getScaledValue()  +
                    m_attributes.getAttribute("101.3").getScaledValue()  +
                    m_attributes.getAttribute("101.4").getScaledValue()  +
                    m_attributes.getAttribute("101.5").getScaledValue()  +
                    m_attributes.getAttribute("101.6").getScaledValue()  +
                    m_attributes.getAttribute("101.7").getScaledValue()  +
                    m_attributes.getAttribute("101.8").getScaledValue()  +
                    m_attributes.getAttribute("101.9").getScaledValue()  +
                    m_attributes.getAttribute("101.10").getScaledValue() +
                    m_attributes.getAttribute("101.11").getScaledValue() +
                    m_attributes.getAttribute("101.12").getScaledValue() +
                    m_attributes.getAttribute("101.13").getScaledValue() +
                    m_attributes.getAttribute("101.14").getScaledValue(),
                RCB_RS_EQUAL);
    end;

    /**
     * Добавить правило для нормализации итоговой строки 110
     */
    macro addRuleFor_101_10()
        addRule(m_attributes.getAttribute("101.10"),
                m_attributes.getAttribute("101.10.1").getScaledValue() + m_attributes.getAttribute("101.10.2").getScaledValue() + m_attributes.getAttribute("101.10.3").getScaledValue() + m_attributes.getAttribute("101.10.4").getScaledValue(),
                RCB_RS_GREATER_OR_EQUAL);
    end;

    macro addRuleFor_201_3_3()
        var X;
        var Y;
        var Z;

        X = getValueBalance("32009") + getValueBalance("32109") + getValueBalance("32209") + getValueBalance("32309") + getValueBalance("47802") + getValueBalance("50106") +
            getValueBalance("50107") + getValueBalance("50109") + getValueBalance("50110") + getValueBalance("50207") + getValueBalance("50208") + getValueBalance("50210") +
            getValueBalance("50211") + getValueBalance("50307") + getValueBalance("50308") + getValueBalance("50310") + getValueBalance("50311");

        Y = getValueBalance("50621") - getValueBalance("50620");

        if (Y > 0)
            Z = X + Y;
        else
            Z = X;
        end;

        Y = getValueBalance("50721") - getValueBalance("50720");

        if (Y > 0)
            Z = Z + Y;
        end;

        addRule(m_attributes.getAttribute("201.3.3"), Z, RCB_RS_LESS_OR_EQUAL);
    end;

    macro addRuleFor_103_3___200_7_2()
        var relation = ReportLinearRelation(RCB_RS_LESS_OR_EQUAL);
        var node     = normalizer.addNode("103.3+200.7.2");

        node.exact = m_attributes.getAttribute("103.3").getValue() + m_attributes.getAttribute("200.7.2").getValue();
        node.recalculateScaled();
        relation.lhs.plus(node);

        relation.rhs.plus(double(nvl(int(global.parameters.getSubCredit134F()) * double(global.parameters.getK3()), 0)));

        this.addRelation(relation);
    end;

    /**
     * Добавить правила для баланса
     */
   macro addRulesWithBalance()
        addRuleFor_100_1_1();
        addRuleFor_100_1_2();
        addRuleFor_100_1_3();
        addRuleFor_100_2();
        addRuleFor_100_2_1_1();
        addRuleFor_100_2_1_2();
        addRuleFor_100_2_2();
        addRuleFor_100_3();
        addRuleFor_100_4();
        addRuleFor_100_5();
        addRuleFor_100_6();
        addRuleFor_101_1();
        addRuleFor_101_1_1();
        addRuleFor_101_1_2();
        addRuleFor_101_2();
        addRuleFor_101_3();
        addRuleFor_101_4_1();
        addRuleFor_101_4_2();
        addRuleFor_101_4_3();
        addRuleFor_101_4_4();
        addRuleFor_101_4_5();
        addRuleFor_101_5_1();
        addRuleFor_101_5_2();
        addRuleFor_101_5_3();
        addRuleFor_101_6();
        addRuleFor_101_7();
        addRuleFor_101_8();
        addRuleFor_101_9();
        addRuleFor_101_10_1();
        addRuleFor_101_10_2();
        addRuleFor_101_10_3();
        addRuleFor_101_10_4();
        addRuleFor_103_1();
        addRuleFor_103_1_1();
        addRuleFor_103_2();
        addRuleFor_103_3();
        addRuleFor_103_4();
        addRuleFor_104_1_1();
        addRuleFor_104_1_2();
        addRuleFor_104_1_3();
        addRuleFor_104_1_4();
        addRuleFor_104_1_5();
        addRuleFor_104_2_1();
        addRuleFor_104_2_2();
        addRuleFor_104_2_3();
        addRuleFor_104_3();
        addRuleFor_104_3_1();
        addRuleFor_104_3_1_1();
        addRuleFor_104_3_2();
        addRuleFor_104_3_2_1();
        addRuleFor_104_6();
        addRuleFor_104_7_1();
        addRuleFor_104_7_2();
        addRuleFor_104_7_3();
        addRuleFor_200_1();
        addRuleFor_200_1_1();
        addRuleFor_200_1_2();
        addRuleFor_200_2();
        addRuleFor_200_3();
        addRuleFor_200_4();
        addRuleFor_200_5();
        addRuleFor_200_6();
        addRuleFor_200_7_1();
        addRuleFor_200_7_2();
        addRuleFor_200_7_3();
        addRuleFor_200_8();
        addRuleFor_201_1_1();
        addRuleFor_201_1_2();
        addRuleFor_201_1_3();
        addRuleFor_201_1_4();
        addRuleFor_201_1_5();
        addRuleFor_201_2_ForLines();
        addRuleFor_201_2_1();
        addRuleFor_201_2_2();
        addRuleFor_201_2_3();
        addRuleFor_201_3_1();
        addRuleFor_201_3_2();
        addRuleFor_201_3_1_1();
        addRuleFor_201_3_3();
        addRuleFor_201_7_2();
        addRuleFor_201_7_3();
        addRuleFor_201_7_5();
        addRuleFor_202_1();
        addRuleFor_202_3();
    end;

    /**
     * Нормализация итоговых строк
     */
    macro normalizeTotalLines()
        addRuleFor_000();
        addRuleFor_100();
        addRuleFor_100_1();
        addRuleFor_100_2_ForLines();
        addRuleFor_100_2_1();
        addRuleFor_100_5_1();
        addRuleFor_100_6_1();
        addRuleFor_101();
        addRuleFor_101_4();
        addRuleFor_101_5();
        addRuleFor_101_8_1();
        addRuleFor_101_9_2();
        addRuleFor_101_10();
        addRuleFor_101_11();
        addRuleFor_101_14();
        addRuleFor_102();
        addRuleFor_103();
        addRuleFor_103_1();
        addRuleFor_103_4_ForLines();
        addRuleFor_104();
        addRuleFor_104_1();
        addRuleFor_104_2_ForLines();
        addRuleFor_104_3_ForLines();
        addRuleFor_104_3_2_ForLines();
        addRuleFor_104_3_2_1_ForLines();
        addRuleFor_104_3_3_ForLines();
        addRuleFor_104_3_3_1_ForLines();
        addRuleFor_104_4();
        addRuleFor_104_7();
        addRuleFor_104_7_5();
        addRuleFor_105();
        addRuleFor_106();
        addRuleFor_200();
        addRuleFor_200_1();
        addRuleFor_200_5_1();
        addRuleFor_200_6_1();
        addRuleFor_200_7();
        addRuleFor_201();
        addRuleFor_201_1();
        addRuleFor_201_2();
        addRuleFor_201_3();
        addRuleFor_201_3_2_ForLines();
        addRuleFor_201_3_3_ForLines();
        addRuleFor_201_6();
        addRuleFor_201_7();
        addRuleFor_202_3_ForLines();
        addRuleFor_203();

        normalize();
        saveLine(RcbArray().initialize("000", "100", "100.1", "100.2", "100.2.1", "100.5.1", "100.6.1", "101", "101.4", "101.5", "101.8.1", "101.9.1а", "101.9.1г", "101.9.2", "101.10", "101.11",
                                       "101.14", "102", "103", "103.1", "103.4", "104", "104.1", "104.2", "104.3", "104.3.1", "104.3.1.1", "104.3.2", "104.3.2.1", "104.3.3", "104.3.3.1", "104.4", "104.7", "104.7.5",
                                       "105", "106", "200", "200.1", "200.5.1а", "200.5.1б", "200.5.1", "200.6.1", "200.7", "201", "201.1", "201.2", "201.3", "201.3.2", "201.3.3", "201.6",
                                       "201.7", "202.3", "203", "103.3", "200.7.1"));
    end;

    /**
     * Логический контроль
     */
    private macro logicalControl()
        m_rowsNumber.moveFirst();

        while (m_rowsNumber.moveNext())
            if (not in (m_rowsNumber.getCurrentItem(), "000", "100.5.1", "100.5.2", "100.6.2", "101.8.2", "101.9.2", "200.5.2", "200.6.2", "Справ_3_Нереализ_ПФИ", "Справ_3_Реализ_ПФИ ")
                and (m_attributes.getAttribute(m_rowsNumber.getCurrentItem()).getValue() < 0))
                m_protocolView.printLogicalWarning(m_rowsNumber.getCurrentItem());
            end;
        end;
    end;

    /**
     * Выполнение нормализации
     */
    macro execute()
        addRulesWithBalance();
        addRuleFor_103_3___200_7_2();
        normalize();
        saveLine(RcbArray().initialize(
            "100.1.1", "100.1.2",   "100.1.3",   "100.2",     "100.2.1",   "100.2.1.1", "100.2.1.2", "100.2.2",   "100.3",
            "100.4",   "100.5",     "100.6",     "101.1",     "101.1.1",   "101.1.2",   "101.2",     "101.3",
            "101.4.1", "101.4.2",   "101.4.3",   "101.4.4",   "101.4.5",   "101.5.1",   "101.5.2",   "101.5.3",   "101.6",
            "101.7",   "101.8",     "101.9",     "101.10.1",  "101.10.2",  "101.10.3",  "101.10.4",  "103.1",
            "103.1.1", "103.2",     "103.3",     "103.4",     "104.1.1",   "104.1.2",   "104.1.3"    "104.1.4",   "104.1.5",
            "104.2.1", "104.2.2",   "104.2.3",   "104.3",     "104.3.1",   "104.3.1.1", "104.3.3",   "104.3.3.1", "104.6",
            "104.7.1", "104.7.2",   "104.7.3",   "200.1",     "200.1.1",   "200.1.2",   "200.2",     "200.3",     "200.4",
            "200.5",     "200.6",   "200.7",     "200.7.1",   "200.7.2",   "200.7.3",   "200.8",     "201.1.1",   "201.1.2",
            "201.1.3", "201.1.4",   "201.1.5",   "201.2",     "201.2.1",   "201.2.2",   "201.2.3",   "201.3.1",   "201.3.1.1",
            "201.3.2", "201.3.2.1", "201.3.3.3", "201.3.3.1", "201.7.2",   "201.7.3",   "201.7.5",   "202.1",     "202.3"));

        RcbApplication().TransactionManager().commit();

        normalizeTotalLines();

        RcbApplication().TransactionManager().commit();

        logicalControl();
    end;
end;