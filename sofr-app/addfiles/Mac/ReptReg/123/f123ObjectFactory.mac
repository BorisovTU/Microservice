/*
$Name:          f123ObjectFactory.mac
$Module:        Регламентируемая отчетность
$Description:   Форма 123. Фабрика объектов
*/

/**
 * @since   18.09.2014
 * @author  Kirin Pavel
 * @version 6.00.020.31
 */

class (RcbObjectFactoryBase) TF123ObjectFactory()
    initRcbObjectFactoryBase();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report", report, isLazy);
    end;

    macro createPreviousReport() : RcbReportBase
        return genObject("TF123PreviousReport");
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("TF123Part", partId, compositeValue);
    end;

    macro createAttribute(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF123Attribute", id, part, compositeValue);
    end;

    macro createAttributeListCurrency(id : String, part : RcbPartBase, compositeValue : Object) : RcbAttributeBase
        return genObject("TF123AttributeListCurrency", id, part, compositeValue);
    end;

    macro createNormalizationController()
        return genObject("TF123NormalizationController");
    end;

    macro createBalanceAttribute()
        return genObject("TBalanceAttribute", "БАЛАНС", RcbApplication.currentReport.createBalanceReport(false, RCB_CBR_IS_EARLIEST_BEGINNING_DATE));
        // return genObject("TBalanceAttribute", "БАЛАНС", RcbApplication.currentReport.createBalanceReport());
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController");
    end;

    macro createCalculateProtocolView(protocolName : String) : RcbCalculateProtocolView
        return genObject("TF123CalculateProtocolView", protocolName);
    end;

    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF123DataSources", protocolView);
    end;

    macro createDataSourceFilters() : RcbDataSourceFilters
        return genObject("TF123DataSourceFilters");
    end;

    macro createParameters() : TF123Parameters
        return genObject("TF123Parameters");
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF123TuneTable");
    end;

    macro createReportView() : RcbReportView
        return genObject("TF123ReportView");
    end;

    macro createControlCalculatedData()
        return genObject("TF123ControlCalculatedData");
    end;

    macro createPrintProtocolView(protocolName : String)
        return genObject("TF123PrintProtocolView", protocolName);
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController");
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF123KlikoExportController");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF123PtkPsdExportController");
    end;

    macro createNormalizationProtocolView()
        return genObject("TF123NormalizationProtocolView");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("TF123ReportNormalizer", protocolView);
    end;

    macro createCapitalData(report : RcbReport)
        return genObject("TF123CapitalData", report);
    end;
end;

class (TF123ObjectFactory) TF123ObjectFactory_3377()
    initTF123ObjectFactory();

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_3377");
    end;
end;

class (TF123ObjectFactory_3377) TF123ObjectFactory_3643()
    initTF123ObjectFactory();

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_3643");
    end;
end;


class (TF123ObjectFactory_3643) TF123ObjectFactory_3714()
    initTF123ObjectFactory();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_3714", report, isLazy);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_3714");
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController_3714");
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF123KlikoExportController_3714");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF123PtkPsdExportController_3714");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("TF123ReportNormalizer_3714", protocolView);
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF123TuneTable3714");
    end;
end;

class (TF123ObjectFactory_3714) TF123ObjectFactory_3875()
    initTF123ObjectFactory();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_3875", report, isLazy);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_3875");
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController_3875");
    end;

    macro createKlikoExportController() : RcbKlikoExportController
        return genObject("TF123KlikoExportController_3875");
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF123PtkPsdExportController_3875");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("TF123ReportNormalizer_3875", protocolView);
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF123TuneTable3875");
    end;

    /**
     * Создать источник данных
     *
     * @param protocolView Файл протокола расчета
     *
     * @return RcbDataSources Объект источника данных
     */
    macro createDataSources(protocolView : RcbCalculateProtocolView) : RcbDataSources
        return genObject("TF123DataSources_3875", protocolView);
    end;
end;

class (TF123ObjectFactory_3875) TObjectFactory4033()
    initTF123ObjectFactory();

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController_4033");
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_4033");
    end;

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_4033", report, isLazy);
    end;

    macro createKlikoExportController(isMonth : bool) : RcbKlikoExportController
        return genObject("TF123KlikoExportController_4033", isMonth);
    end;

    macro createPtkPsdExportController() : RcbKlikoExportController
        return genObject("TF123PtkPsdExportController_4033");
    end;

    macro createReportNormalizer(protocolView : Object)
        return genObject("TF123ReportNormalizer_4033", protocolView);
    end;

    macro createTuneTable() : RcbTuneTable
        return genObject("TF123TuneTable4033");
    end;
end;

class (TObjectFactory4033) TObjectFactory4098()
    initTObjectFactory4033();

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_4098");
    end;
end;

class (TObjectFactory4098) TObjectFactory41_1_1_4_330()
    initTObjectFactory4098();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_41_1_1_4_330", report, isLazy);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_41_1_1_4_330");
    end;
end;

class (TObjectFactory41_1_1_4_330) TObjectFactory_4212()
    initTObjectFactory41_1_1_4_330();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_4212", report, isLazy);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_4212");
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController_4212");
    end;
end;

class (TObjectFactory_4212) TObjectFactory_4637()
    initTObjectFactory_4212();

    macro createReport(report : RcbReport, isLazy : Bool) : RcbReportBase
        return genObject("TF123Report_4637", report, isLazy);
    end;

    macro createPart(partId : String, compositeValue : Object) : RcbPartBase
        return genObject("TF123Part_4637", partId, compositeValue);
    end;

    macro createReportCalculateController() : RcbReportCalculateController
        return genObject("TF123ReportCalculateController_4637");
    end;

    macro createReportPrintController() : RcbReportPrintController
        return genObject("TF123ReportPrintController_4637");
    end;
end;

if (objectFactoryInstance == null)
    if   (rcbApplication.currentReport.context.period.endDate >= RCB_I4637_DATE)
        objectFactoryInstance = TObjectFactory_4637();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4212_DATE)
        objectFactoryInstance = TObjectFactory_4212();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_41_1_1_4_330_DATE)
        objectFactoryInstance = TObjectFactory41_1_1_4_330();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4098_DATE)
        objectFactoryInstance = TObjectFactory4098();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I4033_DATE)
        objectFactoryInstance = TObjectFactory4033();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3875_DATE2)
        objectFactoryInstance = TF123ObjectFactory_3875();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3714_DATE)
        objectFactoryInstance = TF123ObjectFactory_3714();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3643_DATE2)
        objectFactoryInstance = TF123ObjectFactory_3643();
    elif (rcbApplication.currentReport.context.period.endDate >= RCB_I3377_DATE)
        objectFactoryInstance = TF123ObjectFactory_3377();
    else
        objectFactoryInstance = TF123ObjectFactory();
    end;
end;
