import CommonInter, RSD;

macro ShowDocument( docID )
    
    var cmd = RsdCommand(
      "select d.T_DEBITCURRCODE as debitcurrcode, d.T_CREDITCURRCODE as creditcurrcode FROM dpmdtype_dbt pt, drtdocument_dbt d "+
      "where pt.t_DocTypeId = d.t_DocTypeId AND d.t_documentid = ?" );

    cmd.addParam("documentid", RSDBP_IN, docID);
    cmd.execute();
    
    var rs = RsdRecordset(cmd);
    rs.MoveNext();
    
    var docType:string;
    if ( rs.value("debitcurrcode") == rs.value("creditcurrcode") )
        if ( ( rs.value("debitcurrcode") == 0 ) or ( rs.value("debitcurrcode") == 810 ) )
            docType = "Платеж банка"
        else
            docType = "Валютный платеж банка"
        end
    else
        docType = "Валютный платеж банка"
    end;

    ShowDocument_Payment( docID, docType );
end;