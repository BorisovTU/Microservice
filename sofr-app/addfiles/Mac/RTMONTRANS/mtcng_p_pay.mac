import Globals, ContactNGReport;

private const useTemplate = false;

private class (TxtContactNGReport) TxtContactNGPaymentReport(transferRec)
  InitTxtContactNGReport(transferRec);

  macro show()
    var dd, mm, yyyy;
    DateSplit( transferRec_.sendDate, dd, mm, yyyy );

    [Платежная система _Contact_NG_________________________________________
                         (название платежной системы)
  
  
                             ЗАЯВЛЕНИЕ НА ПОЛУЧЕНИЕ ДЕНЕЖНОГО ПЕРЕВОДА № _#________________
  
     		Я, _#_______________________________________________________________________________________________________
                                            (Фамилия, Имя, Отчество Получателя)
     _#_____________________________________________________________________________________________________________________
                                   (документ, удостоверяющий личность (серия, номер, кем и когда выдан)
     Адрес получателя: _#___________________________________________________________________________________________________
     Прошу _#___________________________________________________________________________
              (наименование Банка Получателя)
     Выдать мне сумму в размере _#______________________ _#______
                                      (сумма цифрами)      (валюта)
     _#_____________________________________________________________________________________________________________________
         (сумма прописью)
     Подтверждаю, что данный Денежный перевод не связан с осуществлением предпринимательской и инвестиционной деятельности 
     или приобретением прав на недвижимое имущество, а является частным Денежным переводом на текущие расходы.
  
     "_##_"______##______________#_____ г.
       (дата составления заявления)
  
     _______________________________________                        ________________________________________________________
         (печать, подпись операциониста)                                           (подпись Получателя)]
     ( format(transferRec_.transCode),
       format(concat(concat(reciever_.lastName(), reciever_.FirstName(), " "), reciever_.SecondName(), " ")),
       format(reciever_.paper()), format(reciever_.address()), format(reciever_.point().name()),
       transferRec_.sum:0:2:a:l, sumCurrency(), sumInWords(transferRec_.sum),
       dd:o, mm:o, yyyy );
  end;
end;

private class (TemplateContactNGReport) TemplateContactNGPaymentReport(transferRec)
  InitTemplateContactNGReport(transferRec);
  
  macro show()
    factory_.registerForm("Contact_NG", "Contact_NG_payment.dot", "Contact_NG_payment.doc.doc",
                          "transCode", "currDate",
                          "recName1", "recName2", "recName3", "recBirthDay",
                          "recPaper", "recAdress", "recPhoneNumber", "recPointName",
                          "senderName1", "senderName2", "senderName3",
                          "sum", "CurName", "sumProp",
			  "recAddInfo",
                          "transCode", "currDate",
                          "recName1", "recName2", "recName3", "recBirthDay",
                          "recPaper", "recAdress", "recPhoneNumber", "recPointName",
                          "senderName1", "senderName2", "senderName3",
                          "sum", "CurName", "sumProp",
			  "recAddInfo");
 
    factory_.addDoc("Contact_NG",
                     transferRec_.transCode, string(transferRec_.sendDate),
                     reciever_.LastName(), reciever_.FirstName(), reciever_.SecondName(), string(reciever_.birthDay()),
		     reciever_.paper(), reciever_.address(), reciever_.phone(), reciever_.point().name(),
                     sender_.LastName(), sender_.FirstName(), sender_.SecondName(),
                     string(transferRec_.sum:0:2), sumCurrency(), sumInWords(transferRec_.sum),
		     recAddInfo(),
                     transferRec_.transCode, string(transferRec_.sendDate),
                     reciever_.LastName(), reciever_.FirstName(), reciever_.SecondName(), string(reciever_.birthDay()),
		     reciever_.paper(), reciever_.address(), reciever_.phone(), reciever_.point().name(),
                     sender_.LastName(), sender_.FirstName(), sender_.SecondName(),
                     string(transferRec_.sum:0:2), sumCurrency(), sumInWords(transferRec_.sum),
		     recAddInfo());
    show();
  end;
end;


private macro main()
  var transfer = getCurrentTransfer();
  if (ValType(transfer) != V_GENOBJ ) return ; end;
  
  var report = null;
  if(useTemplate) report = TemplateContactNGPaymentReport();
  else            report = TxtContactNGPaymentReport();
  end;
  
  report.setTransfer(transfer.rec);
  report.show();
end;

main();

