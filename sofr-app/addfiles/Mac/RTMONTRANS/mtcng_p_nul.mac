import Globals, ContactNGReport;

private const useTemplate = false;

private class (TxtContactNGReport) TxtContactNGNullReport(transferRec)
  InitTxtContactNGReport(transferRec);

  macro show()
    [Платежная система _CONTACT_NG________________________________
                         (название платежной системы)


                                    ЗАЯВЛЕНИЕ НА АННУЛИРОВАНИЕ ДЕНЕЖНОГО ПЕРЕВОДА

     Я, _#__________________________________________________________________________________________________________________
                                            (Фамилия, Имя, Отчество Отправителя)
     _#_____________________________________________________________________________________________________________________
                                   (документ, удостоверяющий личность (серия, номер, кем и когда выдан)
     _#_____________________________________________________________________________________________________________________
                                                (адрес отправителя)
     отправил денежный перевод со следующими реквизитами:
     	Номер перевода _#_______________________________________________
     	Дата отправления перевода _#____________________________________
     	Сумма и валюта перевода _#_____________________________ _#______
     	Ф.И.О. Получателя _#____________________________________________
     	Банк Получателя _#______________________________________________
     Прошу аннулировать денежный перевод и вернуть денежные средства

     _#_________________________                                    ________________________________________________________
              (дата)                                                             (подпись Отправителя)


     ОТМЕТКИ БАНКА
     +-----------------------------------------------------------+-----------------------------------------------------------+
     |             Заявление принято и проверено                 |     Подтверждение об аннулировании денежного перевода     |
     |                                                           |     получено "_______" ______________________ 200___ г.   |
     |                                                           |                                                           |
     |                                                           |     Номер перевода _____________________________          |
     |                                                           |                                                           |
     |                                                           |                                                           |
     |  _______________________________________________________  |  _______________________________________________________  |
     |         (печать, подпись сотрудника Банка)                |              (печать, подпись сотрудника Банка)           |
     +-----------------------------------------------------------+-----------------------------------------------------------+]
     ( format(concat(concat(sender_.LastName(), sender_.FirstName(), " "), sender_.SecondName(), " ")),
       format(sender_.paper()), format(sender_.address()), 
       transferRec_.transCode, string( transferRec_.sendDate:f ), 
       string(transferRec_.sum:0:2:a), sumCurrency(),
       format(concat(concat(reciever_.lastName(), reciever_.FirstName(), " "), reciever_.SecondName(), " ")),
       format(reciever_.point().name()),
       String( {curdate}:f ) );
  end;
end;

private class (TemplateContactNGReport) TemplateContactNGNullReport(transferRec)
  InitTemplateContactNGReport(transferRec);

  macro show()
    factory_.registerForm("Contact_NG", "Contact_NG_null.dot", "Contact_NG_null.doc",
                          "senderBankName",
			  "senderName2", "senderName1",
			  "senderName1", "senderName2", "senderName3", "senderPaper", "senderPointCode",
			  "transCode", "sendDate",
			  "sum", "curCode", "sumProp", "CurName",
			  "currDate");
 
    factory_.addDoc("Contact_NG",
                     sender_.point().name(),
		     sender_.firstName(), sender_.lastName(),
		     sender_.lastName(), sender_.firstName(), sender_.secondName(), sender_.paper(), sender_.point().name(),
		     transferRec_.transCode, string(transferRec_.sendDate),
		     transferRec_.sum, sumCurrency(), sumInWords(transferRec_.sum), TCurrency(transferRec_.curCode).fullName(),
		     string({curdate}));
    show();
  end;
end;

private macro main()
  var transfer = getCurrentTransfer;
  if (ValType(transfer) != V_GENOBJ ) return ; end;
  
  var report = null;
  if(useTemplate) report = TemplateContactNGNullReport();
  else            report = TxtContactNGNullReport();
  end;
  
  report.setTransfer(transfer.rec);
  report.show();
end;

main();
