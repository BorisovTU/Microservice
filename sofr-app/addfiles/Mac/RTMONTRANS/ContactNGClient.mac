import MonTransInter, CommonInter, ContactNGAddress, stringUtils;

class TClient(transferRec)
  private var transferRec_ = transferRec;
  private var place = null;
  macro firstName()
  end;
  macro secondName()
  end;
  macro lastName()
  end;
  macro paper()
  end;
  macro address()
  end;
  macro phone()
  end;
  macro point()
    return place;
  end;
  macro birthDay()
  end;
end;

class (TClient) TSender(transferRec)
  macro firstName()
    return transferRec_.senderName2;
  end;

  macro secondName()
    return transferRec_.senderName3;
  end;

  macro lastName()
    return transferRec_.senderName1;
  end;

  macro paper()
    if (transferRec_.senderPaperNumber == "")
      return "";
    end;
    var senderPaper = "";
    senderPaper = GetNameOfPAPRKIND(transferRec_.senderPaperKind);
    senderPaper = concat(senderPaper, transferRec_.senderPaperSeries, " ");
    senderPaper = concat(senderPaper, transferRec_.senderPaperNumber, " ü ");
    senderPaper = concat(senderPaper, transferRec_.senderPaperIssuer, ", ¢ë¤ ­ ");
    senderPaper = concat(senderPaper, string(transferRec_.senderPaperIssuedDate:f));
    return senderPaper;
  end;
  macro address()
    return transferRec_.senderAdress;
  end;
  macro phone()
    return transferRec_.senderPhoneNumber;
  end;
  
  macro point()
    return ContactPoint(transferRec_.sendPointCode);
  end;

  macro BirthDay()
    return transferRec_.senderBorn;
  end;
  
  macro citizenship()
    var countryCode = trim(transferRec_.senderCitizenship);
    if ( countryCode == "" ) return ""; end;
    var cmd = RsdCommand( "select t_Name as name from DCOUNTRY_DBT "
                          "where t_CodeCyr3 = '" + countryCode + "' or "
                          "t_CodeLat2 = '" + countryCode + "' or "  
                          "t_CodeLat3 = '" + countryCode + "' or "  
                          "t_CodeNum3 = '" + countryCode + "'");
    var rs = RsdRecordSet(cmd);
    if(rs.movenext()) 
      return rs.value("name");
    end;
  
    return ""; 
  end;

  macro isResident()
    return transferRec_.senderNotResident == 0;
  end;
  
  InitTClient(transferRec);
end;

class (TClient) TReciever(transferRec)
  macro firstName()
    return transferRec_.recName2;
  end;

  macro secondName()
    return transferRec_.recName3;
  end;

  macro lastName()
    return transferRec_.recName1;
  end;
  
  macro paper()
    if (transferRec_.recPaperNumber == "")
      return "";
    end;
    var recPaper = "";
    recPaper = GetNameOfPAPRKIND(transferRec_.recPaperKind);
    recPaper = concat(recPaper, transferRec_.recPaperSeries, " ");
    recPaper = concat(recPaper, transferRec_.recPaperNumber, " ü ");
    recPaper = concat(recPaper, transferRec_.recPaperIssuer, ", ¢ë¤ ­ ");
    recPaper = concat(recPaper, string(transferRec_.recPaperIssuedDate:f));
    return recPaper;
  end;
  macro address()
    return transferRec_.recAdress;
  end;
  macro phone()
    return transferRec_.recPhoneNumber;
  end;

  macro point()
    return ContactPoint(transferRec_.receivePointCode);
  end;
  
  macro birthDay()
    return transferRec_.recBorn;
  end;
  
  InitTClient(transferRec);
end;
