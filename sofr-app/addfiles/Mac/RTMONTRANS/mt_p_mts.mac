import DeprIntr, globals, MonTransInter, rsd, sqlconv, mtcnt_opsend01;

private var transferReport = getCurrentTransfer();

/////////////////////////////////////////
// Получить SortName валюты 
/////////////////////////////////////////
private MACRO currNameForCode(curCode)
   var ds = TRsbDataSet("SELECT t_short_name FROM dcurrency_dbt WHERE t_code_currency = " + curCode);
   if (not ds.moveNext())
      RunError("Ошибка получения короткого имени валюты с кодом '" + curCode + "'.");
   end;
   return ds.Short_Name;
END;


/////////////////////////////////////////////// 
// Печать чека на пополнение лицевого счета МТС
/////////////////////////////////////////////// 
MACRO printChek(chekNum, 
                   chekDate, 
                   chekTime, 
                   chekSum, 
                   currCode, 
                   operName, 
                   phone,
                   account,
                   espp)
[┌──────────────────────────────────────────────┐
 │ Перевод по системе "Contact"                 │];
[│ Чек № #############                          │] (chekNum);
[│                                              │];
[│ ##############################               │] (getBankName());
[│                                              │];
[│ Дата:  #####################                 │] (chekDate);
[│ Время: ########                              │] (chekTime);
[│ Сумма: ########  ###########                 │] (chekSum, currNameForCode(currCode));
[│                                              │];
[│ #############################                │] (operName);
[│ Номер телефона: #############                │] (phone);
[│ Лицевой счет:   #############                │] (account);
[│ Код ЕСПП:       #############                │] (espp);
[│                                              │];
[│                                              │];
[│ СПАСИБО                                      │];
[└──────────────────────────────────────────────┘];

END;

printChek(transferReport.rec.addField01, 
          transferReport.rec.sendDate, 
          payTime, 
          transferReport.rec.sum, 
          transferReport.rec.curCode, 
          transferReport.rec.addField03, 
          transferReport.rec.recAddInfo,
          transferReport.rec.addField04,
          transferReport.rec.addField05);

