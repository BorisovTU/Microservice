/*
$Name: it_file_save.mac 
$Module: Главная книга
$Description: Служебная утилита: Сохранение в файл на диск данных из поля CLOB_FILE таблицы ITT_FILE 
*/
var ID_FILE = 3781638;  // Укажите значение ID_FILE из таблицы ITT_FILE и запустите на выполнение.
//////////////////////////////////////////////////////////////////////
import it_utils;
var file_Name ;
var FileDir = IT_GetPatchTxtFile(false)+"\\";
var Dt = TRsbDataSet("select file_name, file_code from itt_file where id_file = "+String(id_file));
if (Dt.movenext())
   if (StrLen(Dt.File_Name) > 0)
     file_Name =  (FileDir+Dt.File_Name);
   elif  (StrLen(Dt.file_code) > 0)
     file_Name =  (FileDir+Dt.file_code+"_"+String(id_file));
   else
     file_Name =  (FileDir+"ID_FILE_"+String(id_file));
   end;
   BegAction(100,("Выгрузка ID_FILE ="+String(id_file)+" в "+file_Name));
   IT_StoreClobDataANSI("file_clob",("itt_file where id_file = "+String(id_file)),file_Name,"FILE");
   EndAction(0);
  MsgBox("Данные ID_FILE ="+String(id_file)+" выгружены в "+ file_Name);
else
  MsgBox("Данные в таблице itt_file для ID_FILE="+id_file+" не найдены !");
end;
Dt = null;
Exit(1);
