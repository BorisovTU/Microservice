/* mac название клиента
 ********************************************************************
                         Торговый дом v3.0
              Copyright (c) R-Style Software Lab Ltd. 1996
                                                  Данилкин Д.П. (DDP)
  название клиента
 ********************************************************************
*/
import "adress.mac";

   file party_clientba    ("party.dbt",    "bank.def")   KEY 0; /* PartyID */
   file partcode_clientba ("partcode.dbt", "bank.def")   KEY 0; /* PartyID + CodeKind */

   record ClientAdress (adress);


/* ------------------------------------------------------------------------ */
/* Возвращает : Название клиента */
/* ------------------------------------------------------------------------ */
macro GetClientName(ClientDprt, ClientNumb)

  var szNameClient = "";

  party_clientba.PartyID = ClientNumb;

  if (getEQ(party_clientba) == TRUE)
    szNameClient = party_clientba.Name;
  end;

  return szNameClient;

end;


/* ------------------------------------------------------------------------ */
/* Сокращенное название клиента */
/* ------------------------------------------------------------------------ */
MACRO GetClientShortName(ClientDprt, ClientNumb)
   party_clientba.PartyID = ClientNumb;
   if( getEQ(party_clientba) )
         return  party_clientba.ShortName;
   else  return  "";
   end;
END;


/* ------------------------------------------------------------------------ */
/* Возвращает : Название типа клиента */
/* ------------------------------------------------------------------------ */
macro GetClientTypeName( iCode )
  return "";
end;


/* ------------------------------------------------------------------------ */
/* Возвращает : Тип клиента */
/* ------------------------------------------------------------------------ */
macro GetClientType(ClientDprt, ClientNumb)
  return 0;
end;


/* ------------------------------------------------------------------------ */
/* Код клиента */
/* ------------------------------------------------------------------------ */
MACRO GetClientCod(ClientDprt, ClientNumb)
  partcode_clientba.PartyID  = ClientNumb;
  partcode_clientba.CodeKind = 1;           /* Контрагенты */
  if( getEQ(partcode_clientba) )       
        return  partcode_clientba.Code;
  else  return  "";
  end;
END;


/* ------------------------------------------------------------------------ */
/* Адресс клиента */
/* ------------------------------------------------------------------------ */
MACRO GetClientAddress(ClientDprt, ClientNumb)
   if( НайтиЮридическийАдресСубъекта(ClientNumb,ClientAdress) )       
         return  ClientAdress.Adress;
   else  return  "";
   end;
END;
