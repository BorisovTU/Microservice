/*                                                                */
/* Товары поставщиков.                                            */
/*                                                                */
/* R_WARE.MAC                                                     */
/*                                                                */
/* 30.12.97 А.Лебедев                                             */
/*                                                                */

/* Внешние переменные
   ~~~~~~~~~~~~~~~~~~ */

/*IMPORT l_const;*/


/* Глобальные переменные
   ~~~~~~~~~~~~~~~~~~~~~ */

/*тип каталога*/
var fTypeLWare = 0;  /* 0 - автоопределение,
                        1 - обычный, 2 - с штрих кодом, 3 - с кодом поставщика,
                        4 - альтернативный */
/*каталог МБП*/
var fLVM = -1;       /* -1 - автоопределение,
                         0 - нет, 1 - да */

/*при печати каталога МБП пропускать обычные товары*/
var fHideNonLVM = 0; /* 0 - нет, 1 - да */

/*печатать состав комплекта*/
var fCompl = 1;      /* 0 - нет, 1 - да */

/*сортировка*/
var fSort;           /* 0 - по коду, 1 - по наименованию */

/*размер кода товара*/
var fWidthWare;      /* 10, 16 */

/* Файлы
   ~~~~~ */
/*текущие цены*/
/*file wareprc ("wareprc.dbt")  KEY  2;  Ware, Clnt, KodPrice, Currency */


/* Функции получения наименований из кодификаторов

   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*наименование прайс-листа*/
macro GetName_PriceList (AkeyDprtPriceList, AkeyNumbPriceList)
file prlist ("pricelst.dbt");
  prlist.AkeyDprt = AkeyDprtPriceList;
  prlist.AkeyNumb = AkeyNumbPriceList;
  if (GetEQ (prlist) == TRUE)
    return  prlist.Name;
  else
    return "";
  end;
end;

/*наименование валюты*/
macro GetName_Currency (FIID)
 FILE Fininstr( "fininstr.dbt", "bank.def" ) key 0;
 var stat, ret = "";
 Fininstr.FIID = String(FIID);
 stat = getEQ(Fininstr);
 if(stat)
   ret = Fininstr.Ccy;
 end;
 return ret;
end;

/*наименование вида цены*/
macro GetName_KodPrice (KodPrice)
file kodpr ("kodprice.dbt", "balance.def");
  kodpr.KodPrice = KodPrice;
  if (GetEQ (kodpr) == TRUE)
    return  kodpr.Compress_Name;
  else
    return "";
  end;
end;

/*формирование строки отступа*/
macro StrRecurs (iRecurs)
  return  MkStr (" ", iRecurs);
end;


/* Внутренняя функция печати. Печатает все!
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*
      iMode, 1 - шапка, 2 - строка, 3 - подвал
*/
macro Report (iMode,
              KodPrice, Currency1, Currency2, AltCurrency, AltWarehous,
              iRecurs, Ware, Name_Ware, BarCod, VendCod, Name_Vend,
              Price1, Price2, AltWare, AltName_Ware, AltQuant,
              LVM_Symb, LVM_NameCurr, LVM_Price
             )
array aName;
var   a;
var   str, len;

  if ((iMode == 2) or (iMode == 21))
    str = StrRecurs (iRecurs);
    len = StrLen (str);
  end;

/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
  if ((NOT fLVM) and (fTypeLWare == 1)) /*обычный*/
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
    if (fSort == 0) /*сортировка по коду*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: обычный
   █ Сортировка: по коду
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------+---------------------------------------+------------+------------+
 |Код товара|             Наименование              |  Цена ###  |  Цена ###  |
 +----------+---------------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################|############|############|
](String (str, Ware:10, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:10, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------+---------------------------------------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: обычный
   █ Сортировка: по коду
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------------+---------------------------------+------------+------------+
 |   Код товара   |          Наименование           |  Цена ###  |  Цена ###  |
 +----------------+---------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################|############|############|
](String (str, Ware:16, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:16, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------------+---------------------------------+------------+------------+];
        end;
      end;
    elif (fSort == 1) /*сортировка по наименованию*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: обычный
   █ Сортировка: по наименованию
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +---------------------------------------+----------+------------+------------+
 |             Наименование              |Код товара|  Цена ###  |  Цена ###  |
 +---------------------------------------+----------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 39-len-StrLen(aName(0))), "|", Ware:10):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 39-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 37-len-StrLen(aName(0))), "|", Ware:10):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 37-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------------+----------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: обычный
   █ Сортировка: по наименованию
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +---------------------------------+----------------+------------+------------+
 |          Наименование           |   Код товара   |  Цена ###  |  Цена ###  |
 +---------------------------------+----------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 33-len-StrLen(aName(0))), "|", Ware:16):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 33-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|            |            |
](String (str, "> ",  aName (0)+MkStr (" ", 31-len-StrLen(aName(0))), "|", Ware:16):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 31-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------+----------------+------------+------------+];
        end;
      end;
    end;
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
  elif ((NOT fLVM) and (fTypeLWare == 2)) /*с штрих кодом*/
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
    if (fSort == 0) /*сортировка по коду*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с штрих кодом
   █ Сортировка: по коду
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------+-------------+-------------------------+------------+------------+
 |Код товара|  Штрих код  |      Наименование       |  Цена ###  |  Цена ###  |
 +----------+-------------+-------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 25 - len, 25 - len, 1);
[|##################################################|############|############|
](String (str, Ware:10, " ", BarCod:13, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 10), " ", MkStr (" ", 13), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 23 - len, 23 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:10, " ", BarCod:13, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 10), " ", MkStr (" ", 13), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------+-------------+-------------------------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с штрих кодом
   █ Сортировка: по коду
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------------+-------------+-------------------+------------+------------+
 |   Код товара   |  Штрих код  |   Наименование    |  Цена ###  |  Цена ###  |
 +----------------+-------------+-------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 19 - len, 19 - len, 1);
[|##################################################|############|############|
](String (str, Ware:16, " ", BarCod:13, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 16), " ", MkStr (" ", 13), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 17 - len, 17 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:16, " ", BarCod:13, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 16), " ", MkStr (" ", 13), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------------+-------------+-------------------+------------+------------+];
        end;
      end;
    elif (fSort == 1) /*сортировка по наименованию*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с штрих кодом
   █ Сортировка: по наименованию
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +-------------------------+-------------+----------+------------+------------+
 |      Наименование       |  Штрих код  |Код товара|  Цена ###  |  Цена ###  |
 +-------------------------+-------------+----------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 25 - len, 25 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 25-len-StrLen(aName(0))), "|", BarCod:13, "|", Ware:10):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 25-len-StrLen(aName(a))), "|", MkStr (" ", 13), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 23 - len, 23 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 23-len-StrLen(aName(0))), "|", BarCod:13, "|", Ware:10):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 23-len-StrLen(aName(a))), "|", MkStr (" ", 13), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+-------------------------+-------------+----------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с штрих кодом
   █ Сортировка: по наименованию
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +-------------------+-------------+----------------+------------+------------+
 |   Наименование    |  Штрих код  |   Код товара   |  Цена ###  |  Цена ###  |
 +-------------------+-------------+----------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 19 - len, 19 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 19-len-StrLen(aName(0))), "|", BarCod:13, "|", Ware:16):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 19-len-StrLen(aName(a))), "|", MkStr (" ", 13), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 17 - len, 17 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 17-len-StrLen(aName(0))), "|", BarCod:13, "|", Ware:16):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 17-len-StrLen(aName(a))), "|", MkStr (" ", 13), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+-------------------+-------------+----------------+------------+------------+];
        end;
      end;
    end;
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
  elif ((NOT fLVM) and (fTypeLWare == 3)) /*с кодом поставщика*/
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
    if (fSort == 0) /*сортировка по коду*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с кодом поставщика
   █ Сортировка: по коду
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------+---------------------------------------+------------+------------+
 |Код товара|         Кодировка поставщика          |  Цена ###  |  Цена ###  |
 +----------+---------------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Vend, aName, 28 - len, 28 - len, 1);
[|##################################################|############|############|
](String (str, Ware:10, " ", VendCod:10, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 10), " ", MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Vend, aName, 26 - len, 26 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:10, " ", VendCod:10, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 10), " ", MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------+---------------------------------------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с кодом поставщика
   █ Сортировка: по коду
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +----------------+---------------------------------+------------+------------+
 |   Код товара   |      Кодировка поставщика       |  Цена ###  |  Цена ###  |
 +----------------+---------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Vend, aName, 16 - len, 16 - len, 1);
[|##################################################|############|############|
](String (str, Ware:16, " ", VendCod:16, " ", aName (0)):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 16), " ", MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Vend, aName, 14 - len, 14 - len, 1);
[|##################################################|            |            |
](String (str, "> ", Ware:16, " ", VendCod:16, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 16), " ", MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------------+---------------------------------+------------+------------+];
        end;
      end;
    elif (fSort == 1) /*сортировка по наименованию*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с кодом поставщика
   █ Сортировка: по наименованию
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +---------------------------------------+----------+------------+------------+
 |         Кодировка поставщика          |Код товара|  Цена ###  |  Цена ###  |
 +---------------------------------------+----------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Vend, aName, 28 - len, 28 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 28-len-StrLen(aName(0))), " ", VendCod:10, "|", Ware:10):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 28-len-StrLen(aName(a))), " ", MkStr (" ", 10), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Vend, aName, 26 - len, 26 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 26-len-StrLen(aName(0))), " ", VendCod:10, "|", Ware:10):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 26-len-StrLen(aName(a))), " ", MkStr (" ", 10), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------------+----------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: с кодом поставщика
   █ Сортировка: по наименованию
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                        Вид цены "######"
 +---------------------------------+----------------+------------+------------+
 |      Кодировка поставщика       |   Код товара   |  Цена ###  |  Цена ###  |
 +---------------------------------+----------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  String (GetName_Currency (Currency1) :w),
  String (GetName_Currency (Currency2) :w));
        elif (iMode == 2)
          StrSplit (Name_Vend, aName, 16 - len, 16 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 16-len-StrLen(aName(0))), " ", VendCod:16, "|", Ware:16):w,
  Price1:r:w,
  Price2:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 14-len-StrLen(aName(a))), " ", MkStr (" ", 10), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Vend, aName, 14 - len, 14 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 14-len-StrLen(aName(0))), " ", VendCod:16, "|", Ware:16):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 14-len-StrLen(aName(a))), " ", MkStr (" ", 10), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------+----------------+------------+------------+];
        end;
      end;
    end;
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
  elif ((NOT fLVM) and (fTypeLWare == 4)) /*альтернативный*/
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
    if (fSort == 0) /*сортировка по коду*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: альтернативный
   █ Сортировка: по коду
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                      "######"       ####
 +----------+---------------------------------------+------------+------------+
 |Код товара|             Наименование              |  Цена ###  |  Остаток   |
 +----------+---------------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  AltWarehous,
  String (GetName_Currency (AltCurrency) :w));
        elif (iMode == 2)
          StrSplit (AltName_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################|############|############|
](String (str, AltWare:10, " ", aName (0)):w,
  Price1:r:w,
  AltQuant:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (AltName_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|            |            |
](String (str, "> ", AltWare:10, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------+---------------------------------------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: альтернативный
   █ Сортировка: по коду
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                      "######"       ####
 +----------------+---------------------------------+------------+------------+
 |   Код товара   |          Наименование           |  Цена ###  |  Остаток   |
 +----------------+---------------------------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  AltWarehous,
  String (GetName_Currency (AltCurrency) :w));
        elif (iMode == 2)
          StrSplit (AltName_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################|############|############|
](String (str, AltWare:16, " ", aName (0)):w,
  Price1:r:w,
  AltQuant:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (AltName_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|            |            |
](String (str, "> ", AltWare:16, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------------+---------------------------------+------------+------------+];
        end;
      end;
    elif (fSort == 1) /*сортировка по наименованию*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: альтернативный
   █ Сортировка: по наименованию
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                      "######"       ####
 +---------------------------------------+----------+------------+------------+
 |             Наименование              |Код товара|  Цена ###  |  Остаток   |
 +---------------------------------------+----------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  AltWarehous,
  String (GetName_Currency (AltCurrency) :w));
        elif (iMode == 2)
          StrSplit (AltName_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 39-len-StrLen(aName(0))), "|", AltWare:10):w,
  Price1:r:w,
  AltQuant:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 39-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (AltName_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 37-len-StrLen(aName(0))), "|", AltWare:10):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 37-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------------+----------+------------+------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Вид: альтернативный
   █ Сортировка: по наименованию
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[                                                      "######"       ####
 +---------------------------------+----------------+------------+------------+
 |          Наименование           |   Код товара   |  Цена ###  |  Остаток   |
 +---------------------------------+----------------+------------+------------+
](String (GetName_KodPrice (KodPrice ) :w),
  AltWarehous,
  String (GetName_Currency (AltCurrency) :w));
        elif (iMode == 2)
          StrSplit (AltName_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################|############|############|
](String (str, aName (0)+MkStr (" ", 33-len-StrLen(aName(0))), "|", AltWare:16):w,
  Price1:r:w,
  AltQuant:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, aName (a)+MkStr (" ", 33-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (AltName_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|            |            |
](String (str, "> ", aName (0)+MkStr (" ", 31-len-StrLen(aName(0))), "|", AltWare:16):w);
          a = 1; while (a < aSize (aName))
[|##################################################|            |            |
](String (str, "  ", aName (a)+MkStr (" ", 31-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------+----------------+------------+------------+];
        end;
      end;
    end;
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
  elif (fLVM) /*МБП*/
/* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
    if (fSort == 0) /*сортировка по коду*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Подсистема: МБП
   █ Вид:
   █ Сортировка: по коду
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[
 +----------+---------------------------------------+-----+-------------------+
 |Код товара|             Наименование              | МБП |           Цена    |
 +----------+---------------------------------------+-----+-------------------+
];
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################| ### |   ### ############|
](String (str, Ware:10, " ", aName (0)):w,
  LVM_Symb, LVM_NameCurr, LVM_Price:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|     |                   |
](String (str, "> ", Ware:10, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, "  ", MkStr (" ", 10), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------+---------------------------------------+-----+-------------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Подсистема: МБП
   █ Вид:
   █ Сортировка: по коду
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[
 +----------------+---------------------------------+-----+-------------------+
 |   Код товара   |          Наименование           | МБП |           Цена    |
 +----------------+---------------------------------+-----+-------------------+
];
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################| ### |   ### ############|
](String (str, Ware:16, " ", aName (0)):w,
  LVM_Symb, LVM_NameCurr, LVM_Price:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|     |                   |
](String (str, "> ", Ware:16, " ", aName (0)):w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, "  ", MkStr (" ", 16), " ", aName (a)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+----------------+---------------------------------+-----+-------------------+];
        end;
      end;
    elif (fSort == 1) /*сортировка по наименованию*/
      if (fWidthWare == 10) /*код товара 10 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Подсистема: МБП
   █ Вид:
   █ Сортировка: по наименованию
   █ Код товара: 10
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[
 +---------------------------------------+----------+-----+-------------------+
 |             Наименование              |Код товара| МБП |           Цена    |
 +---------------------------------------+----------+-----+-------------------+
];
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 39 - len, 39 - len, 1);
[|##################################################| ### |   ### ############|
](String (str, aName (0)+MkStr (" ", 39-len-StrLen(aName(0))), "|", Ware:10):w,
  LVM_Symb, LVM_NameCurr, LVM_Price:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, aName (a)+MkStr (" ", 39-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 37 - len, 37 - len, 1);
[|##################################################|     |                   |
](String (str, "> ", aName (0)+MkStr (" ", 37-len-StrLen(aName(0))), "|", Ware:10):w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, "  ", aName (a)+MkStr (" ", 37-len-StrLen(aName(a))), "|", MkStr (" ", 10)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------------+----------+-----+-------------------+];
        end;
      elif (fWidthWare == 16) /*код товара 16 символов*/
/* █▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   █ Подсистема: МБП
   █ Вид:
   █ Сортировка: по наименованию
   █ Код товара: 16
   █▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ */
        if (iMode == 1)
[
 +---------------------------------+----------------+-----+-------------------+
 |          Наименование           |   Код товара   | МБП |           Цена    |
 +---------------------------------+----------------+-----+-------------------+
];
        elif (iMode == 2)
          StrSplit (Name_Ware, aName, 33 - len, 33 - len, 1);
[|##################################################| ### |   ### ############|
](String (str, aName (0)+MkStr (" ", 33-len-StrLen(aName(0))), "|", Ware:16):w,
  LVM_Symb, LVM_NameCurr, LVM_Price:r:w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, aName (a)+MkStr (" ", 33-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 21)
          StrSplit (Name_Ware, aName, 31 - len, 31 - len, 1);
[|##################################################|     |                   |
](String (str, "> ", aName (0)+MkStr (" ", 31-len-StrLen(aName(0))), "|", Ware:16):w);
          a = 1; while (a < aSize (aName))
[|##################################################|     |                   |
](String (str, "  ", aName (a)+MkStr (" ", 31-len-StrLen(aName(a))), "|", MkStr (" ", 16)):w);
            a = a + 1;
          end;
        elif (iMode == 3)
[+---------------------------------+----------------+-----+-------------------+];
        end;
      end;
    end;
  end;

end;


/* Функция печати шапки отчета (вызывается из Си-программы).
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*
                        V_INTEGER, &parm->RslAkeyDprtPriceList,
                        V_INTEGER, &parm->RslAkeyNumbPriceList,
                        V_STRING,   parm->Ware,
                        V_INTEGER, &parm->RslTypeLWare,
                        V_BOOL,    &parm->RslLVM,
                        V_INTEGER, &parm->RslSort,
                        V_INTEGER, &parm->RslWidthWare,
                        V_INTEGER, &parm->RslKodPrice,
                        V_INTEGER, &parm->RslCurrency1,
                        V_INTEGER, &parm->RslCurrency2,
                        V_INTEGER, &parm->RslTypeKodWare,
                        V_INTEGER, &parm->RslTypeNameWare,
                        V_INTEGER, &parm->RslTypeOstWare,
                        V_INTEGER, &parm->RslAltCurrency,
                        V_INTEGER, &parm->RslAltWarehous,
*/
macro PrintTitle (AkeyDprtPriceList, AkeyNumbPriceList, Ware,
                  TypeLWare, LVM, iSort, iWidthWare,
                  KodPrice, Currency1, Currency2,
                  AltTypeKodWare, AltTypeNameWare, AltTypeOstWare,
                  AltCurrency, AltWarehous)


  /*блок определения глобальных переменных*/
  if (fTypeLWare == 0)
    fTypeLWare = TypeLWare + 1;
  end;

  if (fLVM == -1)
    fLVM = LVM;
  end;

  fSort = iSort;
  fWidthWare = iWidthWare;


[----------------------------------------------------- ########## - ######## --
]
 (Date(), Time());

  /* наименование отчета */
  if (AkeyDprtPriceList == 0)
[
                        К А Т А Л О Г   Т О В А Р О В

];
  else
[
 ##############################################################################

](
   String (GetName_PriceList (AkeyDprtPriceList, AkeyNumbPriceList)):c
 );
  end;

  /*текст перед шапкой, параметры отчета*/
  if (Ware != "") /*не весь каталог*/
[Раздел: #] (Ware);
  end;
  if (fTypeLWare == 4) /*альтернативный*/
    if (AltTypeKodWare == 1)
/*[Код товара: в нашей кодировке];*/
    elif (AltTypeKodWare == 2)
[Код товара: в кодировке у поставщика];
    end;
    if (AltTypeNameWare == 1)
/*[Наименование товара: в нашей кодировке];*/
    elif (AltTypeNameWare == 2)
[Наименование товара: в кодировке у поставщика];
    end;
    if (AltTypeOstWare == 1)
[Остаток на складе: логический];
    elif (AltTypeOstWare == 2)
[Остаток на складе: физический];
    end;
  end;

  /*печать шапки*/
  if ((NOT fLVM) and (fTypeLWare == 1)) /*обычный*/
    Report(1,
           KodPrice, Currency1, Currency2, AltCurrency, AltWarehous);
  elif ((NOT fLVM) and (fTypeLWare == 2)) /*с штрих кодом*/
    Report(1,
           KodPrice, Currency1, Currency2, AltCurrency, AltWarehous);
  elif ((NOT fLVM) and (fTypeLWare == 3)) /*с кодировкой поставщика*/
    Report(1,
           KodPrice, Currency1, Currency2, AltCurrency, AltWarehous);
  elif ((NOT fLVM) and (fTypeLWare == 4)) /*альтернативный*/
    Report(1,
           KodPrice, Currency1, Currency2, AltCurrency, AltWarehous);
  elif (fLVM) /*каталог МБП*/
    Report(1,
           KodPrice, Currency1, Currency2, AltCurrency, AltWarehous);
  end;
end;


/* Внутренняя функция печати состава комплекта */
macro PrintCompl (Head, iRecurs)
file compl ("complect.dbt", "balance.def")  KEY 0;
file ware  ("ware.dbt", "balance.def") KEY 0;
var rc;

  compl.HeadCod = Head;
  compl.Ware    = "";
  rc = GetGE (compl);
  while (rc and
         (compl.HeadCod == Head))

    ware.ware = compl.Ware;
    if (GetEQ (Ware) != TRUE)  ware.Name_Ware = "не найден";  end;

    Report(21,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    "", "", "",
                    "", "", "", "", compl.Quantity,
                    "", "", "");
    rc = Next (compl);
  end;
end;

/* Функция печати строки отчета (вызывается из Си-программы).
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*
                        V_INTEGER, &parm->RslAkeyDprtPriceList,
                        V_INTEGER, &parm->RslAkeyNumbPriceList,
                        V_INTEGER, &addr,
                        V_INTEGER, &addr1,

                        V_INTEGER, &parm->RslRecurs,

                        V_STRING,  parm->parmLW->ls.BarCod,
                        V_BOOL,    &parm->cParent,
                        V_MONEY,   &parm->parmLW->ls.Price [0],
                        V_MONEY,   &parm->parmLW->ls.Price [1],

                        V_STRING,  &parm->bs->Mps->PFList [0].FValue,
                        V_STRING,  &parm->bs->Mps->PFList [1].FValue,
                        V_DOUBLE,  &parm->parmLW->QtyOstWare,

                        V_STRING,  &parm->parmLW->ls.szLVM,
                        V_STRING,  &parm->parmLW->ls.NameCurr [0],
                        V_MONEY,   &parm->parmLW->ls.Price [0],
                        V_ENDLIST
*/
macro PrintLine (AkeyDprtPriceList, AkeyNumbPriceList, addr, addr1,
                 iRecurs,
                 BarCod, cParent, Price1, Price2,
                 AltWare, AltName_Ware, AltQuant,
                 LVM_Symb, LVM_NameCurr, LVM_Price)
record ware  ("ware.dbt", "balance.def");
record wlist ("warelist.dbt", "balance.def");
var    rc;
var    a;

  /* настроить буфер */
  if (AkeyDprtPriceList == 0)
    setbuff (ware, addr);
  else
    setbuff (wlist, addr);
    setbuff (ware, addr1);
  end;

  /*для каталога МБП пропускать обычные товары*/
  if (fHideNonLVM == 1)
    if (AkeyDprtPriceList == 0)
      if (NOT ware.cLVM)  return 0; end;
    else
      if (wlist.iType == 1)
        if (NOT ware.cLVM)  return 0; end;
      end;
    end;
  end;

  /*обнуление цен для разделов*/
  if (cParent)
    Price1 = "";
    Price2 = "";
    AltQuant  = "";
    LVM_NameCurr = "";
    LVM_Price = "";
  else
    if (Price1 != 0)  Price1 = String (Price1);
    else              Price1 = "0";
    end;
    if (Price2 != 0)  Price2 = String (Price2);
    else              Price2 = "0";
    end;
    if (LVM_Price != 0)  LVM_Price = String (LVM_Price);
    else                 LVM_Price = "0";
    end;


    SetDefPrec (0);
    AltQuant = String (AltQuant);

  end;

  /*печать строки*/
  if ((NOT fLVM) and (fTypeLWare == 1)) /*обычный*/
    Report(2,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    BarCod, ware.VendKod, ware.Name_Vend,
                    Price1, Price2, "", "", "",
                    "", "", "");
  elif ((NOT fLVM) and (fTypeLWare == 2)) /*с штрих кодом*/
    Report(2,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    BarCod, ware.VendKod, ware.Name_Vend,
                    Price1, Price2, "", "", "",
                    "", "", "");
  elif ((NOT fLVM) and (fTypeLWare == 3)) /*с кодировкой поставщика*/
    Report(2,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    BarCod, ware.VendKod, ware.Name_Vend,
                    Price1, Price2, "", "", "",
                    "", "", "");
  elif ((NOT fLVM) and (fTypeLWare == 4)) /*альтернативный*/
    Report(2,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    BarCod, ware.VendKod, ware.Name_Vend,
                    Price1, Price2,
                    AltWare, AltName_Ware, AltQuant,
                    "", "", "");
  elif (fLVM) /*каталог МБП*/
    Report(2,
           "", "", "", "", "",
           iRecurs, ware.Ware, ware.Name_Ware,
                    BarCod, ware.VendKod, ware.Name_Vend,
                    "", "", "", "", "",
                    LVM_Symb, LVM_NameCurr, LVM_Price);
  end;

  if (fCompl)
    if (ware.Complect)
      PrintCompl (ware.Ware, iRecurs);
    end;
  end;
end;


/* Функция печати подвала отчета (вызывается из Си-программы).
   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
/*
*/
macro PrintEnd ()
  /*печать подвала*/
  Report(3);
         /*"", "", "", "", "",
         "", "", "", "", "", "");*/
end;

