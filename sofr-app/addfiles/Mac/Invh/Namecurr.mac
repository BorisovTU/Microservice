/*----------------------------------------------------------*/
/*                 МБП-Банк и МБП-Баланс                    */
/*       Получить имя валюты из справочника валюты          */
/*----------------------------------------------------------*/

file    bnkCurr0_gl   ("fininstr.dbt", "bank.def")   KEY 0;    /* FIID */

/*--------------------------------*/
/* Полное название валюты (Баланс)*/
/*--------------------------------*/
MACRO GetNameCurrency (iCode)
file    FCurr   ("currency.dbt","balance.def")  KEY 0;
  FCurr.Code_Currency = iCode;
  if (GetEQ(FCurr) == TRUE)     return FCurr.Name_Currency;
  else                          return "";
  end;
end;

/*--------------------------------------*/
/* Сокращенное название валюты (Баланс) */
/*--------------------------------------*/
MACRO GetCompressNameCurrency( iCode )
file    FCurr   ("currency.dbt","balance.def")  KEY 0;
   FCurr.Code_Currency = iCode;
   if( getEQ( FCurr ) ) return FCurr.Compres_Name;
   else                 return "";
   end;
end;


/*------------------------------------*/
/* Сокращенное название валюты (Банк) */
/*------------------------------------*/
MACRO GetShortNameCurrency_Bank( iCode )
  bnkCurr0_gl.FIID = iCode;
  if( getEQ( bnkCurr0_gl ) )    return  bnkCurr0_gl.Ccy;
  else                          return  string(iCode);
  end;
end;

/*--------------------------------*/
/* Полное название валюты (Банк)  */
/*--------------------------------*/
MACRO GetNameCurrency_Bank( iCode )
  bnkCurr0_gl.FIID = iCode;
  if( getEQ( bnkCurr0_gl ) )    return  bnkCurr0_gl.Name;
  else                          return  string(iCode);
  end;
end;
