/*
$Name:           lcscrunop.mac
$Module:         Торговое финансирование
$Description:    Отчет группового исполнения операции
*/ 

IMPORT  PaymInter, BankInter;

private const   
  Ошибка   = 0,
  Первый   = 1,
  Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  if( Вызов==Первый )
[                Отчет о групповом исполнении операции                          ];
[┌─────────┬──────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                        Сообщение                           │];
[│документа│ошибки│                                                            │];
[├─────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif ( Вызов == Ошибка )

    if(Статус == 0)
      Сообщение = "Действие выполнено успешно.";
    end;

    var WarnList : TArray = GetWarnings();
    for(var Warning, WarnList)
      Сообщение = Сообщение + "\n" + Warning.stat + " " + Warning.message;
    end;

[│#########│######│############################################################│]
( GetLastPaymentsNumber(), Статус, StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└─────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
