/*
  $Name:        lc011_10.mac
  $Module:      Документарные аккредитивы
  $Description: Макрос шага
*/

// --------------------------------------------------------------------
//         Автоматизированная банковская система RS-Bank v6.0
//                 Copyright (c) R-Style Software Lab
//
//  Назначение  : Макрос шага
//
//  Описание    : Операция - 3411   - "Аккредитив"
//                Блок     - 341011 - "Учет привлеченных средств по МБК"
//                Шаг      - 10     - "Учет привлеченных средств по МБК"
//
//  Программист : Чукина Т.А.
//
//  Создан      : 15.07.2013
//
// --------------------------------------------------------------------

IMPORT LCInter, lc_common;

var LCDocObj:RsbLetterOfCredit;

macro needCreatePaym_11_10(RecLcpay : TRecHandler) : bool
  return (RecLcpay.rec.State == LCPAY_COMPENSATION_STATUS_NOTPROC); // Не обработано
end;

macro checkLcpay_11_10(RecLcpay : TRecHandler) : bool
  if(not RecLcpay.rec.DealAccount)
    msgbox("Не задан счет привлеченных средств");
    return false;
  end;

  return true;
end;

MACRO ExecuteStep()
  return CreateCompensationPayments_MemOrd(LCDocObj, @needCreatePaym_11_10, @checkLcpay_11_10);
END;
