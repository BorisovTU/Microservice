/*
  $Name:        lc013_10.mac
  $Module:      Документарные аккредитивы
  $Description: Макрос шага
*/

// --------------------------------------------------------------------
//         Автоматизированная банковская система RS-Bank v6.0
//                 Copyright (c) R-Style Software Lab
//
//  Назначение  : Макрос шага
//
//  Описание    : Операция - 3411   - "Аккредитив"
//                Блок     - 341013 - "Отзыв аккредитива"
//                Шаг      - 10     - "Отзыв аккредитива"
//
//  Программист : Чукина Т.А.
//
//  Создан      : 16.07.2013
//
// --------------------------------------------------------------------

IMPORT LCInter, BankInter, "lc_common.mac";

var LCDocObj:RsbLetterOfCredit;

MACRO ExecuteStep()
  var stat : integer = 0;

  if(not stat)
    // Сформировать мультивалютные мемориальные ордера для отражения отзываемой суммы
    stat = CreateDocsOffBalance_StopLcAccounting(LCDocObj, true);

    if(stat)
      return stat;
    end;
  end;

  if( (stat = LCDocObj.ChangeState(WLD_STATUS_LC_RECALL)) != 0 )
    DisplayError();
  end;

  return stat;
END;
