/*
  $Name:        lc001_10.mac
  $Module:      Документарные аккредитивы
  $Description: Макрос шага
*/

/* -------------------------------------------------------------------- */
/*         Автоматизированная банковская система RS-Bank v6.0           */
/*                 Copyright (c) R-Style Software Lab                   */
/*                                                                      */
/*  Назначение  : Макрос шага                                           */
/*                                                                      */
/*  Описание    : Операция - 3411   - "Аккредитив"                      */
/*                Блок     - 341001 - "Оформление"                      */
/*                Шаг      - 10     - "Оформление"                      */
/*                                                                      */
/*  Программист : Чукина Т.А.                                           */
/*                                                                      */
/*  Создан      : 15.05.2013                                            */
/*                                                                      */
/* -------------------------------------------------------------------- */
IMPORT InsCarryDoc, OprInter, LCInter;

var LCDocObj:RsbLetterOfCredit;

MACRO ExecuteStep()

  var StatusValue : integer = 0;

  if( LCDocObj.Cover == LCDOC_COVER_KIND_APPLICANT_CREDIT )
    StatusValue = LCDOC_ST_OK_LOAN_RSLOANS;
  else
    StatusValue = LCDOC_ST_OK_ACCOUNT;
  end;

  if( not InsertOprStatus(LCDOC_ST_KIND_OK, StatusValue) )
    msgbox("Ошибка при установке сегментов статуса экземпляра операции");
    return 1;
  end;

  if( LCDocObj.Compensation == LCDOC_COMPENSATION_KIND_FIN_BANK )
    StatusValue = LCDOC_ST_OB_DEALMBK_RSDEALING;
  else
    StatusValue = LCDOC_ST_OB_TRANSFER;
  end;

  if( not InsertOprStatus(LCDOC_ST_KIND_OB, StatusValue) )
    msgbox("Ошибка при установке сегментов статуса экземпляра операции");
    return 1;
  end;

  return 0;
END;
