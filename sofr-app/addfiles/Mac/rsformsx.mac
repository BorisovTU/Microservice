//-*--------------------------------------------------------------------------*-
//
// File Name   : rsforms.mac
//
// Copyright (c) 1991 - 2005 by R-Style Softlab.
// All Rights Reserved.
//
//-*--------------------------------------------------------------------------*-
// 28.03.05  - create file
//-*--------------------------------------------------------------------------*-

//
// Устаревший файл. Вместо него следует использовать rsforms.mac
//

import rsforms;   

class FrmCreatorOld (instName:string, module:string)

  var inst = CreateObject ("rcwhost", "TRcwHost", instName, true);
  inst.Execute;

  if (module)
     if (not inst.AddModule (module))
       MsgBox ("Errr to Add");
     end;
  end;

  macro AddModule (module:string)
     inst.AddModule (module)
  end;

  private macro GetExtWnd (o)
     if (o)
        if (IsEqClass ("TWindow", o))
           o = o.object
        elif (IsEqClass ("TControl", o))
           o = o.windowRef.object
        end
     end;
     return o;
  end;
  
  macro SetExtMainWnd  (wnd:object)
     inst.Call ("SetExtMainWnd",wnd);
  end;
          
                     
  macro FindForm (name:string)
     return inst.Call ("GetFormByName",name);
  end;
  macro CreateForm (cls, name)
    return inst.Call (cls, null, name);
  end;

  macro GetForm (cls, name, owner)
    var f = null;
    if (name)
      f = FindForm (name)
    end;
  
    if (f == null)
      f = CreateForm (cls, name);
      f.showPopUp (5, GetExtWnd (owner))
    else
      f.Activate;
    end;
    return f;
  end;
  
  macro GetFormInMainWnd (cls,name)
    var f = null;
    if (name)
      f = FindForm (name)
    end;
  
    if (f == null)
       f = CreateForm (cls,name);
       inst.Call ("OpenFormInMainWnd",f);
    else
       f.Activate;
    end;
    return f;
  end;

  macro GetFormInNamedWnd (wndName,cls,name)
    var f = null;
    if (name)
      f = FindForm (name)
    end;
  
    if (f == null)
       f = CreateForm (cls,name);
       inst.Call ("OpenFormInNamedWnd",wndName,f);
    else
       f.Activate;
    end;
    return f;
  end;
        
  macro GetFormInExtWnd (w,cls,name)
    var f = null;
    if (name)
      f = FindForm (name)
    end;
  
    if (f == null)
       f = CreateForm (cls,name);
       inst.Call ("OpenFormInExtWnd",w,f);
    else
       f.Activate;
    end;
    return f;
  end;

  macro GetFormInWnd (wnd,cls,name)
    var f = null;
    if (name)
      f = FindForm (name)
    end;
  
    if (f == null)
       f = CreateForm (cls,name);
       inst.Call ("OpenFormInWnd",wnd,f);
    else
       f.Activate;
    end;
    return f;
  end;

end;
