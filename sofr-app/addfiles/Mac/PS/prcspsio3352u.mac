/*
$Name:             Prcspsio3352u.mac
$Module:            ¨ Š
$Description:      ¥ç âì ®¡êï¢«¥­¨ï ­  ¢§­®á ­ «¨ç­ë¬¨ 3352-“
*/

import prcs;


/* ¥ç âì ®¡êï¢«¥­¨ï ­  ¢§­®á ­ «¨ç­ë¬¨ */
MACRO PrintDocumentCashOrder( d : TCashOrderPrintData3352,ncopy:integer):bool

  var index : integer;
  array ArrayGround, ArrayClient, ArrayPayerBankName, ArrayReceiverBankName, ArrayReceiverName, ArraySum;

  StrSplit(d.Client, ArrayClient, 39, 31, 2);
  StrSplit(d.ReceiverName, ArrayReceiverName, 39, 31, 2);
  StrSplit(d.PayerBankName, ArrayPayerBankName, 50, 37, 2);
  StrSplit(d.ReceiverBankName, ArrayReceiverBankName, 50, 37, 2);
  StrSplit(d.Ground, ArrayGround, 95, 74, 2);
  StrSplit(d.SumRubString, ArraySum, 71, 80, 2);  
  
  if (ArraySum(1) == "")
    ArraySum(0) = AddStrSymbols(ArraySum(0), "", 80);
  end;
  ArraySum(1) = AddStrSymbols(ArraySum(1), d.SumNameRubString, 71);
  
  
  while( ncopy > 0 )

    /*¡êï¢«¥­¨¥*/
    [                                             ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  Ú Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä ¿    
      ¡êï¢«¥­¨¥ ­  ¢§­®á ­ «¨ç­ë¬¨               ³Š®¤ ä®à¬ë ¤®ªã¬¥­â ³  ³âàë¢­®© â «®­ ª ®¡êï¢«¥­¨î³
                                                  ³  ¯® Š“„ 0402001  ³  ³­  ¢§­®á ­ «¨ç­ë¬¨ ü#######³
                                                  ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  À Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ù
                                                                                                 
                                 ÚÄÄÄÄÄÄÄÄÄ¿     ####################### ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                šŸ‚‹…ˆ…     N ³ ####### ³       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ³    Œ¥áâ® ¤«ï ­ ª«¥©ª¨     ³
                                 ÀÄÄÄÄÄÄÄÄÄÙ                „ â          ³     ®âàë¢­®£® â «®­       ³
                                                     „……’               ³                           ³
                                             ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      â ª®£® ###############################³áç¥â ü ####################³  ###    ################# ³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
      #######################################        Š…„ˆ’              ³          ‘ã¬¬  æ¨äà ¬¨    ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
      ®«ãç â¥«ì ############################³áç¥â ü ####################³  ###    ################# ³
                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³  ###    ################# ³ 
      #######################################³       ####################³  ###    ################# ³]
     (d.Number:l, 
      d.DateStr:c, 
      d.Number:c, 
      ArrayClient(0), d.PayerAccount:l, d.FICode, d.AmountStr:r, 
      ArrayClient(1), 
      ArrayReceiverName(0), d.CreditList.value(0).Account:l, d.CreditList.value(0).FICode, d.CreditList.value(0).Amount:r,
      d.CreditList.value(1).Account:l, d.CreditList.value(1).FICode, d.CreditList.value(1).Amount:r, 
      ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode, d.CreditList.value(2).Amount:r); 
      
      index = 3;
      while( index < d.CreditList.size )
        if (d.CreditList.value(index).Amount == "") 
          break; 
        end;

    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³  ###    ################# ³]
      (d.CreditList.value(index).Account:l, d.CreditList.value(index).FICode, d.CreditList.value(index).Amount:r);
       index = index + 1;
      end;

    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´     
      ˆ ############                  ‘ç¥â ü ######################### ³                           ³
          ÄÄÄÄÄÄÄÄÄÄÄÄ                         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
      (d.ReceiverINN, d.CreditList2.value(0).Account:l);
      index = 1;
      while( index < d.CreditList2.size )
        if (d.CreditList2.value(index).Account == "") 
          break; 
        end;
      
    [                                          ######################### ³                           ³
                                               ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
        (d.CreditList2.value(index).Account:l);
        index = index + 1;
      end;
     
    [                                                                    ³  ¢ â®¬ ç¨á«¥ ¯® á¨¬¢®« ¬: ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  #####################################³  á¨¬¢®« ³       áã¬¬      ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ################################################## ˆŠ ########## ³   ####  ³ ##############  ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï #####################################³   ####  ³ ##############  ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ################################################## ˆŠ ########## ³   ####  ³ ##############  ³]

      (ArrayPayerBankName(0), 
       ArrayPayerBankName(1), d.BIC1, d.ArraySym.value(0):c, MakeMoneyStr3352(d.ArrayPartSum.value(0)):r, 
       ArrayReceiverBankName(0), d.ArraySym.value(1):c, MakeMoneyStr3352(d.ArrayPartSum.value(1)):r, 
       ArrayReceiverBankName(1), d.BIC2, d.ArraySym.value(2):c, MakeMoneyStr3352(d.ArrayPartSum.value(2)):r);

      index = 3;
      while( index < d.ArraySym.size )
        if ((index == 3) and (d.ArraySym.value(index) != ""))
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
        elif (d.ArraySym.value(index) != "")
    [                                                                    ÃÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
        end;
        
        if (d.ArraySym.value(index) == "") 
          break; 
        end;
    [                                                                    ³   ####  ³ ##############  ³]
        (d.ArraySym.value(index):c, MakeMoneyStr3352(d.ArrayPartSum.value(index)):r );
        index = index + 1;
      end;
      
      if (index == 3)
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
      else
    [                                                                    ÀÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ];
      end;
    
    [ ‘ã¬¬  ¯à®¯¨áìî ################################################################################
                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ####################################################################### ########### ###########
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÄ 
                                                                               (æ¨äà ¬¨)              ]
      (ArraySum(0),
       ArraySum(1),d.SumKopString:c,d.SumNameKopString:l);
      
    
    [ ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï ###########################################################################                                                                        
                           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

      ‚­®á¨â¥«ì __________ 
              («¨ç­ ï ¯®¤¯¨áì) 
      _______________  ___________  _______________    _______________  ___________  _______________
       (­ ¨¬¥­®¢ ­¨¥    («¨ç­ ï        (ä ¬¨«¨ï,        (­ ¨¬¥­®¢ ­¨¥     («¨ç­ ï       (ä ¬¨«¨ï,     
         ¤®«¦­®áâ¨)      ¯®¤¯¨áì)      ¨­¨æ¨ «ë)          ¤®«¦­®áâ¨)       ¯®¤¯¨áì)      ¨­¨æ¨ «ë)    
                                                                                                      ]
      (ArrayGround(0),
       ArrayGround(1));               
  

      StrSplit(d.Client, ArrayClient, 62, 54, 2);
      StrSplit(d.ReceiverName, ArrayReceiverName, 62, 51, 2);
    /*Š¢¨â ­æ¨ï*/  
    [
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                 ÚÄÄÄÄÄÄÄÄÄÄ¿                                    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                    Š¢¨â ­æ¨ï  N ³ #######  ³          #######################   ³Š®¤ ä®à¬ë ¤®ªã¬¥­â ³
                                 ÀÄÄÄÄÄÄÄÄÄÄÙ           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ³  ¯® Š“„ 0402001  ³
                                                                „ â              ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
                                                                                                
                                                                           ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      â ª®£® ############################################################ ³„«ï § ç¨á«¥­¨ï ­  áç¥â( )³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ####################   ³ 
      #################################################################### ³  ####################   ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ####################   ³ 
      ®«ãç â¥«ì ######################################################### ³  ####################   ³ 
                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´  ####################   ³ 
      #################################################################### ³                         ³]
      
      (d.Number:c, d.DateStr:c,
      ArrayClient(0), 
      d.CreditList2.value(0).Account:l,
      ArrayClient(1), d.CreditList2.value(1).Account:l,
      d.CreditList2.value(2).Account:l,
      ArrayReceiverName(0), d.CreditList2.value(3).Account:l,
      d.CreditList2.value(4).Account:l,
      ArrayReceiverName(1), d.CreditList2.value(5).Account:l );

      index = 6;
      while( index < d.CreditList2.size )
        if (d.CreditList2.value(index).Account == "") 
          break; 
        end;
    [                                                                      ³  ####################   ³ ]
        ( d.CreditList2.value(index).Account:l );
        index = index + 1;
    end;
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ˆ ############                                                     ³ ###   ################# ³ 
          ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                         ³ ]
      
      ( d.ReceiverINN,
        d.CreditList.value(0).FICode,  d.CreditList.value(0).Amounts:r );
      index = 1;
      while( index < d.CreditList.size )
        if (d.CreditList.value(index).Amount == "") 
          break; 
        end;
    [                                                                      ³ ###   ################# ³ ]
        ( d.CreditList.value(index).FICode,  d.CreditList.value(index).Amounts:r );
        index = index + 1;
      end;
    [                                                                      ³  ‘ã¬¬  (áã¬¬ë) æ¨äà ¬¨  ³        
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï ##################################################################                                  
                                   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################ ˆŠ ########## 
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄ      
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï #################################################################                                                            
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################ ˆŠ ########## 
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄ      
      ‘ã¬¬  ¯à®¯¨áìî ################################################################################
                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ####################################################################### ########### ###########
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÄ 
                                                                               (æ¨äà ¬¨)              
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï ##########################################################################                                            
                           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ###############################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      
                          
          Œ¥áâ®           _______________ _________ _____________ ____________  ________ ____________                       
          ¯¥ç â¨           (­ ¨¬¥­®¢ ­¨¥   («¨ç­ ï    (ä ¬¨«¨ï,   (­ ¨¬¥­®¢ ­¨¥ («¨ç­ ï   (ä ¬¨«¨ï,     
         (èâ ¬¯ )            ¤®«¦­®áâ¨)    ¯®¤¯¨áì)    ¨­¨æ¨ «ë)    ¤®«¦­®áâ¨)  ¯®¤¯¨áì)   ¨­¨æ¨ «ë)   
                                                                                                       ]

      (ArrayPayerBankName(0),
      ArrayPayerBankName(1), d.BIC1,
      ArrayReceiverBankName(0), 
      ArrayReceiverBankName(1), d.BIC2,
      ArraySum(0),
      ArraySum(1),d.SumKopString:c,d.SumNameKopString:l,
      ArrayGround(0),
      ArrayGround(1));
         
    /*à¤¥à*/         
    
      StrSplit (d.Client, ArrayClient, 33, 25, 3);
      StrSplit(d.ReceiverName, ArrayReceiverName, 33, 22, 3);
    
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                 ÚÄÄÄÄÄÄÄÄÄÄ¿                                    ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
                        à¤¥à  N ³ #######  ³       #######################      ³Š®¤ ä®à¬ë ¤®ªã¬¥­â ³
                                 ÀÄÄÄÄÄÄÄÄÄÄÙ        ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ        ³  ¯® Š“„ 0402001  ³
                                                             „ â                 ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ     
                                                                          
                                                       „……’                   
                                             ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      â ª®£® ###############################³áç¥â ü ####################³  ###    ################# ³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
      #######################################        Š…„ˆ’              ³          ‘ã¬¬  æ¨äà ¬¨    ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
      ®«ãç â¥«ì ############################³áç¥â ü ####################³  ###    ################# ³
                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³  ###    ################# ³ 
      #######################################³       ####################³  ###    ################# ³]
     (d.Number:c, d.DateStr:c, 
      ArrayClient(0), d.PayerAccount:l, d.FICode, d.AmountStr:r, 
      ArrayClient(1), 
      ArrayReceiverName(0), d.CreditList.value(0).Account:l, d.CreditList.value(0).FICode, d.CreditList.value(0).Amount:r,
      d.CreditList.value(1).Account:l, d.CreditList.value(1).FICode, d.CreditList.value(1).Amount:r, 
      ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode, d.CreditList.value(2).Amount:r); 
      
      index = 3;
      while( index < d.CreditList.size )
        if (d.CreditList.value(index).Account == "") 
          break; 
        end;
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³  ###    ################# ³]
        (d.CreditList.value(index).Account:l, d.CreditList.value(index).FICode, d.CreditList.value(index).Amount:r);
         index = index + 1;
      end;

    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´     
      ˆ ############                  ‘ç¥â ü ######################### ³                           ³
          ÄÄÄÄÄÄÄÄÄÄÄÄ                         ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
      (d.ReceiverINN, d.CreditList2.value(0).Account:l);
      index = 1;
      while( index < d.CreditList2.size )
        if (d.CreditList2.value(index).Account == "") 
          break; 
        end;
    [                                          ######################### ³                           ³
                                               ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´]
        (d.CreditList2.value(index).Account:l);
        index = index + 1;
      end;
     
    [                                                                    ³  ¢ â®¬ ç¨á«¥ ¯® á¨¬¢®« ¬: ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  #####################################³  á¨¬¢®« ³       áã¬¬      ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ################################################## ˆŠ ########## ³   ####  ³ ##############  ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï #####################################³   ####  ³ ##############  ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ################################################## ˆŠ ########## ³   ####  ³ ##############  ³]

      (ArrayPayerBankName(0), 
       ArrayPayerBankName(1), d.BIC1, d.ArraySym.value(0):c, MakeMoneyStr3352(d.ArrayPartSum.value(0)):r, 
       ArrayReceiverBankName(0), d.ArraySym.value(1):c, MakeMoneyStr3352(d.ArrayPartSum.value(1)):r, 
       ArrayReceiverBankName(1), d.BIC2, d.ArraySym.value(2):c, MakeMoneyStr3352(d.ArrayPartSum.value(2)):r);

      index = 3;
      while( index < d.ArraySym.size )
        if ((index == 3) and (d.ArraySym.value(index) != ""))
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
        elif (d.ArraySym.value(index) != "")
    [                                                                    ÃÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´];
        end;
      
        if (d.ArraySym.value(index) == "") 
          break; 
        end;
    [                                                                    ³   ####  ³ ##############  ³]
      

        (d.ArraySym.value(index):c, MakeMoneyStr3352(d.ArrayPartSum.value(index)):r );
        index = index + 1;
      end;
      if (index == 3)
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄ´];
      else
    [                                                                    ÃÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄ´];
      end;
      
      StrSplit(d.SumRubString, ArraySum, 71, 51, 2); 
  
      if (ArraySum(1) == "")
        ArraySum(0) = AddStrSymbols(ArraySum(0), "", 51);
      end;
      ArraySum(1) = AddStrSymbols(ArraySum(1), d.SumNameRubString, 71);      
    [ ‘ã¬¬  ¯à®¯¨áìî ####################################################³ ˜¨äà ¤®ªã¬¥­â    ³   ##   ³
                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÙ
      ####################################################################### ########### ###########
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ      ÄÄÄÄÄÄÄÄÄÄÄ 
                                                                               (æ¨äà ¬¨)              ]
      (ArraySum(0), d.ShifrOper:c,                                                                             
      ArraySum(1),d.SumKopString:c,d.SumNameKopString:l);
    
    [ ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï ###########################################################################                                                                        
                           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ################################################################################################
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

       _______________    _________   ______________   _____________   ________   _______________                       
       (­ ¨¬¥­®¢ ­¨¥      («¨ç­ ï       (ä ¬¨«¨ï,      (­ ¨¬¥­®¢ ­¨¥   («¨ç­ ï       (ä ¬¨«¨ï,     
         ¤®«¦­®áâ¨)       ¯®¤¯¨áì)      ¨­¨æ¨ «ë)        ¤®«¦­®áâ¨)    ¯®¤¯¨áì)      ¨­¨æ¨ «ë)        ]
      (ArrayGround(0),
      ArrayGround(1)           
     );                                                      
    
    ncopy = ncopy - 1;
  end;

  return TRUE;

end;

macro PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind;
  var data : TCashOrderPrintData3352 = TCashOrderPrintData3352();
  
  if( DocKind != 410/*CASH_PS_INCORDER*/  )
    MsgBox("„ ­­ë© ¢¨¤ ¤®ªã¬¥­â  ­¥ ¯®¤¤¥à¦¨¢ ¥âáï ¬ ªà®á®¬");
    return FALSE;
  end;
  data.Init( pr_pmpaym, pr_pmrmprop, pr_pscshdoc );
  if( pr_PrintEA )
    PrintEAHeader();
  end;
  
  return PrintDocumentCashOrder(data,ncopy);
end;