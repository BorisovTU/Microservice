/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prreqch.mac                                        */
/*                                                                      */
/*  Описание       : Заполнение печатной формы на изменение счета       */
/*                                                                      */
/*  Программист    : Дроздов И.Е.                                       */
/*                                                                      */
/*  Создан         : 21.10.04                                           */
/*                                                                      */
/************************************************************************/

IMPORT "BnkTemplReport.mac";
IMPORT rqmeslib;

MACRO ЗаполнитьДанные( chnga, wlmes  )

  var stat:integer = 0;
  
  var field, buff;
  ЗаполнитьДанныеСообщенияОбИзменении( chnga, wlmes );

  while(СчитатьПоле(field,buff))

    if( field == "КодНОБ" )
      ЗаполнитьДанныеРегистрацииБанкаФНС( buff );
      return;
    end;
  end;
END;

class (BnkTemplReport)ReqChangeReport(p_chnga, p_wlmes)
   var chnga = p_chnga, wlmes = p_wlmes;

  MACRO Create()
    
    ОчиститьФормуСообщения();
    ЗаполнитьДанные(chnga, wlmes);


    SetSheetName( ReqAccount );

    SetValuesMultiCell( "FormKND"        , "1114303"       ,3  ,  7 ,
                        "Number1"        , SeriesAndNum    ,3  , 20 ,        
                        "CodeGNI"        , CodeGNI         ,3  ,  4 ,
                        "IndexGNI_1"     , IndexGNI        ,3  ,  6 ,
                        "IndexBank_1"    , BankIndex       ,3  ,  6 ,    
                        "RegNomBank_1"   , BankRegNom      ,3  ,  4 ,  
                        "NumberBank_1"   , BankNumber      ,3  ,  4 ,  
                        "BankBIC_1"      , BankBIC         ,3  ,  9 ,
                        "BankINN_1"      , BankINN         ,3  , 12 ,   
                        "BankKPP_1"      , BankKPP         ,3  ,  9 ,    
                        "BankOGRN_1"     , BankOGRN        ,3  , 13 ,    
                        "AccOld1"        , ReqAccountOld   ,3  , 20 ,
                        "NomDog_1"       , DogAccNumber    ,3  , 20 ,  
                        "ClientINN_1"    , ClientINN       ,3  , 12 ,
                        "ClientKPP_1"    , ClientKPP       ,3  ,  9 ,
                        "ClientOGRNIP_1" , ClientOGRN      ,3  , 15 ,
                        "NatCur_1"       , NatCurAcc       ,3  ,  1 ,           
                        "ValCur_1"       , ValCurAcc       ,3  ,  1 ,            
                        "AccNew_1"       , ReqAccount      ,3  , 20 ,
                        "DNew_1"         , ChngAccDateD    ,3  ,  2 , 
                        "MNew_1"         , ChngAccDateM    ,3  ,  2 ,             
                        "YNew_1"         , ChngAccDateY    ,3  ,  4 , 
                        "IndexBank_2"    , ""              ,3  ,  6 ,    
                        "RegNomBank_2"   , ""              ,3  ,  4 ,  
                        "NumberBank_2"   , ""              ,3  ,  4 ,  
                        "BankBIC_2"      , ""              ,3  ,  9 ,
                        "BankINN_2"      , ""              ,3  , 12 ,   
                        "BankKPP_2"      , ""              ,3  ,  9 ,    
                        "BankOGRN_2"     , ""              ,3  , 13 ,    
                        "DBank_1"        , ""              ,3  ,  2 ,
                        "MBank_1"        , ""              ,3  ,  2 ,
                        "YBank_1"        , ""              ,3  ,  4 ,
                        "DBank_2"        , ChngAccDateD    ,3  ,  2 ,
                        "MBank_2"        , ChngAccDateM    ,3  ,  2 ,
                        "YBank_2"        , ChngAccDateY    ,3  ,  4 ,
                        "Phon_1"         , Phone           ,3  , 20 ,      
                        "Number2"        , SeriesAndNum    ,3  , 20 ,        
                        "CodeGNI2"       , CodeGNI         ,3  ,  4 ,
                        "DMes_1"         , OutSideDateD    ,3  ,  2 ,       
                        "MMes_1"         , OutSideDateM    ,3  ,  2 ,       
                        "YMes_1"         , OutSideDateY    ,3  ,  4 ,       
                        "AccOld2"        , ReqAccountOld   ,3  , 20 ,
                        "NomDog_2"       , DogAccNumber    ,3  , 20 ,
                        "ClientINN_2"    , ClientINN       ,3  , 12 ,
                        "ClientKPP_2"    , ClientKPP       ,3  ,  9 ,
                        "ClientOGRNIP_2" , ClientOGRN      ,3  , 15 ,
                        "NatCur_2"       , NatCurAcc       ,3  ,  1 ,
                        "ValCur_2"       , ValCurAcc       ,3  ,  1 ,
                        "DBank_3"        , ChngAccDateD    ,3  ,  2 ,           
                        "MBank_3"        , ChngAccDateM    ,3  ,  2 ,        
                        "YBank_3"        , ChngAccDateY    ,3  ,  4 ,        
                        "Phon_2"         , Phone           ,3  , 20 
                      );                                           
                                                                      
    SetValues( "NameGNI"        , NameGNI,                       
               "AdresGNI"       , AdressGNI,                     
               "BankName_1"     , BankName,                      
               "AdresBank_1"    , BankAdress,                    
               "NameClient_1"   , ClientName,                    
               "KindAcc_1"      , KindAcc,                       
               "BankName_2"     , "",                            
               "AdresBank_2"    , "",                            
               "PostBank_1"     , PostBank,                      
               "FIO_Bank_1"     , FIOBank,                       
               "NameGNI2"       , NameGNI,                       
               "NameClient_2"   , ClientName,                    
               "KindAcc_2"      , KindAcc,                       
               "PostBank_2"     , PostBank,                      
               "FIO_Bank_2"     , FIOBank
             );                       
   end;                                                               
   
  initBnkTemplReport("ReqChange.xls");
end;


MACRO PrintChangeAcc( chnga, wlmes, ncopy)
  return ReqChangeReport(chnga, wlmes).Print();
END;
