/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2006              */
/*                                                                      */
/*  Имя файла      : prbcbuy.mac                                        */
/*                                                                      */
/*  Описание       : Печать поручения на покупку валюты.                */
/*                                                                      */
/*  Программист    : Локтюшин В.Ю.                                      */
/*                                                                      */
/*  Создан         : 17.05.06                                           */
/*                                                                      */
/************************************************************************/
           
import prbc;

CONST SET_CHAR = "X", 
      UNSET_CHAR = "";

MACRO PrintBUYOrder(ncopy:integer):bool

  RECORD RecordAdress ( adress );

  ClearRecord( RecordAdress );
  НайтиЮридическийАдресСубъекта( pr_pmpaym.rec.Payer, RecordAdress );
  
  var   BuyCost :PrintBuyCost = PrintBuyCost(pr_pmrmprop, pr_pmpaym, pr_ps_bcord, pr_credit);

  ARRAY RBN, DC, DG;
  strsplit( BuyCost.RecBankName, RBN, 92, 42, 2 );  
  strsplit( BuyCost.DocComment,  DC,  92, 56, 2 );
  strsplit( BuyCost.DocGround,   DG,  92, 39, 2 );
   
  while(ncopy != 0)
  [
                            Поручение на покупку иностранной валюты
                               № ################ от ##########
                                 ----------------    ----------

     Наименование клиента: ############################################## ИНН ###################
                          ------------------------------------------------   ---------------------
     Адрес: #####################################################################################
           ---------------------------------------------------------------------------------------
     Ф.И.О. уполномоченного сотрудника: #########################################################
                                      ------------------------------------------------------------
     Должность ################################ Тел./факс: ######################################
              ----------------------------------          ----------------------------------------

     Расчетный счет № ########################
                      -------------------------
     Банк: ############################################# БИК ######### Кор/сч ###################
           ----------------------------------------------    ---------        --------------------
     Текущий валютный счет № ####################### в ##########################################
                             ---------------------------------------------------------------------
     ############################################################################################
     ---------------------------------------------------------------------------------------------
     Основание покупки валюты (код и наименование): ##### #######################################
                                                    ----------------------------------------------
     ############################################################################################
     ---------------------------------------------------------------------------------------------
     Документы, обосновывающие покупку : ########################################################
                                         ---------------------------------------------------------
     ############################################################################################
     ---------------------------------------------------------------------------------------------


     Просим #####################################################################################
            --------------------------------------------------------------------------------------
     - ##### продать нам иностранную валюту  по внутреннему курсу банка на дату совершения операции
     - ##### купить для нас иностранную валюту на биржевых торгах (торговая площадка ###########
                                                                                 ----------------,
     валюта торгов ################ ) по текущему курсу валютной биржи, но не выше* #############
                   ----------------                                                 --------------

     +------------------------------------+------------------------------------------------------+
     |Наименование и код покупаемой валюты|##### - ##############################################|
     +------------------------------------+------------------------------------------------------+
     |Сумма рублей, перечисленная на      |######################################################|
     |покупку валюты                      |######################################################|
     +------------------------------------+------------------------------------------------------+
     |Сумма покупаемой валюты             |######################################################|
     |                                    |######################################################|
     +------------------------------------+------------------------------------------------------+
     |Курс                                |######################################################|
     +------------------------------------+------------------------------------------------------+

     Купленную валюту просим зачислить на вышеуказанный текущий валютный счет.
     Сумму покрытия просим списать с нашего расчетного счета № ###################################
                                                               -----------------------------------
     Остаток неиспользованных средств просим вернуть на счет № ###################################
                                                               -----------------------------------
     * при покупке валюты через специализированную валютную биржу обязательно предварительное
     депонирование средств из расчета планового курса операции. В случае отсутствия курса,
     плановым признается курс равный официальному курсу ЦБ на дату проведения операции
     увеличенный на #### %
                   ------

          М.П.                                      Руководитель
                                                                     -----------------------------
                                                    Главный бухгалтер
                                                                     -----------------------------

     ------Заполняется банком---------------------------------------------------------------------

     +--------------------------------------+----------------------------------------------------+
     |Отметка отдела валютного контроля об  |                                                    |
     |обоснованности покупки валюты         |                                                    |
     +--------------------------------------+----------------------------------------------------+

     +--------------------------------------+----------------------------------------------------+
     |Дата исполнения                       |####################################################|
     +--------------------------------------+----------------------------------------------------+
     |Курс продажи                          |#####/#####          ###############################|
     +--------------------------------------+----------------------------------------------------+
     |Кросс-курс банка                      |#####/#####          ###############################|
     +--------------------------------------+----------------------------------------------------+
     |Сумма валюты к зачислению             |####################################################|
     +--------------------------------------+----------------------------------------------------+
     |Сумма рублей к списанию               |####################################################|
     +--------------------------------------+----------------------------------------------------+
     |Сумма рублевых средств к возврату     |####################################################|
     +--------------------------------------+----------------------------------------------------+

     Исполнитель                                                                  Дата ###########                              

  
  ]     
  (
   /*<В1>*/  BuyCost.PmrmNumber:c,   
   /*<В2>*/  BuyCost.PmrmDate:c,     
   /*<В3>*/  BuyCost.PrpmPayerName,
   /*<В4>*/  BuyCost.PrpmPayerINN, 
   /*<В5>*/  BuyCost.AdressFull,
   /*<В6>*/  BuyCost.BossFIO,      
   /*<В7>*/  BuyCost.BossPost,     
   /*<В8>*/  BuyCost.PhoneNumber,  
   /*<В9>*/  BuyCost.PayerAccount, 
   /*<В10*/  BuyCost.NameBank,     
   /*<В11*/  BuyCost.BankCode,     
   /*<В12*/  BuyCost.CorrAcc,      
   /*<В13*/  BuyCost.RecAccount,
   /*<В14*/  RBN(0),
             RBN(1),
   /*<В15*/  BuyCost.Cause,
   /*<В16*/  DG(0),
             DG(1),
   /*<В17*/  DC(0),    
             DC(1),
   /*<В10*/  BuyCost.NameBank,
   /*<В18*/  BuyCost.BankFundsF,   
   /*<В19*/  BuyCost.BankFundsS,   
   /*<В20*/  BuyCost.ShoteName,    
   /*<В21*/  BuyCost.FinistrExName, 
   /*<В22*/  BuyCost.LimRate,
   /*<В23*/  BuyCost.PayISOCode, 
   /*<В24*/  BuyCost.FinistrPayName,      
   /*<В25*/  BuyCost.Amount:c,      
   /*<В26*/  BuyCost.AmountS,       
   /*<В27*/  BuyCost.PayAmount:c,          
   /*<В28*/  BuyCost.PayAmountS,   
   /*<В29*/  BuyCost.TypeRate,
   /*<В9>*/  BuyCost.PayerAccount,     
   /*<В9>*/  BuyCost.PayerAccount,
   /*<30>*/  BuyCost.KoefDepS,   
   /*<В31*/  BuyCost.ExecDate,
   /*<В32*/  BuyCost.FIIDF,              
   /*<В33*/  BuyCost.FIIDS:l,         
   /*<В34*/  BuyCost.Rate:l,        
   /*<В35*/  BuyCost.FIID_RF,
   /*<В36*/  BuyCost.FIID_RS:l,         
   /*<В37*/  BuyCost.RateS:l,
   /*<В38*/  BuyCost.SatAmount:c,    
   /*<В39*/  BuyCost.Amount:c,       
   /*<В40*/  BuyCost.DepositRest:c,  
   /*<В41*/  BuyCost.ValueDate     
  );            
  ncopy = ncopy - 1;
  END;  
  return TRUE;
  
END;



/* Печать аккредитива */
MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind;

  if( DocKind != PS_BUYCURORDER )
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintBUYOrder(ncopy);
END;




   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
                                
                                               
                                              
                                               

