/*----------------------------------------------------------------------*/
/*         Автоматизированная банковская система RS-Bank                */
/*              Copyright (c) R-Style Software Lab                      */
/*                                                                      */
/*  Имя файла        : psposend.mac                                     */
/*                                                                      */
/*  Описание         : Выполнение шага по выгрузке рублевых платежей К2 */
/*                     в Лоанс                                          */
/*                                                                      */
/*  Программист      : Копачев Д.В.                                     */
/*                                                                      */
/*  Создан           : 21.09.04                                         */
/*                                                                      */
/*----------------------------------------------------------------------*/

import PaymInter;
import paym_rec; /* Pm_paym, Pm_rmprop, Pm_debet, Pm_credit */

RECORD  PartPmpaym( pmpaym );     /* ─┐                                                               */
RECORD  PartDebet ( pmprop );     /*  ├─ параметры платежного документа частичной оплаты картотеки №2 */
RECORD  PartCredit( pmprop );     /*  │                                                               */
RECORD  PartPmrmprop( pmrmprop ); /* ─┘                                                               */

RECORD  Pm_akkr( pmakkr );        /* аккредитив */

MACRO ExecuteStep( doc, payorder ):integer

  var payment:RsbPayment;

  if( Pm_paym.PaymentID ) // Частичная оплата
    payment = RsbPayment( PartPmpaym.PaymentID );
    /*
    else
    payment = RsbPayment( Pm_paym.PaymentID );
    end;
    */

    // Определяем бэк-офис - получатель платежа
    payment.ToBackOffice = "Ц";

    // Статус платежа меняем на "Готов к квитовке"
    payment.PaymStatus   = PM_KVITWAIT;

  end;  

  return 0;

END;
