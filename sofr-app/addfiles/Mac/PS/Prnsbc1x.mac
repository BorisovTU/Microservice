/*
$Name:        Prnsbc1x.mac
$Module:      РКО
$Description: Печать сообщения об изменении счёта.
*/

/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2014              */
/*                                                                      */
/*  Имя файла      : Prnsbc1x.mac                                       */
/*                                                                      */
/*  Релиз          : SBC1_510                                           */
/*                                                                      */
/*  Описание       : Печать сообщения об изменении счёта.               */
/*                                                                      */
/*  Программист    : Тимонин Д. В.                                      */
/*                                                                      */
/*  Создан         : 27.05.14                                           */
/*                                                                      */
/************************************************************************/

IMPORT "BnkTemplReport.mac";
IMPORT rqmeslib, prngni;

private class (BnkTemplReport)ReqChangeReport(p_chnga, p_wlmes)

  var chnga = p_chnga, wlmes = p_wlmes;

  MACRO Create()
    
    ОчиститьФормуСообщения();
    ЗаполнитьДанные(chnga, wlmes);

    SetSheetName( ReqAccount );

    SetValuesMultiCell( "FormKND"               , "1114301"          ,3    ,  7 , //form
                        "SeriesAndNum_1"        , SeriesAndNum       ,3    , 18 , //1
                        "TypeMes_1"             , TypeMes            ,3    ,  3 , //2
                        "CodeNOB_1"             , CodeNOB            ,3    ,  4 , //3
                        "IndexSV_1"             , IndexSV            ,3    ,  6 , //5
                        "BankRegNomSV_1"        , BankRegNomSV       ,3    ,  4 , //7
                        "BankNumber_1"          , BankNumber         ,3    ,  4 , //8
                        "BankBIC_1"             , BankBIC            ,3    ,  9 , //10
                        "BankINN_1"             , BankINN            ,3    , 10 , //11
                        "BankKPP_1"             , BankKPP            ,3    ,  9 , //12
                        "BankOGRN_1"            , BankOGRN           ,3    , 13 , //13
                        "ReqAccount_1"          , ReqAccount         ,3    , 20 , //14
                        "OpClAccDateD_1"        , OpAccDateD         ,3    ,  2 , //15
                        "OpClAccDateM_1"        , OpAccDateM         ,3    ,  2 , //15
                        "OpClAccDateY_1"        , OpAccDateY         ,3    ,  4 , //15
                        "DogAccNumber_1"        , DogAccNumber       ,3    , 20 , //16
                        "DogAccDateD_1"         , DogAccDateD        ,3    ,  2 , //17
                        "DogAccDateM_1"         , DogAccDateM        ,3    ,  2 , //17
                        "DogAccDateY_1"         , DogAccDateY        ,3    ,  4 , //17
                        "ClientCodeSV_1"        , ClientCodeSV       ,3    ,  1 , //19
                        "INNKIO_1"              , INNKIO             ,3    , 12 , //20
                        "KPP_1"                 , KPP                ,3    ,  9 , //21
                        "ORGRN_1"               , OGRN               ,3    , 15 , //22
                        "NumberAcc_1"           , NumberAcc          ,3    ,  1 , //23
                        "InfAbBank_1"           , InfAbBank          ,3    ,  1 , //24
                        "InfAbOrg_1"            , InfAbOrg           ,3    ,  1 , //25
                        "ReqAccountOld_1"       , ReqAccountOld      ,3    , 20 , //26
                        "ChngAccDateD_1"        , ChngAccDateD       ,3    ,  2 , //27
                        "ChngAccDateM_1"        , ChngAccDateM       ,3    ,  2 , //27
                        "ChngAccDateY_1"        , ChngAccDateY       ,3    ,  4 , //27
                        "IndexSVCHNG_1"         , IndexSVCHNG        ,3    ,  6 , //29
                        "BankRegNomSVCHNG_1"    , BankRegNomSVCHNG   ,3    ,  4 , //31
                        "BankNumberSVCHNG_1"    , BankNumberSVCHNG   ,3    ,  4 , //32
                        "BankBICSVCHNG_1"       , BankBICSVCHNG      ,3    ,  9 , //33
                        "BankINNSVCHNG_1"       , BankINNSVCHNG      ,3    , 10 , //34

                        "BankKPPSVCHNG_1"       , BankKPPSVCHNG      ,3    ,  9 , //35
                        "BankOGRNSVCHNG_1"      , BankOGRNSVCHNG     ,3    , 13 , //36
                        "ChngBnkDateD_1"        , ChngBnkDateD       ,3    ,  2 , //37
                        "ChngBnkDateM_1"        , ChngBnkDateM       ,3    ,  2 , //37
                        "ChngBnkDateY_1"        , ChngBnkDateY       ,3    ,  4 , //37
                        "ReorgOrg_1"            , ReorgOrg           ,3    ,  1 , //38 пропущен в проекте
                        "ChngSpAccOwner_1"      , ChngSpAccOwner     ,3    ,  1 , //49
                        "ChngFace_1"            , ChngFace           ,3    ,  1 , //39
                        "INNNPRO_1"             , INNNPRO            ,3    , 12 , //41
                        "KPPNPRO_1"             , KPPNPRO            ,3    ,  9 , //42
                        "OGRNNPRO_1"            , OGRNNPRO           ,3    , 15 , //43
                        "ChngNPDateD_1"         , ChngNPDateD        ,3    ,  2 , //44
                        "ChngNPDateM_1"         , ChngNPDateM        ,3    ,  2 , //44
                        "ChngNPDateY_1"         , ChngNPDateY        ,3    ,  4 , //44
                        "MessAccDateD_1"        , MessAccDateD       ,3    ,  2 , //47
                        "MessAccDateM_1"        , MessAccDateM       ,3    ,  2 , //47
                        "MessAccDateY_1"        , MessAccDateY       ,3    ,  4 , //47
                        "Phone_1"               , Phone              ,3    , 20   //48
                      );

    SetValues( "NameCOSV_1"          , NameCOSV         , // 4
               "BankAddrMNKO_1"      , BankAddrMNKO     , // 6
               "FullNameFIO_1"       , FullNameFIO      , // 18
               "NameCOSVOLD_1"       , NameCOSVOLD      , // 28
               "BankAddrMNKOCHNG_1"  , BankAddrMNKOCHNG , // 30
               "FullNameFIOSVOLD_1"  , FullNameFIOSVOLD , // 40
               "PostBank_1"          , PostBank         , // 45
               "FamPRB_1"            , FamPRB             // 46
             );
  END;                                                               
   
  initBnkTemplReport("ReqChangeBNK.xls");
end;

/* Макрос печати заявления на изменение реквизитов счета */
MACRO PrintDocument( mes, ncopy)
  var StatDoc:integer;
  SetBuff(wlmes, mes);
  //сначала ищем, какой документ будем печатать
  StatDoc = FindAllFile();
  if(StatDoc == 0)
    Msgbox("По данному документу не найдено заявление на|открытие (закрытие, изменение) счета");
    return true;
  else
    if( StatDoc == 3 )
      if(( GetKindRegOrgan() == REG_ORGAN_KIND_FNS ) or ( GetKindRegOrgan() == REG_ORGAN_KIND_NON ))
        ReqChangeReport(chnga, wlmes).Print();
      end;
    end;
  end;
  return TRUE;
END;
