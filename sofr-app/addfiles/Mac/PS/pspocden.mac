/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1999              */
/*                                                                      */
/*  Имя файла        : pspocden.mac                                     */
/*                                                                      */
/*  Описание         : Проверка двойным вводом                          */
/*                     рублевого платежного поручения                   */
/*  Программист      : Бурак В.Ю.                                       */
/*                                                                      */
/*  Создан           : 26.11.99                                         */
/*                                                                      */
/************************************************************************/


record          Pm_paym   ( pmpaym );
record          Pm_prop   ( pmprop );
record          Pm_rmprop ( pmrmprop );

record          DE_Pm_paym   ( pmpaym );
record          DE_Pm_prop   ( pmprop );
record          DE_Pm_rmprop ( pmrmprop );

macro ExecuteStep( )

    if((Pm_prop.BankCode != "") and ((Pm_prop.BankCode != DE_Pm_prop.BankCode) or (Pm_prop.CodeKind != DE_Pm_prop.CodeKind))) return -10;
    end;

    if(Pm_paym.ReceiverAccount != DE_Pm_paym.ReceiverAccount)  return -10;
    end;

    if(Pm_paym.PayerAccount != DE_Pm_paym.PayerAccount)  return -10;
    end;

    if(Pm_paym.Amount != DE_Pm_paym.Amount)  return -10;
    end;

    if(Pm_rmprop.Date != DE_Pm_rmprop.Date)  return -10;
    end;

    if(Pm_rmprop.Priority != DE_Pm_rmprop.Priority)  return -10;
    end;

    if(Pm_paym.NumberPack != DE_Pm_paym.NumberPack)  return -10;
    end;

        return 0;
end;
