/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : rqczscan.mac
  Created     : 05.10.2010
  Programmer  : Popova Olga
  Description : Печать отчета сканирования выполнения функции пользователя
                в заявлениях на открытие накопительного счета

└───────────────────────────────────────────────────────────────────────────*/
RECORD reqopnac( reqopnac );

const   Ошибка     = 0,
        Первый     = 1,
        Последний  = 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

   array StringArray;
   var i = 1;

   setbuff( reqopnac, firstdoc );

   if( Вызов == Первый )
[  Отчет о групповом выполнении функции пользователя для заявлений на открытие накопительного счета.];
[┌───────────────────────────┬────────┬──────────────────────────────────────────────────────────────┐];
[│        Номер счета        │ Номер  │                          Сообщение                           │];
[│                           │ ошибки │                                                              │];
[├───────────────────────────┼────────┼──────────────────────────────────────────────────────────────┤];
   elif( Вызов == Ошибка )

     if( Статус == 0 )
       Сообщение = "Функция выполнена успешно";
     end;
                         
     StrSplit( StrSubst( Сообщение, "|", " " ), StringArray, 56 );                
[│ ######################### │ ###### │ ############################################################ │]( reqopnac.Account:f, Статус, StringArray(0) );
     while( StrLen( StringArray(i) ) > 0 )
[│                           │        │ ############################################################ │]( StringArray(i) );
       i = i + 1;
     end;
        
   elif( Вызов == Последний ) 
[└───────────────────────────┴────────┴──────────────────────────────────────────────────────────────┘];
   end;

END;