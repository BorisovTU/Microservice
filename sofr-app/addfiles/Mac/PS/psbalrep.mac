/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6                        */
/****************************************************************************/
/*                          Подсистема "РКО"                                */
/*  Печать отчета контроля сообщений                                       */
/*                                                                          */
/*  Имя файла: psregdecrep.mac                                              */
/*  Создан:    31.08.11                                    Бердов Д.М.      */
/****************************************************************************/

import "wldoc.mac";

const Ошибка   = 0,
      Первый   = 1,
      Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff (wlregdec, firstdoc);

  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповой печати сообщений                                          ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   #####                                                       ]({oper});
    [                                                                               ];
    [+---------------------+------+------------------------------------------------------------+];
    [|       Номер         |Номер |                 Сообщение                                  |];
    [|      решения        |ошибки|                                                            |];
    [+---------------------+------+------------------------------------------------------------+];
  elif( Вызов == Ошибка )
    if( Статус == 0 )
      Сообщение = "Печать сообщения выполнена успешно";
    end;    
    [|#####################|######|############################################################|](wlregdec.number,Статус,StrSubst(Сообщение, "|", " " ):w);
  elif (Вызов==Последний)
    [+---------------------+------+------------------------------------------------------------+];
  end;
end;

