//-----------------------------------------------------------------------------
// Блок      : Вне блока
// Шаг       : Вне шага
// Назначение: Макрос скроллинга
// Описание  : Макрос скроллинга поручений на списание
//-----------------------------------------------------------------------------


import PaymInter, "rmcmptl.mac";

/* Установка подсказки для скролингов из макроса */

/* Хинт для списков по дате значения */
private const Hint_ByValueDate:string = 
"/*+FIRST_ROWS LEADING(t pmrmprop pmprop prop2 wlpm oproper) INDEX(t dpmpaym_dbt_idx11) INDEX(wlpm dwlpm_dbt_idx1) USE_NL(t pmrmprop pmprop prop2 wlpm oproper)*/";

/* Хинт для списков по статусу первички */
private const Hint_ByStatus:string = 
"/*+FIRST_ROWS LEADING(t pmrmprop pmprop prop2 wlpm oproper) INDEX(t dpmpaym_dbt_idx16) USE_NL(t pmrmprop pmprop prop2 wlpm oproper)*/";

/* Хинт для списков по символу шага */
private const Hint_ByStep     :string = 
"/*+FIRST_ROWS LEADING(oprstep oproper t pmrmprop pmprop prop2 wlpm) INDEX(oprstep doprstep_dbt_idx10) INDEX(t dpmpaym_dbt_idx0) USE_NL(oprstep oproper t pmrmprop pmprop prop2 wlpm)*/";

MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStates:integer, Symbol:string ):string

  /* Возможные значения ScrolStates
   20850 -  Все
   20851 -  Принятые
   20852 -  Обработанные
   20853 -  Отвергнутые
  */

  /* Все, принятые, обработанные */
  if( ( ScrolStates == 20850 ) or ( ScrolStates == 20851 ) or ( ScrolStates == 20852 ) )

    var dtflt:PMScrolDateFltr = PMScrolDateFltr();

    if( dtflt.IsSet( DTFL_VALUEDATE ) )
      return Hint_ByValueDate;
    else
      return Hint_ByStatus;
    end;
  
  elif( ScrolStates == 20853 )

    if( Symbol != "" )
      return Hint_ByStep;
    else 
      return Hint_ByStatus;
    end;

  end;

  return DefaultHint;

END;