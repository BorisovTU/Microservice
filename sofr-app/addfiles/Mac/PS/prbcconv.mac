/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2006              */
/*                                                                      */
/*  Имя файла      : prbcbuy.mac                                        */
/*                                                                      */
/*  Описание       : Печать поручения на покупку валюты.                */
/*                                                                      */
/*  Программист    : Локтюшин В.Ю.                                      */
/*                                                                      */
/*  Создан         : 17.05.06                                           */
/*                                                                      */
/************************************************************************/
           
import prbc;

CONST SET_CHAR = "X", 
      UNSET_CHAR = "";

MACRO PrintBUYOrder(ncopy:integer):bool

  RECORD RecordAdress ( adress );

  ClearRecord( RecordAdress );
  НайтиЮридическийАдресСубъекта( pr_pmpaym.rec.Payer, RecordAdress );
  
  var   BuyCost :PrintBuyCost = PrintBuyCost(pr_pmrmprop, pr_pmpaym, pr_ps_bcord, pr_credit);

   
  while(ncopy != 0)
  [
           
                             Поручение на ####### иностранной валюты
                                 № ################ от ##########
                                   ----------------    ----------

       Наименование клиента: ############################################## ИНН ####################
                            ------------------------------------------------   ---------------------
       Адрес: ######################################################################################
             ---------------------------------------------------------------------------------------
       Ф.И.О. уполномоченного сотрудника: ##########################################################
                                        ------------------------------------------------------------
       Должность ################################ Тел./факс: #######################################
                ----------------------------------          ----------------------------------------

       Текущий валютный счет № #########################
                               -------------------------
       Банк: ############################################# БИК ######### Кор/сч ####################
             ----------------------------------------------    ---------        --------------------

       Просим ######################################################################################
              --------------------------------------------------------------------------------------
       - ##### ####### иностранную валюту  по внутреннему курсу банка на дату совершения операции
       - ##### ####### иностранную валюту на биржевых торгах (торговая площадка #####################
                                                                               --------------------,
       по текущему курсу валютной биржи, но не ##### ###############
                                                     ---------------

       +-------------------------------------+-----------------------------------------------------+
       |Наименование и код продаваемой валюты|##### - #############################################|
       +-------------------------------------+-----------------------------------------------------+
       |Сумма продаваемой валюты             |#####################################################|
       |                                     |#####################################################|
       +-------------------------------------+-----------------------------------------------------+
       |Наименование и код покупаемой валюты |##### - #############################################|
       +-------------------------------------+-----------------------------------------------------+
       |Сумма покупаемой валюты              |#####################################################|
       |                                     |#####################################################|
       +-------------------------------------+-----------------------------------------------------+
       |Курс                                 |#####################################################|
       +-------------------------------------+-----------------------------------------------------+

       Зачисляемую валюту просим перевести на текущий валютный счет № ##############################
                                                                     -------------------------------
       в ###########################################################################################
         -------------------------------------------------------------------------------------------
       Сумму покрытия просим списать с нашего текущего валютного счета № ###########################
                                                                         ---------------------------
       Остаток неиспользованных средств просим вернуть на счет № ###################################
                                                                 -----------------------------------


            М.П.                                      Руководитель
                                                                       -----------------------------
                                                      Главный бухгалтер
                                                                       -----------------------------

       ------Заполняется банком---------------------------------------------------------------------

       +--------------------------------------+----------------------------------------------------+
       |Дата исполнения                       |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Кросс-курс                            |#####/#####       ##################################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма валюты к зачислению             |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма валюты к списанию               |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма валюты к возврату               |####################################################|
       +--------------------------------------+----------------------------------------------------+

       Исполнитель                                                                  Дата ###########

  ]     
  (
   /* <В42>*/ IfThenElse( BuyCost.ConvOper, "покупку", "продажу" ),
   /* <В1> */ BuyCost.PmrmNumber,   
   /* <В2> */ BuyCost.PmrmDate,     
   /* <В3> */ BuyCost.PrpmPayerName,
   /* <В4> */ BuyCost.PrpmPayerINN, 
   /* <В5> */ BuyCost.AdressFull,   
   /* <В6> */ BuyCost.BossFIO,      
   /* <В7> */ BuyCost.BossPost,     
   /* <В8> */ BuyCost.PhoneNumber,  
   /* <В9> */ BuyCost.RecAccount, 
   /* <В10>*/ BuyCost.NameBank,     
   /* <В11>*/ BuyCost.BankCode,     
   /* <В12>*/ BuyCost.CorrAcc,      
   /* <В10>*/ BuyCost.NameBank,   
   /* <В18>*/ BuyCost.BankFundsF,  
   /* <В43>*/ IfThenElse( BuyCost.ConvOper, "продать нам", "купить у нас" ),        
   /* <В19>*/ BuyCost.BankFundsS,     
   /* <В44>*/ IfThenElse( BuyCost.ConvOper, "купить", "продать" ),   
   /* <В20>*/ BuyCost.ShoteName,     
   /* <В45>*/ IfThenElse( BuyCost.ConvOper, "выше", "ниже" ),   
   /* <В22>*/ BuyCost.LimRate,   
   /* <В23>*/ BuyCost.ISOCode,    
   /* <В24>*/ BuyCost.FinistrName, 
   /* <В25>*/ BuyCost.Amount:c,      
   /* <В26>*/ BuyCost.AmountS,           
   /* <В46>*/ BuyCost.PayISOCode, 
   /* <В47>*/ BuyCost.FinistrPayName,        
   /* <В27>*/ BuyCost.PayAmount:c,            
   /* <В28>*/ BuyCost.PayAmountS,    
   /* <В29>*/ BuyCost.TypeRate,   
   /* <В48>*/ BuyCost.RecAccount,         
   /* <В14>*/ BuyCost.RecBankName,     
   /* <В13>*/ BuyCost.PayerAccount, 
   /* <В13>*/ BuyCost.PayerAccount,           
   /* <В31>*/ BuyCost.ExecDate,         
   /* <В32>*/ BuyCost.FIID_FF,        
   /* <В33>*/ BuyCost.FIID_FS:l,         
   /* <В34>*/ BuyCost.Rate:l,         
   /* <В38>*/ BuyCost.SatAmount:c,      
   /* <В39>*/ BuyCost.Amount:c,        
   /* <В40>*/ BuyCost.DepositRest:c,    
   /* <В41>*/ BuyCost.ValueDate       
         
  );                
  ncopy = ncopy - 1;
  END;  
  return TRUE;
  
END;



/* Печать аккредитива */
MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind;

  if( DocKind != PS_BUYCURORDER )
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintBUYOrder(ncopy);
END;



                                         






































                                               



                               

