/********************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6.0                          */
/********************************************************************************/
/*                  Подсистема "РКО"                                            */
/* Печать отчета сканирования массового отката обработки решения рег.органа     */
/*                                                                              */
/*  Имя файла: psbckrpo.mac                                                     */
/*  Создан:    25.04.11                                  Popova O.              */
/********************************************************************************/
IMPORT /*globals,*/"wlmnstls.mac";

const  Ошибка   = 0,
       Первый   = 1,
       Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  if( Вызов == Первый )
[           
        Отчет о групповом откате обработки решений регистрационных органов           

  Дата обработки:  ##########  ########
  Операционист:  ####
 ┌───────────────┬─────────────┬────────────────────────────────────────────────────────────┐  
 │ Номер решения │Номер ошибки │                      Сообщение                             │  
 │               │             │                                                            │
 ├───────────────┼─────────────┼────────────────────────────────────────────────────────────┤]( date(), time(), {Oper} );
  elif( Вызов == Ошибка )       

    setbuff( wlregdec, firstdoc );
    if( Статус == 0 )
      Сообщение = "Откат обработки решения выполнен успешно";
    end;
    if( Статус == 31908 ) //Справка об остатках успешно удалена ( T_PS_DELFNSINFOSUCCESS )
      Статус = 0;
    end;
[│###############│#############│############################################################│](wlregdec.Number, Статус, StrSubst( Сообщение, "|", " " ):w );

  elif( Вызов == Последний )
[└───────────────┴─────────────┴────────────────────────────────────────────────────────────┘];
  end;

END;