/*
$Name:        chktero.mac
$Module:      РКО 
$Description: Макрос шага Проверка на терроризм
*/
/* -------------------------------------------------------------------- */
/*         Автоматизированная банковская система RS-Bank v6.0           */
/*                 Copyright (c) R-Style Software Lab                   */
/*                                                                      */
/*  Имя файла  : chktero.mac                                            */
/*                                                                      */
/*                                                                      */
/*  Программист: Popova O.                                              */
/*  Переписан  : 13.12.2010                                             */
/*  Описание   : Операция - 3030   - "Открытие лицевого счета"          */
/*               Блок     - 303001 - "Проверка на терроризм"            */
/*               Шаг      - 10     - "Проверка на терроризм"            */
/*                                                                      */
/* -------------------------------------------------------------------- */

import PSInter, FMInter, oralib, InsCarryDoc;

var ReqOpenAccObj:RsbReqOpenAcc;

private const Denial    = "Передать в финмониторинг ";

MACRO ExecuteStep( doc, pmDoc )
  if (FM_CheckTerrorPartyFull(ReqOpenAccObj.ClientID, Denial))
    ReqOpenAccObj.DenialOpen   = "X";
    ReqOpenAccObj.DenialReason = 3;/*наличие в отношении заявителя сведений об участии в терроризме*/
    if( not InsertOprStatus( REQOPENA_ST_KIND_OO, REQOPENA_ST_OO_YES ) ) 
      MsgBox( "Ошибка при установке статуса операции" );
      return 1;
    end;
  end;
  if( not InsertOprStatus( REQOPENA_ST_KIND_PT, REQOPENA_ST_PT_NOTNEED ) ) 
     MsgBox( "Ошибка при установке статуса операции" );
     return 1;
  end;
  return 0;
END;
