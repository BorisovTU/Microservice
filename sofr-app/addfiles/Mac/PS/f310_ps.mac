/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : form310ps.mac                             Jule 6,2002
  Programmer  : Андреева Е.
  Description : Отчет по картотеке к внебалансовому счету 90902 (форма 310)
                (вызывающий макрос)
└───────────────────────────────────────────────────────────────────────────*/

//import "form310.mac";
import globals;

var RealPlanNum, PrintForm, Export_, KliExport_;

/* Возможно, в дальнейшем эти настройки будут определяться иначе*/
RealPlanNum = 0;
PrintForm   = true;
Export_     = false;
KliExport_  = false;

/*getRegistryValue( "REPTCB\\REP_GROUPS\\ФОРМА 310\\ПЕЧАТНАЯ ФОРМА",
                  V_BOOL, PrintForm, NULL );
getRegistryValue( "REPTCB\\REP_GROUPS\\ФОРМА 310\\ЭКСПОРТ",
                  V_BOOL, Export_, NULL );*/

 array ArMenu;
 var M, Y, МесяцОтчетный;
 var RepDat;

  ArMenu( 0) = " январь ";
  ArMenu( 1) = " февраль ";
  ArMenu( 2) = " март ";
  ArMenu( 3) = " апрель ";
  ArMenu( 4) = " май ";
  ArMenu( 5) = " июнь ";
  ArMenu( 6) = " июль ";
  ArMenu( 7) = " август ";
  ArMenu( 8) = " сентябрь ";
  ArMenu( 9) = " октябрь ";
  ArMenu(10) = " ноябрь ";
  ArMenu(11) = " декабрь ";


      МесяцОтчетный = Menu( ArMenu, " ~Выберите отчетный период~", "") + 1;
      if ( МесяцОтчетный < 1 ) exit( 1 ); end;
      
      datesplit( {curdate}, null, M, Y );
      if ( МесяцОтчетный > M )   Y = Y - 1;  end;
      if ( not getInt( Y, "Введите год:", 4 ) )           
        exit( 1 ); end;
      
      if ( МесяцОтчетный < 12 ) RepDat = date( 1, МесяцОтчетный+1, Y );
      else                      RepDat = date( 1, 1, Y+1 );
      end;

//MainProc_form310( RealPlanNum, PrintForm, Export_, KliExport_, false, МесяцОтчетный );
exit(1);