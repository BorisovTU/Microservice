/* ╔══════════════════════════════════════════════════════════════════╗ */
/*         Автоматизированная банковская система RS-Bank v5.0           */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : psi2part.mac                                     */
/*                                                                      */
/*  Описание         : Зачисление внутреннего частичного                */
/*  Программист      : Гуров В.В.                                       */
/*                                                                      */
/*  Создан           : 25.06.02                                         */
/*                                                                      */
/* ╚══════════════════════════════════════════════════════════════════╝ */

import  InsCarryDoc, OprInter, FIInter, payconst, PaymInter, PTInter;
import  paym_rec; /* Pm_paym, Pm_rmprop, Pm_debet, Pm_credit */

RECORD  PartPmpaym( pmpaym );     /* ─┐                                                               */
RECORD  PartDebet ( pmprop );     /*  ├─ параметры платежного документа частичной оплаты картотеки №2 */
RECORD  PartCredit( pmprop );     /*  │                                                               */
RECORD  PartPmrmprop( pmrmprop ); /* ─┘                                                               */

RECORD  d( arhdoc );

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteStep( doc, payorder )

  if( (PartPmpaym.PaymentID) and (PartCredit.Group != PAYMENTS_GROUP_EXTERNAL) )
     if( not InsertPaymentStat( PartPmpaym.PaymentID, PM_FINISHED ) )
        msgbox( "Ошибка при обновлении статуса платежа" );
        return 1;
     end;
  end;

  return 0;

END;
