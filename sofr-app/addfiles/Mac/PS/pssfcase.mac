/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*  Имя файла        : pssfcase.mac                                     */
/*  Описание         : Шаг - проверка необходимости квитовки/проводки   */
/*  Программист      : AAV                                              */
/*  Создан           : 14.11.02                                         */
/************************************************************************/

import "payconst.mac", OprInter;
import  paym_rec; /* Pm_paym, Pm_rmprop, Pm_debet, Pm_credit */

RECORD  Ps_payord( pspayord );
RECORD  Ps_paydem( pspaydem ); /* параметры требования */

const Menu1    = " Квитовать c фактическим  ";
const Menu2    = " Выполнить проводку";
const Menu3    = " Поместить в закрытые";
const Menu4    = " Отмена";
const MenuName = "Действия c платежом:";

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, pspayord, KindDoc)

  var menu_item;

  menu_item = Opr_MakeChoice(Menu1, Menu2, Menu3, Menu4, MenuName);

  if( menu_item == 0 )
    return string(ПЗО_НомерШагаКвитовка);
  elif ( menu_item == 1)
    return string(ПЗО_НомерШагаПроводка);
  elif ( menu_item == 2)
    return string(ПЗО_НомерШагаИсполнить);
  else
    return 1;
  end;

END;


