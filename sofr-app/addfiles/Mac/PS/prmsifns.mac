/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : pmmsifns.mac
  Created     : 11.11.2011
  Description : Отчет сканирования массовой печати справок в ФНС
└───────────────────────────────────────────────────────────────────────────*/

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlregdec ( wlregdec );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlregdec, firstdoc );

  if( Вызов==Первый )
[                    Отчет о групповой печати документов.                       ];
[┌─────────┬──────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                        Сообщение                           │];
[│документа│ошибки│                                                            │];
[├─────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif (Вызов==Ошибка)

    if(Статус == 0)
      Сообщение = "Документ успешно напечатан";
    end;

[│#########│######│############################################################│]( rwlregdec.DecisionID(), Статус, StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└─────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
