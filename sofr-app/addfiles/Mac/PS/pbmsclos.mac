/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : pbmsclos.mac
  Created     : 16.03.2012
  Programmer  : Popova O. 
  Description : Отчет сканирования массового закрытия подтверждений банка
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlresprm ( wlresprm );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlresprm, firstdoc );

  if( Вызов == Первый )
[                 Отчет о групповом закрытии подтверждений.                     ];
[┌─────────────┬──────┬────────────────────────────────────────────────────────────┐];
[│    Номер    │Номер │                        Сообщение                           │];
[│подтверждения│ошибки│                                                            │];
[├─────────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif( Вызов == Ошибка )

    if( Статус == 0 )
      Сообщение = "Документ успешно закрыт";
    end;

[│#############│######│############################################################│]( rwlresprm.ResultID, Статус, StrSubst( Сообщение, "|", " " ):w );

  elif( Вызов == Последний )
[└─────────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
