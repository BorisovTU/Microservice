/*
  $Name:        AccOperations.mac
  $Module:      РКО
  $Description: Функции и классы для работы с клиентскими счетами
*/
//-----------------------------------------------------------------------------
//          Автоматизированная банковская система RS-Bank               
//                 Copyright (c) R-Style Software Lab
//
// Подсистема   : РКО
//
// Описание     : Функции и классы для работы с клиентскими счетами
//
// Программист  : Чукина Т.А.
//
// Создан       : 24.10.2015
//
//-----------------------------------------------------------------------------

import globals, likepy, oralib, "rsberror.mac", "bnk_common.mac", CTInter;

const RegOpenAcc = "PS\\REQOPENACC\\OPERATION\\";


MACRO GetRegValForOPENAC( Setup:string, Type, RegVal ):integer
   
   var stat:integer = 0;

   var RegStr:string = RegOpenAcc + Setup;

   var RegValue;
  
   if( Type == GetRegistryValue( RegStr, Type, RegValue, stat ) )
     SetParm( 2, RegValue );
   end;

   return stat;

END;

MACRO ReadNoteForAccount( Account:string, FIID:integer, NoteKind:integer ):string

  RECORD AccIn ( account ); 

  ClearRecord( AccIn );
 
  AccIn.Account = Account;
  AccIn.Code_Currency = FIID;
  AccIn.Chapter       = 1;

  var OBID:string = UniID( AccIn, OBJTYPE_ACCOUNT );

  // Заполнить примечание
  return readNoteForObject( OBJTYPE_ACCOUNT, OBID, NoteKind );

END;

MACRO Fns_NeedFindClientByClosedINN : bool
  var RegPath : string = RegOpenAcc + "365-П\\ПоискКлиента_ЗакрИНН";

  var NeedSearchClosedINN : bool = Bnk_GetRegistryValue(RegPath, V_BOOL, false);

  return NeedSearchClosedINN;
END;
