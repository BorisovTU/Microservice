/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                         R-Style Software Lab

  File Name   : psbciprn.mac
  Created     : 30.04.04
  Description : Отчет печати Ответный платеж РКО

└───────────────────────────────────────────────────────────────────────────*/
IMPORT  PaymInter, OprInter;

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов,firstdoc,Статус,Сообщение )
   array StringArray;
   var i = 1;
   var stat;

   record pm_paym (pmpaym);

   setbuff (pm_paym,firstdoc);

   var frmprop:TBFile = TBFile("pmrmprop.dbt", "R", 0);

        if (Вызов==Первый)
[              Отчет о групповой печати ответных платежей РКО                   ];
[+---------+------+------------------------------------------------------------+];
[|  Номер  |Номер |                 Сообщение                                  |];
[|документа|ошибки|                                                            |];
[+---------+------+------------------------------------------------------------+];
        elif (Вызов==Ошибка)

          if (Статус == 0)
            Сообщение = "Печать выполнена успешно";
          end;
          frmprop.rec.PaymentID = pm_paym.PaymentID;
          if( not frmprop.GetEQ() )
            Статус = 1;
            Сообщение = "Не найден платежный документ";
          end;
          StrSplit(StrSubst(Сообщение, "|", " " ), StringArray, 56);                        
[|#########|######|############################################################|](frmprop.rec.Number,Статус,StringArray(0));
          while ( StrLen(StringArray(i) ) > 0)
[|         |      |############################################################|](StringArray(i));
            i = i + 1;
          end;

        elif (Вызов==Последний)
[+---------+------+------------------------------------------------------------+];
        end;
END;