/************************************************************************/
/*         Автоматизированная банковская система RS-Bank v5.1           */
/*                 Copyright (c) R-Style Software Lab 1999              */
/*                                                                      */
/*  Описание         : Определение необходимости внебалансового учета   */
/*                                                                      */
/************************************************************************/
import  OprInter;

macro   ExecuteCaseStep(OperationKind, StepNumber, Document, DocKind)

        record  bo(ps_bcord);
        VAR     ReturnString = "";
        VAR     dateOp, dateVal;
        VAR     stat = 0;

        setbuff( bo, Document);

        /*  Получить дату начала операции */
        GetOprDate( 0, dateOp);

        /*  Получить дату исполнения заявки */
        GetOprDate( 1, dateVal );

        if ( dateOp < dateVal )
                /*  Необходим внебалансовый учет */
                return  "50";
        end;
        
        if ( dateOp  ==  dateVal )
                /*  Сразу исполение заявки */
                return  "60";
        end;

        MsgBox( "Дата заявки не может превышать дату исполнения заявки" );
        return  "";

END;
