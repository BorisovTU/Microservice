/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : psakrec.mac                                      */
/*                                                                      */
/*  Описание         : Шаг - Запись в журнале исходящих документов      */
/*                     модуля "Аккредитивы"                             */
/*                                                                      */
/*                                                                      */
/*  Создан           : 20.12.00                                         */
/*                                                                      */
/************************************************************************/
import  InsCarryDoc, OprInter, FIInter, payconst, PaymInter, PTInter, paym_rec;

RECORD  Ps_payord( pspayord );
RECORD  Pm_akkr ( pmakkr );  /* параметры аккредитива */

/**********************************/
/* Выполнение шага                */
/**********************************/

MACRO ExecuteStep( doc, payorder )
   var stat;

   setbuff(Ps_payord, payorder);


   /*после всего*/
   if( (Pm_credit.PaymentID == Pm_paym.PaymentID) and (Pm_credit.Group == PAYMENTS_GROUP_EXTERNAL) )
     stat = InsertPaymentStat( Pm_paym.PaymentID, PM_READY_TO_SEND );
   else
     stat = InsertPaymentStat( Pm_paym.PaymentID, PM_FINISHED );
   end;

   if (not stat)
      msgbox("Ошибка при изменении статуса платежа");
      return 1;
   end;

   return 0;

END;


