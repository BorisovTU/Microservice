/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : pbmsback.mac
  Created     : 16.03.2012
  Programmer  : Popova O. 
  Description : Отчет сканирования массового возврата в отложенные
                подтверждений банка
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlresprm ( wlresprm );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlresprm, firstdoc );

  if( Вызов == Первый )
[             Отчет о групповом возврате в отложенные подтверждений.                ];
[┌─────────────┬──────┬────────────────────────────────────────────────────────────┐];
[│    Номер    │Номер │                        Сообщение                           │];
[│подтверждения│ошибки│                                                            │];
[├─────────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif( Вызов == Ошибка )

    if( Статус == 0 )
      Сообщение = "Документ успешно возвращен в отложенные";
    end;

[│#############│######│############################################################│]( rwlresprm.ResultID, Статус, StrSubst( Сообщение, "|", " " ):w );

  elif( Вызов == Последний )
[└─────────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
