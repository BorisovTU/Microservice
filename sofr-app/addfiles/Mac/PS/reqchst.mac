/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : reqchst.mac
  Created     : 15.11.2004
  Description : Печать отчета сканирования группового старта операций
                распоряжений на изменение номера счета

└───────────────────────────────────────────────────────────────────────────*/
IMPORT PaymInter;

RECORD req_firstdoc( reqchnga );

const  Ошибка   = 0,
       Первый   = 1,
       Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )
  var stat;
  array StringArray;
  var i = 1;

  setbuff( req_firstdoc, firstdoc );

  if( Вызов==Первый )
[                      Отчет о групповом создании операций                      ];
[                   для распоряжений на изменение номера счета                  ];
[+---------+------+------------------------------------------------------------+];
[|  Номер  |Номер |                 Сообщение                                  |];
[|документа|ошибки|                                                            |];
[+---------+------+------------------------------------------------------------+];
  elif( Вызов==Ошибка )

    if( Статус == 0 )
      Сообщение = "Операция создана успешно";
    end;

    StrSplit(StrSubst(Сообщение, "|", " " ), StringArray, 56);

[|#########|######|############################################################|]( req_firstdoc.Number, Статус, StringArray(0) );
         while ( StrLen(StringArray(i) ) > 0)
[|         |      |############################################################|]( StringArray(i) );
           i = i + 1;
         end;

  elif( Вызов==Последний )
[+---------+------+------------------------------------------------------------+];
  end;
END;