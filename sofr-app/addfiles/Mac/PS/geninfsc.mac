/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : geninfsc.mac
  Created     : 31.10.2011
  Programmer  : Popova O. 
  Description : Печать отчета сканирования массовой генерации справок ФНС 
└───────────────────────────────────────────────────────────────────────────*/
const  Ошибка   = 0,
       Первый   = 1,
       Последний= 2;

RECORD rgd_firstdoc ( wlregdec );

import WldInter;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rgd_firstdoc, firstdoc );

  if( Вызов == Первый )
[


            Отчет о групповой генерации справок об остатках на счетах.          ];
[┌─────────┬──────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                        Сообщение                           │];
[│документа│ошибки│                                                            │];
[├─────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif( Вызов == Ошибка )

    if( Статус == 0 )
      Сообщение = "Справка успешно создана.";
    end;
    Сообщение = Сообщение + "\n" + GetFNSInfMassProcessWarning();
[│#########│######│############################################################│]( rgd_firstdoc.Number, Статус, StrSubst( Сообщение, "|", " " ):w );
  elif( Вызов == Последний )
[└─────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;

END;