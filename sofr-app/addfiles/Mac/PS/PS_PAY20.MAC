/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : ps_pay20.mac                                     */
/*                                                                      */
/*  Описание         : Проводка операционного документа по рублевому    */
/*                     платежному поручению                             */
/*  Программист      : Зайцев А.В.                                      */
/*                                                                      */
/*  Создан           : 12.12.98                                         */
/*                                                                      */
/************************************************************************/
import  InsCarryDoc, OprInter, FIInter, globals;


macro ExecuteStep( doc, payorder )
/*     var error,;
     record  d(arhdoc);
     record  p(payorder);

     SetBuff( d, doc );
     SetBuff( p, payorder );

     d.Chapter = 1;
     d.Code_Currency = p.FIID;
     d.Numb_Document = p.Number;

     d.Account_Payer = p.Account_Payer;
     d.Account_Receiver = p.Account_Receiver;

     d.Sum = p.Sum;

     d.Ground = p.Ground;

     d.Date_Carry = {curdate};

     d.Shifr_Oper = p.Shifr_Oper;
     d.Result_Carry = 1;
     d.Kind_Oper = " 1";
     d.Department = p.Department;

     if(  p.FIID == 0 ) /* Платеж в национальной валюте */
              InsertRubDocument();
     else
              InsertCurDocument();
     end;

/*****************************************************
Здесь можно вставлять дополнительные проводки для шага
*****************************************************/
*/
     return 0;

end;
