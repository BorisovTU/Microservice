/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2006              */
/*                                                                      */
/*  Имя файла      : prbcbuy.mac                                        */
/*                                                                      */
/*  Описание       : Печать поручения на покупку валюты.                */
/*                                                                      */
/*  Программист    : Локтюшин В.Ю.                                      */
/*                                                                      */
/*  Создан         : 17.05.06                                           */
/*                                                                      */
/************************************************************************/
           
import prbc;


MACRO PrintSELLrder(ncopy:integer):bool

  RECORD RecordAdress ( adress );

  ClearRecord( RecordAdress );
  НайтиЮридическийАдресСубъекта( pr_pmpaym.rec.Payer, RecordAdress );
  
  var   BuyCost :PrintBuyCost = PrintBuyCost(pr_pmrmprop, pr_pmpaym, pr_ps_bcord, pr_credit);

  ARRAY SellBankName;
  strsplit( BuyCost.SellBankName, SellBankName, 93, 49, 2 );  
   
  while(ncopy != 0)
  [
                            Поручение на продажу иностранной валюты
                                 № ################ от ##########
                                   ----------------    ----------

       Наименование клиента: ############################################## ИНН ####################
                            ------------------------------------------------   ---------------------
       Адрес: ######################################################################################
             ---------------------------------------------------------------------------------------
       Ф.И.О. уполномоченного сотрудника: ##########################################################
                                        ------------------------------------------------------------
       Должность ################################ Тел./факс: #######################################
                ----------------------------------          ----------------------------------------

       Текущий валютный счет № #########################
                               -------------------------
       Банк: ############################################# БИК ######### Кор/сч ####################
             ----------------------------------------------    ---------        --------------------
       Расчетный счет № ######################## в #################################################
                        ----------------------------------------------------------------------------
       #############################################################################################
       ---------------------------------------------------------------------------------------------


       Просим ######################################################################################
              --------------------------------------------------------------------------------------
       - ##### купить у нас иностранную валюту  по внутреннему курсу банка на дату совершения операции
       - ##### продать иностранную валюту на биржевых торгах (торговая площадка ###################
                                                                               --------------------,
       по текущему курсу валютной биржи, но не ниже ###############
                                                    ---------------

       +-------------------------------------+-----------------------------------------------------+
       |Наименование и код продаваемой валюты|##### - #############################################|
       +-------------------------------------+-----------------------------------------------------+
       |Сумма продаваемой валюты             |#####################################################|
       |                                     |#####################################################|
       +-------------------------------------+-----------------------------------------------------+
       |Сумма рублей, полученных от продажи  |#####################################################|
       |валюты                               |#####################################################|
       +-------------------------------------+-----------------------------------------------------+
       |Курс                                 |#####################################################|
       +-------------------------------------+-----------------------------------------------------+

       Вырученные рубли просим зачислить на вышеуказанный расчетный счет.
       Сумму покрытия просим списать с нашего текущего валютного счета № ###########################
                                                                         ---------------------------
       Остаток неиспользованных средств просим вернуть на счет № ###################################
                                                                 -----------------------------------


            М.П.                                      Руководитель
                                                                       -----------------------------
                                                      Главный бухгалтер
                                                                       -----------------------------

       ------Заполняется банком---------------------------------------------------------------------

       +--------------------------------------+----------------------------------------------------+
       |Дата исполнения                       |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Курс покупки                          |#####/#######           ############################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма рублей к зачислению             |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма валюты к списанию               |####################################################|
       +--------------------------------------+----------------------------------------------------+
       |Сумма валюты к возврату               |####################################################|
       +--------------------------------------+----------------------------------------------------+

       Исполнитель                                                                  Дата ###########

  ]     
  (
     /*<В1> */  BuyCost.PmrmNumber:c,
     /*<В2> */  BuyCost.PmrmDate:c,
     /*<В3> */  BuyCost.PrpmPayerName,
     /*<В4> */  BuyCost.PrpmPayerINN,
     /*<В5> */  BuyCost.AdressFull,
     /*<В6> */  BuyCost.BossFIO,
     /*<В7> */  BuyCost.BossPost,
     /*<В8> */  BuyCost.PhoneNumber,
     /*<В13>*/  BuyCost.PayerAccount,
     /*<В10>*/  BuyCost.NameBank,
     /*<В11>*/  BuyCost.BankCode,
     /*<В12>*/  BuyCost.CorrAcc,
     /*<В9> */  BuyCost.RecAccount,
     /*<В14>*/  SellBankName(0),
                SellBankName(1),
     /*<В10>*/  BuyCost.NameBank,
     /*<В18>*/  BuyCost.BankFundsF,
     /*<В19>*/  BuyCost.BankFundsS,
     /*<В20>*/  BuyCost.ShoteName,
     /*<В22>*/  BuyCost.LimRate,
     /*<В23>*/  BuyCost.ISOCode,
     /*<В24>*/  BuyCost.FinistrName,
     /*<В25>*/  BuyCost.Amount:c,
     /*<В26>*/  BuyCost.AmountS,   
     /*<В27>*/  BuyCost.PayAmount:c, 
     /*<В28>*/  BuyCost.PayAmountS,
     /*<В29>*/  BuyCost.TypeRate,
     /*<В13>*/  BuyCost.PayerAccount,
     /*<В13>*/  BuyCost.PayerAccount,
     /*<В31>*/  BuyCost.ExecDate,
     /*<В32>*/  BuyCost.FIIDF,
     /*<В33>*/  BuyCost.FIIDS:l,
     /*<В34>*/  BuyCost.Rate:l,
     /*<В38>*/  BuyCost.SatAmount:c,
     /*<В39>*/  BuyCost.Amount:c,
     /*<В40>*/  BuyCost.DepositRest:c,
     /*<В41>*/  BuyCost.ValueDate
    
  );            
  ncopy = ncopy - 1;
  END;  
  return TRUE;
  
END;

           
           
/* Печать аккредитива */
MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind;

  if( DocKind != PS_BUYCURORDER )
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintSELLrder(ncopy);
END;

           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           
           











                                 

                                               
                                               


   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
                                
                                               
                                              
                                               

