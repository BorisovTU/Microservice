/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : psiwpscn.mac
  Created     : 18.02.2008
  Programmer  : Осмаковский Е.В.
  Description : Печать отчета сканирования о массовой оплате картотеки ОР

└───────────────────────────────────────────────────────────────────────────*/
IMPORT  PaymInter, OprInter;

RECORD rec_psiwpacc (psiwpacc);

const   ПечатьЗаписи = 0,
        Первый       = 1,
        Последний    = 2;


MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
   var stat;
   array StringArray;
   var i = 1;

        setbuff (rec_psiwpacc,firstdoc);

        if (Вызов==Первый)
[                  Отчет о выполнении массовой оплаты по картотеке ожидания разрешений                ];
[                                                                                                     ];
[┌───────────────────────────┬────────┬───────────────────────┬───────────────────────────────────────┐];
[│       Лицевой счет        │ Кол-во │   Сумма документов    │       Результат выполнения оплаты     │];
[│                           │ док-ов │       к оплате        │                                       │];
[├───────────────────────────┼────────┼───────────────────────┼───────────────────────────────────────┤];
        elif (Вызов == ПечатьЗаписи)

          if (Статус == 0)
            Сообщение = "Документы переданы на исполнение";
          elif (Статус == 445)
            Сообщение = "Запрещено дебетование счета";
          end;

[│ ######################### │ ###### │ ##################### │ ##################################### │](rec_psiwpacc.Account, rec_psiwpacc.DocCount, rec_psiwpacc.Sum, StrSubst(Сообщение, "|", " " ):w);
        elif (Вызов==Последний)
[└───────────────────────────┴────────┴───────────────────────┴───────────────────────────────────────┘];
        end;
END;
