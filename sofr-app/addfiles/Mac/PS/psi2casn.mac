/* ╔══════════════════════════════════════════════════════════════════╗ */
/*         Автоматизированная банковская система RS-Bank v5.0           */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : psi2case.mac                                     */
/*                                                                      */
/*  Описание         : Выполнение шага по                               */
/*                     построению списка шагов в картотеке N2           */
/*                                                                      */
/*  Программист      : Андреева Е.П.                                    */
/*                                                                      */
/*  Создан           : 27.11.2002                                       */
/*                                                                      */
/* ╚══════════════════════════════════════════════════════════════════╝ */
import payconst;
import BankInter;/*PSPO_ST_...*/
import "paym_rec.mac";

RECORD  PartPmpaym( pmpaym );     /* ─┐                                                               */
RECORD  PartDebet ( pmprop );     /*  ├─ параметры платежного документа частичной оплаты картотеки №2 */
RECORD  PartCredit( pmprop );     /*  │                                                               */
RECORD  PartPmrmprop( pmrmprop ); /* ─┘                                                               */

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, pspayorder, KindDoc)

  var NumStep:integer = 0;

  RECORD  p(pspayord);
  setbuff(p,pspayorder);

  if( Kind_Operation == 3027 )
    if( p.CurrentState != PSPO_ST_I2 )
      return "";
    else
      return "20";
    end;
  end;
  
  
  if(p.CurrentState == PSPO_ST_I2 )
    if( p.Kind_Operation == 3029 )
       NumStep = НомерШагаЛоансОплатыПлатК2;
    else
       NumStep = НомерШагаОплатыПлатК2;
    end;
  else NumStep = 0;
  end;

  if(NumStep == 0) return "";
  else             return string(NumStep);
  end;

END;


