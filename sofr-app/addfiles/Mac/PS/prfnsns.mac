 /*
 $Name: prfnsns.mac
 $Module: РКО
 $Description: Печать справки о наличии счетов в банке
 */
/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : prfnsns.mac
  Created     : 11.11.2011
  Programmer  : Popova O.
  Description : Печать справки о наличии счетов в банке

└───────────────────────────────────────────────────────────────────────────*/

import CTInter, "fnsprzall.mac";

var pr_wlregdec:TRecHandler  = TRecHandler( "wlregdec",  "bank.def" );

macro PrintDocument( MassCopy, DocKind )
  var Doc = FNSPrint(pr_wlregdec.rec.DecisionID);
  Doc.LnkTypeInfo         = pr_wlregdec.rec.LnkTypeInfo;
  Doc.НаимНО              = pr_wlregdec.rec.RecipientName;
  Doc.АдрНО               = GetNOAdress( pr_wlregdec.rec.RecipientID );
  Doc.RepBankID           = pr_wlregdec.rec.OriginatorID;
  Doc.НаимКО              = pr_wlregdec.rec.OriginatorName;
  Doc.ДатаЗапроса         = pr_wlregdec.rec.LnkDocDate;
  Doc.НомерЗапроса        = pr_wlregdec.rec.LnkDocNumber;
  Doc.НаимНП              = pr_wlregdec.rec.ClientName;
  Doc.ИНННП               = pr_wlregdec.rec.ClientINN;
  Doc.КППНП               = pr_wlregdec.rec.ClientKPP;
  Doc.Счет                = GetLnkAccounts(pr_wlregdec.rec.DecisionID);
  Doc.FillChanges;
  Doc.ВидСправки          = "NS";
  Doc.ПоСостояниюНаДату   = pr_wlregdec.rec.Date;
  Doc.ClientID            = pr_wlregdec.rec.ClientID;
  Doc.RegPartyKind        = pr_wlregdec.rec.RegPartyKind;
  Doc.ClientRegNum        = pr_wlregdec.rec.ClientRegNum;
  Doc.ClientSubCode       = pr_wlregdec.rec.ClientSubCode;

  Doc.PrintDoc();

  return true;

end;