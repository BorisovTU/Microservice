/*
  $Name:        iwpscnpr.mac
  $Module:      РКО
  $Description: Печать протокола работы процедуры массовой оплаты картотеки ОР
*/

/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : iwpscnpr.mac
  Created     : 13.02.2009
  Programmer  : Попова О.
  Description : Печать протокола работы процедуры массовой оплаты картотеки ОР

└───────────────────────────────────────────────────────────────────────────*/
IMPORT  PaymInter, OprInter, globals;

RECORD rec_psiwpacc (psiwpacc);

const   ПечатьЗаписи = 0,
        Первый       = 1,
        Последний    = 2;


private macro PrintTopReport()

[  

   Протокол работы процедуры "Массовая оплата документов картотеки ОР"                                   

   #########################################################################
   Дата выполнения: ##########
   Исполнитель:     #
]({Name_Bank}, {curdate}, {Name_Oper}:l);

end;

private macro ШапкаТаблицы( isPayed:bool )
[  ────────────┬────┬──────────┬──────────────┬───────┬───────────────────────┬────────────────────────┬─────────────  ];
if( isPayed )
[   № документа│Шифр│   Дата   │ Сумма оплаты │Очеред-│    Счет получателя    │    Банк получателя     │  БИК банка    ];
else
[   № документа│Шифр│   Дата   │Сумма к оплате│Очеред-│    Счет получателя    │    Банк получателя     │  БИК банка    ];        
end;
[              │док.│          │              │ ность │                       │                        │  получателя            
   ────────────┴────┴──────────┴──────────────┴───────┴───────────────────────┴────────────────────────┴─────────────
];
end;

private macro PrintTopPayTable()

[  
   Выполнена оплата документов: ];
   ШапкаТаблицы(true);

end;

private macro PrintTopWriteOffTable()

[  
   Списано с картотеки без оплаты: ];
   ШапкаТаблицы(false);

end;

private macro PrintTopGroup( PayerAccount:string, PayerName:string )
[  ####################### ####################################################                                        ]
(  PayerAccount,           PayerName);
end;

private macro PrintDoc( Number:string, ShifrOper:string, DateDoc:date, Amount:money, Priority:integer, ReceiverAccount:string, ReceiverBankName:string, ReceiverCode:string )
[  ############ #### ########## ############## ####### ####################### ######################## ############   ]
(  Number,   ShifrOper,DateDoc, Amount,       Priority, ReceiverAccount,      ReceiverBankName,         ReceiverCode);
end;

private macro PrintTotalGroup( TotalGroupAmount:money )
[  Итого:                    #################  
]                           ( TotalGroupAmount );
end;

private macro PrintTotalTable( TotalTableAmount:money )
[  ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   Всего на сумму:           #################
]                          ( TotalTableAmount );
end;

private macro PrintTopArestAccount()
[  
   Наложено ограничение операций на счета: 
];
end;

private macro PrintArestAccount( Account:string )

[  #########################   ](Account);

end;

private macro PrintTopI2Account()
[  
   В картотеке №2 есть более приоритетные документы по счетам:
];
end;

private macro PrintI2Account( Account:string )

[  #########################   ](Account);

end;
