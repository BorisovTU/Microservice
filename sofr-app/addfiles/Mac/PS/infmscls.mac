/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : infmscls.mac
  Created     : 09.10.2011
  Programmer  : Popova O. 
  Description : Отчет сканирования массового закрытия справок в ФНС
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlregdec ( wlregdec );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlregdec, firstdoc );

  if( Вызов==Первый )
[                   Отчет о групповом закрытии справок.                         ];
[┌─────────┬──────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                        Сообщение                           │];
[│ справки │ошибки│                                                            │];
[├─────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif (Вызов==Ошибка)

    if(Статус == 0)
      Сообщение = "Документ успешно закрыт";
    end;

[│#########│######│############################################################│]( rwlregdec.DecisionID, Статус, StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└─────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
