/* ╔══════════════════════════════════════════════════════════════════╗  */
/*         Автоматизированная банковская система RS-Bank v5.0            */
/*                 Copyright (c) R-Style Software Lab 1998               */
/*                                                                       */
/*  Имя файла        : bcbdexe.mac                                       */
/*                                                                       */
/*  Описание         : Выбор алгоритма выполнения продажи валюты в банке */
/*                                                                       */
/*  Операция         : Продажа валюты                                    */
/*                                                                       */
/*  Программист      : Литворенко А.А.                                   */
/*                                                                       */
/*  Создан           : 10.08.2001                                        */
/*                                                                       */
/* ╚══════════════════════════════════════════════════════════════════╝  */
import InsCarryDoc, payconst;

record  PartBCexe (ps_bcexe); /*Параметры исполнения*/

/**********************************/
/* Выполнение шага                */
/**********************************/

MACRO ExecuteCaseStep(Kind_Operation, Number_Step, ps_bcord, KindDoc)
  var NumStep;
  record   bc(ps_bcord);
  setbuff (bc,ps_bcord);

  if (bc.ValueDate == bc.OrderDate)
     NumStep = ПРВ_Банк_НомерШагаПродажаВалюты;
  else 
     NumStep = ПРВ_Банк_НомерШагаПостановкаСделкиНаВБ;
  end;

  return string(NumStep);
END;

