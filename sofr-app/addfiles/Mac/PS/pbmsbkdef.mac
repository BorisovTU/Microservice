/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : pbmsbkdef.mac
  Created     : 16.04.2012
  Programmer  : Chukina T.
  Description : Отчет сканирования массового отката помещения в отбракованные
                подтверждений банка
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlresprm ( wlresprm );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlresprm, firstdoc );

  if( Вызов == Первый )
[             Отчет о групповом откате помещения в отбракованные подтверждений      ];
[┌─────────────┬──────┬────────────────────────────────────────────────────────────┐];
[│    Номер    │Номер │                        Сообщение                           │];
[│подтверждения│ошибки│                                                            │];
[├─────────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif( Вызов == Ошибка )

    if( Статус == 0 )
      Сообщение = "Откат помещения в отбракованные успешно выполнен";
    end;

[│#############│######│############################################################│]( rwlresprm.ResultID, Статус, StrSubst( Сообщение, "|", " " ):w );

  elif( Вызов == Последний )
[└─────────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
