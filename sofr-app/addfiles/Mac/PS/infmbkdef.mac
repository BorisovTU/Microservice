/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : infmbkdef.mac
  Created     : 12.04.2012
  Programmer  : Chukina T.
  Description : Отчет сканирования массового отката помещения в отбракованные для справок в ФНС
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

RECORD rwlregdec ( wlregdec );

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  setbuff( rwlregdec, firstdoc );

  if( Вызов==Первый )
[              Отчет о групповом откате помещения в отбракованные справок       ];
[┌─────────┬──────┬────────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                        Сообщение                           │];
[│ справки │ошибки│                                                            │];
[├─────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif (Вызов==Ошибка)

    if(Статус == 0)
      Сообщение = "Откат помещения в отбракованные успешно выполнен";
    end;

[│#########│######│############################################################│]( rwlregdec.DecisionID, Статус, StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└─────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
