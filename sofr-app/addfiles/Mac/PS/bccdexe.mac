/*╔════════════════════════════════════════════════════════════════════════╗*/
/*        Автоматизированная банковская система RS-Bank v5.0                */
/*                Copyright (c) R-Style Software Lab 1998                   */
/*                                                                          */
/* Имя файла        : bcсdexe.mac                                           */
/*                                                                          */
/* Описание         : Выбор алгоритма выполнения конвертации валюты в банке */
/*                                                                          */
/* Операция         : Корнвертация валюты                                   */
/*                                                                          */
/* Программист      : Литворенко А.А.                                       */
/*                                                                          */
/* Создан           : 10.08.2001                                            */
/*                                                                          */
/*╚════════════════════════════════════════════════════════════════════════╝*/
import InsCarryDoc, payconst;

record  PartBCexe (ps_bcexe); /*Параметры исполнения*/

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, ps_bcord, KindDoc)

  var NumStep;

  record  bc(ps_bcord);
  setbuff(bc,ps_bcord);

  if (bc.ValueDate == bc.OrderDate)
     NumStep = КВ_Банк_НомерШагаКонверсия;
  else 
     NumStep = КВ_Банк_НомерШагаПостановкаСделкиНаВБ;
  end;

  return string(NumStep);
end;
