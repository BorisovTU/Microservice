/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : pschcoll.mac                                     */
/*                                                                      */
/*  Описание         : Шаг - определение, является ли платеж внешним    */
/*                     (через картотеку №2)                             */
/*                                                                      */
/*  Программист      : Зайцев А.В.                                      */
/*                                                                      */
/*  Создан           : 12.2.99                                          */
/*                                                                      */
/************************************************************************/
import BankInter, payconst, PaymInter, "paym_rec.mac";

RECORD  PartPmpaym( pmpaym );     /* ─┐                                                               */
RECORD  PartDebet ( pmprop );     /*  ├─ параметры платежного документа частичной оплаты картотеки №2 */
RECORD  PartCredit( pmprop );     /*  │                                                               */
RECORD  PartPmrmprop( pmrmprop ); /* ─┘                                                               */

RECORD  Ps_payord( pspayord );

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, pspayord, KindDoc)

  setbuff(Ps_payord, pspayord);

    /* Проверка на внешний платеж */
    if( (PartCredit.PaymentID == PartPmpaym.PaymentID) and (PartCredit.Group == PAYMENTS_GROUP_EXTERNAL) )
         return string(НомерШагаЧастОплатыВнешПлатК2);
    else
         return string(НомерШагаЧастОплатыВнутрПлатК2);
    end;

END;


