/********************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6.0                          */
/********************************************************************************/
/*                  Подсистема "РКО"                                            */
/* Печать отчета сканирования массовой отправки в обработанные требований       */
/* налоговых органов                                                            */
/*  Имя файла: psdmbkdn.mac                                                     */
/*  Создан:    25.06.12                                  Popova O.              */
/********************************************************************************/
IMPORT "wlmnstls.mac";

const  Ошибка   = 0,
       Первый   = 1,
       Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  if( Вызов == Первый )
[           
        Отчет о групповом откате процедуры отказа в исполнении требования                

  Дата обработки:  ##########  ########
  Операционист:  ####
 ┌───────────────┬─────────────┬────────────────────────────────────────────────────────────┐  
 │ Номер решения │Номер ошибки │                      Сообщение                             │  
 │               │             │                                                            │
 ├───────────────┼─────────────┼────────────────────────────────────────────────────────────┤]( date(), time(), {Oper} );
  elif( Вызов == Ошибка )       

    setbuff( wlregdec, firstdoc );
    if( Статус == 0 )
      Сообщение = "Откат процедуры отказа в исполнении требования выполнен успешно";
    end;
[│###############│#############│############################################################│](wlregdec.Number, Статус, StrSubst( Сообщение, "|", " " ):w );

  elif( Вызов == Последний )
[└───────────────┴─────────────┴────────────────────────────────────────────────────────────┘];
  end;

END;