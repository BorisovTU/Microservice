 /************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*                                                                      */
/*  Имя файла        : ps_inrq.mac                                      */
/*                                                                      */
/*  Описание         : Инициализация и проверки ИПВС                    */
/*  Программист      : Копачев Д.В.                                     */
/*                                                                      */
/*  Создан           : 10.11.2005                                       */
/*                                                                      */
/************************************************************************/

import BankInter, PaymInter, globals;

record  psinrq  ( psinrq   );
record  pmpaym  ( pmpaym   );
record  pmprop  ( pmprop   );
record  pmrmprop( pmrmprop );
record  CurTr   ( pmcurtr  );
record  pmkz    ( pmkz     );

record  oldpsinrq  ( psinrq   );
record  oldpmpaym  ( pmpaym   );
record  oldpmprop  ( pmprop   );
record  oldpmrmprop( pmrmprop );
record  OldCurTr   ( pmcurtr  );
record  oldpmkz    ( pmkz     );

/* номера полей в панели */
const fld_Number = 1,  /* номер */
      fld_Ground = 24; /* основание */


macro Новый_Документ( )
  return 0;
end;

macro Проверить_Документ( Режим )
  var stat:integer = 0;

  if ( (Режим == 2 ) or (Режим == 3) or (Режим == 8) )
    if( StrLen( pmrmprop.Number ) == 0 )
      MsgBox("Не задан номер документа");
      return fld_Number;
    end;
    if( StrLen( pmrmprop.Ground ) == 0 )
      MsgBox("Введите Назначение платежа");
      return fld_Ground;
    end;
  end;

  if(Режим == 3)  /* РЕДАКТИРОВАНИЕ ДОКУМЕНТА */
  elif(Режим == 2)  /* ВВОД ДОКУМЕНТА */
  elif(Режим == 1)  /* УДАЛЕНИЕ ДОКУМЕНТА */
  elif(Режим == 7) /*ПОМЕЩЕНИЕ ДОКУМЕНТА В ОТЛОЖЕННЫЕ, ОТКАТ ОПЕРАЦИИ*/
  elif(Режим == 8)  /*ВВОД В ОТЛОЖЕННЫЕ*/
  end;

  return stat;
end;
macro   Функция_Пользователя( Режим:integer )
 /*
 Возможные значения Режим:
  UFN_PANEL_INPUT(1) - функция вызвана из панели ввода объекта;
  UFN_PANEL_EDIT(2) - функция вызвана из панели корректировки объекта;
  UFN_SCROL(3) - функция вызвана из панели скролинга, единичный вызов, любая корректировка объекта запрещена;
  UFN_SCROL_FMASS(4) - функция вызвана из панели скролинга, работа по нескольким записям, вызов до начала обработки, любая корректировка объекта запрещена;
 
// Пример работы: 
 if( Режим == UFN_SCROL )
   return UPDTPAGE;    // Обновить страницу записей и область скролинга
   //return UPDTREC;     // Обновить текущую запись, загрузив из файла
 end;
 */
   return 0;
end;

macro    УстановитьПодсказкуПоиска( СтараяПодсказка )
        return "/*+FIRST_ROWS LEADING(step) INDEX(step doprstep_dbt_idx7)*/";
end;

