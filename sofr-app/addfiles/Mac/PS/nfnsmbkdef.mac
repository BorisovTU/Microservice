/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v6.00                                         R-Style Software Lab

  File Name   : infmbkdef.mac
  Created     : 25.07.2012
  Programmer  : Polyakov E.
  Description : Отчет сканирования массового отката сообщений ФНС
└───────────────────────────────────────────────────────────────────────────*/
const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )

  RECORD notfns ( wlnotfns );
  setbuff( notfns, firstdoc );

  if( Вызов==Первый )
[              Отчет о групповом откате сообщений ФНС                             ];
[┌───────────┬──────┬────────────────────────────────────────────────────────────┐];
[│   Номер   │Номер │                        Сообщение                           │];
[│ сообщения │ошибки│                                                            │];
[├───────────┼──────┼────────────────────────────────────────────────────────────┤];
  elif (Вызов==Ошибка)

    if(Статус == 0)
      Сообщение = "Откат сообщения ФНС успешно завершен";
    end;

[│###########│######│############################################################│]( notfns.NoticeID, Статус, StrSubst(Сообщение, "|", " " ):w );

  elif (Вызов==Последний)
[└───────────┴──────┴────────────────────────────────────────────────────────────┘];
  end;
END;
