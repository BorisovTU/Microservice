/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*             Copyright (c) R-Style Software Lab 2002                  */
/*                                                                      */
/*  Имя файла        : pschngop.mac                                     */
/*                                                                      */
/*  Описание         : РКО. Протокол смены операциониста.               */
/*                                                                      */
/*  Программист      : Смирнов С.В.                                     */
/*                                                                      */
/*  Создан           : 01.07.02                                         */
/*                                                                      */
/************************************************************************/

record ps_payord (pspayord);
record pm_paym   (pmpaym  );
record pm_prop   (pmprop  );
record pm_rmprop (pmrmprop);


MACRO PrintHeader(oper_old, oper_new, account)
  if( not oper_old ) oper_old = ""; end;
  if( not oper_new ) oper_new = ""; end;
  if( not account  ) account  = ""; end;
[
Протокол смены операциониста

 Прежний операционист : #####
   Новый операционист : #####
                 Счет : #########################

+------+----------+-----------+-----------------------------------+------------------+
|  N   |   Дата   |    Опер   |            Получатель             |                  |
| док  |          |-----------|-----------------------------------|       Сумма      |
|      |          | был |стал |   БИК   |          Счет           |                  |
|------+----------+-----------+---------+-------------------------+------------------|
](oper_old, oper_new, account:f);
END;


MACRO PrintLine(oper_old)
[|######|##########|#####|#####|#########|#########################|##################|]
(pm_rmprop.Number, pm_rmprop.Date, 
 oper_old, ps_payord.Oper, 
 pm_prop.BankCode, pm_paym.ReceiverAccount:f, 
 pm_paym.Amount:a);
END;


MACRO PrintFooter()
[+------+----------+-----------+---------+-------------------------+------------------+];
END;


MACRO NoDocuments()
  [Нет документов для исправления];
END;
