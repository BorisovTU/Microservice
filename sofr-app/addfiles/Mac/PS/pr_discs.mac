/*
  $Name:        pr_discs.mac
  $Module:      РКО
  $Description: Протокол работы процедуры "Списания невостребованных чековых книжек"
*/

/*----------------------------------------------------------------------------------*/
/*        Протокол работы процедуры "Списания невостребованных чековых книжек"      */
/*----------------------------------------------------------------------------------*/


  

macro Print_Header( DepName, RepDate, OperName )
[
 Протокол работы процедуры "Списание невостребованных чековых книжек"
 
 
 ############################################################
 Дата выполнения: ##########
 Исполнитель:     #

 Обработаны невостребованные чековые книжки по следующим заявлениям
 ╔═══════════╤════════════╤══════════════════════════════════╤════════╤═══════════════╤════════════════════════════╗
 ║ Номер     │ Дата       │ Счет                             │ Кол-во │ Кол-во листов │ Результат обработки        ║
 ║ заявления │ заявления  │                                  │ книжек │ в книжке      │                            ║
 ╟───────────┼────────────┼──────────────────────────────────┼────────┼───────────────┼────────────────────────────╢]
 ( DepName, RepDate, OperName );
end;

macro Print_Document( DocNum:integer, RepDate:date, Account:string, BooksAmount:integer, SheetsInBook:integer, ResultDiscar:string, err:integer )
  var StrDiscar:string = "";

  if( err )
    if( ResultDiscar == "" )
      StrDiscar = "Ошибка при списании";
    else
      StrDiscar =  ResultDiscar;
    end;
  else
    StrDiscar = "Списание выполнено успешно";
  end;

[║ ######### │ ########## │ #########################        │ ###### │ ############# │ ########################## ║]
(DocNum, RepDate, Account, BooksAmount, SheetsInBook, StrDiscar:w );
                                                                                 
end;



macro Print_Itog( DocNum, Discar, NotDiscar )
[╚═══════════╧════════════╧══════════════════════════════════╧════════╧═══════════════╧════════════════════════════╝


 Итого:

        Обработано заявлений: ##########
        Списано книжек:       ##########
        Не списано книжек:    ##########
]( DocNum, Discar, NotDiscar );
end;



/*
 Протокол работы процедуры "Списание невостребованных чековых книжек"
 
 
 ############################################################
 Дата выполнения: ##########
 Исполнитель:     ############################################################

 Обработаны невостребованные чековые книжки по следующим заявлениям
 ╔═══════════╤════════════╤══════════════════════════════════╤════════╤═══════════════╤═════════════════════╗
 ║ Номер     │ Дата       │ Счет                             │ Кол-во │ Кол-во листов │ Результат обработки ║
 ║ заявления │ заявления  │                                  │ книжек │ в книжке      │                     ║
 ╟───────────┼────────────┼──────────────────────────────────┼────────┼───────────────┼─────────────────────╢
 ║           │            │                                  │        │               │                     ║                                         
 ╚═══════════╧════════════╧══════════════════════════════════╧════════╧═══════════════╧═════════════════════╝

 ║           │            │                           │        │               │                            ║
 
 Итого:
 
        Обработано заявлений: ##########
        Списано книжек:       ##########
        Не списано книжек:    ##########

*/

