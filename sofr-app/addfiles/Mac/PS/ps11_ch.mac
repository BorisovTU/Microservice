import          PaymInter;

/*--------------------------------------------------------------------------------------\
|       Макрос проверки первичного документа до инициализации операции                  |
\--------------------------------------------------------------------------------------*/
macro   InitOperation( KindOp, KindDoc, order )
/*
        Var             b40702 = "40702";

        record          bo(ps_bcord);
        record          paymentB( pmpaym );
        record          paymentK( pmpaym );


        SetBuff( bo, order );

        /* Найти платеж по базовому финансовому инструменту */
        if ( FindPayment( 
                0,      /* Индентификатор неизвестен    */
                1,      /* Базовый актив                */
                0,      /* Subpurpose                   */
                bo.dockind,
                bo.orderid,
                false,
                paymentB,

        )       !=      0 )

                MsgBox( "Не могу найти платеж по зачислению валюты" );
                return  1;
        end;

        /* Найти платеж по контрактиву */
        if ( FindPayment( 
                0,      /* Индентификатор неизвестен    */
                2,      /* Контрактив                   */
                0,      /* Subpurpose                   */
                bo.dockind,
                bo.orderid,
                false,
                paymentK

        )       !=      0 )

                MsgBox( "Не могу найти платеж по контрактиву" );
                return  2;
        end;

        /* Счета клиента должны быть открыты на балансовом счете 40702  */
        if ( Substr( paymentB.PayerAccount, 1, 5 )  !=  b40702 )
                MsgBox( "Счет плательщика должен быть открыт на балансовом счете 40702" );
                return  10;
        end;

        if ( Substr( paymentK.ReceiverAccount, 1, 5 )  !=  b40702 )
                MsgBox( "Счет получателя должен быть открыт на балансовом счете 40702" );
                return  13;
        end;
    */
        return  0;

end;