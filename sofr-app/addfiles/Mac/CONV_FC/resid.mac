/*
   Макрос установки признака резидентности клиентам в исходной БД
   Запускается перед конвертацией
*/

file dep(depositr) key 6;
file dCl(depclnt) write key 0;


macro NotResidentAccount(dTA)
var Ret=FALSE;

 if((dTA=="DVN") OR
   (dTA=="DVN_EUR") OR
   (dTA=="GD-НЕРЕЗИД") OR
   (dTA=="ДВН") OR
   (dTA=="VISA-C-KK(N)") OR
   (dTA=="VISA-O-SU(N)") OR
   (dTA=="Visa-C-SS<N>") OR
   (dTA=="Visa-G-KR(N)") OR
   (dTA=="Visa-G-PR<N>") OR
   (dTA=="Visa-O-US(N)"))
        Ret=TRUE;
 end;
 return(Ret);

end;


while(next(dCl))
    dep.CodClient=dCl.CodClient;
    dep.Code_Currency=0;
    dep.Account="";
    if(GetGE(dep))
        if(dep.CodClient==dCl.CodClient)
            if(NotResidentAccount(dep.Type_Account))
                dCl.YesResident="N";
            end;
        end;
    end;
    update(dCl);
end;