/*Вставил VIG из-за анализа*/
file FLAROS() dbf;

/*
  RS-Retail
  Конвертирование данных из Laros в RS-Retail

  Соответствие операций

  Ромодин Александр Васильевич
  07.10.97
------------------------------------------------------------
  По номеру операции Laros определяет номер операции RS-Retail
  и вид операции: дебет или кредит
  Возврат:
   True - операция найдена
   False - операция не определена
*/
/* ------------------------------------------------------ */

const D_UN  = 0;                /* Не определено        */
const D_IN  = 1;                /* Приход (кредит счета)*/
const D_OUT = 2;                /* Расход (дебет счета) */

const APP_SALARY  = 1;          /* Зар.плата            */
const APP_PENSION = 2;          /* Пенсия               */
const APP_PRIZE   = 3;          /* Выигрыш              */
const APP_OTHER   = 4;          /* Прочее               */
const AT_Compensation = 10;     /* Компенсация          */

const MaxApplType = 10;         /* Максимальный вид зачисления */
/* ------------------------------------------------------ */
/*
  Для рублевых счетов
*/

macro GetNumOper
(
 OperLaros,     /* Вход- номер операции Laros   */
                /* Выход (0- не определено)     */
 DebetCredit,   /* Дебет или кредит     */
 OperRS,        /* Номер операции в RS  */
 ComplexRS,     /* Комплексная операция */
 ApplType,      /* Вид зачисления       */
 Ground,        /* Основание            */
 VidDoc         /* 0 - безналичная,1-наличная   */
)
  var DebetCredit_ = 0,
      OperRS_      = 0,
      ComplexRS_   = 0,
      ApplType_    = 0,

      Ground_      = "",
      VidDoc_      = 0,
      Stat = TRUE;

  var Rest = 0;

  if (OperLaros == "110")         /* Открытие счета       */
    DebetCredit_ = D_IN;
    OperRS_      = 1;
    ComplexRS_   = 1;
    Ground_      = "110 Открытие счета";
    VidDoc_      = 1;
  elif (OperLaros == "706")     /* Открытие счета       */
    DebetCredit_ = D_IN;
    OperRS_      = 1;
    ComplexRS_   = 1;
    Ground_      = "706 Безналичное открытие счета";
    VidDoc_      = 0;
  elif (OperLaros == "111")     /* Переоформление депозита на новый срок*/
    DebetCredit_ = D_IN;
    OperRS_      = 111;
    ComplexRS_   = 82;
    Ground_      = "111 Переоформление на новый срок";
    VidDoc_      = 1;
  elif (OperLaros == "112")     /* Доп.взнос */
    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = 3;
    Ground_      = "112 Дополнительный взнос";
    VidDoc_      = 1;
  elif (OperLaros == "402")     /* Доп.взнос */
    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = 3;
    Ground_      = "402 Прием наличных денег";
    VidDoc_      = 1;
  elif (OperLaros == "113")     /* Доп.взнос без с.книжки */
    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = 3;
    Ground_      = "113 Доп.взнос без сбер.книжки";
/*  elif (OperLaros == 114)  */   /* Прием наличных для перевода */
/*    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = ; */
  elif (OperLaros == "140")     /* Расход */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 4;
    Ground_      = "140 Расход";
    VidDoc_      = 1;
  elif (OperLaros == "141")     /* Выдача % по вкладу */
    DebetCredit_ = D_OUT;
    OperRS_      = 6;
    ComplexRS_   = 6;
    Ground_      = "141 Выдача % по вкладу";
    VidDoc_      = 1;
  elif (OperLaros == "142")     /* Выдача % по срочным */
    DebetCredit_ = D_OUT;
    OperRS_      = 6;
    ComplexRS_   = 6;
    Ground_      = "142 Выдача % по вкладу";
    VidDoc_      = 1;
  elif (OperLaros == "144")     /* Расход по объединенным */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 4;
    Ground_      = "144 Расход по объединенным";
    VidDoc_      = 1;
  elif (OperLaros == "145")     /* Выдача наследнику или по обязательству */
    DebetCredit_ = D_OUT;
    OperRS_      = OperToAlt;
    ComplexRS_   = OperToAlt;
    Ground_      = "145 Выдача наследнику или под обязательство";
    VidDoc_      = 1;
  elif (OperLaros == "147")     /* Закрытие счета наличным путем */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 10;
    Ground_      = "147 Закрытие неподвижных наличными";
    VidDoc_      = 1;

/*  elif (OperLaros == 148) */    /* Выдача чековой книжки за счет средств вклада */
/*    DebetCredit_ = D_OUT;
    OperRS_      = ???;
    ComplexRS_   = */
/*  elif (OperLaros == 149) */    /* Возврат неиспользованной чековой книжки */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
/*  elif (OperLaros == 151) */    /* Выдача вклада по телеграфному подтверждению */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
  elif (OperLaros == "154")     /* Закрытие счета наличным путем */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 10;
    Ground_      = "154 Закрытие счета наличным путем";
    VidDoc_      = 1;
/*  elif (OperLaros == 158) */    /* Выдача по чековой книжке */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
  elif (OperLaros == "988")     /* Выплата компенсации наличными */
    DebetCredit_ = D_OUT;
    OperRS_      = 15;
    ComplexRS_   = 15;
    Ground_      = "988 Выплата компенсации (1994 г)";
    VidDoc_      = 1;
/*  elif (OperLaros == 181) */    /* Выдача чека за счет средств вклада */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
/*  elif (OperLaros == 183) */    /* Прием чека для зачисления на вклад */
/*    DebetCredit_ = D_IN;
    OperRS_ = ???;
    ComplexRS_ = */
/*  elif (OperLaros == 156) */    /* Отметка о расходной операции, вып.в отделении */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
  elif (OperLaros == "143")     /* Выдача наличными условно-закрытого вклада */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 4;
    Ground_      = "143 Выдача наличными условно-закрытого вклада";
    VidDoc_      = 1;
/*  elif (OperLaros == 146) */    /* Выдача за счет другого филиала */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
  elif (OperLaros == "177")     /* Прием наличных в счет погашения долга */
    DebetCredit_ = D_IN;
    OperRS_      = 2;
    ComplexRS_   = 2;
    Ground_      = "177 Прием наичных в счет погашения долга";
    VidDoc_      = 1;
  elif (OperLaros == "198")     /* Корректировка остатка */
    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = 3;
    Ground_      = "198 Корректировка остатка";
    VidDoc_      = 0;
  elif (OperLaros == "200")     /* Зачисление по спискам организаций */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_SALARY;
    Ground_      = "200 Зачисление по спискам организаций";
  elif (OperLaros == "223")     /* Зачисление */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_OTHER;
    Ground_      = "223 Зачисление";
  elif (OperLaros == "201")     /* Зачисление */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_OTHER;
    Ground_      = "201 Зачисление по кредитным авизо";
  elif (OperLaros == "205")     /* Причисление % по целевым на детей */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 10;
    Ground_      = "205 Причисление % по детским";
  elif (OperLaros == "206")     /* Причисление процентов по вкладу */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "206 Причисление %";
  elif (OperLaros == "208")     /* Зачисление премии по молодежно-премиальным */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType     = APP_PRIZE;
    Ground_      = "208 Зачисление премии";
  elif (OperLaros == "207")     /* Зачисление выигрышей по выиграшным вкладам */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_PRIZE;
    Ground_      = "207 Зачисление выигрышей";
  elif (OperLaros == "210")     /* Ежемесячная капитализация процентов */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "210 Ежемесячная капитализация процентов";
  elif (OperLaros == "202")     /* Зачисление пенсии */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_PENSION;
    Ground_      = "202 Зачисление пенсии";
  elif ((OperLaros == "211") OR (OperLaros == "   ")) /* */
    DebetCredit_ = D_IN;
    OperRS_      = 71;
    ComplexRS_   = 71;
    Ground_      = "211 Перевод на объединенные";
  elif (OperLaros == "212")     /* Открытие счета зачислением пенсии */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_PENSION;
    Ground_      = "212 Открытие счета зачислением пенсии";
    VidDoc_      = 0;
  elif (OperLaros == "213")     /* Открытие счета безналично */
    DebetCredit_ = D_IN;
    OperRS_      = 51;
    ComplexRS_   = 51;
    Ground_      = "213 Открытие счета безналично";
  elif (OperLaros == "214")      /* Открытие счета в связи с утерей с.кн */
    DebetCredit_ = D_IN;
    OperRS_      = 51;
    ComplexRS_   = 51;
    Ground_      = "214 Открытие счета в связи с потерей Сбер.книжки";
  elif (OperLaros == "215")     /* Открытие счета безналично */
    DebetCredit_ = D_IN;
    OperRS_      = 51;
    ComplexRS_   = 51;
    Ground_      = "215 Открытие счета безналично";
  elif (OperLaros == "220")     /* Зачисление переводом */
    DebetCredit_ = D_IN;
    OperRS_      = 65;
    ComplexRS_   = 65;
    Ground_      = "220 Зачисление во вклад своего филиала";
  elif (OperLaros == "245")     /* Списание платы со счета */
    DebetCredit_ = D_OUT;
    OperRS_      = 52;
    ComplexRS_   = 52;
    Ground_      = "245 Списание суммы платы со счета";
  elif (OperLaros == "888")     /* Зачисление компенсации */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = AT_Compensation;
    Ground_      = "888 Зачисление компенсации (1994 г)";
  elif (OperLaros == "192")
    DebetCredit_ = D_IN;
    OperRS_      = 40;
    ComplexRS_   = 40;
    Ground_      = "192 Справка по счету";
  elif (OperLaros == "240")     /* Перечисление (списание со счета) */
    DebetCredit_ = D_OUT;
    OperRS_      = 66;
    ComplexRS_   = 66;
    Ground_      = "240 Перечисление на др.счет своего филиала";
  elif (OperLaros == "241")     /* Списание-перевод в др.филиал */
    DebetCredit_ = D_OUT;
    OperRS_      = 67;
    ComplexRS_   = 67;
    Ground_      = "241 Перечисление в др.филиал";
  elif (OperLaros == "242")     /* Списание по данным последконтроля */
    DebetCredit_ = D_OUT;
    OperRS_      = 62;
    ComplexRS_   = 62;
    Ground_      = "242 Списание по данным послед.контроля";
  elif (OperLaros == "243")     /* Списание по разовому поручению */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "243 Списание по разовому поручению";
  elif (OperLaros == "247")     /* Списание по разовому поручению */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "247 Списание суммы оплаченного чека";
  elif (OperLaros == "244")     /* Списание по длительному поручению */
    DebetCredit_ = D_OUT;
    OperRS_      = 64;
    ComplexRS_   = 64;
    Ground_      = "244 Списание по длительному поручению";
/*  elif (OperLaros == 246) */    /* Списание в общ.фонды */
/*    DebetCredit_ = D_OUT;
    OperRS_ = ???;
    ComplexRS_ = */
  elif (OperLaros == "248")     /* Списание по телеграфному запросу */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "248 Списание по телеграфному запросу";
  elif (OperLaros == "249")     /* Списание по исполнительному документу */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "249 Списчание по исполнительному документу";
  elif (OperLaros == "253")     /* Отчисление излишних % */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 72;
    ApplType_    =  1;  /* Отчисление */
    Ground_      = "253 Отчисление излишних %";
/*
  elif (OperLaros == "253")     /* Отчисление % при закрытии срочных */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 10;
    Ground_      = "253 Отчисление % при закрытии срочного";
*/
  elif (OperLaros == "252")     /* Списание обьединенных */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "252 Списание обьединенных";
  elif (OperLaros == "254")     /* Отчисление % при закрытии целевого на детей */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 10;
    Ground_      = "254 Отчисление % при закрытии детского";
  elif (OperLaros == "256")     /* Налог с матариальной выгоды */
    DebetCredit_ = D_OUT;
    OperRS_      = 7;
    ComplexRS_   = 7;
    Ground_      = "256 Налог с материальной выгоды";
  elif (OperLaros == "259")     /* Налог с нерезидентов */
    DebetCredit_ = D_OUT;
    OperRS_      = 8;
    ComplexRS_   = 8;
    Ground_      = "259 Налог с нерезидентов";

  elif (OperLaros == "000")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "000 Причисление %";
  elif (OperLaros == "999")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "999 Причисление %";
  elif (OperLaros == "ДЕН")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_      = OP_DENOM;
    ComplexRS_   = OP_DENOM;
    Ground_      = "ДЕН Деноминация";
  elif (OperLaros == "777")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_ = "777 Вклад был пенсионным до автоматизации";
  elif (OperLaros == "878")     /* Зачисление компенсации */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = AT_Compensation;
    Ground_      = "878 Зачисление компенсации";
  elif (OperLaros == "978")     /* Выдача компенсации */
    DebetCredit_ = D_OUT;
    OperRS_      = 15;
    ComplexRS_   = 15;
    Ground_      = "978 Выдача компенсации";
    VidDoc_      = 1;
  elif (OperLaros == "958")     /* Выдача компенсации */
    DebetCredit_ = D_OUT;
    OperRS_      = 15;
    ComplexRS_   = 15;
    Ground_      = "958 Выдача компенсации";
    VidDoc_      = 1;
  elif (OperLaros == "298")
  /*VIG гребаный анализ*/
    Prev (FLAROS);
    Rest = FLAROS.OSTAT;
    Next (FLAROS);

    if (FLAROS.OSTAT > Rest)
      DebetCredit_ = D_IN;
    else
      DebetCredit_ = D_OUT;
    end;

    OperRS_      = 50;
    ComplexRS_   = 50;
    Ground_      = "298 Корректировка остатков неподв. и объед.";
    VidDoc_      = 1;
/*
  elif (OperLaros == --)
    DebetCredit_ = D_;
    OperRS_ = --;
    ComplexRS_
*/
  else
    Stat = FALSE;
  end;
  SetParm( 1, DebetCredit_ );
  SetParm( 2, OperRS_      );
  SetParm( 3, ComplexRS_   );
  SetParm( 4, ApplType_    );
  SetParm( 5, Ground_      );
  SetParm( 6, VidDoc_      );
  return Stat;
end;
