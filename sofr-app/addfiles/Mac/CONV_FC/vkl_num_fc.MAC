/*
  RS-Retail
  Конвертирование данных из
    п/с "Частные вклады" АБС   RS-Bank в
    п/с "Обслуж.физ.лиц" САРБУ RS-Retail
  2000 год

  Соответствие операций

  Рыжиков А.А.
  27.10.2000
------------------------------------------------------------
  По номеру операции в Ч/в определяетсф номер операции RS-Retail
  и вид операции: дебет или кредит
  Возврат:
   True - операция найдена
   False - операция не определена
*/
/* ------------------------------------------------------ */
const APP_SALARY  = 1;          /* Зар.плата            */
const APP_PENSION = 2;          /* Пенсия               */
const APP_PRIZE   = 3;          /* Выигрыш              */
const APP_OTHER   = 4;          /* Прочее               */
const AT_Compensation = 10;     /* Компенсация          */

const MaxApplType = 10;         /* Максимальный вид зачисления */
/* ------------------------------------------------------ */
/*
  Для рублевых счетов
*/

macro GetNumOper
(
 OperOtherABS,  /* Вход- номер операции в сторонней АБС */
                /* Выход (0- не определено)     */
 DebetCredit,   /* Дебет или кредит     */
 OperRS,        /* Номер операции в RS  */
 ComplexRS,     /* Комплексная операция */
 ApplType,      /* Вид зачисления       */
 Ground,        /* Основание            */
 VidDoc         /* 0 - безналичная,1-наличная   */
)
  var DebetCredit_ = 0,
      OperRS_      = 0,
      ComplexRS_   = 0,
      ApplType_    = 0,

      Ground_      = "",
      VidDoc_      = 0,
      Stat = TRUE;

  if   (OperOtherABS == "1")     /* Доп.взнос */
    DebetCredit_ = D_IN;
    OperRS_      = 3;
    ComplexRS_   = 3;
    Ground_      = "1 Дополнительный взнос";
    VidDoc_      = 1;
  elif (OperOtherABS == "2")     /* Расход */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 4;
    Ground_      = "2 Расход";
    VidDoc_      = 1;
  elif (OperOtherABS == "3")     /* Перечисление (списание со счета) */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "3 Перечисление";
  elif (OperOtherABS == "4")     /* Перечисление (списание со счета) */
    DebetCredit_ = D_OUT;
    OperRS_      = 73;
    ComplexRS_   = 73;
    Ground_      = "4 Внутреннее перечисление";
  elif (OperOtherABS == "5")     /* Зачисление по спискам организаций */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    Ground_      = "5 Зачисление ";
  elif (OperOtherABS == "6")
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "6 Зачисление процентов";
  elif (OperOtherABS == "7")     /* Расход */
    DebetCredit_ = D_OUT;
    OperRS_      = 4;
    ComplexRS_   = 4;
    Ground_      = "7 Нал расход безнал ср-в";
    VidDoc_      = 1;
  elif (OperOtherABS == "10")
    DebetCredit_ = D_IN;
    OperRS_      = 72;
    ComplexRS_   = 72;
    Ground_      = "10 Зачисление процентов";
  elif (OperOtherABS == "11")     /* Перечисление (списание со счета) */
    DebetCredit_ = D_OUT;
    OperRS_      = 63;
    ComplexRS_   = 63;
    Ground_      = "11 Списание без отражения в опер дне";
  else
    Stat = FALSE;
  end;
  SetParm( 1, DebetCredit_ );
  SetParm( 2, OperRS_      );
  SetParm( 3, ComplexRS_   );
  SetParm( 4, ApplType_    );
  SetParm( 5, Ground_      );
  SetParm( 6, VidDoc_      );
  return Stat;
end;
