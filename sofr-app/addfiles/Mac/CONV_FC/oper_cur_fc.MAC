/*
------------------------------------------------------------
  По номеру операции Laros определяет номер операции RS-Retail
  и вид операции: дебет или кредит
  Возврат:
   True - операция найдена
   False - операция не определена
*/
/* ------------------------------------------------------ */
const APP_SALARY  = 1;          /* Зар.плата            */
const APP_PENSION = 2;          /* Пенсия               */
const APP_PRIZE   = 3;          /* Выигрыш              */
const APP_OTHER   = 4;          /* Прочее               */
const AT_Compensation = 10;     /* Компенсация          */

const MaxApplType = 10;      /* Максимальный вид зачисления */
/* ------------------------------------------------------ */
/***********************************************************
  Для валютных счетов
***********************************************************/

macro GetNumOper_currency
(
 OperLaros,     /* Вход- номер операции Laros   */
                /* Выход (0- не определено)     */
 DebetCredit,   /* Дебет или кредит     */
 OperRS,        /* Номер операции в RS  */
 ComplexRS,     /* Комплексная операция */
 ApplType,      /* Вид зачисления       */
 Ground,        /* Основание            */
 VidDoc         /* 0 - безналичная,1-наличная   */
)
  var DebetCredit_ = 0,
      OperRS_      = 0,
      ComplexRS_   = 0,
      ApplType_    = 0,
      Ground_      = "",
      VidDoc_      = 0,
      Stat = TRUE;

  if (OperLaros == "110")         /* Открытие счета       */
    DebetCredit_ = D_IN;
    OperRS_ = 1;
    ComplexRS_ = 1;
    Ground_ = "110 Открытие счета";
    VidDoc_ = 1;
  elif (OperLaros == "111")         /* Открытие счета вносителем */
    DebetCredit_ = D_IN;
    OperRS_ = 1;
    ComplexRS_ = 1;
    Ground_ = "111 Открытие счета вносителем";
    VidDoc_ = 1;
  elif (OperLaros == "112")     /* Доп.взнос */
    DebetCredit_ = D_IN;
    OperRS_ = 3;
    ComplexRS_ = 3;
    Ground_ = "112 Дополнительный взнос";
    VidDoc_ = 1;
  elif (OperLaros == "113")     /* Доп.взнос от вносителя */
    DebetCredit_ = D_IN;
    OperRS_ = 3;
    ComplexRS_ = 3;
    Ground_ = "113 Дополнительный взнос от вносителя";
    VidDoc_ = 1;
  elif (OperLaros == "140")     /* Выдача части вклада */
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 4;
    Ground_ = "140 Выдача части вклада";
    VidDoc_ = 1;
  elif (OperLaros == "141")
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 4;
    Ground_ = "141 Выдача части вклада по доверенности";
    VidDoc_ = 1;
  elif (OperLaros == "142")     /* Выдача % по срочным */
    DebetCredit_ = D_OUT;
    OperRS_ = 6;
    ComplexRS_ = 6;
    Ground_ = "142 Выдача % по срочному вкладу";
    VidDoc_ = 1;
  elif (OperLaros == "143")
    DebetCredit_ = D_OUT;
    OperRS_ = 6;
    ComplexRS_ = 6;
    Ground_ = "143 Выдача % по доверенности";
    VidDoc_ = 1;
  elif (OperLaros == "145")     /* Выдача наследнику или по обязательству */
    DebetCredit_ = D_OUT;
    OperRS_ = OperToAlt;
    ComplexRS_ = OperToAlt;
    Ground_ = "145 Выдача наследнику или под обязательство";
    VidDoc_ = 1;
  elif (OperLaros == "148")     /* Переоформление депозита на новый срок*/
    DebetCredit_ = D_IN;
    OperRS_ = 1;
    ComplexRS_ = 1;
    Ground_ = "148 Переоформление депозита";
    VidDoc_ = 1;
  elif (OperLaros == "149")
    DebetCredit_ = D_IN;
    OperRS_ = 1;
    ComplexRS_ = 1;
    Ground_ = "149 Переоформление депозита по доверенности";
    VidDoc_ = 1;
  elif (OperLaros == "154")
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 10;
    Ground_ = "154 Закрытие счета";
    VidDoc_ = 1;
  elif (OperLaros == "155")
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 10;
    Ground_ = "155 Закрытие счета по доверенности";
    VidDoc_ = 1;
  elif (OperLaros == 175)
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 4;
    Ground = "175 Выдача наличных подотчетным лицам";
  elif (OperLaros == 176)
    DebetCredit_ = D_IN;
    OperRS_ = 3;
    ComplexRS_ = 3;
    Ground = "176 Прием наличных от подотчетных лиц";
  elif (OperLaros == "200")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "200 Зачисление суммы на счет";
  elif (OperLaros == "201")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "201 Зачисление суммы на счет с конвертированием";
  elif (OperLaros == "210")     /* Открытие счета безналично */
    DebetCredit_ = D_IN;
    OperRS_ = 51;
    ComplexRS_ = 51;
    Ground_ = "210 Открытие счета безналично";
  elif (OperLaros == "214")      /* Открытие счета в связи с утерей с.кн */
    DebetCredit_ = D_IN;
    OperRS_ = 51;
    ComplexRS_ = 51;
    Ground_ = "214 Открытие счета в связи с потерей Сбер.книжки";
  elif (OperLaros == "215")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_SALARY;
    Ground_ = "215 Зачисление грантов";
  elif (OperLaros == "220")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "220 Зачисление с другого счета филиала";
  elif (OperLaros == "221")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "221 Зачисление с другого счета филиала";
  elif (OperLaros == "222")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "222 Зачисление при конвертировании";
  elif (OperLaros == "223")     /* Зачисление */
    DebetCredit_ = D_IN;
    OperRS_      = 73;
    ComplexRS_   = 73;
    ApplType_    = APP_OTHER;
    Ground_      = "223 Зачисление";
  elif (OperLaros == "206")     /* Причисление процентов по вкладу */
    DebetCredit_ = D_IN;
    OperRS_ = 72;
    ComplexRS_ = 72;
    Ground_ = "206 Причисление %                          ";
  elif (OperLaros == "240")     /* Перечисление (списание со счета) */
    DebetCredit_ = D_OUT;
    OperRS_ = 62;
    ComplexRS_ = 62;
    Ground_ = "240 Перечисление на др.счет своего филиала";
  elif (OperLaros == "242")     /* Списание по данным последконтроля */
    DebetCredit_ = D_OUT;
    OperRS_ = 62;
    ComplexRS_ = 62;
    Ground_ = "242 Списание по данным послед.контроля";
  elif (OperLaros == "243")     /* Списание по разовому поручению */
    DebetCredit_ = D_OUT;
    OperRS_ = 63;
    ComplexRS_ = 63;
    Ground_ = "243 Списание по разовому поручению";
  elif (OperLaros == "245")
    DebetCredit_ = D_OUT;
    OperRS_ = 63;
    ComplexRS_ = 63;
    Ground_ = "245 Списание комиссии";
  elif (OperLaros == "246")
    DebetCredit_ = D_OUT;
    OperRS_ = 63;
    ComplexRS_ = 63;
    Ground_ = "246 Списание комиссии";
  elif (OperLaros == "251")     /* Списание по длительному поручению */
    DebetCredit_ = D_OUT;
    OperRS_ = 63;
    ComplexRS_ = 63;
    Ground_ = "251 Списание по длительному поручению";
  elif (OperLaros == "000")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_ = 72;
    ComplexRS_ = 72;
    Ground_ = "000 Причисление %";
  elif (OperLaros == "276")
    DebetCredit_ = D_OUT;
    OperRS_ = 4;
    ComplexRS_ = 10;
    Ground_ = "276 Закрытие счета для до востр.?";
    VidDoc_ = 1;
  elif (OperLaros == "999")     /* Запись за 01.01.---- */
    DebetCredit_ = D_IN;
    OperRS_ = 72;
    ComplexRS_ = 72;
    Ground_ = "999 Причисление %";
 /*******************************/
  elif (OperLaros == "  1")     /* Операция причисление % по счету */
    DebetCredit_ = D_IN;
    OperRS_ = 72;
    ComplexRS_ = 72;
    Ground_ = "  1 Причисление %     ";
  elif (OperLaros == "908")       /* ??? операция по счету */
    DebetCredit_ = D_IN;    /* Запись за 01.01.---- */
    OperRS_ = 72;
    ComplexRS_ = 72;
    Ground_ = "908 Причисление %???????";

  elif (OperLaros == "253")     /* Отчисление излишне причисленных % */
    DebetCredit_ = D_OUT;
    OperRS_ = 63;
    ComplexRS_ = 63;
    Ground_ = "253 Отчисление излишне причисленных % ";
  elif (OperLaros == "208")     /* Пролонгация депозитов */
    DebetCredit_ = D_IN;
    OperRS_ = 72;
    ComplexRS_ = 82;
    Ground_ = "208  Пролонгация депозитов                 ";
  elif (OperLaros == "382")
    DebetCredit_ = D_IN;
    OperRS_ = 63;
    ComplexRS_ = 63;
    ApplType_ = APP_OTHER;
    Ground_ = "382 Продажа дорожных чеков";
  elif (OperLaros == "385")
    DebetCredit_ = D_IN;
    OperRS_ = 73;
    ComplexRS_ = 73;
    ApplType_ = APP_OTHER;
    Ground_ = "385 Прием чека для зачисления";
/*
  elif (OperLaros == --)
    DebetCredit_ = D_;
    OperRS_ = --;
    ComplexRS_
*/
  else
    Stat = FALSE;
  end;
  SetParm (1,DebetCredit_);
  SetParm (2,OperRS_);
  SetParm (3,ComplexRS_);
  SetParm (4,ApplType_);
  SetParm (5,Ground_);
  SetParm (6,VidDoc_);
  return Stat;
end;
