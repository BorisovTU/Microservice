
/* Переименование файлов базы данных по списку 

   Список заполняется следующим образом:
  
   FileList( 0 ) = SrcFName1; FileList( 1 ) = DstFName1;
   FileList( 2 ) = SrcFName2; FileList( 3 ) = DstFName2;
   ... 

*/

var
  ComSpec = GetEnv( "COMSPEC" ),
  DbDir = GetIniString("DATABASEDIR");

macro RenameFile( SrcFileName, DstFileName )

  return not Run(ComSpec, "/C ren " + DbDir + SrcFileName + " " + DstFileName +
    " > nul" );
end;

macro RenameDbFiles( FileList )

  var 
   Stat = true, 
   i = 0;

  while ( Stat and ( i < ASize( FileList ) / 2 ) )
    Stat = RenameFile( FileList( 2 * i ), FileList( 2 * i + 1 ));
    if(Stat)
      i = i + 1;
    end;
  end;
  if ( not Stat )
    MsgBox( "Ошибка при переименовании файла " + FileList( 2 * i ) );
  end;
  return Stat;
end;
