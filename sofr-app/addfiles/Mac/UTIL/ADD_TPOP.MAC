/*************************************
*                                    *
* Добавление операции для вкладов    *
*                                    *
*                                    *
*************************************/

file pc_apltp (pc_apltp) key 9999;
file sb_typop (sb_typop) key 0 write;

/***** Вставляемая операция *****/
const NumOpert   = 38;  /* Из sb_naalg.h           */
const UpNumOpert = 0;   /* Главный в группе        */
const Name       = "Начисление накопл.%%";
const SysNumb    =  1;  /* Не отоброжать на экране */
const CharOper   = "E";
/********************************/
var INSERT_ERROR = False;


  ReWind(pc_apltp);
  while (Next(pc_apltp))
    if ((pc_apltp.TypeRec == 1003) AND (pc_apltp.ApplType == 2001))
      ReWind(sb_typop);
      sb_typop.IsCur    = pc_apltp.IsCur;
      sb_typop.Kind     = pc_apltp.Type;
      sb_typop.NumOpert = 0;
      if (GetGE(sb_typop))
	if ((sb_typop.IsCur == pc_apltp.IsCur) AND
	    (sb_typop.Kind  == pc_apltp.Type )    )
	  ReWind(sb_typop);
	  sb_typop.IsCur    = pc_apltp.IsCur;
	  sb_typop.Kind     = pc_apltp.Type;
	  sb_typop.NumOpert = NumOpert;
	  if (NOT GetEQ(sb_typop))
	    ClearRecord(sb_typop);
	    sb_typop.Kind        = pc_apltp.Type;
	    sb_typop.NumOpert    = NumOpert;
	    sb_typop.UpNumOpert  = UpNumOpert;
	    sb_typop.czNameAlg   = Name;
	    sb_typop.CharOper    = CharOper;
	    sb_typop.SysNumb     = SysNumb;
	    sb_typop.IsCur       = pc_apltp.IsCur;
	    if (NOT Insert(sb_typop))
	      INSERT_ERROR = True;
	    end;
	  end;
	end;
      end;
    end;
  end;

  [ ];
  if (INSERT_ERROR)
    [ Error];
  else
    [ Ok];
  end;

end;
