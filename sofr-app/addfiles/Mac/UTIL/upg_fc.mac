/* -@H------------------------------------------------------------------
*   System           : RS-RETAIL             
*
*   File Name        : Upg_fc.mac
*   Sourse Name      :
*
*
*   Description      : Макрос переносит модули,используемые для шагов    
*                    : алгоритма операций, из "Филиала" в "Последконтроль"
*
*   Comment          : Это модули 3200..3300
*                    : Вызывается без параметров
*   Restrictions     : Без ограничений
*   Public routines  :
*   Base files       :
*   Programmer       : Зубов В.Ю.
*
*                 History
*   24.02.1998       : Создан
*
* ----------------------------------------------------------------@H- */

file itemsyst("itemsyst.dbt","bank.def") key 0 write;
Var found,pos;

/*Удаляем записи для последконтроля */
itemsyst.cIdentProgram = "П";/* Последконтроль */
itemsyst.iCaseItem = 3200;

if (GetGE(itemsyst))
  found = True;
  while(found AND (itemsyst.iCaseItem < 3300))
    Delete(itemsyst);
    [# #### - удалена]
     (itemsyst.cIdentProgram,itemsyst.iCaseItem);
    if(not Next(itemsyst))
     found = False;
    end; /* IF */
  end; /* WHILE */
end;/* IF */

/*Добавляем записи для последконтроля */
itemsyst.cIdentProgram = "В";/* Филиал */
itemsyst.iCaseItem = 3200;

if (GetGE(itemsyst))
  found = True;
  while(found AND (itemsyst.iCaseItem < 3300))
    itemsyst.cIdentProgram = "П";/* Последконтроль */
    pos = GetPos(itemsyst);
    Insert(itemsyst);
    [# #### - добавлена]
     (itemsyst.cIdentProgram,itemsyst.iCaseItem);
    GetDirect(itemsyst,pos);
    itemsyst.cIdentProgram = "В";/* Вклады */
    if(not Next(itemsyst))
     found = False;
    end; /* IF */
  end; /* WHILE */
end;/* IF */
