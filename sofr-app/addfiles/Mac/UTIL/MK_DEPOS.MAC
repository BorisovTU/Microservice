/* Заготовка для макроса заполнения файла счетов вкладчиков */

file depo ( depositr ) write;

var ret = TRUE;
var Number = 100100;
var Referenc = 100124;

while ( ret )

   Number = Number + 1;
   Referenc = Referenc + 1;

   depo.Number = Number - 100000;
   depo.Account = "ДВС0" + SubStr( String( Number ), 2 );
   depo.Referenc = "0002000000" + SubStr( String( Referenc ), 2 );

   depo.CodClient = 20000000;
   depo.IsCur = 0;
   depo.FNCash = 20;
   depo.Open_Close = StrFor(0);
   depo.Oper = 9999;
   depo.GroupNumb = "ДО ВОСТРЕБ.";
   depo.Type_Account = "ДО ВОСТРЕБ.";
   depo.PrevAccount = "";
   depo.NextAccount = "";
   depo.SvodAccount = "";
   depo.Code_Currency = 0;
   depo.NumSession = 0;
   depo.Perc_Type = StrFor(0);
   depo.Sum_Out = $0;
   depo.Sum_In = $0;
   depo.Sum_Rest = $0;
   depo.CashRest = $0;
   depo.Final_Date = Date( 0, 0, 0 );
   depo.Previos_Date = Date( 0, 0, 0 );
   depo.Open_Date = Date( 5, 4, 1998 );
   depo.Close_Date = Date( 0, 0, 0 );
   depo.NCurLine = 1;
   depo.UserTypeAccount = "";
   depo.Limit = $0;
   depo.FlagTrast = StrFor(0);
   depo.FlagWill = StrFor(0);
   depo.FlagContr = StrFor(0);
   depo.Start_DateDep = Date( 0, 0, 0 );
   depo.Term = 0;
   depo.KindTerm = StrFor(0);
   depo.End_DateDep = Date( 0, 0, 0 );
   depo.Prol_DateDep = Date( 0, 0, 0 );
   depo.Term_Prol = 0;
   depo.KindTerm_Prol = StrFor(0);
   depo.UseAlternate = 0;
   depo.Givebook = StrFor(0);
   depo.UserField1 = "";
   depo.UserField2 = "";
   depo.UserField3 = "";
   depo.UserField4 = "";
   depo.Action = 0;
   depo.SpecialAccess = 0;
   depo.SumPercOut = $0;
   depo.ConvertRec = StrFor(0);
   depo.FormContr = 0;
   depo.S_NumAccounts = 0;
   depo.StaticRest = $0;
   depo.StaticPaid = StrFor(0);
   depo.RenumDate = Date( 0, 0, 0 );
   depo.ReservDep = "";

   ALG_CONTRACT.BookGiven = StrFor(0);

   ret = insert( depo );
   ALG_CONTRACT.Update;

   if ( Referenc > 110000 )
     ret = FALSE;
   end;

end;

println( " Referenc = ", Referenc );