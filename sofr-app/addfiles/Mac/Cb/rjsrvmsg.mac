/*
$Name:        rjsrvmsg.mac
$Module:      Финансовый мониторинг
$Description: Макрос отчета о групповом выполнении
*/

const   Ошибка   = 0,
    Первый   = 1,
    Последний= 2;

record  FmRjSrvMsg(fmrjsrvmsg);

macro Печать_ОтчетСканирования (Вызов,doc,Статус,Сообщение)
   array StringArray;
   var i = 1;
   var stat;
   setbuff (FmRjSrvMsg,doc);

    if (Вызов==Первый)
[                       Отчет о групповом выполнении.                             ];
[┌─────────────┬────────┬────────────────────────────────────────────────────────┐];
[│     ID      │   №    │                       Сообщение                        │];
[│             │ ошибки │                                                        │];
[├─────────────┼────────┼────────────────────────────────────────────────────────┤];
    elif (Вызов==Ошибка)
         if (Статус == 0)
            Сообщение = "Операция выполнена успешно"
         end;

         if(Статус == 19303)  // Те сообщения, которые не являются ошибками
           Статус = 0;
         end;

         StrSplit(StrSubst(Сообщение, "│", " " ), StringArray, 56);
[│#############│########│########################################################│](FmRjSrvMsg.ID,Статус, StringArray(0));

         while ( StrLen(StringArray(i) ) > 0)
[│             │        │########################################################│](StringArray(i));
           i = i + 1;
         end;

        elif (Вызов==Последний)         
[└─────────────┴────────┴────────────────────────────────────────────────────────┘];
    end;
end;
