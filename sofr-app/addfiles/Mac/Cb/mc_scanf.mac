/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

└───────────────────────────────────────────────────────────────────────────*/


const   Ошибка    = 0,
        Первый    = 1,
        Последний = 2;

RECORD  multycar(multycar);

MACRO Печать_ОтчетСканирования( Вызов, firstdoc, Статус, Сообщение )
   array StringArray;
   var i = 1;
   setbuff( multycar, firstdoc );

    if( Вызов == Первый )
[             Отчет о групповом выполнении.];
[+------+---------+--------+---------------------------------------------------------+];
[|  ID  |    №    |   №    |                 Сообщение                               |];
[|      |документа| ошибки |                                                         |];
[+------+---------+--------+---------------------------------------------------------+];
    
    elif( Вызов == Ошибка )
        if( Статус == 0 )
          Сообщение = "Выполнено успешно"
        end;

        StrSplit(StrSubst(Сообщение, "|", " " ), StringArray, 56);
[|######|#########|########|#########################################################|]
(multycar.CarryID, multycar.Numb_Document, Статус, StringArray(0));
         while ( StrLen(StringArray(i) ) > 0)
[|      |         |        |#########################################################|](StringArray(i));
           i = i + 1;
         end;

        elif (Вызов==Последний)         
[+------+---------+--------+---------------------------------------------------------+];
    end;
END;
