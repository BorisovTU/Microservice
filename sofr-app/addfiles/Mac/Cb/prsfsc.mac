/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prsfsc.mac                                         */
/*                                                                      */
/*  Описание       : Отчет о массовой печати счетов-фактур.             */
/*                                                                      */
/*  Программист    : Попов С.И.                                         */
/*                                                                      */
/*  Создан         : 11.10.06                                           */
/*                                                                      */
/************************************************************************/

const MSG_ERROR:integer = 0,
      MSG_FIRST:integer = 1,
      MSG_LAST :integer = 2;

MACRO Печать_ОтчетСканирования(MessageType:integer, DocBuffer, MessageStat:integer, MessageText:string)
 var stat:integer, i:integer = 1;

 array StringArray;
 record r_factura("bilfactura.dbt", "bank.def");

 SetBuff (r_factura, DocBuffer);

 if (MessageType==MSG_FIRST)

   [    Отчет о групповой печати счетов-фактур.
    +---------------+------+------------------------------------------------------------+
    |     Номер     |Номер |                 Сообщение                                  |
    |   документа   |ошибки|                                                            |
    +---------------+------+------------------------------------------------------------+];

  elif (MessageType==MSG_ERROR)

    if (MessageStat == 0)
      MessageText = "Документ напечатан успешно";
    end;
    StrSplit(StrSubst(MessageText, "|", " " ), StringArray, 56);                
    [|###############|######|############################################################|](r_factura.FacturaNumber, MessageStat, StringArray(0));
    while ( StrLen(StringArray(i) ) > 0)
      [|               |      |############################################################|](StringArray(i));
      i = i + 1;
    end;

  elif (MessageType==MSG_LAST)
    [+---------------+------+------------------------------------------------------------+];
  end;      

END;
