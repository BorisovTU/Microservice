// макрос скроллинга контролируемых состояний

import Globals, BankInter;

record mnstate_buf( mnstate );
record mnfltst    ( mnfltst );

private const SET_CHAR   = "X";
private const UNSET_CHAR = "";

private macro Проверить_документ( Режим )
  var stat:integer = 0;

  if( (Режим == 2) or (Режим == 3) or (Режим == 8) ) 

    if( mnstate_buf.CtrlObjType == 0 )
      MsgBox("Не заполнено обязательное поле 'Контролируемый объект'");
      return 1;
    end;
    
    if( mnstate_buf.IdentProgram == UNSET_CHAR )
      MsgBox("Не заполнено обязательное поле 'Подсистема'");
      return 1;
    end;

    if( mnstate_buf.NumberPoint == 0 )
      MsgBox("Не заполнено обязательное поле 'Пункт меню'");
      return 1;
    end;

    if( mnstate_buf.Name == "" )
      MsgBox("Не заполнено обязательное поле 'Название'");
      return 1;
    end;
  
    /*mnfltst.MnStateID = mnstate_buf.MnStateID;
    if( not GetEQ(mnfltst) )
      MsgBox("Отбор документов по заданным параметрам некорректен");
      return 1;
    end;*/

  end;

  return 0;
end;

private macro CheckFltForPrDoc()

end;