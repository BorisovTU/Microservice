/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prdocsc.mac                                        */
/*                                                                      */
/*  Описание       : Отчет о массовой печати мемориальных ордеров.      */
/*                                                                      */
/*  Программист    : Смирнов С.В.                                       */
/*                                                                      */
/*  Создан         : 23.10.02                                           */
/*                                                                      */
/************************************************************************/

const MSG_ERROR:integer = 0,
      MSG_FIRST:integer = 1,
      MSG_LAST :integer = 2;

MACRO Печать_ОтчетСканирования(MessageType:integer, DocBuffer, MessageStat:integer, MessageText:string)
 var stat:integer, i:integer = 1;
 array StringArray;
 record r_document("acctrn.dbt", "bank.def");

 SetBuff (r_document, DocBuffer);

 if (MessageType==MSG_FIRST)

   [    Отчет о групповой печати мемориальных ордеров.
    +---------+------+------------------------------------------------------------+
    |  Номер  |Номер |                 Сообщение                                  |
    |документа|ошибки|                                                            |
    +---------+------+------------------------------------------------------------+];

  elif (MessageType==MSG_ERROR)

    if (MessageStat == 0)
      MessageText = "Документ напечатан успешно";
    end;
    StrSplit(StrSubst(MessageText, "|", " " ), StringArray, 56);                
    [|#########|######|############################################################|](r_document.Numb_Document, MessageStat, StringArray(0));
    while ( StrLen(StringArray(i) ) > 0)
      [|         |      |############################################################|](StringArray(i));
      i = i + 1;
    end;

  elif (MessageType==MSG_LAST)
    [+---------+------+------------------------------------------------------------+];
  end;

END;
