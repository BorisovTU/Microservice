/*
  $Name:         prpmdmi_lib.mac
  $Module:       Ÿ¤à® Banking
  $Description:  Š« ááë ¨ äã­ªæ¨¨ ¤«ï ¯¥ç â¨ ¯« â¥¦­®£® âà¥¡®¢ ­¨ï
*/

import prpm, gnd120p, "pmlib.mac";

class TPayDemPrnInfo
  var PayerProps   :TPartyProperties = null;
  var ReceiverProps:TPartyProperties = null;
  var partPayList  :TPartPayList = null;

  var Amount        :money   = $0,
      AmountStr     :string  = "";

  var ground        :string  = "",
      AcceptTerm    :string  = "",
      AcceptPeriod  :integer = 0, 
      PayDate       :date    = date(0, 0, 0),
      I2_Date       :date    = date(0, 0, 0),
      Date_Into     :date    = date(0, 0, 0),
      chargeOffDate :date    = date(0, 0, 0),
      UIN           :string  = "",
      DocDate       :date    = date(0, 0, 0),
      DocNumber     :string  = "",
      PaymentKind   :string  = "",
      ShifrOper     :string  = "",
      Priority      :integer = PM_DefaultMaxPriority(),
      PayerBankMarkDate :date= date(0, 0, 0);
end;

/* ¥ç âì ¯« â¥¦­®£® âà¥¡®¢ ­¨ï ¯® 1256-“ */
MACRO PrintPayDem1256(pr : TPayDemPrnInfo):bool
  var PayerProps = pr.PayerProps,
      ReceiverProps = pr.ReceiverProps,
      ground = InterpretGround( pr.Ground );

  ARRAY SS, SG, SBP, SBR, SP, SR, TE, UIN;

  strsplit( pr.AcceptTerm,             TE,    61, 61, 3 );
  strsplit( PayerProps.Name,        SP,    50, 50, 4 );
  strsplit( ReceiverProps.Name,     SR,    50, 50, 4 );
  strsplit( PayerProps.BankName,    SBP,   50, 50, 3 );
  strsplit( ReceiverProps.BankName, SBR,   50, 50, 3 );
  strsplit( ground,                 SG,    77, 77, 3 );
  strsplit( pr.UIN, UIN, 13, 13, 2);
  strsplit( pr.AmountStr, SS, 80, 80, 3 );


    [
                                                                                     ÚÄÄÄÄÄÄÄÄÄ¿
                                                                                     ³ 0401061 ³
          ############            ##########            ##########                   ÀÄÄÄÄÄÄÄÄÄÙ
       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ   ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
       ®áâã¯. ¢ ¡ ­ª ¯« â.  Žª®­ç. áà®ª   ªæ¥¯â   ‘¯¨á ­® á® áç. ¯« â.
       
                                                              ##########  ###############
       ‹€’…†Ž… ’…Ž‚€ˆ… N #######################         ÄÄÄÄÄÄÄÄÄÄ  ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                                                („ â )    (‚¨¤ ¯« â¥¦ )
     ÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄ
      “á«®¢¨¥ ³#############################################################³ ‘à®ª ¤«ï  ³ ####
      ®¯« âë  ³#############################################################³  ªæ¥¯â    ³
              ³#############################################################³           ³
     ÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄ
      ‘ã¬¬    ³ ################################################################################
      ¯à®¯¨áìî³ ################################################################################
              ³ ################################################################################
     ÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ˆ ################################################³ ‘“ŒŒ€ ³#############################
                                                          ³       ³
      ####################################################³       ³
      ####################################################ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ####################################################³ ‘ç.N. ³#############################
      ####################################################³       ³
      ‹€’…‹œ™ˆŠ                                          ³       ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ####################################################³ ˆŠ   ³#############################
      ####################################################ÃÄÄÄÄÄÄÄ´
      ####################################################³ ‘ç.N. ³#############################
      €Š ‹€’…‹œ™ˆŠ€                                    ³       ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      ####################################################³ ˆŠ   ³#############################
      ####################################################ÃÄÄÄÄÄÄÄ´
      ####################################################³ ‘ç.N. ³#############################
      €Š Ž‹“—€’…‹Ÿ                                     ³       ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄ´
      ˆ ################################################³ ‘ç.N. ³#############################
                                                          ³       ³
                                                          ÃÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄ
                                                          ³‚¨¤ Ž¯.³ #########   ³        ³
      ####################################################ÃÄÄÄÄÄÄÄ´             ³Žç¥à.¯«.³ ###
      ####################################################³ §.¯«.³             ³        ³
      ####################################################ÃÄÄÄÄÄÄÄ´             ÃÄÄÄÄÄÄÄÄ´
      ####################################################³Š®¤    ³#############³¥§.¯®«¥³
      Ž‹“—€’…‹œ                                          ³       ³#############³        ³
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄ
       §­ ç¥­¨¥ ¯« â¥¦ :
      ##########################################################################################
      ##########################################################################################
      ##########################################################################################

      „ â  ®âáë«ª¨ (¢àãç¥­¨ï) ¯« â¥«ìé¨ªã ¯à¥¤ãá¬®âà¥­­ëå
      ¤®£®¢®à®¬ ¤®ªã¬¥­â®¢
     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
                                     ®¤¯¨á¨                            Žâ¬¥âª¨ ¡ ­ª  ¯®«ãç â¥«ï

          Œ..
                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

                       ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

                                                                                   „ â  ¯®¬¥é¥­¨ï
      ÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄ    ¢ ª àâ®â¥ªã
       N ç.  ³   N ¯« â.  ³  „ â       ³  ‘ã¬¬        ³  ‘ã¬¬       ³ ®¤¯¨áì      ##########
       ¯« â. ³   ®à¤¥à    ³  ¯« â.     ³  ç áâ¨ç­®£®  ³  ®áâ âª     ³              Žâ¬¥âª¨ ¡ ­ª   
             ³            ³  ®à¤¥à     ³  ¯« â¥¦      ³  ¯« â¥¦     ³              ¯« â¥«ìé¨ª 
      ÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ    ##########
    ]
     (pr.Date_Into:f:c, pr.PayDate:f:c, pr.chargeOffDate:f:c, pr.DocDate:f:c,
      GetPaymentKind(pr.PaymentKind):c, pr.DocNumber:l,
      TE(0), pr.AcceptPeriod:z, TE(1), TE(2),
      SS(0):l, SS(1):l, SS(2), 
      MakeINN_KPP_String(PayerProps.INN), pr.Amount:l:f,
      SP(0):l, SP(1):l, SP(2):l, PayerProps.Account:l, SP(3):l,
      SBP(0):l, PayerProps.BankBIC:l,    SBP(1):l, SBP(2):l, PayerProps.BankCorrAccount:l,
      SBR(0):l, ReceiverProps.BankBIC:l, SBR(1):l, SBR(2):l, ReceiverProps.BankCorrAccount:l,
      MakeINN_KPP_String(ReceiverProps.INN), ReceiverProps.Account:l,
      pr.ShifrOper:l, SR(0):l, pr.Priority:z,
      SR(1):l, SR(2):l, SR(3):l,
      UIN(0),
      UIN(1),
      SG(0):l, SG(1):l, SG(2):l, pr.I2_Date:f, pr.PayerBankMarkDate:f );

    if( pr.partPayList.size > 0 )
      var partPayList : TPartPayList = pr.partPayList;
      var i : integer = 0;

      while(i < partPayList.size)
        [  ##### ³ ########## ³ ########## ³ ############ ³ ########### ³]
        ( partPayList.Value(i).SubPurp:l, 
          partPayList.Value(i).Number:l, 
          partPayList.Value(i).PayDate:f:c,
          partPayList.Value(i).Amount:l:f,
          partPayList.Value(i).Rest:l:f );
        i=i+1;
      end;
      if( partPayList.size )
        [ ÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄ
        ];
      end;
    end;


  
  return TRUE;
  
END;
