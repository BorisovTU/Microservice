/*
$Name:             opercode.mac
$Module:           RS-Retail
$Description:      константы кодов операций
*/


/***************************************************************************\
| OPERCODE.MAC - константы кодов операций                                   |
| Зубов В.Ю. 29-07-97                                                       |
\***************************************************************************/
/* Не вызывать операции с пометкой (комплексная)!!!!*/
Const
Открытие_Cчета                       = 31, /*  Открытие счета(комплексная)         */
Открытие_Наличными                   = 1,  /*  -------------- наличными            */
Открытие_Безналичными                = 51,  /*  -------------- безналичными        */
Открытие_Переводом                   = 58,  /*  -------------- переводом        */

Поиск_счета                          = 2,  /*  Поиск счета   (комплексная)       */
Дополнительный_Взнос                 = 3,  /*  Дополнительный взнос                */
Расход                               = 4,  /*  Расход                              */

Списание                             = 61, /*  Списание      (комплексная)         */
Списание_Простое                     = 62, /*  -------- простое                    */
Списание_По_Раз_Поруч                = 63, /*  -------- по поручению (разовому)    */
Списание_По_Длит_Поруч               = 64, /*  -------- по поручению длительному   */
Списание_Переводом                   = 65, /*  -------- переводом вклада           */
Списание_В_Свой_Филиал               = 66, /*  -------- в свой филиал              */
Списание_В_Чужой_Филиал              = 67, /*  -------- в чужой филиал             */
Списание_Карточное                   = 44,
Зачисление                           = 70, /*  Зачисление     (комплексная)        */
Зачисление_По_Данным_ПК              = 71, /*  ---------- по данным последконтроля */
Зачисление_Процентов                 = 72, /*  ---------- процентов                */
Зачисление_В_Пак_Режиме              = 73, /*  ---------- в пакетном режиме        */
Зачисление_Компенсации               = 74, /*  ---------- компенсации              */

Выдача_Процентов                     = 6,  /*  Выдача процентов                    */
Расчет_Процентов                     = 35, /*  Расчет процентов                    */

Закрытие_Счета                       = 34, /*  Закрытие счета (комплексная)        */
Закрытие_Наличными                   = 10, /*  -------------- наличными            */
Закрытие_Безналичными                = 81, /*  -------------- безналичными         */
Закрытие_Переводом                   = 96, /*  -------------- переводом            */

Безналичная_Конверсия                = 80, /*  Безналичная конвертация             */
Пролонгация_Депозитов                = 82, /*  Пролонгация депозитов               */
Пополнение_Счета                     = 83, /*  Пополнение счета                    */
Оплата_Транзакции                    = 84, /*  Оплата транзакции                   */

Прочие_Операции                      = 40, /*  Прочие операции                     */
Инкассация_Служ_Счета                = 25, /*  Инкассация служ.счета               */
Подкрепление_Служ_счета              = 26, /*  Подкрепление служ. счета            */
Закрытие_Дня                         = 27, /*  Операция закрытия дня               */

Наличная_Комиссия                    = 5,  /*  Наличная комиссия                   */
/*
Безналичная_Комиссия                 = 52, /*  Безналичная комиссия                */
*/
Переплата_Процентов                  = 55, /* По акту Последконтроля               */
Недоплата_Процентов                  = 57,

Перевод_В_Альт_Сост                  = 85, /*  Перевод вклада в ALT состояние      */
Перевод_В_Доп_Сост                   = 86, /*  -------//------- DEP --//-----      */

Выдача_Компенсации                   = 15, /*  Выдача компенсации                  */

Перевод_В_Другой_Вид_Вклада          = 78, /*  Смена вида вклада                   */

Деноминация                          = 0,  /*  Деноминация                         */
Служебная_операция                   = 999;/*  Служебная                           */

/*- Подоперации -----------------------------------------------------------*/
Const
  Без_Подоперации       =  0,
/*
  Зачисление_Зарплаты   =  1,   /* Зачисление заработной платы */
  Зачисление_Пенсии     =  2,   /* Зачисление пенсии */
*/
/* подоперации безналичного открытия счета */

 Открытие_Зарплатой     =  1,   /*  зарплата */
 Открытие_Пенсией       =  2,   /*  пенсия */
 Открытие_Выигрышем     =  3,   /*  выигрыш */
 Открытие_Прочее        =  4,   /*  другие */
 Открытие_Компенсацией  = 10,   /*  компенсации */

 /* подоперации cписания */

 Безналичная_Комиссия          =  7, /* Безналичная комиссия */
 Налог_Нерезидентов            =  8, /* Подоходный налог на нерезидентов */
 Спис_По_Данным_ПК             =  9, /* По данным последконтроля */
 Оплата_Покупки_ЦБ             = 10, /* Оплата покупки ЦБ */
 Безналичная_Конвертация       = 11, /* Безналичная_Конвертация */
 Налог_Ставки_Рефинансирования = 14, /* Налог при превышении ставки рефинансирования */
 /* подоперации зачисления */

 Зач_По_Данным_ПК       =  9,   /* По данным последконтроля */

 /* подоперации зачисления процентов */

 Излишне_Причисленные   =  1,    /*  отчисление излишне причисленных */
 Оплата_Овердрафта      =  2,    /*  оплата овердрафта */
 За_Прошлые_Периоды     =  3,    /*  оплата процентов за прошлые периоды */
 Зач_За_Полные_Месяцы   =  4,    /*  за полные месяцы хранения */

 /* подоперации пакетного зачисления */
 Зачисление_Зарплаты    =  1,    /* Зачисление заработной платы */
 Зачисление_Пенсии      =  2,    /* Зачисление пенсии */
 Зачисление_Выигрыша    =  3,    /*  выигрыш */
 Зачисление_Прочее      =  4,    /*  другие */
 Зачисление_Компенс     = 10,    /*  компенсации */
 Отвергнутые_Зачисления = 50,    /*  отвергнутые зачисления */

 /* подоперации смены вида вклада */
 Списания_При_Смене     =  1,    /* списания */
 Зачисления_При_Смене   =  2,    /* зачисления */

 /* подоперации безналичного закрытия */
 Закрытие_Ручное        =  1,    /* ручной режим */
 Закрытие_В_Неподвижные =  8,    /* переводом в неподвижные и объедин. */

 /* подоперации наличног закрытия */
 Нал_Закрытие_Ручное    =  1,    /* ручной режим */
/*----------- Вид комиссии --------------------------------------------*/
 Тип_БезналКоммиссия    =  0,    /* Безналичная */
 Тип_НалКомиссия        =  21,    /* Наличная */
 Тип_БезналКонверсия    =  31,    /* Конвертация (безналичная) */

 /* подоперации внутренних переводов */
 ЗачислениеНаСчетПолуч  =  11,   /* Зачисление на счет получателя */

 /* подоперации выдачи процентов */
 За_Полные_Месяцы_Уст   =  1,    /* Старый код подоперации */
 За_Полные_Месяцы       =  4,    /* Новый  код подоперации */
 Выдача_Расчитанных_Проц= 22;    /* Выдача расчитанных, но не оплаченных процентов */

/**************************************************************************\
|                   Является ли операция закрытием счета                   |
\**************************************************************************/
macro IsOperCloseAcc( sb_dep_doc )

  var stat = FALSE;

  if ((sb_dep_doc.TypeComplexOper == Закрытие_Наличными) AND
      (sb_dep_doc.TypeOper        == Расход ) )
    stat = TRUE;
  elif ((( sb_dep_doc.TypeComplexOper == Закрытие_Безналичными  )  OR
         ( sb_dep_doc.TypeComplexOper == Закрытие_Переводом     ) )  AND
        (( sb_dep_doc.TypeOper        == Списание_По_Раз_Поруч  )  OR
         ( sb_dep_doc.TypeOper        == Списание_По_Длит_Поруч )  OR
         ((sb_dep_doc.TypeOper        == Списание_Переводом )  AND
          (sb_dep_doc.ApplType        != 11 ) )  OR
         ( sb_dep_doc.TypeOper        == Списание_В_Свой_Филиал  )  OR
         ( sb_dep_doc.TypeOper        == Списание_В_Чужой_Филиал )  OR
         ((sb_dep_doc.TypeOper        == Безналичная_Конверсия )  AND
          (sb_dep_doc.ApplType        != 12 ) ) ) )
    stat = TRUE;
  end;

  return stat;

end;
