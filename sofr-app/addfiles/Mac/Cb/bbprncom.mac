/*
   Общие функции и переменные для макросов печати

   2.02.200 NIKA
*/

 import BankInter, PTInter, FIInter, PaymInter, rslx, globals;

/* ===================================================================== */
 const
   КоличествоКопий  = 0;

 /*CONST ПутьНастройкиИспользованияVRSLВалютномПоручении = "BBANK\\CPORDER\\ORDER\\USE_VRSL";
 CONST ПутьНастройкиИспользованияVRSLВалютномПереводе  = "BBANK\\CPTRANSFER\\ORDER\\USE_VRSL";*/

var  MassCopy = 0;

/* ===================================================================== */

macro ПолучитьISOКод( FIID )
record fi ( fininstr );

  if( FIID != ALLFININSTR )
    if( ПолучитьФинИн( FIID, fi ) == 0 )
      return int(fi.ISO_Number);
    else
      return "";
    end;
  else
    return "";
  end;

end;

macro Cut( text )

  var position;
  position = Index( text, "\n");
  while(position)
      text = SubStr( text, 1, position-1) +" "+ SubStr( text, position+1 );
      position = Index( text, "\n");
  end;
  SetParm( 0, text );
end;

macro MakeString()

  var resultStr, i, str;
  resultStr = "";

  if( GetParm( 0, str ) )
    resultStr = str;
    i = 1;
    while( GetParm( i, str ) )

      if( Trim(str) != "" )
        resultStr = resultStr + ", " + str;
      end;
      i = i + 1;

    end;
  end;

  return resultStr;

end;

/* Заполнить массив из двух строк наименованием главы */
MACRO GetNameChapter(chapter:integer,SCH:ArrayRef,len:integer)
  private FILE obchaptr(obchaptr);
  var   NameChapter:string = "";
  var   ShortNameChapter:string = "";
  ARRAY returnSCH;
  returnSCH(0) = returnSCH(1) = "";

  obchaptr.Chapter = chapter;
  if(getEQ(obchaptr))
    NameChapter      = string("Глава \"", obchaptr.Name,     "\"");
    ShortNameChapter = string("Глава \"", obchaptr.ShortName,"\"");
  else
    msgbox ("Не найдена глава: \"" + string(chapter) + "\"");
  end;

  strsplit(NameChapter, returnSCH, 80, len, 2);

  if(strlen(returnSCH(1)) > len)
    strsplit(ShortNameChapter, returnSCH, len, len, 2);
  end;

  SetParm(1,returnSCH);

END;
