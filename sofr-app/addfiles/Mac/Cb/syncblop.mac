import rsd, "globals.mac";

var cmd : RsdCommand;

macro ¥ç âì˜ ¯ª¨¡­®¢«¥­¨ï() : bool
[‚‹Ÿ…Œ›… ‹Šˆ ˆ ‚ˆ„› …€–ˆ‰

];
  return true;
end;

macro ¥ç âì˜ ¯ª¨«®ª () : bool
[
‹Šˆ ˆ ‚ˆ„› …€–ˆ‰, ‚ Š’›• ˆ ˆ‘‹œ‡“’‘Ÿ

];
  return true;
end;

macro ¥ç âì˜ ¯ª¨‚¨¤ ¯¥à æ¨¨() : bool
[
‚ˆ„› …€–ˆ‰

];
  return true;
end;

macro ¥ç âì«®ª ( Block : integer ) : bool

  var str : string;
  var sqlString : string;
  var rs : RsdRecordset;

  sqlString = "SELECT t_Name FROM doprblock_dbt WHERE t_BlockID = " + Block + "; ";

  cmd = RsdCommand( sqlString );
  cmd.NullConversion = true;
  rs = RsdRecordset( cmd );

  if( rs.moveNext())
    str = Block + " " + rs.value(0);
    println( str );
  end;

  sqlString = "SELECT t_Kind_Operation, t_Name FROM doprkoper_dbt " + 
              "WHERE t_Kind_Operation IN (SELECT t_Kind_Operation FROM DOPROBLCK_DBT WHERE t_BlockID = " + Block + "); ";

  cmd = RsdCommand( sqlString );
  cmd.NullConversion = true;
  rs = RsdRecordset( cmd );

  while( rs.moveNext())
    str = "        " + rs.value(0) + " " + rs.value(1);
    println( str );
  end;
  
  return true;
end;

macro ¥ç âì‚¨¤ ¯¥à æ¨¨( KOper : integer) : bool

  var str : string;
  var sqlString : string;
  var rs : RsdRecordset;

  sqlString = "SELECT t_Name FROM doprkoper_dbt WHERE t_Kind_Operation = " + KOper + "; ";

  cmd = RsdCommand( sqlString );
  cmd.NullConversion = true;
  rs = RsdRecordset( cmd );

  if( rs.moveNext())
    str = KOper + "    " + rs.value(0);
    println( str );
  end;

  return true; 
end;
