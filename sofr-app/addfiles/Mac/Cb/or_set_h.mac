/*
$Name:        or_set_h.mac
$Module:      Ядро ГКБО
$Description: Инструмент для создания универсальных отчетов (настройки)
*/

IMPORT "or_const.mac"; /* Константы, применяемые в инструменте */

/* ОБЩИЕ ИНСТРУМЕНТАЛЬНЫЕ НАСТРОЙКИ */
VAR DefaultTxtBegStr   :integer = 0;                                          /* Номер первой строки в текстовом отчете по умолчанию */
VAR DefaultTxtPageSize :integer = 60;                                         /* Размер страницы в текстовом отчете по умолчанию (обычно 60) */
VAR StatusIndicatorRep :string  = " Обработка и печать отобранных записей...";/* Статусная строка индикатора для формирования отчета */
VAR TitulIndicatorRep  :string  = "Формирование отчета...";                   /* Заголовок индикатора для формирования отчета */
VAR NameDirTerm        :string  = "$TxtFile\\";                               /* Путь к временному файлу для формирования отчета на терминале в трехзвенке  */ 
VAR NameMacDirTerm     :string  = "$Mac\\";                                   /* Путь к макросам инструмента и спецформатирования на терминале в трехзвенке */ 
VAR NameTemplateDirTerm:string  = "Template";                                 /* Путь к шаблонам на терминале в трехзвенке                                  */ 
VAR FlagHighQualityRep :bool    = False;                                      /* Флаг высококачественного отчета (при значении False упрощает некоторые 
                                                                                 алгоритмы, тем самым уменьшает время создания отчета, но ухудшает его качество) */
VAR FlagTerminalClone  :bool    = True;                                       /* Флаг автоматического клонирования инструмента в трехзвенке на вызвавшем его терминале... */

/*11.02.2020 RAS:505069, 504825 Вернул дистрибутивное значение MAXROWSHEET*/
/*17.04.2020 BPV добавил параметр в метод AddRow (IgnoreMAXROWSHEET) - нужно передавать true если вывод идет в xslx и ограничене на колво строк не требуется*/
VAR MAXROWSHEET:integer = MAX_ROWSHEET_XLS;                                   /* Максимальное кол-во строк на лист. Их конечно 65536, но установим с запасом (плюс заголовки, т.к. их точно не учтешь) */

VAR ROW_FLUSH_COUNT:integer = FLUSH_COUNT_XLS;                                /* Количество записей, при достижении которого, содержимое листа сбрасывается на диск. Используется при выводе больших отчетов в POI */ 

/* Массив значений констант для элементов типа "ячейка таблицы" */
/* Внимание!!! Здесь должны быть добавлены все необходимые константы! */
VAR ArrConstTabl:TArray = TArray;
    ArrConstTabl[ArrConstTabl.Size()] = REP_ELEM_TABL;
    ArrConstTabl[ArrConstTabl.Size()] = REP_ELEM_SHOWSEP;

// Структура для хранения данных по кодировкам
class WREnCode( _encode :string, _charset:string, _csvCoding:integer, _webCharSet )
    var encode   :string   = _encode   ;  // Кодировка для открытия файлов txt-файлов RS-инструментом
    var charset  :string   = _charset  ;  // Кодировка для для html-файлов, для заполнения поля charset в заголовке
    var csvCoding:integer  = _csvCoding;  // Кодировка для csv-файлов (для xls-шаблонов)
    var webCharSet:string  = _webCharSet;
end;

//  Настройки кодировки инструмента
var WR_lsEncode:tarray = TArray;
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("rsoem"  , "866"         , xlMSDOS  , "Cp866");   // RSOEM    кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("rsansi" , "windows-1251", xlWindows, "Cp1251");  // RSANSI   кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("lcoem"  , "lcoem"       , xlMSDOS  , "Cp866");   // LCOEM    кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("lcansi" , "lcansi"      , xlWindows, "Cp1251");  // LCANSI   кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("utf8"   , "utf-8"       , xlUTF8   , "UTF-8");   // UTF-8    кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("utf16le", "utf-16"      , xlUTF8   , "UTF_16LE");// UTF-16LE кодировка
    WR_lsEncode[WR_lsEncode.Size] = WREnCode("utf16be", "utf-16"      , xlUTF8   , "UTF_16BE");// UTF-16BE кодировка

VAR WR_CURRENCODE:integer = 1; // Текущая кодировка (номер из массива - для скорости, чтобы потом не сравнивать сроки)

/**/
