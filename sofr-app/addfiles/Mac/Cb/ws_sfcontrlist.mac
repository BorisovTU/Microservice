 /*
 $Name: ws_sfcontrlist.mac
 $Module: Главная книга
 $Description: Макрос виджета ServContractListingWidget
 */

import "ws_sfcontrclass.mac";

///////////////////////////////////////////////////////////
// Получить список
// PageSize - размер страницы
// PageNum - номер страницы НАЧИНАЯ С 0 !!!
///////////////////////////////////////////////////////////

macro GetSfContrList
(
  pagesize      : integer,
  pagenum       : integer,
  FilterParm,                 // параметры фильтрации
  DateConcBegin : date,       // Начало диапазона дат заключения ДО
  DateConcEnd   : date,       // Конец диапазона дат заключения ДО
  WhereCond     : string,     // Дополнительное SQL-условие
  NumberLk      : string,     // пользовательский код ДО
  listLen       : integer,    // длина списка
  orderitems,
  param
)

  var obj = SfContrList();

  return obj.GetList(pagesize, pagenum, FilterParm, DateConcBegin, DateConcEnd, WhereCond, NumberLk, listLen, orderitems);


end;

///////////////////////////////////////////////////////////
// Получить общее количество
///////////////////////////////////////////////////////////

macro GetSfContrCount
(
  FilterParm,                 // параметры фильтрации
  DateConcBegin : date,       // Начало диапазона дат заключения ДО
  DateConcEnd   : date,       // Конец диапазона дат заключения ДО
  WhereCond     : string,     // Дополнительное SQL-условие
  listLen       : integer,    // длина списка
  orderitems,
  param
):integer

  var obj = SfContrList();

  return obj.GetCount( FilterParm, DateConcBegin, DateConcEnd, WhereCond, listLen,orderitems );

end;

////////////////////////////////////////////////
// Возвращает номер строки
////////////////////////////////////////////////

macro GetSfContrRowNum
(
  SfContrID     : integer,
  FilterParm,                 // параметры фильтрации
  DateConcBegin : date,       // Начало диапазона дат заключения ДО
  DateConcEnd   : date,       // Конец диапазона дат заключения ДО
  WhereCond     : string,     // Дополнительное SQL-условие
  listLen       : integer,    // длина списка
  orderitems,
  param
):integer

  var obj = SfContrList();

  return obj.GetRowNum( SfContrID, FilterParm, DateConcBegin, DateConcEnd, WhereCond, listLen, orderitems );

end;

///////////////////////////////////////////////////////////
// Возвращает список субъектов длинны listLen по
// частичному совпадению значения
///////////////////////////////////////////////////////////

macro LookupSfContrByNumber
(
  pagesize      : integer,
  pagenum       : integer,
  FilterParm,                 // параметры фильтрации
  DateConcBegin : date,       // Начало диапазона дат заключения ДО
  DateConcEnd   : date,       // Конец диапазона дат заключения ДО
  WhereCond     : string,     // Дополнительное SQL-условие
  NumberLk      : string,     // пользовательский код ДО
  listLen       : integer,    // длина списка
  orderitems,
  param
)

  var obj = SfContrList();

  return obj.GetList(pagesize, pagenum, FilterParm, DateConcBegin, DateConcEnd, WhereCond, NumberLk, listLen, orderitems);

end;