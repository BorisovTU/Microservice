/*
$Name:             Prcsio3352u.mac
$Module:            ¨ Š
$Description:      ¥ç âì ¯à¨å®¤­®£® ª áá®¢®£® ®à¤¥à  3352-“
*/

import prcs;
    
/* -----------------------------------------------
   ¥¯®áà¥¤áâ¢¥­­® ¯¥ç âì ¯® ¯®¤£®â®¢«¥­­ë¬ ¤ ­­ë¬
   ----------------------------------------------- */

PRIVATE MACRO PrintIncCashOrder( d : TIncOrderPrintData3352, ncopy : integer ):bool                                                                                

  array ArrayClient, ArrayPayerBankName, ArrayReceiverBankName, ArrayGround, ArrayReceiverName, ArraySum;
  StrSplit (d.Client, ArrayClient, 43, 35, 2);
  StrSplit(d.PayerBankName, ArrayPayerBankName, 55, 41, 2);
  StrSplit(d.ReceiverBankName, ArrayReceiverBankName, 55, 41, 2);
  StrSplit(d.Ground, ArrayGround, 100, 80, 2);
  StrSplit(d.ReceiverName, ArrayReceiverName, 43, 32, 3);
  StrSplit(d.SumString, ArraySum, 70, 56, 2);
      
  /*¥ç âì*/
  while(ncopy > 0)  
    ncopy = ncopy - 1;
    [                                                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿  Ú Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä ¿
                                                       ³Š®¤ ä®à¬ë ¤®ªã¬¥­â ³  ³âàë¢­®© â «®­ ª à áå®¤­®¬ã³
                                                       ³  ¯® Š“„ 0402008  ³  ³ª áá®¢®¬ã ®à¤¥àã ü ########³
                                                       ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ  À Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ä Ù
                                                                                                  
                                 ÚÄÄÄÄÄÄÄÄÄ¿                                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
      à¨å®¤­ë© ª áá®¢ë© ®à¤¥à N ³#########³          ####################### ³    Œ¥áâ® ¤«ï ­ ª«¥©ª¨     ³
                                 ÀÄÄÄÄÄÄÄÄÄÙ            ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ  ³     ®âàë¢­®£® â «®­       ³
                                                               „ â            ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                              „……’           ³     ‘ã¬¬  æ¨äà ¬¨         ³
                                                  ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄ´
      â ª®£® ################################### ³áç¥â ü ####################³### #################³     ³
              ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                     ³     ³
      ###########################################             Š…„ˆ’          ³                     ³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                     ³     ³
      ®«ãç â¥«ì ################################ ³áç¥â ü ####################³### #################³     ³
                 ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³### #################³     ³]
     (d.Number:l, 
      d.Number:c, d.DateStr:c, 
      ArrayClient(0), d.PayerAccount:l, d.FICode, d.AmountStr:r, 
      ArrayClient(1), 
      ArrayReceiverName(0), d.CreditList.value(0).Account:l, d.CreditList.value(0).FICode,  d.CreditList.value(0).Amount:r,
      d.CreditList.value(1).Account:l, d.CreditList.value(1).FICode,  d.CreditList.value(1).Amount:r);

    if (d.CreditList.size == 2)      
    [ ########################################### ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄ´
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                            ³                           ³
      ###########################################                             ³                           ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                            ³                           ³]
     (ArrayReceiverName(1),
      ArrayReceiverName(2));
    end;
    if (d.CreditList.size == 3)      
    [ ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄ´
      ###########################################                             ³                           ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                            ³                           ³]
     (ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode,  d.CreditList.value(2).Amount:r, 
      ArrayReceiverName(2));
    end;
    if (d.CreditList.size == 4)      
    [ ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³### #################³     ³
      ########################################### ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄ´
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ                            ³                           ³]
     (ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode,  d.CreditList.value(2).Amount:r, 
      d.CreditList.value(3).Account:l, d.CreditList.value(3).FICode,  d.CreditList.value(3).Amount:r, 
      ArrayReceiverName(2));
    end;
    if (d.CreditList.size == 5)      
    [ ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³### #################³     ³
      ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄ´]
     (ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode,  d.CreditList.value(2).Amount:r, 
      d.CreditList.value(3).Account:l, d.CreditList.value(3).FICode,  d.CreditList.value(3).Amount:r, 
      ArrayReceiverName(2), d.CreditList.value(4).Account:l, d.CreditList.value(4).FICode,  d.CreditList.value(4).Amount:r );
    end;
    if (d.CreditList.size > 5)      
    [ ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³### #################³     ³
      ########################################### ³       ####################³### #################³     ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ³       ####################³### #################³     ³]
     (ArrayReceiverName(1), d.CreditList.value(2).Account:l, d.CreditList.value(2).FICode,  d.CreditList.value(2).Amount:r, 
      d.CreditList.value(3).Account:l, d.CreditList.value(3).FICode,  d.CreditList.value(3).Amount:r, 
      ArrayReceiverName(2), d.CreditList.value(4).Account:l, d.CreditList.value(4).FICode,  d.CreditList.value(4).Amount:r, 
      d.CreditList.value(5).Account:l, d.CreditList.value(5).FICode,  d.CreditList.value(5).Amount:r ); 

      var i : integer = 6;
      while( i < d.CreditList.size )
        if (d.CreditList.value(i).Account == "") 
          break; 
        end;        
    [                                             ³       ####################³### #################³     ³]
        (d.CreditList.value(i).Account:l, d.CreditList.value(i).FICode, d.CreditList.value(i).Amount:r);
         i = i + 1;
      end;
    [                                             ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄ´]     
    end;

    [                                                                         ³                           ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³
      ˆ ############                       ‘ç¥â ü ######################### ³                           ³
          ÄÄÄÄÄÄÄÄÄÄÄÄÄ                             ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³]
      (d.ReceiverINN, d.CreditList2.value(0).Account:l);
    i = 1;
    while( i < d.CreditList2.size )
      if (d.CreditList2.value(i).Account == "") 
        break; 
      end;        
    [                                               ######################### ³                           ³
                                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´                           ³]
      (d.CreditList2.value(i).Account:l);
      i = i + 1;
    end;
     
    [                                                                         ³  ¢ â®¬ ç¨á«¥ ¯® á¨¬¢®« ¬: ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¢­®á¨â¥«ï  ######################################### ³  á¨¬¢®« ³       áã¬¬      ³ 
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ####################################################### ˆŠ ########## ³   ####  ³ ##############  ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ¨¬¥­®¢ ­¨¥ ¡ ­ª -¯®«ãç â¥«ï ######################################### ³   ####  ³ ##############  ³
                                    ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
       ####################################################### ˆŠ ########## ³   ####  ³ ##############  ³
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ     ÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ‘ã¬¬  ¯à®¯¨áìî ######################################################## ³   ####  ³ ##############  ³
                     ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
      ####################################################################### ³   ####  ³ ##############  ³]
    
      (ArrayPayerBankName(0),
       ArrayPayerBankName(1), d.BIC1,d.ArraySym.value(0):c, MakeMoneyStr3352(d.ArrayPartSum.value(0)):r, 
       ArrayReceiverBankName(0), d.ArraySym.value(1):c, MakeMoneyStr3352(d.ArrayPartSum.value(1)):r, 
       ArrayReceiverBankName(1), d.BIC2, d.ArraySym.value(2):c, MakeMoneyStr3352(d.ArrayPartSum.value(2)):r,  
       ArraySum(0), d.ArraySym.value(3):c, MakeMoneyStr3352(d.ArrayPartSum.value(3)):r,  
       ArraySum(1), d.ArraySym.value(4):c, MakeMoneyStr3352(d.ArrayPartSum.value(4)):r );  

    var CashSymbCount = 6;
    while( CashSymbCount < d.ArraySym.size )
      if (d.ArraySym.value(CashSymbCount) == "") 
        break; 
      end;        
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´
                                                                              ³   ####  ³ ##############  ³]
      (d.ArraySym.value(CashSymbCount):c, MakeMoneyStr3352(d.ArrayPartSum.value(CashSymbCount)):r );
      CashSymbCount = CashSymbCount + 1;
    end;
    
    [ ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄ´
                                                                              ³ ˜¨äà ¤®ªã¬¥­â    ³   ##   ³
                                                                              ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÙ]
      (d.ShifrOper:c);                                                                             
    [ ˆáâ®ç­¨ª ¯®áâã¯«¥­¨ï ################################################################################        
                           ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
      #####################################################################################################                 
      ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ 
      
      ‚­®á¨â¥«ì __________ _______________ _________  _____________ ________________ ________  ____________                       
                 («¨ç­ ï   (­ ¨¬¥­®¢ ­¨¥   («¨ç­ ï      (ä ¬¨«¨ï,    (­ ¨¬¥­®¢ ­¨¥   («¨ç­ ï    (ä ¬¨«¨ï,     
                 ¯®¤¯¨áì)    ¤®«¦­®áâ¨)    ¯®¤¯¨áì)     ¨­¨æ¨ «ë)      ¤®«¦­®áâ¨)     ¯®¤¯¨áì)   ¨­¨æ¨ «ë) ]
      (ArrayGround(0),
       ArrayGround(1)           
     );               
   end;                                                                                             
                                                                                    
  return TRUE;

END;

/* ãä¥à ¬ã«ìâ¨¢ «îâ­®£® ¤®ªã¬¥­â , çâ®¡ë ¯¥ç âì ­¥ àã£ « áì */
var pr_multydoc:TRecHandler = TRecHandler( "multydoc.dbt" );
/* ãä¥à ¬¥¬®à¤¥à , çâ®¡ë ¯¥ç âì ­¥ àã£ « áì */
var pr_cb_doc  :TRecHandler = TRecHandler( "cb_doc.dbt"   ); 

/*------------------------------------------------------------------------
  ¥ç âì ¯à¨å®¤­®£® ª áá®¢®£® ®à¤¥à  ¨§  ¨ Š 3352-“
  ncopy:integer - ç¨á«® ª®¯¨©
  ------------------------------------------------------------------------*/

MACRO PrintDocument(ncopy:integer):bool

  var DocKind:integer = pr_pmpaym.rec.DocKind;
  var data : TIncOrderPrintData3352 = TIncOrderPrintData3352();

  if( ( DocKind == 410/*CASH_PS_INCORDER*/ ) or ( DocKind == 430/*CASH_BOF_INCORDER*/ ) )
    data.InitByCashOrder( pr_pmpaym, pr_pmrmprop, pr_pscshdoc );  
  elif( ( DocKind == CB_MULTYDOC ) or ( DocKind == DLDOC_MEMORIALORDER ) )
    data.InitByMemorialDocument( pr_pmpaym, pr_pmrmprop );
  else
    MsgBox("„ ­­ë© ¢¨¤ ¤®ªã¬¥­â  ­¥ ¯®¤¤¥à¦¨¢ ¥âáï ¬ ªà®á®¬");
    return FALSE;
  end;
  if( pr_PrintEA )
    PrintEAHeader();
  end;

  return PrintIncCashOrder(data, ncopy);

END;
