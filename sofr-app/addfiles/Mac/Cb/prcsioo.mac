/*
 $Name:        prcsioo.mac
 $Module:      ББ
 $Description: Печать приходно-расходного кассового ордера
*/
/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2012              */
/*                                                                      */
/*  Имя файла      : prcsioo.mac                                        */
/*                                                                      */
/*  Описание       : Печать приходно-расходного кассового ордера        */
/*                                                                      */
/************************************************************************/

import globals, FIInter, PTInter, PaymInter, oprinter;
import prpm, prcs, prcs_common;
IMPORT oralib, likepy;
import RsbDataSet;

PRIVATE MACRO PrintIncCashOrder( d : TInOutOrderPrintData, ncopy : integer ):bool                                                                                
  var CashSymbCount = 3;                         
  array ArrayGround, ArraySum;
  StrSplit(d.Ground, ArrayGround, 72, 62, 3);
  StrSplit(d.SumString, ArraySum, 27, 27, 3);
  while(ncopy > 0)  
    ncopy = ncopy - 1;

    [                                                                     
                                           ┌──────────┐                                                                ┌──────────┐                        
       Приходно-расходный кассовый ордер N │ ######## │                         │  Приходно-расходный кассовый ордер N │ ######## │
                                           └──────────┘                         │                                      └──────────┘
       #########################                                                │  #########################
                                                                                │
       ПРИХОДНАЯ ЧАСТЬ                                                          │  РАСХОДНАЯ ЧАСТЬ
                                                                                │
       От кого ################################################################ │  Выдать #################################################################
       ─────────────────────────────────────────────────────────────────────────┼───────────────────────────────────────────────────────────────────────────┐
                               (фамилия, имя, отчество)                         │                           (фамилия, имя, отчество)                        │ 
                                                                                │                                                                           │
       Банк отправитель ##################################################      │  Банк получатель  ##################################################      │
       ─────────────────────────────────────────────────────────────────────────┼───────────────────────────────────────────────────────────────────────────┤
       Банк получатель  ##################################################      │  Банк отправитель ##################################################      │
       ───────────────────────────────────────────┬─────────────────────────────┼─────────────────────────────────────────────┬─────────────────────────────┤
                                                  │     ###################     │                                             │     ###################     │
                       ДЕБЕТ                      │        Сумма цифрами        │                 ДЕБЕТ                       │        Сумма цифрами        │
       ┌──────────────────────────────────────────┼─────────────────────────────┤  ┌──────────────────────────────────────────┼─────────────────────────────┤
       │ счет № #########################         │         в том числе         │  │ счет № #########################         │         в том числе         │
       └──────────────────────────────────────────┤         по символам:        │  └──────────────────────────────────────────┤         по символам:        │
                      КРЕДИТ                      │                             │                 КРЕДИТ                      │                             │
       ┌──────────────────────────────────────────┼────────┬────────────────────┤  ┌──────────────────────────────────────────┼────────┬────────────────────┤
       │ счет № #########################         │ символ │       сумма        │  │ счет № #########################         │ символ │        сумма       │
       └──────────────────────────────────────────┼────────┼────────────────────┤  └──────────────────────────────────────────┼────────┼────────────────────┤
       Сумма прописью ########################### │  ####  │  ################  │  Сумма прописью ########################### │  ####  │  ################  │
                      ########################### │  ####  │  ################  │                 ########################### │  ####  │  ################  │
                      ########################### │  ####  │  ################  │                 ########################### │  ####  │  ################  │
    ](d.Number:c,d.Number:c,
      d.DateStr:l,d.DateStr:l,
      d.Client:l,d.Client:l,
      d.PayerBankName:l,d.ReceiverBankName:l,
      d.PayerBankName:l,d.ReceiverBankName:l,
      d.Amount:r, d.PayAmount:r,
      d.PayerAccount:l, d.PayerAccount:l,
      d.ReceiverAccount:l, d.ReceiverAccount:l,
      ArraySum(0), d.ArraySym.value(0):c, d.ArrayPartSum.value(0):r, ArraySum(0), d.ArraySym2.value(0):c, d.ArrayPartSum2.value(0):r,
      ArraySum(1), d.ArraySym.value(1):c, d.ArrayPartSum.value(1):r, ArraySum(1), d.ArraySym2.value(1):c, d.ArrayPartSum2.value(1):r,
      ArraySum(2), d.ArraySym.value(2):c, d.ArrayPartSum.value(2):r, ArraySum(2), d.ArraySym2.value(2):c, d.ArrayPartSum2.value(2):r);

    if( (d.ArraySym.size <= 3) and  (d.ArraySym2.size <= 3))
    [  ───────────────────────────────────────────┴────────┴────────────────────┼─────────────────────────────────────────────┴────────┴────────────────────┘];
    else
      while( (CashSymbCount < d.ArraySym.size) and  (CashSymbCount < d.ArraySym2.size))
     
    [                                             │  ####  │  ################  │                                             │  ####  │  ################  │](d.ArraySym.value(CashSymbCount):c, d.ArrayPartSum.value(CashSymbCount):r,d.ArraySym2.value(CashSymbCount):c, d.MoneyStyle(d.ArrayPartSum2.value(CashSymbCount)):r);
 
        CashSymbCount = CashSymbCount + 1;
      end;
      if (d.ArraySym.size > d.ArraySym2.size) 
        while( CashSymbCount < d.ArraySym.size)
    [                                             │  ####  │  ################  │                                             │        │                    │](d.ArraySym.value(CashSymbCount):c, d.ArrayPartSum.value(CashSymbCount):r);
          CashSymbCount = CashSymbCount + 1;
        end;
      else
        while( CashSymbCount < d.ArraySym2.size)
    [                                             │  ####  │  ################  │                                             │        │                    │](d.ArraySym2.value(CashSymbCount):c, d.ArrayPartSum2.value(CashSymbCount):r);
          CashSymbCount = CashSymbCount + 1;
        end;

      end;
    [  ───────────────────────────────────────────┴────────┴────────────────────┼─────────────────────────────────────────────┴────────┴────────────────────┘];   
    end;  


    [                                                                           │
       Основание ############################################################## │  Основание ############################################################## 
       ######################################################################## │            ############################################################## 
       ######################################################################## │            ##############################################################
    ](ArrayGround(0),ArrayGround(0),
      ArrayGround(1),ArrayGround(1),
      ArrayGround(2),ArrayGround(2));  
    [                                                                           │
       ─────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────
                                                                                │
       Вноситель        ________________  _____________________________________ │  Бухгалтерский  ________________         ##################################
                        (личная подпись)            (фамилия и инициалы)        │  работник       (личная подпись)                 (фамилия и инициалы)                                                            
       ─────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────
                                                                                │
       Бухгалтерский    ________________  ##################################### │  Контроллер     ________________          _________________________________
       работник         (личная подпись)            (фамилия и инициалы)        │                 (личная подпись)                 (фамилия и инициалы)                                                            
                                                                                │
       ─────────────────────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────────
                                                                                │
       Получил кассовый                                                         │  Получил по документу, удостоверяющему личность
       работник         ________________  ##################################### │  #########################################################################
                        (личная подпись)            (фамилия и инициалы)        │  (наименование документа, номер, кем и когда выдан)
                                                                                │
                                                                                │  Выдал кассовый ________________        ##################################
                                                                                │  работник       (личная подпись)                 (фамилия и инициалы)
  


   ](d.BworkName:c,d.BworkName:c,d.CworkName:c, d.Document:l:w, d.CCworkName:c);
      
  end;
    return true;  
END;


/*  Печать приходно-расходного кассового ордера*/
MACRO PrintDocument(ncopy:integer):bool

  var DocKind:integer = pr_pmpaym.rec.DocKind;
  var data : TInOutOrderPrintData = TInOutOrderPrintData();

  if( DocKind == 445 )   /*Приходно-расходный кассовый ордер*/
    data.InitByCashOrder( pr_pmpaym, pr_pmrmprop, pr_pscshdoc );  
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintIncCashOrder(data, ncopy);

END;
