 /*
 $Name: pmsetprecedence.mac
 $Module: ¤ΰ®  ­¨­£
 $Description: “αβ ­®Ά¨ ―ΰ¨®ΰ¨β¥β  ―« β¥¦ 
 */
 
 
 // …†€‚‘… €‘—…’›\“”‘\’…’ ‹€’…†€\€”€‰‹
 
import bnk_common, PaymInter;
 
macro “αβ ­®Ά¨βμΰ¨®ΰ¨β¥β( OrderID )
  var obj = RsbPayment( OrderID );
  if( (strlen(obj.Precedence) == 2) and (int(obj.Precedence) > 9) )
    return true;
  end;
  
  if( obj.PaymentKind == "‘" )
    obj.Precedence = Bnk_GetRegistryValue( "…†€‚‘… €‘—…’›\\“”‘\\’…’ ‹€’…†€\\‘—›‰ ‘…‚‘", V_STRING, "69");
  elif( InList(obj.PaymentKind, "", "", "’") )
    obj.Precedence = Bnk_GetRegistryValue( "…†€‚‘… €‘—…’›\\“”‘\\’…’ ‹€’…†€\\…‘—›‰ ‘…‚‘", V_STRING, "79");
  end;
  
  return true;
end;
