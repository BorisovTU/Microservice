/************************************************************************/
/*         Автоматизированная банковская система RS-Bank 5.1            */
/*                 Copyright (c) R-Style Software Lab 2001              */
/*                                                                      */
/*  Имя файла        : opbbchsn.mac                                     */
/*                                                                      */
/*  Описание         : Определение необходимости выгрузки платежей ББ   */
/*                     в АРМ Позиционера                                */
/*                                                                      */
/*  Программист      : Копачев Д.В.                                     */
/*                                                                      */
/*  Создан           : 05.08.04                                         */
/*                                                                      */
/************************************************************************/
import PaymInter;
import "paym_rec.mac";

macro ExecuteCaseStep(Kind_Operation, Number_Step, primdoc, KindDoc)
  const ББНомерШагаПроводки = 20;  /* Номер шага Проводка */
  const ББНомерШагаВыгрузки = 30;  /* Номер шага Выгрузка в АРМ Позиционера */

  if(( (Pm_debet.PaymentID  == Pm_paym.PaymentID) and (Pm_debet.Group == PAYMENTS_GROUP_EXTERNAL ) ) or
     ( (Pm_credit.PaymentID == Pm_paym.PaymentID) and (Pm_credit.Group == PAYMENTS_GROUP_EXTERNAL) )) 
    return String(ББНомерШагаВыгрузки);  /* Выгрузка в АРМ Позиционера - для внешних платежей */
  else 
    return String(ББНомерШагаПроводки);  /* Проводка для внутренних платежей */ 
  end;

end;
