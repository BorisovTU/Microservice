/*-------------------------------------------------------------------------
          Автоматизированная банковская система RS-Bank v6.00.020
                 Copyright (c) R-Style Software Lab

  Имя файла        : mpcrcl50.mac

  Библиотека       : RSACCOUNT

  Описание         : 

  Программист      : Kirakozov Michael (KMV)

  Создан           : 26.02.2009
-------------------------------------------------------------------------*/
IMPORT RsbDataSet, CTInter, InsCarryDoc, globals, mpclb;

record contract_buf (prccontract);
record cntopr_buf (prccntopr);
var prccontract = TBfile("prccontract.dbt"),
    cntsched = TBfile("prccntsched.dbt"),
    prccntopr = TBfile("prccntopr.dbt"),
    DocID      = 0,
    ContractID = 0;


MACRO ExecuteCaseStep(OperationKind, StepNumber, Document, DocKind)

   SetBuff( cntopr_buf, Document );

   ContractID = cntopr_buf.contractid;
   DocID      = cntopr_buf.DocID;

   prccntopr.KeyNum = 0;	
   prccntopr.rec.DocID = DocID;
   if (not prccntopr.GetEQ)
      msgbox ("Не найдена операция");
      return 1;
   end; 

   if (prccntopr.rec.ReclassType == 0) 
      PrcInsertClientQuality(ContractID, date(prccntopr.rec.DocDate + 1), prccntopr.rec.NewClientQuality);      
      return "70";
   else
      return "60";
   end;

END;


MACRO PrintStepDocs (
                ID_Operation,  /* Номер экземпляра операции */
                ID_Step,       /* Номер шага операции */
                Kind_Operation,/* Вид операции */
                KindStep)      /* Вид шага операции */
  exit(1); 

END;

