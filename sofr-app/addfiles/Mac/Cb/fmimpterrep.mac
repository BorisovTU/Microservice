Import BankInter, FMInter, /*PTInter, FIInter, CTInter,*/ "globals.mac";
Import oralib;

// SELECT PartyID, TerrListPos, TerrName
private macro Print_Report1( ProcName, StrQuery )

  [ ##################################################################################################### ]
  ( ProcName );                                                                

  [ษออออออออออออัอออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป];
  [บ ID         ณ ฎฌฅเ ข ณ จฌฅญฎขญจฅ ข ฅเฅ็ญฅ                                                       บ];
  [บ แใก๊ฅชโ   ณ ฅเฅ็ญฅ ณ                                                                              บ];


  var cmd = RsdCommand( StrQuery );
  cmd.NullConversion = true;
  var rs = RsdRecordset( cmd );

  while( rs.moveNext() )
    var PartyID     = rs.value("PartyID" );
    var TerrListPos = rs.value("TerrListPos" );
    var TerrName    = rs.value("TerrName" );


  [วฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤถ];
  [บ ########## ณ ######  ณ ############################################################################ บ]
  ( PartyID, TerrListPos,  TerrName:w );

  end;

  [ศออออออออออออฯอออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ];
  println("");
end;

// SELECT PartyID, PartyName, TerrListPos, BeforeTerrName, AfterTerrName
private macro Print_Report2( ProcName, StrQuery )

  [ ##################################################################################################### ]
  ( ProcName );                                                                

  [ษออออออออออออัอออออออออออออออออออออออัอออออออออัอออออออออออออออออออออออออออัออออออออออออออออออออออออออป];
  [บ ID         ณ จฌฅญฎขญจฅ แใก๊ฅชโ ณ ฎฌฅเ ข ณ จฌฅญฎขญจฅ ข ฅเฅ็ญฅ    ณ จฌฅญฎขญจฅ ข ฅเฅ็ญฅ   บ];
  [บ แใก๊ฅชโ   ณ                       ณ ฅเฅ็ญฅ ณ คฎ จฌฏฎเโ                ณ ฏฎแซฅ จฌฏฎเโ            บ];


  var cmd = RsdCommand( StrQuery );
  cmd.NullConversion = true;
  var rs = RsdRecordset( cmd );

  while( rs.moveNext() )
    var PartyID        = rs.value("PartyID"        );
    var PartyName      = rs.value("PartyName"      );
    var TerrListPos    = rs.value("TerrListPos"    );
    var BeforeTerrName = rs.value("BeforeTerrName" );
    var AfterTerrName  = rs.value("AfterTerrName"  );

  [วฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤถ];
  [บ ########## ณ ##################### ณ ####### ณ ######################### ณ ######################## บ]
  ( PartyID, PartyName:w, TerrListPos, BeforeTerrName:w, AfterTerrName:w );

  end;

  [ศออออออออออออฯอออออออออออออออออออออออฯอออออออออฯอออออออออออออออออออออออออออฯออออออออออออออออออออออออออผ];
  println("");
end;


// SELECT PartyID, TerrName
private macro Print_Report3( ProcName, StrQuery )

  [ ##################################################################################################### ]
  ( ProcName );                                                                

  [ษออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป];
  [บ ID         ณ จฌฅญฎขญจฅ                                                                           บ];
  [บ แใก๊ฅชโ   ณ                                                                                        บ];


  var cmd = RsdCommand( StrQuery );
  cmd.NullConversion = true;
  var rs = RsdRecordset( cmd );

  while( rs.moveNext() )
    var PartyID     = rs.value("PartyID" );
    var TerrName    = rs.value("TerrName" );


  [วฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤถ];
  [บ ########## ณ ###################################################################################### บ]
  ( PartyID, TerrName:w );

  end;

  [ศออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ];
  println("");
end;


// SELECT PartyID, TerrListPos, TerrName
private macro Print_Report4( ProcName, StrQuery )

  [ ##################################################################################################### ]
  ( ProcName );                                                                

  [ษออออออออออออัอออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป];
  [บ ID         ณ ฎฌฅเ ข ณ จฌฅญฎขญจฅ                                                                 บ];
  [บ แใก๊ฅชโ   ณ ฅเฅ็ญฅ ณ                                                                              บ];


  var cmd = RsdCommand( StrQuery );
  cmd.NullConversion = true;
  var rs = RsdRecordset( cmd );

  while( rs.moveNext() )
    var PartyID     = rs.value("PartyID" );
    var TerrListPos = rs.value("TerrListPos" );
    var TerrName    = rs.value("TerrName" );


  [วฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤถ];
  [บ ########## ณ ######  ณ ############################################################################ บ]
  ( PartyID, TerrListPos,  TerrName:w );

  end;

  [ศออออออออออออฯอออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ];
  println("");
end;


// SELECT PartyID, TerrName
private macro Print_Report5( ProcName, StrQuery )

  [ ##################################################################################################### ]
  ( ProcName );                                                                

  [ษออออออออออออัออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป];
  [บ ฎฌฅเ ข    ณ จฌฅญฎขญจฅ                                                                           บ];
  [บ ฅเฅ็ญฅ    ณ                                                                                        บ];


  var cmd = RsdCommand( StrQuery );
  cmd.NullConversion = true;
  var rs = RsdRecordset( cmd );

  while( rs.moveNext() )
    var TerrListPos = rs.value("TerrListPos" );
    var TerrName    = rs.value("TerrName" );


  [วฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤถ];
  [บ ########## ณ ###################################################################################### บ]
  ( TerrListPos, TerrName:w );

  end;

  [ศออออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ];
  println("");
end;



macro FMImpTerrPrintRep(TerrFileName, TerrFileDate, TerrFileNumber)

  println("        เฎโฎชฎซ เฎๆฅคใเ๋ จฌฏฎเโ ฅเฅ็ญ๏  ข ฏเขฎ็ญจช แใก๊ฅชโฎข");
  println("");

  var SysDate = date();  
  var SysTyme = time();  

  println(" โ, ขเฅฌ๏: " + string(SysDate) + " " + string(SysTyme)); 
  println(" ฎซ์งฎขโฅซ์: " +{oper} + " " + {Name_Oper}); 
                                              

  println(" ฉซ: " + TerrFileName + " โ ฅเฅ็ญ๏: " + string(TerrFileDate) + " ฎฌฅเ ฅเฅ็ญ๏: " + TerrFileNumber ); 


  // ฏจแฎช "กเกฎโญ๋ เญฅฅ"
  var StrQuery = "SELECT lpt.t_PartyID AS PartyID, lpt.t_TerrListPos AS TerrListPos, pnm.t_Name AS TerrName " +
                 " FROM dfmlistptimp_tmp lpt, dfmlistptname_dbt pnm "  +
                 " WHERE lpt.t_Stats = 1 AND lpt.t_PartyID = pnm.t_PartyID AND t_IsMain = 'X' ORDER BY lpt.t_PartyID ";
  Print_Report1( "กเกฎโญ๋ เญฅฅ:", StrQuery );


  // ฏจแฎช "ฉคฅญ๋ โฎ็ญ๋ฌ ฏฎจแชฎฌ"
  StrQuery = "SELECT lpt.t_PartyID AS  PartyID, pt.t_Name AS PartyName, lpt.t_TerrListPos AS TerrListPos, lpni.t_Name AS  BeforeTerrName, lpnd.t_Name AS AfterTerrName  " +
             "  FROM dfmlistptimp_tmp lpt, dfmlistpttwinimp_tmp twin, dparty_dbt pt, dfmlistptnameimp_tmp lpni, dfmlistptname_dbt lpnd " +
             "  WHERE  lpt.t_Stats = 3 AND lpt.t_Action = 0  AND lpt.t_PartyID = twin.t_TwinPartyID AND twin.t_Similarity = 1 " +
             "    AND  lpt.t_PartyID = pt.t_PartyID AND lpni.t_ImpPtID = lpt.t_ImpPtID  AND lpni.t_IsMain = 'X' " +
             "    AND lpnd.t_PartyID = lpt.t_PartyID  AND lpnd.t_IsMain = 'X'";

  Print_Report2( "ฉคฅญ๋ โฎ็ญ๋ฌ ฏฎจแชฎฌ:", StrQuery );


  // ฏจแฎช "ฉคฅญ๋ ฏฎ แฎขฏคฅญจ๎ "
  StrQuery = "SELECT lpt.t_PartyID AS  PartyID, pt.t_Name AS PartyName, lpt.t_TerrListPos AS TerrListPos, lpni.t_Name AS  BeforeTerrName, lpnd.t_Name AS AfterTerrName  " +
             "  FROM dfmlistptimp_tmp lpt, dfmlistpttwinimp_tmp twin, dparty_dbt pt, dfmlistptnameimp_tmp lpni, dfmlistptname_dbt lpnd " +
             "  WHERE  lpt.t_Stats = 3 AND lpt.t_Action = 0  AND lpt.t_PartyID = twin.t_TwinPartyID AND twin.t_Similarity = 2 " +
             "    AND  lpt.t_PartyID = pt.t_PartyID AND lpni.t_ImpPtID = lpt.t_ImpPtID  AND lpni.t_IsMain = 'X' " +
             "    AND lpnd.t_PartyID = lpt.t_PartyID  AND lpnd.t_IsMain = 'X'";

  Print_Report2( "ฉคฅญ๋ ฏฎ แฎขฏคฅญจ๎ :", StrQuery );

  // ฏจแฎช "ฉคฅญ๋ แเขญฅญจฅฌ แฏจแชฎข ฏฎๅฎฆจๅ แใก๊ฅชโฎข"
  StrQuery = "SELECT lpt.t_PartyID AS  PartyID, pt.t_Name AS PartyName, lpt.t_TerrListPos AS TerrListPos, lpni.t_Name AS  BeforeTerrName, lpnd.t_Name AS AfterTerrName  " +
             "  FROM dfmlistptimp_tmp lpt, dfmlistpttwinimp_tmp twin, dparty_dbt pt, dfmlistptnameimp_tmp lpni, dfmlistptname_dbt lpnd " +
             "  WHERE  lpt.t_Stats = 3 AND lpt.t_Action = 3  AND lpt.t_PartyID = twin.t_TwinPartyID  " +
             "    AND  lpt.t_PartyID = pt.t_PartyID AND lpni.t_ImpPtID = lpt.t_ImpPtID  AND lpni.t_IsMain = 'X' " +
             "    AND lpnd.t_PartyID = lpt.t_PartyID  AND lpnd.t_IsMain = 'X'";

  Print_Report2( "ฉคฅญ๋ แเขญฅญจฅฌ แฏจแชฎข ฏฎๅฎฆจๅ แใก๊ฅชโฎข:", StrQuery );


  // ฏจแฎช "งญ็ฅญ๋ ข๋กฎเฎฌ ข แฏจแชฅ ฏฎๅฎฆจๅ"
  StrQuery = "SELECT lpt.t_PartyID AS  PartyID, pt.t_Name AS PartyName, lpt.t_TerrListPos AS TerrListPos, lpni.t_Name AS  BeforeTerrName, lpnd.t_Name AS AfterTerrName  " +
             "  FROM dfmlistptimp_tmp lpt, dfmlistpttwinimp_tmp twin, dparty_dbt pt, dfmlistptnameimp_tmp lpni, dfmlistptname_dbt lpnd " +
             "  WHERE  lpt.t_Stats = 3 AND lpt.t_Action = 1  AND lpt.t_PartyID = twin.t_TwinPartyID " +
             "    AND  lpt.t_PartyID = pt.t_PartyID AND lpni.t_ImpPtID = lpt.t_ImpPtID  AND lpni.t_IsMain = 'X' " +
             "    AND lpnd.t_PartyID = lpt.t_PartyID  AND lpnd.t_IsMain = 'X'";

  Print_Report2( "งญ็ฅญ๋ ข๋กฎเฎฌ ข แฏจแชฅ ฏฎๅฎฆจๅ:", StrQuery );


  
  // ฏจแฎช "ฎงคญ๋ ญฎข๋ฅ แใก๊ฅชโ๋"
  StrQuery = "SELECT lpt.t_PartyID AS PartyID, lpt.t_TerrListPos AS TerrListPos, pt.t_Name AS TerrName " +
             "  FROM dfmlistptimp_tmp lpt, dparty_dbt pt " +
             " WHERE lpt.t_Stats = 3 AND lpt.t_PartyID = pt.t_PartyID  ORDER BY lpt.t_PartyID ";

  Print_Report4( "ฎงคญ๋ ญฎข๋ฅ แใก๊ฅชโ๋:", StrQuery );

  // ฏจแฎช "เฎฏใ้ฅญ๋ ฏเจ เใ็ญฎฉ ฎกเกฎโชฅ"
  StrQuery = " SELECT lpt.t_TerrListPos AS TerrListPos, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_Stats = 6 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report5( "เฎฏใ้ฅญ๋ ฏเจ เใ็ญฎฉ ฎกเกฎโชฅ:", StrQuery );


  // ฏจแฎช "ฅ จฌฏฎเโจเฎขญ๋ จง-ง ฏเฅเ๋ขญจ๏ เฎๆฅคใเ๋"
  StrQuery = " SELECT lpt.t_TerrListPos AS TerrListPos, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_Stats IN (2,4) AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report5( "ฅ จฌฏฎเโจเฎขญ๋ จง-ง ฏเฅเ๋ขญจ๏ เฎๆฅคใเ๋:", StrQuery );


  // ฏจแฎช "ง๊๏โ๋ จง ฅเฅ็ญ๏"
  StrQuery = " SELECT lpt.t_PartyID AS PartyID, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_Stats = 8 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report3( "ง๊๏โ๋ จง ฅเฅ็ญ๏:", StrQuery );


  // ฏจแฎช "เฎฏใ้ฅญ๋ ฏเจ จง๊๏โจจ จง ฅเฅ็ญ๏"
  StrQuery = " SELECT lpt.t_PartyID AS PartyID, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_Stats = 9 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report3( "เฎฏใ้ฅญ๋ ฏเจ จง๊๏โจจ จง ฅเฅ็ญ๏:", StrQuery );


  // ฏจแฎช "ฅ จแชซ๎็ฅญ๋ จง-ง ฏเฅเ๋ขญจ๏ เฎๆฅคใเ๋"
  StrQuery = " SELECT lpt.t_PartyID AS PartyID, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_Stats = 7 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report3( "ฅ จแชซ๎็ฅญ๋ จง-ง ฏเฅเ๋ขญจ๏ เฎๆฅคใเ๋:", StrQuery );

  // ซจฅญโ๋, โเฅกใ๎้จฅ งฌฎเฆจขญจ๏ แเฅคแโข จ จฌใ้ฅแโข
  StrQuery = " SELECT lpt.t_PartyID AS PartyID, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_FreezingState = 1 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report3( "ซจฅญโ๋, โเฅกใ๎้จฅ งฌฎเฆจขญจ๏ แเฅคแโข จ จฌใ้ฅแโข:", StrQuery );


  // ซจฅญโ๋, โเฅกใ๎้จฅ เงฌฎเฆจขญจฅ แเฅคแโข จ จฌใ้ฅแโข
  StrQuery = " SELECT lpt.t_PartyID AS PartyID, pnm.t_Name AS TerrName " +
             "   FROM dfmlistptimp_tmp lpt, dfmlistptnameimp_tmp pnm " +
             "  WHERE lpt.t_FreezingState = 2 AND lpt.t_ImpPtID = pnm.t_ImpPtID AND t_IsMain = 'X' ORDER BY lpt.t_ImpPtID ";

  Print_Report3( "ซจฅญโ๋, โเฅกใ๎้จฅ เงฌฎเฆจขญจฅ แเฅคแโข จ จฌใ้ฅแโข:", StrQuery );

  return true;
end;