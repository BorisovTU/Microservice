/*                                                                          */
/*                         R-Style SoftWare Lab                             */
/*                                                                          */
/****************************************************************************/
/*                       Подсистема "ГКБО"                                  */
/*                                                                          */
/*                             ПЗО                                          */
/*                                                                          */
/*                                                                          */
/*  Имя файла: sfcatacc.mac                                                 */
/*  Создан: 16.10.2007                                               СолАН  */
/*                                                                          */
/****************************************************************************/

import "sfcomcat.mac";

private const RashetCatCode = "+Расчеты"; 

macro GetRaschetAccount( ConId, FIID )

  var SfComPD : SfComPrimDoc;  

  var RashetAccount:string;
  
  file   sfcontrFile( "sfcontr.dbt") key 0;

  sfcontrFile.Id = ConId;
  if( not getEQ( sfcontrFile ) )
     MsgBox("Не найден договор обслуживания: ", ConId);
     return 1;
  end;

  SfComPD = SfComPrimDoc( 87 /*DLDOC_SFCONTRACT*/, sfcontrFile );
  RashetAccount = SfComPD.FindAndOpenAccount( RashetCatCode, {curdate}, FIID );  

  return RashetAccount;

end;
