/******* Отчет о массовом откату ТО и операций по ним ********/



const   Ошибка   = 0,
    Первый   = 1,
    Последний= 2;

RECORD  sfinvrec (sfinv);

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
   
   setbuff (sfinvrec, firstdoc);

    if (Вызов==Первый)
[             Отчет о массовом выполнении.];
[┌────────────┬────────┬──────────────────────────────────────────────────────────────────┐];
[│  Номер ТО  │   №    │                      Сообщение                                   │];
[│            │ ошибки │                                                                  │];
[├────────────┼────────┼──────────────────────────────────────────────────────────────────┤];
    elif (Вызов==Ошибка)
        if (Статус == 0)
            Сообщение = "Операция выполнена успешно"
        end;
        
[│############│########│##################################################################│](sfinvrec.docnumber, Статус, Сообщение);
    
        elif (Вызов==Последний)         
[└────────────┴────────┴──────────────────────────────────────────────────────────────────┘];
    end;
END;
