//-----------------------------------------------------------------------------
// Блок     : 29009 - "Возврат из картотеки"
// Шаг      : 40    - "Снятие статуса картотеки"
// Описание : Макрос шага
//-----------------------------------------------------------------------------
import pm_setst, cbsttls;
var PaymentObj:RsbPayment;

MACRO ExecuteStep( doc, paymDoc )

  // Установить статус платежа
  PaymentObj.PaymStatus = PM_FINISHED;

  // Установить статус первички "Закрыт"
  PM_SetPrimDocumentState( PaymentObj, DOCUMENT_ST_CLOSED );

  // Установить статус сегмента операции
  if( УстановитьСтатусыПлатежа( OPR_PAYM_STATE, OPR_PM_ST_CLOSE ) )
    msgbox("Ошибка при установке сегментов статуса экземпляра операции");
    return 1;
  end;

  return 0;

END;
