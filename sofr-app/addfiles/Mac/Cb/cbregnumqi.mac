/*************************************************************************
 Имя файла: cbregnumqi.mac
 Макрос формирования регистрационного номера КИ по заявлению
**************************************************************************/
import PTInter;

macro GenerateNumber( Value, ObjKind, AddrBuf, RegDate )

  record PARTY("party");
  var ClientCode = "";
  var Day, Month, Year;

  SetBuff(PARTY, AddrBuf);
  ClientCode = ПолучитьКодСубъекта(PARTY.PartyID, PTCK_CONTR);
  DateSplit(RegDate, Day, Month, Year);

  return (string(Year:4:o) + string(Month:2:o) + string(Day:2:o) + ClientCode);
end;

