/*
 * Макрос для вызова XML-запроса в текущем процессе
 */

Import XmlRpcInter, "serviceaction.mac";

macro Al_XmlRpcLocalCall( macroXMLRPCRequest : string )

  var RSLResult;

  var XMLResult : string;

  /* запускаем локальное выполнение переданного XML-запроса */
  XMLResult = XmlRpcLocalCall( macroXMLRPCRequest );

  /* преобразуем XML-ответ в объект RSL*/
  ConvertToRSL( XMLResult, RSLResult );

  if( (ValType(RSLResult) == V_GENOBJ) and (GenPropID(RSLResult, "faultString") != -1) )

    /* если вернули объект с полем faultString, значит была ошибка выполнения */
    msgbox( toOEM(RSLResult.faultString, true) );

  end;

  return XMLResult;
end;
