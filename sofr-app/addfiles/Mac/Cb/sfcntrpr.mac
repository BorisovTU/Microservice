/*
        Отчет о массовой печати договоров обслуживания
*/

RECORD sfcontr (sfcontr);

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)

        setbuff (sfcontr,firstdoc);

var stat;
        if (Вызов==Первый)
[    Отчет о групповом выполнении операции.    ];
[+----------------+------+------------------------------------------------------------+];
[|   Номер        |Номер |                 Сообщение                                  |];
[|  договора      |ошибки|                                                            |];
[+----------------+------+------------------------------------------------------------+];
        elif (Вызов==Ошибка)

                if (Статус == 0)
                        Сообщение = "Операция выполнена успешно";
                end;
[|################|######|############################################################|](sfcontr.Number,Статус,Сообщение);
        elif (Вызов==Последний)
[+----------------+------+------------------------------------------------------------+];
        end;
END;