/************************************************************************/
/*         Автоматизированная банковская система RS-Bank v6.0           */
/*                 Copyright (c) R-Style Software Lab 2005              */
/*  Имя файла        : cbsfinv20.mac                                    */
/*  Описание         : Оплата ТО. Шаг выбора                            */
/*  Программист      : Чернов А.Г.                                      */
/*  Создан           : 10-10-2005                                       */
/************************************************************************/

import OprInter, SFInter, "cbsfinv.mac";

private macro proc( doc, sfinv )
  return 0;
end;


/* Номера шагов для перехода */
const НомерШагаВставкаСвязки      = 30;
const НомерШагаЗавершениеОперации = 40;

macro ExecuteCaseStep( Kind_Operation, Number_Step, first, KindDoc )
  record sfinv_buf("sfinv.dbt");

  setbuff( sfinv_buf, first );

  if( sfinv_buf.InvMethod == SFINV_INVMETHOD_REQUEST )
    if( SfGetPrevDoc( sfinv_buf, @proc ) == 0 )
      return string( НомерШагаВставкаСвязки );
    else
      return string( НомерШагаЗавершениеОперации );
    end;
  else
    return string( НомерШагаЗавершениеОперации );
  end;

  return 1;
end;
