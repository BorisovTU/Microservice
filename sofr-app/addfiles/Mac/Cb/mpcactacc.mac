/*-------------------------------------------------------------------------
          Автоматизированная банковская система RS-Bank v.6.0.020
                 Copyright (c) R-Style Software Lab

  Имя файла        : mpcactacc.mac

  Библиотека       : 

  Описание         : Актуализация счетов

  Программист      : Kirakozov Michael (KMB)

  Создан           : 02.02.2009
-------------------------------------------------------------------------*/
import mpccarry, mpc_categ, globals;



MACRO MPC_ActAccountsForFD( ContractID,  CatCode, FIID: @integer, Chapter: @integer, acc_buf):string
  var fd,ok, CurrencyDate, Account="",
      stat = 0, 
      Purpose = "";
   record account_buf (account);

   fd = PrcContractFD(ContractId);
   if (ValType(fd) != V_GENOBJ)
      msgbox ("Не могу создать первичный документ");
      return "";
   end;

   ok = MPC_GetDocAccount(CatCode, fd, Account, null, {curdate}, NULL, NULL, NULL, account_buf, FIROLE_INCOME);

   Chapter = account_buf.chapter;
   FIID = account_buf.code_currency;

   if (ValType(acc_buf) != V_UNDEF)
      Copy(acc_buf, account_buf);
   end;

   return Account;
   
END;


