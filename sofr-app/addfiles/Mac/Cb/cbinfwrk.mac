/*
    Информирование о необработанных документах
    Открытые 

            Mikhailov S., 22.08.2001, Wed
*/

import cbinfcom;
import cbinfint;/*INTerface must be before PRImary!*/
import cbinfpri;


/*__________________________________*/

macro CBINF_Proc( RegPath, OutType )

    var PrimDocFlag, RegError, this_stat;

    CBINF_Result = 0;
    CBINF_ErrorStatus = 0;

    if( OutType == CBINF_OutReport )
        if( PrintHeader( RegPath, LIST_WORKING ) )
            return CBINF_StatusError;
        end;
    end;
    
/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegPsPayOrd,
                            V_BOOL, PrimDocFlag, RegError);

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegPsPayOrd, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcPsPayOrd( RegPath, OutType, PSPO_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;


/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegPsCpOrd,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegPsCpOrd, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcPsCpOrd( RegPath, OutType, CP_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;


/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^410^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegPSCshDoc,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegPSCshDoc, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcPSCshDoc( RegPath, OutType, STAT_CASH_ORDER_OPEN );
    end;

    if( this_stat )
        return this_stat;
    end;




/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegCheckIss,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegCheckIss, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcCheckIss( RegPath, OutType, CHECKISS_ST_OPEN );
    end;

    if( this_stat )
        return this_stat;
    end;

/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegReqOpenA,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegReqOpenA, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcReqOpenA( RegPath, OutType, REQOPENA_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;

/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegReqClosA,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegReqClosA, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcReqClosA( RegPath, OutType, REQCLOSA_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;



/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^200^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegPsBcOrd,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegPsBcOrd, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcPSBcOrd( RegPath, OutType, PSBCORD_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;


/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^15^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegMultyDoc,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegMultyDoc, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcMultyDoc( RegPath, OutType, MCDOC_STATUS_OPEN );
    end;

    if( this_stat )
        return this_stat;
    end;







/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegBankPayment,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegBankPayment, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcBankPayment( RegPath, OutType, MEMORDER_STATUS_OPEN );
    end;

    if( this_stat )
        return this_stat;
    end;

/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegBankClaim,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegBankClaim, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcBankClaim( RegPath, OutType, MEMORDER_STATUS_OPEN );
    end;

    if( this_stat )
        return this_stat;
    end;


/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
    GetRegistryValue( RegPath + "\\" + CBINF_RegBBCpOrd,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegBBCpOrd, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcBBCpOrd( RegPath, OutType, CP_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;


/*^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^28^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^*/
/*
    GetRegistryValue( RegPath + "\\" + CBINF_RegBBCpTrn,
                            V_BOOL, PrimDocFlag, RegError );

    if( RegError )
        return WriteRegError( RegPath + "\\" + CBINF_RegBBCpTrn, RegError, OutType );
    end;

    if( PrimDocFlag )
        this_stat = ProcBBCpTrn( RegPath, OutType, CP_ST_WORKING );
    end;

    if( this_stat )
        return this_stat;
    end;
*/




/**/
    if( OutType == CBINF_OutReport )
        if( PrintFooter( RegPath, LIST_WORKING ) )
            return CBINF_StatusError;
        end;
    end;

    return CBINF_StatusOk;
end;/*CBINF_Proc*/

/*test call

const REGPATH = "COMMON\\CBINFPARMS";
var ret;

ret = CBINF_Proc( REGPATH, CBINF_OutReport );

msgbox( "test : stat =  ", ret , " CBINF_Result = ", CBINF_Result );
*/

