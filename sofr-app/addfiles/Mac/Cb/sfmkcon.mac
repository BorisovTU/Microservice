/*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

    RS-Bank 5.10

    ‡Ž

    Œ áá®¢®¥ ä®à¬¨à®¢ ­¨¥ ¤®£®¢®à®¢ ®¡á«ã¦¨¢ ­¨ï
                    Orlov V.          08.08.2002

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*/
import PTInter;

const DEPARTMENT_TYPE_VSP = 2;

record sfcontrRec( "sfcontr.dbt") /*key 0*/;
/*
   Œ áá®¢®¥ ä®à¬¨à®¢ ­¨¥ ¤®£®¢®à®¢ ®¡á«ã¦¨¢ ­¨ï
*/

/* Œ ªà®á ª®àà¥ªâ¨à®¢ª¨ ¯ à ¬¥âà®¢ § ¯®«­¥­¨ï ª®­âà ªâ  */
macro FillContract()
    /* ‡¤¥áì ¬®¦­® ¨§¬¥­¨âì á®§¤ ¢ ¥¬ë© ¤®£®¢®à.
        ¯à¨¬¥à ¨¬ï:
       sfcontrRec.Name = "„®£®¢®à 1";
    */
   return 0;
end;

macro GetBranchForContr(ServKind, ObjectBuf, Branch)
    file deprt("dp_dep.dbt") key 0;
    record account("account.dbt");
    
    Branch = 0;
    
    if (ServKind == PTSK_PAY)
        SetBuff(account, ObjectBuf);
        
        deprt.Code = account.Branch;
        
        if (GetEQ(deprt))        
            if (deprt.NodeType == DEPARTMENT_TYPE_VSP)
                Branch = account.Branch;        
            end;
        end;
    end;
                                    
    SetParm(2, Branch); 
    
    return 0;
end;

macro ReportPrintHeader( )


[                 Œ áá®¢®¥ ä®à¬¨à®¢ ­¨¥ ¤®£®¢®à®¢ ®¡á«ã¦¨¢ ­¨ï ];
[ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄ¿];
[³           ‘ç¥â            ³  ®¬¥à   ³           ˆ¬ï           ³    „ â     ³];
[³                           ³ ¤®£®¢®à  ³         ¤®£®¢®à         ³   ­ ç «    ³];
[ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄ´];

    return 0;
end;/*ReportPrintHeader*/


macro ReportPrintLine(RecBuf)

    record sfcontrBuf( "sfcontr.dbt");
    SetBuff(sfcontrBuf, RecBuf );
[³ ######################### ³ ######## ³ ####################### ³ ########## ³]
( sfcontrBuf.object, sfcontrBuf.number, sfcontrBuf.Name, sfcontrBuf.dateBegin );

    return 0;
end;/*ReportPrintLine*/

macro ReportPrintFooter( )

[ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÙ];
[  ];

    return 0;
end;

macro ReportPrintErrLine(RecBuf, ErrStat, ErrMes )
    record sfcontrBuf( "sfcontr.dbt");
    array StringArray;
    var i = 1;
    SetBuff(sfcontrBuf, RecBuf );


         StrSplit(StrSubst(ErrMes, "|", " " ), StringArray, 47);
[³ ######################### ³ ############################################### ³]
(sfcontrBuf.Object, StringArray(0) );
         while ( StrLen(StringArray(i) ) > 0)
[³                           ³ ############################################### ³](StringArray(i));
           i = i + 1;
         end;

end;
