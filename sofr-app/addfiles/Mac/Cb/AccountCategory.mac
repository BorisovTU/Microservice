//AccountCategory.mac
//Общий класс для общих методов при работе с категориями учёта
import oralib;

class AccountCategory()
    private var id:integer;
    private var categoryNumber:integer;
    private var code:string;
    private var name:string;

    macro InitByID(_id:integer)
        var query = "select t_id, "
                  + "       t_number, "
                  + "       t_code, "
                  + "       t_name "
                  + "  from dmccateg_dbt "
                  + "where t_id = :id";
        var sql = ExecSQLselectPrmDyn(query, _id);
        if (sql.MoveNext())
            id             = sql.value("t_id");
            categoryNumber = sql.value("t_number");
            code           = sql.value("t_code");
            name           = sql.value("t_name");
        end;
    end;

    macro GetName():string
        return name;
    end;

    macro GetCode():string
        return code;
    end;
end;