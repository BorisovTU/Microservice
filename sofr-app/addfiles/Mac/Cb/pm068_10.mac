//-----------------------------------------------------------------------------
// Блок      : 29061 - "Репликация документа БО 5.50"
// Шаг       : 10    - "Выбор варианта обработки"
// Описание  : Макрос шага
//-----------------------------------------------------------------------------
import PaymInter, "cbsttls.mac";

var PaymentObj:RsbPayment;

// ----------------------------------------------------------------------------
// Выполнение шага
// ----------------------------------------------------------------------------
macro ExecuteStep( Kind_Operation, first, KindDoc, ID_Operation )
  if ((not PaymentObj.IsExternal()) or (PaymentObj.ValueDate < {curdate}))
    if(УстановитьСтатусыПлатежа(OPR_PAYM_STATE, OPR_PM_ST_CLOSE ))
      msgbox("Ошибка при установке статуса платежа");
      return 1;
    end;
  else
    if(УстановитьСтатусыПлатежа(OPR_PAYM_DO, OPR_PM_ST_DISCHARGE ))
      msgbox("Ошибка при установке статуса платежа");
      return 1;
    end;
  end;
  return 0;
end;