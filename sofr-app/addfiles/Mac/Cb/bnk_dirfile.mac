 /*
 $Name: bnk_dirfile.mac
 $Module: Ядро Банкинг
 $Description: Общие функции для работы с каталогами и файлами
 */

import rsexts; 
// Нежелательно импортировать здесь другие макросы Расч. банка,
// т.к. этот макрофайл сам предназначен для импорта в макросы РБ

macro FileExists(FileName : string) : bool
  var DirList : TDirList = TDirList(FileName, "f");
  
  if(DirList.Count)
    return TRUE;
  end;

  return FALSE;
end;

macro CreateDirectory(Directory : string)
  var ErrMsg : string = "";

  var CheckDirResult : integer = ExistDir(Directory);

  if( CheckDirResult == 2 ) // каталог с указанным именем не существует

    if( not MakeDir(Directory) )
      ErrMsg = "Ошибка при создании каталога " + Directory;
      RunError(ErrMsg, ErrMsg);
    end;

  elif( CheckDirResult == 1 )
    ErrMsg = "Каталог " + Directory + " недоступен для записи";
    RunError(ErrMsg, ErrMsg);
  end;

end;
