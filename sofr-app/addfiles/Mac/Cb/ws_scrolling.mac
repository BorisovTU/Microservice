 /*
 $Name: ws_scrolling.mac
 $Module: WEB
 $Description: Метаданные для автоматической генерации скроллинга в WebClient
 */

//import RsbDataSet, cb_sql, globals, BankInter, ws_file;
//import ws_datafilter;
import commonutil;

class TMoveDirection
    const Up = 1;
    const Down = 2;
    const Top = 3;
    const Bottom = 4;
end;
const MoveDirection = TMoveDirection;

macro MakeFilterValue()
  var i = 0, val;
  var a = TArray();
  while (getparm(i, val))
      a[a.size] = val;
      i = i + 1;
  end;
  return a;
end;

class WebFilterProvider
    var Id : integer; // Внутренний идентификатор провайдера фильтра
    var Type : integer; // Тип данных, тип параметра:
    var Name : string; // Наименование условия
    var ColumnName : string; // Связанный столбец скроллинга
    var DefaultValue; // Значение по умолчанию TArray
    var DefaultCondition : integer; // Условие сравнения по умолчанию.
end;

class TWebServiceResultType
    const None = 0;
    const Action = 1;
    const Scrolling = 2;
    const Panel = 3;
    const ExecutePanel = 4;
end;
const WebServiceResultType = TWebServiceResultType;

class WebServiceCallback(m, p, prm, t)
    var MacroName : string = m; // Имя макроса сервиса.
    var ProcName : string = p; // Имя вызываемой процедуры сервиса.
    var Params : string = prm; // Произвольная текстовая строка параметров.
    var ResultType = CU_IIF(t != null, t, WebServiceResultType.Action); // Тип возвращаемого значения WebServiceResultType
end;

class TWebToolbarItemType
    const Separator = 1;
    const Button = 2;
    const ToggleButton = 3;
    const SplitButton = 4;
    const MenuButton = 5;
    const CheckBox = 6;
end;
const WebToolbarItemType = TWebToolbarItemType;

class WebToolbarItem
    var Type : integer; // Тип элемента. TWebToolbarItemType
    var Text : string; // Текст выводимый на элементе, где это допустимо.
    var Image : string; // Картинка выводимая на элемента, где это допустимо.
    var HotKey : string; // Горячая клавиша.
    var Tooltip : string; // Всплывающая подсказка.
    var MenuItems; // Набор пунктов выпадающего списка. Используется там, где это допустимо (SplitButton и  MenuButton).
    var Service; // WebServiceCallback Вызываемый сервис.
end;

class TWebMenuItemType
    const Separator = 1;
    const SimpleItem = 2;
    const CheckedItem = 3;
end;
const WebMenuItemType = TWebMenuItemType;

class WebMenuItem
    var Type : integer; // Тип элемента. WebMenuItemType
    var Text : string; // Текст выводимый на элементе, где это допустимо.
    var Image : string; // Картинка выводимая на элемента, где это допустимо.
    var HotKey : string; // Горячая клавиша.
    var Tooltip : string; // Всплывающая подсказка.
    var Service; // WebServiceCallback Вызываемый сервис.
end;

class TWebColumnType
    const Text = 1; // Текстовое поле
    const Numeric = 2; // Число
    const Money = 3; // Деньги
    const Flag = 4; // Флаг
    const Date = 5; // Дата
    const Time = 6; // Время
    const DateTime = 7; // Дата и Время
end;
const WebColumnType = TWebColumnType;

class WebScrollingItem
    var Name : string; // Внутренний идентификатор столбца
    var Type : integer; // Тип данных WebColumnType
    var Title : string; // Заголовок столбца.
    var Tooltip : string; // Tooltip для заголовка столбца = Title
    var Width : string; // Ширина столбца: SizeToHeader SizeToCells Auto Auto
    var Source : string; // Источник данных
end;

class ColumnSumServiceResult
    var TotalSum : money; // сумма по всем записям
    var SelectedItemsSum : money; // сумма по выделенным по записям
end;

//********* Прототипы функций сервисов *********

//WebServiceCallback("ws_scrolling", "OnToolbar", "777", WebServiceResultType.Scrolling);

//macro CustomAction(params, scrollingID, selectedItem, items, columnName)
//    return 0;
//end;

// Для CheckBox param это IsChecked
//macro CustomActionWithParameter(params, scrollingID, param, selectedItem, items, columnName)
//    return 0;
//end;

//macro AddAction(params, scrollingID)
//    return 0;
//end;

//macro EditAction(params, scrollingID, selectedItem)
//    return 0;
//end;

//macro DeleteAction(params, scrollingID, items)
//    return 0;
//end;

//macro GetRows(params, scrollingID, pagesize, pagenum, filterItems /*TArray of FilterConditionItem Значения фильтрации*/, orderItems)
//    return 0;
//end;

//macro GetRowCount(params, scrollingID, filterItems /*TArray of FilterConditionItem Значения фильтрации*/)
//    return 0;
//end;

//macro ReorderRows(params, scrollingID, items, operation /*MoveDirection*/)
//    return 0;
//end;

//macro CalculateSum(params, scrollingID, columnName, items) // : ColumnSumServiceResult
//    var result = ColumnSumServiceResult;
//    result.TotalSum = $555;
//    result.SelectedItemsSum = $111;
//    return result;
//end;


class WebScrolling
    var ScrollingID : string; // UID скроллинга.
    var Title : string; // Наименование панели.
    var Width : integer = 800; // Ширина панели.
    var Height : integer = 480; // Высота панели.
    var IsHelpButtonVisible : bool = false; // Признак отображения кнопки <Помощь> у панели.
    var HelpPage : string; // Ссылка на имя страницы файла-помощи. Если isHelpButtonVisible=False, то не используется.
    var IsAddButtonVisible : bool = false; // Признак отображения кнопки <Создать>.
    var AddService; // WebServiceCallback Сервис, вызываемый по кнопке <Создать>. Сервис должен вернуть объект и мета-данные панели ввода объекта.
    var IsEditButtonVisible : bool; // Признак отображения кнопки <Редактировать>.
    var EditService; // WebServiceCallback Сервис, вызываемый по кнопке <Редактировать>. Сервис должен вернуть объект и мета-данные панели редактирования объекта.
    var IsDeleteButtonVisible : bool; // Признак отображения кнопки <Редактировать>.
    var DeleteService; // WebServiceCallback Сервис, вызываемый по кнопке <Удалить>.
    var IsAutoRefreshButtonVisible : bool = false; // Признак отображения кнопки <Автообновление>.
    var ToolbarItems; // TArray Кнопки и другие элементы тулбара панели. Массив. Размещаются на Тулбаре в порядке следования в массиве.
    var Columns; // TArray  Поля скроллинга. Массив.
    var IsFilterVisible : bool = false; // Признак наличия фильтра.
    var FilterItems; // TArray  Атрибуты фильтра. Массив.
    var GetRowCountService; // WebServiceCallback Сервис, возвращающий число записей скроллинга в соответствии с текущим наложенным фильтром.
    var GetRowsService; // WebServiceCallback Сервис, возвращающий записи скроллинга в соответствии с текущим наложенным фильтром. Записи возвращаются только для текущей активной страницы скроллинга.
    var IsUpdateOrderRowsEnabled : bool = false; // Признак определяет доступность в скроллинге функционала пользовательского перемещения отдельных записей по списку.
    var UpdateOrderRowsService; // WebServiceCallback Сервис перемещает набор выделенных записей выше или ниже в скроллинге.
    var GetColumnSumService; // WebServiceCallback Сервис выполняет подсчет общей суммы по первому денежному столбцу скроллинга. Если денежных столбцов нет, то кнопку не отображаем.
end;

/*
macro GetRows(pagesize, pagenum, FilterItems, OrderItems)
    var a = TArray;
    var item = ScrollItem();
    with (item)
        item.TextValue = "text";
        item.NumericValue = 19;
        item.MoneyValue = $33;
        item.FlagValue = true;
        item.DateValue = date();
        item.TimeValue = time();
        item.DateTimeValue = dttm(date(), time());
    end;
    a[a.size] = item;

    item = ScrollItem();
    with (item)
        item.TextValue = "vesta";
        item.NumericValue = 33;
        item.MoneyValue = $54.322;
        item.FlagValue = false;
        item.DateValue = date(4,4,2005);
        item.TimeValue = time();
        item.DateTimeValue = dttm(date(5,5,2005), time());
    end;
    a[a.size] = item;
    return a;
end;

macro GetRowCount(FilterItems)
    return 2;
end;

macro CalculateSum(params, columnId)
    return $777;
end;

private macro PrintItems(items)
    var s = "";
    for (var i, items)
        s = s + i.Type + " " + i.Number + " " + i.Title + "\n";
    end;
    return s;
end;

macro ReorderRows(params, items, operation)
    fprintln("ws_scrolling_log", PrintItems(items) + " " + operation);
    return 0;
end;

macro AddAction(params)
    return 0;
end;

macro EditAction(params, items)
    return 0;
end;

macro DeleteAction(params, items)

    return provider;
end;

class NameAlgItem(t,n,ti)
    var Type : integer = t;
    var Number : integer = n;
    var Title : string = ti;
end;

private macro GetNameAlgListQuery()

    CaptureOutput;
    [
        select T_ITYPEALG type,T_INUMBERALG num,T_SZNAMEALG title from dnamealg_dbt
    ];

    var cmdText = StopCaptureOutput;
    return cmdText;
end;


macro GetNameAlgList(
  params
 ,pageSize:Integer                            // Размер страницы
 ,pageIndex:Integer                             // Номер страницы
 ,filterItems//:TArray of FilterConditionItem // Значения фильтрации
 ,orderItems//:TArray of OrderItem            // Параметры сортировки
)//:TArray of NameAlgItem

    var fp = FilterParser(filterItems);
    fp.AddFieldCondition(1, "dnamealg_dbt", "T_ITYPEALG");
    fp.AddFieldCondition(2, "dnamealg_dbt", "T_INUMBERALG");
    fp.AddFieldCondition(3, "dnamealg_dbt", "T_SZNAMEALG");
    println(fp.GetFullSQLCondition());

    var query = GetNameAlgListQuery();
    query = query + " where " + fp.GetFullSQLCondition();
    query = SQL_WrapSelect(query, pageIndex, pageSize);
    var cmd = RsdCommand(query);
    cmd.execute();
    var rs = TRsbDataSet(cmd);

    var result = TArray();

    while(rs.MoveNext())
      result[result.Size] = NameAlgItem(rs.type, rs.num, rs.title);
    end;   

    return result;
end;

macro GetNameAlgListItemCount(
    params,
    filterItems//:TArray of FilterConditionItem // Значения фильтрации
    )

    var fp = FilterParser(filterItems);
    fp.AddFieldCondition(1, "dnamealg_dbt", "T_ITYPEALG");
    fp.AddFieldCondition(2, "dnamealg_dbt", "T_INUMBERALG");
    fp.AddFieldCondition(3, "dnamealg_dbt", "T_SZNAMEALG");
    println(fp.GetFullSQLCondition());

    var query = GetNameAlgListQuery();
    query = query + " where " + fp.GetFullSQLCondition();

  return SQL_GetNRecs(query);
end;

macro OnToolbar(items)
    fprintln("ws_scrolling_log", "On toolbar");
    return 0;
end;
*/
/*
macro GetScrollingDefinition()

// ************** тулбар **************
    var scrollToolbarItems = TArray;

    // первых
    var mItems = TArray;
    var menuItem = WebMenuItem();
    with (menuItem)
        Type = WebMenuItemType.SimpleItem;
        Text = "Пункт 1";
        HotKey = "AltA";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    mItems[mItems.size] = menuItem;

    menuItem = WebMenuItem();
    with (menuItem)
        Type = WebMenuItemType.SimpleItem;
        Text = "Пункт 2";
        HotKey = "Ctrl3";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    mItems[mItems.size] = menuItem;

    var item = WebToolbarItem();
    with (item)
        Type = WebToolbarItemType.MenuButton;
        Text = "Меню";
        Tooltip = "меню кнопка";
        HotKey = "Ctrl1";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
        MenuItems = mItems;

    end;
    scrollToolbarItems[scrollToolbarItems.size] = item;

    // второй
    item = WebToolbarItem();
    item.Type = WebToolbarItemType.Separator;
    scrollToolbarItems[scrollToolbarItems.size] = item;

    // третий
    mItems = TArray;
    menuItem = WebMenuItem();
    with (menuItem)
        Type = WebMenuItemType.CheckedItem;
        Text = "Пункт 1";
        HotKey = "Ctrl2";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    mItems[mItems.size] = menuItem;

    menuItem = WebMenuItem();
    with (menuItem)
        Type = WebMenuItemType.CheckedItem;
        Text = "Пункт 2";
        HotKey = "AltD";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    mItems[mItems.size] = menuItem;

    item = WebToolbarItem();
    with (item)
        Type = WebToolbarItemType.SplitButton;
        Text = "Разделенная";
        Tooltip = "Разделенная кнопка";
        HotKey = "Ctrl2a";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
        MenuItems = mItems;

    end;
    scrollToolbarItems[scrollToolbarItems.size] = item;

    // четвертый

    item = WebToolbarItem();
    with (item)
        Type = WebToolbarItemType.Button;
        Text = "Прос.Кнопка";
        Tooltip = "Простая кнопка";
        HotKey = "Ctrl3x";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    scrollToolbarItems[scrollToolbarItems.size] = item;

    // пятый

    item = WebToolbarItem();
    with (item)
        Type = WebToolbarItemType.ToggleButton;
        Text = "Залип";
        Tooltip = "Залипающая кнопка";
        HotKey = "Ctrl4";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar");
    end;
    scrollToolbarItems[scrollToolbarItems.size] = item;

// ************** провайдеры фильтра **************
    var providers = TArray;
    var provider = WebFilterProvider();
    with (provider)
        Id = 1;
        ColumnName = "TypeColumn";
        Type = FilterParameterType_Int;
        Name = "Условие по типу";
        DefaultCondition = FilterCondition_Less;
        DefaultValue = MakeFilterValue(123);
    end;
    providers[providers.size] = provider;
    
    provider = WebFilterProvider();
    with (provider)
        Id = 2;
        ColumnName = "NumberColumn";
        Type = FilterParameterType_Int;
        Name = "Условие по номеру";
        DefaultCondition = FilterCondition_Greater;
        DefaultValue = MakeFilterValue(222);
    end;
    providers[providers.size] = provider;

    provider = WebFilterProvider();
    with (provider)
        Id = 3;
        ColumnName = "TitleColumn";
        Type = FilterParameterType_String;
        Name = "Условие по заголовку";
        DefaultCondition = FilterCondition_StartWith;
        DefaultValue = MakeFilterValue("Ко");
    end;
    providers[providers.size] = provider;

// ************** столбцы скроллинга **************

    var scrollColumns = TArray;
    item = WebScrollingItem;
    with (item)
        Name = "TypeColumn";
        Type = WebColumnType.Numeric;
        Title = "Тип";
        Tooltip = "Тип значения";
        Width = "SizeToHeader";
        Source = "Type"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "NumberColumn";
        Type = WebColumnType.Numeric;
        Title = "Номер";
        Tooltip = "Номер названия";
        Width = "Auto";
        Source = "Number"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "TitleColumn";
        Type = WebColumnType.Text;
        Title = "Заголовок";
        Tooltip = "Заголовок наименования";
        Width = "SizeToCells";
        Source = "Title"
    end;
    scrollColumns[scrollColumns.size] = item;
*/
/*
    var scrollColumns = TArray;
    item = WebScrollingItem;
    with (item)
        Name = "TextColumn";
        Type = WebColumnType.Text;
        Title = "Текстный столбец";
        Tooltip = "Текстный тултип";
        Width = "SizeToHeader";
        Source = "TextValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "NumericColumn";
        Type = WebColumnType.Numeric;
        Title = "Числовой столбец";
        Tooltip = "Числовой тултип";
        Width = "Auto";
        Source = "NumericValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "MoneyColumn";
        Type = WebColumnType.Money;
        Title = "Денежный столбец";
        Tooltip = "Денежный тултип";
        Width = "SizeToHeader";
        Source = "MoneyValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "FlagColumn";
        Type = WebColumnType.Flag;
        Title = "Флагный столбец";
        Tooltip = "Флагный тултип";
        Width = "SizeToHeader";
        Source = "FlagValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "DateColumn";
        Type = WebColumnType.Date;
        Title = "Датный столбец";
        Tooltip = "Датный тултип";
        Width = "SizeToHeader";
        Source = "DateValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "TimeColumn";
        Type = WebColumnType.Time;
        Title = "Временный столбец";
        Tooltip = "Временный тултип";
        Width = "SizeToHeader";
        Source = "TimeValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "DateTimeColumn";
        Type = WebColumnType.DateTime;
        Title = "ДатныйВременный столбец";
        Tooltip = "ДатныйВременный тултип";
        Width = "SizeToHeader";
        Source = "DateTimeValue"
    end;
    scrollColumns[scrollColumns.size] = item;
*/
/*
// ************** описание скроллинга **************
    var scrolling = WebScrolling();
    scrolling.Columns = scrollColumns;
    with (scrolling)
        // UID скроллинга.
        ScrollingID = "NewScroll001";
        // Наименование панели.
        Title = "Заголовок нового скроллинга";
        // Ширина панели.
        Width = 700;
        // Высота панели.
        Height = 500;
        // Признак отображения кнопки <Помощь> у панели.
        IsHelpButtonVisible = false;
        // Ссылка на имя страницы файла-помощи. Если isHelpButtonVisible=False, то не используется.
        HelpPage = "";
        // Признак отображения кнопки <Создать>.
        IsAddButtonVisible = true;
        // Сервис, вызываемый по кнопке <Создать>. Сервис должен вернуть объект и мета-данные панели ввода объекта.
        AddService = WebServiceCallback("ws_scrolling", "AddAction");
        // Признак отображения кнопки <Редактировать>.
        IsEditButtonVisible = true;
        // Сервис, вызываемый по кнопке <Редактировать>. Сервис должен вернуть объект и мета-данные панели редактирования объекта.
        EditService = WebServiceCallback("ws_scrolling", "EditAction");
        // Признак отображения кнопки <Редактировать>.
        IsDeleteButtonVisible = true;
        // Сервис, вызываемый по кнопке <Удалить>.
        DeleteService = WebServiceCallback("ws_scrolling", "DeleteAction");
        // Признак отображения кнопки <Автообновление>.
        IsAutoRefreshButtonVisible = true;
        // Кнопки и другие элементы тулбара панели. Массив. Размещаются на Тулбаре в порядке следования в массиве.
        ToolbarItems = scrollToolbarItems;
        // Поля скроллинга. Массив.
        Columns = scrollColumns;
        // Признак наличия фильтра.
        IsFilterVisible = true;
        // Атрибуты фильтра. Массив.
        FilterItems = providers;
        // Сервис, возвращающий число записей скроллинга в соответствии с текущим наложенным фильтром.
        //GetRowCountService = WebServiceCallback("ws_scrolling", "GetRowCount");
        GetRowCountService = WebServiceCallback("ws_scrolling", "GetNameAlgListItemCount");
        // Сервис, возвращающий записи скроллинга в соответствии с текущим наложенным фильтром. Записи возвращаются только для текущей активной страницы скроллинга.
        //GetRowsService = WebServiceCallback("ws_scrolling", "GetRows");
        GetRowsService = WebServiceCallback("ws_scrolling", "GetNameAlgList");
        // Признак определяет доступность в скроллинге функционала пользовательского перемещения отдельных записей по списку.
        IsUpdateOrderRowsEnabled = true;
        // Сервис перемещает набор выделенных записей выше или ниже в скроллинге.
        UpdateOrderRowsService = WebServiceCallback("ws_scrolling", "ReorderRows");
        // Сервис выполняет подсчет общей суммы по первому денежному столбцу скроллинга. Если денежных столбцов нет, то кнопку не отображаем.
        GetColumnSumService = WebServiceCallback("ws_scrolling", "CalculateSum");

    end;
    return scrolling;
end;
*/
/*
macro CustomAction(params, scrollingID, selectedItem, items, columnName)
    return 0;
end;

macro AddAction(params, scrollingID)
    return 0;
end;

macro EditAction(params, scrollingID, selectedItem)
    return 0;
end;

macro DeleteAction(params, scrollingID, items)
    return 0;
end;

class ScrollItem
    var TextValue;
    var MoneyValue;
end;

macro GetRows(params, scrollingID, pagesize, pagenum, filterItems /*TArray of FilterConditionItem Значения фильтрации*/, orderItems)
    var a = TArray;
    var item = ScrollItem();
    with (item)
        item.TextValue = "text";
        item.MoneyValue = $33;
    end;
    a[a.size] = item;

    item = ScrollItem();
    with (item)
        item.TextValue = "vesta";
        item.MoneyValue = $54.322;
    end;
    a[a.size] = item;
    return a;
end;

macro GetRowCount(params, scrollingID, filterItems /*TArray of FilterConditionItem Значения фильтрации*/)
    return 2;
end;

macro ReorderRows(params, scrollingID, items, operation /*MoveDirection*/)
    return 0;
end;

macro CalculateSum(params, scrollingID, columnName, items) // : ColumnSumServiceResult
    var result = ColumnSumServiceResult;
    result.TotalSum = $555;
    result.SelectedItemsSum = $111;
    return result;
end;


macro GetScrollingDefinition()

// ************** тулбар **************
    var scrollToolbarItems = TArray;

    var item = WebToolbarItem();
    with (item)
        Type = WebToolbarItemType.Button;
        Text = "Прос.Кнопка";
        Tooltip = "Простая кнопка";
        HotKey = "Ctrl3x";
        Service = WebServiceCallback("ws_scrolling", "OnToolbar", "777", WebServiceResultType.Scrolling);
    end;
    scrollToolbarItems[scrollToolbarItems.size] = item;
// ************** столбцы скроллинга **************

    var scrollColumns = TArray;
    item = WebScrollingItem;
    with (item)
        Name = "TextColumn";
        Type = WebColumnType.Text;
        Title = "Тип";
        Tooltip = "Тип значения";
        Width = "SizeToHeader";
        Source = "TextValue"
    end;
    scrollColumns[scrollColumns.size] = item;

    item = WebScrollingItem;
    with (item)
        Name = "MoneyColumn";
        Type = WebColumnType.Money;
        Title = "Денежный столбец";
        Tooltip = "Денежный тултип";
        Width = "SizeToHeader";
        Source = "MoneyValue"
    end;
    scrollColumns[scrollColumns.size] = item;

// ************** описание скроллинга **************
    var scrolling = WebScrolling();
    scrolling.Columns = scrollColumns;
    with (scrolling)
        // UID скроллинга.
        ScrollingID = "NewScroll001";
        // Наименование панели.
        Title = "Заголовок нового скроллинга";
        // Ширина панели.
        Width = 700;
        // Высота панели.
        Height = 500;
        // Признак отображения кнопки <Помощь> у панели.
        IsHelpButtonVisible = false;
        // Ссылка на имя страницы файла-помощи. Если isHelpButtonVisible=False, то не используется.
        HelpPage = "";
        // Признак отображения кнопки <Создать>.
        IsAddButtonVisible = true;
        // Сервис, вызываемый по кнопке <Создать>. Сервис должен вернуть объект и мета-данные панели ввода объекта.
        AddService = WebServiceCallback("ws_scrolling", "AddAction");
        // Признак отображения кнопки <Редактировать>.
        IsEditButtonVisible = true;
        // Сервис, вызываемый по кнопке <Редактировать>. Сервис должен вернуть объект и мета-данные панели редактирования объекта.
        EditService = WebServiceCallback("ws_scrolling", "EditAction");
        // Признак отображения кнопки <Редактировать>.
        IsDeleteButtonVisible = true;
        // Сервис, вызываемый по кнопке <Удалить>.
        DeleteService = WebServiceCallback("ws_scrolling", "DeleteAction");
        // Признак отображения кнопки <Автообновление>.
        IsAutoRefreshButtonVisible = true;
        // Кнопки и другие элементы тулбара панели. Массив. Размещаются на Тулбаре в порядке следования в массиве.
        ToolbarItems = scrollToolbarItems;
        // Поля скроллинга. Массив.
        Columns = scrollColumns;
        // Признак наличия фильтра.
        IsFilterVisible = false;
        // Атрибуты фильтра. Массив.
        //FilterItems = providers;
        // Сервис, возвращающий число записей скроллинга в соответствии с текущим наложенным фильтром.
        GetRowCountService = WebServiceCallback("ws_scrolling", "GetRowCount");
        // Сервис, возвращающий записи скроллинга в соответствии с текущим наложенным фильтром. Записи возвращаются только для текущей активной страницы скроллинга.
        GetRowsService = WebServiceCallback("ws_scrolling", "GetRows");
        // Признак определяет доступность в скроллинге функционала пользовательского перемещения отдельных записей по списку.
        IsUpdateOrderRowsEnabled = true;
        // Сервис перемещает набор выделенных записей выше или ниже в скроллинге.
        UpdateOrderRowsService = WebServiceCallback("ws_scrolling", "ReorderRows");
        // Сервис выполняет подсчет общей суммы по первому денежному столбцу скроллинга. Если денежных столбцов нет, то кнопку не отображаем.
        GetColumnSumService = WebServiceCallback("ws_scrolling", "CalculateSum");

    end;
    return scrolling;
end;

macro OnToolbar(params, scrollingID, selectedItem, items, columnName)
//    fprintln("ws_scrolling_log", "On toolbar");
    return GetScrollingDefinition();
end;
*/