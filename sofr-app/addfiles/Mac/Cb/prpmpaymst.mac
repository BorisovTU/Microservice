/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2009              */
/*                                                                      */
/*  Имя файла      : prpmpaymst.mac                                     */
/*                                                                      */
/*  Описание       : Вызов печати платежа со штампом                    */
/*                                                                      */
/*  Программист    : Катюшин А.А.                                       */
/*                                                                      */
/*  Создан         : 01.07.09                                           */
/*                                                                      */
/************************************************************************/

import prpm;

MACRO PrintDocument(ncopy:integer):bool
  var DocKind:string = pr_pmrmprop.rec.ShifrOper,
      stat:bool;
  
  /* Платежный ордер (частичная оплата картотеки 2 печатается так всегда) */
  if (DocKind == "16" ) 
    stat = FillBuffersForPayOrderPrint();
    if(stat)
      stat = ExecMacroFile("prpmorist.mac", "PrintPayOrder", ncopy);
    end;

  /* Клиентское платежное поручение с шифром 06 является инкассовым поручением */
  elif (DocKind == "06" ) 
    stat = ExecMacroFile("prpminist.mac", "PrintIncashRequest", ncopy);

  /*Платежное поручение*/
  elif (DocKind == "01")
    stat = ExecMacroFile("prpmrqist.mac", "PrintPayReq", ncopy);

  /*Платежное требование*/
  elif (DocKind == "02")
    stat = ExecMacroFile("prpmdmist.mac", "PrintPayDem", ncopy);

  /*Платежное требование-поручение*/
  elif (DocKind == "05")
    stat = ExecMacroFile("prpminist.mac", "PrintIncashRequest", ncopy);

  /*Аккредитив*/
  elif (DocKind == "08") 
    stat = ExecMacroFile("prpmaci.mac", "PrintAkkreditiv", ncopy, ((pr_debet.rec.IsSender == "X") or (pr_credit.rec.IsSender == "X")));

  /*Платежное поручение*/
  elif( paymentIsRequest(pr_pmpaym, pr_debet, pr_credit) )
    stat = ExecMacroFile("prpmrqist.mac", "PrintPayReq", ncopy);

  /*Платежное требование*/
  elif( paymentIsDemand(pr_pmpaym, pr_debet, pr_credit) )
    stat = ExecMacroFile("prpmdmist.mac", "PrintPayDem", ncopy);
  
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    stat = FALSE;
  end;
  
  return stat;

END;
