/*
$Name:           sfunicntrpr.mac
$Module:         Ядро ГКБО
$Description:    ПЗО: Отчет о массовой печати СДО
*/

RECORD SfUnionContr (sfunioncontr);

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)

        setbuff (SfUnionContr,firstdoc);

var stat;
        if (Вызов==Первый)
[    Отчет о групповом выполнении операции.    ];
[+----------------+------+------------------------------------------------------------+];
[|   Номер        |Номер |                 Сообщение                                  |];
[|    СДО         |ошибки|                                                            |];
[+----------------+------+------------------------------------------------------------+];
        elif (Вызов==Ошибка)

                if (Статус == 0)
                        Сообщение = "Операция выполнена успешно";
                end;
[|################|######|############################################################|](SfUnionContr.Number,Статус,Сообщение);
        elif (Вызов==Последний)
[+----------------+------+------------------------------------------------------------+];
        end;
END;