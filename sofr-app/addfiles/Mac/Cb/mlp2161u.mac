/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : mlp2161u.mac.mac
  Created     : 25.08.2009
  Programmer  : Попова О.
  Description : Печатная форма МО по ф.2161-У
                без учета курсовых разниц

└───────────────────────────────────────────────────────────────────────────*/


import "pr2161lib.mac", OprInter;

private VAR CopyCont = 1;          /* Кол-во копий                         */

var pr_document:TRecHandler = TRecHandler( "acctrn.dbt", "bank.def" );
var pr_multydoc:TRecHandler = TRecHandler( "multydoc.dbt", "bank.def" );

MACRO PrintDocument(ncopy: integer, DocKind:integer ):bool
  CopyCont = ncopy;
  while(CopyCont)
    if( DocKind == DLDOC_CARRY )
      СформироватьОтчетДляПроводки( pr_document, 1 );
    elif( DocKind == CB_MULTYDOC )
      СформироватьОтчетДляМультивалютногоМО( pr_multydoc, 1 );
    else
      MsgBox("Данный вид документа не поддерживается макросом");
      return false;
    end;
    CopyCont = CopyCont - 1;
  end;
  return true;
END;