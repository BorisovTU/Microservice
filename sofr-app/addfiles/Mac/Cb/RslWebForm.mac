/*
$Name:               RslWebForm.mac
$Module:             Web
$Description:        Использование Web-клиента из EasyWin
*/

import rsbwebinter;

private var webClient = TRslWebClient;

webClient.SetURL("http://");

private var pos = 1;
private var args = cmdArgs;

private macro SetPrm(str)

   var p = index(str, ":");
   var parmName = trim(substr(str, 1, p - 1));
   var parmValue = trim(substr(str, p + 1));

   if (strlen(parmName))
      webClient.AddParam(parmName, parmValue);
   end;
end;

while(pos > 0)
    pos = index(args, "-", 2);
    if (pos > 0)
       SetPrm(substr(args, 2, pos - 2));
       args = substr(args, pos);
    else
        SetPrm(substr(args, 2));
    end;
end;

webClient.ShowWebForm();

