/*
  $Name:        bnk_IStreamImpl.mac
  $Module:      Ядро Банкинг
  $Description: Объекты, реализующие интерфейс IStream
*/
//-----------------------------------------------------------------------------
//          Автоматизированная банковская система RS-Bank               
//                 Copyright (c) R-Style Software Lab
//
// Подсистема   : Ядро Банкинг
//
// Описание     : Объекты, реализующие интерфейс IStream
//
// Программист  : Чукина Т.А.
//
// Создан       : 01.04.2016
//
//-----------------------------------------------------------------------------

import "lib_lang.mac";

class TIStreamImpl
  macro CreateFile(FName : string)
    PureVirtualFunc();
  end;

  macro CloseFile
    PureVirtualFunc();
  end;

  macro GetObjIStream : object
    PureVirtualFunc();
  end;
end;

class (TIStreamImpl) TIStreamImpl_NewObjects
  private var sfile : object = ActiveX("newObjects.binsrv.FileStream");

  macro CreateFile(FName : string)
    sfile.CreateFile(FName);
  end;

  macro CloseFile
    sfile.Close();
  end;

  macro GetObjIStream : object
    return sfile;
  end;
end;

class (TIStreamImpl) TIStreamImpl_RS
  private var RsFile = null;

  macro CreateFile(FName : string)
    RsFile = TStream(FName, "C");
  end;

  macro CloseFile
    RsFile = null;
  end;

  macro GetObjIStream : object
    return RsFile.Stream;
  end;
end;
