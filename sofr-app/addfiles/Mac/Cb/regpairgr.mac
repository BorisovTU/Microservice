/*Пример макроса формирования основания проводок по выведению единого результата*/


/*Функция содержит следующие входные параметры:
- Тип выполняемой проводки: 1 ("Урегулирование парных счетов") или 2 ("Выведение единого результата")
- Дата проводки. 
- Буфер проводки.
Возвращать функция должна текстовую строку.
*/
macro УстановитьОснование( CarryType, RegDate, BuffDoc )
  var stat = 0, 
      Ground = "Основание проводки задано в макросе.";
  
  record Документ( arhdoc );
  setbuff( Документ, BuffDoc );

  if( CarryType == 1 )
    Ground = Ground + "\nУрегулирование парных счетов за " + RegDate;
    Ground = Ground + " со счета " + Документ.Account_Payer +" на счет " + Документ.Account_Receiver + ".";
  elif( CarryType == 2 )
    Ground = Ground + "\nВыведение единого результата на конец дня " + RegDate + ".";
  end;

  return Ground;

end;
