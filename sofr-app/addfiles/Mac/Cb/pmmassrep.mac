import oralib;

MACRO PrintReport()

  var select :string = "select rm.t_Number, rm.t_Date, db.t_BankCode, pm.t_PayerAccount, cr.t_BankCode, pm.t_ReceiverAccount, "
                              "t.t_ErrorStatus, decode( nvl(t.t_ErrorMessage, CHR(1)), CHR(1), msg.t_Contents, t.t_ErrorMessage ) "
                       "from doprtemp_tmp  t, "
                            "dpmpaym_dbt   pm, "
                            "dpmrmprop_dbt rm, "
                            "dpmprop_dbt   db, "
                            "dpmprop_dbt   cr, "
                            "dbank_msg     msg "
                       "where pm.t_PaymentID = t.t_OrderID "
                         "and rm.t_PaymentID = pm.t_PaymentID "
                         "and db.t_PaymentID = pm.t_PaymentID "
                         "and db.t_DebetCredit = 0 "
                         "and cr.t_PaymentID = pm.t_PaymentID "
                         "and cr.t_DebetCredit = 1 "
                         "and msg.t_Number(+) = t.t_ErrorStatus "
                        "order by pm.t_PaymentID";

    [
        ¥§ã«ìâ âë ¬ áá®¢®© ®¡à ¡®âª¨ ¤®ªã¬¥­â®¢

     ÚÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÂÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿
     ³  ®¬¥à  ³ „ â      ³  ­ª ¯« â¥«ìé¨ª ³ ‘ç¥â ¯« â¥«ìé¨ª     ³  ­ª ¯®«ãç â¥«ï ³ ‘ç¥â ¯®«ãç â¥«ï     ³ ¥§ã«ìâ â ®¡à ¡®âª¨                    ³
     ÃÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÅÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´ ];

  var rs:RsdRecordset = execSQLselect( select );
  var result:string = "";
  var total_success:integer = 0, total_error:integer = 0;

  while( rs.moveNext() )
    
    if( not rs.value(6) )
      result = "“á¯¥è­® ®¡à ¡®â ­";
      total_success = total_success + 1;
    else
      result = string( rs.value(6), " ", rs.value(7) );
      total_error = total_error + 1;
    end;

    [³######## ³##########³#################³#####################³#################³#####################³########################################³ ]
    ( rs.value(0):r, date(rs.value(1)):l, rs.value(2):l, rs.value(3):l, rs.value(4):l, rs.value(5):l, result:l:w );

  end;

    [ÀÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÁÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ
    ˆâ®£®
      - ®¡à ¡®â ­®: #
      - ãá¯¥è­®   : #
      - á ®è¨¡ª®© : #](total_success + total_error:l, total_success:l, total_error:l);

END;