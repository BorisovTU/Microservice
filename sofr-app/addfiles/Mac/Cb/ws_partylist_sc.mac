 /*
 $Name: ws_partylist_sc.mac
 $Module: Главная книга
 $Description: Макрос скроллинга субъектов
 */

import "ws_partylistclass.mac";

///////////////////////////////////////////////////////////
// Получить список пользователей постранично
// PageSize - размер страницы
// PageNum - номер страницы НАЧИНАЯ С 0 !!!
///////////////////////////////////////////////////////////

macro GetPartyList( pagesize            : integer,
                    pagenum             : integer,
                    listkind            : integer,
                    namekind            : integer,
                    codekind            : integer,
                    paperkind           : integer,
                    partykindcollection : string,
                    filteritems,
                    orderitems,
                    param,
                    isallparty          : bool,
                    PartyEx ):TArray

  var obj = PartyList(isallparty);

  return obj.GetList( pagesize, pagenum, listkind, namekind, codekind, paperkind, partykindcollection, filteritems, orderitems, PartyEx );


end;

///////////////////////////////////////////////////////////
// Получить общее количество субъектов (для паджинации)
///////////////////////////////////////////////////////////

macro GetPartyCount(listkind            : integer,
                    namekind            : integer,
                    codekind            : integer,
                    partykindcollection : string,
                    filteritems,
                    param,
                    isallparty          : bool,
                    PartyEx ):integer

  var obj = PartyList(isallparty);

  return obj.GetCount( listkind, namekind, codekind, partykindcollection, filteritems, PartyEx);

end;