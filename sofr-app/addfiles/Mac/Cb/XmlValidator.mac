/*
$Name: XmlValidator.mac
$Module: ü§‡Æ ÉäÅé
$Description: Xml XSd Validator
*/
import "serviceaction.mac";

class XmlValidator
    var parser = CreateXMLParserValidate();
    var cache = CreateSchemaCollection();
    parser.schemas = cache;
    var objErr;

    macro addXsdEx(NamespaceURI, XsdFileName)
        var xsd = CreateXMLParserValidate();
        xsd.load(XsdFileName);
        cache.add(NamespaceURI, xsd);
    end;

    macro addXsd(XsdFileName)
        addXsdEx("", XsdFileName);
    end;

    macro loadXML(XmlString)
        return parser.loadXML(XmlString);
    end;

    macro loadFile(XmlFileName)
        return parser.load(XmlFileName);
    end;

    macro validate()
        objErr = parser.Validate();
        return objErr;
    end;
end;