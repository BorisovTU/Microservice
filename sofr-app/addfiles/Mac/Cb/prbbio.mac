import FIInter, pralcash, prbboo, prbbadd, prcsord;

/* печать приходного кассового ордера из ББ */
macro PrintIncCashDoc( ord, pm, sb )
  setbuff( payment, pm  );
  setbuff( order,   ord );
  /* вызываем печать обычного приходного кассового ордера */
  PrintIncomeCashOrder(payment, order, 0);
end;

/* массовая печать кассовых ордеров из ББ */
macro Cash_MassPrint( Num, /* число печатаемых копий, если 0, считается первым вызовом */
                      aa, bb, cc )
  var err;
  setbuff( payment, bb  );
  setbuff( order,   aa );

  if(Num) MassCopy = Num;
  else    MassCopy = КоличествоКопий;
  end;

  if(MassCopy == 0)
    MassCopy = GetNumCopy();
  end;

  if(MassCopy <= 0) return false;end;

  if  (order.DocKind == 400) err = PrintAddCashDoc(aa, bb, cc);
  elif(order.DocKind == 430) err = PrintIncomeCashOrder(payment, order, MassCopy);
  elif(order.DocKind == 440) err = PrintOutgoCashOrder(payment, order, MassCopy);
  end;

  if(err) return true; end;

  return MassCopy;

end;

/* Вызов происходит перед печатью 1-го документа из списка */
MACRO Cash_HeaderMassPrint
  MassCopy = 1;
  if ( not GetInt(MassCopy,"Введите количество копий.",3))
    MassCopy = 0;
  end;
  return MassCopy;
END;

/* Вызов происходит после печати последнего документа */
MACRO Cash_ItogMassPrint
END;
