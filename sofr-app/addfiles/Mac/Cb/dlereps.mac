/* IR 23.10.02 перенес из векселей */

Import rsexts, Dlerept, dlreptls;

/*Печать отчета из файла меток*/
MACRO DLEREPS_PrintReportFromFile (fullserverfilename)
var
    fulltermfilename;

    if (IsStandAlone) /*Двухзвенка*/
        if (DLREPTLS_FillTemplsPaths())
          MsgBox("Ошибка при получении путей к шаблонам из настроек банка");
          return false;
        end;
        DLEREPT_PrintReportFromFile (fullserverfilename, false);
    else /*Трехзвенка*/
        fulltermfilename = CallRemoteRsl("DLerept.mac", "DLREPTL_GetTxtFileDir") + "exlrep." + UserNumber;

        if (not CopyFile (fullserverfilename,"$"+fulltermfilename))
            MsgBox ("Ошибка при передаче файла на терминал");
            return false;
        else
            CallRemoteRsl ("DLerept.mac" ,"DLEREPT_PrintReportFromFile", fulltermfilename, true);
        end;
    end;

    return true;
end;