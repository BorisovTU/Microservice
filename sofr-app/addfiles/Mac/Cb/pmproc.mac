/*
$Name:             pmproc.mac
$Module:           
$Description:      
*/
//-----------------------------------------------------------------------------
// Блок      : Вне блока
// Шаг       : Вне шага
// Назначение: Макрос скроллинга
// Описание  : Макрос скроллинга платежей к обработке
//-----------------------------------------------------------------------------

import BankInter, pm_tools;

record  pm_paym ( pmpaym );
record  debet ( pmprop );
record  credit ( pmprop );
record  rm( pmrmprop );
record  curtr( pmcurtr );
record  pmkz( pmkz );

record  old_pm_paym ( pmpaym );
record  old_debet ( pmprop );
record  old_credit ( pmprop );
record  old_rm( pmrmprop );
record  old_curtr( pmcurtr );
record  old_pmkz( pmkz );

MACRO УстановитьПодсказку( TableName:string, IndexNum:integer, DefaultHint:string, ScrolStates:integer ):string
  
  // 1 - Незавершенные МФР
  // 2 - Ручная обработка, Контроль ручной обработки
  // 3 - На валютном контроле
  
  if( ScrolStates == 3 )
    return "/*+FIRST_ROWS LEADING(oprstep oproper t insprop outprop pmrmprop) index(oprstep doprstep_dbt_idx10) index(t dpmpaym_dbt_idx0) USE_NL(oprstep oproper t insprop outprop pmrmprop)*/";
  else
    return "/*+FIRST_ROWS LEADING(t oproper pmpaym dbprop crprop pmrmprop) index(t doprstep_dbt_idx10) index(pmpaym dpmpaym_dbt_idx0) USE_NL(t oproper pmpaym dbprop crprop pmrmprop)*/";
  end;

END;

/*
                      Пользовательская функция
     Режимы функции
        UFN_SCROL       = 3 - вызов из скроллинга
        UFN_PANEL_VIEW  = 7 - панель просмотра
     (константы доступны при подключенном BankInter)
*/
macro Функция_Пользователя( режим )
   return 0;
end;


macro Проверить_Документ(mode)
  
  if(mode == OBJ_UPDATE)
    
    if(PM_CheckCO(pm_paym,rm,debet,credit)) 
      return 1; 
    end;

  end;
  
  return 0;

end;
