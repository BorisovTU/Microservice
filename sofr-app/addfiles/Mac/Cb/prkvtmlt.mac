
/*                   R-Style SoftWare Lab, RS-Bank 6.0                      */
/*  Печать отчета квитовки сводного платежа                                 */
/*                                                                          */
/*  Имя файла: prkvtmlt.mac                                                 */
/*  Создан:    13.07.07                                                     */
/*--------------------------------------------------------------------------*/

private const   Квитовка = 0,
                ОткатКвитовки = 1;

private var Number, NumKvit, KindAction;

MACRO PrintHead(KindAct,NumMpm,DateMpm)
  var Kind = "";
  KindAction = KindAct;
  Number = 0;
  NumKvit = 0;            
  if( KindAct == Квитовка ) 
    Kind = "квитовки";
  elif ( KindAct == ОткатКвитовки )
    Kind = "отката квитовки";
  end;
[ Результат ############### сводного платежа № ############### от ########## ] ( Kind, NumMpm:l, DateMpm );
[ ┌───┬─────────────────────────┬─────────────────────────┬─────────────────┬──────────────────────────────┐
  │Nпп│  Референс               │ Счет получателя         │ Сумма документа │ Результат                    │
  ├───┼─────────────────────────┼─────────────────────────┼─────────────────┼──────────────────────────────┤];
  
END;


MACRO PrintRecord( Ref, Acc, Sum, Result )
  var stat;
  Number = Number + 1;
  
  if(Result == "")
    NumKvit = NumKvit + 1;
    if(KindAction == Квитовка)
      Result = "Сквитован";
    elif(KindAction == ОткатКвитовки)
      Result = "Откат шага выполнен успешно";
    end;
  end;

[ │###│#########################│#########################│#################│##############################│]
( Number:r, Ref, Acc, Sum, Result ); 
  

END;

MACRO PrintItog()
[ └───┴─────────────────────────┴─────────────────────────┴─────────────────┴──────────────────────────────┘
  Итого                       
    сквитовано документов: #####
            не сквитовано: #####]
(NumKvit, (Number - NumKvit));
END;
