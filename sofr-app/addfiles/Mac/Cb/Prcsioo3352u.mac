/*
 $Name:        Prcsioo3352u.mac
 $Module:      ББ
 $Description: Печать приходно-расходного кассового ордера по 3352-У
*/

// Программист: TDV 2014

import globals, FIInter, PTInter, PaymInter, oprinter;
import prcs_common;
import RsbDataSet;

PRIVATE MACRO PrintIncCashOrder( d : TInOutOrderPrintData, ncopy : integer ):bool                                                                                
  var CashSymbCount = 1;
  array ArrayGround,ArraySum,ArrayPaperName,ArrayPayerBankName,ArrayReceiverBankName;

  StrSplit(d.PayerBankName, ArrayPayerBankName, 72, 55, 2);
  StrSplit(d.ReceiverBankName, ArrayReceiverBankName, 72, 56, 2);
  StrSplit(d.SumString, ArraySum, 47, 32, 3);
  StrSplit(d.Ground, ArrayGround, 72, 62, 3);
  StrSplit(d.Document, ArrayPaperName, 72, 24, 3);
  
  while(ncopy > 0)  
    ncopy = ncopy - 1;
    [                                                                     
                                                                                                                                  ┌─────────────────────┐
                                                                                                                                  │ Код формы документа │
                                                                                                                                  │   по ОКУД 0402007   │
                                           ┌───────┐                           │                                     ┌───────┐    └─────────────────────┘
       Приходно-расходный кассовый ордер N │#######│                           │ Приходно-расходный кассовый ордер N │#######│                           
                                           └───────┘                           │                                     └───────┘
       #########################                                               │  #########################
       ─────────────────────────                                               │  ─────────────────────────                                                 
                 Дата                                                          │            Дата                                                             
                                                                               │                                                                         
       ПРИХОДНАЯ ЧАСТЬ                                                         │  РАСХОДНАЯ ЧАСТЬ
                                                                               │
       От кого ################################################################│ Выдать #################################################################
               ────────────────────────────────────────────────────────────────│        ─────────────────────────────────────────────────────────────────
                            (фамилия, имя, отчество (при наличии))             │                     (фамилия, имя, отчество (при наличии))        
                                                                               │                        
       Банк отправитель #######################################################│ Банк получатель ########################################################      
                        ───────────────────────────────────────────────────────│                 ────────────────────────────────────────────────────────
       ########################################################################│########################################################################
       ────────────────────────────────────────────────────────────────────────│─────────────────────────────────────────────────────────────────────────
       Банк получатель ########################################################│ Банк отправитель #######################################################      
                       ────────────────────────────────────────────────────────│                  ───────────────────────────────────────────────────────
       ########################################################################│########################################################################
       ────────────────────────────────────────────────────────────────────────│─────────────────────────────────────────────────────────────────────────
                       ДЕБЕТ                ┌──────────────────────────────────┤                ДЕБЕТ                 ┌─────────────────────────────────┐
       ┌────────────────────────────────────┤          Сумма цифрами           │┌─────────────────────────────────────┤             Сумма цифрами       │
       │ счет № #########################   │ ###          ################### ││ счет № #########################    │ ###         ################### │
       └────────────────────────────────────┤                                  │└─────────────────────────────────────┤                                 │
                       КРЕДИТ               │                                  │               КРЕДИТ                 │                                 │
       ┌────────────────────────────────────┤                                  │┌─────────────────────────────────────┤                                 │
       │ счет № #########################   │                                  ││ счет № #########################    │                                 │
       └────────────────────────────────────┴─────────┬────────────────────────┤└─────────────────────────────────────┴─────────┬───────────────────────┤
       Сумма прописью ################################│         Символ         │ Сумма прописью ################################│        Символ         │
                      ────────────────────────────────┤   ##################   │                ────────────────────────────────┤  ##################   │
       ###############################################│                        │ ###############################################│                       │
       ───────────────────────────────────────────────┤                        │────────────────────────────────────────────────┤                       │
       ###############################################│                        │ ###############################################│                       │
       ───────────────────────────────────────────────┴────────────────────────│────────────────────────────────────────────────┴───────────────────────┘
       Основание ##############################################################│ Основание ############################################################## 
                 ──────────────────────────────────────────────────────────────│           ──────────────────────────────────────────────────────────────
       ########################################################################│ ######################################################################## 
       ────────────────────────────────────────────────────────────────────────│─────────────────────────────────────────────────────────────────────────
        Вноситель                                                              │                                             ############################
                                 ────────────────  ────────────────────────────│ ────────────────────────  ────────────────  ────────────────────────────
                                 (личная подпись)      (фамилия, инициалы)     │ (наименование должности)  (личная подпись)      (фамилия, инициалы)     
                                                   ############################│                                                                         
       ────────────────────────  ────────────────  ────────────────────────────│ ────────────────────────  ────────────────  ────────────────────────────
       (наименование должности)  (личная подпись)      (фамилия, инициалы)     │ (наименование должности)  (личная подпись)      (фамилия, инициалы)     
                                                   ############################│                                                                         
       ────────────────────────  ────────────────  ────────────────────────────│ Получил по документу, удостоверяющему личность  ########################
       (наименование должности)  (личная подпись)      (фамилия, инициалы)     │                                                 ────────────────────────
                                                                               │ ########################################################################
                                                                               │ ────────────────────────────────────────────────────────────────────────
                                                                               │              (наименование документа, серия, номер,                     
                                                                               │ ###################################################
                                                                               │ ───────────────────────────────────────────────────  ───────────────────
                                                                               │                            кем и когда выдан)         (личная подпись)  
                                                                               │                                             ############################
                                                                               │ ────────────────────────  ────────────────  ────────────────────────────
                                                                               │ (наименование должности)  (личная подпись)      (фамилия, инициалы)     ]

     (d.Number:c,d.Number:c,
      d.DateStr:c,d.DateStr:c,
      d.Client:l,d.Client:l,
      ArrayPayerBankName(0):l,ArrayReceiverBankName(0):l,
      ArrayPayerBankName(1):l,ArrayReceiverBankName(1):l,
      ArrayReceiverBankName(0):l,ArrayPayerBankName(0):l,
      ArrayReceiverBankName(1):l,ArrayPayerBankName(1):l,
      d.PayerAccount:l, d.CCY_Code:l, d.Amount:r, d.PayerAccount:l, d.CCY_Code:l, d.Amount:r,
      d.ReceiverAccount:l, d.ReceiverAccount:l,
      ArraySum(0):l, ArraySum(0):l,
      d.ArraySym.value(0):c, d.ArraySym2.value(0):c,
      ArraySum(1):l, ArraySum(1):l,
      ArraySum(2):l, ArraySum(2):l,
      ArrayGround(0):l,ArrayGround(0):l,
      ArrayGround(1):l,ArrayGround(1):l,
      d.BworkName:c,
      d.BworkName:c,
      d.CworkName:c,
      ArrayPaperName(0):l:w,
      ArrayPaperName(1):l:w,
      ArrayPaperName(2):l:w,
      d.CCworkName:c);
  end;
  return true;  
END;


/*  Печать приходно-расходного кассового ордера*/
MACRO PrintDocument(ncopy:integer):bool

  var DocKind:integer = pr_pmpaym.rec.DocKind;
  var data : TInOutOrderPrintData = TInOutOrderPrintData();

  if( DocKind == 445 )   /*Приходно-расходный кассовый ордер*/
    data.InitByCashOrder( pr_pmpaym, pr_pmrmprop, pr_pscshdoc );  
    if( data.format == 0 )
      data.DateStr = DDpMMpYYYY( pr_pmpaym.rec.valuedate );
    end;
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintIncCashOrder(data, ncopy);

END;
