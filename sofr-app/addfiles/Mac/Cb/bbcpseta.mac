/* ╔══════════════════════════════════════════════════════════════════╗ */
/*         Автоматизированная банковская система RS-Bank v6.00          */
/*                 Copyright (c) R-Style Software Lab 2004              */
/*                                                                      */
/*  Имя файла        : bbcpseta.mac                                     */
/*                                                                      */
/*  Описание         : Выполнение шага по определению дополнительных    */
/*                     счетов для проводок конверсии                    */
/*                                                                      */
/*  Программист      : Андреева Е.П.                                    */
/*                                                                      */
/*  Создан           : 22.04.2004                                       */
/*                                                                      */
/* ╚══════════════════════════════════════════════════════════════════╝ */
import InsCarryDoc, "cppmconv.mac", "paym_rec.mac";

/**********************************/
/* Выполнение шага настроек       */
/**********************************/
MACRO ExecuteParamStep( Kind_Operation, Doc_Kind, order )

  record  cporder(bbcpord);

  setbuff( cporder,order );

  /* Только для платежа с конверсией или оплаты ПЗО */
  if(( Pm_paym.FIID != Pm_paym.PayFIID ) or (cporder.Origin == CP_OR_SF))
    if( УстановитьДополнительныеСчетаПроводокКонверсии( 1, Pm_paym.FIID, Pm_paym.PayFIID, cporder.Kind_Operation ) )
      msgbox( "Ошибка при установке счетов ОВП" );
      return 1;
    end;
  end;

  return 0;

END;