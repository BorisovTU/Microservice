/*
$Name:        sfcontrref.mac
$Module:      РКО (ПЗО)  
$Description: Макрос генерации номера ДО
*/


import "globals.mac";

record SfContr ("SfContr.dbt");
record SfContrRefParm ("SfContrRefParm.rec");


macro SfContrGetRef( SeqValue, ObjKind, ObjAddr )
  var refer;

  SetBuff( SfContr,  ObjAddr );

  var sizer = GetRecordSize (SfContr);

  var BlobObjAddr = 0;
  if(ObjAddr != null)
    BlobObjAddr = OffsetMemAddr(ObjAddr, sizer);
    SetBuff( SfContrRefParm,  BlobObjAddr );
  end;

  refer = String( SfContr.PartyID:5, SfContrRefParm.ProductID:5, SeqValue:5 );
  refer = StrSubst( refer, " ", "0" );

  return refer;
end;