/*
$Name:        biljrprn.mac
$Module:      Бухгалтерия банка 
$Description: Макрос печати журнала
*/


import globals;
import "biljrprn1.mac";
import "biljrprn2.mac";

Var Direction;
Var JournalID;
Var Dolz_1;
Var FIO_1;
Var PrnDepartment = 0;
Var BeginDate     : DATE;
Var EndDate       : DATE;
Var NumStr        = 1;
Var FPrintHead     = true;
Var FPrintBottom   = true;
                                               
private FILE BILSFJOURNAL ("bilsfjournal.dbt");

/*-----------------------------------------------------------------------------------*/
MACRO PrintDocument( ncopy:integer ):bool
  Var stat = 0;
  Var NumPage  = 1 ;
  var TempFile;

  ClearRecord(BILSFJOURNAL);
  BILSFJOURNAL.JournalID = JournalID;
  if(not GetEQ(BILSFJOURNAL))
    return false;
  end;

  if(EndDate >= date(01,10,2014))
    PrintDocument2( ncopy, JournalID, Direction, Dolz_1, FIO_1, PrnDepartment, BeginDate, EndDate, NumStr, FPrintHead, FPrintBottom );
  else
    PrintDocument1( ncopy, JournalID, Direction, Dolz_1, FIO_1, PrnDepartment, BeginDate, EndDate, NumStr, FPrintHead, FPrintBottom );
  end;

  return true;
END;


