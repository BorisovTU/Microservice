//
//  Вызов макропроцедуры по замораживанию закрепленных за клиентом средств в Расчетном Банке
//
import BankInter;

private macro GetBankingMacroForBlocking : string
  var MacroName : string = "",
      RegPath : string = "ФИНМОНИТОРИНГ\\ЗАМОРАЖИВАНИЕ\\BANKING\\MACROFORBLOCKING",
      err : integer = 0;

  GetRegistryValue(RegPath, V_STRING, MacroName, err);
  if( err )
    MacroName = "rbblockcln.mac";
  end;

  return MacroName;
end;

macro FMPartyFreezeBanking(PartyID : integer) : integer
  var stat : integer = ExecMacroFile(GetBankingMacroForBlocking(), "Bnk_FreezeClient", PartyID);
  if(stat == null)
    stat = 1;
  end;

  return stat;

OnError(er)
  return 1;
end;

macro FMPartyUnFreezeBanking(PartyID : integer) : integer
  var stat : integer = ExecMacroFile(GetBankingMacroForBlocking(), "Bnk_UnFreezeClient", PartyID);
  if(stat == null)
    stat = 1;
  end;

  return stat;

OnError(er)
  return 1;
end;
