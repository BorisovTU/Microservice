/*
 *  Различные функции для работы с данными Ритейла в модуле "Финансовый мониторинг"
 */

Import "fm_turn_retail.mac";


macro CalcClientTurn( Number_I, Summa_I, Number_O, Summa_O, PartyID, Year, Quarter )

  var stat : integer;
  var _Number_I : integer, _Summa_I : money;
  var _Number_O : integer, _Summa_O : money;

  _Number_I = _Number_O = 0;
  _Summa_I = _Summa_O = $0;

  stat = RSRetail_TurnForClient( PartyID, Year, Quarter, _Number_I, _Summa_I, _Number_O, _Summa_O );

  if( stat )
    msgbox( "Ошибка при расчете оборотов по операциям RS-Retail" );
  else
  
    SetParm( 0, _Number_I ); SetParm( 1, _Summa_I );
    SetParm( 2, _Number_O ); SetParm( 3, _Summa_O );

  end;

  return stat;

end;