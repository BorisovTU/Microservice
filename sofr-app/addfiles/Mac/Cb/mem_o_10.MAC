/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*            Copyright (c) R-Style Software Lab 1999                   */
/*                                                                      */
/*  Имя файла   : mem_o_10.MAC                                          */
/*                                                                      */
/*  Описание    : Операция "Приход по внебалансу"                       */
/*                Шаг 2  "Проводки по внебалансу"                       */
/*                                                                      */
/*  Создан      : 05.04.1999                                            */
/*                                                                      */
/************************************************************************/
import BankInter, FIInter;

record mo( "uo_mem_o", "USEROP.DEF" );

/************************************************************************/
/* Процедура шага                                                       */
/************************************************************************/
macro ExecuteStep (CarryDoc, FirstDoc)
var stat = 1;
   var ErrorMsg : string;
   var doc = RsbAccTransaction(); // RsbAccTransactionData

   /* Читаем данные из пользовательского файла первичных документов */
   SetBuff( mo, FirstDoc );

   doc.Chapter         = mo.Chapter;
   doc.FIID            = mo.Code_Currency;
   doc.Date_Carry      = mo.Date_Carry;
   doc.AccountPayer    = mo.Account_Payer;
   doc.AccountReceiver = mo.Account_Receiver;
   doc.Sum             = mo.Sum;
   doc.Number_Pack     = mo.Number_Pack;
   doc.Numb_Document   = mo.Numb_Document;
   doc.Ground          = mo.Ground;
   doc.Department      = mo.Department;
   doc.Kind_Oper       = " 1"; 

   if(not doc.Carry(NULL, ErrorMsg))
     println("При формировании проводки возникла ошибка: " + ErrorMsg);
   else
     stat = 0;
   end;

   return stat;
end;
