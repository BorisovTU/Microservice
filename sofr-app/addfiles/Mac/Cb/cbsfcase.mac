/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 1998              */
/*  Имя файла        : cbsfcase.mac                                     */
/*  Описание         : Шаг - проверка необходимости квитовки/проводки   */
/*  Программист      : AAV                                              */
/*  Создан           : 14.11.02                                         */
/************************************************************************/

import "opbbcnst.mac", OprInter, "paym_rec.mac";

PRIVATE record Order( memorder );

const Menu1    = " Квитовать c фактическим  ";
const Menu2    = " Выполнить проводку";
const Menu3    = " Поместить в закрытые";
const Menu4    = " Отмена";
const MenuName = "Действия c платежом:";

/**********************************/
/* Выполнение шага                */
/**********************************/
MACRO ExecuteCaseStep(Kind_Operation, Number_Step, primdoc, KindDoc)

  var menu_item;

  menu_item = Opr_MakeChoice(Menu1, Menu2, Menu3, Menu4, MenuName);

  if( menu_item == 0 )
    return string(ББНомерШагаКвитовкаПЗО);
  elif ( menu_item == 1)
    return string(ББНомерШагаПроводкаПЗО);
  elif ( menu_item == 2)
    return string(ББНомерШагаИсполнитьПЗО);
  else
    return 1;
  end;

END;


