/*
  $Name:         voarsc.mac
  $Module:       
  $Description:  Печать отчета сканирования массовом акцепте (отказе) валютного контролера
*/

/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank v.6                                          R-Style Software Lab

  File Name   : voarsc.mac
  Created     : 14.10.2008
  Description : Печать отчета сканирования массовом акцепте (отказе) 
                   валютного контролера
└───────────────────────────────────────────────────────────────────────────*/
IMPORT  PSInter, OprInter, PSInter;

const   ПечатьЗаписи = 0,
        Первый       = 1,
        Последний    = 2;

MACRO Печать_ОтчетСканирования(Вызов,pmptr,Статус,Сообщение, Action)
   
        RECORD pm_paym (pmpaym);
        
        setbuff (pm_paym, pmptr);

        var StrAction = "Акцепт (отказ) ";
        if(Action == VO_ACTION_STEP_REFUSE)
          StrAction = "Отказ ";
        end;

        if (Вызов==Первый)
if(Action == VO_ACTION_STEP_REFUSE)
[                      Отчет о выполнении массового отказа                         ];
elif(Action == VO_ACTION_STEP_ACCEPT_COMMISSION)
[                      Отчет о снятии принадлежности к ВО                          ];
else
[                      Отчет о выполнении массового акцепта(отказа)                ];
end;
[                                                                                  ];
[┌─────────┬─────────────┬──────────┬──────┬──────────────────────────────────────┐];
[│   ID    │    Сумма    │   Дата   │Номер │              Сообщение               │];
[│ платежа │             │          │ошибки│                                      │];
[├─────────┼─────────────┼──────────┼──────┼──────────────────────────────────────┤];
        elif (Вызов == ПечатьЗаписи)

          if (Статус == 0)
            if(Action == VO_ACTION_STEP_ACCEPT_COMMISSION)
              Сообщение = "Операция выполнена успешно.";
            else 
              Сообщение = StrAction + " выполнен успешно.";
            end;
          end;           
[│#########│#############│##########│######│######################################│](pm_paym.PaymentID, pm_paym.Amount, pm_paym.ValueDate,Статус,StrSubst(Сообщение, "|", " " ):w);
                
        elif (Вызов==Последний)
[└─────────┴─────────────┴──────────┴──────┴──────────────────────────────────────┘];
        end;

END;

