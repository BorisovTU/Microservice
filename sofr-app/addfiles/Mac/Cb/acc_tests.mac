/**
 @file 		acc_test.mac
 @brief 	Авто-тесты для проверки счетов
*/

IMPORT RSD;

/** 
  @brief 		Процедура проверки полученного счета с учетом категории и вида (активный/пассивный)
  @return 		0, если есть обще-системный счет в таблице dmcaccdoc_dbt, 1, если нет
*/
PRIVATE MACRO TestMcAccDocKind(p_Cat: STRING, p_Acc: STRING, p_KindAccount: STRING)
  var sql, cmd, x_Res;
  sql =  "DECLARE "
       + "  x_Cnt NUMBER; "
       + "BEGIN "
       + "  SELECT count(*) INTO x_Cnt "
       + "    FROM dmcaccdoc_dbt r, dmccateg_dbt c "
       + "    WHERE c.t_code = :p_Cat and r.t_catid = c.t_id and r.t_account = :p_Acc and r.t_kind_account = :p_Kind ; "
       + "  IF(x_Cnt = 1) THEN "
       + "    :p_res := 0; "
       + "  END IF; "
       + "EXCEPTION WHEN others THEN "
       + "  :p_res := 1; "
       + "END; "
  ;
  cmd = RSDCommand(sql);
  cmd.addParam("p_Cat", RSDBP_IN, p_Cat);
  cmd.addParam("p_Acc", RSDBP_IN, p_Acc);
  cmd.addParam("p_Kind", RSDBP_IN, p_KindAccount);
  cmd.addParam("p_Res", RSDBP_OUT, V_INTEGER);
  cmd.execute();
  x_Res = cmd.value("p_Res");
  return x_Res;
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Процедура проверки полученного счета
  @return 		0, если есть обще-системный счет в таблице dmcaccdoc_dbt, 1, если нет
*/
PRIVATE MACRO TestMcAccDoc(p_Cat: STRING, p_Acc: STRING)
  var sql, cmd, x_Res;
  sql =  "DECLARE "
       + "  x_Cnt NUMBER; "
       + "BEGIN "
       + "  SELECT count(*) INTO x_Cnt "
       + "    FROM dmcaccdoc_dbt r, dmccateg_dbt c "
       + "    WHERE c.t_code = :p_Cat and r.t_catid = c.t_id and r.t_account = :p_Acc; "
       + "  IF(x_Cnt = 1) THEN "
       + "    :p_res := 0; "
       + "  END IF; "
       + "EXCEPTION WHEN others THEN "
       + "  :p_res := 1; "
       + "END; "
  ;
  cmd = RSDCommand(sql);
  cmd.addParam("p_Cat", RSDBP_IN, p_Cat);
  cmd.addParam("p_Acc", RSDBP_IN, p_Acc);
  cmd.addParam("p_Res", RSDBP_OUT, V_INTEGER);
  cmd.execute();
  x_Res = cmd.value("p_Res");
  return x_Res;
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810499003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404810499003202617
  return TestMcAccDoc("+Биржа", "47404810499003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404840799003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404840799003202617
  return TestMcAccDoc("+Биржа", "47404840799003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404978399003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404978399003202617
  return TestMcAccDoc("+Биржа", "47404978399003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404156399003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404156399003202617
  return TestMcAccDoc("+Биржа", "47404156399003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810099003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404810099003202619
  return TestMcAccDoc("+Биржа", "47404810099003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404840399003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404840399003202619
  return TestMcAccDoc("+Биржа", "47404840399003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404978999003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404978999003202619
  return TestMcAccDoc("+Биржа", "47404978999003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404156999003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404156999003202619
  return TestMcAccDoc("+Биржа", "47404156999003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810799003202621
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47404810799003202621
  return TestMcAccDoc("+Биржа", "47404810799003202621");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810199003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403810199003202617
  return TestMcAccDoc("-Биржа", "47403810199003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403840499003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403840499003202617
  return TestMcAccDoc("-Биржа", "47403840499003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403978099003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403978099003202617
  return TestMcAccDoc("-Биржа", "47403978099003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403156099003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403156099003202617
  return TestMcAccDoc("-Биржа", "47403156099003202617");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810799003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403810799003202619
  return TestMcAccDoc("-Биржа", "47403810799003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403840099003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403840099003202619
  return TestMcAccDoc("-Биржа", "47403840099003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403978699003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403978699003202619
  return TestMcAccDoc("-Биржа", "47403978699003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403156699003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403156699003202619
  return TestMcAccDoc("-Биржа", "47403156699003202619");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810499003202621
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO Acc_47403810499003202621
  return TestMcAccDoc("-Биржа", "47403810499003202621");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810499003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404810499003202617
  return TestMcAccDocKind("+Биржа", "47404810499003202617", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404840799003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404840799003202617
  return TestMcAccDocKind("+Биржа", "47404840799003202617", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404978399003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404978399003202617
  return TestMcAccDocKind("+Биржа", "47404978399003202617", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404156399003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404156399003202617
  return TestMcAccDocKind("+Биржа", "47404156399003202617", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810099003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404810099003202619
  return TestMcAccDocKind("+Биржа", "47404810099003202619", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404840399003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404840399003202619
  return TestMcAccDocKind("+Биржа", "47404840399003202619", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404978999003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404978999003202619
  return TestMcAccDocKind("+Биржа", "47404978999003202619", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404156999003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404156999003202619
  return TestMcAccDocKind("+Биржа", "47404156999003202619", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404810799003202621
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404810799003202621
  return TestMcAccDocKind("+Биржа", "47404810799003202621", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810199003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403810199003202617
  return TestMcAccDocKind("-Биржа", "47403810199003202617", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403840499003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403840499003202617
  return TestMcAccDocKind("-Биржа", "47403840499003202617", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403978099003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403978099003202617
  return TestMcAccDocKind("-Биржа", "47403978099003202617", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403156099003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403156099003202617
  return TestMcAccDocKind("-Биржа", "47403156099003202617", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810799003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403810799003202619
  return TestMcAccDocKind("-Биржа", "47403810799003202619", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403840099003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403840099003202619
  return TestMcAccDocKind("-Биржа", "47403840099003202619", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403978699003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403978699003202619
  return TestMcAccDocKind("-Биржа", "47403978699003202619", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403156699003202619
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403156699003202619
  return TestMcAccDocKind("-Биржа", "47403156699003202619", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403810499003202621
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403810499003202621
  return TestMcAccDocKind("-Биржа", "47403810499003202621", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 30424810499003202617
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_30424810499003202617
  return TestMcAccDocKind("Клиринговый счет", "30424810499003202617", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404840299003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404840299003001347
  return TestMcAccDocKind("+Обеспечение", "47404840299003001347", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404978899003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404978899003001347
  return TestMcAccDocKind("+Обеспечение", "47404978899003001347", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47404156899003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47404156899003001347
  return TestMcAccDocKind("+Обеспечение", "47404156899003001347", "А");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403840999003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403840999003001347
  return TestMcAccDocKind("-Обеспечение", "47403840999003001347", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403978599003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403978599003001347
  return TestMcAccDocKind("-Обеспечение", "47403978599003001347", "П");
ONERROR(err)
  return 1;
END;

/** 
  @brief 		Проверка счета 47403156599003001347
  @return 		0, если тест прошел успешно, 1, если не успешно
*/
MACRO AccCat_47403156599003001347
  return TestMcAccDocKind("-Обеспечение", "47403156599003001347", "П");
ONERROR(err)
  return 1;
END;
