IMPORT rslx, dlreptl;

/*Вывести на экран отчет Excel-ем*/
MACRO DLEREPT_PrintReportFromFile (filen, IsTerm)
var
    ExcelApp;

    if (not IsTerm)
        DLREPTL_InitServerWork();
    end;

    filen = PathToAbsolute (filen);
    ExcelApp = ActiveX( "Excel.Application", null, TRUE );

    if (not ExcelApp.Workbooks.OpenText (
        filen,      /*Filename*/
        3,          /*Origin = xlMSDOS*/
        1,          /*StartRow*/
        1,          /*DataType = xlDelimited*/
        1,          /*TextQualifier = xlTextQualifierDoubleQuote*/
        False,      /*ConsecutiveDelimiter*/
        False,      /*Tab*/
        False,      /*Semicolon*/
        False,      /*Comma*/
        False,      /*Space*/
        True,       /*Other*/
        "~"        /*OtherChar*/        )
       ) 
        msgbox ("Ошибка при выгрузке отчета в Excel");
        return false;
    end;

    /*ExcelApp.ActiveSheet.Columns.AutoFit;*/
    ExcelApp.Visible = true;

    return true;
END;
