/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : sfdfdel.mac
  Created     : 14.01.08
  Programmer  : SolAN
  Description : Отчет о массовом удалении удержанных периодических комиссий

└───────────────────────────────────────────────────────────────────────────*/
import SfInter;

const   Ошибка   = 0,
    Первый   = 1,
    Последний= 2;

RECORD defcom (sfdefcom);

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
   array StringArray;
   var i = 1;
   var stat;
   setbuff (defcom, firstdoc);

   record comiss(sfcomiss);      

    if (Вызов==Первый)
[                 Отчет о массовом удалении удержанных периодических комиссий ];
[┌───────────────┬─────────────┬─────────────┬─────────┬─────────────────────────────────────────────────────────┐];
[│    Комиссия   │ Дата начала │ Дата оконч. │    №    │                 Сообщение                               │];
[│               │   периода   │   периода   │  ошибки │                                                         │];
[├───────────────┼─────────────┼─────────────┼─────────┼─────────────────────────────────────────────────────────┤];
    elif (Вызов==Ошибка)
        if (Статус == 0)
            Сообщение = "Операция выполнена успешно"
        end;

        SfGetComiss( defcom.FeeType, defcom.CommNumber, comiss ); 

        StrSplit(StrSubst(Сообщение, "│", " " ), StringArray, 56);
[│###############│#############│#############│#########│#########################################################│]
( comiss.Code, defcom.datePeriodBegin, defcom.DatePeriodEnd, Статус, StringArray(0));

        while ( StrLen(StringArray(i) ) > 0)
[│               │             │             │         │#########################################################│](StringArray(i));
           i = i + 1;
        end;

    elif (Вызов==Последний)         
[└───────────────┴─────────────┴─────────────┴─────────┴─────────────────────────────────────────────────────────┘];
    end;
END;
