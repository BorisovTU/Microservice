/*---- Пример макро-файла пользователя (работающего самостоятельно), ------*/
/*----        вызываемого перед процедурой "Закрытия дня"            ------*/
/*----                (п/с "Системный сервис")                       ------*/

import extpaym;

const ПроверятьНеисполненныеПлатежи = false;

macro USER1FIN ( )
  var StatDischarged = 0, retval;
  /*Сюда можно вставлять свой код, который будет выполняться
    перед процедурой "Закрытия дня" */

  if ( ПроверятьНеисполненныеПлатежи )
     StatDischarged = ExtPaymentsListDate_Panel(); 
/*    ExtPaymentsListDate({curdate}); */
  end;

  if (StatDischarged)
    retval = MsgBoxEx("Найдены выгруженные в МБР, но не отправленные платежи.|Продолжить завершение дня?",
                       MB_YES+MB_NO, IND_NO, "Предупреждение" );
    if (retval == IND_NO)
      retval = 1;
    else
      retval = 0;
    end;
  end;

  return retval;
end;
