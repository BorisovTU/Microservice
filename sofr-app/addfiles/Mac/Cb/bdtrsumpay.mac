/*
  $Name:        bdtrsumpay.mac
  $Module:      Бухгалтерия банка
  $Description: Печать отчета массового формирования расчетных документов для перечисления общей суммы
*/

/********************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 6.0                          */
/********************************************************************************/
/*                  Подсистема "ББ"                                             */
/* Печать отчета массового формирования расчетных документов                    */
/* для перечисления общей суммы                                                 */
/*  Имя файла: bdtrsumpay.mac                                                   */
/*  Создан:    14.04.13                                  Lazarenko M.           */
/********************************************************************************/
IMPORT PaymInter, BankInter, OprInter, globals, PSInter;

macro PrintHeader
[           
        Отчет о групповом формировании расчетных документов для перечисления общей суммы

  Дата обработки:  ##########  ########
  Операционист:  #
 ┌───────────────┬─────────────┬────────────────────────────────────────────────────────────┐  
 │ Номер перевода│Номер ошибки │                      Сообщение                             │  
 │               │             │                                                            │
 ├───────────────┼─────────────┼────────────────────────────────────────────────────────────┤]
  ( date(), time(), {oper}:l );

end;

macro PrintLine(НомерПеревода : string, Статус : integer, Сообщение : string)
  if( Статус == 0 )
    Сообщение = "Перевод включен в платёж на общую сумму";
  end;

  var WarnList : TArray = GetWarnings();
  for(var Warning, WarnList)
    Сообщение = Сообщение + "\n" + Warning.stat + " " + Warning.message;
  end;

[│###############│#############│############################################################│]
  (НомерПеревода, Статус, StrSubst( Сообщение, "|", " " ):w );

end;

macro PrintFooter
[└───────────────┴─────────────┴────────────────────────────────────────────────────────────┘];

  println( "Сформирован(о) " + GetSumPayCount() + " платеж(ей)" );
end;
