/* Печать протокола сканирования */
Import "globals.mac";


macro PrintProtocol_Scan( DateStart, DateFinish, AllDoc, Error, SimpleScanDoc, SimpleScanOperOC, SimpleScanOperUO, scanSplitSum, SplitSumDoc, SplitSumOperOC, SplitSumOperUO, LogErrFileName )

  var allOC : integer, allUO : integer;
  File LogFile() txt;


  allOC = SimpleScanOperOC;
  allUO = SimpleScanOperUO + SplitSumOperUO; 

[##########г. ##########
 Исполнитель ##### #

 Отобрано операций с ########## по ##########

 Операции, подлежащие контролю:
 Всего создано операций для контроля        = ##### шт.
                        из них OK           = ##### шт.
                        из них НО           = ##### шт.
]
(
  date:f
 ,time:f
 ,{Oper}
 ,{Name_Oper}
 ,DateStart:f
 ,DateFinish:f
 ,SimpleScanDoc
 ,SimpleScanOperOC
 ,SimpleScanOperUO
);

if( scanSplitSum )

[
 Операции дробления сумм:
 Всего операций дробления                   = ##### шт.
 Всего создано операций для контроля (НО)   = ##### шт.
]
(
  SplitSumDoc
 ,SplitSumOperUO
);

end;

[
 Итого обработано документов                = ##### шт.
 Итого создано операций для контроля        = ##### шт.
                        из них OK           = ##### шт.
                        из них НО           = ##### шт.
]
(
  AllDoc
 ,SimpleScanDoc + SplitSumOperUO
 ,allOC
 ,allUO
);


/* Если были ошибки, напечатаем о них */
  if( ERROR != 0 )
[
Количество ошибок                           = ##### шт.
]
(
  ERROR
);
    if(LogErrFileName != "")
      if(Open( LogFile, LogErrFileName ) )
        println();
        while ( Next(LogFile) )
          println(LogFile.Str);
        end;
      end;
    end;
  end;

end;


/* Печать протокола проверки на терроризм */
macro PrintProtocol_CheckTerror( DateStart, DateFinish, ALL_OPR, NEW_OPR, OLD_OPR, ERROR, LogErrFileName, AddLogFileName )

  File LogFile() txt;
  File AddLogFile() txt;
 

[##########г. ##########
Отобрано операций, участники которых возможно причастны к террористической
деятельности за период с ########## по ##########

Обработано документов = ##### шт.

Сформировано записей  = ##### шт.

Дополнено записей     = ##### шт.
]
(
  date:f
 ,time:f
 ,DateStart:f
 ,DateFinish:f
 ,ALL_OPR
 ,NEW_OPR
 ,OLD_OPR
);

/* Если были ошибки, напечатаем о них */
  if( ERROR != 0 )
[
Количество ошибок     = ##### шт.
]
(
  ERROR
);
    if(LogErrFileName != "")
      if(Open( LogFile, LogErrFileName ) )
        println();
        while ( Next(LogFile) )
          println(LogFile.Str);
        end;
      end;
    end;
  end;

  if((AddLogFileName != NULL) AND (AddLogFileName != ""))
      if(Open( AddLogFile, AddLogFileName ) )
        println();
        while ( Next(AddLogFile) )
          println(AddLogFile.Str);
        end;
      end;
  end;
end;

/* Печать протокола о предварительной проверки предварительной на терроризм */
macro PrintProtocol_PreCheckPaymTer( DateStart, DateFinish, PayAcc, RecAcc, ALL_OPR, ERROR )

[##########г. ##########
Начало периода: ########## 

Конец периода:  ##########

Счета по Дебету:  #########################

Счета по Кредиту: #########################

Обработано документов = ##### шт.
]
(
  date:f
 ,time:f
 ,DateStart:f
 ,DateFinish:f
 ,PayAcc
 ,RecAcc
 ,ALL_OPR
);

/* Если были ошибки, напечатаем о них */
  if( ERROR != 0 )
[
Количество ошибок     = ##### шт.
]
(
  ERROR
);
  end;

end;
