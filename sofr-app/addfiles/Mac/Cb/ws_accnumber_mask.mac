/*
$Name:        ws_accnumber_mask.mac
$Module:      Web-обшее
$Description: Макрос по работе с масками номеров лицевых счетов Web-интерфейсов
*/
Import rsd;
Import BankInter;
Import "globals.mac";

class AccNumberMask

  var Chapter : integer;
  var Template : string;

end;

macro GetAccountNumberMaskTemplate( DefaultMask : @string, TemplateList : TArray )

  var accountMask : AccNumberMask;

  var AccountNumberMaskTemplate : string;

  var error : integer;

  var rs : RsdRecordset;
  var cmd : RsdCommand;

  cmd = RsdCommand( "SELECT t_Chapter, t_Template FROM dobchaptr_dbt" );

  cmd.nullConversion = true;

  rs = RsdRecordset( cmd );

  AccountNumberMaskTemplate = "";

  while( rs.moveNext() )

    accountMask = AccNumberMask();

    accountMask.Chapter  = rs.value("t_Chapter");
    accountMask.Template = rs.value("t_Template");

    if( accountMask.Template != "" )

      TemplateList[TemplateList.size] = accountMask;

    end;

    accountMask = null;

  end;

  GetRegistryValue( "BANK_INI\\ОБЩИЕ ПАРАМЕТРЫ\\ОТОБРАЖЕНИЕ ПОЛЕЙ\\ACCOUNTFORMATTEMPL", V_STRING, DefaultMask, error, false, {oper} );

end;