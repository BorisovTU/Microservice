/*-------------------------------------------------------------------------
          Автоматизированная банковская система RS-Bank v6.00.020
                 Copyright (c) R-Style Software Lab

  Имя файла        : mpcach30.mac

  Библиотека       : RSACCOUNT

  Описание         : 

  Программист      : Kirakozov Michael (KMV)

  Создан           : 26.02.2009
-------------------------------------------------------------------------*/
IMPORT RsbDataSet,  CTInter,  globals;

record contract_buf (prccontract);
record cntopr_buf (prccntopr);
var prccontract = TBfile("prccontract.dbt"),
    prccntopr = TBfile("prccntopr.dbt"),
    ContractID = 0,
    DocID = 0;


MACRO ExecuteCaseStep(OperationKind, StepNumber, Document, DocKind)

   SetBuff( cntopr_buf, Document );

   ContractID = cntopr_buf.contractid;
   DocID      = cntopr_buf.DocID;

   prccntopr.KeyNum = 0;	
   prccntopr.rec.DocID = DocID;
   if (not prccntopr.GetEQ)
      msgbox ("Не найдена операция доначисления");
      return 1;
   end; 
   
   if (prccntopr.rec.Sum == 0) 
      return "50";
   else
      return "40";
   end;

END;


MACRO PrintStepDocs (
                ID_Operation,  /* Номер экземпляра операции */
                ID_Step,       /* Номер шага операции */
                Kind_Operation,/* Вид операции */
                KindStep)      /* Вид шага операции */
  exit(1); 

END;

