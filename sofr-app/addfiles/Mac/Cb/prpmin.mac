/************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prpmin.mac                                         */
/*                                                                      */
/*  Описание       : Печать инкассового поручения                       */
/*                   (требование-поручение). Вызов из си.               */
/*                                                                      */
/*  Программист    : Смирнов С.В. SMR PRN                               */
/*                                                                      */
/*  Создан         : 16.10.02                                           */
/*                                                                      */
/************************************************************************/

import prpmini;

/* Печать инкассового поручения */
MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind,
      stat:bool;
  
  if( ( (DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_ORDER) and (pr_pmrmprop.rec.ShifrOper == "06" ) ) or
      ( (DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_REQUEST) ) or
      ( DocKind == WL_INDOC )
    )
    return PrintIncashRequest(ncopy);
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    stat = FALSE;
  end;

  return stat;

END;
