import SfInter, BankInter, PTInter, CTInter, FIInter, globals, RSD;

var sfcontr_rec:TRecHandler  = TRecHandler("sfcontr.dbt", "bank.def");

macro FinInName(FIID)
   file fininstr(fininstr);
   fininstr.FIID = FIID;
   if(not GetEQ(fininstr))
     runerror("Не найден финансовый инструмент");
   end;
   return fininstr.Name;
end;

macro ServKindInName(ServKind)
    file servkind1("servkind.dbt") key 0;
   servkind1.ServiseKind = ServKind;
   if(not GetEQ(servkind1))
     runerror("Не найден вид обслуживания");
   end;
   return servkind1.Name;
end;


MACRO PrintDocument( ncopy:integer):bool
  var i : integer = 0;
  for (i, 1, ncopy, 1)
    println("Номер договора: ", sfcontr_rec.rec.ID);
    println("Название: ", sfcontr_rec.rec.Name);
    println("Дата заключения: ", sfcontr_rec.rec.DateConc);
    println("Даты начала и окончания периода действия: ", sfcontr_rec.rec.dateBegin, sfcontr_rec.rec.dateClose);
    println("Вид обслуживания: ", sfcontr_rec.rec.ServKind, " ", ServKindInName(sfcontr_rec.rec.ServKind)  );
    println("Тип и идентификатор объекта договора: ", sfcontr_rec.rec.objectType," ", sfcontr_rec.rec.object);
    println("Валюта договора: ", ПолучитьКодФинИн(sfcontr_rec.rec.FIID) ," ", FinInName(sfcontr_rec.rec.FIID));
    println("\n");
  end;
  return TRUE;

END;
