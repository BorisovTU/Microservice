/*
$Name:             ver_rep.mac
$Module:           Ядро Banking
$Description:      Функции для печати ведомости расхождения
*/

/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.10                                         R-Style Software Lab

  File Name   : ver_rep.mac
  Created     : 23.02.2003
  Programmer  : Андреева Е.П.
  Description : Функции для печати ведомости расхождения

└───────────────────────────────────────────────────────────────────────────*/

const  tax_fld_AuthorStatusCode = 1, /* Для налоговых реквизитов */
       tax_fld_AuthorStatusName = 2,
       tax_fld_PayerINN         = 3,
       tax_fld_PayerKPP         = 4,
       tax_fld_ReceiverINN      = 5,
       tax_fld_ReceiverKPP      = 6,
       tax_fld_TaxCode          = 7,
       tax_fld_TaxName          = 8,
       tax_fld_OKATOCode        = 9,
       tax_fld_OKATOName        = 10,
       tax_fld_GroundCode       = 11,
       tax_fld_GroundName       = 12,
       tax_fld_Period           = 13,
       tax_fld_Number           = 14,
       tax_fld_Date             = 15,
       tax_fld_TypeCode         = 16,
       tax_fld_TypeName         = 17;

const  co_fld_VOName          = 1,    /* для реквезитов валютной операции */
       co_fld_VONote          = 2,
       co_fld_ContractUIN     = 3,
       co_fld_ContractRegDate = 4,
       co_fld_ContractNumber  = 5,
       co_fld_ContractDate    = 6,
       co_fld_FI_Code         = 7,
       co_fld_FI_Name         = 8;
       
macro Print_LargeStr(pn1,pn2,name_str)

array StringArray1, StringArray2;
var i = 1;
[│   #######################################################################   │]
(name_str:c);
[├──────────────────────────────────────┬──────────────────────────────────────┤];
StrSplit(pn1, StringArray1, 36);
StrSplit(pn2, StringArray2, 36);
[│####################################  │  ####################################│]
(StringArray1(0):r,(StringArray2(0)):l);
while((StrLen(StringArray1(i) ) > 0) OR (StrLen(StringArray2(i) ) > 0))
if((StrLen(StringArray1(i) ) > 0) AND (StrLen(StringArray2(i) ) > 0))
[│####################################  │  ####################################│]
(StringArray1(i):r,StringArray2(i):l);
elif(StrLen(StringArray1(i) ) > 0)
[│####################################  │                                      │]
(StringArray1(i):r);
elif(StrLen(StringArray2(i) ) > 0)
[│                                      │  ####################################│]
(StringArray2(i):l);
end;
i = i + 1;
end;
[├──────────────────────────────────────┴──────────────────────────────────────┤];

end;

macro Print_SmallStr(str1, str2, name_str)

[│   #######################################################################   │]
(name_str:c);
[├──────────────────────────────────────┬──────────────────────────────────────┤];
[│####################################  │  ####################################│]
(str1:r, str2:l);
[├──────────────────────────────────────┴──────────────────────────────────────┤];

end;

MACRO Print_Head()
[
                   Ведомость расхождения документа и дубликата                  ];
[┌──────────────────────────────────────┬──────────────────────────────────────┐];
[│     Значение реквизита в документе   │   Значение реквизита в дубликате     │];
[├──────────────────────────────────────┴──────────────────────────────────────┤];
END;

MACRO Print_Kolvo(i)
[│Количество несовпадающих реквизитов: ####                                    │](i:l);
[└─────────────────────────────────────────────────────────────────────────────┘];
END;

macro Print_Amount(a1,a2, name_str)
[│   #######################################################################   │]
(name_str:c);
[├──────────────────────────────────────┬──────────────────────────────────────┤];
[│          ##########################  │  ##########################          │]
(a1:r:f, a2:l:f);
[├──────────────────────────────────────┴──────────────────────────────────────┤];
end;

macro Print_PayerINN(pinn1,pinn2)
   Print_LargeStr("'"+pinn1+"'","'"+pinn2+"'", "ИНН плательщика");
end;

macro Print_ReceiverINN(rinn1,rinn2)
   Print_SmallStr("'"+rinn1+"'","'"+rinn2+"'", "ИНН получателя");
end;

macro Print_PaymentKind(pk1,pk2)
   Print_SmallStr(pk1, pk2, "Вид платежа");
end;

macro Print_PayerName(pn1,pn2)
   Print_LargeStr("'"+pn1+"'","'"+pn2+"'", "Плательщик");
end;

macro Print_ReceiverName(pn1,pn2)
   Print_LargeStr("'"+pn1+"'","'"+pn2+"'", "Получатель");
end;

macro Print_ReceiverBankName(pn1,pn2)
   Print_LargeStr("'"+pn1+"'","'"+pn2+"'", "Название банка получателя");
end;

macro Print_PayerBankName(pn1,pn2)
   Print_LargeStr("'"+pn1+"'","'"+pn2+"'", "Название банка плательщика");
end;

macro Print_CodeKindP(kk1,kk2)
   Print_SmallStr(kk1, kk2, "Вид кода банка плательщика");
end;

macro Print_CodeKind(kk1,kk2)
   Print_SmallStr(kk1, kk2, "Вид кода банка получателя");
end;

MACRO Print_Itog()
[                                                                               ];
[───────────────────────────────────────────────────────────────────────────────];
[                                Конец отчета                                   ];
[                                                                               ];
END;
