/*───────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.0                                            R-Style Software Lab

  Библиотека для работы с именами файлов и каталогов на RSL

FILENAME: PATH_LBR.MAC
CREATED: 28.01.99 Мол.
EXPORTS:

  FileFromPath( s)
    Извлекает "имя файла + расширение" из полного пути

  DirFromPath( s)
    Извлекает путь без имени файла из полного пути

  Dir_Chomp( s)
    Отрезает концевой символ '\' из пути

MODIFICATIONS:
NOTES:

└───────────────────────────────────────────────────────────────────────────*/

/* Извлекает "имя файла + расширение" из полного пути */
MACRO FileFromPath( s)
var
   c, f = "", i = strlen( s);

  while ( i > 0 )
    c = SubStr( s, i, 1);

    if ( (c == ":") or (c == "\\") or (c == "/") )
      return f;
    end;

    f = c + f;
    i = i - 1;
  end;

  return f;
END;

/* Извлекает путь без имени файла из полного пути */
MACRO DirFromPath( s)
var
   lf = strlen( FileFromPath( s)),
   ls = strlen( s);

  return SubStr( s, 1, ls-lf);
END;

/* Отрезает концевой символ '\' из пути */
MACRO Dir_Chomp( s)
var
   l = strlen( s), c = SubStr( s, l, 1);

  if ( c == "\\" )
    s = SubStr( s, 1, l-1);
  end;

  return s;
END;

/* eof */