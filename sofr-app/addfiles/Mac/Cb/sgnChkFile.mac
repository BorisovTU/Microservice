import BankInter;
        
macro CheckSignatureFile(CryptoID, FileName, GenResult : @integer, ResultArr : @TArray, SignIDArr : @TArray, MesArr : @TArray)
	var Result : string;
	//var MesArray = TArray;
	var iBegin, iEnd;
	var i : integer = 0;
	var tmp;
	var RetValue;

        ResultArr = TArray;
        SignIDArr = TArray;
        MesArr = TArray;

	RetValue = CPCheckSignatureFile(4, FileName, @GenResult, @Result);
	
	if ((GenResult == 0) or (GenResult == 1))

        iBegin = 1;
        iEnd = Index(Result, "\n");                                                                                            

        while (iEnd != 0)

            tmp = SubStr(Result, 1, iEnd - 1);

            ResultArr(i) = Int(SubStr(tmp, 1, Index(tmp, "|") - 1));
            tmp = SubStr(tmp, Index(tmp, "|") + 1);
                	
            SignIDArr(i) = SubStr(tmp, 1, Index(tmp, "|") - 1);
            tmp = SubStr(tmp, Index(tmp, "|") + 1);        	

            MesArr(i) = tmp;            

            Result = SubStr(Result, iEnd + 1);
            iEnd = Index(Result, "\n");
            i = i + 1;
        end;
    end;
    
    InitError();

    return RetValue;
end;
