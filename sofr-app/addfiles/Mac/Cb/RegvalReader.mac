//RegvalReader.mac
import BankInter;

class RegValReader()

  macro GetBool(path:string, defaultValue:bool):bool
    var val, ErrCode;
    GetRegistryValue(path, V_BOOL, val, ErrCode);
    if (ErrCode != 0)
      return defaultValue;
    end;

    return val;
  end;

  macro GetString(path:string, defaultValue):string
    var val, ErrCode;
    GetRegistryValue(path, V_STRING, val, ErrCode);
    if (ErrCode != 0)
      return defaultValue;
    end;

    return val;
  end;
end;