/*
$Name:        sfucontrref.mac
$Module:      РКО (ПЗО)  
$Description: Макрос генерации номера СДО
*/


import "globals.mac";

record SfUnionContr ("SfUnionContr.dbt");
record SfContrRefParm ("SfContrRefParm.rec");


macro SfUContrGetRef( SeqValue, ObjKind, ObjAddr )
  var refer;

  SetBuff( SfUnionContr,  ObjAddr );
  var sizer = GetRecordSize (SfUnionContr);

  var BlobObjAddr = 0;
  if(ObjAddr != null)
    BlobObjAddr = OffsetMemAddr(ObjAddr, sizer);
    SetBuff( SfContrRefParm,  BlobObjAddr );
  end;

  refer = String( SfUnionContr.PartyID:5, SfContrRefParm.ProductID:5, SeqValue:5 );
  refer = StrSubst( refer, " ", "0" );

  return refer;
end;