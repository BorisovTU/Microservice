/*************************************************************************/
/*         Автоматизированная банковская система RS-Bank                */
/*                 Copyright (c) R-Style Software Lab 2002              */
/*                                                                      */
/*  Имя файла      : prpmdmv.mac                                        */
/*                                                                      */
/*  Описание       : Печать платежного требования (RS-Forms) Вызов из си.*/
/*                                                                      */
/*  Программист    : Дроздов И.Е.                                        */
/*                                                                      */
/*  Создан         : 22.09.04                                            */
/*                                                                      */
/*************************************************************************/

import prpmdmvi;

MACRO PrintHeader()

END;

MACRO PrintFooter()

END;

/* Печать платежного требования  (RS-Forms) */
MACRO PrintDocument(ncopy:integer):bool
  var DocKind:integer = pr_pmpaym.rec.DocKind,
      stat:bool;
  
  if( (DocKind == DLDOC_BANKCLAIM) or  ((DocKind == PS_PAYORDER) and (pr_pspayord.rec.DocKind == PSPOKIND_DEMAND)) or
       paymentIsDemand(pr_pmpaym, pr_debet, pr_credit) 
    )
    return PrintPayDemRSF( ncopy );
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    stat = FALSE;
  end;

  return stat;

END;
