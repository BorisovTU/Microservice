/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : scndldef.mac
  Created     : 27.04.00
  Programmer  : Бурак В.Ю.
  Description : Печать отчета об удалении отложенных документов 

└───────────────────────────────────────────────────────────────────────────*/
import "pralcash.mac";

record pscshdoc (pscshdoc);

const Ошибка   = 0,
      Первый   = 1,
      Последний = 2,
      ReportLineWidth = 78;

macro Печать_ОтчетСканирования ( Вызов, firstdoc, Статус, Сообщение )
  
  var stat, i = 1;
  array StringArray;

  setbuff (pscshdoc, firstdoc);
  record pm_rmprop (pmrmprop);
  record pm_paym   (pmpaym);

  if( Вызов == Первый )
[                  Отчет о групповом удалении документов.
+---------+------+-----------------------------------------------------------+
|  Номер  |Номер |                Сообщение                                  |
|документа|ошибки|                                                           |
+---------+------+-----------------------------------------------------------+];
  elif( Вызов==Ошибка )
    if( Статус == 0 )
      Сообщение = "Документ удален успешно"
    end;

         StrSplit(StrSubst(Сообщение, "|", " " ), StringArray, 56);
[|#########|######|###########################################################|](GetLastPaymentsNumber(),Статус,StringArray(0));
         while ( StrLen(StringArray(i) ) > 0)
[|         |      |###########################################################|](StringArray(i));
           i = i + 1;
         end;

  elif( Вызов == Последний )
[+---------+------+-----------------------------------------------------------+];
  end;
end;
