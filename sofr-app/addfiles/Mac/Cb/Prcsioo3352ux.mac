/*
 $Name:        Prcsioo3352ux.mac
 $Module:      ББ
 $Description: Печать приходно-расходного кассового ордера по 3352-У в XML
*/

// Программист: TDV 2014
IMPORT BnkTemplReport;
IMPORT globals, FIInter, PTInter, PaymInter, oprinter;
IMPORT prcs_common;

private class (BnkTemplReport)PrintOrderReport(PrintOrderData)

  var data   = PrintOrderData;

  MACRO Create()
      
    array ArrayGround, ArraySum,ArrayPaperName,ArrayPayerBankName,ArrayReceiverBankName;
    StrSplit(data.PayerBankName, ArrayPayerBankName, 75, 44, 2);
    StrSplit(data.ReceiverBankName, ArrayReceiverBankName, 75, 45, 2);
    StrSplit(data.SumString, ArraySum, 50, 33, 3);      
    StrSplit(data.Ground, ArrayGround, 70, 62, 3);
    StrSplit(data.Document, ArrayPaperName, 70, 28, 3);
    
    SetSheetName( data.Number );

    SetValues( "Number_1"            ,  data.Number              , "Number_2"             , data.Number              ,
               "DateStr_1"           ,  data.DateStr             , "DateStr_2"            , data.DateStr             ,
               "Client_1"            ,  data.Client              , "Client_2"             , data.Client              ,
               "PayerBankName_1_1"   ,  ArrayPayerBankName(0)    , "ReceiverBankName_1_1" , ArrayReceiverBankName(0) ,
               "PayerBankName_1_2"   ,  ArrayPayerBankName(1)    , "ReceiverBankName_1_2" , ArrayReceiverBankName(1) ,
               "ReceiverBankName_2_1",  ArrayReceiverBankName(0) , "PayerBankName_2_1"    , ArrayPayerBankName(0)    ,
               "ReceiverBankName_2_2",  ArrayReceiverBankName(1) , "PayerBankName_2_2"    , ArrayPayerBankName(1)    ,
               "PayerAccount_1"      ,  data.PayerAccount        , "PayerAccount_2"       , data.PayerAccount        ,
               "ReceiverAccount_1"   ,  data.ReceiverAccount     , "ReceiverAccount_2"    , data.ReceiverAccount     ,
               "CCY_Code_1"          ,  data.CCY_Code            , "CCY_Code_2"           , data.CCY_Code            ,
               "Amount_1"            ,  data.Amount              , "Amount_2"             , data.Amount              ,
               "ArraySum_1_1"        ,  ArraySum(0)              , "ArraySum_2_1"         , ArraySum(0)              ,            
               "ArraySum_1_2"        ,  ArraySum(1)              , "ArraySum_2_2"         , ArraySum(1)              ,            
               "ArraySum_1_3"        ,  ArraySum(2)              , "ArraySum_2_3"         , ArraySum(2)              ,            
               "ArraySym_1"          ,  data.ArraySym.value(0)   , "ArraySym_2"           , data.ArraySym2.value(0)  ,            
               "ArrayGround_1_1"     ,  ArrayGround(0)           , "ArrayGround_2_1"      , ArrayGround(0)           ,
               "ArrayGround_1_2"     ,  ArrayGround(1)           , "ArrayGround_2_2"      , ArrayGround(1)           ,
               "BworkName_1"         ,  data.BworkName           , "BworkName_2"          , data.BworkName           ,
               "CworkName_1"         ,  data.CworkName           , "CworkName_2"          , data.CCworkName          ,
               "doc_1"               ,  ArrayPaperName(0)        , "doc_2"                , ArrayPaperName(1)        ,
               "doc_3"               ,  ArrayPaperName(2)        
             );
  END;

  initBnkTemplReport("Приходно-расходный ордер.xls");
end; 

/*  Печать приходно-расходного кассового ордера*/
MACRO PrintDocument(ncopy:integer):bool

  var DocKind:integer = pr_pmpaym.rec.DocKind;
  var data : TInOutOrderPrintData = TInOutOrderPrintData();

  if( DocKind == 445 )   /*Приходно-расходный кассовый ордер*/
    data.InitByCashOrder( pr_pmpaym, pr_pmrmprop, pr_pscshdoc );  
    if( data.format == 0 )
      data.DateStr = DDpMMpYYYY( pr_pmpaym.rec.valuedate );
    end;
  else
    MsgBox("Данный вид документа не поддерживается макросом");
    return FALSE;
  end;

  return PrintOrderReport(data).print();

END;
