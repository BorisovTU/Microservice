
/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 6.0                                          R-Style Software Lab

  File Name   : rbsmsc_del.mac
  Created     : 16.04.2008
  Programmer  : Egorov P.
  Description : Печать отчета для массового удаления сводных мем. ордеров 

└───────────────────────────────────────────────────────────────────────────*/

IMPORT PaymInter, "gstname.mac";
RECORD paym(pmpaym);

CONST   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;


MACRO Печать_ОтчетСканирования(Вызов,firstdoc,Статус,Сообщение)
  record rmprop  (pmrmprop);

  setbuff(paym,firstdoc);

  if(Вызов==Ошибка)
    if(Статус == 0)
      Сообщение = "Документ удален успешно. ";
    end;
  end;
  
  
  if( Вызов == Первый )
[         Отчет о групповом удалении мемориальных ордеров.                     ];
[┌─────────┬──────┬───────────────────────────────────────────────────────────┐];
[│  Номер  │Номер │                Сообщение                                  │];
[│документа│ошибки│                                                           │];
[├─────────┼──────┼───────────────────────────────────────────────────────────┤];

  elif( Вызов == Ошибка )
      println("│", GetLastPaymentsNumber():9, "│", Статус:6, "│", Сообщение:59,  "│");

  elif (Вызов==Последний)
[└─────────┴──────┴───────────────────────────────────────────────────────────┘];
  end;
END;
