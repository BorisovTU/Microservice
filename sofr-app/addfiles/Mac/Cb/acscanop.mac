/*──────────────────────────────────────────────────────────────────────────┐
  RS-Bank 5.1                                          R-Style Software Lab

  File Name   : 
  Created     : 
  Programmer  : 
  Description : 

└───────────────────────────────────────────────────────────────────────────*/
IMPORT  CTInter, FIInter;

RECORD ocor(objatcor);
RECORD acc(account);

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования (Вызов,firstdoc,Статус,Сообщение)
   var stat, i = 1;
   array StringArray;
   var  FI_Code;

        setbuff(ocor,firstdoc);

        if( Вызов == Первый )
[           Отчет о формировании резерва по 137-П         ];
[+-----+----------+-------------------------+-------+-----------------------------------------------------------+];
[|Глава| Валюта   | Лицевой счет            | Номер |                 Сообщение                                 |];
[|     |          |                         | ошибки|                                                           |];
[+-----+----------+-------------------------+-------+-----------------------------------------------------------+];
        elif( Вызов==Ошибка )

          RestoreFromUniID(ocor.Object, acc, OBJTYPE_ACCOUNT);
          FI_Code = ПолучитьКодФинИн(acc.Code_Currency);
              
          if( Статус == 0 )
            Сообщение = "Выполнено успешно";
          end;

          StrSplit(StrSubst(Сообщение, "|", " " ), StringArray, 56);
[|#####|##########|#########################|#######|###########################################################|](acc.Chapter,FI_Code,acc.Account,Статус,StringArray(0));
          while ( StrLen(StringArray(i) ) > 0)
[|     |          |                         |       |############################################################|](StringArray(i));
            i = i + 1;
          end;

        elif( Вызов==Последний )
[+-----+----------+-------------------------+-------+-----------------------------------------------------------+];
        end;
END;