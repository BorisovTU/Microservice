import rsd, ptinter;

var query = "SELECT COUNT(*) FROM dparty_dbt";
var rs = RsdRecordset(query);
var count = 0;

rs.MoveNext;
InitProgress(int(rs.value(0)), "Пожалуйста подождите...", "Выполняется пересчет HASHVALUE");

query = "SELECT t_PartyID FROM dparty_dbt";
rs = RsdRecordset(query);

while(rs.MoveNext)
  PT_RecalcHashValue(rs.value(0));
  count = count + 1;
  UseProgress(count);
end;
RemProgress();

