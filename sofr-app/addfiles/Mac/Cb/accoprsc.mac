/*
$Name:        accoprsc.mac
$Module:      Макрос скроллинга "Сроки совершения операций по лицевому счету"
$Description: Макрос скроллинга
*/

import BankInter;


/*
ACCOPER_CHECK_DATE           // значение поля "Начало операции" меньше даты открытия счета
ACCOPER_CHECK_BEGIN_DATE     // значение поля "Начало операции" равно дате начала операции другой записи
ACCOPER_CHECK_INCLUDEBWP_BD  // cоответствие даты начала операции периоду включения исключения счета в РПС.
ACCOPER_CHECK_BEGIN_END_DATE // значение поля "Начало операции" больше значения поля "Окончание операции"
ACCOPER_CHECK_ACC_CLOSE_DATE // лицевой счет закрыт, и значение поля "Окончание операции" больше даты закрытия счета
ACCOPER_CHECK_INCLUDEBWP_ED  // cоответствие даты окончания операции периоду включения исключения счета в РПС
ACCOPER_CHECK_NUMDAY         // значение поля "Срок в днях" должно содержать только цифры, представляющие число, большее 0, или содержать единственный символ "D"  
ACCOPER_CHECK_NUMDAY_DATE    // значение поля "Срок в днях" не соответствует рассчитанному
ACCOPER_CHECK_MINMAX_BALDAY  // значениt поля "Срок совершения операции (в днях)" - "нижняя граница" и "верхняя граница" - балансового счёта
ACCOPER_CHECK_SUM_ZERO       // значение поля "Сумма" меньше или равно 0
ACCOPER_CHECK_SUM_DATE       // значение поля "Сумма" больше 0, и значения полей "Начало операции" и "Окончание операции" не заданы
ACCOPER_CHECK_STATUS_CLOSE   // лицевой счёт закрыт и значение поля "Состояние операции" равно 1 "открыта"

*/


private macro InitAO(AccOper:TRecHandler) 

  //msgbox("InitAO");
  //AccOper.rec.EndDate = date(10,10,2020);

  return 0;
end;

// Mode:
//  OBJ_DELETE (1) - удаление объекта;
//  OBJ_INSERT (2) - ввод объекта в систему;
//  OBJ_UPDATE (3) - корректировка объекта;
private macro CheckAO(Mode:integer, AccOper:TRecHandler, AccOperOld:TRecHandler, CheckMode:@integer)
  
  CheckMode = bOR( ACCOPER_CHECK_DATE, ACCOPER_CHECK_BEGIN_DATE, ACCOPER_CHECK_INCLUDEBWP_BD, ACCOPER_CHECK_BEGIN_END_DATE, ACCOPER_CHECK_ACC_CLOSE_DATE,ACCOPER_CHECK_INCLUDEBWP_ED,
                   ACCOPER_CHECK_NUMDAY, ACCOPER_CHECK_NUMDAY_DATE, ACCOPER_CHECK_MINMAX_BALDAY, ACCOPER_CHECK_SUM_ZERO, ACCOPER_CHECK_SUM_DATE, ACCOPER_CHECK_STATUS_CLOSE  );

  return 0;
end;

// Функция возвращает сумму констант для задания режима работы подсветки.
/*
ACCOPER_CHECK_DATE
ACCOPER_CHECK_ACC_CLOSE_DATE
ACCOPER_CHECK_NUMDAY_DATE
ACCOPER_CHECK_MINMAX_BALDAY
*/

private macro GetHighlightMode(AccOper:TRecHandler, CheckMode:@integer)

  CheckMode = bOR(ACCOPER_CHECK_DATE, ACCOPER_CHECK_ACC_CLOSE_DATE, ACCOPER_CHECK_NUMDAY_DATE, ACCOPER_CHECK_MINMAX_BALDAY);

  return 0;
end;



