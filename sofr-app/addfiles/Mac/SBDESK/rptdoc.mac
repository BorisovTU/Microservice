/****************************************************************************/
/*                   R-Style SoftWare Lab, RS-Bank 5.1                      */
/****************************************************************************/
/*                                                                          */
/*  Имя файла: rptback.mac                                                 */
/*  Создан:    17.12.06                                     Бабин А.П.      */
/****************************************************************************/

import commonInter,"globals.mac";

RECORD cashDocs( sb_casdc );   
file   cashVal( sb_casvl ) key 0;

const   Ошибка   = 0,
        Первый   = 1,
        Последний= 2;

MACRO Печать_ОтчетСканирования( Вызов,firstdoc,Статус,Сообщение )
  var stat;
  var ALG_CASHNUMOPER=803;

  setbuff( cashDocs, firstdoc );
  ClearRecord(cashVal);
  cashVal.RefValue=cashDocs.RefValue;
  getEQ(cashVal);

  if( Вызов == Первый )
    [                                                                               ];
    [   Отчет о групповом подтверждении документов кассы                            ];
    [   Дата обработки: ##########  ########                                        ](date:f, time);
    [   Операционист:   ####                                                        ]({oper});
    [                                                                               ];
    [+-------+---------+--------------------------+------------+------------+----------------------------------------------+];
    [| N_Doc | Вид     | Операция                 | Сумма      | Сумма      |                Сообщение                     |];
    [|       | ресурса |                          | (валюта)   | (штуки)    |                                              |];
    [+-------+---------+--------------------------+------------+------------+----------------------------------------------+];
  elif( Вызов == Ошибка )
    if( Статус == 0 )
      Сообщение = "Документ подтвержден";
    end;
    [|#######|#########|##########################|############|############|##############################################|]
(cashDocs.ORDNumber,string(cashVal.IDENTVALUE),GetNameAlg(ALG_CASHNUMOPER,cashDocs.NumOper):w,cashDocs.ValueMoney,cashDocs.ValueCol,StrSubst(Сообщение, "|", " "):w );
         elif (Вызов==Последний)
    [+-------+---------+--------------------------+------------+------------+----------------------------------------------+];
  end;
end;