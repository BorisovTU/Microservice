
/* ”®à¬  227 ( èâãª¨ ) */

import ResCommP, F227Comm;

macro _CalcTurns( RefValue,Cred,Deb,OtherCred,OtherDeb )

  CashVal.rec.UnitMeas = RESMESUNIT_POINT;

  CalcTurns( RefValue, Cred, Deb, OtherCred, OtherDeb );
  SetParm( 1, Cred );
  SetParm( 2, Deb );
  SetParm( 3, OtherCred );
  SetParm( 4, OtherDeb );
end;

  var
    RegPath = "RS-RETAIL\\…—€’ˆ\\‚…„Œ‘’œ__Œ…’€Œ_˜’“Šˆ",
    RecFound;

  CalcTurnsProc = @_CalcTurns;

  CheckPrinter( RegPath, StrFor( 0 ) );

  if ( {EDeskOpen} )
    OperBrigade = B_EDESK;
  elif ( {DeskOpen} ) 
    OperBrigade = B_RDESK;
  end;

  if ( {RprtDSubj} == "" )
    KeyNum( DeskSubj, 1 );
    ClearRecord( DeskSubj );
    DeskSubj.Branch = Branch;
    DeskSubj.Type = DST_PANTRY;
    RecFound = GetGE( DeskSubj );
    while ( RecFound
      and ( DeskSubj.Branch == Branch )
      and ( DeskSubj.Type == DST_PANTRY ) )
      PrintHeadIfNeed=-1;
      Safe = DeskSubj.Name;
      TreatCurrentSafe;
      RecFound = Next( DeskSubj );
    end;
    KeyNum( DeskSubj, 0 );
    DeskSubj.Branch = Branch;
    DeskSubj.Name = RDesk;
    if ( GetEQ( DeskSubj ) )
      Safe = DeskSubj.Name;
      TreatCurrentSafe;
    end;
  else
    DeskSubj.Branch = Branch;
    DeskSubj.Name = {RprtDSubj};
    if ( GetEQ( DeskSubj ) )
      Safe = DeskSubj.Name;
      TreatCurrentSafe;
    end;
  end;
  ExitMacro;
end;
