
/* Касса пересчета: Объявление на взнос наличными */

import deprintr, DeskInter, RD_Comm, CashDecl;

  var
    Decl : TCashDecl, 
    Number,
    PayerBIC,
    PayerName,
    DebetAcc,
    CreditAcc;

  CheckPersonType( PT_OPER );

  if ( Bag.RouteID != 0 )
    Exit( 1 );
  end; 

  GetInt( Number, "Введите номер объявления" );
  if ( ValType( Number ) == V_INTEGER )
    GetClientInfo( Bag.ClientType, Bag.ClientID, PayerName, PayerBIC );
    GetAccounts( DebetAcc, CreditAcc );

    Decl.Number = Number;
    Decl.DocDate = {curdate};
    Decl.PayerName = PayerName;
    Decl.PayerBIC = PayerBic;
    Decl.RcvBank = {Name_Bank};
    Decl.RcvBIC = {MFO_Bank};
    Decl.DebetAcc = DebetAcc;
    Decl.CreditAcc = CreditAcc;
    Decl.Ground = "Излишки опер. кассы";
    Decl.Sum = Bag.RealSum;

    Decl.Print;    
  end;
end;    