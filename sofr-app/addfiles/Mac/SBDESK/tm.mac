/*===========================================================================
  RS-Retail 5.10 TM.lib
     Build  071

     Библиотека для принтеров серии ТМ

HISTORY:
  creation LAA 15.07.2002
  correct OSB 2525
  correct OSB 0017
  correct OSB Vologda
============================================================================*/

const 
  Использовать_ТМ = TRUE;  /* Если Вы не пользуетесь принтером серии ТМ */
                           /* для печати ордеров, установите значение   */ 
                           /* переменной Использовать_ТМ равным FALSE   */ 

MACRO Сброс() /* Сброс принтера */
  if ( Использовать_ТМ )
    println(StrFor(27)+"@");
  end; 
end;
       
MACRO Печать_ПД_4() /* печать на бумагу в лотке (slip) */
  if ( Использовать_ТМ )
    println("c0"+strfor(4));
  end;
end;

MACRO Поднять_Каретку() /* Поднять каретку для листа в TM*/
  if ( Использовать_ТМ )
    print("@c0");   /* инициализация + направление печати на slip */
  end; 
END;

MACRO Опустить_Каретку() /* Опустить каретку для листа в TM*/
  if ( Использовать_ТМ )
    print("@c1");
  end;
END;

MACRO Прогон_Листа()    /* Прогон листа до конца */
  if ( Использовать_ТМ )
    print(StrFor(12));
  end;
END;

MACRO Строка_Вниз() /* Опускает на 1 строку вниз верхнюю ленту */
  if ( Использовать_ТМ )
    print("K");
  end;
END;

MACRO Двойная_высота() /* ну очень высокие буквы */
  if ( Использовать_ТМ )
    println("!");
  end;
end;

MACRO Семь_на_дюйм()
  if ( Использовать_ТМ )
    print("3");
  end; 
END;

MACRO Восемь_на_дюйм() /* Режим печати - 8 строк на дюйм */
  if ( Использовать_ТМ )
    print("\x1b0");
  end;
END;

MACRO Резать_Ленту() /* разрезает верхнюю ленту*/
  if ( Использовать_ТМ )
  /*
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    println(" ");
    */ /*раскоментировать в случае желания прогнать а потом отрезать*/
    /* Резак работает после StrFor(27)+"i", зачем JJJ - не знаю */
    print("i                         JJJ");
  end;
END;

MACRO Узкий_режим() /* устанавливает узкий режим печати*/
  if ( Использовать_ТМ )
    print("!");
  end;
END;

MACRO Широкий_режим() /* устанавливает широкий режим печати*/
  if ( Использовать_ТМ )
    print("!");
  end; 
END;

MACRO Вверх_Ногами() /*печать вверх ногами (необходимо выверното подавать строки)
                       например для печати справки 0406007 вверх ногами*/
  if ( Использовать_ТМ )
    print("@c0{");
  end;
END;

MACRO Печать_чека() /* печать без контрольной ленты (receipt) */
  if ( Использовать_ТМ )
    println("c0"+strfor(2));
  end;
end;

MACRO Печать_Ленты() /* печать на контрольную ленту (journal) */
  if ( Использовать_ТМ )
    println("c0"+strfor(1));
  end; 
end;

MACRO Печать_Лазер() /* печать на лазерном принтере -ландшафт(из ретейл) */
/*  println ("<ESC>&l1O<ESC>(s0p18.00h18)")  */  /* Сильное сжатие по горизонтали*/
/*  println ("&l1O(s0p18.00h18)") */  /* Сильное сжатие по горизонтали*/
    println ("E&l1O(3R")  /* Печать без сжатие по горизонтали*/
/*    println ("&l1O")  /* Печать без сжатие по горизонтали*/   */
end;


MACRO Печать_Лазер_портр() /* печать на лазерном принтере -потрет(из ретейл) */
/*  println ("<ESC>&l1O<ESC>(s0p18.00h18)")  */  /* Сильное сжатие по горизонтали*/
/*  println ("&l1O(s0p18.00h18)") */  /* Сильное сжатие по горизонтали*/
    println ("E&a1L(3R(s0p14.00h14.0v0s0b3T&l8D")  /* Печать без сжатие по горизонтали*/
end;


MACRO Печать_Лазер_сжат() /* печать на лазерном принтере -портрет с сжатием */
    println ("E&l0O(3R(s0p16.00h16)")
end;

MACRO Печать_Лазер_сжат_ланд() /* печать на лазерном принтере -ландшафт с сжатием */
    println ("E&l1O(3R(s0p18.00h18)")

end;

MACRO Печать_Лазер_сжат_ланд2() /* печать на лазерном принтере -ландшафт с сжатием - чуть крупнее*/
    println ("E&l1O(3R(s0p14.00h14)")

end;

MACRO Печать_Лазер_сжат_ланд_сильн() /* печать на лазерном принтере -ландшафт с сжатием */
    println ("E&l1O(3R(s0p26.00h18)")

end;

MACRO Печать_Лазер_113_И() /* печать на лазерном принтере -ландшафт с сжатием */
    println ("E&l1O(3R(s0p22.00h22)")

end;


MACRO Открыть_кассу()  /* Открыть денежный ящик  */
  println("p"+strfor(1)+strfor(25)+strfor(250));
end;

MACRO Header_Up()
  if ( Использовать_ТМ )
    if (GetTrue(TRUE,"Вставлен лист заголовком вверх в принтер ТМ?| При ответе НЕТ печать на принтер по умолчанию"))
      return TRUE;
    end;
  else
    return TRUE;
  end;
END;

MACRO Header_Rihgt()
  if ( Использовать_ТМ )
    if (GetTrue(TRUE,"Вставлен лист заголовком вправо в принтер ТМ?| При ответе НЕТ печать на принтер по умолчанию"))
      return TRUE;
    end;
  else
    return TRUE;
  end; 
END;

MACRO Branch_PrintTM()
/*
  file LISTFDEP ("listfdep.dbt","sbbank.def") key 0;

  var Branch = NumFNCash(), stat = FALSE;

  if ( Использовать_ТМ )
    LISTFDEP.FNCash = Branch;
    stat = GetEQ (LISTFDEP);
    if (stat)
      if ( (strUpr(trim(LISTFDEP.Reserve)) == "TM") or
           (strUpr(trim(LISTFDEP.Reserve)) == "ТМ")
         )
        return TRUE;
      else
        return FALSE;
      end;
    else
      msgBox ("TM.Lib Error in function PrintTM  | | Номер филиала не найден для проверки печати на ТМ");
      exit (1);
    end;
  end;
*/
  return FALSE;
end;

