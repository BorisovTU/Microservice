
/* Квитанция о приеме на экспертизу */

import DeprIntr, DeskInter, RD_Comm;

var
  Sum, RubSum,
  CtrName,
  OpDesc;

  CheckPersonType( PT_CONTR );

  if ( Bag.Dubious )
    Sum = Bag.Dubious;
  else
    Sum = Money( Bag.DubiousItems );
  end;

  GetCurrCodeAndCBRate( Bag.ValueRef );
  FindCashValue( Bag.ValueRef );
  GetClientInfo( Bag.ClientType, Bag.ClientID, CtrName, null, null, null, null );

  RubSum = Cur2Rub( Sum );
  if ( RubSum == $0 )
    Exit( 1 );
  end;

  OpDesc = "Прием на экспертизу: " + CashValue.NameValue;
  if ( CurrCode )
    OpDesc = OpDesc + " (на сумму " + Sum + " " + Curr.Short_Name + ")";
  end; 


  [                                                            +-------------+ ];
  [                                                            |   0402004   | ];
  [                                                            +-------------+ ];
  [                                                                            ];
  [    КВИТАНЦИЯ        Серия ____________                                     ];
  [    ###################################                                     ]
  ( Bag.Date:m );
  [                                                                            ];
  [                                                  +-----------------------+ ];
  [                                                  | Приход                | ];
  [ От кого     #################################### | счет №                | ]
  ( CtrName );
  [ -------------------------------------------------+-----------------------+ ];
  [                                                  | Сумма цифрами         | ];
  [ Получатель  #################################### | ##################### | ]
  ( {Name_Bank}, RubSum );
  [ -------------------------------------------------+-----------------------+ ];
  [ Сумма прописью                                                             ];
  [ ########################################################################## ]
  ( RubToStr( RubSum ):w );
  [ -------------------------------------------------------------------------- ];
  [ Вид операции                                                               ];
  [ ########################################################################## ]
  ( OpDesc );  
  [ -------------------------------------------------------------------------- ];
  [ Основание                                                                  ]; 
  [                                                                            ]; 
  [ -------------------------------------------------------------------------- ];
  [ Бухгалтер                           Кассир                                 ];
  [ М.П.                                                                       ];
  Print( StrFor( 12 ) );    
end;