import BankInter;

macro GetRegImportDirU(dt:date, ErrMes:@string):string
  var RegDir = "РСХБ\\ДИРЕКТОРИИ\\IMPORT";
  var ImpDir, err, i, j, k;

  GetRegistryValue(RegDir, V_STRING, ImpDir, err);

  if(err)
     ErrMes = "Ошибка получения значения настройки \"" + ImpDir + "\"";
     return "";
  end;

  if(substr(ImpDir,strlen(ImpDir)) != "\\")
    ImpDir = ImpDir + "\\";
  end;

  datesplit(dt, i, j, k);
  if(i < 10)
    ImpDir = ImpDir + "0" + i;
  else
    ImpDir = ImpDir + i;
  end;
  if(j < 10)
    ImpDir = ImpDir + "0" + j;
  else
    ImpDir = ImpDir + j;
  end;
  ImpDir = ImpDir + substr(string(k),3,2) + "\\";

  return ImpDir;
end;

macro GetRegImportDirUSPB(dt:date, ErrMes:@string):string
  var RegDir = "РСХБ\\ДИРЕКТОРИИ\\SPBIMPORT";
  var ImpDir, err, i, j, k;

  GetRegistryValue(RegDir, V_STRING, ImpDir, err);

  if(err)
     ErrMes = "Ошибка получения значения настройки \"" + ImpDir + "\"";
     return "";
  end;

  if(substr(ImpDir,strlen(ImpDir)) != "\\")
    ImpDir = ImpDir + "\\";
  end;

  datesplit(dt, i, j, k);
  if(i < 10)
    ImpDir = ImpDir + "0" + i;
  else
    ImpDir = ImpDir + i;
  end;
  if(j < 10)
    ImpDir = ImpDir + "0" + j;
  else
    ImpDir = ImpDir + j;
  end;
  ImpDir = ImpDir + substr(string(k),3,2) + "\\";

  return ImpDir;
end;

macro GetRegImportDirUNRD( dt:date, ErrMes:@string):string
  var RegDir = "РСХБ\\ДИРЕКТОРИИ\\IMPORTNRD";
  var ImpDir, err, i, j, k;

  GetRegistryValue(RegDir, V_STRING, ImpDir, err);

  if(err)
     ErrMes = "Ошибка получения значения настройки \"" + ImpDir + "\"";
     return "";
  end;

  if(substr(ImpDir,strlen(ImpDir)) != "\\")
    ImpDir = ImpDir + "\\";
  end;
/*
  datesplit(dt, i, j, k);
  if(i < 10)
    ImpDir = ImpDir + "0" + i;
  else
    ImpDir = ImpDir + i;
  end;
  if(j < 10)
    ImpDir = ImpDir + "0" + j;
  else
    ImpDir = ImpDir + j;
  end;
  ImpDir = ImpDir + substr(string(k),3,2) + "\\";
*/
  return ImpDir;
end;

