/*
$Name:        rgtgtsnc.mac
$Module:      Шлюз
$Description:
*/
/////////////////////////////////////////
// Класс сеанса шлюза
/////////////////////////////////////////
import GateInter, RsbDataSet, RSD;

Class TGtSnc(SeanceId : integer)
   VAR Id                : integer;
   VAR ApplicationId     : integer;
   VAR Direction         : integer;
   VAR Kind              : integer;
   VAR RecordStatus      : integer;	
   VAR IsOperStartup     : string;
   VAR StartId           : string;
   VAR Sysdate           : date;
   VAR Systime           : time;
   VAR Enddate           : date;
   VAR Endtime           : time;
   VAR ErrCount          : integer;
   VAR WarnCount         : integer;
	

   /////////////////////////////////////////
   // Внутренняя инициализация объекта
   /////////////////////////////////////////
   private Macro Init()
           var cmd = RsdCommand("SELECT T_SEANCEID, T_DIRECTION, T_APPLICATIONID, " +
                            "T_KIND, T_RECORDSTATUS, T_ISOPERSTARTUP, " +
                            "T_STARTID, T_SYSDATE, T_SYSTIME, " +
                            "T_ENDDATE, T_ENDTIME, T_ERRORCOUNT, T_WARNINGCOUNT " +
                            "FROM DGTSEANCE_DBT where T_SEANCEID = ?");
           cmd.AddParam("", RSDBP_IN, Id);
           cmd.Execute();

           var ds = TRsbDataSet(cmd);

           if (ds.MoveNext() != true)
              RunError("Сеанс с заданным идентификатором" + Id + " не существует!");
           else
              ApplicationId = ds.APPLICATIONID;
              Direction     = ds.DIRECTION;
              Kind          = ds.KIND;
              RecordStatus  = ds.RECORDSTATUS;	
              IsOperStartup = ds.ISOPERSTARTUP;
              StartId       = ds.STARTID;
              Sysdate       = ds.SYSDATE;
              Systime       = ds.SYSTIME ;
              Enddate       = ds.ENDTIME;
              Endtime       = ds.ENDTIME;
              ErrCount      = ds.ERRORCOUNT;
              WarnCount     = ds.WARNINGCOUNT;
           end;
   end;

   /////////////////////////////////////////
   // Конструктор
   /////////////////////////////////////////
   Id = SeanceId;
   Init();
   /////////////////////////////////////////


end;
